const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["chunks/types-E3Sm3O4A.js","assets/types--hK0Ljo7.css"])))=>i.map(i=>d[i]);
var l,c,d,h,p,f,m,y,_,b,w,E,M,N,P,L,j,D,F,U,B,H,z,q,V,Z,K,Y,ee,ne,se,ie,oe,le,ce,pe,fe,ge,be,Oe,Ne,De,Fe,Ue,Be,He,qe,Ve,Je,tt,nt,it,ht,ft,gt,yt,_t,bt,wt,St,xt,kt,Et,It,Tt,At,Ot,Mt,Nt,Pt,Lt,jt,Dt,Ft,Bt,Ht,Wt,Vt,Zt=Object.defineProperty,__typeError=l=>{throw TypeError(l)},__publicField=(l,c,d)=>((l,c,d)=>c in l?Zt(l,c,{enumerable:!0,configurable:!0,writable:!0,value:d}):l[c]=d)(l,"symbol"!=typeof c?c+"":c,d),__accessCheck=(l,c,d)=>c.has(l)||__typeError("Cannot "+d),__privateGet=(l,c,d)=>(__accessCheck(l,c,"read from private field"),d?d.call(l):c.get(l)),__privateAdd=(l,c,d)=>c.has(l)?__typeError("Cannot add the same private member more than once"):c instanceof WeakSet?c.add(l):c.set(l,d),__privateSet=(l,c,d,h)=>(__accessCheck(l,c,"write to private field"),h?h.call(l,d):c.set(l,d),d),__privateMethod=(l,c,d)=>(__accessCheck(l,c,"access private method"),d),__privateWrapper=(l,c,d,h)=>({set _(h){__privateSet(l,c,h,d)},get _(){return __privateGet(l,c,h)}});import{r as Gt,j as Kt,R as Yt,a as Qt,b as er,d as tr,g as rr,e as sr,B as or,f as ar,h as ur,i as dr,u as pr,k as fr,M as gr,l as vr,m as wr,c as Sr}from"./types-E3Sm3O4A.js";var kr="popstate";function createBrowserHistory(l={}){return function(l,c,d,h={}){let{window:p=document.defaultView,v5Compat:f=!1}=h,m=p.history,y="POP",_=null,b=getIndex();null==b&&(b=0,m.replaceState({...m.state,idx:b},""));function getIndex(){return(m.state||{idx:null}).idx}function handlePop(){y="POP";let l=getIndex(),c=null==l?null:l-b;b=l,_&&_({action:y,location:w.location,delta:c})}function push(l,c){y="PUSH";let d=createLocation(w.location,l,c);b=getIndex()+1;let h=getHistoryState(d,b),E=w.createHref(d);try{m.pushState(h,"",E)}catch(M){if(M instanceof DOMException&&"DataCloneError"===M.name)throw M;p.location.assign(E)}f&&_&&_({action:y,location:w.location,delta:1})}function replace2(l,c){y="REPLACE";let d=createLocation(w.location,l,c);b=getIndex();let h=getHistoryState(d,b),p=w.createHref(d);m.replaceState(h,"",p),f&&_&&_({action:y,location:w.location,delta:0})}function createURL(l){return function(l,c=!1){let d="http://localhost";"undefined"!=typeof window&&(d="null"!==window.location.origin?window.location.origin:window.location.href);invariant(d,"No window.location.(origin|href) available to create URL");let h="string"==typeof l?l:createPath(l);h=h.replace(/ $/,"%20"),!c&&h.startsWith("//")&&(h=d+h);return new URL(h,d)}(l)}let w={get action(){return y},get location(){return l(p,m)},listen(l){if(_)throw new Error("A history only accepts one active listener");return p.addEventListener(kr,handlePop),_=l,()=>{p.removeEventListener(kr,handlePop),_=null}},createHref:l=>c(p,l),createURL:createURL,encodeLocation(l){let c=createURL(l);return{pathname:c.pathname,search:c.search,hash:c.hash}},push:push,replace:replace2,go:l=>m.go(l)};return w}((function(l,c){let{pathname:d,search:h,hash:p}=l.location;return createLocation("",{pathname:d,search:h,hash:p},c.state&&c.state.usr||null,c.state&&c.state.key||"default")}),(function(l,c){return"string"==typeof c?c:createPath(c)}),0,l)}function invariant(l,c){if(!1===l||null==l)throw new Error(c)}function warning(l,c){if(!l){"undefined"!=typeof console&&console.warn(c);try{throw new Error(c)}catch(hh){}}}function getHistoryState(l,c){return{usr:l.state,key:l.key,idx:c}}function createLocation(l,c,d=null,h){return{pathname:"string"==typeof l?l:l.pathname,search:"",hash:"",..."string"==typeof c?parsePath(c):c,state:d,key:c&&c.key||h||Math.random().toString(36).substring(2,10)}}function createPath({pathname:l="/",search:c="",hash:d=""}){return c&&"?"!==c&&(l+="?"===c.charAt(0)?c:"?"+c),d&&"#"!==d&&(l+="#"===d.charAt(0)?d:"#"+d),l}function parsePath(l){let c={};if(l){let d=l.indexOf("#");d>=0&&(c.hash=l.substring(d),l=l.substring(0,d));let h=l.indexOf("?");h>=0&&(c.search=l.substring(h),l=l.substring(0,h)),l&&(c.pathname=l)}return c}function matchRoutes(l,c,d="/"){return function(l,c,d,h){let p="string"==typeof c?parsePath(c):c,f=stripBasename(p.pathname||"/",d);if(null==f)return null;let m=flattenRoutes(l);!function(l){l.sort(((l,c)=>l.score!==c.score?c.score-l.score:function(l,c){let d=l.length===c.length&&l.slice(0,-1).every(((l,d)=>l===c[d]));return d?l[l.length-1]-c[c.length-1]:0}(l.routesMeta.map((l=>l.childrenIndex)),c.routesMeta.map((l=>l.childrenIndex)))))}(m);let y=null;for(let _=0;null==y&&_<m.length;++_){let l=decodePath(f);y=matchRouteBranch(m[_],l,h)}return y}(l,c,d,!1)}function flattenRoutes(l,c=[],d=[],h=""){let flattenRoute=(l,p,f)=>{let m={relativePath:void 0===f?l.path||"":f,caseSensitive:!0===l.caseSensitive,childrenIndex:p,route:l};m.relativePath.startsWith("/")&&(invariant(m.relativePath.startsWith(h),`Absolute route path "${m.relativePath}" nested under path "${h}" is not valid. An absolute child route path must start with the combined path of all its parent routes.`),m.relativePath=m.relativePath.slice(h.length));let y=joinPaths([h,m.relativePath]),_=d.concat(m);l.children&&l.children.length>0&&(invariant(!0!==l.index,`Index routes must not have child routes. Please remove all child routes from route path "${y}".`),flattenRoutes(l.children,c,_,y)),(null!=l.path||l.index)&&c.push({path:y,score:computeScore(y,l.index),routesMeta:_})};return l.forEach(((l,c)=>{if(""!==l.path&&l.path?.includes("?"))for(let d of explodeOptionalSegments(l.path))flattenRoute(l,c,d);else flattenRoute(l,c)})),c}function explodeOptionalSegments(l){let c=l.split("/");if(0===c.length)return[];let[d,...h]=c,p=d.endsWith("?"),f=d.replace(/\?$/,"");if(0===h.length)return p?[f,""]:[f];let m=explodeOptionalSegments(h.join("/")),y=[];return y.push(...m.map((l=>""===l?f:[f,l].join("/")))),p&&y.push(...m),y.map((c=>l.startsWith("/")&&""===c?"/":c))}var Cr=/^:[\w-]+$/,Er=3,Ir=2,Tr=1,Rr=10,Ar=-2,isSplat=l=>"*"===l;function computeScore(l,c){let d=l.split("/"),h=d.length;return d.some(isSplat)&&(h+=Ar),c&&(h+=Ir),d.filter((l=>!isSplat(l))).reduce(((l,c)=>l+(Cr.test(c)?Er:""===c?Tr:Rr)),h)}function matchRouteBranch(l,c,d=!1){let{routesMeta:h}=l,p={},f="/",m=[];for(let y=0;y<h.length;++y){let l=h[y],_=y===h.length-1,b="/"===f?c:c.slice(f.length)||"/",w=matchPath({path:l.relativePath,caseSensitive:l.caseSensitive,end:_},b),E=l.route;if(!w&&_&&d&&!h[h.length-1].route.index&&(w=matchPath({path:l.relativePath,caseSensitive:l.caseSensitive,end:!1},b)),!w)return null;Object.assign(p,w.params),m.push({params:p,pathname:joinPaths([f,w.pathname]),pathnameBase:normalizePathname(joinPaths([f,w.pathnameBase])),route:E}),"/"!==w.pathnameBase&&(f=joinPaths([f,w.pathnameBase]))}return m}function matchPath(l,c){"string"==typeof l&&(l={path:l,caseSensitive:!1,end:!0});let[d,h]=function(l,c=!1,d=!0){warning("*"===l||!l.endsWith("*")||l.endsWith("/*"),`Route path "${l}" will be treated as if it were "${l.replace(/\*$/,"/*")}" because the \`*\` character must always follow a \`/\` in the pattern. To get rid of this warning, please change the route path to "${l.replace(/\*$/,"/*")}".`);let h=[],p="^"+l.replace(/\/*\*?$/,"").replace(/^\/*/,"/").replace(/[\\.*+^${}|()[\]]/g,"\\$&").replace(/\/:([\w-]+)(\?)?/g,((l,c,d)=>(h.push({paramName:c,isOptional:null!=d}),d?"/?([^\\/]+)?":"/([^\\/]+)")));l.endsWith("*")?(h.push({paramName:"*"}),p+="*"===l||"/*"===l?"(.*)$":"(?:\\/(.+)|\\/*)$"):d?p+="\\/*$":""!==l&&"/"!==l&&(p+="(?:(?=\\/|$))");let f=new RegExp(p,c?void 0:"i");return[f,h]}(l.path,l.caseSensitive,l.end),p=c.match(d);if(!p)return null;let f=p[0],m=f.replace(/(.)\/+$/,"$1"),y=p.slice(1);return{params:h.reduce(((l,{paramName:c,isOptional:d},h)=>{if("*"===c){let l=y[h]||"";m=f.slice(0,f.length-l.length).replace(/(.)\/+$/,"$1")}const p=y[h];return l[c]=d&&!p?void 0:(p||"").replace(/%2F/g,"/"),l}),{}),pathname:f,pathnameBase:m,pattern:l}}function decodePath(l){try{return l.split("/").map((l=>decodeURIComponent(l).replace(/\//g,"%2F"))).join("/")}catch(c){return warning(!1,`The URL path "${l}" could not be decoded because it is a malformed URL segment. This is probably due to a bad percent encoding (${c}).`),l}}function stripBasename(l,c){if("/"===c)return l;if(!l.toLowerCase().startsWith(c.toLowerCase()))return null;let d=c.endsWith("/")?c.length-1:c.length,h=l.charAt(d);return h&&"/"!==h?null:l.slice(d)||"/"}function getInvalidPathError(l,c,d,h){return`Cannot include a '${l}' character in a manually specified \`to.${c}\` field [${JSON.stringify(h)}].  Please separate it out to the \`to.${d}\` field. Alternatively you may provide the full path as a string in <Link to="..."> and the router will parse it for you.`}function getResolveToMatches(l){let c=function(l){return l.filter(((l,c)=>0===c||l.route.path&&l.route.path.length>0))}(l);return c.map(((l,d)=>d===c.length-1?l.pathname:l.pathnameBase))}function resolveTo(l,c,d,h=!1){let p;"string"==typeof l?p=parsePath(l):(p={...l},invariant(!p.pathname||!p.pathname.includes("?"),getInvalidPathError("?","pathname","search",p)),invariant(!p.pathname||!p.pathname.includes("#"),getInvalidPathError("#","pathname","hash",p)),invariant(!p.search||!p.search.includes("#"),getInvalidPathError("#","search","hash",p)));let f,m=""===l||""===p.pathname,y=m?"/":p.pathname;if(null==y)f=d;else{let l=c.length-1;if(!h&&y.startsWith("..")){let c=y.split("/");for(;".."===c[0];)c.shift(),l-=1;p.pathname=c.join("/")}f=l>=0?c[l]:"/"}let _=function(l,c="/"){let{pathname:d,search:h="",hash:p=""}="string"==typeof l?parsePath(l):l,f=d?d.startsWith("/")?d:function(l,c){let d=c.replace(/\/+$/,"").split("/");return l.split("/").forEach((l=>{".."===l?d.length>1&&d.pop():"."!==l&&d.push(l)})),d.length>1?d.join("/"):"/"}(d,c):c;return{pathname:f,search:normalizeSearch(h),hash:normalizeHash(p)}}(p,f),b=y&&"/"!==y&&y.endsWith("/"),w=(m||"."===y)&&d.endsWith("/");return _.pathname.endsWith("/")||!b&&!w||(_.pathname+="/"),_}var joinPaths=l=>l.join("/").replace(/\/\/+/g,"/"),normalizePathname=l=>l.replace(/\/+$/,"").replace(/^\/*/,"/"),normalizeSearch=l=>l&&"?"!==l?l.startsWith("?")?l:"?"+l:"",normalizeHash=l=>l&&"#"!==l?l.startsWith("#")?l:"#"+l:"";var Or=["POST","PUT","PATCH","DELETE"];new Set(Or);var Mr=["GET",...Or];new Set(Mr);var jr=Gt.createContext(null);jr.displayName="DataRouter";var zr=Gt.createContext(null);zr.displayName="DataRouterState",Gt.createContext(!1);var qr=Gt.createContext({isTransitioning:!1});qr.displayName="ViewTransition",Gt.createContext(new Map).displayName="Fetchers",Gt.createContext(null).displayName="Await";var Vr=Gt.createContext(null);Vr.displayName="Navigation";var Zr=Gt.createContext(null);Zr.displayName="Location";var Gr=Gt.createContext({outlet:null,matches:[],isDataRoute:!1});Gr.displayName="Route";var Kr=Gt.createContext(null);function useInRouterContext(){return null!=Gt.useContext(Zr)}function useLocation(){return invariant(useInRouterContext(),"useLocation() may be used only in the context of a <Router> component."),Gt.useContext(Zr).location}Kr.displayName="RouteError";var Yr="You should call navigate() in a React.useEffect(), not when your component is first rendered.";function useIsomorphicLayoutEffect$3(l){Gt.useContext(Vr).static||Gt.useLayoutEffect(l)}function useNavigate(){let{isDataRoute:l}=Gt.useContext(Gr);return l?function(){let{router:l}=function(l){let c=Gt.useContext(jr);return invariant(c,getDataRouterConsoleError(l)),c}("useNavigate"),c=useCurrentRouteId("useNavigate"),d=Gt.useRef(!1);return useIsomorphicLayoutEffect$3((()=>{d.current=!0})),Gt.useCallback((async(h,p={})=>{warning(d.current,Yr),d.current&&("number"==typeof h?l.navigate(h):await l.navigate(h,{fromRouteId:c,...p}))}),[l,c])}():function(){invariant(useInRouterContext(),"useNavigate() may be used only in the context of a <Router> component.");let l=Gt.useContext(jr),{basename:c,navigator:d}=Gt.useContext(Vr),{matches:h}=Gt.useContext(Gr),{pathname:p}=useLocation(),f=JSON.stringify(getResolveToMatches(h)),m=Gt.useRef(!1);return useIsomorphicLayoutEffect$3((()=>{m.current=!0})),Gt.useCallback(((h,y={})=>{if(warning(m.current,Yr),!m.current)return;if("number"==typeof h)return void d.go(h);let _=resolveTo(h,JSON.parse(f),p,"path"===y.relative);null==l&&"/"!==c&&(_.pathname="/"===_.pathname?c:joinPaths([c,_.pathname])),(y.replace?d.replace:d.push)(_,y.state,y)}),[c,d,f,p,l])}()}function useParams(){let{matches:l}=Gt.useContext(Gr),c=l[l.length-1];return c?c.params:{}}function useResolvedPath(l,{relative:c}={}){let{matches:d}=Gt.useContext(Gr),{pathname:h}=useLocation(),p=JSON.stringify(getResolveToMatches(d));return Gt.useMemo((()=>resolveTo(l,JSON.parse(p),h,"path"===c)),[l,p,h,c])}function useRoutesImpl(l,c,d,h){invariant(useInRouterContext(),"useRoutes() may be used only in the context of a <Router> component.");let{navigator:p}=Gt.useContext(Vr),{matches:f}=Gt.useContext(Gr),m=f[f.length-1],y=m?m.params:{},_=m?m.pathname:"/",b=m?m.pathnameBase:"/",w=m&&m.route;{let l=w&&w.path||"";warningOnce(_,!w||l.endsWith("*")||l.endsWith("*?"),`You rendered descendant <Routes> (or called \`useRoutes()\`) at "${_}" (under <Route path="${l}">) but the parent route path has no trailing "*". This means if you navigate deeper, the parent won't match anymore and therefore the child routes will never render.\n\nPlease change the parent <Route path="${l}"> to <Route path="${"/"===l?"*":`${l}/*`}">.`)}let E,M=useLocation();if(c){let l="string"==typeof c?parsePath(c):c;invariant("/"===b||l.pathname?.startsWith(b),`When overriding the location using \`<Routes location>\` or \`useRoutes(routes, location)\`, the location pathname must begin with the portion of the URL pathname that was matched by all parent routes. The current pathname base is "${b}" but pathname "${l.pathname}" was given in the \`location\` prop.`),E=l}else E=M;let N=E.pathname||"/",P=N;if("/"!==b){let l=b.replace(/^\//,"").split("/");P="/"+N.replace(/^\//,"").split("/").slice(l.length).join("/")}let L=matchRoutes(l,{pathname:P});warning(w||null!=L,`No routes matched location "${E.pathname}${E.search}${E.hash}" `),warning(null==L||void 0!==L[L.length-1].route.element||void 0!==L[L.length-1].route.Component||void 0!==L[L.length-1].route.lazy,`Matched leaf route at location "${E.pathname}${E.search}${E.hash}" does not have an element or Component. This means it will render an <Outlet /> with a null value by default resulting in an "empty" page.`);let j=function(l,c=[],d=null){if(null==l){if(!d)return null;if(d.errors)l=d.matches;else{if(0!==c.length||d.initialized||!(d.matches.length>0))return null;l=d.matches}}let h=l,p=d?.errors;if(null!=p){let l=h.findIndex((l=>l.route.id&&void 0!==p?.[l.route.id]));invariant(l>=0,`Could not find a matching route for errors on route IDs: ${Object.keys(p).join(",")}`),h=h.slice(0,Math.min(h.length,l+1))}let f=!1,m=-1;if(d)for(let y=0;y<h.length;y++){let l=h[y];if((l.route.HydrateFallback||l.route.hydrateFallbackElement)&&(m=y),l.route.id){let{loaderData:c,errors:p}=d,y=l.route.loader&&!c.hasOwnProperty(l.route.id)&&(!p||void 0===p[l.route.id]);if(l.route.lazy||y){f=!0,h=m>=0?h.slice(0,m+1):[h[0]];break}}}return h.reduceRight(((l,y,_)=>{let b,w=!1,E=null,M=null;d&&(b=p&&y.route.id?p[y.route.id]:void 0,E=y.route.errorElement||en,f&&(m<0&&0===_?(warningOnce("route-fallback",!1,"No `HydrateFallback` element provided to render during initial hydration"),w=!0,M=null):m===_&&(w=!0,M=y.route.hydrateFallbackElement||null)));let N=c.concat(h.slice(0,_+1)),getChildren=()=>{let c;return c=b?E:w?M:y.route.Component?Gt.createElement(y.route.Component,null):y.route.element?y.route.element:l,Gt.createElement(RenderedRoute,{match:y,routeContext:{outlet:l,matches:N,isDataRoute:null!=d},children:c})};return d&&(y.route.ErrorBoundary||y.route.errorElement||0===_)?Gt.createElement(tn,{location:d.location,revalidation:d.revalidation,component:E,error:b,children:getChildren(),routeContext:{outlet:null,matches:N,isDataRoute:!0}}):getChildren()}),null)}(L&&L.map((l=>Object.assign({},l,{params:Object.assign({},y,l.params),pathname:joinPaths([b,p.encodeLocation?p.encodeLocation(l.pathname).pathname:l.pathname]),pathnameBase:"/"===l.pathnameBase?b:joinPaths([b,p.encodeLocation?p.encodeLocation(l.pathnameBase).pathname:l.pathnameBase])}))),f,d,h);return c&&j?Gt.createElement(Zr.Provider,{value:{location:{pathname:"/",search:"",hash:"",state:null,key:"default",...E},navigationType:"POP"}},j):j}function DefaultErrorComponent(){let l=function(){let l=Gt.useContext(Kr),c=function(l){let c=Gt.useContext(zr);return invariant(c,getDataRouterConsoleError(l)),c}("useRouteError"),d=useCurrentRouteId("useRouteError");if(void 0!==l)return l;return c.errors?.[d]}(),c=function(l){return null!=l&&"number"==typeof l.status&&"string"==typeof l.statusText&&"boolean"==typeof l.internal&&"data"in l}(l)?`${l.status} ${l.statusText}`:l instanceof Error?l.message:JSON.stringify(l),d=l instanceof Error?l.stack:null,h="rgba(200,200,200, 0.5)",p={padding:"0.5rem",backgroundColor:h},f={padding:"2px 4px",backgroundColor:h},m=null;return console.error("Error handled by React Router default ErrorBoundary:",l),m=Gt.createElement(Gt.Fragment,null,Gt.createElement("p",null,"\ud83d\udcbf Hey developer \ud83d\udc4b"),Gt.createElement("p",null,"You can provide a way better UX than this when your app throws errors by providing your own ",Gt.createElement("code",{style:f},"ErrorBoundary")," or"," ",Gt.createElement("code",{style:f},"errorElement")," prop on your route.")),Gt.createElement(Gt.Fragment,null,Gt.createElement("h2",null,"Unexpected Application Error!"),Gt.createElement("h3",{style:{fontStyle:"italic"}},c),d?Gt.createElement("pre",{style:p},d):null,m)}Gt.createContext(null);var en=Gt.createElement(DefaultErrorComponent,null),tn=class extends Gt.Component{constructor(l){super(l),this.state={location:l.location,revalidation:l.revalidation,error:l.error}}static getDerivedStateFromError(l){return{error:l}}static getDerivedStateFromProps(l,c){return c.location!==l.location||"idle"!==c.revalidation&&"idle"===l.revalidation?{error:l.error,location:l.location,revalidation:l.revalidation}:{error:void 0!==l.error?l.error:c.error,location:c.location,revalidation:l.revalidation||c.revalidation}}componentDidCatch(l,c){console.error("React Router caught the following error during render",l,c)}render(){return void 0!==this.state.error?Gt.createElement(Gr.Provider,{value:this.props.routeContext},Gt.createElement(Kr.Provider,{value:this.state.error,children:this.props.component})):this.props.children}};function RenderedRoute({routeContext:l,match:c,children:d}){let h=Gt.useContext(jr);return h&&h.static&&h.staticContext&&(c.route.errorElement||c.route.ErrorBoundary)&&(h.staticContext._deepestRenderedBoundaryId=c.route.id),Gt.createElement(Gr.Provider,{value:l},d)}function getDataRouterConsoleError(l){return`${l} must be used within a data router.  See https://reactrouter.com/en/main/routers/picking-a-router.`}function useCurrentRouteId(l){let c=function(l){let c=Gt.useContext(Gr);return invariant(c,getDataRouterConsoleError(l)),c}(l),d=c.matches[c.matches.length-1];return invariant(d.route.id,`${l} can only be used on routes that contain a unique "id"`),d.route.id}var rn={};function warningOnce(l,c,d){c||rn[l]||(rn[l]=!0,warning(!1,d))}function Navigate({to:l,replace:c,state:d,relative:h}){invariant(useInRouterContext(),"<Navigate> may be used only in the context of a <Router> component.");let{static:p}=Gt.useContext(Vr);warning(!p,"<Navigate> must not be used on the initial render in a <StaticRouter>. This is a no-op, but you should modify your code so the <Navigate> is only ever rendered in response to some user interaction or state change.");let{matches:f}=Gt.useContext(Gr),{pathname:m}=useLocation(),y=useNavigate(),_=resolveTo(l,getResolveToMatches(f),m,"path"===h),b=JSON.stringify(_);return Gt.useEffect((()=>{y(JSON.parse(b),{replace:c,state:d,relative:h})}),[y,b,h,c,d]),null}function Route(l){invariant(!1,"A <Route> is only ever to be used as the child of <Routes> element, never rendered directly. Please wrap your <Route> in a <Routes>.")}function Router({basename:l="/",children:c=null,location:d,navigationType:h="POP",navigator:p,static:f=!1}){invariant(!useInRouterContext(),"You cannot render a <Router> inside another <Router>. You should never have more than one in your app.");let m=l.replace(/^\/*/,"/"),y=Gt.useMemo((()=>({basename:m,navigator:p,static:f,future:{}})),[m,p,f]);"string"==typeof d&&(d=parsePath(d));let{pathname:_="/",search:b="",hash:w="",state:E=null,key:M="default"}=d,N=Gt.useMemo((()=>{let l=stripBasename(_,m);return null==l?null:{location:{pathname:l,search:b,hash:w,state:E,key:M},navigationType:h}}),[m,_,b,w,E,M,h]);return warning(null!=N,`<Router basename="${m}"> is not able to match the URL "${_}${b}${w}" because it does not start with the basename, so the <Router> won't render anything.`),null==N?null:Gt.createElement(Vr.Provider,{value:y},Gt.createElement(Zr.Provider,{children:c,value:N}))}function Routes({children:l,location:c}){return useRoutesImpl(createRoutesFromChildren(l),c)}function createRoutesFromChildren(l,c=[]){let d=[];return Gt.Children.forEach(l,((l,h)=>{if(!Gt.isValidElement(l))return;let p=[...c,h];if(l.type===Gt.Fragment)return void d.push.apply(d,createRoutesFromChildren(l.props.children,p));invariant(l.type===Route,`[${"string"==typeof l.type?l.type:l.type.name}] is not a <Route> component. All component children of <Routes> must be a <Route> or <React.Fragment>`),invariant(!l.props.index||!l.props.children,"An index route cannot have child routes.");let f={id:l.props.id||p.join("-"),caseSensitive:l.props.caseSensitive,element:l.props.element,Component:l.props.Component,index:l.props.index,path:l.props.path,loader:l.props.loader,action:l.props.action,hydrateFallbackElement:l.props.hydrateFallbackElement,HydrateFallback:l.props.HydrateFallback,errorElement:l.props.errorElement,ErrorBoundary:l.props.ErrorBoundary,hasErrorBoundary:!0===l.props.hasErrorBoundary||null!=l.props.ErrorBoundary||null!=l.props.errorElement,shouldRevalidate:l.props.shouldRevalidate,handle:l.props.handle,lazy:l.props.lazy};l.props.children&&(f.children=createRoutesFromChildren(l.props.children,p)),d.push(f)})),d}Gt.memo((function({routes:l,future:c,state:d}){return useRoutesImpl(l,void 0,d,c)}));var nn="get",sn="application/x-www-form-urlencoded";function isHtmlElement(l){return null!=l&&"string"==typeof l.tagName}function createSearchParams(l=""){return new URLSearchParams("string"==typeof l||Array.isArray(l)||l instanceof URLSearchParams?l:Object.keys(l).reduce(((c,d)=>{let h=l[d];return c.concat(Array.isArray(h)?h.map((l=>[d,l])):[[d,h]])}),[]))}var an=null;var ln=new Set(["application/x-www-form-urlencoded","multipart/form-data","text/plain"]);function getFormEncType(l){return null==l||ln.has(l)?l:(warning(!1,`"${l}" is not a valid \`encType\` for \`<Form>\`/\`<fetcher.Form>\` and will default to "${sn}"`),null)}function getFormSubmissionInfo(l,c){let d,h,p,f,m;if(isHtmlElement(y=l)&&"form"===y.tagName.toLowerCase()){let m=l.getAttribute("action");h=m?stripBasename(m,c):null,d=l.getAttribute("method")||nn,p=getFormEncType(l.getAttribute("enctype"))||sn,f=new FormData(l)}else if(function(l){return isHtmlElement(l)&&"button"===l.tagName.toLowerCase()}(l)||function(l){return isHtmlElement(l)&&"input"===l.tagName.toLowerCase()}(l)&&("submit"===l.type||"image"===l.type)){let m=l.form;if(null==m)throw new Error('Cannot submit a <button> or <input type="submit"> without a <form>');let y=l.getAttribute("formaction")||m.getAttribute("action");if(h=y?stripBasename(y,c):null,d=l.getAttribute("formmethod")||m.getAttribute("method")||nn,p=getFormEncType(l.getAttribute("formenctype"))||getFormEncType(m.getAttribute("enctype"))||sn,f=new FormData(m,l),!function(){if(null===an)try{new FormData(document.createElement("form"),0),an=!1}catch(hh){an=!0}return an}()){let{name:c,type:d,value:h}=l;if("image"===d){let l=c?`${c}.`:"";f.append(`${l}x`,"0"),f.append(`${l}y`,"0")}else c&&f.append(c,h)}}else{if(isHtmlElement(l))throw new Error('Cannot submit element that is not <form>, <button>, or <input type="submit|image">');d=nn,h=null,p=sn,m=l}var y;return f&&"text/plain"===p&&(m=f,f=void 0),{action:h,method:d.toLowerCase(),encType:p,formData:f,body:m}}function invariant2(l,c){if(!1===l||null==l)throw new Error(c)}function isHtmlLinkDescriptor(l){return null!=l&&(null==l.href?"preload"===l.rel&&"string"==typeof l.imageSrcSet&&"string"==typeof l.imageSizes:"string"==typeof l.rel&&"string"==typeof l.href)}async function getKeyedPrefetchLinks(l,c,d){return function(l,c){let d=new Set;return new Set(c),l.reduce(((l,c)=>{let h=JSON.stringify(function(l){let c={},d=Object.keys(l).sort();for(let h of d)c[h]=l[h];return c}(c));return d.has(h)||(d.add(h),l.push({key:h,link:c})),l}),[])}((await Promise.all(l.map((async l=>{let h=c.routes[l.route.id];if(h){let l=await async function(l,c){if(l.id in c)return c[l.id];try{let d=await import(l.module);return c[l.id]=d,d}catch(d){return console.error(`Error loading route module \`${l.module}\`, reloading page...`),console.error(d),window.__reactRouterContext&&window.__reactRouterContext.isSpaMode,window.location.reload(),new Promise((()=>{}))}}(h,d);return l.links?l.links():[]}return[]})))).flat(1).filter(isHtmlLinkDescriptor).filter((l=>"stylesheet"===l.rel||"preload"===l.rel)).map((l=>"stylesheet"===l.rel?{...l,rel:"prefetch",as:"style"}:{...l,rel:"prefetch"})))}function getNewMatchesForLinks(l,c,d,h,p,f){let isNew=(l,c)=>!d[c]||l.route.id!==d[c].route.id,matchPathChanged=(l,c)=>d[c].pathname!==l.pathname||d[c].route.path?.endsWith("*")&&d[c].params["*"]!==l.params["*"];return"assets"===f?c.filter(((l,c)=>isNew(l,c)||matchPathChanged(l,c))):"data"===f?c.filter(((c,f)=>{let m=h.routes[c.route.id];if(!m||!m.hasLoader)return!1;if(isNew(c,f)||matchPathChanged(c,f))return!0;if(c.route.shouldRevalidate){let h=c.route.shouldRevalidate({currentUrl:new URL(p.pathname+p.search+p.hash,window.origin),currentParams:d[0]?.params||{},nextUrl:new URL(l,window.origin),nextParams:c.params,defaultShouldRevalidate:!0});if("boolean"==typeof h)return h}return!0})):[]}function getModuleLinkHrefs(l,c,{includeHydrateFallback:d}={}){return h=l.map((l=>{let h=c.routes[l.route.id];if(!h)return[];let p=[h.module];return h.clientActionModule&&(p=p.concat(h.clientActionModule)),h.clientLoaderModule&&(p=p.concat(h.clientLoaderModule)),d&&h.hydrateFallbackModule&&(p=p.concat(h.hydrateFallbackModule)),h.imports&&(p=p.concat(h.imports)),p})).flat(1),[...new Set(h)];var h}function useDataRouterContext2(){let l=Gt.useContext(jr);return invariant2(l,"You must render this element inside a <DataRouterContext.Provider> element"),l}Object.getOwnPropertyNames(Object.prototype).sort().join("\0");var un=Gt.createContext(void 0);function useFrameworkContext(){let l=Gt.useContext(un);return invariant2(l,"You must render this element inside a <HydratedRouter> element"),l}function composeEventHandlers$1(l,c){return d=>{l&&l(d),d.defaultPrevented||c(d)}}function PrefetchPageLinks({page:l,...c}){let{router:d}=useDataRouterContext2(),h=Gt.useMemo((()=>matchRoutes(d.routes,l,d.basename)),[d.routes,l,d.basename]);return h?Gt.createElement(PrefetchPageLinksImpl,{page:l,matches:h,...c}):null}function PrefetchPageLinksImpl({page:l,matches:c,...d}){let h=useLocation(),{manifest:p,routeModules:f}=useFrameworkContext(),{basename:m}=useDataRouterContext2(),{loaderData:y,matches:_}=function(){let l=Gt.useContext(zr);return invariant2(l,"You must render this element inside a <DataRouterStateContext.Provider> element"),l}(),b=Gt.useMemo((()=>getNewMatchesForLinks(l,c,_,p,h,"data")),[l,c,_,p,h]),w=Gt.useMemo((()=>getNewMatchesForLinks(l,c,_,p,h,"assets")),[l,c,_,p,h]),E=Gt.useMemo((()=>{if(l===h.pathname+h.search+h.hash)return[];let d=new Set,_=!1;if(c.forEach((l=>{let c=p.routes[l.route.id];c&&c.hasLoader&&(!b.some((c=>c.route.id===l.route.id))&&l.route.id in y&&f[l.route.id]?.shouldRevalidate||c.hasClientLoader?_=!0:d.add(l.route.id))})),0===d.size)return[];let w=function(l,c,d){let h="string"==typeof l?new URL(l,"undefined"==typeof window?"server://singlefetch/":window.location.origin):l;return"/"===h.pathname?h.pathname=`_root.${d}`:c&&"/"===stripBasename(h.pathname,c)?h.pathname=`${c.replace(/\/$/,"")}/_root.${d}`:h.pathname=`${h.pathname.replace(/\/$/,"")}.${d}`,h}(l,m,"data");return _&&d.size>0&&w.searchParams.set("_routes",c.filter((l=>d.has(l.route.id))).map((l=>l.route.id)).join(",")),[w.pathname+w.search]}),[m,y,h,p,b,c,l,f]),M=Gt.useMemo((()=>getModuleLinkHrefs(w,p)),[w,p]),N=function(l){let{manifest:c,routeModules:d}=useFrameworkContext(),[h,p]=Gt.useState([]);return Gt.useEffect((()=>{let h=!1;return getKeyedPrefetchLinks(l,c,d).then((l=>{h||p(l)})),()=>{h=!0}}),[l,c,d]),h}(w);return Gt.createElement(Gt.Fragment,null,E.map((l=>Gt.createElement("link",{key:l,rel:"prefetch",as:"fetch",href:l,...d}))),M.map((l=>Gt.createElement("link",{key:l,rel:"modulepreload",href:l,...d}))),N.map((({key:l,link:c})=>Gt.createElement("link",{key:l,...c}))))}function mergeRefs(...l){return c=>{l.forEach((l=>{"function"==typeof l?l(c):null!=l&&(l.current=c)}))}}un.displayName="FrameworkContext";var dn="undefined"!=typeof window&&void 0!==window.document&&void 0!==window.document.createElement;try{dn&&(window.__reactRouterVersion="7.7.0")}catch(hh){}function BrowserRouter({basename:l,children:c,window:d}){let h=Gt.useRef();null==h.current&&(h.current=createBrowserHistory({window:d,v5Compat:!0}));let p=h.current,[f,m]=Gt.useState({action:p.action,location:p.location}),y=Gt.useCallback((l=>{Gt.startTransition((()=>m(l)))}),[m]);return Gt.useLayoutEffect((()=>p.listen(y)),[p,y]),Gt.createElement(Router,{basename:l,children:c,location:f.location,navigationType:f.action,navigator:p})}var hn=/^(?:[a-z][a-z0-9+.-]*:|\/\/)/i,pn=Gt.forwardRef((function({onClick:l,discover:c="render",prefetch:d="none",relative:h,reloadDocument:p,replace:f,state:m,target:y,to:_,preventScrollReset:b,viewTransition:w,...E},M){let N,{basename:P}=Gt.useContext(Vr),L="string"==typeof _&&hn.test(_),j=!1;if("string"==typeof _&&L&&(N=_,dn))try{let l=new URL(window.location.href),c=_.startsWith("//")?new URL(l.protocol+_):new URL(_),d=stripBasename(c.pathname,P);c.origin===l.origin&&null!=d?_=d+c.search+c.hash:j=!0}catch(hh){warning(!1,`<Link to="${_}"> contains an invalid URL which will probably break when clicked - please update to a valid URL path.`)}let D=function(l,{relative:c}={}){invariant(useInRouterContext(),"useHref() may be used only in the context of a <Router> component.");let{basename:d,navigator:h}=Gt.useContext(Vr),{hash:p,pathname:f,search:m}=useResolvedPath(l,{relative:c}),y=f;return"/"!==d&&(y="/"===f?d:joinPaths([d,f])),h.createHref({pathname:y,search:m,hash:p})}(_,{relative:h}),[F,U,B]=function(l,c){let d=Gt.useContext(un),[h,p]=Gt.useState(!1),[f,m]=Gt.useState(!1),{onFocus:y,onBlur:_,onMouseEnter:b,onMouseLeave:w,onTouchStart:E}=c,M=Gt.useRef(null);Gt.useEffect((()=>{if("render"===l&&m(!0),"viewport"===l){let l=new IntersectionObserver((l=>{l.forEach((l=>{m(l.isIntersecting)}))}),{threshold:.5});return M.current&&l.observe(M.current),()=>{l.disconnect()}}}),[l]),Gt.useEffect((()=>{if(h){let l=setTimeout((()=>{m(!0)}),100);return()=>{clearTimeout(l)}}}),[h]);let setIntent=()=>{p(!0)},cancelIntent=()=>{p(!1),m(!1)};return d?"intent"!==l?[f,M,{}]:[f,M,{onFocus:composeEventHandlers$1(y,setIntent),onBlur:composeEventHandlers$1(_,cancelIntent),onMouseEnter:composeEventHandlers$1(b,setIntent),onMouseLeave:composeEventHandlers$1(w,cancelIntent),onTouchStart:composeEventHandlers$1(E,setIntent)}]:[!1,M,{}]}(d,E),H=function(l,{target:c,replace:d,state:h,preventScrollReset:p,relative:f,viewTransition:m}={}){let y=useNavigate(),_=useLocation(),b=useResolvedPath(l,{relative:f});return Gt.useCallback((w=>{if(function(l,c){return!(0!==l.button||c&&"_self"!==c||function(l){return!!(l.metaKey||l.altKey||l.ctrlKey||l.shiftKey)}(l))}(w,c)){w.preventDefault();let c=void 0!==d?d:createPath(_)===createPath(b);y(l,{replace:c,state:h,preventScrollReset:p,relative:f,viewTransition:m})}}),[_,y,b,d,h,c,l,p,f,m])}(_,{replace:f,state:m,target:y,preventScrollReset:b,relative:h,viewTransition:w});let z=Gt.createElement("a",{...E,...B,href:N||D,onClick:j||p?l:function(c){l&&l(c),c.defaultPrevented||H(c)},ref:mergeRefs(M,U),target:y,"data-discover":L||"render"!==c?void 0:"true"});return F&&!L?Gt.createElement(Gt.Fragment,null,z,Gt.createElement(PrefetchPageLinks,{page:D})):z}));pn.displayName="Link",Gt.forwardRef((function({"aria-current":l="page",caseSensitive:c=!1,className:d="",end:h=!1,style:p,to:f,viewTransition:m,children:y,..._},b){let w=useResolvedPath(f,{relative:_.relative}),E=useLocation(),M=Gt.useContext(zr),{navigator:N,basename:P}=Gt.useContext(Vr),L=null!=M&&function(l,c={}){let d=Gt.useContext(qr);invariant(null!=d,"`useViewTransitionState` must be used within `react-router-dom`'s `RouterProvider`.  Did you accidentally import `RouterProvider` from `react-router`?");let{basename:h}=useDataRouterContext3("useViewTransitionState"),p=useResolvedPath(l,{relative:c.relative});if(!d.isTransitioning)return!1;let f=stripBasename(d.currentLocation.pathname,h)||d.currentLocation.pathname,m=stripBasename(d.nextLocation.pathname,h)||d.nextLocation.pathname;return null!=matchPath(p.pathname,m)||null!=matchPath(p.pathname,f)}(w)&&!0===m,j=N.encodeLocation?N.encodeLocation(w).pathname:w.pathname,D=E.pathname,F=M&&M.navigation&&M.navigation.location?M.navigation.location.pathname:null;c||(D=D.toLowerCase(),F=F?F.toLowerCase():null,j=j.toLowerCase()),F&&P&&(F=stripBasename(F,P)||F);const U="/"!==j&&j.endsWith("/")?j.length-1:j.length;let B,H=D===j||!h&&D.startsWith(j)&&"/"===D.charAt(U),z=null!=F&&(F===j||!h&&F.startsWith(j)&&"/"===F.charAt(j.length)),q={isActive:H,isPending:z,isTransitioning:L},V=H?l:void 0;B="function"==typeof d?d(q):[d,H?"active":null,z?"pending":null,L?"transitioning":null].filter(Boolean).join(" ");let Z="function"==typeof p?p(q):p;return Gt.createElement(pn,{..._,"aria-current":V,className:B,ref:b,style:Z,to:f,viewTransition:m},"function"==typeof y?y(q):y)})).displayName="NavLink";var wn=Gt.forwardRef((({discover:l="render",fetcherKey:c,navigate:d,reloadDocument:h,replace:p,state:f,method:m=nn,action:y,onSubmit:_,relative:b,preventScrollReset:w,viewTransition:E,...M},N)=>{let P=function(){let{router:l}=useDataRouterContext3("useSubmit"),{basename:c}=Gt.useContext(Vr),d=useCurrentRouteId("useRouteId");return Gt.useCallback((async(h,p={})=>{let{action:f,method:m,encType:y,formData:_,body:b}=getFormSubmissionInfo(h,c);if(!1===p.navigate){let c=p.fetcherKey||getUniqueFetcherId();await l.fetch(c,d,p.action||f,{preventScrollReset:p.preventScrollReset,formData:_,body:b,formMethod:p.method||m,formEncType:p.encType||y,flushSync:p.flushSync})}else await l.navigate(p.action||f,{preventScrollReset:p.preventScrollReset,formData:_,body:b,formMethod:p.method||m,formEncType:p.encType||y,replace:p.replace,state:p.state,fromRouteId:d,flushSync:p.flushSync,viewTransition:p.viewTransition})}),[l,c,d])}(),L=function(l,{relative:c}={}){let{basename:d}=Gt.useContext(Vr),h=Gt.useContext(Gr);invariant(h,"useFormAction must be used inside a RouteContext");let[p]=h.matches.slice(-1),f={...useResolvedPath(l||".",{relative:c})},m=useLocation();if(null==l){f.search=m.search;let l=new URLSearchParams(f.search),c=l.getAll("index");if(c.some((l=>""===l))){l.delete("index"),c.filter((l=>l)).forEach((c=>l.append("index",c)));let d=l.toString();f.search=d?`?${d}`:""}}l&&"."!==l||!p.route.index||(f.search=f.search?f.search.replace(/^\?/,"?index&"):"?index");"/"!==d&&(f.pathname="/"===f.pathname?d:joinPaths([d,f.pathname]));return createPath(f)}(y,{relative:b}),j="get"===m.toLowerCase()?"get":"post",D="string"==typeof y&&hn.test(y);return Gt.createElement("form",{ref:N,method:j,action:L,onSubmit:h?_:l=>{if(_&&_(l),l.defaultPrevented)return;l.preventDefault();let h=l.nativeEvent.submitter,y=h?.getAttribute("formmethod")||m;P(h||l.currentTarget,{fetcherKey:c,method:y,navigate:d,replace:p,state:f,relative:b,preventScrollReset:w,viewTransition:E})},...M,"data-discover":D||"render"!==l?void 0:"true"})}));function useDataRouterContext3(l){let c=Gt.useContext(jr);return invariant(c,function(l){return`${l} must be used within a data router.  See https://reactrouter.com/en/main/routers/picking-a-router.`}(l)),c}function useSearchParams(l){warning("undefined"!=typeof URLSearchParams,"You cannot use the `useSearchParams` hook in a browser that does not support the URLSearchParams API. If you need to support Internet Explorer 11, we recommend you load a polyfill such as https://github.com/ungap/url-search-params.");let c=Gt.useRef(createSearchParams(l)),d=Gt.useRef(!1),h=useLocation(),p=Gt.useMemo((()=>function(l,c){let d=createSearchParams(l);return c&&c.forEach(((l,h)=>{d.has(h)||c.getAll(h).forEach((l=>{d.append(h,l)}))})),d}(h.search,d.current?null:c.current)),[h.search]),f=useNavigate(),m=Gt.useCallback(((l,c)=>{const h=createSearchParams("function"==typeof l?l(new URLSearchParams(p)):l);d.current=!0,f("?"+h,c)}),[f,p]);return[p,m]}wn.displayName="Form";var Cn=0,getUniqueFetcherId=()=>`__${String(++Cn)}__`;var On=class{constructor(){this.listeners=new Set,this.subscribe=this.subscribe.bind(this)}subscribe(l){return this.listeners.add(l),this.onSubscribe(),()=>{this.listeners.delete(l),this.onUnsubscribe()}}hasListeners(){return this.listeners.size>0}onSubscribe(){}onUnsubscribe(){}},Ln="undefined"==typeof window||"Deno"in globalThis;function noop$4(){}function isValidTimeout(l){return"number"==typeof l&&l>=0&&l!==1/0}function timeUntilStale(l,c){return Math.max(l+(c||0)-Date.now(),0)}function resolveStaleTime(l,c){return"function"==typeof l?l(c):l}function resolveEnabled(l,c){return"function"==typeof l?l(c):l}function matchQuery(l,c){const{type:d="all",exact:h,fetchStatus:p,predicate:f,queryKey:m,stale:y}=l;if(m)if(h){if(c.queryHash!==hashQueryKeyByOptions(m,c.options))return!1}else if(!partialMatchKey(c.queryKey,m))return!1;if("all"!==d){const l=c.isActive();if("active"===d&&!l)return!1;if("inactive"===d&&l)return!1}return("boolean"!=typeof y||c.isStale()===y)&&((!p||p===c.state.fetchStatus)&&!(f&&!f(c)))}function matchMutation(l,c){const{exact:d,status:h,predicate:p,mutationKey:f}=l;if(f){if(!c.options.mutationKey)return!1;if(d){if(hashKey(c.options.mutationKey)!==hashKey(f))return!1}else if(!partialMatchKey(c.options.mutationKey,f))return!1}return(!h||c.state.status===h)&&!(p&&!p(c))}function hashQueryKeyByOptions(l,c){return(c?.queryKeyHashFn||hashKey)(l)}function hashKey(l){return JSON.stringify(l,((l,c)=>isPlainObject$5(c)?Object.keys(c).sort().reduce(((l,d)=>(l[d]=c[d],l)),{}):c))}function partialMatchKey(l,c){return l===c||typeof l==typeof c&&(!(!l||!c||"object"!=typeof l||"object"!=typeof c)&&Object.keys(c).every((d=>partialMatchKey(l[d],c[d]))))}function replaceEqualDeep(l,c){if(l===c)return l;const d=isPlainArray(l)&&isPlainArray(c);if(d||isPlainObject$5(l)&&isPlainObject$5(c)){const h=d?l:Object.keys(l),p=h.length,f=d?c:Object.keys(c),m=f.length,y=d?[]:{},_=new Set(h);let b=0;for(let w=0;w<m;w++){const h=d?w:f[w];(!d&&_.has(h)||d)&&void 0===l[h]&&void 0===c[h]?(y[h]=void 0,b++):(y[h]=replaceEqualDeep(l[h],c[h]),y[h]===l[h]&&void 0!==l[h]&&b++)}return p===m&&b===p?l:y}return c}function shallowEqualObjects(l,c){if(!c||Object.keys(l).length!==Object.keys(c).length)return!1;for(const d in l)if(l[d]!==c[d])return!1;return!0}function isPlainArray(l){return Array.isArray(l)&&l.length===Object.keys(l).length}function isPlainObject$5(l){if(!hasObjectPrototype(l))return!1;const c=l.constructor;if(void 0===c)return!0;const d=c.prototype;return!!hasObjectPrototype(d)&&(!!d.hasOwnProperty("isPrototypeOf")&&Object.getPrototypeOf(l)===Object.prototype)}function hasObjectPrototype(l){return"[object Object]"===Object.prototype.toString.call(l)}function replaceData(l,c,d){return"function"==typeof d.structuralSharing?d.structuralSharing(l,c):!1!==d.structuralSharing?replaceEqualDeep(l,c):c}function addToEnd(l,c,d=0){const h=[...l,c];return d&&h.length>d?h.slice(1):h}function addToStart(l,c,d=0){const h=[c,...l];return d&&h.length>d?h.slice(0,-1):h}var jn=Symbol();function ensureQueryFn(l,c){return!l.queryFn&&c?.initialPromise?()=>c.initialPromise:l.queryFn&&l.queryFn!==jn?l.queryFn:()=>Promise.reject(new Error(`Missing queryFn: '${l.queryHash}'`))}function shouldThrowError(l,c){return"function"==typeof l?l(...c):!!l}var Dn=new(h=class extends On{constructor(){super(),__privateAdd(this,l),__privateAdd(this,c),__privateAdd(this,d),__privateSet(this,d,(l=>{if(!Ln&&window.addEventListener){const listener2=()=>l();return window.addEventListener("visibilitychange",listener2,!1),()=>{window.removeEventListener("visibilitychange",listener2)}}}))}onSubscribe(){__privateGet(this,c)||this.setEventListener(__privateGet(this,d))}onUnsubscribe(){var l;this.hasListeners()||(null==(l=__privateGet(this,c))||l.call(this),__privateSet(this,c,void 0))}setEventListener(l){var h;__privateSet(this,d,l),null==(h=__privateGet(this,c))||h.call(this),__privateSet(this,c,l((l=>{"boolean"==typeof l?this.setFocused(l):this.onFocus()})))}setFocused(c){__privateGet(this,l)!==c&&(__privateSet(this,l,c),this.onFocus())}onFocus(){const l=this.isFocused();this.listeners.forEach((c=>{c(l)}))}isFocused(){return"boolean"==typeof __privateGet(this,l)?__privateGet(this,l):"hidden"!==globalThis.document?.visibilityState}},l=new WeakMap,c=new WeakMap,d=new WeakMap,h),Fn=new(y=class extends On{constructor(){super(),__privateAdd(this,p,!0),__privateAdd(this,f),__privateAdd(this,m),__privateSet(this,m,(l=>{if(!Ln&&window.addEventListener){const onlineListener=()=>l(!0),offlineListener=()=>l(!1);return window.addEventListener("online",onlineListener,!1),window.addEventListener("offline",offlineListener,!1),()=>{window.removeEventListener("online",onlineListener),window.removeEventListener("offline",offlineListener)}}}))}onSubscribe(){__privateGet(this,f)||this.setEventListener(__privateGet(this,m))}onUnsubscribe(){var l;this.hasListeners()||(null==(l=__privateGet(this,f))||l.call(this),__privateSet(this,f,void 0))}setEventListener(l){var c;__privateSet(this,m,l),null==(c=__privateGet(this,f))||c.call(this),__privateSet(this,f,l(this.setOnline.bind(this)))}setOnline(l){__privateGet(this,p)!==l&&(__privateSet(this,p,l),this.listeners.forEach((c=>{c(l)})))}isOnline(){return __privateGet(this,p)}},p=new WeakMap,f=new WeakMap,m=new WeakMap,y);function pendingThenable(){let l,c;const d=new Promise(((d,h)=>{l=d,c=h}));function finalize2(l){Object.assign(d,l),delete d.resolve,delete d.reject}return d.status="pending",d.catch((()=>{})),d.resolve=c=>{finalize2({status:"fulfilled",value:c}),l(c)},d.reject=l=>{finalize2({status:"rejected",reason:l}),c(l)},d}function defaultRetryDelay(l){return Math.min(1e3*2**l,3e4)}function canFetch(l){return"online"!==(l??"online")||Fn.isOnline()}var $n=class extends Error{constructor(l){super("CancelledError"),this.revert=l?.revert,this.silent=l?.silent}};function isCancelledError(l){return l instanceof $n}function createRetryer(l){let c,d=!1,h=0,p=!1;const f=pendingThenable(),canContinue=()=>Dn.isFocused()&&("always"===l.networkMode||Fn.isOnline())&&l.canRun(),canStart=()=>canFetch(l.networkMode)&&l.canRun(),resolve=d=>{p||(p=!0,l.onSuccess?.(d),c?.(),f.resolve(d))},reject=d=>{p||(p=!0,l.onError?.(d),c?.(),f.reject(d))},pause=()=>new Promise((d=>{c=l=>{(p||canContinue())&&d(l)},l.onPause?.()})).then((()=>{c=void 0,p||l.onContinue?.()})),run=()=>{if(p)return;let c;const f=0===h?l.initialPromise:void 0;try{c=f??l.fn()}catch(m){c=Promise.reject(m)}Promise.resolve(c).then(resolve).catch((c=>{if(p)return;const f=l.retry??(Ln?0:3),m=l.retryDelay??defaultRetryDelay,y="function"==typeof m?m(h,c):m,_=!0===f||"number"==typeof f&&h<f||"function"==typeof f&&f(h,c);var b;!d&&_?(h++,l.onFail?.(h,c),(b=y,new Promise((l=>{setTimeout(l,b)}))).then((()=>canContinue()?void 0:pause())).then((()=>{d?reject(c):run()}))):reject(c)}))};return{promise:f,cancel:c=>{p||(reject(new $n(c)),l.abort?.())},continue:()=>(c?.(),f),cancelRetry:()=>{d=!0},continueRetry:()=>{d=!1},canStart:canStart,start:()=>(canStart()?run():pause().then(run),f)}}var defaultScheduler=l=>setTimeout(l,0);var Un=function(){let l=[],c=0,notifyFn=l=>{l()},batchNotifyFn=l=>{l()},d=defaultScheduler;const schedule=h=>{c?l.push(h):d((()=>{notifyFn(h)}))};return{batch:h=>{let p;c++;try{p=h()}finally{c--,c||(()=>{const c=l;l=[],c.length&&d((()=>{batchNotifyFn((()=>{c.forEach((l=>{notifyFn(l)}))}))}))})()}return p},batchCalls:l=>(...c)=>{schedule((()=>{l(...c)}))},schedule:schedule,setNotifyFunction:l=>{notifyFn=l},setBatchNotifyFunction:l=>{batchNotifyFn=l},setScheduler:l=>{d=l}}}(),Bn=(b=class{constructor(){__privateAdd(this,_)}destroy(){this.clearGcTimeout()}scheduleGc(){this.clearGcTimeout(),isValidTimeout(this.gcTime)&&__privateSet(this,_,setTimeout((()=>{this.optionalRemove()}),this.gcTime))}updateGcTime(l){this.gcTime=Math.max(this.gcTime||0,l??(Ln?1/0:3e5))}clearGcTimeout(){__privateGet(this,_)&&(clearTimeout(__privateGet(this,_)),__privateSet(this,_,void 0))}},_=new WeakMap,b),Hn=(U=class extends Bn{constructor(l){super(),__privateAdd(this,D),__privateAdd(this,w),__privateAdd(this,E),__privateAdd(this,M),__privateAdd(this,N),__privateAdd(this,P),__privateAdd(this,L),__privateAdd(this,j),__privateSet(this,j,!1),__privateSet(this,L,l.defaultOptions),this.setOptions(l.options),this.observers=[],__privateSet(this,N,l.client),__privateSet(this,M,__privateGet(this,N).getQueryCache()),this.queryKey=l.queryKey,this.queryHash=l.queryHash,__privateSet(this,w,function(l){const c="function"==typeof l.initialData?l.initialData():l.initialData,d=void 0!==c,h=d?"function"==typeof l.initialDataUpdatedAt?l.initialDataUpdatedAt():l.initialDataUpdatedAt:0;return{data:c,dataUpdateCount:0,dataUpdatedAt:d?h??Date.now():0,error:null,errorUpdateCount:0,errorUpdatedAt:0,fetchFailureCount:0,fetchFailureReason:null,fetchMeta:null,isInvalidated:!1,status:d?"success":"pending",fetchStatus:"idle"}}(this.options)),this.state=l.state??__privateGet(this,w),this.scheduleGc()}get meta(){return this.options.meta}get promise(){return __privateGet(this,P)?.promise}setOptions(l){this.options={...__privateGet(this,L),...l},this.updateGcTime(this.options.gcTime)}optionalRemove(){this.observers.length||"idle"!==this.state.fetchStatus||__privateGet(this,M).remove(this)}setData(l,c){const d=replaceData(this.state.data,l,this.options);return __privateMethod(this,D,F).call(this,{data:d,type:"success",dataUpdatedAt:c?.updatedAt,manual:c?.manual}),d}setState(l,c){__privateMethod(this,D,F).call(this,{type:"setState",state:l,setStateOptions:c})}cancel(l){const c=__privateGet(this,P)?.promise;return __privateGet(this,P)?.cancel(l),c?c.then(noop$4).catch(noop$4):Promise.resolve()}destroy(){super.destroy(),this.cancel({silent:!0})}reset(){this.destroy(),this.setState(__privateGet(this,w))}isActive(){return this.observers.some((l=>!1!==resolveEnabled(l.options.enabled,this)))}isDisabled(){return this.getObserversCount()>0?!this.isActive():this.options.queryFn===jn||this.state.dataUpdateCount+this.state.errorUpdateCount===0}isStatic(){return this.getObserversCount()>0&&this.observers.some((l=>"static"===resolveStaleTime(l.options.staleTime,this)))}isStale(){return this.getObserversCount()>0?this.observers.some((l=>l.getCurrentResult().isStale)):void 0===this.state.data||this.state.isInvalidated}isStaleByTime(l=0){return void 0===this.state.data||"static"!==l&&(!!this.state.isInvalidated||!timeUntilStale(this.state.dataUpdatedAt,l))}onFocus(){const l=this.observers.find((l=>l.shouldFetchOnWindowFocus()));l?.refetch({cancelRefetch:!1}),__privateGet(this,P)?.continue()}onOnline(){const l=this.observers.find((l=>l.shouldFetchOnReconnect()));l?.refetch({cancelRefetch:!1}),__privateGet(this,P)?.continue()}addObserver(l){this.observers.includes(l)||(this.observers.push(l),this.clearGcTimeout(),__privateGet(this,M).notify({type:"observerAdded",query:this,observer:l}))}removeObserver(l){this.observers.includes(l)&&(this.observers=this.observers.filter((c=>c!==l)),this.observers.length||(__privateGet(this,P)&&(__privateGet(this,j)?__privateGet(this,P).cancel({revert:!0}):__privateGet(this,P).cancelRetry()),this.scheduleGc()),__privateGet(this,M).notify({type:"observerRemoved",query:this,observer:l}))}getObserversCount(){return this.observers.length}invalidate(){this.state.isInvalidated||__privateMethod(this,D,F).call(this,{type:"invalidate"})}fetch(l,c){if("idle"!==this.state.fetchStatus)if(void 0!==this.state.data&&c?.cancelRefetch)this.cancel({silent:!0});else if(__privateGet(this,P))return __privateGet(this,P).continueRetry(),__privateGet(this,P).promise;if(l&&this.setOptions(l),!this.options.queryFn){const l=this.observers.find((l=>l.options.queryFn));l&&this.setOptions(l.options)}const d=new AbortController,addSignalProperty=l=>{Object.defineProperty(l,"signal",{enumerable:!0,get:()=>(__privateSet(this,j,!0),d.signal)})},fetchFn=()=>{const l=ensureQueryFn(this.options,c),d=(()=>{const l={client:__privateGet(this,N),queryKey:this.queryKey,meta:this.meta};return addSignalProperty(l),l})();return __privateSet(this,j,!1),this.options.persister?this.options.persister(l,d,this):l(d)},h=(()=>{const l={fetchOptions:c,options:this.options,queryKey:this.queryKey,client:__privateGet(this,N),state:this.state,fetchFn:fetchFn};return addSignalProperty(l),l})();this.options.behavior?.onFetch(h,this),__privateSet(this,E,this.state),"idle"!==this.state.fetchStatus&&this.state.fetchMeta===h.fetchOptions?.meta||__privateMethod(this,D,F).call(this,{type:"fetch",meta:h.fetchOptions?.meta});const onError=l=>{isCancelledError(l)&&l.silent||__privateMethod(this,D,F).call(this,{type:"error",error:l}),isCancelledError(l)||(__privateGet(this,M).config.onError?.(l,this),__privateGet(this,M).config.onSettled?.(this.state.data,l,this)),this.scheduleGc()};return __privateSet(this,P,createRetryer({initialPromise:c?.initialPromise,fn:h.fetchFn,abort:d.abort.bind(d),onSuccess:l=>{if(void 0!==l){try{this.setData(l)}catch(c){return void onError(c)}__privateGet(this,M).config.onSuccess?.(l,this),__privateGet(this,M).config.onSettled?.(l,this.state.error,this),this.scheduleGc()}else onError(new Error(`${this.queryHash} data is undefined`))},onError:onError,onFail:(l,c)=>{__privateMethod(this,D,F).call(this,{type:"failed",failureCount:l,error:c})},onPause:()=>{__privateMethod(this,D,F).call(this,{type:"pause"})},onContinue:()=>{__privateMethod(this,D,F).call(this,{type:"continue"})},retry:h.options.retry,retryDelay:h.options.retryDelay,networkMode:h.options.networkMode,canRun:()=>!0})),__privateGet(this,P).start()}},w=new WeakMap,E=new WeakMap,M=new WeakMap,N=new WeakMap,P=new WeakMap,L=new WeakMap,j=new WeakMap,D=new WeakSet,F=function(l){this.state=(c=>{switch(l.type){case"failed":return{...c,fetchFailureCount:l.failureCount,fetchFailureReason:l.error};case"pause":return{...c,fetchStatus:"paused"};case"continue":return{...c,fetchStatus:"fetching"};case"fetch":return{...c,...fetchState(c.data,this.options),fetchMeta:l.meta??null};case"success":return{...c,data:l.data,dataUpdateCount:c.dataUpdateCount+1,dataUpdatedAt:l.dataUpdatedAt??Date.now(),error:null,isInvalidated:!1,status:"success",...!l.manual&&{fetchStatus:"idle",fetchFailureCount:0,fetchFailureReason:null}};case"error":const d=l.error;return isCancelledError(d)&&d.revert&&__privateGet(this,E)?{...__privateGet(this,E),fetchStatus:"idle"}:{...c,error:d,errorUpdateCount:c.errorUpdateCount+1,errorUpdatedAt:Date.now(),fetchFailureCount:c.fetchFailureCount+1,fetchFailureReason:d,fetchStatus:"idle",status:"error"};case"invalidate":return{...c,isInvalidated:!0};case"setState":return{...c,...l.state}}})(this.state),Un.batch((()=>{this.observers.forEach((l=>{l.onQueryUpdate()})),__privateGet(this,M).notify({query:this,type:"updated",action:l})}))},U);function fetchState(l,c){return{fetchFailureCount:0,fetchFailureReason:null,fetchStatus:canFetch(c.networkMode)?"fetching":"paused",...void 0===l&&{error:null,status:"pending"}}}var zn=(H=class extends On{constructor(l={}){super(),__privateAdd(this,B),this.config=l,__privateSet(this,B,new Map)}build(l,c,d){const h=c.queryKey,p=c.queryHash??hashQueryKeyByOptions(h,c);let f=this.get(p);return f||(f=new Hn({client:l,queryKey:h,queryHash:p,options:l.defaultQueryOptions(c),state:d,defaultOptions:l.getQueryDefaults(h)}),this.add(f)),f}add(l){__privateGet(this,B).has(l.queryHash)||(__privateGet(this,B).set(l.queryHash,l),this.notify({type:"added",query:l}))}remove(l){const c=__privateGet(this,B).get(l.queryHash);c&&(l.destroy(),c===l&&__privateGet(this,B).delete(l.queryHash),this.notify({type:"removed",query:l}))}clear(){Un.batch((()=>{this.getAll().forEach((l=>{this.remove(l)}))}))}get(l){return __privateGet(this,B).get(l)}getAll(){return[...__privateGet(this,B).values()]}find(l){const c={exact:!0,...l};return this.getAll().find((l=>matchQuery(c,l)))}findAll(l={}){const c=this.getAll();return Object.keys(l).length>0?c.filter((c=>matchQuery(l,c))):c}notify(l){Un.batch((()=>{this.listeners.forEach((c=>{c(l)}))}))}onFocus(){Un.batch((()=>{this.getAll().forEach((l=>{l.onFocus()}))}))}onOnline(){Un.batch((()=>{this.getAll().forEach((l=>{l.onOnline()}))}))}},B=new WeakMap,H),qn=(Y=class extends Bn{constructor(l){super(),__privateAdd(this,Z),__privateAdd(this,z),__privateAdd(this,q),__privateAdd(this,V),this.mutationId=l.mutationId,__privateSet(this,q,l.mutationCache),__privateSet(this,z,[]),this.state=l.state||{context:void 0,data:void 0,error:null,failureCount:0,failureReason:null,isPaused:!1,status:"idle",variables:void 0,submittedAt:0},this.setOptions(l.options),this.scheduleGc()}setOptions(l){this.options=l,this.updateGcTime(this.options.gcTime)}get meta(){return this.options.meta}addObserver(l){__privateGet(this,z).includes(l)||(__privateGet(this,z).push(l),this.clearGcTimeout(),__privateGet(this,q).notify({type:"observerAdded",mutation:this,observer:l}))}removeObserver(l){__privateSet(this,z,__privateGet(this,z).filter((c=>c!==l))),this.scheduleGc(),__privateGet(this,q).notify({type:"observerRemoved",mutation:this,observer:l})}optionalRemove(){__privateGet(this,z).length||("pending"===this.state.status?this.scheduleGc():__privateGet(this,q).remove(this))}continue(){return __privateGet(this,V)?.continue()??this.execute(this.state.variables)}async execute(l){const onContinue=()=>{__privateMethod(this,Z,K).call(this,{type:"continue"})};__privateSet(this,V,createRetryer({fn:()=>this.options.mutationFn?this.options.mutationFn(l):Promise.reject(new Error("No mutationFn found")),onFail:(l,c)=>{__privateMethod(this,Z,K).call(this,{type:"failed",failureCount:l,error:c})},onPause:()=>{__privateMethod(this,Z,K).call(this,{type:"pause"})},onContinue:onContinue,retry:this.options.retry??0,retryDelay:this.options.retryDelay,networkMode:this.options.networkMode,canRun:()=>__privateGet(this,q).canRun(this)}));const c="pending"===this.state.status,d=!__privateGet(this,V).canStart();try{if(c)onContinue();else{__privateMethod(this,Z,K).call(this,{type:"pending",variables:l,isPaused:d}),await(__privateGet(this,q).config.onMutate?.(l,this));const c=await(this.options.onMutate?.(l));c!==this.state.context&&__privateMethod(this,Z,K).call(this,{type:"pending",context:c,variables:l,isPaused:d})}const h=await __privateGet(this,V).start();return await(__privateGet(this,q).config.onSuccess?.(h,l,this.state.context,this)),await(this.options.onSuccess?.(h,l,this.state.context)),await(__privateGet(this,q).config.onSettled?.(h,null,this.state.variables,this.state.context,this)),await(this.options.onSettled?.(h,null,l,this.state.context)),__privateMethod(this,Z,K).call(this,{type:"success",data:h}),h}catch(h){try{throw await(__privateGet(this,q).config.onError?.(h,l,this.state.context,this)),await(this.options.onError?.(h,l,this.state.context)),await(__privateGet(this,q).config.onSettled?.(void 0,h,this.state.variables,this.state.context,this)),await(this.options.onSettled?.(void 0,h,l,this.state.context)),h}finally{__privateMethod(this,Z,K).call(this,{type:"error",error:h})}}finally{__privateGet(this,q).runNext(this)}}},z=new WeakMap,q=new WeakMap,V=new WeakMap,Z=new WeakSet,K=function(l){this.state=(c=>{switch(l.type){case"failed":return{...c,failureCount:l.failureCount,failureReason:l.error};case"pause":return{...c,isPaused:!0};case"continue":return{...c,isPaused:!1};case"pending":return{...c,context:l.context,data:void 0,failureCount:0,failureReason:null,error:null,isPaused:l.isPaused,status:"pending",variables:l.variables,submittedAt:Date.now()};case"success":return{...c,data:l.data,failureCount:0,failureReason:null,error:null,status:"success",isPaused:!1};case"error":return{...c,data:void 0,error:l.error,failureCount:c.failureCount+1,failureReason:l.error,isPaused:!1,status:"error"}}})(this.state),Un.batch((()=>{__privateGet(this,z).forEach((c=>{c.onMutationUpdate(l)})),__privateGet(this,q).notify({mutation:this,type:"updated",action:l})}))},Y);var Wn=(ie=class extends On{constructor(l={}){super(),__privateAdd(this,ee),__privateAdd(this,ne),__privateAdd(this,se),this.config=l,__privateSet(this,ee,new Set),__privateSet(this,ne,new Map),__privateSet(this,se,0)}build(l,c,d){const h=new qn({mutationCache:this,mutationId:++__privateWrapper(this,se)._,options:l.defaultMutationOptions(c),state:d});return this.add(h),h}add(l){__privateGet(this,ee).add(l);const c=scopeFor(l);if("string"==typeof c){const d=__privateGet(this,ne).get(c);d?d.push(l):__privateGet(this,ne).set(c,[l])}this.notify({type:"added",mutation:l})}remove(l){if(__privateGet(this,ee).delete(l)){const c=scopeFor(l);if("string"==typeof c){const d=__privateGet(this,ne).get(c);if(d)if(d.length>1){const c=d.indexOf(l);-1!==c&&d.splice(c,1)}else d[0]===l&&__privateGet(this,ne).delete(c)}}this.notify({type:"removed",mutation:l})}canRun(l){const c=scopeFor(l);if("string"==typeof c){const d=__privateGet(this,ne).get(c),h=d?.find((l=>"pending"===l.state.status));return!h||h===l}return!0}runNext(l){const c=scopeFor(l);if("string"==typeof c){const d=__privateGet(this,ne).get(c)?.find((c=>c!==l&&c.state.isPaused));return d?.continue()??Promise.resolve()}return Promise.resolve()}clear(){Un.batch((()=>{__privateGet(this,ee).forEach((l=>{this.notify({type:"removed",mutation:l})})),__privateGet(this,ee).clear(),__privateGet(this,ne).clear()}))}getAll(){return Array.from(__privateGet(this,ee))}find(l){const c={exact:!0,...l};return this.getAll().find((l=>matchMutation(c,l)))}findAll(l={}){return this.getAll().filter((c=>matchMutation(l,c)))}notify(l){Un.batch((()=>{this.listeners.forEach((c=>{c(l)}))}))}resumePausedMutations(){const l=this.getAll().filter((l=>l.state.isPaused));return Un.batch((()=>Promise.all(l.map((l=>l.continue().catch(noop$4))))))}},ee=new WeakMap,ne=new WeakMap,se=new WeakMap,ie);function scopeFor(l){return l.options.scope?.id}function infiniteQueryBehavior(l){return{onFetch:(c,d)=>{const h=c.options,p=c.fetchOptions?.meta?.fetchMore?.direction,f=c.state.data?.pages||[],m=c.state.data?.pageParams||[];let y={pages:[],pageParams:[]},_=0;const fetchFn=async()=>{let d=!1;const b=ensureQueryFn(c.options,c.fetchOptions),fetchPage=async(l,h,p)=>{if(d)return Promise.reject();if(null==h&&l.pages.length)return Promise.resolve(l);const f=(()=>{const l={client:c.client,queryKey:c.queryKey,pageParam:h,direction:p?"backward":"forward",meta:c.options.meta};var f;return f=l,Object.defineProperty(f,"signal",{enumerable:!0,get:()=>(c.signal.aborted?d=!0:c.signal.addEventListener("abort",(()=>{d=!0})),c.signal)}),l})(),m=await b(f),{maxPages:y}=c.options,_=p?addToStart:addToEnd;return{pages:_(l.pages,m,y),pageParams:_(l.pageParams,h,y)}};if(p&&f.length){const l="backward"===p,c={pages:f,pageParams:m},d=(l?getPreviousPageParam:getNextPageParam)(h,c);y=await fetchPage(c,d,l)}else{const c=l??f.length;do{const l=0===_?m[0]??h.initialPageParam:getNextPageParam(h,y);if(_>0&&null==l)break;y=await fetchPage(y,l),_++}while(_<c)}return y};c.options.persister?c.fetchFn=()=>c.options.persister?.(fetchFn,{client:c.client,queryKey:c.queryKey,meta:c.options.meta,signal:c.signal},d):c.fetchFn=fetchFn}}}function getNextPageParam(l,{pages:c,pageParams:d}){const h=c.length-1;return c.length>0?l.getNextPageParam(c[h],c,d[h],d):void 0}function getPreviousPageParam(l,{pages:c,pageParams:d}){return c.length>0?l.getPreviousPageParam?.(c[0],c,d[0],d):void 0}var Vn=(Ne=class{constructor(l={}){__privateAdd(this,oe),__privateAdd(this,le),__privateAdd(this,ce),__privateAdd(this,pe),__privateAdd(this,fe),__privateAdd(this,ge),__privateAdd(this,be),__privateAdd(this,Oe),__privateSet(this,oe,l.queryCache||new zn),__privateSet(this,le,l.mutationCache||new Wn),__privateSet(this,ce,l.defaultOptions||{}),__privateSet(this,pe,new Map),__privateSet(this,fe,new Map),__privateSet(this,ge,0)}mount(){__privateWrapper(this,ge)._++,1===__privateGet(this,ge)&&(__privateSet(this,be,Dn.subscribe((async l=>{l&&(await this.resumePausedMutations(),__privateGet(this,oe).onFocus())}))),__privateSet(this,Oe,Fn.subscribe((async l=>{l&&(await this.resumePausedMutations(),__privateGet(this,oe).onOnline())}))))}unmount(){var l,c;__privateWrapper(this,ge)._--,0===__privateGet(this,ge)&&(null==(l=__privateGet(this,be))||l.call(this),__privateSet(this,be,void 0),null==(c=__privateGet(this,Oe))||c.call(this),__privateSet(this,Oe,void 0))}isFetching(l){return __privateGet(this,oe).findAll({...l,fetchStatus:"fetching"}).length}isMutating(l){return __privateGet(this,le).findAll({...l,status:"pending"}).length}getQueryData(l){const c=this.defaultQueryOptions({queryKey:l});return __privateGet(this,oe).get(c.queryHash)?.state.data}ensureQueryData(l){const c=this.defaultQueryOptions(l),d=__privateGet(this,oe).build(this,c),h=d.state.data;return void 0===h?this.fetchQuery(l):(l.revalidateIfStale&&d.isStaleByTime(resolveStaleTime(c.staleTime,d))&&this.prefetchQuery(c),Promise.resolve(h))}getQueriesData(l){return __privateGet(this,oe).findAll(l).map((({queryKey:l,state:c})=>[l,c.data]))}setQueryData(l,c,d){const h=this.defaultQueryOptions({queryKey:l}),p=__privateGet(this,oe).get(h.queryHash),f=p?.state.data,m=function(l,c){return"function"==typeof l?l(c):l}(c,f);if(void 0!==m)return __privateGet(this,oe).build(this,h).setData(m,{...d,manual:!0})}setQueriesData(l,c,d){return Un.batch((()=>__privateGet(this,oe).findAll(l).map((({queryKey:l})=>[l,this.setQueryData(l,c,d)]))))}getQueryState(l){const c=this.defaultQueryOptions({queryKey:l});return __privateGet(this,oe).get(c.queryHash)?.state}removeQueries(l){const c=__privateGet(this,oe);Un.batch((()=>{c.findAll(l).forEach((l=>{c.remove(l)}))}))}resetQueries(l,c){const d=__privateGet(this,oe);return Un.batch((()=>(d.findAll(l).forEach((l=>{l.reset()})),this.refetchQueries({type:"active",...l},c))))}cancelQueries(l,c={}){const d={revert:!0,...c},h=Un.batch((()=>__privateGet(this,oe).findAll(l).map((l=>l.cancel(d)))));return Promise.all(h).then(noop$4).catch(noop$4)}invalidateQueries(l,c={}){return Un.batch((()=>(__privateGet(this,oe).findAll(l).forEach((l=>{l.invalidate()})),"none"===l?.refetchType?Promise.resolve():this.refetchQueries({...l,type:l?.refetchType??l?.type??"active"},c))))}refetchQueries(l,c={}){const d={...c,cancelRefetch:c.cancelRefetch??!0},h=Un.batch((()=>__privateGet(this,oe).findAll(l).filter((l=>!l.isDisabled()&&!l.isStatic())).map((l=>{let c=l.fetch(void 0,d);return d.throwOnError||(c=c.catch(noop$4)),"paused"===l.state.fetchStatus?Promise.resolve():c}))));return Promise.all(h).then(noop$4)}fetchQuery(l){const c=this.defaultQueryOptions(l);void 0===c.retry&&(c.retry=!1);const d=__privateGet(this,oe).build(this,c);return d.isStaleByTime(resolveStaleTime(c.staleTime,d))?d.fetch(c):Promise.resolve(d.state.data)}prefetchQuery(l){return this.fetchQuery(l).then(noop$4).catch(noop$4)}fetchInfiniteQuery(l){return l.behavior=infiniteQueryBehavior(l.pages),this.fetchQuery(l)}prefetchInfiniteQuery(l){return this.fetchInfiniteQuery(l).then(noop$4).catch(noop$4)}ensureInfiniteQueryData(l){return l.behavior=infiniteQueryBehavior(l.pages),this.ensureQueryData(l)}resumePausedMutations(){return Fn.isOnline()?__privateGet(this,le).resumePausedMutations():Promise.resolve()}getQueryCache(){return __privateGet(this,oe)}getMutationCache(){return __privateGet(this,le)}getDefaultOptions(){return __privateGet(this,ce)}setDefaultOptions(l){__privateSet(this,ce,l)}setQueryDefaults(l,c){__privateGet(this,pe).set(hashKey(l),{queryKey:l,defaultOptions:c})}getQueryDefaults(l){const c=[...__privateGet(this,pe).values()],d={};return c.forEach((c=>{partialMatchKey(l,c.queryKey)&&Object.assign(d,c.defaultOptions)})),d}setMutationDefaults(l,c){__privateGet(this,fe).set(hashKey(l),{mutationKey:l,defaultOptions:c})}getMutationDefaults(l){const c=[...__privateGet(this,fe).values()],d={};return c.forEach((c=>{partialMatchKey(l,c.mutationKey)&&Object.assign(d,c.defaultOptions)})),d}defaultQueryOptions(l){if(l._defaulted)return l;const c={...__privateGet(this,ce).queries,...this.getQueryDefaults(l.queryKey),...l,_defaulted:!0};return c.queryHash||(c.queryHash=hashQueryKeyByOptions(c.queryKey,c)),void 0===c.refetchOnReconnect&&(c.refetchOnReconnect="always"!==c.networkMode),void 0===c.throwOnError&&(c.throwOnError=!!c.suspense),!c.networkMode&&c.persister&&(c.networkMode="offlineFirst"),c.queryFn===jn&&(c.enabled=!1),c}defaultMutationOptions(l){return l?._defaulted?l:{...__privateGet(this,ce).mutations,...l?.mutationKey&&this.getMutationDefaults(l.mutationKey),...l,_defaulted:!0}}clear(){__privateGet(this,oe).clear(),__privateGet(this,le).clear()}},oe=new WeakMap,le=new WeakMap,ce=new WeakMap,pe=new WeakMap,fe=new WeakMap,ge=new WeakMap,be=new WeakMap,Oe=new WeakMap,Ne),Zn=(Ot=class extends On{constructor(l,c){super(),__privateAdd(this,_t),__privateAdd(this,De),__privateAdd(this,Fe),__privateAdd(this,Ue),__privateAdd(this,Be),__privateAdd(this,He),__privateAdd(this,qe),__privateAdd(this,Ve),__privateAdd(this,Je),__privateAdd(this,tt),__privateAdd(this,nt),__privateAdd(this,it),__privateAdd(this,ht),__privateAdd(this,ft),__privateAdd(this,gt),__privateAdd(this,yt,new Set),this.options=c,__privateSet(this,De,l),__privateSet(this,Je,null),__privateSet(this,Ve,pendingThenable()),this.options.experimental_prefetchInRender||__privateGet(this,Ve).reject(new Error("experimental_prefetchInRender feature flag is not enabled")),this.bindMethods(),this.setOptions(c)}bindMethods(){this.refetch=this.refetch.bind(this)}onSubscribe(){1===this.listeners.size&&(__privateGet(this,Fe).addObserver(this),shouldFetchOnMount(__privateGet(this,Fe),this.options)?__privateMethod(this,_t,bt).call(this):this.updateResult(),__privateMethod(this,_t,kt).call(this))}onUnsubscribe(){this.hasListeners()||this.destroy()}shouldFetchOnReconnect(){return shouldFetchOn(__privateGet(this,Fe),this.options,this.options.refetchOnReconnect)}shouldFetchOnWindowFocus(){return shouldFetchOn(__privateGet(this,Fe),this.options,this.options.refetchOnWindowFocus)}destroy(){this.listeners=new Set,__privateMethod(this,_t,Et).call(this),__privateMethod(this,_t,It).call(this),__privateGet(this,Fe).removeObserver(this)}setOptions(l){const c=this.options,d=__privateGet(this,Fe);if(this.options=__privateGet(this,De).defaultQueryOptions(l),void 0!==this.options.enabled&&"boolean"!=typeof this.options.enabled&&"function"!=typeof this.options.enabled&&"boolean"!=typeof resolveEnabled(this.options.enabled,__privateGet(this,Fe)))throw new Error("Expected enabled to be a boolean or a callback that returns a boolean");__privateMethod(this,_t,Tt).call(this),__privateGet(this,Fe).setOptions(this.options),c._defaulted&&!shallowEqualObjects(this.options,c)&&__privateGet(this,De).getQueryCache().notify({type:"observerOptionsUpdated",query:__privateGet(this,Fe),observer:this});const h=this.hasListeners();h&&shouldFetchOptionally(__privateGet(this,Fe),d,this.options,c)&&__privateMethod(this,_t,bt).call(this),this.updateResult(),!h||__privateGet(this,Fe)===d&&resolveEnabled(this.options.enabled,__privateGet(this,Fe))===resolveEnabled(c.enabled,__privateGet(this,Fe))&&resolveStaleTime(this.options.staleTime,__privateGet(this,Fe))===resolveStaleTime(c.staleTime,__privateGet(this,Fe))||__privateMethod(this,_t,wt).call(this);const p=__privateMethod(this,_t,St).call(this);!h||__privateGet(this,Fe)===d&&resolveEnabled(this.options.enabled,__privateGet(this,Fe))===resolveEnabled(c.enabled,__privateGet(this,Fe))&&p===__privateGet(this,gt)||__privateMethod(this,_t,xt).call(this,p)}getOptimisticResult(l){const c=__privateGet(this,De).getQueryCache().build(__privateGet(this,De),l),d=this.createResult(c,l);return function(l,c){if(!shallowEqualObjects(l.getCurrentResult(),c))return!0;return!1}(this,d)&&(__privateSet(this,Be,d),__privateSet(this,qe,this.options),__privateSet(this,He,__privateGet(this,Fe).state)),d}getCurrentResult(){return __privateGet(this,Be)}trackResult(l,c){return new Proxy(l,{get:(l,d)=>(this.trackProp(d),c?.(d),Reflect.get(l,d))})}trackProp(l){__privateGet(this,yt).add(l)}getCurrentQuery(){return __privateGet(this,Fe)}refetch({...l}={}){return this.fetch({...l})}fetchOptimistic(l){const c=__privateGet(this,De).defaultQueryOptions(l),d=__privateGet(this,De).getQueryCache().build(__privateGet(this,De),c);return d.fetch().then((()=>this.createResult(d,c)))}fetch(l){return __privateMethod(this,_t,bt).call(this,{...l,cancelRefetch:l.cancelRefetch??!0}).then((()=>(this.updateResult(),__privateGet(this,Be))))}createResult(l,c){const d=__privateGet(this,Fe),h=this.options,p=__privateGet(this,Be),f=__privateGet(this,He),m=__privateGet(this,qe),y=l!==d?l.state:__privateGet(this,Ue),{state:_}=l;let b,w={..._},E=!1;if(c._optimisticResults){const p=this.hasListeners(),f=!p&&shouldFetchOnMount(l,c),m=p&&shouldFetchOptionally(l,d,c,h);(f||m)&&(w={...w,...fetchState(_.data,l.options)}),"isRestoring"===c._optimisticResults&&(w.fetchStatus="idle")}let{error:M,errorUpdatedAt:N,status:P}=w;b=w.data;let L=!1;if(void 0!==c.placeholderData&&void 0===b&&"pending"===P){let l;p?.isPlaceholderData&&c.placeholderData===m?.placeholderData?(l=p.data,L=!0):l="function"==typeof c.placeholderData?c.placeholderData(__privateGet(this,it)?.state.data,__privateGet(this,it)):c.placeholderData,void 0!==l&&(P="success",b=replaceData(p?.data,l,c),E=!0)}if(c.select&&void 0!==b&&!L)if(p&&b===f?.data&&c.select===__privateGet(this,tt))b=__privateGet(this,nt);else try{__privateSet(this,tt,c.select),b=c.select(b),b=replaceData(p?.data,b,c),__privateSet(this,nt,b),__privateSet(this,Je,null)}catch(z){__privateSet(this,Je,z)}__privateGet(this,Je)&&(M=__privateGet(this,Je),b=__privateGet(this,nt),N=Date.now(),P="error");const j="fetching"===w.fetchStatus,D="pending"===P,F="error"===P,U=D&&j,B=void 0!==b,H={status:P,fetchStatus:w.fetchStatus,isPending:D,isSuccess:"success"===P,isError:F,isInitialLoading:U,isLoading:U,data:b,dataUpdatedAt:w.dataUpdatedAt,error:M,errorUpdatedAt:N,failureCount:w.fetchFailureCount,failureReason:w.fetchFailureReason,errorUpdateCount:w.errorUpdateCount,isFetched:w.dataUpdateCount>0||w.errorUpdateCount>0,isFetchedAfterMount:w.dataUpdateCount>y.dataUpdateCount||w.errorUpdateCount>y.errorUpdateCount,isFetching:j,isRefetching:j&&!D,isLoadingError:F&&!B,isPaused:"paused"===w.fetchStatus,isPlaceholderData:E,isRefetchError:F&&B,isStale:isStale(l,c),refetch:this.refetch,promise:__privateGet(this,Ve)};if(this.options.experimental_prefetchInRender){const finalizeThenableIfPossible=l=>{"error"===H.status?l.reject(H.error):void 0!==H.data&&l.resolve(H.data)},recreateThenable=()=>{const l=__privateSet(this,Ve,H.promise=pendingThenable());finalizeThenableIfPossible(l)},c=__privateGet(this,Ve);switch(c.status){case"pending":l.queryHash===d.queryHash&&finalizeThenableIfPossible(c);break;case"fulfilled":"error"!==H.status&&H.data===c.value||recreateThenable();break;case"rejected":"error"===H.status&&H.error===c.reason||recreateThenable()}}return H}updateResult(){const l=__privateGet(this,Be),c=this.createResult(__privateGet(this,Fe),this.options);if(__privateSet(this,He,__privateGet(this,Fe).state),__privateSet(this,qe,this.options),void 0!==__privateGet(this,He).data&&__privateSet(this,it,__privateGet(this,Fe)),shallowEqualObjects(c,l))return;__privateSet(this,Be,c);__privateMethod(this,_t,At).call(this,{listeners:(()=>{if(!l)return!0;const{notifyOnChangeProps:c}=this.options,d="function"==typeof c?c():c;if("all"===d||!d&&!__privateGet(this,yt).size)return!0;const h=new Set(d??__privateGet(this,yt));return this.options.throwOnError&&h.add("error"),Object.keys(__privateGet(this,Be)).some((c=>{const d=c;return __privateGet(this,Be)[d]!==l[d]&&h.has(d)}))})()})}onQueryUpdate(){this.updateResult(),this.hasListeners()&&__privateMethod(this,_t,kt).call(this)}},De=new WeakMap,Fe=new WeakMap,Ue=new WeakMap,Be=new WeakMap,He=new WeakMap,qe=new WeakMap,Ve=new WeakMap,Je=new WeakMap,tt=new WeakMap,nt=new WeakMap,it=new WeakMap,ht=new WeakMap,ft=new WeakMap,gt=new WeakMap,yt=new WeakMap,_t=new WeakSet,bt=function(l){__privateMethod(this,_t,Tt).call(this);let c=__privateGet(this,Fe).fetch(this.options,l);return l?.throwOnError||(c=c.catch(noop$4)),c},wt=function(){__privateMethod(this,_t,Et).call(this);const l=resolveStaleTime(this.options.staleTime,__privateGet(this,Fe));if(Ln||__privateGet(this,Be).isStale||!isValidTimeout(l))return;const c=timeUntilStale(__privateGet(this,Be).dataUpdatedAt,l);__privateSet(this,ht,setTimeout((()=>{__privateGet(this,Be).isStale||this.updateResult()}),c+1))},St=function(){return("function"==typeof this.options.refetchInterval?this.options.refetchInterval(__privateGet(this,Fe)):this.options.refetchInterval)??!1},xt=function(l){__privateMethod(this,_t,It).call(this),__privateSet(this,gt,l),!Ln&&!1!==resolveEnabled(this.options.enabled,__privateGet(this,Fe))&&isValidTimeout(__privateGet(this,gt))&&0!==__privateGet(this,gt)&&__privateSet(this,ft,setInterval((()=>{(this.options.refetchIntervalInBackground||Dn.isFocused())&&__privateMethod(this,_t,bt).call(this)}),__privateGet(this,gt)))},kt=function(){__privateMethod(this,_t,wt).call(this),__privateMethod(this,_t,xt).call(this,__privateMethod(this,_t,St).call(this))},Et=function(){__privateGet(this,ht)&&(clearTimeout(__privateGet(this,ht)),__privateSet(this,ht,void 0))},It=function(){__privateGet(this,ft)&&(clearInterval(__privateGet(this,ft)),__privateSet(this,ft,void 0))},Tt=function(){const l=__privateGet(this,De).getQueryCache().build(__privateGet(this,De),this.options);if(l===__privateGet(this,Fe))return;const c=__privateGet(this,Fe);__privateSet(this,Fe,l),__privateSet(this,Ue,l.state),this.hasListeners()&&(c?.removeObserver(this),l.addObserver(this))},At=function(l){Un.batch((()=>{l.listeners&&this.listeners.forEach((l=>{l(__privateGet(this,Be))})),__privateGet(this,De).getQueryCache().notify({query:__privateGet(this,Fe),type:"observerResultsUpdated"})}))},Ot);function shouldFetchOnMount(l,c){return function(l,c){return!1!==resolveEnabled(c.enabled,l)&&void 0===l.state.data&&!("error"===l.state.status&&!1===c.retryOnMount)}(l,c)||void 0!==l.state.data&&shouldFetchOn(l,c,c.refetchOnMount)}function shouldFetchOn(l,c,d){if(!1!==resolveEnabled(c.enabled,l)&&"static"!==resolveStaleTime(c.staleTime,l)){const h="function"==typeof d?d(l):d;return"always"===h||!1!==h&&isStale(l,c)}return!1}function shouldFetchOptionally(l,c,d,h){return(l!==c||!1===resolveEnabled(h.enabled,l))&&(!d.suspense||"error"!==l.state.status)&&isStale(l,d)}function isStale(l,c){return!1!==resolveEnabled(c.enabled,l)&&l.isStaleByTime(resolveStaleTime(c.staleTime,l))}var Gn=(Bt=class extends On{constructor(l,c){super(),__privateAdd(this,jt),__privateAdd(this,Mt),__privateAdd(this,Nt),__privateAdd(this,Pt),__privateAdd(this,Lt),__privateSet(this,Mt,l),this.setOptions(c),this.bindMethods(),__privateMethod(this,jt,Dt).call(this)}bindMethods(){this.mutate=this.mutate.bind(this),this.reset=this.reset.bind(this)}setOptions(l){const c=this.options;this.options=__privateGet(this,Mt).defaultMutationOptions(l),shallowEqualObjects(this.options,c)||__privateGet(this,Mt).getMutationCache().notify({type:"observerOptionsUpdated",mutation:__privateGet(this,Pt),observer:this}),c?.mutationKey&&this.options.mutationKey&&hashKey(c.mutationKey)!==hashKey(this.options.mutationKey)?this.reset():"pending"===__privateGet(this,Pt)?.state.status&&__privateGet(this,Pt).setOptions(this.options)}onUnsubscribe(){this.hasListeners()||__privateGet(this,Pt)?.removeObserver(this)}onMutationUpdate(l){__privateMethod(this,jt,Dt).call(this),__privateMethod(this,jt,Ft).call(this,l)}getCurrentResult(){return __privateGet(this,Nt)}reset(){__privateGet(this,Pt)?.removeObserver(this),__privateSet(this,Pt,void 0),__privateMethod(this,jt,Dt).call(this),__privateMethod(this,jt,Ft).call(this)}mutate(l,c){return __privateSet(this,Lt,c),__privateGet(this,Pt)?.removeObserver(this),__privateSet(this,Pt,__privateGet(this,Mt).getMutationCache().build(__privateGet(this,Mt),this.options)),__privateGet(this,Pt).addObserver(this),__privateGet(this,Pt).execute(l)}},Mt=new WeakMap,Nt=new WeakMap,Pt=new WeakMap,Lt=new WeakMap,jt=new WeakSet,Dt=function(){const l=__privateGet(this,Pt)?.state??{context:void 0,data:void 0,error:null,failureCount:0,failureReason:null,isPaused:!1,status:"idle",variables:void 0,submittedAt:0};__privateSet(this,Nt,{...l,isPending:"pending"===l.status,isSuccess:"success"===l.status,isError:"error"===l.status,isIdle:"idle"===l.status,mutate:this.mutate,reset:this.reset})},Ft=function(l){Un.batch((()=>{if(__privateGet(this,Lt)&&this.hasListeners()){const c=__privateGet(this,Nt).variables,d=__privateGet(this,Nt).context;"success"===l?.type?(__privateGet(this,Lt).onSuccess?.(l.data,c,d),__privateGet(this,Lt).onSettled?.(l.data,null,c,d)):"error"===l?.type&&(__privateGet(this,Lt).onError?.(l.error,c,d),__privateGet(this,Lt).onSettled?.(void 0,l.error,c,d))}this.listeners.forEach((l=>{l(__privateGet(this,Nt))}))}))},Bt),Kn=Gt.createContext(void 0),useQueryClient=l=>{const c=Gt.useContext(Kn);if(!c)throw new Error("No QueryClient set, use QueryClientProvider to set one");return c},QueryClientProvider=({client:l,children:c})=>(Gt.useEffect((()=>(l.mount(),()=>{l.unmount()})),[l]),Kt.jsx(Kn.Provider,{value:l,children:c})),Jn=Gt.createContext(!1);Jn.Provider;var Yn=Gt.createContext(function(){let l=!1;return{clearReset:()=>{l=!1},reset:()=>{l=!0},isReset:()=>l}}()),fetchOptimistic=(l,c,d)=>c.fetchOptimistic(l).catch((()=>{d.clearReset()}));function useBaseQuery(l,c,d){const h=Gt.useContext(Jn),p=Gt.useContext(Yn),f=useQueryClient(),m=f.defaultQueryOptions(l);f.getDefaultOptions().queries?._experimental_beforeQuery?.(m),m._optimisticResults=h?"isRestoring":"optimistic",(l=>{if(l.suspense){const clamp2=l=>"static"===l?l:Math.max(l??1e3,1e3),c=l.staleTime;l.staleTime="function"==typeof c?(...l)=>clamp2(c(...l)):clamp2(c),"number"==typeof l.gcTime&&(l.gcTime=Math.max(l.gcTime,1e3))}})(m),((l,c)=>{(l.suspense||l.throwOnError||l.experimental_prefetchInRender)&&(c.isReset()||(l.retryOnMount=!1))})(m,p),(l=>{Gt.useEffect((()=>{l.clearReset()}),[l])})(p);const y=!f.getQueryCache().get(m.queryHash),[_]=Gt.useState((()=>new c(f,m))),b=_.getOptimisticResult(m),w=!h&&!1!==l.subscribed;if(Gt.useSyncExternalStore(Gt.useCallback((l=>{const c=w?_.subscribe(Un.batchCalls(l)):noop$4;return _.updateResult(),c}),[_,w]),(()=>_.getCurrentResult()),(()=>_.getCurrentResult())),Gt.useEffect((()=>{_.setOptions(m)}),[m,_]),((l,c)=>l?.suspense&&c.isPending)(m,b))throw fetchOptimistic(m,_,p);if((({result:l,errorResetBoundary:c,throwOnError:d,query:h,suspense:p})=>l.isError&&!c.isReset()&&!l.isFetching&&h&&(p&&void 0===l.data||shouldThrowError(d,[l.error,h])))({result:b,errorResetBoundary:p,throwOnError:m.throwOnError,query:f.getQueryCache().get(m.queryHash),suspense:m.suspense}))throw b.error;if(f.getDefaultOptions().queries?._experimental_afterQuery?.(m,b),m.experimental_prefetchInRender&&!Ln&&((l,c)=>l.isLoading&&l.isFetching&&!c)(b,h)){const l=y?fetchOptimistic(m,_,p):f.getQueryCache().get(m.queryHash)?.promise;l?.catch(noop$4).finally((()=>{_.updateResult()}))}return m.notifyOnChangeProps?b:_.trackResult(b)}function useQuery(l,c){return useBaseQuery(l,Zn)}function useMutation(l,c){const d=useQueryClient(),[h]=Gt.useState((()=>new Gn(d,l)));Gt.useEffect((()=>{h.setOptions(l)}),[h,l]);const p=Gt.useSyncExternalStore(Gt.useCallback((l=>h.subscribe(Un.batchCalls(l))),[h]),(()=>h.getCurrentResult()),(()=>h.getCurrentResult())),f=Gt.useCallback(((l,c)=>{h.mutate(l,c).catch(noop$4)}),[h]);if(p.error&&shouldThrowError(h.options.throwOnError,[p.error]))throw p.error;return{...p,mutate:f,mutateAsync:p.mutate}}const toPascalCase=l=>{const c=(l=>l.replace(/^([A-Z])|[\s-_]+(\w)/g,((l,c,d)=>d?d.toUpperCase():c.toLowerCase())))(l);return c.charAt(0).toUpperCase()+c.slice(1)},mergeClasses=(...l)=>l.filter(((l,c,d)=>Boolean(l)&&""!==l.trim()&&d.indexOf(l)===c)).join(" ").trim(),hasA11yProp=l=>{for(const c in l)if(c.startsWith("aria-")||"role"===c||"title"===c)return!0};var Qn={xmlns:"http://www.w3.org/2000/svg",width:24,height:24,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:2,strokeLinecap:"round",strokeLinejoin:"round"};const Xn=Gt.forwardRef((({color:l="currentColor",size:c=24,strokeWidth:d=2,absoluteStrokeWidth:h,className:p="",children:f,iconNode:m,...y},_)=>Gt.createElement("svg",{ref:_,...Qn,width:c,height:c,stroke:l,strokeWidth:h?24*Number(d)/Number(c):d,className:mergeClasses("lucide",p),...!f&&!hasA11yProp(y)&&{"aria-hidden":"true"},...y},[...m.map((([l,c])=>Gt.createElement(l,c))),...Array.isArray(f)?f:[f]]))),createLucideIcon=(l,c)=>{const d=Gt.forwardRef((({className:d,...h},p)=>{return Gt.createElement(Xn,{ref:p,iconNode:c,className:mergeClasses(`lucide-${f=toPascalCase(l),f.replace(/([a-z0-9])([A-Z])/g,"$1-$2").toLowerCase()}`,`lucide-${l}`,d),...h});var f}));return d.displayName=toPascalCase(l),d},es=createLucideIcon("arrow-up",[["path",{d:"m5 12 7-7 7 7",key:"hav0vg"}],["path",{d:"M12 19V5",key:"x0mq9r"}]]),ts=createLucideIcon("calendar",[["path",{d:"M8 2v4",key:"1cmpym"}],["path",{d:"M16 2v4",key:"4m81vk"}],["rect",{width:"18",height:"18",x:"3",y:"4",rx:"2",key:"1hopcy"}],["path",{d:"M3 10h18",key:"8toen8"}]]),rs=createLucideIcon("check",[["path",{d:"M20 6 9 17l-5-5",key:"1gmf2c"}]]),ns=createLucideIcon("chevron-down",[["path",{d:"m6 9 6 6 6-6",key:"qrunsl"}]]),ss=createLucideIcon("chevron-left",[["path",{d:"m15 18-6-6 6-6",key:"1wnfg3"}]]),is=createLucideIcon("chevron-right",[["path",{d:"m9 18 6-6-6-6",key:"mthhwq"}]]),os=createLucideIcon("chevron-up",[["path",{d:"m18 15-6-6-6 6",key:"153udz"}]]),as=createLucideIcon("circle-alert",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["line",{x1:"12",x2:"12",y1:"8",y2:"12",key:"1pkeuh"}],["line",{x1:"12",x2:"12.01",y1:"16",y2:"16",key:"4dfq90"}]]),ls=createLucideIcon("circle-check-big",[["path",{d:"M21.801 10A10 10 0 1 1 17 3.335",key:"yps3ct"}],["path",{d:"m9 11 3 3L22 4",key:"1pflzl"}]]),cs=createLucideIcon("circle-x",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"m15 9-6 6",key:"1uzhvr"}],["path",{d:"m9 9 6 6",key:"z0biqf"}]]),us=createLucideIcon("circle",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}]]),ds=createLucideIcon("clock",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["polyline",{points:"12 6 12 12 16 14",key:"68esgv"}]]),Cs=createLucideIcon("code-xml",[["path",{d:"m18 16 4-4-4-4",key:"1inbqp"}],["path",{d:"m6 8-4 4 4 4",key:"15zrgr"}],["path",{d:"m14.5 4-5 16",key:"e7oirm"}]]),Es=createLucideIcon("copy",[["rect",{width:"14",height:"14",x:"8",y:"8",rx:"2",ry:"2",key:"17jyea"}],["path",{d:"M4 16c-1.1 0-2-.9-2-2V4c0-1.1.9-2 2-2h10c1.1 0 2 .9 2 2",key:"zix9uf"}]]),Os=createLucideIcon("download",[["path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4",key:"ih7n3h"}],["polyline",{points:"7 10 12 15 17 10",key:"2ggqvy"}],["line",{x1:"12",x2:"12",y1:"15",y2:"3",key:"1vk2je"}]]),Ms=createLucideIcon("external-link",[["path",{d:"M15 3h6v6",key:"1q9fwt"}],["path",{d:"M10 14 21 3",key:"gplh6r"}],["path",{d:"M18 13v6a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V8a2 2 0 0 1 2-2h6",key:"a6xqqp"}]]),Ns=createLucideIcon("eye-off",[["path",{d:"M10.733 5.076a10.744 10.744 0 0 1 11.205 6.575 1 1 0 0 1 0 .696 10.747 10.747 0 0 1-1.444 2.49",key:"ct8e1f"}],["path",{d:"M14.084 14.158a3 3 0 0 1-4.242-4.242",key:"151rxh"}],["path",{d:"M17.479 17.499a10.75 10.75 0 0 1-15.417-5.151 1 1 0 0 1 0-.696 10.75 10.75 0 0 1 4.446-5.143",key:"13bj9a"}],["path",{d:"m2 2 20 20",key:"1ooewy"}]]),Ps=createLucideIcon("eye",[["path",{d:"M2.062 12.348a1 1 0 0 1 0-.696 10.75 10.75 0 0 1 19.876 0 1 1 0 0 1 0 .696 10.75 10.75 0 0 1-19.876 0",key:"1nclc0"}],["circle",{cx:"12",cy:"12",r:"3",key:"1v7zrd"}]]),Ls=createLucideIcon("file-image",[["path",{d:"M15 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V7Z",key:"1rqfz7"}],["path",{d:"M14 2v4a2 2 0 0 0 2 2h4",key:"tnqrlb"}],["circle",{cx:"10",cy:"12",r:"2",key:"737tya"}],["path",{d:"m20 17-1.296-1.296a2.41 2.41 0 0 0-3.408 0L9 22",key:"wt3hpn"}]]),Ds=createLucideIcon("file-plus-2",[["path",{d:"M4 22h14a2 2 0 0 0 2-2V7l-5-5H6a2 2 0 0 0-2 2v4",key:"1pf5j1"}],["path",{d:"M14 2v4a2 2 0 0 0 2 2h4",key:"tnqrlb"}],["path",{d:"M3 15h6",key:"4e2qda"}],["path",{d:"M6 12v6",key:"1u72j0"}]]),Fs=createLucideIcon("file-text",[["path",{d:"M15 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V7Z",key:"1rqfz7"}],["path",{d:"M14 2v4a2 2 0 0 0 2 2h4",key:"tnqrlb"}],["path",{d:"M10 9H8",key:"b1mrlr"}],["path",{d:"M16 13H8",key:"t4e002"}],["path",{d:"M16 17H8",key:"z1uh3a"}]]),Us=createLucideIcon("folder-open",[["path",{d:"m6 14 1.5-2.9A2 2 0 0 1 9.24 10H20a2 2 0 0 1 1.94 2.5l-1.54 6a2 2 0 0 1-1.95 1.5H4a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h3.9a2 2 0 0 1 1.69.9l.81 1.2a2 2 0 0 0 1.67.9H18a2 2 0 0 1 2 2v2",key:"usdka0"}]]),Zs=createLucideIcon("folder",[["path",{d:"M20 20a2 2 0 0 0 2-2V8a2 2 0 0 0-2-2h-7.9a2 2 0 0 1-1.69-.9L9.6 3.9A2 2 0 0 0 7.93 3H4a2 2 0 0 0-2 2v13a2 2 0 0 0 2 2Z",key:"1kt360"}]]),Gs=createLucideIcon("hash",[["line",{x1:"4",x2:"20",y1:"9",y2:"9",key:"4lhtct"}],["line",{x1:"4",x2:"20",y1:"15",y2:"15",key:"vyu0kd"}],["line",{x1:"10",x2:"8",y1:"3",y2:"21",key:"1ggp8o"}],["line",{x1:"16",x2:"14",y1:"3",y2:"21",key:"weycgp"}]]),hi=createLucideIcon("image-off",[["line",{x1:"2",x2:"22",y1:"2",y2:"22",key:"a6p6uj"}],["path",{d:"M10.41 10.41a2 2 0 1 1-2.83-2.83",key:"1bzlo9"}],["line",{x1:"13.5",x2:"6",y1:"13.5",y2:"21",key:"1q0aeu"}],["line",{x1:"18",x2:"21",y1:"12",y2:"15",key:"5mozeu"}],["path",{d:"M3.59 3.59A1.99 1.99 0 0 0 3 5v14a2 2 0 0 0 2 2h14c.55 0 1.052-.22 1.41-.59",key:"mmje98"}],["path",{d:"M21 15V5a2 2 0 0 0-2-2H9",key:"43el77"}]]),mi=createLucideIcon("image-plus",[["path",{d:"M16 5h6",key:"1vod17"}],["path",{d:"M19 2v6",key:"4bpg5p"}],["path",{d:"M21 11.5V19a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h7.5",key:"1ue2ih"}],["path",{d:"m21 15-3.086-3.086a2 2 0 0 0-2.828 0L6 21",key:"1xmnt7"}],["circle",{cx:"9",cy:"9",r:"2",key:"af1f0g"}]]),vi=createLucideIcon("image",[["rect",{width:"18",height:"18",x:"3",y:"3",rx:"2",ry:"2",key:"1m3agn"}],["circle",{cx:"9",cy:"9",r:"2",key:"af1f0g"}],["path",{d:"m21 15-3.086-3.086a2 2 0 0 0-2.828 0L6 21",key:"1xmnt7"}]]),yi=createLucideIcon("layers",[["path",{d:"M12.83 2.18a2 2 0 0 0-1.66 0L2.6 6.08a1 1 0 0 0 0 1.83l8.58 3.91a2 2 0 0 0 1.66 0l8.58-3.9a1 1 0 0 0 0-1.83z",key:"zw3jo"}],["path",{d:"M2 12a1 1 0 0 0 .58.91l8.6 3.91a2 2 0 0 0 1.65 0l8.58-3.9A1 1 0 0 0 22 12",key:"1wduqc"}],["path",{d:"M2 17a1 1 0 0 0 .58.91l8.6 3.91a2 2 0 0 0 1.65 0l8.58-3.9A1 1 0 0 0 22 17",key:"kqbvx6"}]]),_i=createLucideIcon("link",[["path",{d:"M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71",key:"1cjeqo"}],["path",{d:"M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71",key:"19qd67"}]]),wi=createLucideIcon("loader-circle",[["path",{d:"M21 12a9 9 0 1 1-6.219-8.56",key:"13zald"}]]),xi=createLucideIcon("log-out",[["path",{d:"M9 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h4",key:"1uf3rs"}],["polyline",{points:"16 17 21 12 16 7",key:"1gabdz"}],["line",{x1:"21",x2:"9",y1:"12",y2:"12",key:"1uyos4"}]]),ki=createLucideIcon("pause",[["rect",{x:"14",y:"4",width:"4",height:"16",rx:"1",key:"zuxfzm"}],["rect",{x:"6",y:"4",width:"4",height:"16",rx:"1",key:"1okwgv"}]]),Ei=createLucideIcon("pencil",[["path",{d:"M21.174 6.812a1 1 0 0 0-3.986-3.987L3.842 16.174a2 2 0 0 0-.5.83l-1.321 4.352a.5.5 0 0 0 .623.622l4.353-1.32a2 2 0 0 0 .83-.497z",key:"1a8usu"}],["path",{d:"m15 5 4 4",key:"1mk7zo"}]]),Ri=createLucideIcon("play",[["polygon",{points:"6 3 20 12 6 21 6 3",key:"1oa8hb"}]]),Mi=createLucideIcon("plus",[["path",{d:"M5 12h14",key:"1ays0h"}],["path",{d:"M12 5v14",key:"s699le"}]]),Ni=createLucideIcon("refresh-cw",[["path",{d:"M3 12a9 9 0 0 1 9-9 9.75 9.75 0 0 1 6.74 2.74L21 8",key:"v9h5vc"}],["path",{d:"M21 3v5h-5",key:"1q7to0"}],["path",{d:"M21 12a9 9 0 0 1-9 9 9.75 9.75 0 0 1-6.74-2.74L3 16",key:"3uifl3"}],["path",{d:"M8 16H3v5",key:"1cv678"}]]),Pi=createLucideIcon("rotate-ccw",[["path",{d:"M3 12a9 9 0 1 0 9-9 9.75 9.75 0 0 0-6.74 2.74L3 8",key:"1357e3"}],["path",{d:"M3 3v5h5",key:"1xhq8a"}]]),ji=createLucideIcon("settings",[["path",{d:"M12.22 2h-.44a2 2 0 0 0-2 2v.18a2 2 0 0 1-1 1.73l-.43.25a2 2 0 0 1-2 0l-.15-.08a2 2 0 0 0-2.73.73l-.22.38a2 2 0 0 0 .73 2.73l.15.1a2 2 0 0 1 1 1.72v.51a2 2 0 0 1-1 1.74l-.15.09a2 2 0 0 0-.73 2.73l.22.38a2 2 0 0 0 2.73.73l.15-.08a2 2 0 0 1 2 0l.43.25a2 2 0 0 1 1 1.73V20a2 2 0 0 0 2 2h.44a2 2 0 0 0 2-2v-.18a2 2 0 0 1 1-1.73l.43-.25a2 2 0 0 1 2 0l.15.08a2 2 0 0 0 2.73-.73l.22-.39a2 2 0 0 0-.73-2.73l-.15-.08a2 2 0 0 1-1-1.74v-.5a2 2 0 0 1 1-1.74l.15-.09a2 2 0 0 0 .73-2.73l-.22-.38a2 2 0 0 0-2.73-.73l-.15.08a2 2 0 0 1-2 0l-.43-.25a2 2 0 0 1-1-1.73V4a2 2 0 0 0-2-2z",key:"1qme2f"}],["circle",{cx:"12",cy:"12",r:"3",key:"1v7zrd"}]]),Fi=createLucideIcon("square",[["rect",{width:"18",height:"18",x:"3",y:"3",rx:"2",key:"afitv7"}]]),qi=createLucideIcon("trash-2",[["path",{d:"M3 6h18",key:"d0wm0j"}],["path",{d:"M19 6v14c0 1-1 2-2 2H7c-1 0-2-1-2-2V6",key:"4alrt4"}],["path",{d:"M8 6V4c0-1 1-2 2-2h4c1 0 2 1 2 2v2",key:"v07s0e"}],["line",{x1:"10",x2:"10",y1:"11",y2:"17",key:"1uufr5"}],["line",{x1:"14",x2:"14",y1:"11",y2:"17",key:"xtxkd"}]]),Vi=createLucideIcon("triangle-alert",[["path",{d:"m21.73 18-8-14a2 2 0 0 0-3.48 0l-8 14A2 2 0 0 0 4 21h16a2 2 0 0 0 1.73-3",key:"wmoenq"}],["path",{d:"M12 9v4",key:"juzpu7"}],["path",{d:"M12 17h.01",key:"p32p05"}]]),Gi=createLucideIcon("undo-2",[["path",{d:"M9 14 4 9l5-5",key:"102s5s"}],["path",{d:"M4 9h10.5a5.5 5.5 0 0 1 5.5 5.5a5.5 5.5 0 0 1-5.5 5.5H11",key:"f3b9sd"}]]),Ki=createLucideIcon("upload",[["path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4",key:"ih7n3h"}],["polyline",{points:"17 8 12 3 7 8",key:"t8dd8p"}],["line",{x1:"12",x2:"12",y1:"3",y2:"15",key:"widbto"}]]),Ji=createLucideIcon("user",[["path",{d:"M19 21v-2a4 4 0 0 0-4-4H9a4 4 0 0 0-4 4v2",key:"975kel"}],["circle",{cx:"12",cy:"7",r:"4",key:"17ys0d"}]]),Yi=createLucideIcon("wifi-off",[["path",{d:"M12 20h.01",key:"zekei9"}],["path",{d:"M8.5 16.429a5 5 0 0 1 7 0",key:"1bycff"}],["path",{d:"M5 12.859a10 10 0 0 1 5.17-2.69",key:"1dl1wf"}],["path",{d:"M19 12.859a10 10 0 0 0-2.007-1.523",key:"4k23kn"}],["path",{d:"M2 8.82a15 15 0 0 1 4.177-2.643",key:"1grhjp"}],["path",{d:"M22 8.82a15 15 0 0 0-11.288-3.764",key:"z3jwby"}],["path",{d:"m2 2 20 20",key:"1ooewy"}]]),Qi=createLucideIcon("x",[["path",{d:"M18 6 6 18",key:"1bl5f8"}],["path",{d:"m6 6 12 12",key:"d8bk6v"}]]),Xi="Smartlook client is not initialized.",ro={init:function(l,c){const d=window;if(d.smartlook)return console.warn("Smartlook client is already initialized."),!1;d.smartlook=function(){d.smartlook.api.push(arguments)},d.smartlook.api=[];const h=c;let p="https://web-sdk.smartlook.com/recorder.js";if(null==h?void 0:h.relayProxyUrl)try{const l=new URL("/recorder.js",h.relayProxyUrl);h.host=l.origin,p=l.toString()}catch(hh){return console.error("Smartlook init param `relayProxyUrl` is not valid. Please provide full url like `https://my-proxy-domain.com/`."),!1}d.smartlook("init",l,h);const f=window.document.getElementsByTagName("head")[0],m=window.document.createElement("script");return m.async=!0,m.type="text/javascript",m.crossOrigin="anonymous",m.src=p,f.appendChild(m),!0},identify:function(l,c){const d=window;return d.smartlook?l?(d.smartlook("identify",l,c),!0):(console.warn("Smartlook - User ID must be provided"),!1):(console.warn(Xi),!1)},anonymize:function(){const l=window;return l.smartlook?(l.smartlook("anonymize"),!0):(console.warn(Xi),!1)},track:function(l,c){const d=window;return d.smartlook?(d.smartlook("track",l,c),!0):(console.warn(Xi),!1)},disable:function(){const l=window;return l.smartlook?(l.smartlook("disable"),!0):(console.warn(Xi),!1)},record:function(l){const c=window;return c.smartlook?(c.smartlook("record",l),!0):(console.warn(Xi),!1)},getData:function(l){const c=window;return c.smartlook?(c.smartlook(l),!0):(console.warn(Xi),!1)},restart:function(){const l=window;return l.smartlook?(l.smartlook("restart"),!0):(console.warn(Xi),!1)},pause:function(){const l=window;return l.smartlook?(l.smartlook("pause"),!0):(console.warn(Xi),!1)},resume:function(){const l=window;return l.smartlook?(l.smartlook("resume"),!0):(console.warn(Xi),!1)},error:function(l){const c=window;return c.smartlook?(c.smartlook("error",l),!0):(console.warn(Xi),!1)},navigation:function(l){const c=window;return c.smartlook?(c.smartlook("navigation",l),!0):(console.warn(Xi),!1)},properties:function(l){const c=window;return c.smartlook?(c.smartlook("properties",l),!0):(console.warn(Xi),!1)},initialized:function(){return!!window.smartlook},get playUrl(){return window.smartlook.playUrl},get sessionId(){return window.smartlook.sessionId},get visitorId(){return window.smartlook.visitorId},get recordId(){return window.smartlook.recordId},get key(){return window.smartlook.key},get version(){return window.smartlook.version}};var oo=Array(12).fill(0),Yt$1=({visible:l,className:c})=>Yt.createElement("div",{className:["sonner-loading-wrapper",c].filter(Boolean).join(" "),"data-visible":l},Yt.createElement("div",{className:"sonner-spinner"},oo.map(((l,c)=>Yt.createElement("div",{className:"sonner-loading-bar",key:`spinner-bar-${c}`}))))),ao=Yt.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 20 20",fill:"currentColor",height:"20",width:"20"},Yt.createElement("path",{fillRule:"evenodd",d:"M10 18a8 8 0 100-16 8 8 0 000 16zm3.857-9.809a.75.75 0 00-1.214-.882l-3.483 4.79-1.88-1.88a.75.75 0 10-1.06 1.061l2.5 2.5a.75.75 0 001.137-.089l4-5.5z",clipRule:"evenodd"})),co=Yt.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",fill:"currentColor",height:"20",width:"20"},Yt.createElement("path",{fillRule:"evenodd",d:"M9.401 3.003c1.155-2 4.043-2 5.197 0l7.355 12.748c1.154 2-.29 4.5-2.599 4.5H4.645c-2.309 0-3.752-2.5-2.598-4.5L9.4 3.003zM12 8.25a.75.75 0 01.75.75v3.75a.75.75 0 01-1.5 0V9a.75.75 0 01.75-.75zm0 8.25a.75.75 0 100-1.5.75.75 0 000 1.5z",clipRule:"evenodd"})),ho=Yt.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 20 20",fill:"currentColor",height:"20",width:"20"},Yt.createElement("path",{fillRule:"evenodd",d:"M18 10a8 8 0 11-16 0 8 8 0 0116 0zm-7-4a1 1 0 11-2 0 1 1 0 012 0zM9 9a.75.75 0 000 1.5h.253a.25.25 0 01.244.304l-.459 2.066A1.75 1.75 0 0010.747 15H11a.75.75 0 000-1.5h-.253a.25.25 0 01-.244-.304l.459-2.066A1.75 1.75 0 009.253 9H9z",clipRule:"evenodd"})),po=Yt.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 20 20",fill:"currentColor",height:"20",width:"20"},Yt.createElement("path",{fillRule:"evenodd",d:"M18 10a8 8 0 11-16 0 8 8 0 0116 0zm-8-5a.75.75 0 01.75.75v4.5a.75.75 0 01-1.5 0v-4.5A.75.75 0 0110 5zm0 10a1 1 0 100-2 1 1 0 000 2z",clipRule:"evenodd"})),fo=Yt.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",width:"12",height:"12",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"1.5",strokeLinecap:"round",strokeLinejoin:"round"},Yt.createElement("line",{x1:"18",y1:"6",x2:"6",y2:"18"}),Yt.createElement("line",{x1:"6",y1:"6",x2:"18",y2:"18"})),mo=1,go=new class{constructor(){this.subscribe=l=>(this.subscribers.push(l),()=>{let c=this.subscribers.indexOf(l);this.subscribers.splice(c,1)}),this.publish=l=>{this.subscribers.forEach((c=>c(l)))},this.addToast=l=>{this.publish(l),this.toasts=[...this.toasts,l]},this.create=l=>{var c;let{message:d,...h}=l,p="number"==typeof(null==l?void 0:l.id)||(null==(c=l.id)?void 0:c.length)>0?l.id:mo++,f=this.toasts.find((l=>l.id===p)),m=void 0===l.dismissible||l.dismissible;return this.dismissedToasts.has(p)&&this.dismissedToasts.delete(p),f?this.toasts=this.toasts.map((c=>c.id===p?(this.publish({...c,...l,id:p,title:d}),{...c,...l,id:p,dismissible:m,title:d}):c)):this.addToast({title:d,...h,dismissible:m,id:p}),p},this.dismiss=l=>(this.dismissedToasts.add(l),l||this.toasts.forEach((l=>{this.subscribers.forEach((c=>c({id:l.id,dismiss:!0})))})),this.subscribers.forEach((c=>c({id:l,dismiss:!0}))),l),this.message=(l,c)=>this.create({...c,message:l}),this.error=(l,c)=>this.create({...c,message:l,type:"error"}),this.success=(l,c)=>this.create({...c,type:"success",message:l}),this.info=(l,c)=>this.create({...c,type:"info",message:l}),this.warning=(l,c)=>this.create({...c,type:"warning",message:l}),this.loading=(l,c)=>this.create({...c,type:"loading",message:l}),this.promise=(l,c)=>{if(!c)return;let d;void 0!==c.loading&&(d=this.create({...c,promise:l,type:"loading",message:c.loading,description:"function"!=typeof c.description?c.description:void 0}));let h,p=l instanceof Promise?l:l(),f=void 0!==d,m=p.then((async l=>{if(h=["resolve",l],Yt.isValidElement(l))f=!1,this.create({id:d,type:"default",message:l});else if(ie$1(l)&&!l.ok){f=!1;let h="function"==typeof c.error?await c.error(`HTTP error! status: ${l.status}`):c.error,p="function"==typeof c.description?await c.description(`HTTP error! status: ${l.status}`):c.description;this.create({id:d,type:"error",message:h,description:p})}else if(void 0!==c.success){f=!1;let h="function"==typeof c.success?await c.success(l):c.success,p="function"==typeof c.description?await c.description(l):c.description;this.create({id:d,type:"success",message:h,description:p})}})).catch((async l=>{if(h=["reject",l],void 0!==c.error){f=!1;let h="function"==typeof c.error?await c.error(l):c.error,p="function"==typeof c.description?await c.description(l):c.description;this.create({id:d,type:"error",message:h,description:p})}})).finally((()=>{var l;f&&(this.dismiss(d),d=void 0),null==(l=c.finally)||l.call(c)})),g2=()=>new Promise(((l,c)=>m.then((()=>"reject"===h[0]?c(h[1]):l(h[1]))).catch(c)));return"string"!=typeof d&&"number"!=typeof d?{unwrap:g2}:Object.assign(d,{unwrap:g2})},this.custom=(l,c)=>{let d=(null==c?void 0:c.id)||mo++;return this.create({jsx:l(d),id:d,...c}),d},this.getActiveToasts=()=>this.toasts.filter((l=>!this.dismissedToasts.has(l.id))),this.subscribers=[],this.toasts=[],this.dismissedToasts=new Set}},ie$1=l=>l&&"object"==typeof l&&"ok"in l&&"boolean"==typeof l.ok&&"status"in l&&"number"==typeof l.status,le$2=(l,c)=>{let d=(null==c?void 0:c.id)||mo++;return go.addToast({title:l,...c,id:d}),d},vo=Object.assign(le$2,{success:go.success,info:go.info,warning:go.warning,error:go.error,custom:go.custom,message:go.message,promise:go.promise,dismiss:go.dismiss,loading:go.loading},{getHistory:()=>go.toasts,getToasts:()=>go.getActiveToasts()});function tt$1(l){return void 0!==l.label}!function(l,{insertAt:c}={}){if("undefined"==typeof document)return;let d=document.head||document.getElementsByTagName("head")[0],h=document.createElement("style");h.type="text/css","top"===c&&d.firstChild?d.insertBefore(h,d.firstChild):d.appendChild(h),h.styleSheet?h.styleSheet.cssText=l:h.appendChild(document.createTextNode(l))}(':where(html[dir="ltr"]),:where([data-sonner-toaster][dir="ltr"]){--toast-icon-margin-start: -3px;--toast-icon-margin-end: 4px;--toast-svg-margin-start: -1px;--toast-svg-margin-end: 0px;--toast-button-margin-start: auto;--toast-button-margin-end: 0;--toast-close-button-start: 0;--toast-close-button-end: unset;--toast-close-button-transform: translate(-35%, -35%)}:where(html[dir="rtl"]),:where([data-sonner-toaster][dir="rtl"]){--toast-icon-margin-start: 4px;--toast-icon-margin-end: -3px;--toast-svg-margin-start: 0px;--toast-svg-margin-end: -1px;--toast-button-margin-start: 0;--toast-button-margin-end: auto;--toast-close-button-start: unset;--toast-close-button-end: 0;--toast-close-button-transform: translate(35%, -35%)}:where([data-sonner-toaster]){position:fixed;width:var(--width);font-family:ui-sans-serif,system-ui,-apple-system,BlinkMacSystemFont,Segoe UI,Roboto,Helvetica Neue,Arial,Noto Sans,sans-serif,Apple Color Emoji,Segoe UI Emoji,Segoe UI Symbol,Noto Color Emoji;--gray1: hsl(0, 0%, 99%);--gray2: hsl(0, 0%, 97.3%);--gray3: hsl(0, 0%, 95.1%);--gray4: hsl(0, 0%, 93%);--gray5: hsl(0, 0%, 90.9%);--gray6: hsl(0, 0%, 88.7%);--gray7: hsl(0, 0%, 85.8%);--gray8: hsl(0, 0%, 78%);--gray9: hsl(0, 0%, 56.1%);--gray10: hsl(0, 0%, 52.3%);--gray11: hsl(0, 0%, 43.5%);--gray12: hsl(0, 0%, 9%);--border-radius: 8px;box-sizing:border-box;padding:0;margin:0;list-style:none;outline:none;z-index:999999999;transition:transform .4s ease}:where([data-sonner-toaster][data-lifted="true"]){transform:translateY(-10px)}@media (hover: none) and (pointer: coarse){:where([data-sonner-toaster][data-lifted="true"]){transform:none}}:where([data-sonner-toaster][data-x-position="right"]){right:var(--offset-right)}:where([data-sonner-toaster][data-x-position="left"]){left:var(--offset-left)}:where([data-sonner-toaster][data-x-position="center"]){left:50%;transform:translate(-50%)}:where([data-sonner-toaster][data-y-position="top"]){top:var(--offset-top)}:where([data-sonner-toaster][data-y-position="bottom"]){bottom:var(--offset-bottom)}:where([data-sonner-toast]){--y: translateY(100%);--lift-amount: calc(var(--lift) * var(--gap));z-index:var(--z-index);position:absolute;opacity:0;transform:var(--y);filter:blur(0);touch-action:none;transition:transform .4s,opacity .4s,height .4s,box-shadow .2s;box-sizing:border-box;outline:none;overflow-wrap:anywhere}:where([data-sonner-toast][data-styled="true"]){padding:16px;background:var(--normal-bg);border:1px solid var(--normal-border);color:var(--normal-text);border-radius:var(--border-radius);box-shadow:0 4px 12px #0000001a;width:var(--width);font-size:13px;display:flex;align-items:center;gap:6px}:where([data-sonner-toast]:focus-visible){box-shadow:0 4px 12px #0000001a,0 0 0 2px #0003}:where([data-sonner-toast][data-y-position="top"]){top:0;--y: translateY(-100%);--lift: 1;--lift-amount: calc(1 * var(--gap))}:where([data-sonner-toast][data-y-position="bottom"]){bottom:0;--y: translateY(100%);--lift: -1;--lift-amount: calc(var(--lift) * var(--gap))}:where([data-sonner-toast]) :where([data-description]){font-weight:400;line-height:1.4;color:inherit}:where([data-sonner-toast]) :where([data-title]){font-weight:500;line-height:1.5;color:inherit}:where([data-sonner-toast]) :where([data-icon]){display:flex;height:16px;width:16px;position:relative;justify-content:flex-start;align-items:center;flex-shrink:0;margin-left:var(--toast-icon-margin-start);margin-right:var(--toast-icon-margin-end)}:where([data-sonner-toast][data-promise="true"]) :where([data-icon])>svg{opacity:0;transform:scale(.8);transform-origin:center;animation:sonner-fade-in .3s ease forwards}:where([data-sonner-toast]) :where([data-icon])>*{flex-shrink:0}:where([data-sonner-toast]) :where([data-icon]) svg{margin-left:var(--toast-svg-margin-start);margin-right:var(--toast-svg-margin-end)}:where([data-sonner-toast]) :where([data-content]){display:flex;flex-direction:column;gap:2px}[data-sonner-toast][data-styled=true] [data-button]{border-radius:4px;padding-left:8px;padding-right:8px;height:24px;font-size:12px;color:var(--normal-bg);background:var(--normal-text);margin-left:var(--toast-button-margin-start);margin-right:var(--toast-button-margin-end);border:none;cursor:pointer;outline:none;display:flex;align-items:center;flex-shrink:0;transition:opacity .4s,box-shadow .2s}:where([data-sonner-toast]) :where([data-button]):focus-visible{box-shadow:0 0 0 2px #0006}:where([data-sonner-toast]) :where([data-button]):first-of-type{margin-left:var(--toast-button-margin-start);margin-right:var(--toast-button-margin-end)}:where([data-sonner-toast]) :where([data-cancel]){color:var(--normal-text);background:rgba(0,0,0,.08)}:where([data-sonner-toast][data-theme="dark"]) :where([data-cancel]){background:rgba(255,255,255,.3)}:where([data-sonner-toast]) :where([data-close-button]){position:absolute;left:var(--toast-close-button-start);right:var(--toast-close-button-end);top:0;height:20px;width:20px;display:flex;justify-content:center;align-items:center;padding:0;color:var(--gray12);border:1px solid var(--gray4);transform:var(--toast-close-button-transform);border-radius:50%;cursor:pointer;z-index:1;transition:opacity .1s,background .2s,border-color .2s}[data-sonner-toast] [data-close-button]{background:var(--gray1)}:where([data-sonner-toast]) :where([data-close-button]):focus-visible{box-shadow:0 4px 12px #0000001a,0 0 0 2px #0003}:where([data-sonner-toast]) :where([data-disabled="true"]){cursor:not-allowed}:where([data-sonner-toast]):hover :where([data-close-button]):hover{background:var(--gray2);border-color:var(--gray5)}:where([data-sonner-toast][data-swiping="true"]):before{content:"";position:absolute;left:-50%;right:-50%;height:100%;z-index:-1}:where([data-sonner-toast][data-y-position="top"][data-swiping="true"]):before{bottom:50%;transform:scaleY(3) translateY(50%)}:where([data-sonner-toast][data-y-position="bottom"][data-swiping="true"]):before{top:50%;transform:scaleY(3) translateY(-50%)}:where([data-sonner-toast][data-swiping="false"][data-removed="true"]):before{content:"";position:absolute;inset:0;transform:scaleY(2)}:where([data-sonner-toast]):after{content:"";position:absolute;left:0;height:calc(var(--gap) + 1px);bottom:100%;width:100%}:where([data-sonner-toast][data-mounted="true"]){--y: translateY(0);opacity:1}:where([data-sonner-toast][data-expanded="false"][data-front="false"]){--scale: var(--toasts-before) * .05 + 1;--y: translateY(calc(var(--lift-amount) * var(--toasts-before))) scale(calc(-1 * var(--scale)));height:var(--front-toast-height)}:where([data-sonner-toast])>*{transition:opacity .4s}:where([data-sonner-toast][data-expanded="false"][data-front="false"][data-styled="true"])>*{opacity:0}:where([data-sonner-toast][data-visible="false"]){opacity:0;pointer-events:none}:where([data-sonner-toast][data-mounted="true"][data-expanded="true"]){--y: translateY(calc(var(--lift) * var(--offset)));height:var(--initial-height)}:where([data-sonner-toast][data-removed="true"][data-front="true"][data-swipe-out="false"]){--y: translateY(calc(var(--lift) * -100%));opacity:0}:where([data-sonner-toast][data-removed="true"][data-front="false"][data-swipe-out="false"][data-expanded="true"]){--y: translateY(calc(var(--lift) * var(--offset) + var(--lift) * -100%));opacity:0}:where([data-sonner-toast][data-removed="true"][data-front="false"][data-swipe-out="false"][data-expanded="false"]){--y: translateY(40%);opacity:0;transition:transform .5s,opacity .2s}:where([data-sonner-toast][data-removed="true"][data-front="false"]):before{height:calc(var(--initial-height) + 20%)}[data-sonner-toast][data-swiping=true]{transform:var(--y) translateY(var(--swipe-amount-y, 0px)) translate(var(--swipe-amount-x, 0px));transition:none}[data-sonner-toast][data-swiped=true]{user-select:none}[data-sonner-toast][data-swipe-out=true][data-y-position=bottom],[data-sonner-toast][data-swipe-out=true][data-y-position=top]{animation-duration:.2s;animation-timing-function:ease-out;animation-fill-mode:forwards}[data-sonner-toast][data-swipe-out=true][data-swipe-direction=left]{animation-name:swipe-out-left}[data-sonner-toast][data-swipe-out=true][data-swipe-direction=right]{animation-name:swipe-out-right}[data-sonner-toast][data-swipe-out=true][data-swipe-direction=up]{animation-name:swipe-out-up}[data-sonner-toast][data-swipe-out=true][data-swipe-direction=down]{animation-name:swipe-out-down}@keyframes swipe-out-left{0%{transform:var(--y) translate(var(--swipe-amount-x));opacity:1}to{transform:var(--y) translate(calc(var(--swipe-amount-x) - 100%));opacity:0}}@keyframes swipe-out-right{0%{transform:var(--y) translate(var(--swipe-amount-x));opacity:1}to{transform:var(--y) translate(calc(var(--swipe-amount-x) + 100%));opacity:0}}@keyframes swipe-out-up{0%{transform:var(--y) translateY(var(--swipe-amount-y));opacity:1}to{transform:var(--y) translateY(calc(var(--swipe-amount-y) - 100%));opacity:0}}@keyframes swipe-out-down{0%{transform:var(--y) translateY(var(--swipe-amount-y));opacity:1}to{transform:var(--y) translateY(calc(var(--swipe-amount-y) + 100%));opacity:0}}@media (max-width: 600px){[data-sonner-toaster]{position:fixed;right:var(--mobile-offset-right);left:var(--mobile-offset-left);width:100%}[data-sonner-toaster][dir=rtl]{left:calc(var(--mobile-offset-left) * -1)}[data-sonner-toaster] [data-sonner-toast]{left:0;right:0;width:calc(100% - var(--mobile-offset-left) * 2)}[data-sonner-toaster][data-x-position=left]{left:var(--mobile-offset-left)}[data-sonner-toaster][data-y-position=bottom]{bottom:var(--mobile-offset-bottom)}[data-sonner-toaster][data-y-position=top]{top:var(--mobile-offset-top)}[data-sonner-toaster][data-x-position=center]{left:var(--mobile-offset-left);right:var(--mobile-offset-right);transform:none}}[data-sonner-toaster][data-theme=light]{--normal-bg: #fff;--normal-border: var(--gray4);--normal-text: var(--gray12);--success-bg: hsl(143, 85%, 96%);--success-border: hsl(145, 92%, 91%);--success-text: hsl(140, 100%, 27%);--info-bg: hsl(208, 100%, 97%);--info-border: hsl(221, 91%, 91%);--info-text: hsl(210, 92%, 45%);--warning-bg: hsl(49, 100%, 97%);--warning-border: hsl(49, 91%, 91%);--warning-text: hsl(31, 92%, 45%);--error-bg: hsl(359, 100%, 97%);--error-border: hsl(359, 100%, 94%);--error-text: hsl(360, 100%, 45%)}[data-sonner-toaster][data-theme=light] [data-sonner-toast][data-invert=true]{--normal-bg: #000;--normal-border: hsl(0, 0%, 20%);--normal-text: var(--gray1)}[data-sonner-toaster][data-theme=dark] [data-sonner-toast][data-invert=true]{--normal-bg: #fff;--normal-border: var(--gray3);--normal-text: var(--gray12)}[data-sonner-toaster][data-theme=dark]{--normal-bg: #000;--normal-bg-hover: hsl(0, 0%, 12%);--normal-border: hsl(0, 0%, 20%);--normal-border-hover: hsl(0, 0%, 25%);--normal-text: var(--gray1);--success-bg: hsl(150, 100%, 6%);--success-border: hsl(147, 100%, 12%);--success-text: hsl(150, 86%, 65%);--info-bg: hsl(215, 100%, 6%);--info-border: hsl(223, 100%, 12%);--info-text: hsl(216, 87%, 65%);--warning-bg: hsl(64, 100%, 6%);--warning-border: hsl(60, 100%, 12%);--warning-text: hsl(46, 87%, 65%);--error-bg: hsl(358, 76%, 10%);--error-border: hsl(357, 89%, 16%);--error-text: hsl(358, 100%, 81%)}[data-sonner-toaster][data-theme=dark] [data-sonner-toast] [data-close-button]{background:var(--normal-bg);border-color:var(--normal-border);color:var(--normal-text)}[data-sonner-toaster][data-theme=dark] [data-sonner-toast] [data-close-button]:hover{background:var(--normal-bg-hover);border-color:var(--normal-border-hover)}[data-rich-colors=true][data-sonner-toast][data-type=success],[data-rich-colors=true][data-sonner-toast][data-type=success] [data-close-button]{background:var(--success-bg);border-color:var(--success-border);color:var(--success-text)}[data-rich-colors=true][data-sonner-toast][data-type=info],[data-rich-colors=true][data-sonner-toast][data-type=info] [data-close-button]{background:var(--info-bg);border-color:var(--info-border);color:var(--info-text)}[data-rich-colors=true][data-sonner-toast][data-type=warning],[data-rich-colors=true][data-sonner-toast][data-type=warning] [data-close-button]{background:var(--warning-bg);border-color:var(--warning-border);color:var(--warning-text)}[data-rich-colors=true][data-sonner-toast][data-type=error],[data-rich-colors=true][data-sonner-toast][data-type=error] [data-close-button]{background:var(--error-bg);border-color:var(--error-border);color:var(--error-text)}.sonner-loading-wrapper{--size: 16px;height:var(--size);width:var(--size);position:absolute;inset:0;z-index:10}.sonner-loading-wrapper[data-visible=false]{transform-origin:center;animation:sonner-fade-out .2s ease forwards}.sonner-spinner{position:relative;top:50%;left:50%;height:var(--size);width:var(--size)}.sonner-loading-bar{animation:sonner-spin 1.2s linear infinite;background:var(--gray11);border-radius:6px;height:8%;left:-10%;position:absolute;top:-3.9%;width:24%}.sonner-loading-bar:nth-child(1){animation-delay:-1.2s;transform:rotate(.0001deg) translate(146%)}.sonner-loading-bar:nth-child(2){animation-delay:-1.1s;transform:rotate(30deg) translate(146%)}.sonner-loading-bar:nth-child(3){animation-delay:-1s;transform:rotate(60deg) translate(146%)}.sonner-loading-bar:nth-child(4){animation-delay:-.9s;transform:rotate(90deg) translate(146%)}.sonner-loading-bar:nth-child(5){animation-delay:-.8s;transform:rotate(120deg) translate(146%)}.sonner-loading-bar:nth-child(6){animation-delay:-.7s;transform:rotate(150deg) translate(146%)}.sonner-loading-bar:nth-child(7){animation-delay:-.6s;transform:rotate(180deg) translate(146%)}.sonner-loading-bar:nth-child(8){animation-delay:-.5s;transform:rotate(210deg) translate(146%)}.sonner-loading-bar:nth-child(9){animation-delay:-.4s;transform:rotate(240deg) translate(146%)}.sonner-loading-bar:nth-child(10){animation-delay:-.3s;transform:rotate(270deg) translate(146%)}.sonner-loading-bar:nth-child(11){animation-delay:-.2s;transform:rotate(300deg) translate(146%)}.sonner-loading-bar:nth-child(12){animation-delay:-.1s;transform:rotate(330deg) translate(146%)}@keyframes sonner-fade-in{0%{opacity:0;transform:scale(.8)}to{opacity:1;transform:scale(1)}}@keyframes sonner-fade-out{0%{opacity:1;transform:scale(1)}to{opacity:0;transform:scale(.8)}}@keyframes sonner-spin{0%{opacity:1}to{opacity:.15}}@media (prefers-reduced-motion){[data-sonner-toast],[data-sonner-toast]>*,.sonner-loading-bar{transition:none!important;animation:none!important}}.sonner-loader{position:absolute;top:50%;left:50%;transform:translate(-50%,-50%);transform-origin:center;transition:opacity .2s,transform .2s}.sonner-loader[data-visible=false]{opacity:0;transform:scale(.8) translate(-50%,-50%)}\n');var yo=3,_o=14;function M$1(...l){return l.filter(Boolean).join(" ")}var ve$1=l=>{var c,d,h,p,f,m,y,_,b,w,E;let{invert:M,toast:N,unstyled:P,interacting:L,setHeights:j,visibleToasts:D,heights:F,index:U,toasts:B,expanded:H,removeToast:z,defaultRichColors:q,closeButton:V,style:Z,cancelButtonStyle:K,actionButtonStyle:Y,className:ee="",descriptionClassName:ne="",duration:se,position:ie,gap:oe,loadingIcon:le,expandByDefault:ce,classNames:pe,icons:fe,closeButtonAriaLabel:ge="Close toast",pauseWhenPageIsHidden:be}=l,[Oe,Ne]=Yt.useState(null),[De,Fe]=Yt.useState(null),[Ue,Be]=Yt.useState(!1),[He,qe]=Yt.useState(!1),[Ve,Je]=Yt.useState(!1),[tt,nt]=Yt.useState(!1),[it,ht]=Yt.useState(!1),[ft,gt]=Yt.useState(0),[yt,_t]=Yt.useState(0),bt=Yt.useRef(N.duration||se||4e3),wt=Yt.useRef(null),St=Yt.useRef(null),xt=0===U,kt=U+1<=D,Et=N.type,It=!1!==N.dismissible,Tt=N.className||"",At=N.descriptionClassName||"",Ot=Yt.useMemo((()=>F.findIndex((l=>l.toastId===N.id))||0),[F,N.id]),Mt=Yt.useMemo((()=>{var l;return null!=(l=N.closeButton)?l:V}),[N.closeButton,V]),Nt=Yt.useMemo((()=>N.duration||se||4e3),[N.duration,se]),Pt=Yt.useRef(0),Lt=Yt.useRef(0),jt=Yt.useRef(0),Dt=Yt.useRef(null),[Ft,Bt]=ie.split("-"),Ht=Yt.useMemo((()=>F.reduce(((l,c,d)=>d>=Ot?l:l+c.height),0)),[F,Ot]),Wt=(()=>{let[l,c]=Yt.useState(document.hidden);return Yt.useEffect((()=>{let t2=()=>{c(document.hidden)};return document.addEventListener("visibilitychange",t2),()=>window.removeEventListener("visibilitychange",t2)}),[]),l})(),Vt=N.invert||M,Zt="loading"===Et;Lt.current=Yt.useMemo((()=>Ot*oe+Ht),[Ot,Ht]),Yt.useEffect((()=>{bt.current=Nt}),[Nt]),Yt.useEffect((()=>{Be(!0)}),[]),Yt.useEffect((()=>{let l=St.current;if(l){let c=l.getBoundingClientRect().height;return _t(c),j((l=>[{toastId:N.id,height:c,position:N.position},...l])),()=>j((l=>l.filter((l=>l.toastId!==N.id))))}}),[j,N.id]),Yt.useLayoutEffect((()=>{if(!Ue)return;let l=St.current,c=l.style.height;l.style.height="auto";let d=l.getBoundingClientRect().height;l.style.height=c,_t(d),j((l=>l.find((l=>l.toastId===N.id))?l.map((l=>l.toastId===N.id?{...l,height:d}:l)):[{toastId:N.id,height:d,position:N.position},...l]))}),[Ue,N.title,N.description,j,N.id]);let Kt=Yt.useCallback((()=>{qe(!0),gt(Lt.current),j((l=>l.filter((l=>l.toastId!==N.id)))),setTimeout((()=>{z(N)}),200)}),[N,z,j,Lt]);return Yt.useEffect((()=>{if(N.promise&&"loading"===Et||N.duration===1/0||"loading"===N.type)return;let l;return H||L||be&&Wt?(()=>{if(jt.current<Pt.current){let l=(new Date).getTime()-Pt.current;bt.current=bt.current-l}jt.current=(new Date).getTime()})():bt.current!==1/0&&(Pt.current=(new Date).getTime(),l=setTimeout((()=>{var l;null==(l=N.onAutoClose)||l.call(N,N),Kt()}),bt.current)),()=>clearTimeout(l)}),[H,L,N,Et,be,Wt,Kt]),Yt.useEffect((()=>{N.delete&&Kt()}),[Kt,N.delete]),Yt.createElement("li",{tabIndex:0,ref:St,className:M$1(ee,Tt,null==pe?void 0:pe.toast,null==(c=null==N?void 0:N.classNames)?void 0:c.toast,null==pe?void 0:pe.default,null==pe?void 0:pe[Et],null==(d=null==N?void 0:N.classNames)?void 0:d[Et]),"data-sonner-toast":"","data-rich-colors":null!=(h=N.richColors)?h:q,"data-styled":!(N.jsx||N.unstyled||P),"data-mounted":Ue,"data-promise":!!N.promise,"data-swiped":it,"data-removed":He,"data-visible":kt,"data-y-position":Ft,"data-x-position":Bt,"data-index":U,"data-front":xt,"data-swiping":Ve,"data-dismissible":It,"data-type":Et,"data-invert":Vt,"data-swipe-out":tt,"data-swipe-direction":De,"data-expanded":!!(H||ce&&Ue),style:{"--index":U,"--toasts-before":U,"--z-index":B.length-U,"--offset":`${He?ft:Lt.current}px`,"--initial-height":ce?"auto":`${yt}px`,...Z,...N.style},onDragEnd:()=>{Je(!1),Ne(null),Dt.current=null},onPointerDown:l=>{Zt||!It||(wt.current=new Date,gt(Lt.current),l.target.setPointerCapture(l.pointerId),"BUTTON"!==l.target.tagName&&(Je(!0),Dt.current={x:l.clientX,y:l.clientY}))},onPointerUp:()=>{var l,c,d,h;if(tt||!It)return;Dt.current=null;let p=Number((null==(l=St.current)?void 0:l.style.getPropertyValue("--swipe-amount-x").replace("px",""))||0),f=Number((null==(c=St.current)?void 0:c.style.getPropertyValue("--swipe-amount-y").replace("px",""))||0),m=(new Date).getTime()-(null==(d=wt.current)?void 0:d.getTime()),y="x"===Oe?p:f,_=Math.abs(y)/m;if(Math.abs(y)>=20||_>.11)return gt(Lt.current),null==(h=N.onDismiss)||h.call(N,N),Fe("x"===Oe?p>0?"right":"left":f>0?"down":"up"),Kt(),nt(!0),void ht(!1);Je(!1),Ne(null)},onPointerMove:c=>{var d,h,p,f;if(!Dt.current||!It||(null==(d=window.getSelection())?void 0:d.toString().length)>0)return;let m=c.clientY-Dt.current.y,y=c.clientX-Dt.current.x,_=null!=(h=l.swipeDirections)?h:function(l){let[c,d]=l.split("-"),h=[];return c&&h.push(c),d&&h.push(d),h}(ie);!Oe&&(Math.abs(y)>1||Math.abs(m)>1)&&Ne(Math.abs(y)>Math.abs(m)?"x":"y");let b={x:0,y:0};"y"===Oe?(_.includes("top")||_.includes("bottom"))&&(_.includes("top")&&m<0||_.includes("bottom")&&m>0)&&(b.y=m):"x"===Oe&&(_.includes("left")||_.includes("right"))&&(_.includes("left")&&y<0||_.includes("right")&&y>0)&&(b.x=y),(Math.abs(b.x)>0||Math.abs(b.y)>0)&&ht(!0),null==(p=St.current)||p.style.setProperty("--swipe-amount-x",`${b.x}px`),null==(f=St.current)||f.style.setProperty("--swipe-amount-y",`${b.y}px`)}},Mt&&!N.jsx?Yt.createElement("button",{"aria-label":ge,"data-disabled":Zt,"data-close-button":!0,onClick:Zt||!It?()=>{}:()=>{var l;Kt(),null==(l=N.onDismiss)||l.call(N,N)},className:M$1(null==pe?void 0:pe.closeButton,null==(p=null==N?void 0:N.classNames)?void 0:p.closeButton)},null!=(f=null==fe?void 0:fe.close)?f:fo):null,N.jsx||Gt.isValidElement(N.title)?N.jsx?N.jsx:"function"==typeof N.title?N.title():N.title:Yt.createElement(Yt.Fragment,null,Et||N.icon||N.promise?Yt.createElement("div",{"data-icon":"",className:M$1(null==pe?void 0:pe.icon,null==(m=null==N?void 0:N.classNames)?void 0:m.icon)},N.promise||"loading"===N.type&&!N.icon?N.icon||(null!=fe&&fe.loading?Yt.createElement("div",{className:M$1(null==pe?void 0:pe.loader,null==(Qt=null==N?void 0:N.classNames)?void 0:Qt.loader,"sonner-loader"),"data-visible":"loading"===Et},fe.loading):le?Yt.createElement("div",{className:M$1(null==pe?void 0:pe.loader,null==(er=null==N?void 0:N.classNames)?void 0:er.loader,"sonner-loader"),"data-visible":"loading"===Et},le):Yt.createElement(Yt$1,{className:M$1(null==pe?void 0:pe.loader,null==(tr=null==N?void 0:N.classNames)?void 0:tr.loader),visible:"loading"===Et})):null,"loading"!==N.type?N.icon||(null==fe?void 0:fe[Et])||(l=>{switch(l){case"success":return ao;case"info":return ho;case"warning":return co;case"error":return po;default:return null}})(Et):null):null,Yt.createElement("div",{"data-content":"",className:M$1(null==pe?void 0:pe.content,null==(y=null==N?void 0:N.classNames)?void 0:y.content)},Yt.createElement("div",{"data-title":"",className:M$1(null==pe?void 0:pe.title,null==(_=null==N?void 0:N.classNames)?void 0:_.title)},"function"==typeof N.title?N.title():N.title),N.description?Yt.createElement("div",{"data-description":"",className:M$1(ne,At,null==pe?void 0:pe.description,null==(b=null==N?void 0:N.classNames)?void 0:b.description)},"function"==typeof N.description?N.description():N.description):null),Gt.isValidElement(N.cancel)?N.cancel:N.cancel&&tt$1(N.cancel)?Yt.createElement("button",{"data-button":!0,"data-cancel":!0,style:N.cancelButtonStyle||K,onClick:l=>{var c,d;tt$1(N.cancel)&&It&&(null==(d=(c=N.cancel).onClick)||d.call(c,l),Kt())},className:M$1(null==pe?void 0:pe.cancelButton,null==(w=null==N?void 0:N.classNames)?void 0:w.cancelButton)},N.cancel.label):null,Gt.isValidElement(N.action)?N.action:N.action&&tt$1(N.action)?Yt.createElement("button",{"data-button":!0,"data-action":!0,style:N.actionButtonStyle||Y,onClick:l=>{var c,d;tt$1(N.action)&&(null==(d=(c=N.action).onClick)||d.call(c,l),!l.defaultPrevented&&Kt())},className:M$1(null==pe?void 0:pe.actionButton,null==(E=null==N?void 0:N.classNames)?void 0:E.actionButton)},N.action.label):null));var Qt,er,tr};function _t$2(){if("undefined"==typeof window||"undefined"==typeof document)return"ltr";let l=document.documentElement.getAttribute("dir");return"auto"!==l&&l?l:window.getComputedStyle(document.documentElement).direction}function Te$2(l,c){let d={};return[l,c].forEach(((l,c)=>{let h=1===c,p=h?"--mobile-offset":"--offset",f=h?"16px":"32px";function g2(l){["top","right","bottom","left"].forEach((c=>{d[`${p}-${c}`]="number"==typeof l?`${l}px`:l}))}"number"==typeof l||"string"==typeof l?g2(l):"object"==typeof l?["top","right","bottom","left"].forEach((c=>{void 0===l[c]?d[`${p}-${c}`]=f:d[`${p}-${c}`]="number"==typeof l[c]?`${l[c]}px`:l[c]})):g2(f)})),d}var bo=Gt.forwardRef((function(l,c){let{invert:d,position:h="bottom-right",hotkey:p=["altKey","KeyT"],expand:f,closeButton:m,className:y,offset:_,mobileOffset:b,theme:w="light",richColors:E,duration:M,style:N,visibleToasts:P=yo,toastOptions:L,dir:j=_t$2(),gap:D=_o,loadingIcon:F,icons:U,containerAriaLabel:B="Notifications",pauseWhenPageIsHidden:H}=l,[z,q]=Yt.useState([]),V=Yt.useMemo((()=>Array.from(new Set([h].concat(z.filter((l=>l.position)).map((l=>l.position)))))),[z,h]),[Z,K]=Yt.useState([]),[Y,ee]=Yt.useState(!1),[ne,se]=Yt.useState(!1),[ie,oe]=Yt.useState("system"!==w?w:"undefined"!=typeof window&&window.matchMedia&&window.matchMedia("(prefers-color-scheme: dark)").matches?"dark":"light"),le=Yt.useRef(null),ce=p.join("+").replace(/Key/g,"").replace(/Digit/g,""),pe=Yt.useRef(null),fe=Yt.useRef(!1),ge=Yt.useCallback((l=>{q((c=>{var d;return null!=(d=c.find((c=>c.id===l.id)))&&d.delete||go.dismiss(l.id),c.filter((({id:c})=>c!==l.id))}))}),[]);return Yt.useEffect((()=>go.subscribe((l=>{l.dismiss?q((c=>c.map((c=>c.id===l.id?{...c,delete:!0}:c)))):setTimeout((()=>{Qt.flushSync((()=>{q((c=>{let d=c.findIndex((c=>c.id===l.id));return-1!==d?[...c.slice(0,d),{...c[d],...l},...c.slice(d+1)]:[l,...c]}))}))}))}))),[]),Yt.useEffect((()=>{if("system"!==w)return void oe(w);if("system"===w&&(window.matchMedia&&window.matchMedia("(prefers-color-scheme: dark)").matches?oe("dark"):oe("light")),"undefined"==typeof window)return;let l=window.matchMedia("(prefers-color-scheme: dark)");try{l.addEventListener("change",(({matches:l})=>{oe(l?"dark":"light")}))}catch(c){l.addListener((({matches:l})=>{try{oe(l?"dark":"light")}catch(c){console.error(c)}}))}}),[w]),Yt.useEffect((()=>{z.length<=1&&ee(!1)}),[z]),Yt.useEffect((()=>{let d2=l=>{var c,d;p.every((c=>l[c]||l.code===c))&&(ee(!0),null==(c=le.current)||c.focus()),"Escape"===l.code&&(document.activeElement===le.current||null!=(d=le.current)&&d.contains(document.activeElement))&&ee(!1)};return document.addEventListener("keydown",d2),()=>document.removeEventListener("keydown",d2)}),[p]),Yt.useEffect((()=>{if(le.current)return()=>{pe.current&&(pe.current.focus({preventScroll:!0}),pe.current=null,fe.current=!1)}}),[le.current]),Yt.createElement("section",{ref:c,"aria-label":`${B} ${ce}`,tabIndex:-1,"aria-live":"polite","aria-relevant":"additions text","aria-atomic":"false",suppressHydrationWarning:!0},V.map(((c,h)=>{var p;let[w,B]=c.split("-");return z.length?Yt.createElement("ol",{key:c,dir:"auto"===j?_t$2():j,tabIndex:-1,ref:le,className:y,"data-sonner-toaster":!0,"data-theme":ie,"data-y-position":w,"data-lifted":Y&&z.length>1&&!f,"data-x-position":B,style:{"--front-toast-height":`${(null==(p=Z[0])?void 0:p.height)||0}px`,"--width":"356px","--gap":`${D}px`,...N,...Te$2(_,b)},onBlur:l=>{fe.current&&!l.currentTarget.contains(l.relatedTarget)&&(fe.current=!1,pe.current&&(pe.current.focus({preventScroll:!0}),pe.current=null))},onFocus:l=>{l.target instanceof HTMLElement&&"false"===l.target.dataset.dismissible||fe.current||(fe.current=!0,pe.current=l.relatedTarget)},onMouseEnter:()=>ee(!0),onMouseMove:()=>ee(!0),onMouseLeave:()=>{ne||ee(!1)},onDragEnd:()=>ee(!1),onPointerDown:l=>{l.target instanceof HTMLElement&&"false"===l.target.dataset.dismissible||se(!0)},onPointerUp:()=>se(!1)},z.filter((l=>!l.position&&0===h||l.position===c)).map(((h,p)=>{var y,_;return Yt.createElement(ve$1,{key:h.id,icons:U,index:p,toast:h,defaultRichColors:E,duration:null!=(y=null==L?void 0:L.duration)?y:M,className:null==L?void 0:L.className,descriptionClassName:null==L?void 0:L.descriptionClassName,invert:d,visibleToasts:P,closeButton:null!=(_=null==L?void 0:L.closeButton)?_:m,interacting:ne,position:c,style:null==L?void 0:L.style,unstyled:null==L?void 0:L.unstyled,classNames:null==L?void 0:L.classNames,cancelButtonStyle:null==L?void 0:L.cancelButtonStyle,actionButtonStyle:null==L?void 0:L.actionButtonStyle,removeToast:ge,toasts:z.filter((l=>l.position==h.position)),heights:Z.filter((l=>l.position==h.position)),setHeights:K,expandByDefault:f,gap:D,loadingIcon:F,expanded:Y,pauseWhenPageIsHidden:H,swipeDirections:l.swipeDirections})}))):null})))}));const wo={};function warnOnce(){for(var l=arguments.length,c=new Array(l),d=0;d<l;d++)c[d]=arguments[d];isString$2(c[0])&&wo[c[0]]||(isString$2(c[0])&&(wo[c[0]]=new Date),function(){if(console&&console.warn){for(var l=arguments.length,c=new Array(l),d=0;d<l;d++)c[d]=arguments[d];isString$2(c[0])&&(c[0]=`react-i18next:: ${c[0]}`),console.warn(...c)}}(...c))}const loadedClb=(l,c)=>()=>{if(l.isInitialized)c();else{const initialized=()=>{setTimeout((()=>{l.off("initialized",initialized)}),0),c()};l.on("initialized",initialized)}},loadNamespaces=(l,c,d)=>{l.loadNamespaces(c,loadedClb(l,d))},loadLanguages=(l,c,d,h)=>{isString$2(d)&&(d=[d]),d.forEach((c=>{l.options.ns.indexOf(c)<0&&l.options.ns.push(c)})),l.loadLanguages(c,loadedClb(l,h))},isString$2=l=>"string"==typeof l,So=/&(?:amp|#38|lt|#60|gt|#62|apos|#39|quot|#34|nbsp|#160|copy|#169|reg|#174|hellip|#8230|#x2F|#47);/g,jo={"&amp;":"&","&#38;":"&","&lt;":"<","&#60;":"<","&gt;":">","&#62;":">","&apos;":"'","&#39;":"'","&quot;":'"',"&#34;":'"',"&nbsp;":" ","&#160;":" ","&copy;":"\xa9","&#169;":"\xa9","&reg;":"\xae","&#174;":"\xae","&hellip;":"\u2026","&#8230;":"\u2026","&#x2F;":"/","&#47;":"/"},unescapeHtmlEntity=l=>jo[l];let zo={bindI18n:"languageChanged",bindI18nStore:"",transEmptyNodeValue:"",transSupportBasicHtmlNodes:!0,transWrapTextNodes:"",transKeepBasicHtmlNodesFor:["br","strong","i","p"],useSuspense:!0,unescape:l=>l.replace(So,unescapeHtmlEntity)};const Go=Gt.createContext();class ReportNamespaces{constructor(){__publicField(this,"getUsedNamespaces",(()=>Object.keys(this.usedNamespaces))),this.usedNamespaces={}}addUsedNamespaces(l){l.forEach((l=>{this.usedNamespaces[l]||(this.usedNamespaces[l]=!0)}))}}const alwaysNewT=(l,c,d,h)=>l.getFixedT(c,d,h),useTranslation=function(l){let c=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};const{i18n:d}=c,{i18n:h,defaultNS:p}=Gt.useContext(Go)||{},f=d||h||void 0;if(f&&!f.reportNamespaces&&(f.reportNamespaces=new ReportNamespaces),!f){warnOnce("You will need to pass in an i18next instance by using initReactI18next");const notReadyT=(l,c)=>{return isString$2(c)?c:"object"==typeof(d=c)&&null!==d&&isString$2(c.defaultValue)?c.defaultValue:Array.isArray(l)?l[l.length-1]:l;var d},l=[notReadyT,{},!1];return l.t=notReadyT,l.i18n={},l.ready=!1,l}f.options.react&&void 0!==f.options.react.wait&&warnOnce("It seems you are still using the old wait option, you may migrate to the new useSuspense behaviour.");const m={...zo,...f.options.react,...c},{useSuspense:y,keyPrefix:_}=m;let b=p||f.options&&f.options.defaultNS;b=isString$2(b)?[b]:b||["translation"],f.reportNamespaces.addUsedNamespaces&&f.reportNamespaces.addUsedNamespaces(b);const w=(f.isInitialized||f.initializedStoreOnce)&&b.every((l=>function(l,c){let d=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};return c.languages&&c.languages.length?void 0!==c.options.ignoreJSONStructure?c.hasLoadedNamespace(l,{lng:d.lng,precheck:(c,h)=>{if(d.bindI18n&&d.bindI18n.indexOf("languageChanging")>-1&&c.services.backendConnector.backend&&c.isLanguageChangingTo&&!h(c.isLanguageChangingTo,l))return!1}}):function(l,c){let d=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};const h=c.languages[0],p=!!c.options&&c.options.fallbackLng,f=c.languages[c.languages.length-1];if("cimode"===h.toLowerCase())return!0;const loadNotPending=(l,d)=>{const h=c.services.backendConnector.state[`${l}|${d}`];return-1===h||2===h};return!(d.bindI18n&&d.bindI18n.indexOf("languageChanging")>-1&&c.services.backendConnector.backend&&c.isLanguageChangingTo&&!loadNotPending(c.isLanguageChangingTo,l)||!c.hasResourceBundle(h,l)&&c.services.backendConnector.backend&&(!c.options.resources||c.options.partialBundledLanguages)&&(!loadNotPending(h,l)||p&&!loadNotPending(f,l)))}(l,c,d):(warnOnce("i18n.languages were undefined or empty",c.languages),!0)}(l,f,m))),E=((l,c,d,h)=>Gt.useCallback(alwaysNewT(l,c,d,h),[l,c,d,h]))(f,c.lng||null,"fallback"===m.nsMode?b:b[0],_),getT=()=>E,getNewT=()=>alwaysNewT(f,c.lng||null,"fallback"===m.nsMode?b:b[0],_),[M,N]=Gt.useState(getT);let P=b.join();c.lng&&(P=`${c.lng}${P}`);const L=((l,c)=>{const d=Gt.useRef();return Gt.useEffect((()=>{d.current=l}),[l,c]),d.current})(P),j=Gt.useRef(!0);Gt.useEffect((()=>{const{bindI18n:l,bindI18nStore:d}=m;j.current=!0,w||y||(c.lng?loadLanguages(f,c.lng,b,(()=>{j.current&&N(getNewT)})):loadNamespaces(f,b,(()=>{j.current&&N(getNewT)}))),w&&L&&L!==P&&j.current&&N(getNewT);const boundReset=()=>{j.current&&N(getNewT)};return l&&f&&f.on(l,boundReset),d&&f&&f.store.on(d,boundReset),()=>{j.current=!1,l&&f&&l.split(" ").forEach((l=>f.off(l,boundReset))),d&&f&&d.split(" ").forEach((l=>f.store.off(l,boundReset)))}}),[f,P]),Gt.useEffect((()=>{j.current&&w&&N(getT)}),[f,_,w]);const D=[M,f,w];if(D.t=M,D.i18n=f,D.ready=w,w)return D;if(!w&&!y)return D;throw new Promise((l=>{c.lng?loadLanguages(f,c.lng,b,(()=>l())):loadNamespaces(f,b,(()=>l()))}))};var Ko="object"==typeof globalThis?globalThis:"object"==typeof self?self:"object"==typeof window?window:"object"==typeof global?global:{},Jo="1.9.0",Yo=/^(\d+)\.(\d+)\.(\d+)(-(.+))?$/;var Qo=function(l){var c=new Set([l]),d=new Set,h=l.match(Yo);if(!h)return function(){return!1};var p=+h[1],f=+h[2],m=+h[3];if(null!=h[4])return function(c){return c===l};function _reject(l){return d.add(l),!1}function _accept(l){return c.add(l),!0}return function(l){if(c.has(l))return!0;if(d.has(l))return!1;var h=l.match(Yo);if(!h)return _reject(l);var y=+h[1],_=+h[2],b=+h[3];return null!=h[4]||p!==y?_reject(l):0===p?f===_&&m<=b?_accept(l):_reject(l):f<=_?_accept(l):_reject(l)}}(Jo),Xo=Jo.split(".")[0],ea=Symbol.for("opentelemetry.js.api."+Xo),ta=Ko;function registerGlobal(l,c,d,h){var p;void 0===h&&(h=!1);var f=ta[ea]=null!==(p=ta[ea])&&void 0!==p?p:{version:Jo};if(!h&&f[l]){var m=new Error("@opentelemetry/api: Attempted duplicate registration of API: "+l);return d.error(m.stack||m.message),!1}if(f.version!==Jo){m=new Error("@opentelemetry/api: Registration of version v"+f.version+" for "+l+" does not match previously registered API v"+Jo);return d.error(m.stack||m.message),!1}return f[l]=c,d.debug("@opentelemetry/api: Registered a global for "+l+" v"+Jo+"."),!0}function getGlobal$1(l){var c,d,h=null===(c=ta[ea])||void 0===c?void 0:c.version;if(h&&Qo(h))return null===(d=ta[ea])||void 0===d?void 0:d[l]}function unregisterGlobal(l,c){c.debug("@opentelemetry/api: Unregistering a global for "+l+" v"+Jo+".");var d=ta[ea];d&&delete d[l]}var ra,na,ia=function(){function DiagComponentLogger2(l){this._namespace=l.namespace||"DiagComponentLogger"}return DiagComponentLogger2.prototype.debug=function(){for(var l=[],c=0;c<arguments.length;c++)l[c]=arguments[c];return logProxy("debug",this._namespace,l)},DiagComponentLogger2.prototype.error=function(){for(var l=[],c=0;c<arguments.length;c++)l[c]=arguments[c];return logProxy("error",this._namespace,l)},DiagComponentLogger2.prototype.info=function(){for(var l=[],c=0;c<arguments.length;c++)l[c]=arguments[c];return logProxy("info",this._namespace,l)},DiagComponentLogger2.prototype.warn=function(){for(var l=[],c=0;c<arguments.length;c++)l[c]=arguments[c];return logProxy("warn",this._namespace,l)},DiagComponentLogger2.prototype.verbose=function(){for(var l=[],c=0;c<arguments.length;c++)l[c]=arguments[c];return logProxy("verbose",this._namespace,l)},DiagComponentLogger2}();function logProxy(l,c,d){var h=getGlobal$1("diag");if(h)return d.unshift(c),h[l].apply(h,function(l,c,d){if(d||2===arguments.length)for(var h,p=0,f=c.length;p<f;p++)!h&&p in c||(h||(h=Array.prototype.slice.call(c,0,p)),h[p]=c[p]);return l.concat(h||Array.prototype.slice.call(c))}([],function(l,c){var d="function"==typeof Symbol&&l[Symbol.iterator];if(!d)return l;var h,p,f=d.call(l),m=[];try{for(;(void 0===c||c-- >0)&&!(h=f.next()).done;)m.push(h.value)}catch(y){p={error:y}}finally{try{h&&!h.done&&(d=f.return)&&d.call(f)}finally{if(p)throw p.error}}return m}(d),!1))}(na=ra||(ra={}))[na.NONE=0]="NONE",na[na.ERROR=30]="ERROR",na[na.WARN=50]="WARN",na[na.INFO=60]="INFO",na[na.DEBUG=70]="DEBUG",na[na.VERBOSE=80]="VERBOSE",na[na.ALL=9999]="ALL";var ha=function(){function DiagAPI2(){function _logProxy(l){return function(){for(var c=[],d=0;d<arguments.length;d++)c[d]=arguments[d];var h=getGlobal$1("diag");if(h)return h[l].apply(h,function(l,c,d){if(d||2===arguments.length)for(var h,p=0,f=c.length;p<f;p++)!h&&p in c||(h||(h=Array.prototype.slice.call(c,0,p)),h[p]=c[p]);return l.concat(h||Array.prototype.slice.call(c))}([],function(l,c){var d="function"==typeof Symbol&&l[Symbol.iterator];if(!d)return l;var h,p,f=d.call(l),m=[];try{for(;(void 0===c||c-- >0)&&!(h=f.next()).done;)m.push(h.value)}catch(y){p={error:y}}finally{try{h&&!h.done&&(d=f.return)&&d.call(f)}finally{if(p)throw p.error}}return m}(c),!1))}}var l=this;l.setLogger=function(c,d){var h,p,f;if(void 0===d&&(d={logLevel:ra.INFO}),c===l){var m=new Error("Cannot use diag as the logger for itself. Please use a DiagLogger implementation like ConsoleDiagLogger or a custom implementation");return l.error(null!==(h=m.stack)&&void 0!==h?h:m.message),!1}"number"==typeof d&&(d={logLevel:d});var y=getGlobal$1("diag"),_=function(l,c){function _filterFunc(d,h){var p=c[d];return"function"==typeof p&&l>=h?p.bind(c):function(){}}return l<ra.NONE?l=ra.NONE:l>ra.ALL&&(l=ra.ALL),c=c||{},{error:_filterFunc("error",ra.ERROR),warn:_filterFunc("warn",ra.WARN),info:_filterFunc("info",ra.INFO),debug:_filterFunc("debug",ra.DEBUG),verbose:_filterFunc("verbose",ra.VERBOSE)}}(null!==(p=d.logLevel)&&void 0!==p?p:ra.INFO,c);if(y&&!d.suppressOverrideMessage){var b=null!==(f=(new Error).stack)&&void 0!==f?f:"<failed to generate stacktrace>";y.warn("Current logger will be overwritten from "+b),_.warn("Current logger will overwrite one already registered from "+b)}return registerGlobal("diag",_,l,!0)},l.disable=function(){unregisterGlobal("diag",l)},l.createComponentLogger=function(l){return new ia(l)},l.verbose=_logProxy("verbose"),l.debug=_logProxy("debug"),l.info=_logProxy("info"),l.warn=_logProxy("warn"),l.error=_logProxy("error")}return DiagAPI2.instance=function(){return this._instance||(this._instance=new DiagAPI2),this._instance},DiagAPI2}(),ma=function(){function BaggageImpl2(l){this._entries=l?new Map(l):new Map}return BaggageImpl2.prototype.getEntry=function(l){var c=this._entries.get(l);if(c)return Object.assign({},c)},BaggageImpl2.prototype.getAllEntries=function(){return Array.from(this._entries.entries()).map((function(l){var c=function(l,c){var d="function"==typeof Symbol&&l[Symbol.iterator];if(!d)return l;var h,p,f=d.call(l),m=[];try{for(;(void 0===c||c-- >0)&&!(h=f.next()).done;)m.push(h.value)}catch(y){p={error:y}}finally{try{h&&!h.done&&(d=f.return)&&d.call(f)}finally{if(p)throw p.error}}return m}(l,2);return[c[0],c[1]]}))},BaggageImpl2.prototype.setEntry=function(l,c){var d=new BaggageImpl2(this._entries);return d._entries.set(l,c),d},BaggageImpl2.prototype.removeEntry=function(l){var c=new BaggageImpl2(this._entries);return c._entries.delete(l),c},BaggageImpl2.prototype.removeEntries=function(){for(var l,c,d=[],h=0;h<arguments.length;h++)d[h]=arguments[h];var p=new BaggageImpl2(this._entries);try{for(var f=function(l){var c="function"==typeof Symbol&&Symbol.iterator,d=c&&l[c],h=0;if(d)return d.call(l);if(l&&"number"==typeof l.length)return{next:function(){return l&&h>=l.length&&(l=void 0),{value:l&&l[h++],done:!l}}};throw new TypeError(c?"Object is not iterable.":"Symbol.iterator is not defined.")}(d),m=f.next();!m.done;m=f.next()){var y=m.value;p._entries.delete(y)}}catch(_){l={error:_}}finally{try{m&&!m.done&&(c=f.return)&&c.call(f)}finally{if(l)throw l.error}}return p},BaggageImpl2.prototype.clear=function(){return new BaggageImpl2},BaggageImpl2}(),ya=Symbol("BaggageEntryMetadata"),ba=ha.instance();function createBaggage(l){return void 0===l&&(l={}),new ma(new Map(Object.entries(l)))}function createContextKey(l){return Symbol.for(l)}var wa,Sa,xa=new(function(){return function BaseContext2(l){var c=this;c._currentContext=l?new Map(l):new Map,c.getValue=function(l){return c._currentContext.get(l)},c.setValue=function(l,d){var h=new BaseContext2(c._currentContext);return h._currentContext.set(l,d),h},c.deleteValue=function(l){var d=new BaseContext2(c._currentContext);return d._currentContext.delete(l),d}}}()),ka=[{n:"error",c:"error"},{n:"warn",c:"warn"},{n:"info",c:"info"},{n:"debug",c:"debug"},{n:"verbose",c:"trace"}],Ca=function(){return function(){function _consoleFunc(l){return function(){for(var c=[],d=0;d<arguments.length;d++)c[d]=arguments[d];if(console){var h=console[l];if("function"!=typeof h&&(h=console.log),"function"==typeof h)return h.apply(console,c)}}}for(var l=0;l<ka.length;l++)this[ka[l].n]=_consoleFunc(ka[l].c)}}(),Ea=function(){var extendStatics=function(l,c){return(extendStatics=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(l,c){l.__proto__=c}||function(l,c){for(var d in c)Object.prototype.hasOwnProperty.call(c,d)&&(l[d]=c[d])})(l,c)};return function(l,c){if("function"!=typeof c&&null!==c)throw new TypeError("Class extends value "+String(c)+" is not a constructor or null");function __(){this.constructor=l}extendStatics(l,c),l.prototype=null===c?Object.create(c):(__.prototype=c.prototype,new __)}}(),Ia=function(){function NoopMeter2(){}return NoopMeter2.prototype.createGauge=function(l,c){return Ya},NoopMeter2.prototype.createHistogram=function(l,c){return Qa},NoopMeter2.prototype.createCounter=function(l,c){return Ja},NoopMeter2.prototype.createUpDownCounter=function(l,c){return Xa},NoopMeter2.prototype.createObservableGauge=function(l,c){return tl},NoopMeter2.prototype.createObservableCounter=function(l,c){return el},NoopMeter2.prototype.createObservableUpDownCounter=function(l,c){return rl},NoopMeter2.prototype.addBatchObservableCallback=function(l,c){},NoopMeter2.prototype.removeBatchObservableCallback=function(l){},NoopMeter2}(),Aa=function(){return function(){}}(),Oa=function(l){function NoopCounterMetric2(){return null!==l&&l.apply(this,arguments)||this}return Ea(NoopCounterMetric2,l),NoopCounterMetric2.prototype.add=function(l,c){},NoopCounterMetric2}(Aa),Na=function(l){function NoopUpDownCounterMetric2(){return null!==l&&l.apply(this,arguments)||this}return Ea(NoopUpDownCounterMetric2,l),NoopUpDownCounterMetric2.prototype.add=function(l,c){},NoopUpDownCounterMetric2}(Aa),ja=function(l){function NoopGaugeMetric2(){return null!==l&&l.apply(this,arguments)||this}return Ea(NoopGaugeMetric2,l),NoopGaugeMetric2.prototype.record=function(l,c){},NoopGaugeMetric2}(Aa),Da=function(l){function NoopHistogramMetric2(){return null!==l&&l.apply(this,arguments)||this}return Ea(NoopHistogramMetric2,l),NoopHistogramMetric2.prototype.record=function(l,c){},NoopHistogramMetric2}(Aa),Ha=function(){function NoopObservableMetric2(){}return NoopObservableMetric2.prototype.addCallback=function(l){},NoopObservableMetric2.prototype.removeCallback=function(l){},NoopObservableMetric2}(),za=function(l){function NoopObservableCounterMetric2(){return null!==l&&l.apply(this,arguments)||this}return Ea(NoopObservableCounterMetric2,l),NoopObservableCounterMetric2}(Ha),Va=function(l){function NoopObservableGaugeMetric2(){return null!==l&&l.apply(this,arguments)||this}return Ea(NoopObservableGaugeMetric2,l),NoopObservableGaugeMetric2}(Ha),Ga=function(l){function NoopObservableUpDownCounterMetric2(){return null!==l&&l.apply(this,arguments)||this}return Ea(NoopObservableUpDownCounterMetric2,l),NoopObservableUpDownCounterMetric2}(Ha),Ka=new Ia,Ja=new Oa,Ya=new ja,Qa=new Da,Xa=new Na,el=new za,tl=new Va,rl=new Ga,nl={get:function(l,c){if(null!=l)return l[c]},keys:function(l){return null==l?[]:Object.keys(l)}},sl={set:function(l,c,d){null!=l&&(l[c]=d)}},il=function(){function NoopContextManager2(){}return NoopContextManager2.prototype.active=function(){return xa},NoopContextManager2.prototype.with=function(l,c,d){for(var h=[],p=3;p<arguments.length;p++)h[p-3]=arguments[p];return c.call.apply(c,function(l,c,d){if(d||2===arguments.length)for(var h,p=0,f=c.length;p<f;p++)!h&&p in c||(h||(h=Array.prototype.slice.call(c,0,p)),h[p]=c[p]);return l.concat(h||Array.prototype.slice.call(c))}([d],function(l,c){var d="function"==typeof Symbol&&l[Symbol.iterator];if(!d)return l;var h,p,f=d.call(l),m=[];try{for(;(void 0===c||c-- >0)&&!(h=f.next()).done;)m.push(h.value)}catch(y){p={error:y}}finally{try{h&&!h.done&&(d=f.return)&&d.call(f)}finally{if(p)throw p.error}}return m}(h),!1))},NoopContextManager2.prototype.bind=function(l,c){return c},NoopContextManager2.prototype.enable=function(){return this},NoopContextManager2.prototype.disable=function(){return this},NoopContextManager2}(),ol="context",al=new il,ll=function(){function ContextAPI2(){}return ContextAPI2.getInstance=function(){return this._instance||(this._instance=new ContextAPI2),this._instance},ContextAPI2.prototype.setGlobalContextManager=function(l){return registerGlobal(ol,l,ha.instance())},ContextAPI2.prototype.active=function(){return this._getContextManager().active()},ContextAPI2.prototype.with=function(l,c,d){for(var h,p=[],f=3;f<arguments.length;f++)p[f-3]=arguments[f];return(h=this._getContextManager()).with.apply(h,function(l,c,d){if(d||2===arguments.length)for(var h,p=0,f=c.length;p<f;p++)!h&&p in c||(h||(h=Array.prototype.slice.call(c,0,p)),h[p]=c[p]);return l.concat(h||Array.prototype.slice.call(c))}([l,c,d],function(l,c){var d="function"==typeof Symbol&&l[Symbol.iterator];if(!d)return l;var h,p,f=d.call(l),m=[];try{for(;(void 0===c||c-- >0)&&!(h=f.next()).done;)m.push(h.value)}catch(y){p={error:y}}finally{try{h&&!h.done&&(d=f.return)&&d.call(f)}finally{if(p)throw p.error}}return m}(p),!1))},ContextAPI2.prototype.bind=function(l,c){return this._getContextManager().bind(l,c)},ContextAPI2.prototype._getContextManager=function(){return getGlobal$1(ol)||al},ContextAPI2.prototype.disable=function(){this._getContextManager().disable(),unregisterGlobal(ol,ha.instance())},ContextAPI2}();(Sa=wa||(wa={}))[Sa.NONE=0]="NONE",Sa[Sa.SAMPLED=1]="SAMPLED";var cl="0000000000000000",ul="00000000000000000000000000000000",dl={traceId:ul,spanId:cl,traceFlags:wa.NONE},hl=function(){function NonRecordingSpan2(l){void 0===l&&(l=dl),this._spanContext=l}return NonRecordingSpan2.prototype.spanContext=function(){return this._spanContext},NonRecordingSpan2.prototype.setAttribute=function(l,c){return this},NonRecordingSpan2.prototype.setAttributes=function(l){return this},NonRecordingSpan2.prototype.addEvent=function(l,c){return this},NonRecordingSpan2.prototype.addLink=function(l){return this},NonRecordingSpan2.prototype.addLinks=function(l){return this},NonRecordingSpan2.prototype.setStatus=function(l){return this},NonRecordingSpan2.prototype.updateName=function(l){return this},NonRecordingSpan2.prototype.end=function(l){},NonRecordingSpan2.prototype.isRecording=function(){return!1},NonRecordingSpan2.prototype.recordException=function(l,c){},NonRecordingSpan2}(),pl=createContextKey("OpenTelemetry Context Key SPAN");function getSpan(l){return l.getValue(pl)||void 0}function getActiveSpan$1(){return getSpan(ll.getInstance().active())}function setSpan(l,c){return l.setValue(pl,c)}function deleteSpan(l){return l.deleteValue(pl)}function setSpanContext(l,c){return setSpan(l,new hl(c))}function getSpanContext(l){var c;return null===(c=getSpan(l))||void 0===c?void 0:c.spanContext()}var fl=/^([0-9a-f]{32})$/i,ml=/^[0-9a-f]{16}$/i;function isValidTraceId(l){return fl.test(l)&&l!==ul}function isSpanContextValid(l){return isValidTraceId(l.traceId)&&(c=l.spanId,ml.test(c)&&c!==cl);var c}function wrapSpanContext(l){return new hl(l)}var gl=ll.getInstance(),vl=function(){function NoopTracer2(){}return NoopTracer2.prototype.startSpan=function(l,c,d){if(void 0===d&&(d=gl.active()),Boolean(null==c?void 0:c.root))return new hl;var h,p=d&&getSpanContext(d);return"object"==typeof(h=p)&&"string"==typeof h.spanId&&"string"==typeof h.traceId&&"number"==typeof h.traceFlags&&isSpanContextValid(p)?new hl(p):new hl},NoopTracer2.prototype.startActiveSpan=function(l,c,d,h){var p,f,m;if(!(arguments.length<2)){2===arguments.length?m=c:3===arguments.length?(p=c,m=d):(p=c,f=d,m=h);var y=null!=f?f:gl.active(),_=this.startSpan(l,p,y),b=setSpan(y,_);return gl.with(b,m,void 0,_)}},NoopTracer2}();var yl,_l,bl,wl,Sl,xl,kl=new vl,Cl=function(){function ProxyTracer2(l,c,d,h){this._provider=l,this.name=c,this.version=d,this.options=h}return ProxyTracer2.prototype.startSpan=function(l,c,d){return this._getTracer().startSpan(l,c,d)},ProxyTracer2.prototype.startActiveSpan=function(l,c,d,h){var p=this._getTracer();return Reflect.apply(p.startActiveSpan,p,arguments)},ProxyTracer2.prototype._getTracer=function(){if(this._delegate)return this._delegate;var l=this._provider.getDelegateTracer(this.name,this.version,this.options);return l?(this._delegate=l,this._delegate):kl},ProxyTracer2}(),El=new(function(){function NoopTracerProvider2(){}return NoopTracerProvider2.prototype.getTracer=function(l,c,d){return new vl},NoopTracerProvider2}()),Il=function(){function ProxyTracerProvider2(){}return ProxyTracerProvider2.prototype.getTracer=function(l,c,d){var h;return null!==(h=this.getDelegateTracer(l,c,d))&&void 0!==h?h:new Cl(this,l,c,d)},ProxyTracerProvider2.prototype.getDelegate=function(){var l;return null!==(l=this._delegate)&&void 0!==l?l:El},ProxyTracerProvider2.prototype.setDelegate=function(l){this._delegate=l},ProxyTracerProvider2.prototype.getDelegateTracer=function(l,c,d){var h;return null===(h=this._delegate)||void 0===h?void 0:h.getTracer(l,c,d)},ProxyTracerProvider2}();(_l=yl||(yl={}))[_l.NOT_RECORD=0]="NOT_RECORD",_l[_l.RECORD=1]="RECORD",_l[_l.RECORD_AND_SAMPLED=2]="RECORD_AND_SAMPLED",(wl=bl||(bl={}))[wl.INTERNAL=0]="INTERNAL",wl[wl.SERVER=1]="SERVER",wl[wl.CLIENT=2]="CLIENT",wl[wl.PRODUCER=3]="PRODUCER",wl[wl.CONSUMER=4]="CONSUMER",(xl=Sl||(Sl={}))[xl.UNSET=0]="UNSET",xl[xl.OK=1]="OK",xl[xl.ERROR=2]="ERROR";var Tl=ll.getInstance(),Rl=ha.instance(),Al=new(function(){function NoopMeterProvider2(){}return NoopMeterProvider2.prototype.getMeter=function(l,c,d){return Ka},NoopMeterProvider2}()),Ol="metrics",Ml=function(){function MetricsAPI2(){}return MetricsAPI2.getInstance=function(){return this._instance||(this._instance=new MetricsAPI2),this._instance},MetricsAPI2.prototype.setGlobalMeterProvider=function(l){return registerGlobal(Ol,l,ha.instance())},MetricsAPI2.prototype.getMeterProvider=function(){return getGlobal$1(Ol)||Al},MetricsAPI2.prototype.getMeter=function(l,c,d){return this.getMeterProvider().getMeter(l,c,d)},MetricsAPI2.prototype.disable=function(){unregisterGlobal(Ol,ha.instance())},MetricsAPI2}(),Nl=Ml.getInstance(),Pl=function(){function NoopTextMapPropagator2(){}return NoopTextMapPropagator2.prototype.inject=function(l,c){},NoopTextMapPropagator2.prototype.extract=function(l,c){return l},NoopTextMapPropagator2.prototype.fields=function(){return[]},NoopTextMapPropagator2}(),Ll=createContextKey("OpenTelemetry Baggage Key");function getBaggage(l){return l.getValue(Ll)||void 0}function getActiveBaggage(){return getBaggage(ll.getInstance().active())}function setBaggage(l,c){return l.setValue(Ll,c)}function deleteBaggage(l){return l.deleteValue(Ll)}var jl="propagation",Fl=new Pl,Ul=function(){function PropagationAPI2(){this.createBaggage=createBaggage,this.getBaggage=getBaggage,this.getActiveBaggage=getActiveBaggage,this.setBaggage=setBaggage,this.deleteBaggage=deleteBaggage}return PropagationAPI2.getInstance=function(){return this._instance||(this._instance=new PropagationAPI2),this._instance},PropagationAPI2.prototype.setGlobalPropagator=function(l){return registerGlobal(jl,l,ha.instance())},PropagationAPI2.prototype.inject=function(l,c,d){return void 0===d&&(d=sl),this._getGlobalPropagator().inject(l,c,d)},PropagationAPI2.prototype.extract=function(l,c,d){return void 0===d&&(d=nl),this._getGlobalPropagator().extract(l,c,d)},PropagationAPI2.prototype.fields=function(){return this._getGlobalPropagator().fields()},PropagationAPI2.prototype.disable=function(){unregisterGlobal(jl,ha.instance())},PropagationAPI2.prototype._getGlobalPropagator=function(){return getGlobal$1(jl)||Fl},PropagationAPI2}().getInstance(),Bl="trace",Hl=function(){function TraceAPI2(){this._proxyTracerProvider=new Il,this.wrapSpanContext=wrapSpanContext,this.isSpanContextValid=isSpanContextValid,this.deleteSpan=deleteSpan,this.getSpan=getSpan,this.getActiveSpan=getActiveSpan$1,this.getSpanContext=getSpanContext,this.setSpan=setSpan,this.setSpanContext=setSpanContext}return TraceAPI2.getInstance=function(){return this._instance||(this._instance=new TraceAPI2),this._instance},TraceAPI2.prototype.setGlobalTracerProvider=function(l){var c=registerGlobal(Bl,this._proxyTracerProvider,ha.instance());return c&&this._proxyTracerProvider.setDelegate(l),c},TraceAPI2.prototype.getTracerProvider=function(){return getGlobal$1(Bl)||this._proxyTracerProvider},TraceAPI2.prototype.getTracer=function(l,c){return this.getTracerProvider().getTracer(l,c)},TraceAPI2.prototype.disable=function(){unregisterGlobal(Bl,ha.instance()),this._proxyTracerProvider=new Il},TraceAPI2}().getInstance();class NoopLogger{emit(l){}}const zl=new NoopLogger;const Wl=new class{getLogger(l,c,d){return new NoopLogger}};class ProxyLogger{constructor(l,c,d,h){this._provider=l,this.name=c,this.version=d,this.options=h}emit(l){this._getLogger().emit(l)}_getLogger(){if(this._delegate)return this._delegate;const l=this._provider.getDelegateLogger(this.name,this.version,this.options);return l?(this._delegate=l,this._delegate):zl}}class ProxyLoggerProvider{getLogger(l,c,d){var h;return null!==(h=this.getDelegateLogger(l,c,d))&&void 0!==h?h:new ProxyLogger(this,l,c,d)}getDelegate(){var l;return null!==(l=this._delegate)&&void 0!==l?l:Wl}setDelegate(l){this._delegate=l}getDelegateLogger(l,c,d){var h;return null===(h=this._delegate)||void 0===h?void 0:h.getLogger(l,c,d)}}const Zl="object"==typeof globalThis?globalThis:"object"==typeof self?self:"object"==typeof window?window:"object"==typeof global?global:{},Gl=Symbol.for("io.opentelemetry.js.api.logs"),Kl=Zl;class LogsAPI{constructor(){this._proxyLoggerProvider=new ProxyLoggerProvider}static getInstance(){return this._instance||(this._instance=new LogsAPI),this._instance}setGlobalLoggerProvider(l){return Kl[Gl]?this.getLoggerProvider():(Kl[Gl]=(c=1,d=l,h=Wl,l=>l===c?d:h),this._proxyLoggerProvider.setDelegate(l),l);var c,d,h}getLoggerProvider(){var l,c;return null!==(c=null===(l=Kl[Gl])||void 0===l?void 0:l.call(Kl,1))&&void 0!==c?c:this._proxyLoggerProvider}getLogger(l,c,d){return this.getLoggerProvider().getLogger(l,c,d)}disable(){delete Kl[Gl],this._proxyLoggerProvider=new ProxyLoggerProvider}}const Yl=LogsAPI.getInstance();const Ql=createContextKey("OpenTelemetry SDK Context Key SUPPRESS_TRACING");function suppressTracing(l){return l.setValue(Ql,!0)}function isTracingSuppressed(l){return!0===l.getValue(Ql)}const Xl="baggage";function parsePairKeyValue(l){const c=l.split(";");if(c.length<=0)return;const d=c.shift();if(!d)return;const h=d.indexOf("=");if(h<=0)return;const p=decodeURIComponent(d.substring(0,h).trim()),f=decodeURIComponent(d.substring(h+1).trim());let m;var y;return c.length>0&&("string"!=typeof(y=c.join(";"))&&(ba.error("Cannot create baggage metadata from unknown type: "+typeof y),y=""),m={__TYPE__:ya,toString:function(){return y}}),{key:p,value:f,metadata:m}}class W3CBaggagePropagator{inject(l,c,d){const h=Ul.getBaggage(l);if(!h||isTracingSuppressed(l))return;const p=function(l){return l.getAllEntries().map((([l,c])=>{let d=`${encodeURIComponent(l)}=${encodeURIComponent(c.value)}`;return void 0!==c.metadata&&(d+=";"+c.metadata.toString()),d}))}(h).filter((l=>l.length<=4096)).slice(0,180),f=function(l){return l.reduce(((l,c)=>{const d=`${l}${""!==l?",":""}${c}`;return d.length>8192?l:d}),"")}(p);f.length>0&&d.set(c,Xl,f)}extract(l,c,d){const h=d.get(c,Xl),p=Array.isArray(h)?h.join(","):h;if(!p)return l;const f={};if(0===p.length)return l;return p.split(",").forEach((l=>{const c=parsePairKeyValue(l);if(c){const l={value:c.value};c.metadata&&(l.metadata=c.metadata),f[c.key]=l}})),0===Object.entries(f).length?l:Ul.setBaggage(l,Ul.createBaggage(f))}fields(){return[Xl]}}function sanitizeAttributes(l){const c={};if("object"!=typeof l||null==l)return c;for(const[d,h]of Object.entries(l))isAttributeKey(d)?isAttributeValue(h)?Array.isArray(h)?c[d]=h.slice():c[d]=h:Rl.warn(`Invalid attribute value set for key: ${d}`):Rl.warn(`Invalid attribute key: ${d}`);return c}function isAttributeKey(l){return"string"==typeof l&&l.length>0}function isAttributeValue(l){return null==l||(Array.isArray(l)?function(l){let c;for(const d of l)if(null!=d){if(!c){if(isValidPrimitiveAttributeValue(d)){c=typeof d;continue}return!1}if(typeof d!==c)return!1}return!0}(l):isValidPrimitiveAttributeValue(l))}function isValidPrimitiveAttributeValue(l){switch(typeof l){case"number":case"boolean":case"string":return!0}return!1}let delegateHandler=l=>{Rl.error(function(l){return"string"==typeof l?l:JSON.stringify(function(l){const c={};let d=l;for(;null!==d;)Object.getOwnPropertyNames(d).forEach((l=>{if(c[l])return;const h=d[l];h&&(c[l]=String(h))})),d=Object.getPrototypeOf(d);return c}(l))}(l))};function globalErrorHandler(l){try{delegateHandler(l)}catch{}}const ec=performance,dc="exception.message",pc="exception.stacktrace",fc="exception.type",mc="service.name",gc="service.version",vc="telemetry.sdk.language",yc="webjs",_c="telemetry.sdk.name",Ic="telemetry.sdk.version",Oc="user_agent.original",Nc="process.runtime.name",Pc={[_c]:"opentelemetry",[Nc]:"browser",[vc]:yc,[Ic]:"2.0.1"};const Lc=Math.pow(10,6),Fc=Math.pow(10,9);function millisToHrTime(l){const c=l/1e3;return[Math.trunc(c),Math.round(l%1e3*Lc)]}function getTimeOrigin(){let l=ec.timeOrigin;if("number"!=typeof l){const c=ec;l=c.timing&&c.timing.fetchStart}return l}function hrTimeToMicroseconds(l){return 1e6*l[0]+l[1]/1e3}function isTimeInputHrTime(l){return Array.isArray(l)&&2===l.length&&"number"==typeof l[0]&&"number"==typeof l[1]}function isTimeInput(l){return isTimeInputHrTime(l)||"number"==typeof l||l instanceof Date}function addHrTimes(l,c){const d=[l[0]+c[0],l[1]+c[1]];return d[1]>=Fc&&(d[1]-=Fc,d[0]+=1),d}var $c,Uc;(Uc=$c||($c={}))[Uc.SUCCESS=0]="SUCCESS",Uc[Uc.FAILED=1]="FAILED";class CompositePropagator{constructor(l={}){__publicField(this,"_propagators"),__publicField(this,"_fields"),this._propagators=l.propagators??[],this._fields=Array.from(new Set(this._propagators.map((l=>"function"==typeof l.fields?l.fields():[])).reduce(((l,c)=>l.concat(c)),[])))}inject(l,c,d){for(const p of this._propagators)try{p.inject(l,c,d)}catch(h){Rl.warn(`Failed to inject with ${p.constructor.name}. Err: ${h.message}`)}}extract(l,c,d){return this._propagators.reduce(((l,h)=>{try{return h.extract(l,c,d)}catch(p){Rl.warn(`Failed to extract with ${h.constructor.name}. Err: ${p.message}`)}return l}),l)}fields(){return this._fields.slice()}}const Bc="[_0-9a-z-*/]",Hc=new RegExp(`^(?:${`[a-z]${Bc}{0,255}`}|${`[a-z0-9]${Bc}{0,240}@[a-z]${Bc}{0,13}`})$`),qc=/^[ -~]{0,255}[!-~]$/,Wc=/,|=/;class TraceState{constructor(l){__publicField(this,"_internalState",new Map),l&&this._parse(l)}set(l,c){const d=this._clone();return d._internalState.has(l)&&d._internalState.delete(l),d._internalState.set(l,c),d}unset(l){const c=this._clone();return c._internalState.delete(l),c}get(l){return this._internalState.get(l)}serialize(){return this._keys().reduce(((l,c)=>(l.push(c+"="+this.get(c)),l)),[]).join(",")}_parse(l){l.length>512||(this._internalState=l.split(",").reverse().reduce(((l,c)=>{const d=c.trim(),h=d.indexOf("=");if(-1!==h){const p=d.slice(0,h),f=d.slice(h+1,c.length);(function(l){return Hc.test(l)})(p)&&function(l){return qc.test(l)&&!Wc.test(l)}(f)&&l.set(p,f)}return l}),new Map),this._internalState.size>32&&(this._internalState=new Map(Array.from(this._internalState.entries()).reverse().slice(0,32))))}_keys(){return Array.from(this._internalState.keys()).reverse()}_clone(){const l=new TraceState;return l._internalState=new Map(this._internalState),l}}const Vc="traceparent",Zc="tracestate",eu=new RegExp("^\\s?((?!ff)[\\da-f]{2})-((?![0]{32})[\\da-f]{32})-((?![0]{16})[\\da-f]{16})-([\\da-f]{2})(-.*)?\\s?$");class W3CTraceContextPropagator{inject(l,c,d){const h=Hl.getSpanContext(l);if(!h||isTracingSuppressed(l)||!isSpanContextValid(h))return;const p=`00-${h.traceId}-${h.spanId}-0${Number(h.traceFlags||wa.NONE).toString(16)}`;d.set(c,Vc,p),h.traceState&&d.set(c,Zc,h.traceState.serialize())}extract(l,c,d){const h=d.get(c,Vc);if(!h)return l;const p=Array.isArray(h)?h[0]:h;if("string"!=typeof p)return l;const f=function(l){const c=eu.exec(l);return c?"00"===c[1]&&c[5]?null:{traceId:c[2],spanId:c[3],traceFlags:parseInt(c[4],16)}:null}(p);if(!f)return l;f.isRemote=!0;const m=d.get(c,Zc);if(m){const l=Array.isArray(m)?m.join(","):m;f.traceState=new TraceState("string"==typeof l?l:void 0)}return Hl.setSpanContext(l,f)}fields(){return[Vc,Zc]}}const tu="[object Null]",ru="[object Undefined]",nu=Function.prototype.toString,su=nu.call(Object),iu=Object.getPrototypeOf,au=Object.prototype,lu=au.hasOwnProperty,cu=Symbol?Symbol.toStringTag:void 0,uu=au.toString;function isPlainObject$4(l){if(!function(l){return null!=l&&"object"==typeof l}(l)||"[object Object]"!==function(l){if(null==l)return void 0===l?ru:tu;return cu&&cu in Object(l)?function(l){const c=lu.call(l,cu),d=l[cu];let h=!1;try{l[cu]=void 0,h=!0}catch(hh){}const p=uu.call(l);h&&(c?l[cu]=d:delete l[cu]);return p}(l):function(l){return uu.call(l)}(l)}(l))return!1;const c=iu(l);if(null===c)return!0;const d=lu.call(c,"constructor")&&c.constructor;return"function"==typeof d&&d instanceof d&&nu.call(d)===su}function takeValue(l){return isArray(l)?l.slice():l}function mergeTwoObjects(l,c,d=0,h){let p;if(!(d>20)){if(d++,isPrimitive$2(l)||isPrimitive$2(c)||isFunction$2(c))p=takeValue(c);else if(isArray(l)){if(p=l.slice(),isArray(c))for(let l=0,d=c.length;l<d;l++)p.push(takeValue(c[l]));else if(isObject$1(c)){const l=Object.keys(c);for(let d=0,h=l.length;d<h;d++){const h=l[d];p[h]=takeValue(c[h])}}}else if(isObject$1(l))if(isObject$1(c)){if(!function(l,c){if(!isPlainObject$4(l)||!isPlainObject$4(c))return!1;return!0}(l,c))return c;p=Object.assign({},l);const f=Object.keys(c);for(let m=0,y=f.length;m<y;m++){const y=f[m],_=c[y];if(isPrimitive$2(_))void 0===_?delete p[y]:p[y]=_;else{const f=p[y],m=_;if(wasObjectReferenced(l,y,h)||wasObjectReferenced(c,y,h))delete p[y];else{if(isObject$1(f)&&isObject$1(m)){const d=h.get(f)||[],p=h.get(m)||[];d.push({obj:l,key:y}),p.push({obj:c,key:y}),h.set(f,d),h.set(m,p)}p[y]=mergeTwoObjects(p[y],_,d,h)}}}}else p=c;return p}}function wasObjectReferenced(l,c,d){const h=d.get(l[c])||[];for(let p=0,f=h.length;p<f;p++){const d=h[p];if(d.key===c&&d.obj===l)return!0}return!1}function isArray(l){return Array.isArray(l)}function isFunction$2(l){return"function"==typeof l}function isObject$1(l){return!isPrimitive$2(l)&&!isArray(l)&&!isFunction$2(l)&&"object"==typeof l}function isPrimitive$2(l){return"string"==typeof l||"number"==typeof l||"boolean"==typeof l||void 0===l||l instanceof Date||l instanceof RegExp||null===l}let wu=class{constructor(){__publicField(this,"_promise"),__publicField(this,"_resolve"),__publicField(this,"_reject"),this._promise=new Promise(((l,c)=>{this._resolve=l,this._reject=c}))}get promise(){return this._promise}resolve(l){this._resolve(l)}reject(l){this._reject(l)}};class BindOnceFuture{constructor(l,c){__publicField(this,"_callback"),__publicField(this,"_that"),__publicField(this,"_isCalled",!1),__publicField(this,"_deferred",new wu),this._callback=l,this._that=c}get isCalled(){return this._isCalled}get promise(){return this._deferred.promise}call(...l){if(!this._isCalled){this._isCalled=!0;try{Promise.resolve(this._callback.call(this._that,...l)).then((l=>this._deferred.resolve(l)),(l=>this._deferred.reject(l)))}catch(c){this._deferred.reject(c)}}return this._deferred.promise}}const Su={_export:function(l,c){return new Promise((d=>{Tl.with(suppressTracing(Tl.active()),(()=>{l.export(c,(l=>{d(l)}))}))}))}};const isPromiseLike=l=>null!==l&&"object"==typeof l&&"function"==typeof l.then;class ResourceImpl{constructor(l){__publicField(this,"_rawAttributes"),__publicField(this,"_asyncAttributesPending",!1),__publicField(this,"_memoizedAttributes");const c=l.attributes??{};this._rawAttributes=Object.entries(c).map((([l,c])=>(isPromiseLike(c)&&(this._asyncAttributesPending=!0),[l,c]))),this._rawAttributes=guardedRawAttributes(this._rawAttributes)}static FromAttributeList(l){const c=new ResourceImpl({});return c._rawAttributes=guardedRawAttributes(l),c._asyncAttributesPending=l.filter((([l,c])=>isPromiseLike(c))).length>0,c}get asyncAttributesPending(){return this._asyncAttributesPending}async waitForAsyncAttributes(){if(this.asyncAttributesPending){for(let l=0;l<this._rawAttributes.length;l++){const[c,d]=this._rawAttributes[l];this._rawAttributes[l]=[c,isPromiseLike(d)?await d:d]}this._asyncAttributesPending=!1}}get attributes(){if(this.asyncAttributesPending&&Rl.error("Accessing resource attributes before async attributes settled"),this._memoizedAttributes)return this._memoizedAttributes;const l={};for(const[c,d]of this._rawAttributes)isPromiseLike(d)?Rl.debug(`Unsettled resource attribute ${c} skipped`):null!=d&&(l[c]??(l[c]=d));return this._asyncAttributesPending||(this._memoizedAttributes=l),l}getRawAttributes(){return this._rawAttributes}merge(l){return null==l?this:ResourceImpl.FromAttributeList([...l.getRawAttributes(),...this.getRawAttributes()])}}function resourceFromAttributes(l){return ResourceImpl.FromAttributeList(Object.entries(l))}function guardedRawAttributes(l){return l.map((([l,c])=>isPromiseLike(c)?[l,c.catch((c=>{Rl.debug("promise rejection for resource attribute: %s - %s",l,c)}))]:[l,c]))}class SpanImpl{constructor(l){__publicField(this,"_spanContext"),__publicField(this,"kind"),__publicField(this,"parentSpanContext"),__publicField(this,"attributes",{}),__publicField(this,"links",[]),__publicField(this,"events",[]),__publicField(this,"startTime"),__publicField(this,"resource"),__publicField(this,"instrumentationScope"),__publicField(this,"_droppedAttributesCount",0),__publicField(this,"_droppedEventsCount",0),__publicField(this,"_droppedLinksCount",0),__publicField(this,"name"),__publicField(this,"status",{code:Sl.UNSET}),__publicField(this,"endTime",[0,0]),__publicField(this,"_ended",!1),__publicField(this,"_duration",[-1,-1]),__publicField(this,"_spanProcessor"),__publicField(this,"_spanLimits"),__publicField(this,"_attributeValueLengthLimit"),__publicField(this,"_performanceStartTime"),__publicField(this,"_performanceOffset"),__publicField(this,"_startTimeProvided");const c=Date.now();this._spanContext=l.spanContext,this._performanceStartTime=ec.now(),this._performanceOffset=c-(this._performanceStartTime+getTimeOrigin()),this._startTimeProvided=null!=l.startTime,this._spanLimits=l.spanLimits,this._attributeValueLengthLimit=this._spanLimits.attributeValueLengthLimit||0,this._spanProcessor=l.spanProcessor,this.name=l.name,this.parentSpanContext=l.parentSpanContext,this.kind=l.kind,this.links=l.links||[],this.startTime=this._getTime(l.startTime??c),this.resource=l.resource,this.instrumentationScope=l.scope,null!=l.attributes&&this.setAttributes(l.attributes),this._spanProcessor.onStart(this,l.context)}spanContext(){return this._spanContext}setAttribute(l,c){if(null==c||this._isSpanEnded())return this;if(0===l.length)return Rl.warn(`Invalid attribute key: ${l}`),this;if(!isAttributeValue(c))return Rl.warn(`Invalid attribute value set for key: ${l}`),this;const{attributeCountLimit:d}=this._spanLimits;return void 0!==d&&Object.keys(this.attributes).length>=d&&!Object.prototype.hasOwnProperty.call(this.attributes,l)?(this._droppedAttributesCount++,this):(this.attributes[l]=this._truncateToSize(c),this)}setAttributes(l){for(const[c,d]of Object.entries(l))this.setAttribute(c,d);return this}addEvent(l,c,d){if(this._isSpanEnded())return this;const{eventCountLimit:h}=this._spanLimits;if(0===h)return Rl.warn("No events allowed."),this._droppedEventsCount++,this;void 0!==h&&this.events.length>=h&&(0===this._droppedEventsCount&&Rl.debug("Dropping extra events."),this.events.shift(),this._droppedEventsCount++),isTimeInput(c)&&(isTimeInput(d)||(d=c),c=void 0);const p=sanitizeAttributes(c);return this.events.push({name:l,attributes:p,time:this._getTime(d),droppedAttributesCount:0}),this}addLink(l){return this.links.push(l),this}addLinks(l){return this.links.push(...l),this}setStatus(l){return this._isSpanEnded()||(this.status={...l},null!=this.status.message&&"string"!=typeof l.message&&(Rl.warn(`Dropping invalid status.message of type '${typeof l.message}', expected 'string'`),delete this.status.message)),this}updateName(l){return this._isSpanEnded()||(this.name=l),this}end(l){this._isSpanEnded()?Rl.error(`${this.name} ${this._spanContext.traceId}-${this._spanContext.spanId} - You can only call end() on a span once.`):(this._ended=!0,this.endTime=this._getTime(l),this._duration=function(l,c){let d=c[0]-l[0],h=c[1]-l[1];return h<0&&(d-=1,h+=Fc),[d,h]}(this.startTime,this.endTime),this._duration[0]<0&&(Rl.warn("Inconsistent start and end time, startTime > endTime. Setting span duration to 0ms.",this.startTime,this.endTime),this.endTime=this.startTime.slice(),this._duration=[0,0]),this._droppedEventsCount>0&&Rl.warn(`Dropped ${this._droppedEventsCount} events because eventCountLimit reached`),this._spanProcessor.onEnd(this))}_getTime(l){if("number"==typeof l&&l<=ec.now())return c=l+this._performanceOffset,addHrTimes(millisToHrTime(getTimeOrigin()),millisToHrTime("number"==typeof c?c:ec.now()));var c;if("number"==typeof l)return millisToHrTime(l);if(l instanceof Date)return millisToHrTime(l.getTime());if(isTimeInputHrTime(l))return l;if(this._startTimeProvided)return millisToHrTime(Date.now());const d=ec.now()-this._performanceStartTime;return addHrTimes(this.startTime,millisToHrTime(d))}isRecording(){return!1===this._ended}recordException(l,c){const d={};"string"==typeof l?d[dc]=l:l&&(l.code?d[fc]=l.code.toString():l.name&&(d[fc]=l.name),l.message&&(d[dc]=l.message),l.stack&&(d[pc]=l.stack)),d[fc]||d[dc]?this.addEvent("exception",d,c):Rl.warn(`Failed to record an exception ${l}`)}get duration(){return this._duration}get ended(){return this._ended}get droppedAttributesCount(){return this._droppedAttributesCount}get droppedEventsCount(){return this._droppedEventsCount}get droppedLinksCount(){return this._droppedLinksCount}_isSpanEnded(){if(this._ended){const l=new Error(`Operation attempted on ended Span {traceId: ${this._spanContext.traceId}, spanId: ${this._spanContext.spanId}}`);Rl.warn(`Cannot execute the operation on ended Span {traceId: ${this._spanContext.traceId}, spanId: ${this._spanContext.spanId}}`,l)}return this._ended}_truncateToLimitUtil(l,c){return l.length<=c?l:l.substring(0,c)}_truncateToSize(l){const c=this._attributeValueLengthLimit;return c<=0?(Rl.warn(`Attribute value limit must be positive, got ${c}`),l):"string"==typeof l?this._truncateToLimitUtil(l,c):Array.isArray(l)?l.map((l=>"string"==typeof l?this._truncateToLimitUtil(l,c):l)):l}}var xu;!function(l){l[l.NOT_RECORD=0]="NOT_RECORD",l[l.RECORD=1]="RECORD",l[l.RECORD_AND_SAMPLED=2]="RECORD_AND_SAMPLED"}(xu||(xu={}));class AlwaysOffSampler{shouldSample(){return{decision:xu.NOT_RECORD}}toString(){return"AlwaysOffSampler"}}class AlwaysOnSampler{shouldSample(){return{decision:xu.RECORD_AND_SAMPLED}}toString(){return"AlwaysOnSampler"}}class ParentBasedSampler{constructor(l){__publicField(this,"_root"),__publicField(this,"_remoteParentSampled"),__publicField(this,"_remoteParentNotSampled"),__publicField(this,"_localParentSampled"),__publicField(this,"_localParentNotSampled"),this._root=l.root,this._root||(globalErrorHandler(new Error("ParentBasedSampler must have a root sampler configured")),this._root=new AlwaysOnSampler),this._remoteParentSampled=l.remoteParentSampled??new AlwaysOnSampler,this._remoteParentNotSampled=l.remoteParentNotSampled??new AlwaysOffSampler,this._localParentSampled=l.localParentSampled??new AlwaysOnSampler,this._localParentNotSampled=l.localParentNotSampled??new AlwaysOffSampler}shouldSample(l,c,d,h,p,f){const m=Hl.getSpanContext(l);return m&&isSpanContextValid(m)?m.isRemote?m.traceFlags&wa.SAMPLED?this._remoteParentSampled.shouldSample(l,c,d,h,p,f):this._remoteParentNotSampled.shouldSample(l,c,d,h,p,f):m.traceFlags&wa.SAMPLED?this._localParentSampled.shouldSample(l,c,d,h,p,f):this._localParentNotSampled.shouldSample(l,c,d,h,p,f):this._root.shouldSample(l,c,d,h,p,f)}toString(){return`ParentBased{root=${this._root.toString()}, remoteParentSampled=${this._remoteParentSampled.toString()}, remoteParentNotSampled=${this._remoteParentNotSampled.toString()}, localParentSampled=${this._localParentSampled.toString()}, localParentNotSampled=${this._localParentNotSampled.toString()}}`}}class TraceIdRatioBasedSampler{constructor(l=0){__publicField(this,"_ratio"),__publicField(this,"_upperBound"),this._ratio=l,this._ratio=this._normalize(l),this._upperBound=Math.floor(4294967295*this._ratio)}shouldSample(l,c){return{decision:isValidTraceId(c)&&this._accumulate(c)<this._upperBound?xu.RECORD_AND_SAMPLED:xu.NOT_RECORD}}toString(){return`TraceIdRatioBased{${this._ratio}}`}_normalize(l){return"number"!=typeof l||isNaN(l)?0:l>=1?1:l<=0?0:l}_accumulate(l){let c=0;for(let d=0;d<l.length/8;d++){const h=8*d;c=(c^parseInt(l.slice(h,h+8),16))>>>0}return c}}function loadDefaultConfig(){return{sampler:buildSamplerFromEnv(),forceFlushTimeoutMillis:3e4,generalLimits:{attributeValueLengthLimit:1/0,attributeCountLimit:128},spanLimits:{attributeValueLengthLimit:1/0,attributeCountLimit:128,linkCountLimit:128,eventCountLimit:128,attributePerEventCountLimit:128,attributePerLinkCountLimit:128}}}function buildSamplerFromEnv(){const l="parentbased_always_on";switch(l){case"always_on":return new AlwaysOnSampler;case"always_off":return new AlwaysOffSampler;case"parentbased_always_on":return new ParentBasedSampler({root:new AlwaysOnSampler});case"parentbased_always_off":return new ParentBasedSampler({root:new AlwaysOffSampler});case"traceidratio":return new TraceIdRatioBasedSampler(getSamplerProbabilityFromEnv());case"parentbased_traceidratio":return new ParentBasedSampler({root:new TraceIdRatioBasedSampler(getSamplerProbabilityFromEnv())});default:return Rl.error(`OTEL_TRACES_SAMPLER value "${l}" invalid, defaulting to "parentbased_always_on".`),new ParentBasedSampler({root:new AlwaysOnSampler})}}function getSamplerProbabilityFromEnv(){return Rl.error("OTEL_TRACES_SAMPLER_ARG is blank, defaulting to 1."),1}const Cu=1/0;class BatchSpanProcessorBase{constructor(l,c){__publicField(this,"_exporter"),__publicField(this,"_maxExportBatchSize"),__publicField(this,"_maxQueueSize"),__publicField(this,"_scheduledDelayMillis"),__publicField(this,"_exportTimeoutMillis"),__publicField(this,"_isExporting",!1),__publicField(this,"_finishedSpans",[]),__publicField(this,"_timer"),__publicField(this,"_shutdownOnce"),__publicField(this,"_droppedSpansCount",0),this._exporter=l,this._maxExportBatchSize="number"==typeof c?.maxExportBatchSize?c.maxExportBatchSize:512,this._maxQueueSize="number"==typeof c?.maxQueueSize?c.maxQueueSize:2048,this._scheduledDelayMillis="number"==typeof c?.scheduledDelayMillis?c.scheduledDelayMillis:5e3,this._exportTimeoutMillis="number"==typeof c?.exportTimeoutMillis?c.exportTimeoutMillis:3e4,this._shutdownOnce=new BindOnceFuture(this._shutdown,this),this._maxExportBatchSize>this._maxQueueSize&&(Rl.warn("BatchSpanProcessor: maxExportBatchSize must be smaller or equal to maxQueueSize, setting maxExportBatchSize to match maxQueueSize"),this._maxExportBatchSize=this._maxQueueSize)}forceFlush(){return this._shutdownOnce.isCalled?this._shutdownOnce.promise:this._flushAll()}onStart(l,c){}onEnd(l){this._shutdownOnce.isCalled||l.spanContext().traceFlags&wa.SAMPLED&&this._addToBuffer(l)}shutdown(){return this._shutdownOnce.call()}_shutdown(){return Promise.resolve().then((()=>this.onShutdown())).then((()=>this._flushAll())).then((()=>this._exporter.shutdown()))}_addToBuffer(l){if(this._finishedSpans.length>=this._maxQueueSize)return 0===this._droppedSpansCount&&Rl.debug("maxQueueSize reached, dropping spans"),void this._droppedSpansCount++;this._droppedSpansCount>0&&(Rl.warn(`Dropped ${this._droppedSpansCount} spans because maxQueueSize reached`),this._droppedSpansCount=0),this._finishedSpans.push(l),this._maybeStartTimer()}_flushAll(){return new Promise(((l,c)=>{const d=[];for(let h=0,p=Math.ceil(this._finishedSpans.length/this._maxExportBatchSize);h<p;h++)d.push(this._flushOneBatch());Promise.all(d).then((()=>{l()})).catch(c)}))}_flushOneBatch(){return this._clearTimer(),0===this._finishedSpans.length?Promise.resolve():new Promise(((l,c)=>{const d=setTimeout((()=>{c(new Error("Timeout"))}),this._exportTimeoutMillis);Tl.with(suppressTracing(Tl.active()),(()=>{let h;this._finishedSpans.length<=this._maxExportBatchSize?(h=this._finishedSpans,this._finishedSpans=[]):h=this._finishedSpans.splice(0,this._maxExportBatchSize);const doExport=()=>this._exporter.export(h,(h=>{clearTimeout(d),h.code===$c.SUCCESS?l():c(h.error??new Error("BatchSpanProcessor: span export failed"))}));let p=null;for(let l=0,c=h.length;l<c;l++){const c=h[l];c.resource.asyncAttributesPending&&c.resource.waitForAsyncAttributes&&(p??(p=[]),p.push(c.resource.waitForAsyncAttributes()))}null===p?doExport():Promise.all(p).then(doExport,(l=>{globalErrorHandler(l),c(l)}))}))}))}_maybeStartTimer(){if(this._isExporting)return;const flush=()=>{this._isExporting=!0,this._flushOneBatch().finally((()=>{this._isExporting=!1,this._finishedSpans.length>0&&(this._clearTimer(),this._maybeStartTimer())})).catch((l=>{this._isExporting=!1,globalErrorHandler(l)}))};if(this._finishedSpans.length>=this._maxExportBatchSize)return flush();void 0===this._timer&&(this._timer=setTimeout((()=>flush()),this._scheduledDelayMillis),this._timer)}_clearTimer(){void 0!==this._timer&&(clearTimeout(this._timer),this._timer=void 0)}}class BatchSpanProcessor extends BatchSpanProcessorBase{constructor(l,c){super(l,c),__publicField(this,"_visibilityChangeListener"),__publicField(this,"_pageHideListener"),this.onInit(c)}onInit(l){!0!==l?.disableAutoFlushOnDocumentHide&&"undefined"!=typeof document&&(this._visibilityChangeListener=()=>{"hidden"===document.visibilityState&&this.forceFlush().catch((l=>{globalErrorHandler(l)}))},this._pageHideListener=()=>{this.forceFlush().catch((l=>{globalErrorHandler(l)}))},document.addEventListener("visibilitychange",this._visibilityChangeListener),document.addEventListener("pagehide",this._pageHideListener))}onShutdown(){"undefined"!=typeof document&&(this._visibilityChangeListener&&document.removeEventListener("visibilitychange",this._visibilityChangeListener),this._pageHideListener&&document.removeEventListener("pagehide",this._pageHideListener))}}class RandomIdGenerator{constructor(){__publicField(this,"generateTraceId",getIdGenerator(16)),__publicField(this,"generateSpanId",getIdGenerator(8))}}const Eu=Array(32);function getIdGenerator(l){return function(){for(let c=0;c<2*l;c++)Eu[c]=Math.floor(16*Math.random())+48,Eu[c]>=58&&(Eu[c]+=39);return String.fromCharCode.apply(null,Eu.slice(0,2*l))}}class Tracer{constructor(l,c,d,h){__publicField(this,"_sampler"),__publicField(this,"_generalLimits"),__publicField(this,"_spanLimits"),__publicField(this,"_idGenerator"),__publicField(this,"instrumentationScope"),__publicField(this,"_resource"),__publicField(this,"_spanProcessor");const p=function(l){const c={sampler:buildSamplerFromEnv()},d=loadDefaultConfig(),h=Object.assign({},d,c,l);return h.generalLimits=Object.assign({},d.generalLimits,l.generalLimits||{}),h.spanLimits=Object.assign({},d.spanLimits,l.spanLimits||{}),h}(c);this._sampler=p.sampler,this._generalLimits=p.generalLimits,this._spanLimits=p.spanLimits,this._idGenerator=c.idGenerator||new RandomIdGenerator,this._resource=d,this._spanProcessor=h,this.instrumentationScope=l}startSpan(l,c={},d=Tl.active()){c.root&&(d=Hl.deleteSpan(d));const h=Hl.getSpan(d);if(isTracingSuppressed(d)){Rl.debug("Instrumentation suppressed, returning Noop Span");return Hl.wrapSpanContext(dl)}const p=h?.spanContext(),f=this._idGenerator.generateSpanId();let m,y,_;p&&Hl.isSpanContextValid(p)?(y=p.traceId,_=p.traceState,m=p):y=this._idGenerator.generateTraceId();const b=c.kind??bl.INTERNAL,w=(c.links??[]).map((l=>({context:l.context,attributes:sanitizeAttributes(l.attributes)}))),E=sanitizeAttributes(c.attributes),M=this._sampler.shouldSample(d,y,l,b,E,w);_=M.traceState??_;const N={traceId:y,spanId:f,traceFlags:M.decision===yl.RECORD_AND_SAMPLED?wa.SAMPLED:wa.NONE,traceState:_};if(M.decision===yl.NOT_RECORD){Rl.debug("Recording is off, propagating context in a non-recording span");return Hl.wrapSpanContext(N)}const P=sanitizeAttributes(Object.assign(E,M.attributes));return new SpanImpl({resource:this._resource,scope:this.instrumentationScope,context:d,spanContext:N,name:l,kind:b,links:w,parentSpanContext:m,attributes:P,startTime:c.startTime,spanProcessor:this._spanProcessor,spanLimits:this._spanLimits})}startActiveSpan(l,c,d,h){let p,f,m;if(arguments.length<2)return;2===arguments.length?m=c:3===arguments.length?(p=c,m=d):(p=c,f=d,m=h);const y=f??Tl.active(),_=this.startSpan(l,p,y),b=Hl.setSpan(y,_);return Tl.with(b,m,void 0,_)}getGeneralLimits(){return this._generalLimits}getSpanLimits(){return this._spanLimits}}class MultiSpanProcessor{constructor(l){__publicField(this,"_spanProcessors"),this._spanProcessors=l}forceFlush(){const l=[];for(const c of this._spanProcessors)l.push(c.forceFlush());return new Promise((c=>{Promise.all(l).then((()=>{c()})).catch((l=>{globalErrorHandler(l||new Error("MultiSpanProcessor: forceFlush failed")),c()}))}))}onStart(l,c){for(const d of this._spanProcessors)d.onStart(l,c)}onEnd(l){for(const c of this._spanProcessors)c.onEnd(l)}shutdown(){const l=[];for(const c of this._spanProcessors)l.push(c.shutdown());return new Promise(((c,d)=>{Promise.all(l).then((()=>{c()}),d)}))}}var Tu,Nu;(Nu=Tu||(Tu={}))[Nu.resolved=0]="resolved",Nu[Nu.timeout=1]="timeout",Nu[Nu.error=2]="error",Nu[Nu.unresolved=3]="unresolved";class BasicTracerProvider{constructor(l={}){__publicField(this,"_config"),__publicField(this,"_tracers",new Map),__publicField(this,"_resource"),__publicField(this,"_activeSpanProcessor");const c=function(...l){let c=l.shift();const d=new WeakMap;for(;l.length>0;)c=mergeTwoObjects(c,l.shift(),0,d);return c}({},loadDefaultConfig(),function(l){const c=Object.assign({},l.spanLimits);return c.attributeCountLimit=l.spanLimits?.attributeCountLimit??l.generalLimits?.attributeCountLimit??void 0??void 0??128,c.attributeValueLengthLimit=l.spanLimits?.attributeValueLengthLimit??l.generalLimits?.attributeValueLengthLimit??void 0??void 0??Cu,Object.assign({},l,{spanLimits:c})}(l));this._resource=c.resource??resourceFromAttributes({[mc]:"unknown_service",[vc]:Pc[vc],[_c]:Pc[_c],[Ic]:Pc[Ic]}),this._config=Object.assign({},c,{resource:this._resource});const d=[];l.spanProcessors?.length&&d.push(...l.spanProcessors),this._activeSpanProcessor=new MultiSpanProcessor(d)}getTracer(l,c,d){const h=`${l}@${c||""}:${d?.schemaUrl||""}`;return this._tracers.has(h)||this._tracers.set(h,new Tracer({name:l,version:c,schemaUrl:d?.schemaUrl},this._config,this._resource,this._activeSpanProcessor)),this._tracers.get(h)}forceFlush(){const l=this._config.forceFlushTimeoutMillis,c=this._activeSpanProcessor._spanProcessors.map((c=>new Promise((d=>{let h;const p=setTimeout((()=>{d(new Error(`Span processor did not completed within timeout period of ${l} ms`)),h=Tu.timeout}),l);c.forceFlush().then((()=>{clearTimeout(p),h!==Tu.timeout&&(h=Tu.resolved,d(h))})).catch((l=>{clearTimeout(p),h=Tu.error,d(l)}))}))));return new Promise(((l,d)=>{Promise.all(c).then((c=>{const h=c.filter((l=>l!==Tu.resolved));h.length>0?d(h):l()})).catch((l=>d([l])))}))}shutdown(){return this._activeSpanProcessor.shutdown()}}class SimpleSpanProcessor{constructor(l){__publicField(this,"_exporter"),__publicField(this,"_shutdownOnce"),__publicField(this,"_pendingExports"),this._exporter=l,this._shutdownOnce=new BindOnceFuture(this._shutdown,this),this._pendingExports=new Set}async forceFlush(){await Promise.all(Array.from(this._pendingExports)),this._exporter.forceFlush&&await this._exporter.forceFlush()}onStart(l,c){}onEnd(l){if(this._shutdownOnce.isCalled)return;if(!(l.spanContext().traceFlags&wa.SAMPLED))return;const c=this._doExport(l).catch((l=>globalErrorHandler(l)));this._pendingExports.add(c),c.finally((()=>this._pendingExports.delete(c)))}async _doExport(l){l.resource.asyncAttributesPending&&await(l.resource.waitForAsyncAttributes?.());const c=await Su._export(this._exporter,[l]);if(c.code!==$c.SUCCESS)throw c.error??new Error(`SimpleSpanProcessor: span export failed (status ${c})`)}shutdown(){return this._shutdownOnce.call()}_shutdown(){return this._exporter.shutdown()}}class StackContextManager{constructor(){__publicField(this,"_enabled",!1),__publicField(this,"_currentContext",xa)}_bindFunction(l=xa,c){const d=this,contextWrapper=function(...h){return d.with(l,(()=>c.apply(this,h)))};return Object.defineProperty(contextWrapper,"length",{enumerable:!1,configurable:!0,writable:!1,value:c.length}),contextWrapper}active(){return this._currentContext}bind(l,c){return void 0===l&&(l=this.active()),"function"==typeof c?this._bindFunction(l,c):c}disable(){return this._currentContext=xa,this._enabled=!1,this}enable(){return this._enabled||(this._enabled=!0,this._currentContext=xa),this}with(l,c,d,...h){const p=this._currentContext;this._currentContext=l||xa;try{return c.call(d,...h)}finally{this._currentContext=p}}}class WebTracerProvider extends BasicTracerProvider{constructor(l={}){super(l)}register(l={}){var c;Hl.setGlobalTracerProvider(this),null!==(c=l.propagator)&&(void 0!==c?Ul.setGlobalPropagator(c):Ul.setGlobalPropagator(new CompositePropagator({propagators:[new W3CTraceContextPropagator,new W3CBaggagePropagator]}))),function(l){if(null!==l){if(void 0===l){const l=new StackContextManager;return l.enable(),void Tl.setGlobalContextManager(l)}l.enable(),Tl.setGlobalContextManager(l)}}(l.contextManager)}}const Lu="browser.brands",Du="browser.language",$u="browser.mobile",Hu="browser.platform",qu="deployment.environment.name",Vu="http.url";var Zu=Object.defineProperty,_$1=(l,c,d)=>((l,c,d)=>c in l?Zu(l,c,{enumerable:!0,configurable:!0,writable:!0,value:d}):l[c]=d)(l,"symbol"!=typeof c?c+"":c,d);const Ju="logfire",Yu=`${Ju}.level_num`,ed=`${Ju}.span_type`,nd=`${Ju}.tags`,id=`${Ju}.msg_template`,od=`${Ju}.scrubbed`,ld="logfire";let cd=class extends Error{constructor(l){super(l),this.name="KnownFormattingError"}};const ud=new class{constructor(){_$1(this,"parseRegex",/(\{\{)|(\}\})|(\{([^{}]*)(?::([^{}]*))?\})/g)}chunks(l,c,d){const[h,p]=this.vformatChunks(l,c,d);return[h,p,l]}formatField(l,c){if(!c)return String(l);if("number"==typeof l&&c.includes(".")){const[,d]=c.split(".");return l.toFixed(parseInt(d,10))}return String(l)}getField(l,c){if(!l.includes(".")&&!l.includes("[")){if(l in c)return[c[l],l];throw new cd(`The field ${l} is not defined.`)}try{const d=l.split(".");let h=c[d[0]??""];for(let p=1;p<d.length;p++){const f=d[p]??"";if(!(f in c))throw new cd(`The field ${l} is not an object.`);h=c[f]}return[h,d[0]??""]}catch{if(l in c)return[c[l],l];throw new cd(`The field ${l} is not defined.`)}}parse(l){const c=[];let d,h=0,p="";for(;null!==(d=this.parseRegex.exec(l));){const[f,m,y,_,b,w]=d;p+=l.substring(h,d.index),m?p+="{":y?p+="}":_&&(c.push([p,b??null,w??null,null]),p=""),h=d.index+f.length}return h<l.length&&(p+=l.substring(h)),p&&c.push([p,null,null,null]),c}cleanValue(l,c,d){if(d.SAFE_KEYS.includes(l))return[F$1(c,2e3),[]];const[h,p]=d.scrubValue(["message",l],c);return[F$1(h,2e3),p]}vformatChunks(l,c,d,h=2){if(h<0)throw new cd("Max format spec recursion exceeded");const p=[],f=[];for(const[y,_,b]of this.parse(l))if(y&&p.push({type:"lit",value:y}),null!==_){if(""===_)throw new cd("Empty curly brackets `{}` are not allowed. A field name is required.");let l,h,y=_;if(_.endsWith("=")){const l=p[p.length-1]??null;null!==l&&"lit"===l.type?l.value+=_:p.push({type:"lit",value:_}),y=_.slice(0,-1)}try{[l]=this.getField(y,c)}catch(m){throw m instanceof cd?m:new cd(`Error getting field ${y}: ${String(m)}`)}try{h=this.formatField(l,b??"")}catch(m){throw new cd(`Error formatting field ${y}: ${String(m)}`)}const[w,E]=this.cleanValue(y,h,d);f.push(...E);const M={type:"arg",value:w};b&&(M.spec=b),p.push(M)}return[p,f.length>0?{[od]:f}:{}]}};function C$1(l,c,d){try{const[h,p,f]=ud.chunks(l,c,d);return[h.map((l=>l.value)).join(""),p,f]}catch(h){return h instanceof cd?console.warn(`Formatting error: ${h.message}`):console.error("Unexpected error during formatting:",h),[l,{},l]}}function F$1(l,c){return l.length<=c?l:l.substring(0,c-3)+"..."}const fd=["password","passwd","mysql_pwd","secret","auth(?!ors?\\b)","credential","private[._ -]?key","api[._ -]?key","session","cookie","csrf","xsrf","jwt","ssn","social[._ -]?security","credit[._ -]?card"],kd=new Set(["code.filepath","code.function","code.lineno","db.plan","db.statement","exception.stacktrace","exception.type","http.method","http.route","http.scheme","http.status_code","http.target","http.url","logfire.json_schema","logfire.level_name","logfire.level_num","logfire.logger_name","logfire.msg","logfire.msg_template","logfire.null_args","logfire.package_versions","logfire.pending_parent_id","logfire.sample_rate","logfire.scrubbed","logfire.span_type","logfire.tags","schema.url","url.full","url.path","url.query"]);let Od=class{constructor(l,c){_$1(this,"SAFE_KEYS",Array.from(kd)),_$1(this,"_callback"),_$1(this,"_pattern");const d=[...fd,...l??[]];this._pattern=new RegExp(d.join("|"),"i"),this._callback=c}scrubValue(l,c){const d=[];return[this.scrub(l,c,d),d]}redact(l,c,d,h){if(this._callback){const h=this._callback({path:l,patternMatch:d,value:c});if(null!=h)return h}const p=d[0];return h.push({matched_substring:p,path:l}),`[Scrubbed due to '${p}']`}scrub(l,c,d){if("string"==typeof c){const h=c.match(this._pattern);if(h&&(0!==h.index||h[0].length!==c.length))try{const h=JSON.parse(c),p=this.scrub(l,h,d);return JSON.stringify(p)}catch{return this.redact(l,c,h,d)}return c}if(Array.isArray(c))return c.map(((c,h)=>this.scrub([...l,h],c,d)));if(c&&"object"==typeof c){const h={};for(const[p,f]of Object.entries(c))if(kd.has(p)||["boolean","number","undefined"].includes(typeof f)||null===f)h[p]=f;else{const c=p.match(this._pattern);if(c){const m=this.redact([...l,p],f,c,d);h[p]=m}else h[p]=this.scrub([...l,p],f,d)}return h}return c}},Nd=class{constructor(){_$1(this,"SAFE_KEYS",[])}scrubValue(l,c){return[c,[]]}};function B$1(l){const c=Ld.scrubber,d=ed in l,[h,p]=d?[l,[]]:c.scrubValue([],l),f={},m=[],y={properties:{},type:"object"};p.length>0&&(od in h?h[od].push(...p):h[od]=p);for(const[_,b]of Object.entries(h))_!==nd?null==b?m.push(_):"string"==typeof b||"number"==typeof b||"boolean"==typeof b?f[_]=b:b instanceof Date?f[_]=b.toISOString():Array.isArray(b)?(y.properties[_]={type:"array"},f[_]=JSON.stringify(b)):(y.properties[_]={type:"object"},f[_]=JSON.stringify(b)):f[_]=b;return m.length>0&&(f["logfire.null_args"]=m),Object.keys(y.properties).length>0&&(f["logfire.json_schema"]=JSON.stringify(y)),f}new Nd;const Ld={otelScope:ld,scrubber:new Od,tracer:Hl.getTracer(ld)};function le$1(l){void 0!==l.scrubbing&&(Ld.scrubber=function(l){return void 0!==l?!1===l?new Nd:new Od(l.extraPatterns,l.callback):new Od}(l.scrubbing)),void 0!==l.otelScope&&(Ld.otelScope=l.otelScope,Ld.tracer=Hl.getTracer(l.otelScope))}let jd=class extends RandomIdGenerator{constructor(){super(...arguments),_$1(this,"generateTraceId",(()=>function(){let l=BigInt(Date.now());const c=crypto.getRandomValues(new Uint8Array(10));for(const d of c)l<<=BigInt(8),l|=BigInt(d);return l}().toString(16).padStart(32,"0")))}};const Dd=5,Fd=9,$d=13,Ud=17;function N$1(l,c={},{log:d,tags:h=[],level:p=Fd,parentSpan:f}={}){const[m,y,_]=C$1(l,c,Ld.scrubber),b=f?Hl.setSpan(Tl.active(),f):Tl.active();return Ld.tracer.startSpan(m,{attributes:{...B$1({...c,...y}),[id]:_,[Yu]:p,[nd]:Array.from(new Set(h).values()),[ed]:d?"log":"span"}},b)}function pe$1(l,...c){let d,h,p={},f=Fd,m=[];1===c.length?(p=c[0].attributes??{},f=c[0].level??Fd,m=c[0].tags??[],d=c[0].callback,h=c[0].parentSpan):(p=c[0],f=c[1].level??Fd,m=c[1].tags??[],h=c[1].parentSpan,d=c[2]);const[y,_,b]=C$1(l,p,Ld.scrubber),w=h?Hl.setSpan(Tl.active(),h):Tl.active();return Ld.tracer.startActiveSpan(y,{attributes:{...B$1({...p,..._}),[id]:b,[Yu]:f,[nd]:Array.from(new Set(m).values())}},w,(l=>{const c=d(l);return"object"==typeof c&&null!==c&&"finally"in c&&"function"==typeof c.finally?c.finally((()=>{l.end()})):l.end(),c}))}function E$1(l,c={},d={}){N$1(l,c,{...d,log:!0}).end()}function ge$1(l,c={},d={}){E$1(l,c,{...d,level:Dd})}function be$1(l,c={},d={}){E$1(l,c,{...d,level:Fd})}function he$1(l,c={},d={}){E$1(l,c,{...d,level:Ud})}function Se$1(l,c={},d={}){E$1(l,c,{...d,level:$d})}class OTLPExporterBase{constructor(l){__publicField(this,"_delegate"),this._delegate=l}export(l,c){this._delegate.export(l,c)}forceFlush(){return this._delegate.forceFlush()}shutdown(){return this._delegate.shutdown()}}class OTLPExporterError extends Error{constructor(l,c,d){super(l),__publicField(this,"code"),__publicField(this,"name","OTLPExporterError"),__publicField(this,"data"),this.data=d,this.code=c}}function validateTimeoutMillis(l){if(Number.isFinite(l)&&l>0)return l;throw new Error(`Configuration: timeoutMillis is invalid, expected number greater than 0 (actual: '${l}')`)}class BoundedQueueExportPromiseHandler{constructor(l){__publicField(this,"_concurrencyLimit"),__publicField(this,"_sendingPromises",[]),this._concurrencyLimit=l}pushPromise(l){if(this.hasReachedLimit())throw new Error("Concurrency Limit reached");this._sendingPromises.push(l);const popPromise=()=>{const c=this._sendingPromises.indexOf(l);this._sendingPromises.splice(c,1)};l.then(popPromise,popPromise)}hasReachedLimit(){return this._sendingPromises.length>=this._concurrencyLimit}async awaitAll(){await Promise.all(this._sendingPromises)}}function createBoundedQueueExportPromiseHandler(l){return new BoundedQueueExportPromiseHandler(l.concurrencyLimit)}function createLoggingPartialSuccessResponseHandler(){return{handleResponse(l){null!=l&&function(l){return Object.prototype.hasOwnProperty.call(l,"partialSuccess")}(l)&&null!=l.partialSuccess&&0!==Object.keys(l.partialSuccess).length&&Rl.warn("Received Partial Success response:",JSON.stringify(l.partialSuccess))}}}class OTLPExportDelegate{constructor(l,c,d,h,p){__publicField(this,"_transport"),__publicField(this,"_serializer"),__publicField(this,"_responseHandler"),__publicField(this,"_promiseQueue"),__publicField(this,"_timeout"),__publicField(this,"_diagLogger"),this._transport=l,this._serializer=c,this._responseHandler=d,this._promiseQueue=h,this._timeout=p,this._diagLogger=Rl.createComponentLogger({namespace:"OTLPExportDelegate"})}export(l,c){if(this._diagLogger.debug("items to be sent",l),this._promiseQueue.hasReachedLimit())return void c({code:$c.FAILED,error:new Error("Concurrent export limit reached")});const d=this._serializer.serializeRequest(l);null!=d?this._promiseQueue.pushPromise(this._transport.send(d,this._timeout).then((l=>{if("success"!==l.status)"failure"===l.status&&l.error?c({code:$c.FAILED,error:l.error}):"retryable"===l.status?c({code:$c.FAILED,error:new OTLPExporterError("Export failed with retryable status")}):c({code:$c.FAILED,error:new OTLPExporterError("Export failed with unknown error")});else{if(null!=l.data)try{this._responseHandler.handleResponse(this._serializer.deserializeResponse(l.data))}catch(hh){this._diagLogger.warn("Export succeeded but could not deserialize response - is the response specification compliant?",hh,l.data)}c({code:$c.SUCCESS})}}),(l=>c({code:$c.FAILED,error:l})))):c({code:$c.FAILED,error:new Error("Nothing to send")})}forceFlush(){return this._promiseQueue.awaitAll()}async shutdown(){this._diagLogger.debug("shutdown started"),await this.forceFlush(),this._transport.shutdown()}}function createOtlpNetworkExportDelegate(l,c,d){return h={transport:d,serializer:c,promiseHandler:createBoundedQueueExportPromiseHandler(l)},p={timeout:l.timeoutMillis},new OTLPExportDelegate(h.transport,h.serializer,createLoggingPartialSuccessResponseHandler(),h.promiseHandler,p.timeout);var h,p}class RetryingTransport{constructor(l){__publicField(this,"_transport"),this._transport=l}retry(l,c,d){return new Promise(((h,p)=>{setTimeout((()=>{this._transport.send(l,c).then(h,p)}),d)}))}async send(l,c){const d=Date.now()+c;let h=await this._transport.send(l,c),p=5,f=1e3;for(;"retryable"===h.status&&p>0;){p--;const c=Math.max(Math.min(f,5e3)+(.4*Math.random()-.2),0);f*=1.5;const m=h.retryInMillis??c,y=d-Date.now();if(m>y)return h;h=await this.retry(l,y,m)}return h}shutdown(){return this._transport.shutdown()}}function parseRetryAfterToMills(l){if(null==l)return;const c=Number.parseInt(l,10);if(Number.isInteger(c))return c>0?1e3*c:-1;const d=new Date(l).getTime()-Date.now();return d>=0?d:0}class XhrTransport{constructor(l){__publicField(this,"_parameters"),this._parameters=l}send(l,c){return new Promise((d=>{const h=new XMLHttpRequest;h.timeout=c,h.open("POST",this._parameters.url);const p=this._parameters.headers();Object.entries(p).forEach((([l,c])=>{h.setRequestHeader(l,c)})),h.ontimeout=l=>{d({status:"failure",error:new Error("XHR request timed out")})},h.onreadystatechange=()=>{var l;h.status>=200&&h.status<=299?(Rl.debug("XHR success"),d({status:"success"})):h.status&&(l=h.status,[429,502,503,504].includes(l))?d({status:"retryable",retryInMillis:parseRetryAfterToMills(h.getResponseHeader("Retry-After"))}):0!==h.status&&d({status:"failure",error:new Error("XHR request failed with non-retryable status")})},h.onabort=()=>{d({status:"failure",error:new Error("XHR request aborted")})},h.onerror=()=>{d({status:"failure",error:new Error("XHR request errored")})},h.send(l)}))}shutdown(){}}function createOtlpXhrExportDelegate(l,c){return createOtlpNetworkExportDelegate(l,c,function(l){return new RetryingTransport(l.transport)}({transport:(d=l,new XhrTransport(d))}));var d}function intValue(l){return l>=48&&l<=57?l-48:l>=97&&l<=102?l-87:l-55}function hexToBinary(l){const c=new Uint8Array(l.length/2);let d=0;for(let h=0;h<l.length;h+=2){const p=intValue(l.charCodeAt(h)),f=intValue(l.charCodeAt(h+1));c[d++]=p<<4|f}return c}function hrTimeToNanos(l){const c=BigInt(1e9);return BigInt(l[0])*c+BigInt(l[1])}const Bd="undefined"!=typeof BigInt?function(l){return hrTimeToNanos(l).toString()}:function(l){return l[0]*Fc+l[1]};function identity(l){return l}const Wd={encodeHrTime:function(l){const c=hrTimeToNanos(l);return d=c,{low:Number(BigInt.asUintN(32,d)),high:Number(BigInt.asUintN(32,d>>BigInt(32)))};var d},encodeSpanContext:hexToBinary,encodeOptionalSpanContext:function(l){if(void 0!==l)return hexToBinary(l)}};function createResource(l){return{attributes:toAttributes(l.attributes),droppedAttributesCount:0}}function toAttributes(l){return Object.keys(l).map((c=>toKeyValue(c,l[c])))}function toKeyValue(l,c){return{key:l,value:toAnyValue(c)}}function toAnyValue(l){const c=typeof l;return"string"===c?{stringValue:l}:"number"===c?Number.isInteger(l)?{intValue:l}:{doubleValue:l}:"boolean"===c?{boolValue:l}:l instanceof Uint8Array?{bytesValue:l}:Array.isArray(l)?{arrayValue:{values:l.map(toAnyValue)}}:"object"===c&&null!=l?{kvlistValue:{values:Object.entries(l).map((([l,c])=>toKeyValue(l,c)))}}:{}}function sdkSpanToOtlpSpan(l,c){const d=l.spanContext(),h=l.status,p=l.parentSpanContext?.spanId?c.encodeSpanContext(l.parentSpanContext?.spanId):void 0;return{traceId:c.encodeSpanContext(d.traceId),spanId:c.encodeSpanContext(d.spanId),parentSpanId:p,traceState:d.traceState?.serialize(),name:l.name,kind:null==l.kind?0:l.kind+1,startTimeUnixNano:c.encodeHrTime(l.startTime),endTimeUnixNano:c.encodeHrTime(l.endTime),attributes:toAttributes(l.attributes),droppedAttributesCount:l.droppedAttributesCount,events:l.events.map((l=>function(l,c){return{attributes:l.attributes?toAttributes(l.attributes):[],name:l.name,timeUnixNano:c.encodeHrTime(l.time),droppedAttributesCount:l.droppedAttributesCount||0}}(l,c))),droppedEventsCount:l.droppedEventsCount,status:{code:h.code,message:h.message},links:l.links.map((l=>function(l,c){return{attributes:l.attributes?toAttributes(l.attributes):[],spanId:c.encodeSpanContext(l.context.spanId),traceId:c.encodeSpanContext(l.context.traceId),traceState:l.context.traceState?.serialize(),droppedAttributesCount:l.droppedAttributesCount||0}}(l,c))),droppedLinksCount:l.droppedLinksCount}}function createExportTraceServiceRequest(l,c){const d=function(l){return void 0===l?Wd:{encodeHrTime:Bd,encodeSpanContext:identity,encodeOptionalSpanContext:identity}}(c);return{resourceSpans:spanRecordsToResourceSpans(l,d)}}function spanRecordsToResourceSpans(l,c){const d=function(l){const c=new Map;for(const d of l){let l=c.get(d.resource);l||(l=new Map,c.set(d.resource,l));const h=`${d.instrumentationScope.name}@${d.instrumentationScope.version||""}:${d.instrumentationScope.schemaUrl||""}`;let p=l.get(h);p||(p=[],l.set(h,p)),p.push(d)}return c}(l),h=[],p=d.entries();let f=p.next();for(;!f.done;){const[l,d]=f.value,y=[],_=d.values();let b=_.next();for(;!b.done;){const l=b.value;if(l.length>0){const d=l.map((l=>sdkSpanToOtlpSpan(l,c)));y.push({scope:(m=l[0].instrumentationScope,{name:m.name,version:m.version}),spans:d,schemaUrl:l[0].instrumentationScope.schemaUrl})}b=_.next()}const w={resource:createResource(l),scopeSpans:y,schemaUrl:void 0};h.push(w),f=p.next()}var m;return h}const Vd={serializeRequest:l=>{const c=createExportTraceServiceRequest(l,{});return(new TextEncoder).encode(JSON.stringify(c))},deserializeResponse:l=>{if(0===l.length)return{};const c=new TextDecoder;return JSON.parse(c.decode(l))}};var Kd=Object.defineProperty,i$3=(l,c,d)=>((l,c,d)=>c in l?Kd(l,c,{enumerable:!0,configurable:!0,writable:!0,value:d}):l[c]=d)(l,"symbol"!=typeof c?c+"":c,d);const Jd="target_xpath",Yd={1:"trace",5:"debug",9:"info",10:"notice",13:"warning",17:"error",21:"fatal"},Qd={debug:"#E3E3E3",error:"#EA4335",fatal:"#EA4335",info:"#9EC1FB",notice:"#A5D490","on-debug":"#636262","on-error":"#FFEDE9","on-fatal":"#FFEDE9","on-info":"#063175","on-notice":"#222222","on-trace":"#636262","on-warning":"#613A0D",trace:"#E3E3E3",warning:"#EFB77A"};let Xd=class{export(l,c){this.sendSpans(l,c)}forceFlush(){return Promise.resolve()}shutdown(){return this.sendSpans([]),this.forceFlush()}exportInfo(l){var c;return{attributes:l.attributes,duration:hrTimeToMicroseconds(l.duration),events:l.events,id:l.spanContext().spanId,instrumentationScope:l.instrumentationScope,kind:l.kind,links:l.links,name:l.name,parentSpanContext:l.parentSpanContext,resource:{attributes:l.resource.attributes},status:l.status,timestamp:hrTimeToMicroseconds(l.startTime),traceId:l.spanContext().traceId,traceState:null==(c=l.spanContext().traceState)?void 0:c.serialize()}}sendSpans(l,c){for(const d of l){const l=Yd[d.attributes["logfire.level_num"]]??"info",{attributes:c,name:h,...p}=this.exportInfo(d);console.log(`%cLogfire %c${l}`,"background-color: #E520E9; color: #FFFFFF",`background-color: ${Qd[`on-${l}`]}; color: ${Qd[l]}`,h,c,p)}c&&c({code:$c.SUCCESS})}},eh=class{constructor(l,c){i$3(this,"console"),i$3(this,"wrapped"),c&&(this.console=new SimpleSpanProcessor(new Xd)),this.wrapped=l}async forceFlush(){var l;return await(null==(l=this.console)?void 0:l.forceFlush()),this.wrapped.forceFlush()}onEnd(l){var c;null==(c=this.console)||c.onEnd(l),this.wrapped.onEnd(l)}onStart(l,c){var d;if(Vu in l.attributes){const c=new URL(l.attributes[Vu]);Reflect.set(l,"name",`${l.name} ${c.pathname}`)}Jd in l.attributes&&Reflect.set(l,"name",`${l.attributes.event_type??"unknown"} ${l.attributes[Jd]??""}`),null==(d=this.console)||d.onStart(l,c),this.wrapped.onStart(l,c)}async shutdown(){var l;return await(null==(l=this.console)?void 0:l.shutdown()),this.wrapped.shutdown()}},sh=class extends OTLPExporterBase{constructor(l,c){var d,h,p;super(createOtlpXhrExportDelegate({...(d={compression:l.compression,concurrencyLimit:l.concurrencyLimit,timeoutMillis:l.timeoutMillis},h={},p={timeoutMillis:1e4,concurrencyLimit:30,compression:"none"},{timeoutMillis:validateTimeoutMillis(d.timeoutMillis??h.timeoutMillis??p.timeoutMillis),concurrencyLimit:d.concurrencyLimit??h.concurrencyLimit??p.concurrencyLimit,compression:d.compression??h.compression??p.compression}),agentOptions:{keepAlive:!0},headers:()=>({"Content-Type":"application/json",...l.headers??{},...c?c():{}}),url:l.url??"http://localhost:4318/v1/traces"},Vd))}};function J$1(){return{}}function se$1(l){void 0!==l.diagLogLevel&&Rl.setLogger(new Ca,l.diagLogLevel),void 0!==l.scrubbing&&le$1({scrubbing:l.scrubbing});const c=resourceFromAttributes({[Du]:navigator.language,[mc]:l.serviceName??"logfire-browser",[gc]:l.serviceVersion??"0.0.1",[vc]:yc,[_c]:"logfire-browser",...l.environment?{[qu]:l.environment}:{},[Ic]:"0.9.0",...navigator.userAgentData?{[Lu]:navigator.userAgentData.brands.map((l=>`${l.brand} ${l.version}`)),[$u]:navigator.userAgentData.mobile,[Hu]:navigator.userAgentData.platform}:{[Oc]:navigator.userAgent}});Rl.info("logfire-browser: starting");const d=new WebTracerProvider({idGenerator:new jd,resource:c,spanProcessors:[new eh(new BatchSpanProcessor(new sh({...l.traceExporterConfig,url:l.traceUrl},l.traceExporterHeaders??J$1),l.batchSpanProcessorConfig),!!l.console)]});d.register({contextManager:l.contextManager??new StackContextManager});const h=function(l){const c=l.tracerProvider||Hl.getTracerProvider(),d=l.meterProvider||Nl.getMeterProvider(),h=l.loggerProvider||Yl.getLoggerProvider(),p=l.instrumentations?.flat()??[];return function(l,c,d,h){for(let p=0,f=l.length;p<f;p++){const f=l[p];c&&f.setTracerProvider(c),d&&f.setMeterProvider(d),h&&f.setLoggerProvider&&f.setLoggerProvider(h),f.getConfig().enabled||f.enable()}}(p,c,d,h),()=>{!function(l){l.forEach((l=>l.disable()))}(p)}}({instrumentations:l.instrumentations??[],tracerProvider:d});return async()=>{Rl.info("logfire-browser: shutting down"),h(),await d.forceFlush(),await d.shutdown(),Rl.info("logfire-browser: shut down complete")}}const oh=class _ConfirmitLogfireManager{constructor(){__publicField(this,"isInitialized",!1)}static getInstance(){return _ConfirmitLogfireManager.instance||(_ConfirmitLogfireManager.instance=new _ConfirmitLogfireManager),_ConfirmitLogfireManager.instance}initialize(l){if(this.isInitialized)return;const c={...{traceUrl:"https://logfire-api.pydantic.dev/v1/traces",serviceName:"confirmit-extension",serviceVersion:chrome?.runtime?.getManifest?.()?.version||"1.0.0",environment:"production",console:!1,scrubbing:!1,traceExporterHeaders:()=>({Authorization:"Bearer pylf_v1_us_ZX6yCHqCpNcX8pJ0N33dG9n6kqCF7fxplj05HDpg29KJ"})},...l};try{se$1(c);console.log("[Logfire] Real Logfire SDK initialized successfully")}catch(d){throw console.error("[Logfire] Failed to initialize real SDK:",d),d}this.setupAutoInstrumentation(),this.isInitialized=!0,be$1("Logfire initialized for Confirmit Extension",{service:c.serviceName,version:c.serviceVersion,environment:c.environment})}setupAutoInstrumentation(){this.instrumentFetch(),this.instrumentUserInteractions(),this.instrumentErrors(),this.instrumentPerformance()}instrumentFetch(){const l=window.fetch;window.fetch=async(c,d)=>{const h="string"==typeof c?c:c.toString(),p=d?.method||"GET";return await pe$1(`HTTP ${p}`,{attributes:{"http.method":p,"http.url":this.sanitizeUrl(h),"http.user_agent":navigator.userAgent,component:"fetch"},callback:async h=>{try{const p=await l(c,d);return h.setAttributes({"http.status_code":p.status,"http.response_size":p.headers.get("content-length")||0,"http.success":p.ok}),p}catch(p){throw h.recordException(p),p}}})}}instrumentUserInteractions(){document.addEventListener("click",(l=>{const c=l.target;be$1("User click",{"ui.element.tag":c.tagName.toLowerCase(),"ui.element.class":c.className,"ui.element.id":c.id,"ui.element.text":c.textContent?.slice(0,100),"ui.coordinates.x":l.clientX,"ui.coordinates.y":l.clientY})})),document.addEventListener("submit",(l=>{const c=l.target;be$1("User form submit",{"ui.form.action":c.action,"ui.form.method":c.method,"ui.form.id":c.id,"ui.form.class":c.className})}))}instrumentErrors(){window.addEventListener("error",(l=>{this.reportException(l.error||new Error(l.message),{"error.type":"uncaught_error","error.filename":l.filename,"error.line":l.lineno,"error.column":l.colno})})),window.addEventListener("unhandledrejection",(l=>{const c=l.reason instanceof Error?l.reason:new Error(String(l.reason));this.reportException(c,{"error.type":"unhandled_rejection"})}))}instrumentPerformance(){"memory"in performance&&setInterval((()=>{const l=performance.memory;ge$1("Performance memory",{"memory.used_js_heap_size":l.usedJSHeapSize,"memory.total_js_heap_size":l.totalJSHeapSize,"memory.js_heap_size_limit":l.jsHeapSizeLimit})}),3e4)}trackToolCall(l,c,d){return pe$1(`tool_call.${c}`,{attributes:{"tool_call.id":l,"tool_call.type":c,component:"tool_executor"},callback:async h=>{try{const p=await d();return h.setAttributes({"tool_call.success":!0,"tool_call.result_size":JSON.stringify(p).length}),be$1(`Tool call ${c} completed successfully`,{toolCallId:l,toolCallType:c,success:!0}),p}catch(p){throw h.recordException(p),h.setAttributes({"tool_call.success":!1,"tool_call.error":p.message}),he$1(`Tool call ${c} failed`,{toolCallId:l,toolCallType:c,component:"tool_executor",errorMessage:p.message}),p}}})}trackApiOperation(l,c,d,h){return pe$1(`api.${l}`,{attributes:{"api.endpoint":this.sanitizeUrl(c),"api.method":d,"api.operation":l,component:"api_client"},callback:async p=>{try{const f=await h();return p.setAttributes({"api.success":!0,"api.response_size":JSON.stringify(f).length}),be$1(`API ${l} completed successfully`,{operationName:l,endpoint:this.sanitizeUrl(c),method:d,success:!0}),f}catch(f){throw p.recordException(f),p.setAttributes({"api.success":!1,"api.error":f.message}),he$1(`API ${l} failed`,{operationName:l,endpoint:this.sanitizeUrl(c),method:d,component:"api_client",errorMessage:f.message}),f}}})}createSpan(l,c,d){return d?pe$1(l,{attributes:c,callback:async l=>{try{return await d()}catch(c){throw l.recordException(c),c}}}):N$1(l,c)}log(l,c,d){const h={"log.level":l,"log.timestamp":(new Date).toISOString(),...d};switch(l){case"debug":ge$1(c,h);break;case"info":be$1(c,h);break;case"warn":Se$1(c,h);break;case"error":he$1(c,h)}}reportException(l,c){const d=l instanceof Error?l:new Error(String(l)),h={"error.message":d.message,"error.name":d.name,"error.stack":d.stack,"error.timestamp":(new Date).toISOString(),"extension.version":chrome?.runtime?.getManifest?.()?.version||"unknown","browser.user_agent":navigator.userAgent,"browser.language":navigator.language,"page.url":window.location.href,"page.referrer":document.referrer,...c};he$1(`Exception: ${d.name}`,h);try{!function(l,c,d={}){const h=N$1(l,{[dc]:c.message??"error",[pc]:c.stack,...d},{level:Ud});h.recordException(c),h.setStatus({code:Sl.ERROR}),h.end()}(`${d.name}: ${d.message}`,d)}catch(p){console.error("[Logfire] Failed to report exception:",p)}}trackWebSocketConnection(l,c,d){const h={"websocket.url":this.sanitizeUrl(l),"websocket.status":c,"websocket.timestamp":(new Date).toISOString(),component:"websocket",...d};switch(c){case"connecting":be$1("WebSocket connecting",h);break;case"connected":be$1("WebSocket connected",h);break;case"closing":Se$1("WebSocket closing",h);break;case"closed":Se$1("WebSocket closed",h);break;case"error":he$1("WebSocket error",h)}}trackWebSocketMessageSent(l,c,d){be$1("WebSocket message sent",{"websocket.message.type":l,"websocket.message.direction":"outbound","websocket.message.size":JSON.stringify(c).length,"websocket.message.timestamp":(new Date).toISOString(),component:"websocket",...d})}trackWebSocketMessageReceived(l,c,d){ge$1("WebSocket message received",{"websocket.message.type":l,"websocket.message.direction":"inbound","websocket.message.size":JSON.stringify(c).length,"websocket.message.timestamp":(new Date).toISOString(),component:"websocket",...d})}trackWebSocketReconnection(l,c,d){Se$1("WebSocket reconnection attempt",{"websocket.reconnection.attempt":l,"websocket.reconnection.max_attempts":c,"websocket.reconnection.timestamp":(new Date).toISOString(),component:"websocket",...d})}trackWebSocketBatch(l,c,d){return pe$1("websocket.batch",{attributes:{"websocket.batch.id":l,"websocket.batch.tool_count":c.length,"websocket.batch.tool_types":c.map((l=>l.type)).join(", "),component:"websocket_batch"},callback:async h=>{try{const p=await d();return h.setAttributes({"websocket.batch.success":!0,"websocket.batch.completed_at":(new Date).toISOString()}),be$1("WebSocket batch completed",{batchId:l,toolCount:c.length,success:!0}),p}catch(p){throw h.recordException(p),h.setAttributes({"websocket.batch.success":!1,"websocket.batch.error":p.message}),he$1("WebSocket batch failed",{batchId:l,toolCount:c.length,errorMessage:p.message}),p}}})}trackWebSocketBatchProgress(l,c,d,h){ge$1("WebSocket batch progress",{"websocket.batch.id":l,"websocket.batch.completed":c,"websocket.batch.total":d,"websocket.batch.percentage":Math.round(c/d*100),"websocket.batch.current_tool.id":h.id,"websocket.batch.current_tool.type":h.type,"websocket.batch.current_tool.status":h.status,component:"websocket_batch"})}trackWebSocketAck(l,c,d,h){c?ge$1("WebSocket message acknowledged",{"websocket.ack.event_uid":l,"websocket.ack.duration_ms":d,"websocket.ack.status":"success",component:"websocket",...h}):Se$1("WebSocket message not acknowledged",{"websocket.ack.event_uid":l,"websocket.ack.status":"timeout",component:"websocket",...h})}sanitizeUrl(l){return l}};__publicField(oh,"instance");const ah=oh.getInstance(),logInfo$1=(l,c)=>be$1(l,c),logError=(l,c)=>he$1(l,c),logDebug=(l,c)=>ge$1(l,c);function e$1(l,c,d,h,p,f,m){try{var y=l[f](m),_=y.value}catch(b){return void d(b)}y.done?c(_):Promise.resolve(_).then(h,p)}function t$1(l){return function(){var c=this,d=arguments;return new Promise((function(h,p){var f=l.apply(c,d);function a2(l){e$1(f,h,p,a2,l2,"next",l)}function l2(l){e$1(f,h,p,a2,l2,"throw",l)}a2(void 0)}))}}function r$2(){return r$2=Object.assign?Object.assign.bind():function(l){for(var c=1;c<arguments.length;c++){var d=arguments[c];for(var h in d)({}).hasOwnProperty.call(d,h)&&(l[h]=d[h])}return l},r$2.apply(null,arguments)}function i$2(l,c){if(null==l)return{};var d={};for(var h in l)if({}.hasOwnProperty.call(l,h)){if(-1!==c.indexOf(h))continue;d[h]=l[h]}return d}var uh,hh,fh=["type"],yh=Object.defineProperty,a$1=(l,c,d)=>{return f=d,(p="symbol"!=typeof c?c+"":c)in(h=l)?yh(h,p,{enumerable:!0,configurable:!0,writable:!0,value:f}):h[p]=f;var h,p,f},bh=Object.defineProperty,u=(l,c,d)=>{return f=d,(p="symbol"!=typeof c?c+"":c)in(h=l)?bh(h,p,{enumerable:!0,configurable:!0,writable:!0,value:f}):h[p]=f;var h,p,f},wh=((hh=wh||{})[hh.Document=0]="Document",hh[hh.DocumentType=1]="DocumentType",hh[hh.Element=2]="Element",hh[hh.Text=3]="Text",hh[hh.CDATA=4]="CDATA",hh[hh.Comment=5]="Comment",hh),Sh={Node:["childNodes","parentNode","parentElement","textContent"],ShadowRoot:["host","styleSheets"],Element:["shadowRoot","querySelector","querySelectorAll"],MutationObserver:[]},xh={Node:["contains","getRootNode"],ShadowRoot:["getSelection"],Element:[],MutationObserver:["constructor"]},kh={};function v(l){if(kh[l])return kh[l];var c,d,h,p=(c=l,((h=null==globalThis||null==(d=globalThis.Zone)||null==d.__symbol__?void 0:d.__symbol__(c))&&globalThis[h]?globalThis[h]:void 0)||globalThis[l]),f=p.prototype,m=l in Sh?Sh[l]:void 0,y=Boolean(m&&m.every((l=>{var c,d;return Boolean(null==(d=null==(c=Object.getOwnPropertyDescriptor(f,l))?void 0:c.get)?void 0:d.toString().includes("[native code]"))}))),_=l in xh?xh[l]:void 0,b=Boolean(_&&_.every((l=>{var c;return"function"==typeof f[l]&&(null==(c=f[l])?void 0:c.toString().includes("[native code]"))})));if(y&&b)return kh[l]=p.prototype,p.prototype;try{var w=document.createElement("iframe");document.body.appendChild(w);var E=w.contentWindow;if(!E)return p.prototype;var M=E[l].prototype;return document.body.removeChild(w),M?kh[l]=M:p.prototype}catch(c){return p.prototype}}var Ch={};function g(l,c,d){var h,p=l+"."+String(d);if(Ch[p])return Ch[p].call(c);var f=v(l),m=null==(h=Object.getOwnPropertyDescriptor(f,d))?void 0:h.get;return m?(Ch[p]=m,m.call(c)):c[d]}var y_childNodes=function(l){return g("Node",l,"childNodes")},y_parentNode=function(l){return g("Node",l,"parentNode")},y_parentElement=function(l){return g("Node",l,"parentElement")},y_textContent=function(l){return g("Node",l,"textContent")},y_host=function(l){return l&&"host"in l?g("ShadowRoot",l,"host"):null},y_shadowRoot=function(l){return l&&"shadowRoot"in l?g("Element",l,"shadowRoot"):null};function b2(l){return l.nodeType===l.ELEMENT_NODE}function S(l){var c=l&&"host"in l&&"mode"in l&&y_host(l)||null;return Boolean(c&&"shadowRoot"in c&&y_shadowRoot(c)===l)}function w2(l){return"[object ShadowRoot]"===Object.prototype.toString.call(l)}function C(l){try{var c=l.rules||l.cssRules;return c?((d=Array.from(c,(c=>I(c,l.href))).join("")).includes(" background-clip: text;")&&!d.includes(" -webkit-background-clip: text;")&&(d=d.replace(/\sbackground-clip:\s*text;/g," -webkit-background-clip: text; background-clip: text;")),d):null}catch(h){return null}var d}function I(l,c){if("styleSheet"in l){var d;try{d=C(l.styleSheet)||function(l){var{cssText:c}=l;if(c.split('"').length<3)return c;var d=["@import","url("+JSON.stringify(l.href)+")"];return""===l.layerName?d.push("layer"):l.layerName&&d.push("layer("+l.layerName+")"),l.supportsText&&d.push("supports("+l.supportsText+")"),l.media.length&&d.push(l.media.mediaText),d.join(" ")+";"}(l)}catch(f){d=l.cssText}return l.styleSheet.href?O(d,l.styleSheet.href):d}var h,p=l.cssText;return function(l){return"selectorText"in l}(l)&&l.selectorText.includes(":")&&(h=/(\[(?:[\w-]+)[^\\])(:(?:[\w-]+)\])/gm,p=p.replace(h,"$1\\$2")),c?O(p,c):p}function k(l,c){return Array.from(l.styleSheets).find((l=>l.href===c))}let Eh=class{constructor(){u(this,"idNodeMap",new Map),u(this,"nodeMetaMap",new WeakMap)}getId(l){var c;if(!l)return-1;var d=null==(c=this.getMeta(l))?void 0:c.id;return null!=d?d:-1}getNode(l){return this.idNodeMap.get(l)||null}getIds(){return Array.from(this.idNodeMap.keys())}getMeta(l){return this.nodeMetaMap.get(l)||null}removeNodeFromMap(l){var c=this.getId(l);this.idNodeMap.delete(c),l.childNodes&&l.childNodes.forEach((l=>this.removeNodeFromMap(l)))}has(l){return this.idNodeMap.has(l)}hasNode(l){return this.nodeMetaMap.has(l)}add(l,c){var d=c.id;this.idNodeMap.set(d,l),this.nodeMetaMap.set(l,c)}replace(l,c){var d=this.getNode(l);if(d){var h=this.nodeMetaMap.get(d);h&&this.nodeMetaMap.set(c,h)}this.idNodeMap.set(l,c)}reset(){this.idNodeMap=new Map,this.nodeMetaMap=new WeakMap}};function x(l){var{element:c,maskInputOptions:d,tagName:h,type:p,value:f,maskInputFn:m}=l,y=f||"",_=p&&T(p);return(d[h.toLowerCase()]||_&&d[_])&&(y=m?m(y,c):"*".repeat(y.length)),y}function T(l){return l.toLowerCase()}var Ih="__rrweb_original__";function R(l){var c=l.type;return l.hasAttribute("data-rr-is-password")?"password":c?T(c):null}function A(l,c){var d,h;try{h=new URL(l,null!=c?c:window.location.href)}catch(f){return null}var p=h.pathname.match(/\.([0-9a-z]+)(?:$)/i);return null!==(d=null==p?void 0:p[1])&&void 0!==d?d:null}var Th=/url\((?:(')([^']*)'|(")(.*?)"|([^)]*))\)/gm,Rh=/^(?:[a-z+]+:)?\/\//i,Ah=/^www\..*/i,Mh=/^(data:)([^,]*),(.*)/i;function O(l,c){return(l||"").replace(Th,((l,d,h,p,f,m)=>{var y,_=h||f||m,b=d||p||"";if(!_)return l;if(Rh.test(_)||Ah.test(_))return"url("+b+_+b+")";if(Mh.test(_))return"url("+b+_+b+")";if("/"===_[0])return"url("+b+(((y=c).indexOf("//")>-1?y.split("/").slice(0,3).join("/"):y.split("/")[0]).split("?")[0]+_)+b+")";var w=c.split("/"),E=_.split("/");for(var M of(w.pop(),E))"."!==M&&(".."===M?w.pop():w.push(M));return"url("+b+w.join("/")+b+")"}))}var Ph,jh,Dh=1,$h=new RegExp("[^a-z0-9-_:]");function W(){return Dh++}var Bh=/^[^ \t\n\r\u000c]+/,zh=/^[, \t\n\r\u000c]+/,Vh=new WeakMap;function j2(l,c){return c&&""!==c.trim()?Y$1(l,c):c}function G(l){return Boolean("svg"===l.tagName||l.ownerSVGElement)}function Y$1(l,c){var d=Vh.get(l);if(d||(d=l.createElement("a"),Vh.set(l,d)),c){if(c.startsWith("blob:")||c.startsWith("data:"))return c}else c="";return d.setAttribute("href",c),d.href}function X(l,c,d,h){return h?"src"===d||"href"===d&&("use"!==c||"#"!==h[0])||"xlink:href"===d&&"#"!==h[0]?j2(l,h):"background"!==d||"table"!==c&&"td"!==c&&"th"!==c?"srcset"===d?function(l,c){if(""===c.trim())return c;var d=0;function i3(l){var h,p=l.exec(c.substring(d));return p?(h=p[0],d+=h.length,h):""}for(var h=[];i3(zh),!(d>=c.length);){var p=i3(Bh);if(","===p.slice(-1))p=j2(l,p.substring(0,p.length-1)),h.push(p);else{var f="";p=j2(l,p);for(var m=!1;;){var y=c.charAt(d);if(""===y){h.push((p+f).trim());break}if(m)")"===y&&(m=!1);else{if(","===y){d+=1,h.push((p+f).trim());break}"("===y&&(m=!0)}f+=y,d+=1}}}return h.join(", ")}(l,h):"style"===d?O(h,Y$1(l)):"object"===c&&"data"===d?j2(l,h):h:j2(l,h):h}function K2(l,c,d){return("video"===l||"audio"===l)&&"autoplay"===c}function J(l,c,d){if(!l)return!1;if(l.nodeType!==l.ELEMENT_NODE)return!!d&&J(y_parentNode(l),c,d);for(var h=l.classList.length;h--;){var p=l.classList[h];if(c.test(p))return!0}return!!d&&J(y_parentNode(l),c,d)}function Q(l,c,d,h){var p;if(b2(l)){if(!y_childNodes(p=l).length)return!1}else{if(null===y_parentElement(l))return!1;p=y_parentElement(l)}try{if("string"==typeof c){if(h){if(p.closest("."+c))return!0}else if(p.classList.contains(c))return!0}else if(J(p,c,h))return!0;if(d)if(h){if(p.closest(d))return!0}else if(p.matches(d))return!0}catch(f){}return!1}function te(l){return null==l?"":l.toLowerCase()}function re(l,c){var{doc:d,mirror:h,blockClass:p,blockSelector:f,maskTextClass:m,maskTextSelector:y,skipChild:_=!1,inlineStylesheet:b=!0,maskInputOptions:w={},maskTextFn:E,maskInputFn:M,slimDOMOptions:N,dataURLOptions:P={},inlineImages:L=!1,recordCanvas:j=!1,onSerialize:D,onIframeLoad:F,iframeLoadTimeout:U=5e3,onStylesheetLoad:B,stylesheetLoadTimeout:H=5e3,keepIframeSrcFn:z=()=>!1,newlyAddedElement:q=!1}=c,{needsMask:V}=c,{preserveWhiteSpace:Z=!0}=c;V||(V=Q(l,m,y,void 0===V));var K,Y=function(l,c){var{doc:d,mirror:h,blockClass:p,blockSelector:f,needsMask:m,inlineStylesheet:y,maskInputOptions:_={},maskTextFn:b,maskInputFn:w,dataURLOptions:E={},inlineImages:M,recordCanvas:N,keepIframeSrcFn:P,newlyAddedElement:L=!1}=c,j=function(l,c){if(c.hasNode(l)){var d=c.getId(l);return 1===d?void 0:d}}(d,h);switch(l.nodeType){case l.DOCUMENT_NODE:return"CSS1Compat"!==l.compatMode?{type:wh.Document,childNodes:[],compatMode:l.compatMode}:{type:wh.Document,childNodes:[]};case l.DOCUMENT_TYPE_NODE:return{type:wh.DocumentType,name:l.name,publicId:l.publicId,systemId:l.systemId,rootId:j};case l.ELEMENT_NODE:return function(l,c){for(var d,{doc:h,blockClass:p,blockSelector:f,inlineStylesheet:m,maskInputOptions:y={},maskInputFn:_,dataURLOptions:b={},inlineImages:w,recordCanvas:E,keepIframeSrcFn:M,newlyAddedElement:N=!1,rootId:P}=c,L=function(l,c,d){try{if("string"==typeof c){if(l.classList.contains(c))return!0}else for(var h=l.classList.length;h--;){var p=l.classList[h];if(c.test(p))return!0}if(d)return l.matches(d)}catch(f){}return!1}(l,p,f),j=function(l){if(l instanceof HTMLFormElement)return"form";var c=T(l.tagName);return $h.test(c)?"div":c}(l),D={},F=l.attributes.length,U=0;U<F;U++){var B=l.attributes[U];K2(j,B.name,B.value)||(D[B.name]=X(h,j,T(B.name),B.value))}if("link"===j&&m){var H=null==(V=l)?void 0:V.href;if(H){var z=k(h,H);!z&&H.includes(".css")&&(z=k(h,window.location.origin+"/"+H.replace(window.location.href,"")));var q=null;z&&(q=C(z)),q&&(delete D.rel,delete D.href,D._cssText=q)}}var V;if("style"===j&&l.sheet&&!(l.innerText||y_textContent(l)||"").trim().length){var Z=C(l.sheet);Z&&(D._cssText=Z)}if("input"===j||"textarea"===j||"select"===j){var K=l.value,Y=l.checked;"radio"!==D.type&&"checkbox"!==D.type&&"submit"!==D.type&&"button"!==D.type&&K?D.value=x({element:l,type:R(l),tagName:j,value:K,maskInputOptions:y,maskInputFn:_}):Y&&(D.checked=Y)}if("option"===j&&(l.selected&&!y.select?D.selected=!0:delete D.selected),"dialog"===j&&l.open)try{D.rr_open_mode=l.matches("dialog:modal")?"modal":"non-modal"}catch(V){D.rr_open_mode="modal",D.ph_rr_could_not_detect_modal=!0}if("canvas"===j&&E)if("2d"===l.__context)(function(l){var c=l.getContext("2d");if(!c)return!0;for(var d=0;d<l.width;d+=50)for(var h=0;h<l.height;h+=50){var p=c.getImageData,f=Ih in p?p[Ih]:p;if(new Uint32Array(f.call(c,d,h,Math.min(50,l.width-d),Math.min(50,l.height-h)).data.buffer).some((l=>0!==l)))return!1}return!0})(l)||(D.rr_dataURL=l.toDataURL(b.type,b.quality));else if(!("__context"in l)){var ee=l.toDataURL(b.type,b.quality),ne=h.createElement("canvas");ne.width=l.width,ne.height=l.height,ee!==ne.toDataURL(b.type,b.quality)&&(D.rr_dataURL=ee)}if("img"===j&&w){Ph||(Ph=h.createElement("canvas"),jh=Ph.getContext("2d"));var se=l,ie=se.currentSrc||se.getAttribute("src")||"<unknown-src>",oe=se.crossOrigin,U2=()=>{se.removeEventListener("load",U2);try{Ph.width=se.naturalWidth,Ph.height=se.naturalHeight,jh.drawImage(se,0,0),D.rr_dataURL=Ph.toDataURL(b.type,b.quality)}catch(V){if("anonymous"!==se.crossOrigin)return se.crossOrigin="anonymous",void(se.complete&&0!==se.naturalWidth?U2():se.addEventListener("load",U2));console.warn("Cannot inline img src="+ie+"! Error: "+V)}"anonymous"===se.crossOrigin&&(oe?D.crossOrigin=oe:se.removeAttribute("crossorigin"))};se.complete&&0!==se.naturalWidth?U2():se.addEventListener("load",U2)}if("audio"===j||"video"===j){var le=D;le.rr_mediaState=l.paused?"paused":"played",le.rr_mediaCurrentTime=l.currentTime,le.rr_mediaPlaybackRate=l.playbackRate,le.rr_mediaMuted=l.muted,le.rr_mediaLoop=l.loop,le.rr_mediaVolume=l.volume}if(N||(l.scrollLeft&&(D.rr_scrollLeft=l.scrollLeft),l.scrollTop&&(D.rr_scrollTop=l.scrollTop)),L){var{width:ce,height:pe}=l.getBoundingClientRect();D={class:D.class,rr_width:ce+"px",rr_height:pe+"px"}}"iframe"!==j||M(D.src)||(l.contentDocument||(D.rr_src=D.src),delete D.src);try{customElements.get(j)&&(d=!0)}catch(V){}return{type:wh.Element,tagName:j,attributes:D,childNodes:[],isSVG:G(l)||void 0,needBlock:L,rootId:P,isCustom:d}}(l,{doc:d,blockClass:p,blockSelector:f,inlineStylesheet:y,maskInputOptions:_,maskInputFn:w,dataURLOptions:E,inlineImages:M,recordCanvas:N,keepIframeSrcFn:P,newlyAddedElement:L,rootId:j});case l.TEXT_NODE:return function(l,c){var d,{needsMask:h,maskTextFn:p,rootId:f}=c,m=y_parentNode(l),y=m&&m.tagName,_=y_textContent(l),b="STYLE"===y||void 0,w="SCRIPT"===y||void 0;if(b&&_){try{l.nextSibling||l.previousSibling||(null==(d=m.sheet)?void 0:d.cssRules)&&(_=C(m.sheet))}catch(E){console.warn("Cannot get CSS styles from text's parentNode. Error: "+E,l)}_=O(_,Y$1(c.doc))}return w&&(_="SCRIPT_PLACEHOLDER"),!b&&!w&&_&&h&&(_=p?p(_,y_parentElement(l)):_.replace(/[\S]/g,"*")),{type:wh.Text,textContent:_||"",isStyle:b,rootId:f}}(l,{doc:d,needsMask:m,maskTextFn:b,rootId:j});case l.CDATA_SECTION_NODE:return{type:wh.CDATA,textContent:"",rootId:j};case l.COMMENT_NODE:return{type:wh.Comment,textContent:y_textContent(l)||"",rootId:j};default:return!1}}(l,{doc:d,mirror:h,blockClass:p,blockSelector:f,needsMask:V,inlineStylesheet:b,maskInputOptions:w,maskTextFn:E,maskInputFn:M,dataURLOptions:P,inlineImages:L,recordCanvas:j,keepIframeSrcFn:z,newlyAddedElement:q});if(!Y)return console.warn(l,"not serialized"),null;K=h.hasNode(l)?h.getId(l):!function(l,c){if(c.comment&&l.type===wh.Comment)return!0;if(l.type===wh.Element){if(c.script&&("script"===l.tagName||"link"===l.tagName&&("preload"===l.attributes.rel||"modulepreload"===l.attributes.rel)&&"script"===l.attributes.as||"link"===l.tagName&&"prefetch"===l.attributes.rel&&"string"==typeof l.attributes.href&&"js"===A(l.attributes.href)))return!0;if(c.headFavicon&&("link"===l.tagName&&"shortcut icon"===l.attributes.rel||"meta"===l.tagName&&(te(l.attributes.name).match(/^msapplication-tile(image|color)$/)||"application-name"===te(l.attributes.name)||"icon"===te(l.attributes.rel)||"apple-touch-icon"===te(l.attributes.rel)||"shortcut icon"===te(l.attributes.rel))))return!0;if("meta"===l.tagName){if(c.headMetaDescKeywords&&te(l.attributes.name).match(/^description|keywords$/))return!0;if(c.headMetaSocial&&(te(l.attributes.property).match(/^(og|twitter|fb):/)||te(l.attributes.name).match(/^(og|twitter):/)||"pinterest"===te(l.attributes.name)))return!0;if(c.headMetaRobots&&("robots"===te(l.attributes.name)||"googlebot"===te(l.attributes.name)||"bingbot"===te(l.attributes.name)))return!0;if(c.headMetaHttpEquiv&&void 0!==l.attributes["http-equiv"])return!0;if(c.headMetaAuthorship&&("author"===te(l.attributes.name)||"generator"===te(l.attributes.name)||"framework"===te(l.attributes.name)||"publisher"===te(l.attributes.name)||"progid"===te(l.attributes.name)||te(l.attributes.property).match(/^article:/)||te(l.attributes.property).match(/^product:/)))return!0;if(c.headMetaVerification&&("google-site-verification"===te(l.attributes.name)||"yandex-verification"===te(l.attributes.name)||"csrf-token"===te(l.attributes.name)||"p:domain_verify"===te(l.attributes.name)||"verify-v1"===te(l.attributes.name)||"verification"===te(l.attributes.name)||"shopify-checkout-api-token"===te(l.attributes.name)))return!0}}return!1}(Y,N)&&(Z||Y.type!==wh.Text||Y.isStyle||Y.textContent.replace(/^\s+|\s+$/gm,"").length)?W():-2;var ee=Object.assign(Y,{id:K});if(h.add(l,ee),-2===K)return null;D&&D(l);var ne=!_;if(ee.type===wh.Element){ne=ne&&!ee.needBlock,delete ee.needBlock;var se=y_shadowRoot(l);se&&w2(se)&&(ee.isShadowHost=!0)}if((ee.type===wh.Document||ee.type===wh.Element)&&ne){N.headWhitespace&&ee.type===wh.Element&&"head"===ee.tagName&&(Z=!1);var ie={doc:d,mirror:h,blockClass:p,blockSelector:f,needsMask:V,maskTextClass:m,maskTextSelector:y,skipChild:_,inlineStylesheet:b,maskInputOptions:w,maskTextFn:E,maskInputFn:M,slimDOMOptions:N,dataURLOptions:P,inlineImages:L,recordCanvas:j,preserveWhiteSpace:Z,onSerialize:D,onIframeLoad:F,iframeLoadTimeout:U,onStylesheetLoad:B,stylesheetLoadTimeout:H,keepIframeSrcFn:z};if(ee.type===wh.Element&&"textarea"===ee.tagName&&void 0!==ee.attributes.value);else for(var oe of Array.from(y_childNodes(l))){var le=re(oe,ie);le&&ee.childNodes.push(le)}var ce=null;if(b2(l)&&(ce=y_shadowRoot(l)))for(var pe of Array.from(y_childNodes(ce))){var fe=re(pe,ie);fe&&(w2(ce)&&(fe.isShadow=!0),ee.childNodes.push(fe))}}var ge=y_parentNode(l);return ge&&S(ge)&&w2(ge)&&(ee.isShadow=!0),ee.type===wh.Element&&"iframe"===ee.tagName&&function(l,c,d){var h=l.contentWindow;if(h){var p,f=!1;try{p=h.document.readyState}catch(_){return}if("complete"===p){var m="about:blank";if(h.location.href!==m||l.src===m||""===l.src)return setTimeout(c,0),l.addEventListener("load",c);l.addEventListener("load",c)}else{var y=setTimeout((()=>{f||(c(),f=!0)}),d);l.addEventListener("load",(()=>{clearTimeout(y),f=!0,c()}))}}}(l,(()=>{var c=l.contentDocument;if(c&&F){var d=re(c,{doc:c,mirror:h,blockClass:p,blockSelector:f,needsMask:V,maskTextClass:m,maskTextSelector:y,skipChild:!1,inlineStylesheet:b,maskInputOptions:w,maskTextFn:E,maskInputFn:M,slimDOMOptions:N,dataURLOptions:P,inlineImages:L,recordCanvas:j,preserveWhiteSpace:Z,onSerialize:D,onIframeLoad:F,iframeLoadTimeout:U,onStylesheetLoad:B,stylesheetLoadTimeout:H,keepIframeSrcFn:z});d&&F(l,d)}}),U),ee.type===wh.Element&&"link"===ee.tagName&&"string"==typeof ee.attributes.rel&&("stylesheet"===ee.attributes.rel||"preload"===ee.attributes.rel&&"string"==typeof ee.attributes.href&&"css"===A(ee.attributes.href))&&function(l,c,d){var h,p=!1;try{h=l.sheet}catch(m){return}if(!h){var f=setTimeout((()=>{p||(c(),p=!0)}),d);l.addEventListener("load",(()=>{clearTimeout(f),p=!0,c()}))}}(l,(()=>{if(B){var c=re(l,{doc:d,mirror:h,blockClass:p,blockSelector:f,needsMask:V,maskTextClass:m,maskTextSelector:y,skipChild:!1,inlineStylesheet:b,maskInputOptions:w,maskTextFn:E,maskInputFn:M,slimDOMOptions:N,dataURLOptions:P,inlineImages:L,recordCanvas:j,preserveWhiteSpace:Z,onSerialize:D,onIframeLoad:F,iframeLoadTimeout:U,onStylesheetLoad:B,stylesheetLoadTimeout:H,keepIframeSrcFn:z});c&&B(l,c)}}),H),ee}let Zh=class e{constructor(){__publicField2(this,"parentElement",null),__publicField2(this,"parentNode",null),__publicField2(this,"ownerDocument"),__publicField2(this,"firstChild",null),__publicField2(this,"lastChild",null),__publicField2(this,"previousSibling",null),__publicField2(this,"nextSibling",null),__publicField2(this,"ELEMENT_NODE",1),__publicField2(this,"TEXT_NODE",3),__publicField2(this,"nodeType"),__publicField2(this,"nodeName"),__publicField2(this,"RRNodeType")}get childNodes(){for(var l=[],c=this.firstChild;c;)l.push(c),c=c.nextSibling;return l}contains(l){if(!(l instanceof e))return!1;if(l.ownerDocument!==this.ownerDocument)return!1;if(l===this)return!0;for(;l.parentNode;){if(l.parentNode===this)return!0;l=l.parentNode}return!1}appendChild(l){throw new Error("RRDomException: Failed to execute 'appendChild' on 'RRNode': This RRNode type does not support this method.")}insertBefore(l,c){throw new Error("RRDomException: Failed to execute 'insertBefore' on 'RRNode': This RRNode type does not support this method.")}removeChild(l){throw new Error("RRDomException: Failed to execute 'removeChild' on 'RRNode': This RRNode type does not support this method.")}toString(){return"RRNode"}};var Gh={Node:["childNodes","parentNode","parentElement","textContent"],ShadowRoot:["host","styleSheets"],Element:["shadowRoot","querySelector","querySelectorAll"],MutationObserver:[]},Jh={Node:["contains","getRootNode"],ShadowRoot:["getSelection"],Element:[],MutationObserver:["constructor"]},Qh={};function ae(l){if(Qh[l])return Qh[l];var c,d,h,p=(c=l,((h=null==globalThis||null==(d=globalThis.Zone)||null==d.__symbol__?void 0:d.__symbol__(c))&&globalThis[h]?globalThis[h]:void 0)||globalThis[l]),f=p.prototype,m=l in Gh?Gh[l]:void 0,y=Boolean(m&&m.every((l=>{var c,d;return Boolean(null==(d=null==(c=Object.getOwnPropertyDescriptor(f,l))?void 0:c.get)?void 0:d.toString().includes("[native code]"))}))),_=l in Jh?Jh[l]:void 0,b=Boolean(_&&_.every((l=>{var c;return"function"==typeof f[l]&&(null==(c=f[l])?void 0:c.toString().includes("[native code]"))})));if(y&&b)return Qh[l]=p.prototype,p.prototype;try{var w=document.createElement("iframe");document.body.appendChild(w);var E=w.contentWindow;if(!E)return p.prototype;var M=E[l].prototype;return document.body.removeChild(w),M?Qh[l]=M:f}catch(c){return f}}var Xh={};function ue(l,c,d){var h,p=l+"."+String(d);if(Xh[p])return Xh[p].call(c);var f=ae(l),m=null==(h=Object.getOwnPropertyDescriptor(f,d))?void 0:h.get;return m?(Xh[p]=m,m.call(c)):c[d]}var ep={};function de(l,c,d){var h=l+"."+String(d);if(ep[h])return ep[h].bind(c);var p=ae(l)[d];return"function"!=typeof p?c[d]:(ep[h]=p,p.bind(c))}function he(){return ae("MutationObserver").constructor}var pe_childNodes=function(l){return ue("Node",l,"childNodes")},pe_parentNode=function(l){return ue("Node",l,"parentNode")},pe_parentElement=function(l){return ue("Node",l,"parentElement")},pe_textContent=function(l){return ue("Node",l,"textContent")},pe_contains=function(l,c){return de("Node",l,"contains")(c)},pe_getRootNode=function(l){return de("Node",l,"getRootNode")()},pe_host=function(l){return l&&"host"in l?ue("ShadowRoot",l,"host"):null},pe_shadowRoot=function(l){return l&&"shadowRoot"in l?ue("Element",l,"shadowRoot"):null};function ve(l,c,d){void 0===d&&(d=document);var h={capture:!0,passive:!0};return d.addEventListener(l,c,h),()=>d.removeEventListener(l,c,h)}var tp="Please stop import mirror directly. Instead of that,\r\nnow you can use replayer.getMirror() to access the mirror instance of a replayer,\r\nor you can use record.mirror to access the mirror instance during recording.",rp={map:{},getId:()=>(console.error(tp),-1),getNode:()=>(console.error(tp),null),removeNodeFromMap(){console.error(tp)},has:()=>(console.error(tp),!1),reset(){console.error(tp)}};function _e(l,c,d){void 0===d&&(d={});var h=null,p=0;return function(){for(var f=arguments.length,m=new Array(f),y=0;y<f;y++)m[y]=arguments[y];var _=Date.now();p||!1!==d.leading||(p=_);var b=c-(_-p),w=this;b<=0||b>c?(h&&(clearTimeout(h),h=null),p=_,l.apply(w,m)):h||!1===d.trailing||(h=setTimeout((()=>{p=!1===d.leading?0:Date.now(),h=null,l.apply(w,m)}),b))}}function me(l,c,d,h,p){void 0===p&&(p=window);var f=p.Object.getOwnPropertyDescriptor(l,c);return p.Object.defineProperty(l,c,h?d:{set(l){setTimeout((()=>{d.set.call(this,l)}),0),f&&f.set&&f.set.call(this,l)}}),()=>me(l,c,f||{},!0)}function ye(l,c,d){try{if(!(c in l))return()=>{};var h=l[c],p=d(h);return"function"==typeof p&&(p.prototype=p.prototype||{},Object.defineProperties(p,{__rrweb_original__:{enumerable:!1,value:h}})),l[c]=p,()=>{l[c]=h}}catch(f){return()=>{}}}"undefined"!=typeof window&&window.Proxy&&window.Reflect&&(rp=new Proxy(rp,{get:(l,c,d)=>("map"===c&&console.error(tp),Reflect.get(l,c,d))}));var hp=Date.now;function Se(l){var c,d,h,p,f=l.document;return{left:f.scrollingElement?f.scrollingElement.scrollLeft:void 0!==l.pageXOffset?l.pageXOffset:f.documentElement.scrollLeft||(null==f?void 0:f.body)&&(null==(c=pe_parentElement(f.body))?void 0:c.scrollLeft)||(null==(d=null==f?void 0:f.body)?void 0:d.scrollLeft)||0,top:f.scrollingElement?f.scrollingElement.scrollTop:void 0!==l.pageYOffset?l.pageYOffset:(null==f?void 0:f.documentElement.scrollTop)||(null==f?void 0:f.body)&&(null==(h=pe_parentElement(f.body))?void 0:h.scrollTop)||(null==(p=null==f?void 0:f.body)?void 0:p.scrollTop)||0}}function we(){return window.innerHeight||document.documentElement&&document.documentElement.clientHeight||document.body&&document.body.clientHeight}function Ce(){return window.innerWidth||document.documentElement&&document.documentElement.clientWidth||document.body&&document.body.clientWidth}function Ie(l){return l?l.nodeType===l.ELEMENT_NODE?l:pe_parentElement(l):null}function ke(l,c,d,h){if(!l)return!1;var p=Ie(l);if(!p)return!1;try{if("string"==typeof c){if(p.classList.contains(c))return!0;if(h&&null!==p.closest("."+c))return!0}else if(J(p,c,h))return!0}catch(f){}if(d){if(p.matches(d))return!0;if(h&&null!==p.closest(d))return!0}return!1}function Ee(l,c,d){return!("TITLE"!==l.tagName||!d.headTitleMutations)||-2===c.getId(l)}function xe(l,c){if(S(l))return!1;var d=c.getId(l);if(!c.has(d))return!0;var h=pe_parentNode(l);return(!h||h.nodeType!==l.DOCUMENT_NODE)&&(!h||xe(h,c))}function Te(l){return Boolean(l.changedTouches)}function Me(l,c){return Boolean("IFRAME"===l.nodeName&&c.getMeta(l))}function Re(l,c){return Boolean("LINK"===l.nodeName&&l.nodeType===l.ELEMENT_NODE&&l.getAttribute&&"stylesheet"===l.getAttribute("rel")&&c.getMeta(l))}function Ae(l){return!!l&&(l instanceof Zh&&"shadowRoot"in l?Boolean(l.shadowRoot):Boolean(pe_shadowRoot(l)))}/[1-9][0-9]{12}/.test(Date.now().toString())||(hp=()=>(new Date).getTime());let pp=class{constructor(){a$1(this,"id",1),a$1(this,"styleIDMap",new WeakMap),a$1(this,"idStyleMap",new Map)}getId(l){var c;return null!==(c=this.styleIDMap.get(l))&&void 0!==c?c:-1}has(l){return this.styleIDMap.has(l)}add(l,c){return this.has(l)?this.getId(l):(d=void 0===c?this.id++:c,this.styleIDMap.set(l,d),this.idStyleMap.set(d,l),d);var d}getStyle(l){return this.idStyleMap.get(l)||null}reset(){this.styleIDMap=new WeakMap,this.idStyleMap=new Map,this.id=1}generateId(){return this.id++}};function Pe(l){var c,d=null;return"getRootNode"in l&&(null==(c=pe_getRootNode(l))?void 0:c.nodeType)===Node.DOCUMENT_FRAGMENT_NODE&&pe_host(pe_getRootNode(l))&&(d=pe_host(pe_getRootNode(l))),d}function Le(l){var c=l.ownerDocument;return!!c&&(pe_contains(c,l)||function(l){var c=l.ownerDocument;if(!c)return!1;var d=function(l){for(var c,d=l;c=Pe(d);)d=c;return d}(l);return pe_contains(c,d)}(l))}var gp=(l=>(l[l.DomContentLoaded=0]="DomContentLoaded",l[l.Load=1]="Load",l[l.FullSnapshot=2]="FullSnapshot",l[l.IncrementalSnapshot=3]="IncrementalSnapshot",l[l.Meta=4]="Meta",l[l.Custom=5]="Custom",l[l.Plugin=6]="Plugin",l))(gp||{}),vp=(l=>(l[l.Mutation=0]="Mutation",l[l.MouseMove=1]="MouseMove",l[l.MouseInteraction=2]="MouseInteraction",l[l.Scroll=3]="Scroll",l[l.ViewportResize=4]="ViewportResize",l[l.Input=5]="Input",l[l.TouchMove=6]="TouchMove",l[l.MediaInteraction=7]="MediaInteraction",l[l.StyleSheetRule=8]="StyleSheetRule",l[l.CanvasMutation=9]="CanvasMutation",l[l.Font=10]="Font",l[l.Log=11]="Log",l[l.Drag=12]="Drag",l[l.StyleDeclaration=13]="StyleDeclaration",l[l.Selection=14]="Selection",l[l.AdoptedStyleSheet=15]="AdoptedStyleSheet",l[l.CustomElement=16]="CustomElement",l))(vp||{}),bp=(l=>(l[l.MouseUp=0]="MouseUp",l[l.MouseDown=1]="MouseDown",l[l.Click=2]="Click",l[l.ContextMenu=3]="ContextMenu",l[l.DblClick=4]="DblClick",l[l.Focus=5]="Focus",l[l.Blur=6]="Blur",l[l.TouchStart=7]="TouchStart",l[l.TouchMove_Departed=8]="TouchMove_Departed",l[l.TouchEnd=9]="TouchEnd",l[l.TouchCancel=10]="TouchCancel",l))(bp||{}),wp=(l=>(l[l.Mouse=0]="Mouse",l[l.Pen=1]="Pen",l[l.Touch=2]="Touch",l))(wp||{}),Sp=(l=>(l[l["2D"]=0]="2D",l[l.WebGL=1]="WebGL",l[l.WebGL2=2]="WebGL2",l))(Sp||{}),xp=(l=>(l[l.Play=0]="Play",l[l.Pause=1]="Pause",l[l.Seeked=2]="Seeked",l[l.VolumeChange=3]="VolumeChange",l[l.RateChange=4]="RateChange",l))(xp||{});function $e(l){return"__ln"in l}class We{constructor(){a$1(this,"length",0),a$1(this,"head",null),a$1(this,"tail",null)}get(l){if(l>=this.length)throw new Error("Position outside of list range");for(var c=this.head,d=0;d<l;d++)c=(null==c?void 0:c.next)||null;return c}addNode(l){var c={value:l,previous:null,next:null};if(l.__ln=c,l.previousSibling&&$e(l.previousSibling)){var d=l.previousSibling.__ln.next;c.next=d,c.previous=l.previousSibling.__ln,l.previousSibling.__ln.next=c,d&&(d.previous=c)}else if(l.nextSibling&&$e(l.nextSibling)&&l.nextSibling.__ln.previous){var h=l.nextSibling.__ln.previous;c.previous=h,c.next=l.nextSibling.__ln,l.nextSibling.__ln.previous=c,h&&(h.next=c)}else this.head&&(this.head.previous=c),c.next=this.head,this.head=c;null===c.next&&(this.tail=c),this.length++}removeNode(l){var c=l.__ln;this.head&&(c.previous?(c.previous.next=c.next,c.next?c.next.previous=c.previous:this.tail=c.previous):(this.head=c.next,this.head?this.head.previous=null:this.tail=null),l.__ln&&delete l.__ln,this.length--)}}var kp,Ze=(l,c)=>l+"@"+c;class ze{constructor(){a$1(this,"frozen",!1),a$1(this,"locked",!1),a$1(this,"texts",[]),a$1(this,"attributes",[]),a$1(this,"attributeMap",new WeakMap),a$1(this,"removes",[]),a$1(this,"mapRemoves",[]),a$1(this,"movedMap",{}),a$1(this,"addedSet",new Set),a$1(this,"movedSet",new Set),a$1(this,"droppedSet",new Set),a$1(this,"mutationCb"),a$1(this,"blockClass"),a$1(this,"blockSelector"),a$1(this,"maskTextClass"),a$1(this,"maskTextSelector"),a$1(this,"inlineStylesheet"),a$1(this,"maskInputOptions"),a$1(this,"maskTextFn"),a$1(this,"maskInputFn"),a$1(this,"keepIframeSrcFn"),a$1(this,"recordCanvas"),a$1(this,"inlineImages"),a$1(this,"slimDOMOptions"),a$1(this,"dataURLOptions"),a$1(this,"doc"),a$1(this,"mirror"),a$1(this,"iframeManager"),a$1(this,"stylesheetManager"),a$1(this,"shadowDomManager"),a$1(this,"canvasManager"),a$1(this,"processedNodeManager"),a$1(this,"unattachedDoc"),a$1(this,"processMutations",(l=>{l.forEach(this.processMutation),this.emit()})),a$1(this,"emit",(()=>{if(!this.frozen&&!this.locked){for(var l=[],c=new Set,d=new We,i2=l=>{for(var c=l,d=-2;-2===d;)d=(c=c&&c.nextSibling)&&this.mirror.getId(c);return d},n2=h=>{var p=pe_parentNode(h);if(p&&Le(h)&&"TEXTAREA"!==p.tagName){var f=S(p)?this.mirror.getId(Pe(h)):this.mirror.getId(p),m=i2(h);if(-1===f||-1===m)return d.addNode(h);var y=re(h,{doc:this.doc,mirror:this.mirror,blockClass:this.blockClass,blockSelector:this.blockSelector,maskTextClass:this.maskTextClass,maskTextSelector:this.maskTextSelector,skipChild:!0,newlyAddedElement:!0,inlineStylesheet:this.inlineStylesheet,maskInputOptions:this.maskInputOptions,maskTextFn:this.maskTextFn,maskInputFn:this.maskInputFn,slimDOMOptions:this.slimDOMOptions,dataURLOptions:this.dataURLOptions,recordCanvas:this.recordCanvas,inlineImages:this.inlineImages,onSerialize:l=>{Me(l,this.mirror)&&this.iframeManager.addIframe(l),Re(l,this.mirror)&&this.stylesheetManager.trackLinkElement(l),Ae(h)&&this.shadowDomManager.addShadowRoot(pe_shadowRoot(h),this.doc)},onIframeLoad:(l,c)=>{this.iframeManager.attachIframe(l,c),this.shadowDomManager.observeAttachShadow(l)},onStylesheetLoad:(l,c)=>{this.stylesheetManager.attachLinkElement(l,c)}});y&&(l.push({parentId:f,nextId:m,node:y}),c.add(y.id))}};this.mapRemoves.length;)this.mirror.removeNodeFromMap(this.mapRemoves.shift());for(var h of this.movedSet)Ge(this.removes,h,this.mirror)&&!this.movedSet.has(pe_parentNode(h))||n2(h);for(var p of this.addedSet)Ye(this.droppedSet,p)||Ge(this.removes,p,this.mirror)?Ye(this.movedSet,p)?n2(p):this.droppedSet.add(p):n2(p);for(var f=null;d.length;){var m=null;if(f){var y=this.mirror.getId(pe_parentNode(f.value)),_=i2(f.value);-1!==y&&-1!==_&&(m=f)}if(!m)for(var b=d.tail;b;){var w=b;if(b=b.previous,w){var E=this.mirror.getId(pe_parentNode(w.value));if(-1===i2(w.value))continue;if(-1!==E){m=w;break}var M=w.value,N=pe_parentNode(M);if(N&&N.nodeType===Node.DOCUMENT_FRAGMENT_NODE){var P=pe_host(N);if(-1!==this.mirror.getId(P)){m=w;break}}}}if(!m){for(;d.head;)d.removeNode(d.head.value);break}f=m.previous,d.removeNode(m.value),n2(m.value)}var L={texts:this.texts.map((l=>{var c=l.node,d=pe_parentNode(c);return d&&"TEXTAREA"===d.tagName&&this.genTextAreaValueMutation(d),{id:this.mirror.getId(c),value:l.value}})).filter((l=>!c.has(l.id))).filter((l=>this.mirror.has(l.id))),attributes:this.attributes.map((l=>{var{attributes:c}=l;if("string"==typeof c.style){var d=JSON.stringify(l.styleDiff),h=JSON.stringify(l._unchangedStyles);d.length<c.style.length&&(d+h).split("var(").length===c.style.split("var(").length&&(c.style=l.styleDiff)}return{id:this.mirror.getId(l.node),attributes:c}})).filter((l=>!c.has(l.id))).filter((l=>this.mirror.has(l.id))),removes:this.removes,adds:l};(L.texts.length||L.attributes.length||L.removes.length||L.adds.length)&&(this.texts=[],this.attributes=[],this.attributeMap=new WeakMap,this.removes=[],this.addedSet=new Set,this.movedSet=new Set,this.droppedSet=new Set,this.movedMap={},this.mutationCb(L))}})),a$1(this,"genTextAreaValueMutation",(l=>{var c=this.attributeMap.get(l);c||(c={node:l,attributes:{},styleDiff:{},_unchangedStyles:{}},this.attributes.push(c),this.attributeMap.set(l,c)),c.attributes.value=Array.from(pe_childNodes(l),(l=>pe_textContent(l)||"")).join("")})),a$1(this,"processMutation",(l=>{if(!Ee(l.target,this.mirror,this.slimDOMOptions))switch(l.type){case"characterData":var c=pe_textContent(l.target);ke(l.target,this.blockClass,this.blockSelector,!1)||c===l.oldValue||this.texts.push({value:Q(l.target,this.maskTextClass,this.maskTextSelector,!0)&&c?this.maskTextFn?this.maskTextFn(c,Ie(l.target)):c.replace(/[\S]/g,"*"):c,node:l.target});break;case"attributes":var d=l.target,h=l.attributeName,p=l.target.getAttribute(h);if("value"===h){var f=R(d);p=x({element:d,maskInputOptions:this.maskInputOptions,tagName:d.tagName,type:f,value:p,maskInputFn:this.maskInputFn})}if(ke(l.target,this.blockClass,this.blockSelector,!1)||p===l.oldValue)return;var m=this.attributeMap.get(l.target);if("IFRAME"===d.tagName&&"src"===h&&!this.keepIframeSrcFn(p)){if(d.contentDocument)return;h="rr_src"}if(m||(m={node:l.target,attributes:{},styleDiff:{},_unchangedStyles:{}},this.attributes.push(m),this.attributeMap.set(l.target,m)),"type"===h&&"INPUT"===d.tagName&&"password"===(l.oldValue||"").toLowerCase()&&d.setAttribute("data-rr-is-password","true"),!K2(d.tagName,h))if(m.attributes[h]=X(this.doc,T(d.tagName),T(h),p),"style"===h){if(!this.unattachedDoc)try{this.unattachedDoc=document.implementation.createHTMLDocument()}catch(M){this.unattachedDoc=this.doc}var y=this.unattachedDoc.createElement("span");for(var _ of(l.oldValue&&y.setAttribute("style",l.oldValue),Array.from(d.style))){var b=d.style.getPropertyValue(_),w=d.style.getPropertyPriority(_);b!==y.style.getPropertyValue(_)||w!==y.style.getPropertyPriority(_)?m.styleDiff[_]=""===w?b:[b,w]:m._unchangedStyles[_]=[b,w]}for(var E of Array.from(y.style))""===d.style.getPropertyValue(E)&&(m.styleDiff[E]=!1)}else"open"===h&&"DIALOG"===d.tagName&&(d.matches("dialog:modal")?m.attributes.rr_open_mode="modal":m.attributes.rr_open_mode="non-modal");break;case"childList":if(ke(l.target,this.blockClass,this.blockSelector,!0))return;if("TEXTAREA"===l.target.tagName)return void this.genTextAreaValueMutation(l.target);l.addedNodes.forEach((c=>this.genAdds(c,l.target))),l.removedNodes.forEach((c=>{var d,h=this.mirror.getId(c),p=S(l.target)?this.mirror.getId(pe_host(l.target)):this.mirror.getId(l.target);ke(l.target,this.blockClass,this.blockSelector,!1)||Ee(c,this.mirror,this.slimDOMOptions)||(d=c,-1===this.mirror.getId(d))||(this.addedSet.has(c)?(je(this.addedSet,c),this.droppedSet.add(c)):this.addedSet.has(l.target)&&-1===h||xe(l.target,this.mirror)||(this.movedSet.has(c)&&this.movedMap[Ze(h,p)]?je(this.movedSet,c):this.removes.push({parentId:p,id:h,isShadow:!(!S(l.target)||!w2(l.target))||void 0})),this.mapRemoves.push(c))}))}})),a$1(this,"genAdds",((l,c)=>{if(!this.processedNodeManager.inOtherBuffer(l,this)&&!this.addedSet.has(l)&&!this.movedSet.has(l)){if(this.mirror.hasNode(l)){if(Ee(l,this.mirror,this.slimDOMOptions))return;this.movedSet.add(l);var d=null;c&&this.mirror.hasNode(c)&&(d=this.mirror.getId(c)),d&&-1!==d&&(this.movedMap[Ze(this.mirror.getId(l),d)]=!0)}else this.addedSet.add(l),this.droppedSet.delete(l);ke(l,this.blockClass,this.blockSelector,!1)||(pe_childNodes(l).forEach((l=>this.genAdds(l))),Ae(l)&&pe_childNodes(pe_shadowRoot(l)).forEach((c=>{this.processedNodeManager.add(c,this),this.genAdds(c,l)})))}}))}init(l){["mutationCb","blockClass","blockSelector","maskTextClass","maskTextSelector","inlineStylesheet","maskInputOptions","maskTextFn","maskInputFn","keepIframeSrcFn","recordCanvas","inlineImages","slimDOMOptions","dataURLOptions","doc","mirror","iframeManager","stylesheetManager","shadowDomManager","canvasManager","processedNodeManager"].forEach((c=>{this[c]=l[c]}))}freeze(){this.frozen=!0,this.canvasManager.freeze()}unfreeze(){this.frozen=!1,this.canvasManager.unfreeze(),this.emit()}isFrozen(){return this.frozen}lock(){this.locked=!0,this.canvasManager.lock()}unlock(){this.locked=!1,this.canvasManager.unlock(),this.emit()}reset(){this.shadowDomManager.reset(),this.canvasManager.reset()}}function je(l,c){l.delete(c),pe_childNodes(c).forEach((c=>je(l,c)))}function Ge(l,c,d){return 0!==l.length&&function(l,c,d){for(var h,p=pe_parentNode(c),s2=function(){var c=d.getId(p);if(l.some((l=>l.id===c)))return{v:!0};p=pe_parentNode(p)};p;)if(h=s2())return h.v;return!1}(l,c,d)}function Ye(l,c){return 0!==l.size&&Xe(l,c)}function Xe(l,c){var d=pe_parentNode(c);return!!d&&(!!l.has(d)||Xe(l,d))}var Ke=l=>kp?function(){try{return l(...arguments)}catch(c){if(kp&&!0===kp(c))return;throw c}}:l,Cp=[];function Qe(l){try{if("composedPath"in l){var c=l.composedPath();if(c.length)return c[0]}else if("path"in l&&l.path.length)return l.path[0]}catch(d){}return l&&l.target}function et(l,c){var d=new ze;Cp.push(d),d.init(l);var h=new(he())(Ke(d.processMutations.bind(d)));return h.observe(c,{attributes:!0,attributeOldValue:!0,characterData:!0,characterDataOldValue:!0,childList:!0,subtree:!0}),h}function rt(l){var{scrollCb:c,doc:d,mirror:h,blockClass:p,blockSelector:f,sampling:m}=l;return ve("scroll",Ke(_e(Ke((l=>{var m=Qe(l);if(m&&!ke(m,p,f,!0)){var y=h.getId(m);if(m===d&&d.defaultView){var _=Se(d.defaultView);c({id:y,x:_.left,y:_.top})}else c({id:y,x:m.scrollLeft,y:m.scrollTop})}})),m.scroll||100)),d)}var Ip=["INPUT","TEXTAREA","SELECT"],Tp=new WeakMap;function st(l){return function(l,c){if(ut("CSSGroupingRule")&&l.parentRule instanceof CSSGroupingRule||ut("CSSMediaRule")&&l.parentRule instanceof CSSMediaRule||ut("CSSSupportsRule")&&l.parentRule instanceof CSSSupportsRule||ut("CSSConditionRule")&&l.parentRule instanceof CSSConditionRule){var d=Array.from(l.parentRule.cssRules).indexOf(l);c.unshift(d)}else if(l.parentStyleSheet){var h=Array.from(l.parentStyleSheet.cssRules).indexOf(l);c.unshift(h)}return c}(l,[])}function ot(l,c,d){var h,p;return l?(l.ownerNode?h=c.getId(l.ownerNode):p=d.getId(l),{styleId:p,id:h}):{}}function at(l,c){var d,h,p,f,{mirror:m,stylesheetManager:y}=l;f="#document"===c.nodeName?m.getId(c):m.getId(pe_host(c));var _="#document"===c.nodeName?null==(d=c.defaultView)?void 0:d.Document:null==(p=null==(h=c.ownerDocument)?void 0:h.defaultView)?void 0:p.ShadowRoot,b=(null==_?void 0:_.prototype)?Object.getOwnPropertyDescriptor(null==_?void 0:_.prototype,"adoptedStyleSheets"):void 0;return null!==f&&-1!==f&&_&&b?(Object.defineProperty(c,"adoptedStyleSheets",{configurable:b.configurable,enumerable:b.enumerable,get(){var l;return null==(l=b.get)?void 0:l.call(this)},set(l){var c,d=null==(c=b.set)?void 0:c.call(this,l);if(null!==f&&-1!==f)try{y.adoptStyleSheets(l,f)}catch(h){}return d}}),Ke((()=>{Object.defineProperty(c,"adoptedStyleSheets",{configurable:b.configurable,enumerable:b.enumerable,get:b.get,set:b.set})}))):()=>{}}function lt(l,c){void 0===c&&(c={});var d,h=l.doc.defaultView;if(!h)return()=>{};!function(l,c){var{mutationCb:d,mousemoveCb:h,mouseInteractionCb:p,scrollCb:f,viewportResizeCb:m,inputCb:y,mediaInteractionCb:_,styleSheetRuleCb:b,styleDeclarationCb:w,canvasMutationCb:E,fontCb:M,selectionCb:N,customElementCb:P}=l;l.mutationCb=function(){c.mutation&&c.mutation(...arguments),d(...arguments)},l.mousemoveCb=function(){c.mousemove&&c.mousemove(...arguments),h(...arguments)},l.mouseInteractionCb=function(){c.mouseInteraction&&c.mouseInteraction(...arguments),p(...arguments)},l.scrollCb=function(){c.scroll&&c.scroll(...arguments),f(...arguments)},l.viewportResizeCb=function(){c.viewportResize&&c.viewportResize(...arguments),m(...arguments)},l.inputCb=function(){c.input&&c.input(...arguments),y(...arguments)},l.mediaInteractionCb=function(){c.mediaInteaction&&c.mediaInteaction(...arguments),_(...arguments)},l.styleSheetRuleCb=function(){c.styleSheetRule&&c.styleSheetRule(...arguments),b(...arguments)},l.styleDeclarationCb=function(){c.styleDeclaration&&c.styleDeclaration(...arguments),w(...arguments)},l.canvasMutationCb=function(){c.canvasMutation&&c.canvasMutation(...arguments),E(...arguments)},l.fontCb=function(){c.font&&c.font(...arguments),M(...arguments)},l.selectionCb=function(){c.selection&&c.selection(...arguments),N(...arguments)},l.customElementCb=function(){c.customElement&&c.customElement(...arguments),P(...arguments)}}(l,c),l.recordDOM&&(d=et(l,l.doc));var p=function(l){var{mousemoveCb:c,sampling:d,doc:h,mirror:p}=l;if(!1===d.mousemove)return()=>{};var f,m="number"==typeof d.mousemove?d.mousemove:50,y="number"==typeof d.mousemoveCallback?d.mousemoveCallback:500,_=[],b=_e(Ke((l=>{var d=Date.now()-f;c(_.map((l=>(l.timeOffset-=d,l))),l),_=[],f=null})),y),w=Ke(_e(Ke((l=>{var c=Qe(l),{clientX:d,clientY:h}=Te(l)?l.changedTouches[0]:l;f||(f=hp()),_.push({x:d,y:h,id:p.getId(c),timeOffset:hp()-f}),b("undefined"!=typeof DragEvent&&l instanceof DragEvent?vp.Drag:l instanceof MouseEvent?vp.MouseMove:vp.TouchMove)})),m,{trailing:!1})),E=[ve("mousemove",w,h),ve("touchmove",w,h),ve("drag",w,h)];return Ke((()=>{E.forEach((l=>l()))}))}(l),f=function(l){var{mouseInteractionCb:c,doc:d,mirror:h,blockClass:p,blockSelector:f,sampling:m}=l;if(!1===m.mouseInteraction)return()=>{};var y=!0===m.mouseInteraction||void 0===m.mouseInteraction?{}:m.mouseInteraction,_=[],b=null;return Object.keys(bp).filter((l=>Number.isNaN(Number(l))&&!l.endsWith("_Departed")&&!1!==y[l])).forEach((l=>{var m=T(l),y=(l=>d=>{var m=Qe(d);if(!ke(m,p,f,!0)){var y=null,_=l;if("pointerType"in d){switch(d.pointerType){case"mouse":y=wp.Mouse;break;case"touch":y=wp.Touch;break;case"pen":y=wp.Pen}y===wp.Touch?bp[l]===bp.MouseDown?_="TouchStart":bp[l]===bp.MouseUp&&(_="TouchEnd"):wp.Pen}else Te(d)&&(y=wp.Touch);null!==y?(b=y,(_.startsWith("Touch")&&y===wp.Touch||_.startsWith("Mouse")&&y===wp.Mouse)&&(y=null)):bp[l]===bp.Click&&(y=b,b=null);var w=Te(d)?d.changedTouches[0]:d;if(w){var E=h.getId(m),{clientX:M,clientY:N}=w;Ke(c)(r$2({type:bp[_],id:E,x:M,y:N},null!==y&&{pointerType:y}))}}})(l);if(window.PointerEvent)switch(bp[l]){case bp.MouseDown:case bp.MouseUp:m=m.replace("mouse","pointer");break;case bp.TouchStart:case bp.TouchEnd:return}_.push(ve(m,y,d))})),Ke((()=>{_.forEach((l=>l()))}))}(l),m=rt(l),y=function(l,c){var{viewportResizeCb:d}=l,{win:h}=c,p=-1,f=-1;return ve("resize",Ke(_e(Ke((()=>{var l=we(),c=Ce();p===l&&f===c||(d({width:Number(c),height:Number(l)}),p=l,f=c)})),200)),h)}(l,{win:h}),_=function(l){var{inputCb:c,doc:d,mirror:h,blockClass:p,blockSelector:f,ignoreClass:m,ignoreSelector:y,maskInputOptions:_,maskInputFn:b,sampling:w,userTriggeredOnInput:E}=l;function p3(l){var c=Qe(l),h=l.isTrusted,w=c&&c.tagName;if(c&&"OPTION"===w&&(c=pe_parentElement(c)),c&&w&&!(Ip.indexOf(w)<0)&&!ke(c,p,f,!0)&&!(c.classList.contains(m)||y&&c.matches(y))){var M=c.value,N=!1,P=R(c)||"";"radio"===P||"checkbox"===P?N=c.checked:(_[w.toLowerCase()]||_[P])&&(M=x({element:c,maskInputOptions:_,tagName:w,type:P,value:M,maskInputFn:b})),v3(c,E?{text:M,isChecked:N,userTriggered:h}:{text:M,isChecked:N});var L=c.name;"radio"===P&&L&&N&&d.querySelectorAll('input[type="radio"][name="'+L+'"]').forEach((l=>{if(l!==c){var d=l.value;v3(l,E?{text:d,isChecked:!N,userTriggered:!1}:{text:d,isChecked:!N})}}))}}function v3(l,d){var p=Tp.get(l);if(!p||p.text!==d.text||p.isChecked!==d.isChecked){Tp.set(l,d);var f=h.getId(l);Ke(c)(r$2({},d,{id:f}))}}var M=("last"===w.input?["change"]:["input","change"]).map((l=>ve(l,Ke(p3),d))),N=d.defaultView;if(!N)return()=>{M.forEach((l=>l()))};var P=N.Object.getOwnPropertyDescriptor(N.HTMLInputElement.prototype,"value"),L=[[N.HTMLInputElement.prototype,"value"],[N.HTMLInputElement.prototype,"checked"],[N.HTMLSelectElement.prototype,"value"],[N.HTMLTextAreaElement.prototype,"value"],[N.HTMLSelectElement.prototype,"selectedIndex"],[N.HTMLOptionElement.prototype,"selected"]];return P&&P.set&&M.push(...L.map((l=>me(l[0],l[1],{set(){Ke(p3)({target:this,isTrusted:!1})}},!1,N)))),Ke((()=>{M.forEach((l=>l()))}))}(l),b=function(l){var{mediaInteractionCb:c,blockClass:d,blockSelector:h,mirror:p,sampling:f,doc:m}=l,y=Ke((l=>_e(Ke((f=>{var m=Qe(f);if(m&&!ke(m,d,h,!0)){var{currentTime:y,volume:_,muted:b,playbackRate:w,loop:E}=m;c({type:l,id:p.getId(m),currentTime:y,volume:_,muted:b,playbackRate:w,loop:E})}})),f.media||500))),_=[ve("play",y(xp.Play),m),ve("pause",y(xp.Pause),m),ve("seeked",y(xp.Seeked),m),ve("volumechange",y(xp.VolumeChange),m),ve("ratechange",y(xp.RateChange),m)];return Ke((()=>{_.forEach((l=>l()))}))}(l),d2=()=>{},h2=()=>{},p2=()=>{},v2=()=>{};l.recordDOM&&(d2=function(l,c){var{styleSheetRuleCb:d,mirror:h,stylesheetManager:p}=l,{win:f}=c;if(!f.CSSStyleSheet||!f.CSSStyleSheet.prototype)return()=>{};var m=f.CSSStyleSheet.prototype.insertRule;f.CSSStyleSheet.prototype.insertRule=new Proxy(m,{apply:Ke(((l,c,f)=>{var[m,y]=f,{id:_,styleId:b}=ot(c,h,p.styleMirror);return(_&&-1!==_||b&&-1!==b)&&d({id:_,styleId:b,adds:[{rule:m,index:y}]}),l.apply(c,f)}))}),f.CSSStyleSheet.prototype.addRule=function(l,c,d){void 0===d&&(d=this.cssRules.length);var h=l+" { "+c+" }";return f.CSSStyleSheet.prototype.insertRule.apply(this,[h,d])};var y,_,b=f.CSSStyleSheet.prototype.deleteRule;f.CSSStyleSheet.prototype.deleteRule=new Proxy(b,{apply:Ke(((l,c,f)=>{var[m]=f,{id:y,styleId:_}=ot(c,h,p.styleMirror);return(y&&-1!==y||_&&-1!==_)&&d({id:y,styleId:_,removes:[{index:m}]}),l.apply(c,f)}))}),f.CSSStyleSheet.prototype.removeRule=function(l){return f.CSSStyleSheet.prototype.deleteRule.apply(this,[l])},f.CSSStyleSheet.prototype.replace&&(y=f.CSSStyleSheet.prototype.replace,f.CSSStyleSheet.prototype.replace=new Proxy(y,{apply:Ke(((l,c,f)=>{var[m]=f,{id:y,styleId:_}=ot(c,h,p.styleMirror);return(y&&-1!==y||_&&-1!==_)&&d({id:y,styleId:_,replace:m}),l.apply(c,f)}))})),f.CSSStyleSheet.prototype.replaceSync&&(_=f.CSSStyleSheet.prototype.replaceSync,f.CSSStyleSheet.prototype.replaceSync=new Proxy(_,{apply:Ke(((l,c,f)=>{var[m]=f,{id:y,styleId:_}=ot(c,h,p.styleMirror);return(y&&-1!==y||_&&-1!==_)&&d({id:y,styleId:_,replaceSync:m}),l.apply(c,f)}))}));var w={};ct("CSSGroupingRule")?w.CSSGroupingRule=f.CSSGroupingRule:(ct("CSSMediaRule")&&(w.CSSMediaRule=f.CSSMediaRule),ct("CSSConditionRule")&&(w.CSSConditionRule=f.CSSConditionRule),ct("CSSSupportsRule")&&(w.CSSSupportsRule=f.CSSSupportsRule));var E={};return Object.entries(w).forEach((l=>{var[c,f]=l;E[c]={insertRule:f.prototype.insertRule,deleteRule:f.prototype.deleteRule},f.prototype.insertRule=new Proxy(E[c].insertRule,{apply:Ke(((l,c,f)=>{var[m,y]=f,{id:_,styleId:b}=ot(c.parentStyleSheet,h,p.styleMirror);return(_&&-1!==_||b&&-1!==b)&&d({id:_,styleId:b,adds:[{rule:m,index:[...st(c),y||0]}]}),l.apply(c,f)}))}),f.prototype.deleteRule=new Proxy(E[c].deleteRule,{apply:Ke(((l,c,f)=>{var[m]=f,{id:y,styleId:_}=ot(c.parentStyleSheet,h,p.styleMirror);return(y&&-1!==y||_&&-1!==_)&&d({id:y,styleId:_,removes:[{index:[...st(c),m]}]}),l.apply(c,f)}))})})),Ke((()=>{f.CSSStyleSheet.prototype.insertRule=m,f.CSSStyleSheet.prototype.deleteRule=b,y&&(f.CSSStyleSheet.prototype.replace=y),_&&(f.CSSStyleSheet.prototype.replaceSync=_),Object.entries(w).forEach((l=>{var[c,d]=l;d.prototype.insertRule=E[c].insertRule,d.prototype.deleteRule=E[c].deleteRule}))}))}(l,{win:h}),h2=at(l,l.doc),p2=function(l,c){var{styleDeclarationCb:d,mirror:h,ignoreCSSAttributes:p,stylesheetManager:f}=l,{win:m}=c,y=m.CSSStyleDeclaration.prototype.setProperty;m.CSSStyleDeclaration.prototype.setProperty=new Proxy(y,{apply:Ke(((l,c,m)=>{var _,[b,w,E]=m;if(p.has(b))return y.apply(c,[b,w,E]);var{id:M,styleId:N}=ot(null==(_=c.parentRule)?void 0:_.parentStyleSheet,h,f.styleMirror);return(M&&-1!==M||N&&-1!==N)&&d({id:M,styleId:N,set:{property:b,value:w,priority:E},index:st(c.parentRule)}),l.apply(c,m)}))});var _=m.CSSStyleDeclaration.prototype.removeProperty;return m.CSSStyleDeclaration.prototype.removeProperty=new Proxy(_,{apply:Ke(((l,c,m)=>{var y,[b]=m;if(p.has(b))return _.apply(c,[b]);var{id:w,styleId:E}=ot(null==(y=c.parentRule)?void 0:y.parentStyleSheet,h,f.styleMirror);return(w&&-1!==w||E&&-1!==E)&&d({id:w,styleId:E,remove:{property:b},index:st(c.parentRule)}),l.apply(c,m)}))}),Ke((()=>{m.CSSStyleDeclaration.prototype.setProperty=y,m.CSSStyleDeclaration.prototype.removeProperty=_}))}(l,{win:h}),l.collectFonts&&(v2=function(l){var{fontCb:c,doc:d}=l,h=d.defaultView;if(!h)return()=>{};var p=[],f=new WeakMap,m=h.FontFace;h.FontFace=function(l,c,d){var h=new m(l,c,d);return f.set(h,{family:l,buffer:"string"!=typeof c,descriptors:d,fontSource:"string"==typeof c?c:JSON.stringify(Array.from(new Uint8Array(c)))}),h};var y=ye(d.fonts,"add",(function(l){return function(d){return setTimeout(Ke((()=>{var l=f.get(d);l&&(c(l),f.delete(d))})),0),l.apply(this,[d])}}));return p.push((()=>{h.FontFace=m})),p.push(y),Ke((()=>{p.forEach((l=>l()))}))}(l)));var w=function(l){var{doc:c,mirror:d,blockClass:h,blockSelector:p,selectionCb:f}=l,m=!0,y=Ke((()=>{var l=c.getSelection();if(!(!l||m&&(null==l?void 0:l.isCollapsed))){m=l.isCollapsed||!1;for(var y=[],_=l.rangeCount||0,b=0;b<_;b++){var w=l.getRangeAt(b),{startContainer:E,startOffset:M,endContainer:N,endOffset:P}=w;ke(E,h,p,!0)||ke(N,h,p,!0)||y.push({start:d.getId(E),startOffset:M,end:d.getId(N),endOffset:P})}f({ranges:y})}}));return y(),ve("selectionchange",y)}(l),E=function(l){var{doc:c,customElementCb:d}=l,h=c.defaultView;return h&&h.customElements?ye(h.customElements,"define",(function(l){return function(c,h,p){try{d({define:{name:c}})}catch(f){console.warn("Custom element callback failed for "+c)}return l.apply(this,[c,h,p])}})):()=>{}}(l),M=[];for(var N of l.plugins)M.push(N.observer(N.callback,h,N.options));return Ke((()=>{Cp.forEach((l=>l.reset())),null==d||d.disconnect(),p(),f(),m(),y(),_(),b(),d2(),h2(),p2(),v2(),w(),E(),M.forEach((l=>l()))}))}function ut(l){return void 0!==window[l]}function ct(l){return Boolean(void 0!==window[l]&&window[l].prototype&&"insertRule"in window[l].prototype&&"deleteRule"in window[l].prototype)}class dt{constructor(l){a$1(this,"iframeIdToRemoteIdMap",new WeakMap),a$1(this,"iframeRemoteIdToIdMap",new WeakMap),this.generateIdFn=l}getId(l,c,d,h){var p=d||this.getIdToRemoteIdMap(l),f=h||this.getRemoteIdToIdMap(l),m=p.get(c);return m||(m=this.generateIdFn(),p.set(c,m),f.set(m,c)),m}getIds(l,c){var d=this.getIdToRemoteIdMap(l),h=this.getRemoteIdToIdMap(l);return c.map((c=>this.getId(l,c,d,h)))}getRemoteId(l,c,d){var h=d||this.getRemoteIdToIdMap(l);return"number"!=typeof c?c:h.get(c)||-1}getRemoteIds(l,c){var d=this.getRemoteIdToIdMap(l);return c.map((c=>this.getRemoteId(l,c,d)))}reset(l){if(!l)return this.iframeIdToRemoteIdMap=new WeakMap,void(this.iframeRemoteIdToIdMap=new WeakMap);this.iframeIdToRemoteIdMap.delete(l),this.iframeRemoteIdToIdMap.delete(l)}getIdToRemoteIdMap(l){var c=this.iframeIdToRemoteIdMap.get(l);return c||(c=new Map,this.iframeIdToRemoteIdMap.set(l,c)),c}getRemoteIdToIdMap(l){var c=this.iframeRemoteIdToIdMap.get(l);return c||(c=new Map,this.iframeRemoteIdToIdMap.set(l,c)),c}}let Rp=class{constructor(l){a$1(this,"iframes",new WeakMap),a$1(this,"crossOriginIframeMap",new WeakMap),a$1(this,"crossOriginIframeMirror",new dt(W)),a$1(this,"crossOriginIframeStyleMirror"),a$1(this,"crossOriginIframeRootIdMap",new WeakMap),a$1(this,"mirror"),a$1(this,"mutationCb"),a$1(this,"wrappedEmit"),a$1(this,"loadListener"),a$1(this,"stylesheetManager"),a$1(this,"recordCrossOriginIframes"),this.mutationCb=l.mutationCb,this.wrappedEmit=l.wrappedEmit,this.stylesheetManager=l.stylesheetManager,this.recordCrossOriginIframes=l.recordCrossOriginIframes,this.crossOriginIframeStyleMirror=new dt(this.stylesheetManager.styleMirror.generateId.bind(this.stylesheetManager.styleMirror)),this.mirror=l.mirror,this.recordCrossOriginIframes&&window.addEventListener("message",this.handleMessage.bind(this))}addIframe(l){this.iframes.set(l,!0),l.contentWindow&&this.crossOriginIframeMap.set(l.contentWindow,l)}addLoadListener(l){this.loadListener=l}attachIframe(l,c){var d,h;this.mutationCb({adds:[{parentId:this.mirror.getId(l),nextId:null,node:c}],removes:[],texts:[],attributes:[],isAttachIframe:!0}),this.recordCrossOriginIframes&&(null==(d=l.contentWindow)||d.addEventListener("message",this.handleMessage.bind(this))),null==(h=this.loadListener)||h.call(this,l),l.contentDocument&&l.contentDocument.adoptedStyleSheets&&l.contentDocument.adoptedStyleSheets.length>0&&this.stylesheetManager.adoptStyleSheets(l.contentDocument.adoptedStyleSheets,this.mirror.getId(l.contentDocument))}handleMessage(l){var c=l;if("rrweb"===c.data.type&&c.origin===c.data.origin&&l.source){var d=this.crossOriginIframeMap.get(l.source);if(d){var h=this.transformCrossOriginEvent(d,c.data.event);h&&this.wrappedEmit(h,c.data.isCheckout)}}}transformCrossOriginEvent(l,c){var d;switch(c.type){case gp.FullSnapshot:this.crossOriginIframeMirror.reset(l),this.crossOriginIframeStyleMirror.reset(l),this.replaceIdOnNode(c.data.node,l);var h=c.data.node.id;return this.crossOriginIframeRootIdMap.set(l,h),this.patchRootIdOnNode(c.data.node,h),{timestamp:c.timestamp,type:gp.IncrementalSnapshot,data:{source:vp.Mutation,adds:[{parentId:this.mirror.getId(l),nextId:null,node:c.data.node}],removes:[],texts:[],attributes:[],isAttachIframe:!0}};case gp.Meta:case gp.Load:case gp.DomContentLoaded:return!1;case gp.Plugin:return c;case gp.Custom:return this.replaceIds(c.data.payload,l,["id","parentId","previousId","nextId"]),c;case gp.IncrementalSnapshot:switch(c.data.source){case vp.Mutation:return c.data.adds.forEach((c=>{this.replaceIds(c,l,["parentId","nextId","previousId"]),this.replaceIdOnNode(c.node,l);var d=this.crossOriginIframeRootIdMap.get(l);d&&this.patchRootIdOnNode(c.node,d)})),c.data.removes.forEach((c=>{this.replaceIds(c,l,["parentId","id"])})),c.data.attributes.forEach((c=>{this.replaceIds(c,l,["id"])})),c.data.texts.forEach((c=>{this.replaceIds(c,l,["id"])})),c;case vp.Drag:case vp.TouchMove:case vp.MouseMove:return c.data.positions.forEach((c=>{this.replaceIds(c,l,["id"])})),c;case vp.ViewportResize:return!1;case vp.MediaInteraction:case vp.MouseInteraction:case vp.Scroll:case vp.CanvasMutation:case vp.Input:return this.replaceIds(c.data,l,["id"]),c;case vp.StyleSheetRule:case vp.StyleDeclaration:return this.replaceIds(c.data,l,["id"]),this.replaceStyleIds(c.data,l,["styleId"]),c;case vp.Font:return c;case vp.Selection:return c.data.ranges.forEach((c=>{this.replaceIds(c,l,["start","end"])})),c;case vp.AdoptedStyleSheet:return this.replaceIds(c.data,l,["id"]),this.replaceStyleIds(c.data,l,["styleIds"]),null==(d=c.data.styles)||d.forEach((c=>{this.replaceStyleIds(c,l,["styleId"])})),c}}return!1}replace(l,c,d,h){for(var p of h)(Array.isArray(c[p])||"number"==typeof c[p])&&(Array.isArray(c[p])?c[p]=l.getIds(d,c[p]):c[p]=l.getId(d,c[p]));return c}replaceIds(l,c,d){return this.replace(this.crossOriginIframeMirror,l,c,d)}replaceStyleIds(l,c,d){return this.replace(this.crossOriginIframeStyleMirror,l,c,d)}replaceIdOnNode(l,c){this.replaceIds(l,c,["id","rootId"]),"childNodes"in l&&l.childNodes.forEach((l=>{this.replaceIdOnNode(l,c)}))}patchRootIdOnNode(l,c){l.type===wh.Document||l.rootId||(l.rootId=c),"childNodes"in l&&l.childNodes.forEach((l=>{this.patchRootIdOnNode(l,c)}))}};class pt{constructor(l){a$1(this,"shadowDoms",new WeakSet),a$1(this,"mutationCb"),a$1(this,"scrollCb"),a$1(this,"bypassOptions"),a$1(this,"mirror"),a$1(this,"restoreHandlers",[]),this.mutationCb=l.mutationCb,this.scrollCb=l.scrollCb,this.bypassOptions=l.bypassOptions,this.mirror=l.mirror,this.init()}init(){this.reset(),this.patchAttachShadow(Element,document)}addShadowRoot(l,c){if(w2(l)&&!this.shadowDoms.has(l)){this.shadowDoms.add(l);var d=et(r$2({},this.bypassOptions,{doc:c,mutationCb:this.mutationCb,mirror:this.mirror,shadowDomManager:this}),l);this.restoreHandlers.push((()=>d.disconnect())),this.restoreHandlers.push(rt(r$2({},this.bypassOptions,{scrollCb:this.scrollCb,doc:l,mirror:this.mirror}))),setTimeout((()=>{l.adoptedStyleSheets&&l.adoptedStyleSheets.length>0&&this.bypassOptions.stylesheetManager.adoptStyleSheets(l.adoptedStyleSheets,this.mirror.getId(pe_host(l))),this.restoreHandlers.push(at({mirror:this.mirror,stylesheetManager:this.bypassOptions.stylesheetManager},l))}),0)}}observeAttachShadow(l){l.contentWindow&&l.contentDocument&&this.patchAttachShadow(l.contentWindow.Element,l.contentDocument)}patchAttachShadow(l,c){var d=this;this.restoreHandlers.push(ye(l.prototype,"attachShadow",(function(l){return function(h){var p=l.call(this,h),f=pe_shadowRoot(this);return f&&Le(this)&&d.addShadowRoot(f,c),p}})))}reset(){this.restoreHandlers.forEach((l=>{try{l()}catch(c){}})),this.restoreHandlers=[],this.shadowDoms=new WeakSet}}for(var Op="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",jp="undefined"==typeof Uint8Array?[]:new Uint8Array(256),$p=0;$p<64;$p++)jp[Op.charCodeAt($p)]=$p;var Bp=new Map,mt=(l,c,d)=>{if(l&&(St$1(l,c)||"object"==typeof l)){var h=(f=d,m=l.constructor.name,(y=Bp.get(f))||(y=new Map,Bp.set(f,y)),y.has(m)||y.set(m,[]),y.get(m)),p=h.indexOf(l);return-1===p&&(p=h.length,h.push(l)),p}var f,m,y};function yt2(l,c,d){if(l instanceof Array)return l.map((l=>yt2(l,c,d)));if(null===l)return l;if(l instanceof Float32Array||l instanceof Float64Array||l instanceof Int32Array||l instanceof Uint32Array||l instanceof Uint8Array||l instanceof Uint16Array||l instanceof Int16Array||l instanceof Int8Array||l instanceof Uint8ClampedArray)return{rr_type:l.constructor.name,args:[Object.values(l)]};if(l instanceof ArrayBuffer)return{rr_type:l.constructor.name,base64:function(l){var c,d=new Uint8Array(l),h=d.length,p="";for(c=0;c<h;c+=3)p+=Op[d[c]>>2],p+=Op[(3&d[c])<<4|d[c+1]>>4],p+=Op[(15&d[c+1])<<2|d[c+2]>>6],p+=Op[63&d[c+2]];return h%3==2?p=p.substring(0,p.length-1)+"=":h%3==1&&(p=p.substring(0,p.length-2)+"=="),p}(l)};if(l instanceof DataView)return{rr_type:l.constructor.name,args:[yt2(l.buffer,c,d),l.byteOffset,l.byteLength]};if(l instanceof HTMLImageElement){var h=l.constructor.name,{src:p}=l;return{rr_type:h,src:p}}return l instanceof HTMLCanvasElement?{rr_type:"HTMLImageElement",src:l.toDataURL()}:l instanceof ImageData?{rr_type:l.constructor.name,args:[yt2(l.data,c,d),l.width,l.height]}:St$1(l,c)||"object"==typeof l?{rr_type:l.constructor.name,index:mt(l,c,d)}:l}var bt$1=(l,c,d)=>l.map((l=>yt2(l,c,d))),St$1=(l,c)=>{var d=["WebGLActiveInfo","WebGLBuffer","WebGLFramebuffer","WebGLProgram","WebGLRenderbuffer","WebGLShader","WebGLShaderPrecisionFormat","WebGLTexture","WebGLUniformLocation","WebGLVertexArrayObject","WebGLVertexArrayObjectOES"].filter((l=>"function"==typeof c[l]));return Boolean(d.find((d=>l instanceof c[d])))};function wt$1(l,c,d,h){var p=[];try{var f=ye(l.HTMLCanvasElement.prototype,"getContext",(function(l){return function(p){for(var f=arguments.length,m=new Array(f>1?f-1:0),y=1;y<f;y++)m[y-1]=arguments[y];if(!ke(this,c,d,!0)){var _=function(l){return"experimental-webgl"===l?"webgl":l}(p);if("__context"in this||(this.__context=_),h&&["webgl","webgl2"].includes(_))if(m[0]&&"object"==typeof m[0]){var b=m[0];b.preserveDrawingBuffer||(b.preserveDrawingBuffer=!0)}else m.splice(0,1,{preserveDrawingBuffer:!0})}return l.apply(this,[p,...m])}}));p.push(f)}catch(m){console.error("failed to patch HTMLCanvasElement.prototype.getContext")}return()=>{p.forEach((l=>l()))}}function Ct(l,c,d,h,p,f){var m=[],y=Object.getOwnPropertyNames(l),l2=function(y){if(["isContextLost","canvas","drawingBufferWidth","drawingBufferHeight"].includes(y))return 0;try{if("function"!=typeof l[y])return 0;var _=ye(l,y,(function(l){return function(){for(var m=arguments.length,_=new Array(m),b=0;b<m;b++)_[b]=arguments[b];var w=l.apply(this,_);if(mt(w,f,this),"tagName"in this.canvas&&!ke(this.canvas,h,p,!0)){var E=bt$1(_,f,this),M={type:c,property:y,args:E};d(this.canvas,M)}return w}}));m.push(_)}catch(w){var b=me(l,y,{set(l){d(this.canvas,{type:c,property:y,args:[l],setter:!0})}});m.push(b)}};for(var _ of y)l2(_);return m}var Hp,Yp,Qp,Xp,ef="KGZ1bmN0aW9uKCkgewogICJ1c2Ugc3RyaWN0IjsKICB2YXIgY2hhcnMgPSAiQUJDREVGR0hJSktMTU5PUFFSU1RVVldYWVphYmNkZWZnaGlqa2xtbm9wcXJzdHV2d3h5ejAxMjM0NTY3ODkrLyI7CiAgdmFyIGxvb2t1cCA9IHR5cGVvZiBVaW50OEFycmF5ID09PSAidW5kZWZpbmVkIiA/IFtdIDogbmV3IFVpbnQ4QXJyYXkoMjU2KTsKICBmb3IgKHZhciBpID0gMDsgaSA8IGNoYXJzLmxlbmd0aDsgaSsrKSB7CiAgICBsb29rdXBbY2hhcnMuY2hhckNvZGVBdChpKV0gPSBpOwogIH0KICB2YXIgZW5jb2RlID0gZnVuY3Rpb24oYXJyYXlidWZmZXIpIHsKICAgIHZhciBieXRlcyA9IG5ldyBVaW50OEFycmF5KGFycmF5YnVmZmVyKSwgaTIsIGxlbiA9IGJ5dGVzLmxlbmd0aCwgYmFzZTY0ID0gIiI7CiAgICBmb3IgKGkyID0gMDsgaTIgPCBsZW47IGkyICs9IDMpIHsKICAgICAgYmFzZTY0ICs9IGNoYXJzW2J5dGVzW2kyXSA+PiAyXTsKICAgICAgYmFzZTY0ICs9IGNoYXJzWyhieXRlc1tpMl0gJiAzKSA8PCA0IHwgYnl0ZXNbaTIgKyAxXSA+PiA0XTsKICAgICAgYmFzZTY0ICs9IGNoYXJzWyhieXRlc1tpMiArIDFdICYgMTUpIDw8IDIgfCBieXRlc1tpMiArIDJdID4+IDZdOwogICAgICBiYXNlNjQgKz0gY2hhcnNbYnl0ZXNbaTIgKyAyXSAmIDYzXTsKICAgIH0KICAgIGlmIChsZW4gJSAzID09PSAyKSB7CiAgICAgIGJhc2U2NCA9IGJhc2U2NC5zdWJzdHJpbmcoMCwgYmFzZTY0Lmxlbmd0aCAtIDEpICsgIj0iOwogICAgfSBlbHNlIGlmIChsZW4gJSAzID09PSAxKSB7CiAgICAgIGJhc2U2NCA9IGJhc2U2NC5zdWJzdHJpbmcoMCwgYmFzZTY0Lmxlbmd0aCAtIDIpICsgIj09IjsKICAgIH0KICAgIHJldHVybiBiYXNlNjQ7CiAgfTsKICBjb25zdCBsYXN0QmxvYk1hcCA9IC8qIEBfX1BVUkVfXyAqLyBuZXcgTWFwKCk7CiAgY29uc3QgdHJhbnNwYXJlbnRCbG9iTWFwID0gLyogQF9fUFVSRV9fICovIG5ldyBNYXAoKTsKICBhc3luYyBmdW5jdGlvbiBnZXRUcmFuc3BhcmVudEJsb2JGb3Iod2lkdGgsIGhlaWdodCwgZGF0YVVSTE9wdGlvbnMpIHsKICAgIGNvbnN0IGlkID0gYCR7d2lkdGh9LSR7aGVpZ2h0fWA7CiAgICBpZiAoIk9mZnNjcmVlbkNhbnZhcyIgaW4gZ2xvYmFsVGhpcykgewogICAgICBpZiAodHJhbnNwYXJlbnRCbG9iTWFwLmhhcyhpZCkpIHJldHVybiB0cmFuc3BhcmVudEJsb2JNYXAuZ2V0KGlkKTsKICAgICAgY29uc3Qgb2Zmc2NyZWVuID0gbmV3IE9mZnNjcmVlbkNhbnZhcyh3aWR0aCwgaGVpZ2h0KTsKICAgICAgb2Zmc2NyZWVuLmdldENvbnRleHQoIjJkIik7CiAgICAgIGNvbnN0IGJsb2IgPSBhd2FpdCBvZmZzY3JlZW4uY29udmVydFRvQmxvYihkYXRhVVJMT3B0aW9ucyk7CiAgICAgIGNvbnN0IGFycmF5QnVmZmVyID0gYXdhaXQgYmxvYi5hcnJheUJ1ZmZlcigpOwogICAgICBjb25zdCBiYXNlNjQgPSBlbmNvZGUoYXJyYXlCdWZmZXIpOwogICAgICB0cmFuc3BhcmVudEJsb2JNYXAuc2V0KGlkLCBiYXNlNjQpOwogICAgICByZXR1cm4gYmFzZTY0OwogICAgfSBlbHNlIHsKICAgICAgcmV0dXJuICIiOwogICAgfQogIH0KICBjb25zdCB3b3JrZXIgPSBzZWxmOwogIHdvcmtlci5vbm1lc3NhZ2UgPSBhc3luYyBmdW5jdGlvbihlKSB7CiAgICBpZiAoIk9mZnNjcmVlbkNhbnZhcyIgaW4gZ2xvYmFsVGhpcykgewogICAgICBjb25zdCB7IGlkLCBiaXRtYXAsIHdpZHRoLCBoZWlnaHQsIGRhdGFVUkxPcHRpb25zIH0gPSBlLmRhdGE7CiAgICAgIGNvbnN0IHRyYW5zcGFyZW50QmFzZTY0ID0gZ2V0VHJhbnNwYXJlbnRCbG9iRm9yKAogICAgICAgIHdpZHRoLAogICAgICAgIGhlaWdodCwKICAgICAgICBkYXRhVVJMT3B0aW9ucwogICAgICApOwogICAgICBjb25zdCBvZmZzY3JlZW4gPSBuZXcgT2Zmc2NyZWVuQ2FudmFzKHdpZHRoLCBoZWlnaHQpOwogICAgICBjb25zdCBjdHggPSBvZmZzY3JlZW4uZ2V0Q29udGV4dCgiMmQiKTsKICAgICAgY3R4LmRyYXdJbWFnZShiaXRtYXAsIDAsIDApOwogICAgICBiaXRtYXAuY2xvc2UoKTsKICAgICAgY29uc3QgYmxvYiA9IGF3YWl0IG9mZnNjcmVlbi5jb252ZXJ0VG9CbG9iKGRhdGFVUkxPcHRpb25zKTsKICAgICAgY29uc3QgdHlwZSA9IGJsb2IudHlwZTsKICAgICAgY29uc3QgYXJyYXlCdWZmZXIgPSBhd2FpdCBibG9iLmFycmF5QnVmZmVyKCk7CiAgICAgIGNvbnN0IGJhc2U2NCA9IGVuY29kZShhcnJheUJ1ZmZlcik7CiAgICAgIGlmICghbGFzdEJsb2JNYXAuaGFzKGlkKSAmJiBhd2FpdCB0cmFuc3BhcmVudEJhc2U2NCA9PT0gYmFzZTY0KSB7CiAgICAgICAgbGFzdEJsb2JNYXAuc2V0KGlkLCBiYXNlNjQpOwogICAgICAgIHJldHVybiB3b3JrZXIucG9zdE1lc3NhZ2UoeyBpZCB9KTsKICAgICAgfQogICAgICBpZiAobGFzdEJsb2JNYXAuZ2V0KGlkKSA9PT0gYmFzZTY0KSByZXR1cm4gd29ya2VyLnBvc3RNZXNzYWdlKHsgaWQgfSk7CiAgICAgIHdvcmtlci5wb3N0TWVzc2FnZSh7CiAgICAgICAgaWQsCiAgICAgICAgdHlwZSwKICAgICAgICBiYXNlNjQsCiAgICAgICAgd2lkdGgsCiAgICAgICAgaGVpZ2h0CiAgICAgIH0pOwogICAgICBsYXN0QmxvYk1hcC5zZXQoaWQsIGJhc2U2NCk7CiAgICB9IGVsc2UgewogICAgICByZXR1cm4gd29ya2VyLnBvc3RNZXNzYWdlKHsgaWQ6IGUuZGF0YS5pZCB9KTsKICAgIH0KICB9Owp9KSgpOwovLyMgc291cmNlTWFwcGluZ1VSTD1pbWFnZS1iaXRtYXAtZGF0YS11cmwtd29ya2VyLUlKcEM3Z19iLmpzLm1hcAo=",tf="undefined"!=typeof window&&window.Blob&&new Blob([(Hp=ef,Uint8Array.from(atob(Hp),(l=>l.charCodeAt(0))))],{type:"text/javascript;charset=utf-8"});function Rt(l){var c;try{if(!(c=tf&&(window.URL||window.webkitURL).createObjectURL(tf)))throw"";var d=new Worker(c,{name:null==l?void 0:l.name});return d.addEventListener("error",(()=>{(window.URL||window.webkitURL).revokeObjectURL(c)})),d}catch(h){return new Worker("data:text/javascript;base64,"+ef,{name:null==l?void 0:l.name})}finally{c&&(window.URL||window.webkitURL).revokeObjectURL(c)}}let rf=class{constructor(l){a$1(this,"pendingCanvasMutations",new Map),a$1(this,"rafStamps",{latestId:0,invokeId:null}),a$1(this,"mirror"),a$1(this,"mutationCb"),a$1(this,"resetObservers"),a$1(this,"frozen",!1),a$1(this,"locked",!1),a$1(this,"processMutation",((l,c)=>{!(this.rafStamps.invokeId&&this.rafStamps.latestId!==this.rafStamps.invokeId)&&this.rafStamps.invokeId||(this.rafStamps.invokeId=this.rafStamps.latestId),this.pendingCanvasMutations.has(l)||this.pendingCanvasMutations.set(l,[]),this.pendingCanvasMutations.get(l).push(c)}));var{sampling:c="all",win:d,blockClass:h,blockSelector:p,recordCanvas:f,dataURLOptions:m}=l;this.mutationCb=l.mutationCb,this.mirror=l.mirror,f&&"all"===c&&this.initCanvasMutationObserver(d,h,p),f&&"number"==typeof c&&this.initCanvasFPSObserver(c,d,h,p,{dataURLOptions:m})}reset(){this.pendingCanvasMutations.clear(),this.resetObservers&&this.resetObservers()}freeze(){this.frozen=!0}unfreeze(){this.frozen=!1}lock(){this.locked=!0}unlock(){this.locked=!1}initCanvasFPSObserver(l,c,d,h,p){var f=this,m=wt$1(c,d,h,!0),y=new Map,_=new Rt;_.onmessage=l=>{var{id:c}=l.data;if(y.set(c,!1),"base64"in l.data){var{base64:d,type:h,width:p,height:f}=l.data;this.mutationCb({id:c,type:Sp["2D"],commands:[{property:"clearRect",args:[0,0,p,f]},{property:"drawImage",args:[{rr_type:"ImageBitmap",args:[{rr_type:"Blob",data:[{rr_type:"ArrayBuffer",base64:d}],type:h}]},0,0]}]})}};var b,w=1e3/l,E=0,p2=l=>{var m,M,N;E&&l-E<w||(E=l,(m=[],M=l=>{l.querySelectorAll("canvas").forEach((l=>{ke(l,d,h,!0)||m.push(l)})),l.querySelectorAll("*").forEach((l=>{l.shadowRoot&&M(l.shadowRoot)}))},M(c.document),m).forEach((N=t$1((function*(l){var c,d=f.mirror.getId(l);if(!y.get(d)&&0!==l.width&&0!==l.height){if(y.set(d,!0),["webgl","webgl2"].includes(l.__context)){var h=l.getContext(l.__context);!1===(null==(c=null==h?void 0:h.getContextAttributes())?void 0:c.preserveDrawingBuffer)&&h.clear(h.COLOR_BUFFER_BIT)}var m=l.clientWidth||l.width,b=l.clientHeight||l.height,w=yield createImageBitmap(l,{resizeWidth:m,resizeHeight:b});_.postMessage({id:d,bitmap:w,width:m,height:b,dataURLOptions:p.dataURLOptions},[w])}})),function(l){return N.apply(this,arguments)}))),b=requestAnimationFrame(p2)};b=requestAnimationFrame(p2),this.resetObservers=()=>{m(),cancelAnimationFrame(b)}}initCanvasMutationObserver(l,c,d){this.startRAFTimestamping(),this.startPendingCanvasMutationFlusher();var h,p,f,m,y,_=wt$1(l,c,d,!1),b=function(l,c,d,h){var p=[],f=Object.getOwnPropertyNames(c.CanvasRenderingContext2D.prototype),o2=function(f){try{if("function"!=typeof c.CanvasRenderingContext2D.prototype[f])return 1;var m=ye(c.CanvasRenderingContext2D.prototype,f,(function(p){return function(){for(var m=arguments.length,y=new Array(m),_=0;_<m;_++)y[_]=arguments[_];return ke(this.canvas,d,h,!0)||setTimeout((()=>{var d=bt$1(y,c,this);l(this.canvas,{type:Sp["2D"],property:f,args:d})}),0),p.apply(this,y)}}));p.push(m)}catch(_){var y=me(c.CanvasRenderingContext2D.prototype,f,{set(c){l(this.canvas,{type:Sp["2D"],property:f,args:[c],setter:!0})}});p.push(y)}};for(var m of f)o2(m);return()=>{p.forEach((l=>l()))}}(this.processMutation.bind(this),l,c,d),w=(h=this.processMutation.bind(this),f=c,m=d,(y=[]).push(...Ct((p=l).WebGLRenderingContext.prototype,Sp.WebGL,h,f,m,p)),void 0!==p.WebGL2RenderingContext&&y.push(...Ct(p.WebGL2RenderingContext.prototype,Sp.WebGL2,h,f,m,p)),()=>{y.forEach((l=>l()))});this.resetObservers=()=>{_(),b(),w()}}startPendingCanvasMutationFlusher(){requestAnimationFrame((()=>this.flushPendingCanvasMutations()))}startRAFTimestamping(){var e3=l=>{this.rafStamps.latestId=l,requestAnimationFrame(e3)};requestAnimationFrame(e3)}flushPendingCanvasMutations(){this.pendingCanvasMutations.forEach(((l,c)=>{var d=this.mirror.getId(c);this.flushPendingCanvasMutationFor(c,d)})),requestAnimationFrame((()=>this.flushPendingCanvasMutations()))}flushPendingCanvasMutationFor(l,c){if(!this.frozen&&!this.locked){var d=this.pendingCanvasMutations.get(l);if(d&&-1!==c){var h=d.map((l=>i$2(l,fh))),{type:p}=d[0];this.mutationCb({id:c,type:p,commands:h}),this.pendingCanvasMutations.delete(l)}}}},nf=class{constructor(l){a$1(this,"trackedLinkElements",new WeakSet),a$1(this,"mutationCb"),a$1(this,"adoptedStyleSheetCb"),a$1(this,"styleMirror",new pp),this.mutationCb=l.mutationCb,this.adoptedStyleSheetCb=l.adoptedStyleSheetCb}attachLinkElement(l,c){"_cssText"in c.attributes&&this.mutationCb({adds:[],removes:[],texts:[],attributes:[{id:c.id,attributes:c.attributes}]}),this.trackLinkElement(l)}trackLinkElement(l){this.trackedLinkElements.has(l)||(this.trackedLinkElements.add(l),this.trackStylesheetInLinkElement(l))}adoptStyleSheets(l,c){var d=this;if(0!==l.length){var h={id:c,styleIds:[]},p=[],s2=function(l){var c;d.styleMirror.has(l)?c=d.styleMirror.getId(l):(c=d.styleMirror.add(l),p.push({styleId:c,rules:Array.from(l.rules||CSSRule,((c,d)=>({rule:I(c,l.href),index:d})))})),h.styleIds.push(c)};for(var f of l)s2(f);p.length>0&&(h.styles=p),this.adoptedStyleSheetCb(h)}}reset(){this.styleMirror.reset(),this.trackedLinkElements=new WeakSet}trackStylesheetInLinkElement(l){}},sf=class{constructor(){a$1(this,"nodeMap",new WeakMap),a$1(this,"active",!1)}inOtherBuffer(l,c){var d=this.nodeMap.get(l);return d&&Array.from(d).some((l=>l!==c))}add(l,c){this.active||(this.active=!0,requestAnimationFrame((()=>{this.nodeMap=new WeakMap,this.active=!1}))),this.nodeMap.set(l,(this.nodeMap.get(l)||new Set).add(c))}destroy(){}};var of=!1;try{if(2!==Array.from([1],(l=>2*l))[0]){var af=document.createElement("iframe");document.body.appendChild(af),Array.from=(null==(uh=af.contentWindow)?void 0:uh.Array.from)||Array.from,document.body.removeChild(af)}}catch(hh){console.debug("Unable to override Array.from",hh)}var lf,cf,uf=new Eh;function qt(l){void 0===l&&(l={});var{emit:c,checkoutEveryNms:d,checkoutEveryNth:h,blockClass:p="rr-block",blockSelector:f=null,ignoreClass:m="rr-ignore",ignoreSelector:y=null,maskTextClass:_="rr-mask",maskTextSelector:b=null,inlineStylesheet:w=!0,maskAllInputs:E,maskInputOptions:M,slimDOMOptions:N,maskInputFn:P,maskTextFn:L,hooks:j,packFn:D,sampling:F={},dataURLOptions:U={},mousemoveWait:B,recordDOM:H=!0,recordCanvas:z=!1,recordCrossOriginIframes:q=!1,recordAfter:V=("DOMContentLoaded"===l.recordAfter?l.recordAfter:"load"),userTriggeredOnInput:Z=!1,collectFonts:K=!1,inlineImages:Y=!1,plugins:ee,keepIframeSrcFn:ne=()=>!1,ignoreCSSAttributes:se=new Set([]),errorHandler:ie}=l;kp=ie;var oe=!q||window.parent===window,le=!1;if(!oe)try{window.parent.document&&(le=!1)}catch(pe){le=!0}if(oe&&!c)throw new Error("emit function is required");if(!oe&&!le)return()=>{};void 0!==B&&void 0===F.mousemove&&(F.mousemove=B),uf.reset();var ce,pe,fe=!0===E?{color:!0,date:!0,"datetime-local":!0,email:!0,month:!0,number:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0,textarea:!0,select:!0,password:!0}:void 0!==M?M:{password:!0},ge=!0===N||"all"===N?{script:!0,comment:!0,headFavicon:!0,headWhitespace:!0,headMetaSocial:!0,headMetaRobots:!0,headMetaHttpEquiv:!0,headMetaVerification:!0,headMetaAuthorship:"all"===N,headMetaDescKeywords:"all"===N,headTitleMutations:"all"===N}:N||{};void 0===pe&&(pe=window),"NodeList"in pe&&!pe.NodeList.prototype.forEach&&(pe.NodeList.prototype.forEach=Array.prototype.forEach),"DOMTokenList"in pe&&!pe.DOMTokenList.prototype.forEach&&(pe.DOMTokenList.prototype.forEach=Array.prototype.forEach);var be=0,B2=l=>{for(var c of ee||[])c.eventProcessor&&(l=c.eventProcessor(l));return D&&!le&&(l=D(l)),l};Yp=(l,p)=>{var f,m=l;if(m.timestamp=hp(),!(null==(f=Cp[0])?void 0:f.isFrozen())||m.type===gp.FullSnapshot||m.type===gp.IncrementalSnapshot&&m.data.source===vp.Mutation||Cp.forEach((l=>l.unfreeze())),oe)null==c||c(B2(m),p);else if(le){var y={type:"rrweb",event:B2(m),origin:window.location.origin,isCheckout:p};window.parent.postMessage(y,"*")}if(m.type===gp.FullSnapshot)ce=m,be=0;else if(m.type===gp.IncrementalSnapshot){if(m.data.source===vp.Mutation&&m.data.isAttachIframe)return;be++;var _=h&&be>=h,b=d&&m.timestamp-ce.timestamp>d;(_||b)&&Qp(!0)}};var V2=l=>{Yp({type:gp.IncrementalSnapshot,data:r$2({source:vp.Mutation},l)})},W2=l=>Yp({type:gp.IncrementalSnapshot,data:r$2({source:vp.Scroll},l)}),U2=l=>Yp({type:gp.IncrementalSnapshot,data:r$2({source:vp.CanvasMutation},l)}),Oe=new nf({mutationCb:V2,adoptedStyleSheetCb:l=>Yp({type:gp.IncrementalSnapshot,data:r$2({source:vp.AdoptedStyleSheet},l)})}),Ne=new Rp({mirror:uf,mutationCb:V2,stylesheetManager:Oe,recordCrossOriginIframes:q,wrappedEmit:Yp});for(var De of ee||[])De.getMirror&&De.getMirror({nodeMirror:uf,crossOriginIframeMirror:Ne.crossOriginIframeMirror,crossOriginIframeStyleMirror:Ne.crossOriginIframeStyleMirror});var Fe=new sf;Xp=new rf({recordCanvas:z,mutationCb:U2,win:window,blockClass:p,blockSelector:f,mirror:uf,sampling:F.canvas,dataURLOptions:U});var Ue=new pt({mutationCb:V2,scrollCb:W2,bypassOptions:{blockClass:p,blockSelector:f,maskTextClass:_,maskTextSelector:b,inlineStylesheet:w,maskInputOptions:fe,dataURLOptions:U,maskTextFn:L,maskInputFn:P,recordCanvas:z,inlineImages:Y,sampling:F,slimDOMOptions:ge,iframeManager:Ne,stylesheetManager:Oe,canvasManager:Xp,keepIframeSrcFn:ne,processedNodeManager:Fe},mirror:uf});Qp=function(l){if(void 0===l&&(l=!1),H){Yp({type:gp.Meta,data:{href:window.location.href,width:Ce(),height:we()}},l),Oe.reset(),Ue.init(),Cp.forEach((l=>l.lock()));var c=function(l,c){var{mirror:d=new Eh,blockClass:h="rr-block",blockSelector:p=null,maskTextClass:f="rr-mask",maskTextSelector:m=null,inlineStylesheet:y=!0,inlineImages:_=!1,recordCanvas:b=!1,maskAllInputs:w=!1,maskTextFn:E,maskInputFn:M,slimDOM:N=!1,dataURLOptions:P,preserveWhiteSpace:L,onSerialize:j,onIframeLoad:D,iframeLoadTimeout:F,onStylesheetLoad:U,stylesheetLoadTimeout:B,keepIframeSrcFn:H=()=>!1}=c||{};return re(l,{doc:l,mirror:d,blockClass:h,blockSelector:p,maskTextClass:f,maskTextSelector:m,skipChild:!1,inlineStylesheet:y,maskInputOptions:!0===w?{color:!0,date:!0,"datetime-local":!0,email:!0,month:!0,number:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0,textarea:!0,select:!0,password:!0}:!1===w?{password:!0}:w,maskTextFn:E,maskInputFn:M,slimDOMOptions:!0===N||"all"===N?{script:!0,comment:!0,headFavicon:!0,headWhitespace:!0,headMetaDescKeywords:"all"===N,headMetaSocial:!0,headMetaRobots:!0,headMetaHttpEquiv:!0,headMetaAuthorship:!0,headMetaVerification:!0}:!1===N?{}:N,dataURLOptions:P,inlineImages:_,recordCanvas:b,preserveWhiteSpace:L,onSerialize:j,onIframeLoad:D,iframeLoadTimeout:F,onStylesheetLoad:U,stylesheetLoadTimeout:B,keepIframeSrcFn:H,newlyAddedElement:!1})}(document,{mirror:uf,blockClass:p,blockSelector:f,maskTextClass:_,maskTextSelector:b,inlineStylesheet:w,maskAllInputs:fe,maskTextFn:L,maskInputFn:P,slimDOM:ge,dataURLOptions:U,recordCanvas:z,inlineImages:Y,onSerialize:l=>{Me(l,uf)&&Ne.addIframe(l),Re(l,uf)&&Oe.trackLinkElement(l),Ae(l)&&Ue.addShadowRoot(pe_shadowRoot(l),document)},onIframeLoad:(l,c)=>{Ne.attachIframe(l,c),Ue.observeAttachShadow(l)},onStylesheetLoad:(l,c)=>{Oe.attachLinkElement(l,c)},keepIframeSrcFn:ne});if(!c)return console.warn("Failed to snapshot the document");Yp({type:gp.FullSnapshot,data:{node:c,initialOffset:Se(window)}},l),Cp.forEach((l=>l.unlock())),document.adoptedStyleSheets&&document.adoptedStyleSheets.length>0&&Oe.adoptStyleSheets(document.adoptedStyleSheets,uf.getId(document))}};try{var Be=[],K3=l=>{var c;return Ke(lt)({mutationCb:V2,mousemoveCb:(l,c)=>Yp({type:gp.IncrementalSnapshot,data:{source:c,positions:l}}),mouseInteractionCb:l=>Yp({type:gp.IncrementalSnapshot,data:r$2({source:vp.MouseInteraction},l)}),scrollCb:W2,viewportResizeCb:l=>Yp({type:gp.IncrementalSnapshot,data:r$2({source:vp.ViewportResize},l)}),inputCb:l=>Yp({type:gp.IncrementalSnapshot,data:r$2({source:vp.Input},l)}),mediaInteractionCb:l=>Yp({type:gp.IncrementalSnapshot,data:r$2({source:vp.MediaInteraction},l)}),styleSheetRuleCb:l=>Yp({type:gp.IncrementalSnapshot,data:r$2({source:vp.StyleSheetRule},l)}),styleDeclarationCb:l=>Yp({type:gp.IncrementalSnapshot,data:r$2({source:vp.StyleDeclaration},l)}),canvasMutationCb:U2,fontCb:l=>Yp({type:gp.IncrementalSnapshot,data:r$2({source:vp.Font},l)}),selectionCb:l=>{Yp({type:gp.IncrementalSnapshot,data:r$2({source:vp.Selection},l)})},customElementCb:l=>{Yp({type:gp.IncrementalSnapshot,data:r$2({source:vp.CustomElement},l)})},blockClass:p,ignoreClass:m,ignoreSelector:y,maskTextClass:_,maskTextSelector:b,maskInputOptions:fe,inlineStylesheet:w,sampling:F,recordDOM:H,recordCanvas:z,inlineImages:Y,userTriggeredOnInput:Z,collectFonts:K,doc:l,maskInputFn:P,maskTextFn:L,keepIframeSrcFn:ne,blockSelector:f,slimDOMOptions:ge,dataURLOptions:U,mirror:uf,iframeManager:Ne,stylesheetManager:Oe,shadowDomManager:Ue,processedNodeManager:Fe,canvasManager:Xp,ignoreCSSAttributes:se,plugins:(null==(c=null==ee?void 0:ee.filter((l=>l.observer)))?void 0:c.map((l=>({observer:l.observer,options:l.options,callback:c=>Yp({type:gp.Plugin,data:{plugin:l.name,payload:c}})}))))||[]},j)};Ne.addLoadListener((l=>{try{Be.push(K3(l.contentDocument))}catch(c){console.warn(c)}}));var J2=()=>{Qp(),Be.push(K3(document)),of=!0};return"interactive"===document.readyState||"complete"===document.readyState?J2():(Be.push(ve("DOMContentLoaded",(()=>{Yp({type:gp.DomContentLoaded,data:{}}),"DOMContentLoaded"===V&&J2()}))),Be.push(ve("load",(()=>{Yp({type:gp.Load,data:{}}),"load"===V&&J2()}),window))),()=>{Be.forEach((l=>l())),Fe.destroy(),of=!1,kp=void 0}}catch(pe){console.warn(pe)}}qt.addCustomEvent=(l,c)=>{if(!of)throw new Error("please add custom event after start recording");Yp({type:gp.Custom,data:{tag:l,payload:c}})},qt.freezePage=()=>{Cp.forEach((l=>l.freeze()))},qt.takeFullSnapshot=l=>{if(!of)throw new Error("please take full snapshot after start recording");Qp(l)},qt.mirror=uf,(cf=lf||(lf={}))[cf.NotStarted=0]="NotStarted",cf[cf.Running=1]="Running",cf[cf.Stopped=2]="Stopped";var df,hf=Object.defineProperty,$t=(l,c,d)=>{return f=d,(p="symbol"!=typeof c?c+"":c)in(h=l)?hf(h,p,{enumerable:!0,configurable:!0,writable:!0,value:f}):h[p]=f;var h,p,f},pf=Object.defineProperty,Ut=(l,c,d)=>{return f=d,(p="symbol"!=typeof c?c+"":c)in(h=l)?pf(h,p,{enumerable:!0,configurable:!0,writable:!0,value:f}):h[p]=f;var h,p,f},ff=Object.defineProperty,zt=(l,c,d)=>{return f=d,(p="symbol"!=typeof c?c+"":c)in(h=l)?ff(h,p,{enumerable:!0,configurable:!0,writable:!0,value:f}):h[p]=f;var h,p,f},mf={Node:["childNodes","parentNode","parentElement","textContent"],ShadowRoot:["host","styleSheets"],Element:["shadowRoot","querySelector","querySelectorAll"],MutationObserver:[]},gf={Node:["contains","getRootNode"],ShadowRoot:["getSelection"],Element:[],MutationObserver:["constructor"]},vf={};function Xt(l){if(vf[l])return vf[l];var c=globalThis[l],d=c.prototype,h=l in mf?mf[l]:void 0,p=Boolean(h&&h.every((l=>{var c,h;return Boolean(null==(h=null==(c=Object.getOwnPropertyDescriptor(d,l))?void 0:c.get)?void 0:h.toString().includes("[native code]"))}))),f=l in gf?gf[l]:void 0,m=Boolean(f&&f.every((l=>{var c;return"function"==typeof d[l]&&(null==(c=d[l])?void 0:c.toString().includes("[native code]"))})));if(p&&m)return vf[l]=c.prototype,c.prototype;try{var y=document.createElement("iframe");document.body.appendChild(y);var _=y.contentWindow;if(!_)return c.prototype;var b=_[l].prototype;return document.body.removeChild(y),b?vf[l]=b:d}catch(w){return d}}var yf={};function Jt(l,c,d){var h,p=l+"."+String(d);if(yf[p])return yf[p].call(c);var f=Xt(l),m=null==(h=Object.getOwnPropertyDescriptor(f,d))?void 0:h.get;return m?(yf[p]=m,m.call(c)):c[d]}var tr_parentNode=function(l){return Jt("Node",l,"parentNode")},tr_host=function(l){return l&&"host"in l?Jt("ShadowRoot",l,"host"):null},tr_shadowRoot=function(l){return l&&"shadowRoot"in l?Jt("Element",l,"shadowRoot"):null};function ir(l,c,d){if(!l)return!1;if(l.nodeType!==l.ELEMENT_NODE)return!!d&&ir(tr_parentNode(l),c,d);for(var h=l.classList.length;h--;){var p=l.classList[h];if(c.test(p))return!0}return!!d&&ir(tr_parentNode(l),c,d)}class nr{constructor(){__publicField22(this,"parentElement",null),__publicField22(this,"parentNode",null),__publicField22(this,"ownerDocument"),__publicField22(this,"firstChild",null),__publicField22(this,"lastChild",null),__publicField22(this,"previousSibling",null),__publicField22(this,"nextSibling",null),__publicField22(this,"ELEMENT_NODE",1),__publicField22(this,"TEXT_NODE",3),__publicField22(this,"nodeType"),__publicField22(this,"nodeName"),__publicField22(this,"RRNodeType")}get childNodes(){for(var l=[],c=this.firstChild;c;)l.push(c),c=c.nextSibling;return l}contains(l){if(!(l instanceof nr))return!1;if(l.ownerDocument!==this.ownerDocument)return!1;if(l===this)return!0;for(;l.parentNode;){if(l.parentNode===this)return!0;l=l.parentNode}return!1}appendChild(l){throw new Error("RRDomException: Failed to execute 'appendChild' on 'RRNode': This RRNode type does not support this method.")}insertBefore(l,c){throw new Error("RRDomException: Failed to execute 'insertBefore' on 'RRNode': This RRNode type does not support this method.")}removeChild(l){throw new Error("RRDomException: Failed to execute 'removeChild' on 'RRNode': This RRNode type does not support this method.")}toString(){return"RRNode"}}var _f={Node:["childNodes","parentNode","parentElement","textContent"],ShadowRoot:["host","styleSheets"],Element:["shadowRoot","querySelector","querySelectorAll"],MutationObserver:[]},bf={Node:["contains","getRootNode"],ShadowRoot:["getSelection"],Element:[],MutationObserver:["constructor"]},wf={};function lr(l){if(wf[l])return wf[l];var c=globalThis[l],d=c.prototype,h=l in _f?_f[l]:void 0,p=Boolean(h&&h.every((l=>{var c,h;return Boolean(null==(h=null==(c=Object.getOwnPropertyDescriptor(d,l))?void 0:c.get)?void 0:h.toString().includes("[native code]"))}))),f=l in bf?bf[l]:void 0,m=Boolean(f&&f.every((l=>{var c;return"function"==typeof d[l]&&(null==(c=d[l])?void 0:c.toString().includes("[native code]"))})));if(p&&m)return wf[l]=c.prototype,c.prototype;try{var y=document.createElement("iframe");document.body.appendChild(y);var _=y.contentWindow;if(!_)return c.prototype;var b=_[l].prototype;return document.body.removeChild(y),b?wf[l]=b:d}catch(w){return d}}var Sf={};function cr(l,c,d){var h,p=l+"."+String(d);if(Sf[p])return Sf[p].call(c);var f=lr(l),m=null==(h=Object.getOwnPropertyDescriptor(f,d))?void 0:h.get;return m?(Sf[p]=m,m.call(c)):c[d]}var xf={};function hr(l,c,d){var h=l+"."+String(d);if(xf[h])return xf[h].bind(c);var p=lr(l)[d];return"function"!=typeof p?c[d]:(xf[h]=p,p.bind(c))}var pr_parentNode=function(l){return cr("Node",l,"parentNode")},pr_parentElement=function(l){return cr("Node",l,"parentElement")},pr_contains=function(l,c){return hr("Node",l,"contains")(c)},pr_getRootNode=function(l){return hr("Node",l,"getRootNode")()},pr_host=function(l){return l&&"host"in l?cr("ShadowRoot",l,"host"):null},pr_shadowRoot=function(l){return l&&"shadowRoot"in l?cr("Element",l,"shadowRoot"):null},kf="Please stop import mirror directly. Instead of that,\r\nnow you can use replayer.getMirror() to access the mirror instance of a replayer,\r\nor you can use record.mirror to access the mirror instance during recording.",Cf={map:{},getId:()=>(console.error(kf),-1),getNode:()=>(console.error(kf),null),removeNodeFromMap(){console.error(kf)},has:()=>(console.error(kf),!1),reset(){console.error(kf)}};"undefined"!=typeof window&&window.Proxy&&window.Reflect&&(Cf=new Proxy(Cf,{get:(l,c,d)=>("map"===c&&console.error(kf),Reflect.get(l,c,d))}));var Ef,If=Date.now;function _r(l){return l?l.nodeType===l.ELEMENT_NODE?l:pr_parentElement(l):null}function mr(l){var c,d=null;return"getRootNode"in l&&(null==(c=pr_getRootNode(l))?void 0:c.nodeType)===Node.DOCUMENT_FRAGMENT_NODE&&pr_host(pr_getRootNode(l))&&(d=pr_host(pr_getRootNode(l))),d}function yr(l){for(var c,d=l;c=mr(d);)d=c;return d}function br(l){var c=l.ownerDocument;if(!c)return!1;var d=yr(l);return pr_contains(c,d)}/[1-9][0-9]{12}/.test(Date.now().toString())||(If=()=>(new Date).getTime());for(var Tf=Object.freeze(Object.defineProperty({__proto__:null,StyleSheetMirror:class{constructor(){Ut(this,"id",1),Ut(this,"styleIDMap",new WeakMap),Ut(this,"idStyleMap",new Map)}getId(l){var c;return null!==(c=this.styleIDMap.get(l))&&void 0!==c?c:-1}has(l){return this.styleIDMap.has(l)}add(l,c){return this.has(l)?this.getId(l):(d=void 0===c?this.id++:c,this.styleIDMap.set(l,d),this.idStyleMap.set(d,l),d);var d}getStyle(l){return this.idStyleMap.get(l)||null}reset(){this.styleIDMap=new WeakMap,this.idStyleMap=new Map,this.id=1}generateId(){return this.id++}},get _mirror(){return Cf},closestElementOfNode:_r,getBaseDimension:function e3(l,c){var d,h,p=null==(h=null==(d=l.ownerDocument)?void 0:d.defaultView)?void 0:h.frameElement;if(!p||p===c)return{x:0,y:0,relativeScale:1,absoluteScale:1};var f=p.getBoundingClientRect(),m=e3(p,c),y=f.height/p.clientHeight;return{x:f.x*m.relativeScale+m.x,y:f.y*m.relativeScale+m.y,relativeScale:y,absoluteScale:m.absoluteScale*y}},getNestedRule:function e3(l,c){var d=l[c[0]];return 1===c.length?d:e3(d.cssRules[c[1]].cssRules,c.slice(2))},getPositionsAndIndex:function(l){var c=[...l],d=c.pop();return{positions:c,index:d}},getRootShadowHost:yr,getShadowHost:mr,getWindowHeight:function(){return window.innerHeight||document.documentElement&&document.documentElement.clientHeight||document.body&&document.body.clientHeight},getWindowScroll:function(l){var c,d,h,p,f=l.document;return{left:f.scrollingElement?f.scrollingElement.scrollLeft:void 0!==l.pageXOffset?l.pageXOffset:f.documentElement.scrollLeft||(null==f?void 0:f.body)&&(null==(c=pr_parentElement(f.body))?void 0:c.scrollLeft)||(null==(d=null==f?void 0:f.body)?void 0:d.scrollLeft)||0,top:f.scrollingElement?f.scrollingElement.scrollTop:void 0!==l.pageYOffset?l.pageYOffset:(null==f?void 0:f.documentElement.scrollTop)||(null==f?void 0:f.body)&&(null==(h=pr_parentElement(f.body))?void 0:h.scrollTop)||(null==(p=null==f?void 0:f.body)?void 0:p.scrollTop)||0}},getWindowWidth:function(){return window.innerWidth||document.documentElement&&document.documentElement.clientWidth||document.body&&document.body.clientWidth},hasShadowRoot:function(l){return!!l&&(l instanceof nr&&"shadowRoot"in l?Boolean(l.shadowRoot):Boolean(pr_shadowRoot(l)))},hookSetter:function e3(l,c,d,h,p){void 0===p&&(p=window);var f=p.Object.getOwnPropertyDescriptor(l,c);return p.Object.defineProperty(l,c,h?d:{set(l){setTimeout((()=>{d.set.call(this,l)}),0),f&&f.set&&f.set.call(this,l)}}),()=>e3(l,c,f||{},!0)},inDom:function(l){var c=l.ownerDocument;return!!c&&(pr_contains(c,l)||br(l))},isAncestorRemoved:function e3(l,c){if(h=(d=l)&&"host"in d&&"mode"in d&&tr_host(d)||null,Boolean(h&&"shadowRoot"in h&&tr_shadowRoot(h)===d))return!1;var d,h,p=c.getId(l);if(!c.has(p))return!0;var f=pr_parentNode(l);return(!f||f.nodeType!==l.DOCUMENT_NODE)&&(!f||e3(f,c))},isBlocked:function(l,c,d,h){if(!l)return!1;var p=_r(l);if(!p)return!1;try{if("string"==typeof c){if(p.classList.contains(c))return!0;if(h&&null!==p.closest("."+c))return!0}else if(ir(p,c,h))return!0}catch(f){}if(d){if(p.matches(d))return!0;if(h&&null!==p.closest(d))return!0}return!1},isIgnored:function(l,c,d){return!("TITLE"!==l.tagName||!d.headTitleMutations)||-2===c.getId(l)},isSerialized:function(l,c){return-1!==c.getId(l)},isSerializedIframe:function(l,c){return Boolean("IFRAME"===l.nodeName&&c.getMeta(l))},isSerializedStylesheet:function(l,c){return Boolean("LINK"===l.nodeName&&l.nodeType===l.ELEMENT_NODE&&l.getAttribute&&"stylesheet"===l.getAttribute("rel")&&c.getMeta(l))},iterateResolveTree:function e3(l,c){c(l.value);for(var d=l.children.length-1;d>=0;d--)e3(l.children[d],c)},legacy_isTouchEvent:function(l){return Boolean(l.changedTouches)},get nowTimestamp(){return If},on:function(l,c,d){void 0===d&&(d=document);var h={capture:!0,passive:!0};return d.addEventListener(l,c,h),()=>d.removeEventListener(l,c,h)},patch:function(l,c,d){try{if(!(c in l))return()=>{};var h=l[c],p=d(h);return"function"==typeof p&&(p.prototype=p.prototype||{},Object.defineProperties(p,{__rrweb_original__:{enumerable:!1,value:h}})),l[c]=p,()=>{l[c]=h}}catch(f){return()=>{}}},polyfill:function(l){void 0===l&&(l=window),"NodeList"in l&&!l.NodeList.prototype.forEach&&(l.NodeList.prototype.forEach=Array.prototype.forEach),"DOMTokenList"in l&&!l.DOMTokenList.prototype.forEach&&(l.DOMTokenList.prototype.forEach=Array.prototype.forEach)},queueToResolveTrees:function(l){var c={},r2=(l,d)=>{var h={value:l,parent:d,children:[]};return c[l.node.id]=h,h},d=[];for(var h of l){var{nextId:p,parentId:f}=h;if(p&&p in c){var m=c[p];if(m.parent){var y=m.parent.children.indexOf(m);m.parent.children.splice(y,0,r2(h,m.parent))}else{var _=d.indexOf(m);d.splice(_,0,r2(h,null))}}else if(f in c){var b=c[f];b.children.push(r2(h,b))}else d.push(r2(h,null))}return d},shadowHostInDom:br,throttle:function(l,c,d){void 0===d&&(d={});var h=null,p=0;return function(){for(var f=arguments.length,m=new Array(f),y=0;y<f;y++)m[y]=arguments[y];var _=Date.now();p||!1!==d.leading||(p=_);var b=c-(_-p),w=this;b<=0||b>c?(h&&(clearTimeout(h),h=null),p=_,l.apply(w,m)):h||!1===d.trailing||(h=setTimeout((()=>{p=!1===d.leading?0:Date.now(),h=null,l.apply(w,m)}),b))}},uniqueTextMutations:function(l){for(var c=new Set,d=[],h=l.length;h--;){var p=l[h];c.has(p.id)||(d.push(p),c.add(p.id))}return d}},Symbol.toStringTag,{value:"Module"})),Rf="undefined"==typeof Uint8Array?[]:new Uint8Array(256),Af=0;Af<64;Af++)Rf["ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/".charCodeAt(Af)]=Af;"undefined"!=typeof window&&window.Blob&&new Blob([Uint8Array.from(atob("KGZ1bmN0aW9uKCkgewogICJ1c2Ugc3RyaWN0IjsKICB2YXIgY2hhcnMgPSAiQUJDREVGR0hJSktMTU5PUFFSU1RVVldYWVphYmNkZWZnaGlqa2xtbm9wcXJzdHV2d3h5ejAxMjM0NTY3ODkrLyI7CiAgdmFyIGxvb2t1cCA9IHR5cGVvZiBVaW50OEFycmF5ID09PSAidW5kZWZpbmVkIiA/IFtdIDogbmV3IFVpbnQ4QXJyYXkoMjU2KTsKICBmb3IgKHZhciBpID0gMDsgaSA8IGNoYXJzLmxlbmd0aDsgaSsrKSB7CiAgICBsb29rdXBbY2hhcnMuY2hhckNvZGVBdChpKV0gPSBpOwogIH0KICB2YXIgZW5jb2RlID0gZnVuY3Rpb24oYXJyYXlidWZmZXIpIHsKICAgIHZhciBieXRlcyA9IG5ldyBVaW50OEFycmF5KGFycmF5YnVmZmVyKSwgaTIsIGxlbiA9IGJ5dGVzLmxlbmd0aCwgYmFzZTY0ID0gIiI7CiAgICBmb3IgKGkyID0gMDsgaTIgPCBsZW47IGkyICs9IDMpIHsKICAgICAgYmFzZTY0ICs9IGNoYXJzW2J5dGVzW2kyXSA+PiAyXTsKICAgICAgYmFzZTY0ICs9IGNoYXJzWyhieXRlc1tpMl0gJiAzKSA8PCA0IHwgYnl0ZXNbaTIgKyAxXSA+PiA0XTsKICAgICAgYmFzZTY0ICs9IGNoYXJzWyhieXRlc1tpMiArIDFdICYgMTUpIDw8IDIgfCBieXRlc1tpMiArIDJdID4+IDZdOwogICAgICBiYXNlNjQgKz0gY2hhcnNbYnl0ZXNbaTIgKyAyXSAmIDYzXTsKICAgIH0KICAgIGlmIChsZW4gJSAzID09PSAyKSB7CiAgICAgIGJhc2U2NCA9IGJhc2U2NC5zdWJzdHJpbmcoMCwgYmFzZTY0Lmxlbmd0aCAtIDEpICsgIj0iOwogICAgfSBlbHNlIGlmIChsZW4gJSAzID09PSAxKSB7CiAgICAgIGJhc2U2NCA9IGJhc2U2NC5zdWJzdHJpbmcoMCwgYmFzZTY0Lmxlbmd0aCAtIDIpICsgIj09IjsKICAgIH0KICAgIHJldHVybiBiYXNlNjQ7CiAgfTsKICBjb25zdCBsYXN0QmxvYk1hcCA9IC8qIEBfX1BVUkVfXyAqLyBuZXcgTWFwKCk7CiAgY29uc3QgdHJhbnNwYXJlbnRCbG9iTWFwID0gLyogQF9fUFVSRV9fICovIG5ldyBNYXAoKTsKICBhc3luYyBmdW5jdGlvbiBnZXRUcmFuc3BhcmVudEJsb2JGb3Iod2lkdGgsIGhlaWdodCwgZGF0YVVSTE9wdGlvbnMpIHsKICAgIGNvbnN0IGlkID0gYCR7d2lkdGh9LSR7aGVpZ2h0fWA7CiAgICBpZiAoIk9mZnNjcmVlbkNhbnZhcyIgaW4gZ2xvYmFsVGhpcykgewogICAgICBpZiAodHJhbnNwYXJlbnRCbG9iTWFwLmhhcyhpZCkpIHJldHVybiB0cmFuc3BhcmVudEJsb2JNYXAuZ2V0KGlkKTsKICAgICAgY29uc3Qgb2Zmc2NyZWVuID0gbmV3IE9mZnNjcmVlbkNhbnZhcyh3aWR0aCwgaGVpZ2h0KTsKICAgICAgb2Zmc2NyZWVuLmdldENvbnRleHQoIjJkIik7CiAgICAgIGNvbnN0IGJsb2IgPSBhd2FpdCBvZmZzY3JlZW4uY29udmVydFRvQmxvYihkYXRhVVJMT3B0aW9ucyk7CiAgICAgIGNvbnN0IGFycmF5QnVmZmVyID0gYXdhaXQgYmxvYi5hcnJheUJ1ZmZlcigpOwogICAgICBjb25zdCBiYXNlNjQgPSBlbmNvZGUoYXJyYXlCdWZmZXIpOwogICAgICB0cmFuc3BhcmVudEJsb2JNYXAuc2V0KGlkLCBiYXNlNjQpOwogICAgICByZXR1cm4gYmFzZTY0OwogICAgfSBlbHNlIHsKICAgICAgcmV0dXJuICIiOwogICAgfQogIH0KICBjb25zdCB3b3JrZXIgPSBzZWxmOwogIHdvcmtlci5vbm1lc3NhZ2UgPSBhc3luYyBmdW5jdGlvbihlKSB7CiAgICBpZiAoIk9mZnNjcmVlbkNhbnZhcyIgaW4gZ2xvYmFsVGhpcykgewogICAgICBjb25zdCB7IGlkLCBiaXRtYXAsIHdpZHRoLCBoZWlnaHQsIGRhdGFVUkxPcHRpb25zIH0gPSBlLmRhdGE7CiAgICAgIGNvbnN0IHRyYW5zcGFyZW50QmFzZTY0ID0gZ2V0VHJhbnNwYXJlbnRCbG9iRm9yKAogICAgICAgIHdpZHRoLAogICAgICAgIGhlaWdodCwKICAgICAgICBkYXRhVVJMT3B0aW9ucwogICAgICApOwogICAgICBjb25zdCBvZmZzY3JlZW4gPSBuZXcgT2Zmc2NyZWVuQ2FudmFzKHdpZHRoLCBoZWlnaHQpOwogICAgICBjb25zdCBjdHggPSBvZmZzY3JlZW4uZ2V0Q29udGV4dCgiMmQiKTsKICAgICAgY3R4LmRyYXdJbWFnZShiaXRtYXAsIDAsIDApOwogICAgICBiaXRtYXAuY2xvc2UoKTsKICAgICAgY29uc3QgYmxvYiA9IGF3YWl0IG9mZnNjcmVlbi5jb252ZXJ0VG9CbG9iKGRhdGFVUkxPcHRpb25zKTsKICAgICAgY29uc3QgdHlwZSA9IGJsb2IudHlwZTsKICAgICAgY29uc3QgYXJyYXlCdWZmZXIgPSBhd2FpdCBibG9iLmFycmF5QnVmZmVyKCk7CiAgICAgIGNvbnN0IGJhc2U2NCA9IGVuY29kZShhcnJheUJ1ZmZlcik7CiAgICAgIGlmICghbGFzdEJsb2JNYXAuaGFzKGlkKSAmJiBhd2FpdCB0cmFuc3BhcmVudEJhc2U2NCA9PT0gYmFzZTY0KSB7CiAgICAgICAgbGFzdEJsb2JNYXAuc2V0KGlkLCBiYXNlNjQpOwogICAgICAgIHJldHVybiB3b3JrZXIucG9zdE1lc3NhZ2UoeyBpZCB9KTsKICAgICAgfQogICAgICBpZiAobGFzdEJsb2JNYXAuZ2V0KGlkKSA9PT0gYmFzZTY0KSByZXR1cm4gd29ya2VyLnBvc3RNZXNzYWdlKHsgaWQgfSk7CiAgICAgIHdvcmtlci5wb3N0TWVzc2FnZSh7CiAgICAgICAgaWQsCiAgICAgICAgdHlwZSwKICAgICAgICBiYXNlNjQsCiAgICAgICAgd2lkdGgsCiAgICAgICAgaGVpZ2h0CiAgICAgIH0pOwogICAgICBsYXN0QmxvYk1hcC5zZXQoaWQsIGJhc2U2NCk7CiAgICB9IGVsc2UgewogICAgICByZXR1cm4gd29ya2VyLnBvc3RNZXNzYWdlKHsgaWQ6IGUuZGF0YS5pZCB9KTsKICAgIH0KICB9Owp9KSgpOwovLyMgc291cmNlTWFwcGluZ1VSTD1pbWFnZS1iaXRtYXAtZGF0YS11cmwtd29ya2VyLUlKcEM3Z19iLmpzLm1hcAo="),(l=>l.charCodeAt(0)))],{type:"text/javascript;charset=utf-8"});try{if(2!==Array.from([1],(l=>2*l))[0]){var Of=document.createElement("iframe");document.body.appendChild(Of),Array.from=(null==(df=Of.contentWindow)?void 0:df.Array.from)||Array.from,document.body.removeChild(Of)}}catch(hh){console.debug("Unable to override Array.from",hh)}new class{constructor(){zt(this,"idNodeMap",new Map),zt(this,"nodeMetaMap",new WeakMap)}getId(l){var c;if(!l)return-1;var d=null==(c=this.getMeta(l))?void 0:c.id;return null!=d?d:-1}getNode(l){return this.idNodeMap.get(l)||null}getIds(){return Array.from(this.idNodeMap.keys())}getMeta(l){return this.nodeMetaMap.get(l)||null}removeNodeFromMap(l){var c=this.getId(l);this.idNodeMap.delete(c),l.childNodes&&l.childNodes.forEach((l=>this.removeNodeFromMap(l)))}has(l){return this.idNodeMap.has(l)}hasNode(l){return this.nodeMetaMap.has(l)}add(l,c){var d=c.id;this.idNodeMap.set(d,l),this.nodeMetaMap.set(l,c)}replace(l,c){var d=this.getNode(l);if(d){var h=this.nodeMetaMap.get(d);h&&this.nodeMetaMap.set(c,h)}this.idNodeMap.set(l,c)}reset(){this.idNodeMap=new Map,this.nodeMetaMap=new WeakMap}},function(l){l[l.NotStarted=0]="NotStarted",l[l.Running=1]="Running",l[l.Stopped=2]="Stopped"}(Ef||(Ef={}));class xr{constructor(l){$t(this,"fileName"),$t(this,"functionName"),$t(this,"lineNumber"),$t(this,"columnNumber"),this.fileName=l.fileName||"",this.functionName=l.functionName||"",this.lineNumber=l.lineNumber,this.columnNumber=l.columnNumber}toString(){var l=this.lineNumber||"",c=this.columnNumber||"";return this.functionName?this.functionName+" ("+this.fileName+":"+l+":"+c+")":this.fileName+":"+l+":"+c}}var Mf=/(^|@)\S+:\d+/,Nf=/^\s*at .*(\S+:\d+|\(native\))/m,Pf=/^(eval@)?(\[native code])?$/,Lf={parse:function(l){return l?void 0!==l.stacktrace||void 0!==l["opera#sourceloc"]?this.parseOpera(l):l.stack&&l.stack.match(Nf)?this.parseV8OrIE(l):l.stack?this.parseFFOrSafari(l):(console.warn("[console-record-plugin]: Failed to parse error object:",l),[]):[]},extractLocation:function(l){if(-1===l.indexOf(":"))return[l];var c=/(.+?)(?::(\d+))?(?::(\d+))?$/.exec(l.replace(/[()]/g,""));if(!c)throw new Error("Cannot parse given url: "+l);return[c[1],c[2]||void 0,c[3]||void 0]},parseV8OrIE:function(l){return l.stack.split("\n").filter((function(l){return!!l.match(Nf)}),this).map((function(l){l.indexOf("(eval ")>-1&&(l=l.replace(/eval code/g,"eval").replace(/(\(eval at [^()]*)|(\),.*$)/g,""));var c=l.replace(/^\s+/,"").replace(/\(eval code/g,"("),d=c.match(/ (\((.+):(\d+):(\d+)\)$)/),h=(c=d?c.replace(d[0],""):c).split(/\s+/).slice(1),p=this.extractLocation(d?d[1]:h.pop()),f=h.join(" ")||void 0,m=["eval","<anonymous>"].indexOf(p[0])>-1?void 0:p[0];return new xr({functionName:f,fileName:m,lineNumber:p[1],columnNumber:p[2]})}),this)},parseFFOrSafari:function(l){return l.stack.split("\n").filter((function(l){return!l.match(Pf)}),this).map((function(l){if(l.indexOf(" > eval")>-1&&(l=l.replace(/ line (\d+)(?: > eval line \d+)* > eval:\d+:\d+/g,":$1")),-1===l.indexOf("@")&&-1===l.indexOf(":"))return new xr({functionName:l});var c=/((.*".+"[^@]*)?[^@]*)(?:@)/,d=l.match(c),h=d&&d[1]?d[1]:void 0,p=this.extractLocation(l.replace(c,""));return new xr({functionName:h,fileName:p[0],lineNumber:p[1],columnNumber:p[2]})}),this)},parseOpera:function(l){return!l.stacktrace||l.message.indexOf("\n")>-1&&l.message.split("\n").length>l.stacktrace.split("\n").length?this.parseOpera9(l):l.stack?this.parseOpera11(l):this.parseOpera10(l)},parseOpera9:function(l){for(var c=/Line (\d+).*script (?:in )?(\S+)/i,d=l.message.split("\n"),h=[],p=2,f=d.length;p<f;p+=2){var m=c.exec(d[p]);m&&h.push(new xr({fileName:m[2],lineNumber:parseFloat(m[1])}))}return h},parseOpera10:function(l){for(var c=/Line (\d+).*script (?:in )?(\S+)(?:: In function (\S+))?$/i,d=l.stacktrace.split("\n"),h=[],p=0,f=d.length;p<f;p+=2){var m=c.exec(d[p]);m&&h.push(new xr({functionName:m[3]||void 0,fileName:m[2],lineNumber:parseFloat(m[1])}))}return h},parseOpera11:function(l){return l.stack.split("\n").filter((function(l){return!!l.match(Mf)&&!l.match(/^Error created at/)}),this).map((function(l){var c=l.split("@"),d=this.extractLocation(c.pop()),h=(c.shift()||"").replace(/<anonymous function(: (\w+))?>/,"$2").replace(/\([^)]*\)/g,"")||void 0;return new xr({functionName:h,fileName:d[0],lineNumber:d[1],columnNumber:d[2]})}),this)}};function Nr(l){if(!l||!l.outerHTML)return"";for(var c="";l.parentElement;){var d=l.localName;if(!d)break;d=d.toLowerCase();var h=l.parentElement,p=[];if(h.children&&h.children.length>0)for(var f=0;f<h.children.length;f++){var m=h.children[f];m.localName&&m.localName.toLowerCase&&m.localName.toLowerCase()===d&&p.push(m)}p.length>1&&(d+=":eq("+p.indexOf(l)+")"),c=d+(c?">"+c:""),l=h}return c}function Pr(l){return"[object Object]"===Object.prototype.toString.call(l)}function Fr(l,c){if(0===c)return!0;var d=Object.keys(l);for(var h of d)if(Pr(l[h])&&Fr(l[h],c-1))return!0;return!1}function Lr(l,c){var d={numOfKeysLimit:50,depthOfLimit:4};Object.assign(d,c);var h=[],p=[];return JSON.stringify(l,(function(l,c){if(h.length>0){var f=h.indexOf(this);~f?h.splice(f+1):h.push(this),~f?p.splice(f,1/0,l):p.push(l),~h.indexOf(c)&&(c=h[0]===c?"[Circular ~]":"[Circular ~."+p.slice(0,h.indexOf(c)).join(".")+"]")}else h.push(c);if(null===c)return c;if(void 0===c)return"undefined";if(Pr(m=c)&&Object.keys(m).length>d.numOfKeysLimit||"function"==typeof m||Pr(m)&&Fr(m,d.depthOfLimit))return function(l){var c=l.toString();return d.stringLengthLimit&&c.length>d.stringLengthLimit&&(c=c.slice(0,d.stringLengthLimit)+"..."),c}(c);var m;if("bigint"==typeof c)return c.toString()+"n";if(c instanceof Event){var y={};for(var _ in c){var b=c[_];Array.isArray(b)?y[_]=Nr(b.length?b[0]:null):y[_]=b}return y}return c instanceof Node?c instanceof HTMLElement?c?c.outerHTML:"":c.nodeName:c instanceof Error?c.stack?c.stack+"\nEnd of stack for Error object":c.name+": "+c.message:c}))}var jf={level:["assert","clear","count","countReset","debug","dir","dirxml","error","group","groupCollapsed","groupEnd","info","log","table","time","timeEnd","timeLog","trace","warn"],lengthThreshold:1e3,logger:"console"};function Dr(l,c,d){var h,p=d?Object.assign({},jf,d):jf,f=p.logger;if(!f)return()=>{};h="string"==typeof f?c[f]:f;var m=0,y=!1,_=[];if(p.level.includes("error")){var u2=c=>{var d=c.message,h=c.error,f=Lf.parse(h).map((l=>l.toString())),m=[Lr(d,p.stringifyOptions)];l({level:"error",trace:f,payload:m})};c.addEventListener("error",u2),_.push((()=>{c.removeEventListener("error",u2)}));var c2=c=>{var d,h;c.reason instanceof Error?h=[Lr("Uncaught (in promise) "+(d=c.reason).name+": "+d.message,p.stringifyOptions)]:(d=new Error,h=[Lr("Uncaught (in promise)",p.stringifyOptions),Lr(c.reason,p.stringifyOptions)]);var f=Lf.parse(d).map((l=>l.toString()));l({level:"error",trace:f,payload:h})};c.addEventListener("unhandledrejection",c2),_.push((()=>{c.removeEventListener("unhandledrejection",c2)}))}for(var b of p.level)_.push(h2(h,b));return()=>{_.forEach((l=>l()))};function h2(c,d){var h=this;return c[d]?Tf.patch(c,d,(c=>function(){for(var f=arguments.length,_=new Array(f),b=0;b<f;b++)_[b]=arguments[b];if(c.apply(h,_),!("assert"===d&&_[0]||y)){y=!0;try{var w=Lf.parse(new Error).map((l=>l.toString())).splice(1),E=("assert"===d?_.slice(1):_).map((l=>Lr(l,p.stringifyOptions)));++m<p.lengthThreshold?l({level:d,trace:w,payload:E}):m===p.lengthThreshold&&l({level:"warn",trace:[],payload:[Lr("The number of log records reached the threshold.")]})}catch(M){c("rrweb logger error:",M,..._)}finally{y=!1}}})):()=>{}}}var Hr=l=>({name:"rrweb/console@1",observer:Dr,options:l}),Df=["amazonbot","amazonproductbot","app.hypefactors.com","applebot","archive.org_bot","awariobot","backlinksextendedbot","baiduspider","bingbot","bingpreview","chrome-lighthouse","dataforseobot","deepscan","duckduckbot","facebookexternal","facebookcatalog","http://yandex.com/bots","hubspot","ia_archiver","leikibot","linkedinbot","meta-externalagent","mj12bot","msnbot","nessus","petalbot","pinterest","prerender","rogerbot","screaming frog","sebot-wa","sitebulb","slackbot","slurp","trendictionbot","turnitin","twitterbot","vercel-screenshot","vercelbot","yahoo! slurp","yandexbot","zoombot","bot.htm","bot.php","(bot;","bot/","crawler","ahrefsbot","ahrefssiteaudit","semrushbot","siteauditbot","splitsignalbot","gptbot","oai-searchbot","chatgpt-user","perplexitybot","better uptime bot","sentryuptimebot","uptimerobot","headlesschrome","cypress","google-hoteladsverifier","adsbot-google","apis-google","duplexweb-google","feedfetcher-google","google favicon","google web preview","google-read-aloud","googlebot","googleother","google-cloudvertexbot","googleweblight","mediapartners-google","storebot-google","google-inspectiontool","bytespider"],Br=function(l,c){if(void 0===c&&(c=[]),!l)return!1;var d=l.toLowerCase();return Df.concat(c).some((l=>{var c=l.toLowerCase();return-1!==d.indexOf(c)}))},Ff=["$snapshot","$pageview","$pageleave","$set","survey dismissed","survey sent","survey shown","$identify","$groupidentify","$create_alias","$$client_ingestion_warning","$web_experiment_applied","$feature_enrollment_update","$feature_flag_called"];function $r(l,c){return-1!==l.indexOf(c)}var Wr=function(l){return l.trim()},Ur=function(l){return l.replace(/^\$/,"")},$f=Array.isArray,Uf=Object.prototype,Bf=Uf.hasOwnProperty,Hf=Uf.toString,zf=$f||function(l){return"[object Array]"===Hf.call(l)},Xr=l=>"function"==typeof l,Jr=l=>l===Object(l)&&!zf(l),Qr=l=>{if(Jr(l)){for(var c in l)if(Bf.call(l,c))return!1;return!0}return!1},ei=l=>void 0===l,ti=l=>"[object String]"==Hf.call(l),ri=l=>ti(l)&&0===l.trim().length,ii=l=>null===l,ni=l=>ei(l)||ii(l),si=l=>"[object Number]"==Hf.call(l),oi=l=>"[object Boolean]"===Hf.call(l),ai=l=>l instanceof FormData,li=l=>$r(Ff,l);function ui(l){return null===l||"object"!=typeof l}function ci(l,c){return Object.prototype.toString.call(l)==="[object "+c+"]"}function di(l){return!ei(Event)&&function(l,c){try{return l instanceof c}catch(d){return!1}}(l,Event)}var qf=[!0,"true",1,"1","yes"],pi=l=>$r(qf,l),Wf=[!1,"false",0,"0","no"];function fi(l,c,d,h,p){return c>d&&(h.warn("min cannot be greater than max."),c=d),si(l)?l>d?(h.warn(" cannot be  greater than max: "+d+". Using max value instead."),d):l<c?(h.warn(" cannot be less than min: "+c+". Using min value instead."),c):l:(h.warn(" must be a number. using max or fallback. max: "+d+", fallback: "+p),fi(p||d,c,d,h))}class gi{constructor(l){this._buckets={},this._onBucketRateLimited=l._onBucketRateLimited,this._bucketSize=fi(l.bucketSize,0,100,l._logger),this._refillRate=fi(l.refillRate,0,this._bucketSize,l._logger),this._refillInterval=fi(l.refillInterval,0,864e5,l._logger)}_applyRefill(l,c){var d=c-l.lastAccess,h=Math.floor(d/this._refillInterval);if(h>0){var p=h*this._refillRate;l.tokens=Math.min(l.tokens+p,this._bucketSize),l.lastAccess=l.lastAccess+h*this._refillInterval}}consumeRateLimit(l){var c,d=Date.now(),h=String(l),p=this._buckets[h];return p?this._applyRefill(p,d):(p={tokens:this._bucketSize,lastAccess:d},this._buckets[h]=p),0===p.tokens||(p.tokens--,0===p.tokens&&(null==(c=this._onBucketRateLimited)||c.call(this,l)),0===p.tokens)}stop(){this._buckets={}}}var Vf,Zf,Gf,bi=l=>l instanceof Error;function Si(l){var c=globalThis._posthogChunkIds;if(c){var d=Object.keys(c);return Gf&&d.length===Zf||(Zf=d.length,Gf=d.reduce(((d,h)=>{Vf||(Vf={});var p=Vf[h];if(p)d[p[0]]=p[1];else for(var f=l(h),m=f.length-1;m>=0;m--){var y=f[m],_=null==y?void 0:y.filename,b=c[h];if(_&&b){d[_]=b,Vf[h]=[_,b];break}}return d}),{})),Gf}}var Kf="?";function Ci(l,c,d,h){var p={platform:"web:javascript",filename:l,function:"<anonymous>"===c?Kf:c,in_app:!0};return ei(d)||(p.lineno=d),ei(h)||(p.colno=h),p}var Ii=(l,c)=>{var d=-1!==l.indexOf("safari-extension"),h=-1!==l.indexOf("safari-web-extension");return d||h?[-1!==l.indexOf("@")?l.split("@")[0]:Kf,d?"safari-extension:"+c:"safari-web-extension:"+c]:[l,c]},Jf=/^\s*at (\S+?)(?::(\d+))(?::(\d+))\s*$/i,Yf=/^\s*at (?:(.+?\)(?: \[.+\])?|.*?) ?\((?:address at )?)?(?:async )?((?:<anonymous>|[-a-z]+:|.*bundle|\/)?.*?)(?::(\d+))?(?::(\d+))?\)?\s*$/i,Qf=/\((\S*)(?::(\d+))(?::(\d+))\)/,Ti=l=>{var c=Jf.exec(l);if(c){var[,d,h,p]=c;return Ci(d,Kf,+h,+p)}var f=Yf.exec(l);if(f){if(f[2]&&0===f[2].indexOf("eval")){var m=Qf.exec(f[2]);m&&(f[2]=m[1],f[3]=m[2],f[4]=m[3])}var[y,_]=Ii(f[1]||Kf,f[2]);return Ci(_,y,f[3]?+f[3]:void 0,f[4]?+f[4]:void 0)}},Xf=/^\s*(.*?)(?:\((.*?)\))?(?:^|@)?((?:[-a-z]+)?:\/.*?|\[native code\]|[^@]*(?:bundle|\d+\.js)|\/[\w\-. /=]+)(?::(\d+))?(?::(\d+))?\s*$/i,em=/(\S+) line (\d+)(?: > eval line \d+)* > eval/i,Ai=l=>{var c=Xf.exec(l);if(c){if(c[3]&&c[3].indexOf(" > eval")>-1){var d=em.exec(c[3]);d&&(c[1]=c[1]||"eval",c[3]=d[1],c[4]=d[2],c[5]="")}var h=c[3],p=c[1]||Kf;return[p,h]=Ii(p,h),Ci(h,p,c[4]?+c[4]:void 0,c[5]?+c[5]:void 0)}},tm=/\(error: (.*)\)/;class Li{constructor(l,c,d){void 0===l&&(l=[]),void 0===c&&(c=[]),void 0===d&&(d=[]),this.coercers=l,this.modifiers=d,this.stackParser=function(){for(var l=arguments.length,c=new Array(l),d=0;d<l;d++)c[d]=arguments[d];return function(l,d){void 0===d&&(d=0);for(var h=[],p=l.split("\n"),f=d;f<p.length;f++){var m=p[f];if(!(m.length>1024)){var y=tm.test(m)?m.replace(tm,"$1"):m;if(!y.match(/\S*Error: /)){for(var _ of c){var b=_(y);if(b){h.push(b);break}}if(h.length>=50)break}}}return function(l){if(!l.length)return[];var c=Array.from(l);return c.reverse(),c.slice(0,50).map((l=>{return r$2({},l,{filename:l.filename||(d=c,d[d.length-1]||{}).filename,function:l.function||Kf});var d}))}(h)}}(...c)}buildFromUnknown(l,c){void 0===c&&(c={});var d=c&&c.mechanism||{handled:!0,type:"generic"},h=this.buildCoercingContext(d,c,0).apply(l),p=this.buildParsingContext(),f=this.parseStacktrace(h,p);return{$exception_list:this.convertToExceptionList(f,d),$exception_level:"error"}}modifyFrames(l){var c=this;return t$1((function*(){for(var d of l)d.stacktrace&&d.stacktrace.frames&&zf(d.stacktrace.frames)&&(d.stacktrace.frames=yield c.applyModifiers(d.stacktrace.frames));return l}))()}coerceFallback(l){var c;return{type:"Error",value:"Unknown error",stack:null==(c=l.syntheticException)?void 0:c.stack,synthetic:!0}}parseStacktrace(l,c){var d,h;return null!=l.cause&&(d=this.parseStacktrace(l.cause,c)),""!=l.stack&&null!=l.stack&&(h=this.applyChunkIds(this.stackParser(l.stack,l.synthetic?1:0),c.chunkIdMap)),r$2({},l,{cause:d,stack:h})}applyChunkIds(l,c){return l.map((l=>(l.filename&&c&&(l.chunk_id=c[l.filename]),l)))}applyCoercers(l,c){for(var d of this.coercers)if(d.match(l))return d.coerce(l,c);return this.coerceFallback(c)}applyModifiers(l){var c=this;return t$1((function*(){var d=l;for(var h of c.modifiers)d=yield h(d);return d}))()}convertToExceptionList(l,c){var d,h,p,f={type:l.type,value:l.value,mechanism:{type:null!==(d=c.type)&&void 0!==d?d:"generic",handled:null===(h=c.handled)||void 0===h||h,synthetic:null!==(p=l.synthetic)&&void 0!==p&&p}};l.stack&&(f.stacktrace={type:"raw",frames:l.stack});var m=[f];return null!=l.cause&&m.push(...this.convertToExceptionList(l.cause,r$2({},c,{handled:!0}))),m}buildParsingContext(){return{chunkIdMap:Si(this.stackParser)}}buildCoercingContext(l,c,d){void 0===d&&(d=0);var n2=(d,h)=>{if(h<=4){var p=this.buildCoercingContext(l,c,h);return this.applyCoercers(d,p)}};return r$2({},c,{syntheticException:0==d?c.syntheticException:void 0,mechanism:l,apply:l=>n2(l,d),next:l=>n2(l,d+1)})}}class Oi{match(l){return this.isDOMException(l)||this.isDOMError(l)}coerce(l,c){var d=ti(l.stack);return{type:this.getType(l),value:this.getValue(l),stack:d?l.stack:void 0,cause:l.cause?c.next(l.cause):void 0,synthetic:!1}}getType(l){return this.isDOMError(l)?"DOMError":"DOMException"}getValue(l){var c=l.name||(this.isDOMError(l)?"DOMError":"DOMException");return l.message?c+": "+l.message:c}isDOMException(l){return ci(l,"DOMException")}isDOMError(l){return ci(l,"DOMError")}}class Di{match(l){return l instanceof Error}coerce(l,c){return{type:this.getType(l),value:this.getMessage(l,c),stack:this.getStack(l),cause:l.cause?c.next(l.cause):void 0,synthetic:!1}}getType(l){return l.name||l.constructor.name}getMessage(l,c){var d=l.message;return d.error&&"string"==typeof d.error.message?String(d.error.message):String(d)}getStack(l){return l.stacktrace||l.stack||void 0}}class Hi{constructor(){}match(l){return ci(l,"ErrorEvent")&&null!=l.error}coerce(l,c){var d;return c.apply(l.error)||{type:"ErrorEvent",value:l.message,stack:null==(d=c.syntheticException)?void 0:d.stack,synthetic:!0}}}var rm=/^(?:[Uu]ncaught (?:exception: )?)?(?:((?:Eval|Internal|Range|Reference|Syntax|Type|URI|)Error): )?(.*)$/i;class Bi{match(l){return"string"==typeof l}coerce(l,c){var d,[h,p]=this.getInfos(l);return{type:null!=h?h:"Error",value:null!=p?p:l,stack:null==(d=c.syntheticException)?void 0:d.stack,synthetic:!0}}getInfos(l){var c="Error",d=l,h=l.match(rm);return h&&(c=h[1],d=h[2]),[c,d]}}var nm=["fatal","error","warning","log","info","debug"];function $i(l,c){void 0===c&&(c=40);var d=Object.keys(l);if(d.sort(),!d.length)return"[object has no keys]";for(var h=d.length;h>0;h--){var p=d.slice(0,h).join(", ");if(!(p.length>c))return h===d.length||p.length<=c?p:p.slice(0,c)+"..."}return""}class Wi{match(l){return"object"==typeof l&&null!==l}coerce(l,c){var d,h=this.getErrorPropertyFromObject(l);return h?c.apply(h):{type:this.getType(l),value:this.getValue(l),stack:null==(d=c.syntheticException)?void 0:d.stack,level:this.isSeverityLevel(l.level)?l.level:"error",synthetic:!0}}getType(l){return di(l)?l.constructor.name:"Error"}getValue(l){if("name"in l&&"string"==typeof l.name){var c="'"+l.name+"' captured as exception";return"message"in l&&"string"==typeof l.message&&(c+=" with message: '"+l.message+"'"),c}if("message"in l&&"string"==typeof l.message)return l.message;var d=this.getObjectClassName(l);return(d&&"Object"!==d?"'"+d+"'":"Object")+" captured as exception with keys: "+$i(l)}isSeverityLevel(l){return ti(l)&&!ri(l)&&nm.indexOf(l)>=0}getErrorPropertyFromObject(l){for(var c in l)if(Object.prototype.hasOwnProperty.call(l,c)){var d=l[c];if(bi(d))return d}}getObjectClassName(l){try{var c=Object.getPrototypeOf(l);return c?c.constructor.name:void 0}catch(d){return}}}class Ui{match(l){return di(l)}coerce(l,c){var d,h=l.constructor.name;return{type:h,value:h+" captured as exception with keys: "+$i(l),stack:null==(d=c.syntheticException)?void 0:d.stack,synthetic:!0}}}class Zi{match(l){return ui(l)}coerce(l,c){var d;return{type:"Error",value:"Primitive value captured as exception: "+String(l),stack:null==(d=c.syntheticException)?void 0:d.stack,synthetic:!0}}}class zi{match(l){return ci(l,"PromiseRejectionEvent")}coerce(l,c){var d,h=this.getUnhandledRejectionReason(l);return ui(h)?{type:"UnhandledRejection",value:"Non-Error promise rejection captured with value: "+String(h),stack:null==(d=c.syntheticException)?void 0:d.stack,synthetic:!0}:c.apply(h)}getUnhandledRejectionReason(l){if(ui(l))return l;try{if("reason"in l)return l.reason;if("detail"in l&&"reason"in l.detail)return l.detail.reason}catch(c){}return l}}var sm="undefined"!=typeof window?window:void 0,im="undefined"!=typeof globalThis?globalThis:sm,om=Array.prototype,am=om.forEach,lm=om.indexOf,cm=null==im?void 0:im.navigator,um=null==im?void 0:im.document,dm=null==im?void 0:im.location,hm=null==im?void 0:im.fetch,pm=null!=im&&im.XMLHttpRequest&&"withCredentials"in new im.XMLHttpRequest?im.XMLHttpRequest:void 0,fm=null==im?void 0:im.AbortController,mm=null==cm?void 0:cm.userAgent,gm=null!=sm?sm:{},vm={DEBUG:!1,LIB_VERSION:"1.292.0"},cn=l=>{var c={_log:function(c){if(sm&&(vm.DEBUG||gm.POSTHOG_DEBUG)&&!ei(sm.console)&&sm.console){for(var d=("__rrweb_original__"in sm.console[c]?sm.console[c].__rrweb_original__:sm.console[c]),h=arguments.length,p=new Array(h>1?h-1:0),f=1;f<h;f++)p[f-1]=arguments[f];d(l,...p)}},info:function(){for(var l=arguments.length,d=new Array(l),h=0;h<l;h++)d[h]=arguments[h];c._log("log",...d)},warn:function(){for(var l=arguments.length,d=new Array(l),h=0;h<l;h++)d[h]=arguments[h];c._log("warn",...d)},error:function(){for(var l=arguments.length,d=new Array(l),h=0;h<l;h++)d[h]=arguments[h];c._log("error",...d)},critical:function(){for(var c=arguments.length,d=new Array(c),h=0;h<c;h++)d[h]=arguments[h];console.error(l,...d)},uninitializedWarning:l=>{c.error("You must initialize PostHog before calling "+l)},createLogger:c=>cn(l+" "+c)};return c},ym=cn("[PostHog.js]"),_m=ym.createLogger,bm={};function vn(l,c,d){if(zf(l))if(am&&l.forEach===am)l.forEach(c,d);else if("length"in l&&l.length===+l.length)for(var h=0,p=l.length;h<p;h++)if(h in l&&c.call(d,l[h],h)===bm)return}function fn(l,c,d){if(!ni(l)){if(zf(l))return vn(l,c,d);if(ai(l)){for(var h of l.entries())if(c.call(d,h[1],h[0])===bm)return}else for(var p in l)if(Bf.call(l,p)&&c.call(d,l[p],p)===bm)return}}var gn=function(l){for(var c=arguments.length,d=new Array(c>1?c-1:0),h=1;h<c;h++)d[h-1]=arguments[h];return vn(d,(function(c){for(var d in c)void 0!==c[d]&&(l[d]=c[d])})),l},_n=function(l){for(var c=arguments.length,d=new Array(c>1?c-1:0),h=1;h<c;h++)d[h-1]=arguments[h];return vn(d,(function(c){vn(c,(function(c){l.push(c)}))})),l};function mn(l){for(var c=Object.keys(l),d=c.length,h=new Array(d);d--;)h[d]=[c[d],l[c[d]]];return h}var yn=function(l){try{return l()}catch(c){return}},bn=function(l){return function(){try{for(var c=arguments.length,d=new Array(c),h=0;h<c;h++)d[h]=arguments[h];return l.apply(this,d)}catch(p){ym.critical("Implementation error. Please turn on debug mode and open a ticket on https://app.posthog.com/home#panel=support%3Asupport%3A."),ym.critical(p)}}},Sn=function(l){var c={};return fn(l,(function(l,d){(ti(l)&&l.length>0||si(l))&&(c[d]=l)})),c};var wm=["herokuapp.com","vercel.app","netlify.app"];function In(l){var c=null==l?void 0:l.hostname;if(!ti(c))return!1;var d=c.split(".").slice(-2).join(".");for(var h of wm)if(d===h)return!1;return!0}function kn(l,c){for(var d=0;d<l.length;d++)if(c(l[d]))return l[d]}function En(l,c,d,h){var{capture:p=!1,passive:f=!0}=null!=h?h:{};null==l||l.addEventListener(c,d,{capture:p,passive:f})}var xn=l=>{var c=null==um?void 0:um.createElement("a");return ei(c)?null:(c.href=l,c)},Tn=function(l,c){var d,h;void 0===c&&(c="&");var p=[];return fn(l,(function(l,c){ei(l)||ei(c)||"undefined"===c||(d=encodeURIComponent(l instanceof File?l.name:l.toString()),h=encodeURIComponent(c),p[p.length]=h+"="+d)})),p.join(c)},Mn=function(l,c){for(var d,h=((l.split("#")[0]||"").split(/\?(.*)/)[1]||"").replace(/^\?+/g,"").split("&"),p=0;p<h.length;p++){var f=h[p].split("=");if(f[0]===c){d=f;break}}if(!zf(d)||d.length<2)return"";var m=d[1];try{m=decodeURIComponent(m)}catch(y){ym.error("Skipping decoding for malformed query param: "+m)}return m.replace(/\+/g," ")},Rn=function(l,c,d){if(!l||!c||!c.length)return l;for(var h=l.split("#"),p=h[0]||"",f=h[1],m=p.split("?"),y=m[1],_=m[0],b=(y||"").split("&"),w=[],E=0;E<b.length;E++){var M=b[E].split("=");zf(M)&&(c.includes(M[0])?w.push(M[0]+"="+d):w.push(b[E]))}var N=_;return null!=y&&(N+="?"+w.join("&")),null!=f&&(N+="#"+f),N},An=function(l,c){var d=l.match(new RegExp(c+"=([^&]*)"));return d?d[1]:null};function Nn(l,c,d){try{if(!(c in l))return()=>{};var h=l[c],p=d(h);return Xr(p)&&(p.prototype=p.prototype||{},Object.defineProperties(p,{__posthog_wrapped__:{enumerable:!1,value:!0}})),l[c]=p,()=>{l[c]=h}}catch(f){return()=>{}}}function Pn(l,c){var d,h=function(l){try{return"string"==typeof l?new URL(l).hostname:"url"in l?new URL(l.url).hostname:l.hostname}catch(c){return null}}(l),p={hostname:h,isHostDenied:!1};if(null==(d=c.payloadHostDenyList)||!d.length||null==h||!h.trim().length)return p;for(var f of c.payloadHostDenyList)if(h.endsWith(f))return{hostname:h,isHostDenied:!0};return p}var Sm="$people_distinct_id",xm="__alias",km="__timers",Cm="$autocapture_disabled_server_side",Em="$heatmaps_enabled_server_side",Im="$exception_capture_enabled_server_side",Tm="$error_tracking_suppression_rules",Rm="$error_tracking_capture_extension_exceptions",Am="$web_vitals_enabled_server_side",Om="$dead_clicks_enabled_server_side",Mm="$web_vitals_allowed_metrics",Nm="$session_recording_remote_config",Pm="$sesid",Lm="$session_is_sampled",jm="$enabled_feature_flags",Dm="$early_access_features",Fm="$feature_flag_details",$m="$stored_person_properties",Um="$stored_group_properties",Bm="$surveys",Hm="$surveys_activated",zm="$flag_call_reported",qm="$user_state",Wm="$client_session_props",Vm="$capture_rate_limit",Zm="$initial_campaign_params",Gm="$initial_referrer_info",Km="$initial_person_info",Jm="$epp",Ym="__POSTHOG_TOOLBAR__",Qm="$posthog_cookieless",Xm=[Sm,xm,"__cmpns",km,"$session_recording_enabled_server_side",Em,Pm,jm,Tm,qm,Dm,Fm,Um,$m,Bm,zm,Wm,Vm,Zm,Gm,Jm,Km];function hs(l){return l instanceof Element&&(l.id===Ym||!(null==l.closest||!l.closest(".toolbar-global-fade-container")))}function ps(l){return!!l&&1===l.nodeType}function vs(l,c){return!!l&&!!l.tagName&&l.tagName.toLowerCase()===c.toLowerCase()}function fs(l){return!!l&&3===l.nodeType}function gs(l){return!!l&&11===l.nodeType}function _s(l){return l?Wr(l).split(/\s+/):[]}function ms(l){var c=null==sm?void 0:sm.location.href;return!!(c&&l&&l.some((l=>c.match(l))))}function ys(l){var c="";switch(typeof l.className){case"string":c=l.className;break;case"object":c=(l.className&&"baseVal"in l.className?l.className.baseVal:null)||l.getAttribute("class")||"";break;default:c=""}return _s(c)}function bs(l){return ni(l)?null:Wr(l).split(/(\s+)/).filter((l=>Hs(l))).join("").replace(/[\r\n]/g," ").replace(/[ ]+/g," ").substring(0,255)}function Ss(l){var c="";return Rs(l)&&!As(l)&&l.childNodes&&l.childNodes.length&&fn(l.childNodes,(function(l){var d;fs(l)&&l.textContent&&(c+=null!==(d=bs(l.textContent))&&void 0!==d?d:"")})),Wr(c)}function ws(l){return ei(l.target)?l.srcElement||null:null!=(c=l.target)&&c.shadowRoot?l.composedPath()[0]||null:l.target||null;var c}var eg=["a","button","form","input","select","textarea","label"];function Is(l,c){if(ei(c))return!0;var d,i2=function(l){if(c.some((c=>l.matches(c))))return{v:!0}};for(var h of l)if(d=i2(h))return d.v;return!1}function ks(l){var c=l.parentNode;return!(!c||!ps(c))&&c}var tg=[".ph-no-rageclick",".ph-no-capture"],xs=l=>!l||vs(l,"html")||!ps(l),Ts=(l,c)=>{if(!sm||xs(l))return{parentIsUsefulElement:!1,targetElementList:[]};for(var d=!1,h=[l],p=l;p.parentNode&&!vs(p,"body");)if(gs(p.parentNode))h.push(p.parentNode.host),p=p.parentNode.host;else{var f=ks(p);if(!f)break;if(c||eg.indexOf(f.tagName.toLowerCase())>-1)d=!0;else{var m=sm.getComputedStyle(f);m&&"pointer"===m.getPropertyValue("cursor")&&(d=!0)}h.push(f),p=f}return{parentIsUsefulElement:d,targetElementList:h}};function Rs(l){for(var c=l;c.parentNode&&!vs(c,"body");c=c.parentNode){var d=ys(c);if($r(d,"ph-sensitive")||$r(d,"ph-no-capture"))return!1}if($r(ys(l),"ph-include"))return!0;var h=l.type||"";if(ti(h))switch(h.toLowerCase()){case"hidden":case"password":return!1}var p=l.name||l.id||"";return!ti(p)||!/^cc|cardnum|ccnum|creditcard|csc|cvc|cvv|exp|pass|pwd|routing|seccode|securitycode|securitynum|socialsec|socsec|ssn/i.test(p.replace(/[^a-zA-Z0-9]/g,""))}function As(l){return!!(vs(l,"input")&&!["button","checkbox","submit","reset"].includes(l.type)||vs(l,"select")||vs(l,"textarea")||"true"===l.getAttribute("contenteditable"))}var rg="(4[0-9]{12}(?:[0-9]{3})?)|(5[1-5][0-9]{14})|(6(?:011|5[0-9]{2})[0-9]{12})|(3[47][0-9]{13})|(3(?:0[0-5]|[68][0-9])[0-9]{11})|((?:2131|1800|35[0-9]{3})[0-9]{11})",ng=new RegExp("^(?:"+rg+")$"),sg=new RegExp(rg),ig="\\d{3}-?\\d{2}-?\\d{4}",og=new RegExp("^("+ig+")$"),ag=new RegExp("("+ig+")");function Hs(l,c){if(void 0===c&&(c=!0),ni(l))return!1;if(ti(l)){if(l=Wr(l),(c?ng:sg).test((l||"").replace(/[- ]/g,"")))return!1;if((c?og:ag).test(l))return!1}return!0}function qs(l){var c=Ss(l);return Hs(c=(c+" "+Bs(l)).trim())?c:""}function Bs(l){var c="";return l&&l.childNodes&&l.childNodes.length&&fn(l.childNodes,(function(l){var d;if(l&&"span"===(null==(d=l.tagName)?void 0:d.toLowerCase()))try{var h=Ss(l);c=(c+" "+h).trim(),l.childNodes&&l.childNodes.length&&(c=(c+" "+Bs(l)).trim())}catch(p){ym.error("[AutoCapture]",p)}})),c}function Vs(l){return function(l){return l.map((l=>{var c,d,h="";if(l.tag_name&&(h+=l.tag_name),l.attr_class)for(var p of(l.attr_class.sort(),l.attr_class))h+="."+p.replace(/"/g,"");var f=r$2({},l.text?{text:l.text}:{},{"nth-child":null!==(c=l.nth_child)&&void 0!==c?c:0,"nth-of-type":null!==(d=l.nth_of_type)&&void 0!==d?d:0},l.href?{href:l.href}:{},l.attr_id?{attr_id:l.attr_id}:{},l.attributes),m={};return mn(f).sort(((l,c)=>{var[d]=l,[h]=c;return d.localeCompare(h)})).forEach((l=>{var[c,d]=l;return m[$s(c.toString())]=$s(d.toString())})),(h+=":")+mn(m).map((l=>{var[c,d]=l;return c+'="'+d+'"'})).join("")})).join(";")}(l.map((l=>{var c,d,h={text:null==(c=l.$el_text)?void 0:c.slice(0,400),tag_name:l.tag_name,href:null==(d=l.attr__href)?void 0:d.slice(0,2048),attr_class:Ws(l),attr_id:l.attr__id,nth_child:l.nth_child,nth_of_type:l.nth_of_type,attributes:{}};return mn(l).filter((l=>{var[c]=l;return 0===c.indexOf("attr__")})).forEach((l=>{var[c,d]=l;return h.attributes[c]=d})),h})))}function $s(l){return l.replace(/"|\\"/g,'\\"')}function Ws(l){var c=l.attr__class;return c?zf(c)?c:_s(c):void 0}var lg={initiatorTypes:["audio","beacon","body","css","early-hint","embed","fetch","frame","iframe","icon","image","img","input","link","navigation","object","ping","script","track","video","xmlhttprequest"],maskRequestFn:l=>l,recordHeaders:!1,recordBody:!1,recordInitialRequests:!1,recordPerformance:!1,performanceEntryTypeToObserve:["first-input","navigation","paint","resource"],payloadSizeLimitBytes:1e6,payloadHostDenyList:[".lr-ingest.io",".ingest.sentry.io",".clarity.ms","analytics.google.com","bam.nr-data.net"]},cg=_m("[Recorder]"),zs=l=>"navigation"===l.entryType,js=l=>"resource"===l.entryType;function Ys(l,c){return!!c&&(oi(c)||c[l])}function Xs(l){var{type:c,recordBody:d,headers:h,url:p}=l;function s2(l){var c=Object.keys(h).find((l=>"content-type"===l.toLowerCase())),d=c&&h[c];return l.some((l=>null==d?void 0:d.includes(l)))}if(!d)return!1;if(function e4(l){try{return"string"==typeof l?l.startsWith("blob:"):l instanceof URL?"blob:"===l.protocol:l instanceof Request&&e4(l.url)}catch(c){return!1}}(p))return!1;if(oi(d))return!0;if(zf(d))return s2(d);var f=d[c];return oi(f)?f:s2(f)}function Ks(l,c,d,h,p,f){return Js.apply(this,arguments)}function Js(){return Js=t$1((function*(l,c,d,h,p,f){return void 0===f&&(f=0),f>10?(cg.warn("Failed to get performance entry for request",{url:d,initiatorType:c}),null):function(l,c){for(var d=l.length-1;d>=0;d-=1)if(c(l[d]))return l[d]}(l.performance.getEntriesByName(d),(l=>js(l)&&l.initiatorType===c&&(ei(h)||l.startTime>=h)&&(ei(p)||l.startTime<=p)))||(yield new Promise((l=>setTimeout(l,50*f))),Ks(l,c,d,h,p,f+1))})),Js.apply(this,arguments)}function Qs(l){var{body:c,options:d,url:h}=l;if(ni(c))return null;var{hostname:p,isHostDenied:f}=Pn(h,d);if(f)return p+" is in deny list";if(ti(c))return c;if((l=>l instanceof Document)(c))return c.textContent;if(ai(c))return Tn(c);if(Jr(c))try{return JSON.stringify(c)}catch(m){return"[SessionReplay] Failed to stringify response object"}return"[SessionReplay] Cannot read body of type "+toString.call(c)}var eo=l=>!ii(l)&&("navigation"===l.entryType||"resource"===l.entryType);function to(l){var{entry:c,method:d,status:h,networkRequest:p,isInitial:f,start:m,end:y,url:_,initiatorType:b}=l;m=c?c.startTime:m,y=c?c.responseEnd:y;var w=Math.floor(Date.now()-performance.now()),E=Math.floor(w+(m||0)),M=[r$2({},c?c.toJSON():{name:_},{startTime:ei(m)?void 0:Math.round(m),endTime:ei(y)?void 0:Math.round(y),timeOrigin:w,timestamp:E,method:d,initiatorType:b||(c?c.initiatorType:void 0),status:h,requestHeaders:p.requestHeaders,requestBody:p.requestBody,responseHeaders:p.responseHeaders,responseBody:p.responseBody,isInitial:f})];if(eo(c))for(var N of c.serverTiming||[])M.push({timeOrigin:w,timestamp:E,startTime:Math.round(c.startTime),name:N.name,duration:N.duration,entryType:"serverTiming"});return M}var ug=["video/","audio/"];function io(l){return new Promise(((c,d)=>{var h=setTimeout((()=>c("[SessionReplay] Timeout while trying to read body")),500);try{l.clone().text().then((l=>c(l)),(l=>d(l))).finally((()=>clearTimeout(h)))}catch(p){clearTimeout(h),c("[SessionReplay] Failed to read body")}}))}function no(){return no=t$1((function*(l){var{r:c,options:d,url:h}=l,{hostname:p,isHostDenied:f}=Pn(h,d);return f?Promise.resolve(p+" is in deny list"):io(c)})),no.apply(this,arguments)}function so(){return so=t$1((function*(l){var{r:c,options:d,url:h}=l,p=function(l){var c,{r:d,options:h,url:p}=l;if("chunked"===d.headers.get("Transfer-Encoding"))return"Chunked Transfer-Encoding is not supported";var f=null==(c=d.headers.get("Content-Type"))?void 0:c.toLowerCase(),m=ug.some((l=>null==f?void 0:f.startsWith(l)));if(f&&m)return"Content-Type "+f+" is not supported";var{hostname:y,isHostDenied:_}=Pn(p,h);return _?y+" is in deny list":null}({r:c,options:d,url:h});return ii(p)?io(c):Promise.resolve(p)})),so.apply(this,arguments)}var dg=null;function lo(l,c,d){if(!("performance"in c))return()=>{};if(dg)return cg.warn("Network observer already initialised, doing nothing"),()=>{};var h=d?Object.assign({},lg,d):lg,s2=c=>{var d=[];c.requests.forEach((l=>{var c=h.maskRequestFn(l);c&&d.push(c)})),d.length>0&&l(r$2({},c,{requests:d}))},p=function(l,c,d){if(d.recordInitialRequests){var h=c.performance.getEntries().filter((l=>zs(l)||js(l)&&d.initiatorTypes.includes(l.initiatorType)));l({requests:h.flatMap((l=>to({entry:l,method:void 0,status:void 0,networkRequest:{},isInitial:!0}))),isInitial:!0})}var p=new c.PerformanceObserver((c=>{var h=c.getEntries().filter((l=>{return zs(l)||js(l)&&d.initiatorTypes.includes(l.initiatorType)&&(c=l,!d.recordBody&&!d.recordHeaders||"xmlhttprequest"!==c.initiatorType&&"fetch"!==c.initiatorType);var c}));l({requests:h.flatMap((l=>to({entry:l,method:void 0,status:void 0,networkRequest:{}})))})})),f=PerformanceObserver.supportedEntryTypes.filter((l=>d.performanceEntryTypeToObserve.includes(l)));return p.observe({entryTypes:f}),()=>{p.disconnect()}}(s2,c,h),a2=()=>{},l2=()=>{};return(h.recordHeaders||h.recordBody)&&(a2=function(l,c,d){if(!d.initiatorTypes.includes("xmlhttprequest"))return()=>{};var h=Ys("request",d.recordHeaders),p=Ys("response",d.recordHeaders),f=Nn(c.XMLHttpRequest.prototype,"open",(f=>function(m,y,_,b,w){void 0===_&&(_=!0);var E,M,N=this,P=new Request(y),L={},j={},D=N.setRequestHeader.bind(N);N.setRequestHeader=(l,c)=>(j[l]=c,D(l,c)),h&&(L.requestHeaders=j);var F=N.send.bind(N);N.send=l=>(Xs({type:"request",headers:j,url:y,recordBody:d.recordBody})&&(L.requestBody=Qs({body:l,options:d,url:y})),E=c.performance.now(),F(l));var y2=()=>{if(N.readyState===N.DONE){N.removeEventListener("readystatechange",y2),M=c.performance.now();var h={};N.getAllResponseHeaders().trim().split(/[\r\n]+/).forEach((l=>{var c=l.split(": "),d=c.shift(),p=c.join(": ");d&&(h[d]=p)})),p&&(L.responseHeaders=h),Xs({type:"response",headers:h,url:y,recordBody:d.recordBody})&&(L.responseBody=Qs({body:N.response,options:d,url:y})),Ks(c,"xmlhttprequest",P.url,E,M).then((c=>{var d=to({entry:c,method:m,status:null==N?void 0:N.status,networkRequest:L,start:E,end:M,url:y.toString(),initiatorType:"xmlhttprequest"});l({requests:d})})).catch((()=>{}))}};N.addEventListener("readystatechange",y2),f.call(N,m,y.toString(),_,b,w)}));return()=>{f()}}(s2,c,h),l2=function(l,c,d){if(!d.initiatorTypes.includes("fetch"))return()=>{};var h=Ys("request",d.recordHeaders),p=Ys("response",d.recordHeaders),f=Nn(c,"fetch",(f=>{return m=t$1((function*(m,y){var _,b,w,E=new Request(m,y),M={};try{var N={};E.headers.forEach(((l,c)=>{N[c]=l})),h&&(M.requestHeaders=N),Xs({type:"request",headers:N,url:m,recordBody:d.recordBody})&&(M.requestBody=yield function(l){return no.apply(this,arguments)}({r:E,options:d,url:m})),b=c.performance.now(),_=yield f(E),w=c.performance.now();var P={};return _.headers.forEach(((l,c)=>{P[c]=l})),p&&(M.responseHeaders=P),Xs({type:"response",headers:P,url:m,recordBody:d.recordBody})&&(M.responseBody=yield function(l){return so.apply(this,arguments)}({r:_,options:d,url:m})),_}finally{Ks(c,"fetch",E.url,b,w).then((c=>{var d,h=to({entry:c,method:E.method,status:null==(d=_)?void 0:d.status,networkRequest:M,start:b,end:w,url:E.url,initiatorType:"fetch"});l({requests:h})})).catch((()=>{}))}})),function(l,c){return m.apply(this,arguments)};var m}));return()=>{f()}}(s2,c,h)),dg=()=>{p(),a2(),l2()}}var uo=l=>({name:"rrweb/network@1",observer:lo,options:l});gm.__PosthogExtensions__=gm.__PosthogExtensions__||{},gm.__PosthogExtensions__.rrwebPlugins={getRecordConsolePlugin:Hr,getRecordNetworkPlugin:uo},gm.__PosthogExtensions__.rrweb={record:qt,version:"v2"},gm.rrweb={record:qt,version:"v2"},gm.rrwebConsoleRecord={getRecordConsolePlugin:Hr},gm.getRecordNetworkPlugin=uo;var hg,pg,fg,mg,gg,vg,yg,_g,bg={},wg=[],Sg=/acit|ex(?:s|g|n|p|$)|rph|grid|ows|mnc|ntw|ine[ch]|zoo|^ord|itera/i,xg=Array.isArray;function Co(l,c){for(var d in c)l[d]=c[d];return l}function Io(l){var c=l.parentNode;c&&c.removeChild(l)}function ko(l,c,d){var h,p,f,m={};for(f in c)"key"==f?h=c[f]:"ref"==f?p=c[f]:m[f]=c[f];if(arguments.length>2&&(m.children=arguments.length>3?hg.call(arguments,2):d),"function"==typeof l&&null!=l.defaultProps)for(f in l.defaultProps)void 0===m[f]&&(m[f]=l.defaultProps[f]);return Eo(l,m,h,p,null)}function Eo(l,c,d,h,p){var f={type:l,props:c,key:d,ref:h,__k:null,__:null,__b:0,__e:null,__d:void 0,__c:null,constructor:void 0,__v:null==p?++fg:p,__i:-1,__u:0};return null==p&&null!=pg.vnode&&pg.vnode(f),f}function xo(l){return l.children}function To(l,c){this.props=l,this.context=c}function Mo(l,c){if(null==c)return l.__?Mo(l.__,l.__i+1):null;for(var d;c<l.__k.length;c++)if(null!=(d=l.__k[c])&&null!=d.__e)return d.__e;return"function"==typeof l.type?Mo(l):null}function Ro(l){var c,d;if(null!=(l=l.__)&&null!=l.__c){for(l.__e=l.__c.base=null,c=0;c<l.__k.length;c++)if(null!=(d=l.__k[c])&&null!=d.__e){l.__e=l.__c.base=d.__e;break}return Ro(l)}}function Ao(l){(!l.__d&&(l.__d=!0)&&mg.push(l)&&!No.__r++||gg!==pg.debounceRendering)&&((gg=pg.debounceRendering)||vg)(No)}function No(){var l,c,d,h,p,f,m,y,_;for(mg.sort(yg);l=mg.shift();)l.__d&&(c=mg.length,h=void 0,f=(p=(d=l).__v).__e,y=[],_=[],(m=d.__P)&&((h=Co({},p)).__v=p.__v+1,pg.vnode&&pg.vnode(h),Bo(m,h,p,d.__n,void 0!==m.ownerSVGElement,32&p.__u?[f]:null,y,null==f?Mo(p):f,!!(32&p.__u),_),h.__.__k[h.__i]=h,Vo(y,h,_),h.__e!=f&&Ro(h)),mg.length>c&&mg.sort(yg));No.__r=0}function Po(l,c,d,h,p,f,m,y,_,b,w){var E,M,N,P,L,j=h&&h.__k||wg,D=c.length;for(d.__d=_,function(l,c,d){var h,p,f,m,y,_=c.length,b=d.length,w=b,E=0;for(l.__k=[],h=0;h<_;h++)null!=(p=l.__k[h]=null==(p=c[h])||"boolean"==typeof p||"function"==typeof p?null:"string"==typeof p||"number"==typeof p||"bigint"==typeof p||p.constructor==String?Eo(null,p,null,null,p):xg(p)?Eo(xo,{children:p},null,null,null):void 0===p.constructor&&p.__b>0?Eo(p.type,p.props,p.key,p.ref?p.ref:null,p.__v):p)?(p.__=l,p.__b=l.__b+1,y=Lo(p,d,m=h+E,w),p.__i=y,f=null,-1!==y&&(w--,(f=d[y])&&(f.__u|=131072)),null==f||null===f.__v?(-1==y&&E--,"function"!=typeof p.type&&(p.__u|=65536)):y!==m&&(y===m+1?E++:y>m?w>_-m?E+=y-m:E--:E=y<m&&y==m-1?y-m:0,y!==h+E&&(p.__u|=65536))):(f=d[h])&&null==f.key&&f.__e&&(f.__e==l.__d&&(l.__d=Mo(f)),Wo(f,f,!1),d[h]=null,w--);if(w)for(h=0;h<b;h++)null!=(f=d[h])&&!(131072&f.__u)&&(f.__e==l.__d&&(l.__d=Mo(f)),Wo(f,f))}(d,c,j),_=d.__d,E=0;E<D;E++)null!=(N=d.__k[E])&&"boolean"!=typeof N&&"function"!=typeof N&&(M=-1===N.__i?bg:j[N.__i]||bg,N.__i=E,Bo(l,N,M,p,f,m,y,_,b,w),P=N.__e,N.ref&&M.ref!=N.ref&&(M.ref&&$o(M.ref,null,N),w.push(N.ref,N.__c||P,N)),null==L&&null!=P&&(L=P),65536&N.__u||M.__k===N.__k?_=Fo(N,_,l):"function"==typeof N.type&&void 0!==N.__d?_=N.__d:P&&(_=P.nextSibling),N.__d=void 0,N.__u&=-196609);d.__d=_,d.__e=L}function Fo(l,c,d){var h,p;if("function"==typeof l.type){for(h=l.__k,p=0;h&&p<h.length;p++)h[p]&&(h[p].__=l,c=Fo(h[p],c,d));return c}return l.__e!=c&&(d.insertBefore(l.__e,c||null),c=l.__e),c&&c.nextSibling}function Lo(l,c,d,h){var p=l.key,f=l.type,m=d-1,y=d+1,_=c[d];if(null===_||_&&p==_.key&&f===_.type)return d;if(h>(null==_||131072&_.__u?0:1))for(;m>=0||y<c.length;){if(m>=0){if((_=c[m])&&!(131072&_.__u)&&p==_.key&&f===_.type)return m;m--}if(y<c.length){if((_=c[y])&&!(131072&_.__u)&&p==_.key&&f===_.type)return y;y++}}return-1}function Oo(l,c,d){"-"===c[0]?l.setProperty(c,null==d?"":d):l[c]=null==d?"":"number"!=typeof d||Sg.test(c)?d:d+"px"}function Do(l,c,d,h,p){var f;e:if("style"===c)if("string"==typeof d)l.style.cssText=d;else{if("string"==typeof h&&(l.style.cssText=h=""),h)for(c in h)d&&c in d||Oo(l.style,c,"");if(d)for(c in d)h&&d[c]===h[c]||Oo(l.style,c,d[c])}else if("o"===c[0]&&"n"===c[1])f=c!==(c=c.replace(/(PointerCapture)$|Capture$/,"$1")),c=c.toLowerCase()in l?c.toLowerCase().slice(2):c.slice(2),l.l||(l.l={}),l.l[c+f]=d,d?h?d.u=h.u:(d.u=Date.now(),l.addEventListener(c,f?qo:Ho,f)):l.removeEventListener(c,f?qo:Ho,f);else{if(p)c=c.replace(/xlink(H|:h)/,"h").replace(/sName$/,"s");else if("width"!==c&&"height"!==c&&"href"!==c&&"list"!==c&&"form"!==c&&"tabIndex"!==c&&"download"!==c&&"rowSpan"!==c&&"colSpan"!==c&&"role"!==c&&c in l)try{l[c]=null==d?"":d;break e}catch(m){}"function"==typeof d||(null==d||!1===d&&"-"!==c[4]?l.removeAttribute(c):l.setAttribute(c,d))}}function Ho(l){var c=this.l[l.type+!1];if(l.t){if(l.t<=c.u)return}else l.t=Date.now();return c(pg.event?pg.event(l):l)}function qo(l){return this.l[l.type+!0](pg.event?pg.event(l):l)}function Bo(l,c,d,h,p,f,m,y,_,b){var w,E,M,N,P,L,j,D,F,U,B,H,z,q,V,Z=c.type;if(void 0!==c.constructor)return null;128&d.__u&&(_=!!(32&d.__u),f=[y=c.__e=d.__e]),(w=pg.__b)&&w(c);e:if("function"==typeof Z)try{if(D=c.props,F=(w=Z.contextType)&&h[w.__c],U=w?F?F.props.value:w.__:h,d.__c?j=(E=c.__c=d.__c).__=E.__E:("prototype"in Z&&Z.prototype.render?c.__c=E=new Z(D,U):(c.__c=E=new To(D,U),E.constructor=Z,E.render=Uo),F&&F.sub(E),E.props=D,E.state||(E.state={}),E.context=U,E.__n=h,M=E.__d=!0,E.__h=[],E._sb=[]),null==E.__s&&(E.__s=E.state),null!=Z.getDerivedStateFromProps&&(E.__s==E.state&&(E.__s=Co({},E.__s)),Co(E.__s,Z.getDerivedStateFromProps(D,E.__s))),N=E.props,P=E.state,E.__v=c,M)null==Z.getDerivedStateFromProps&&null!=E.componentWillMount&&E.componentWillMount(),null!=E.componentDidMount&&E.__h.push(E.componentDidMount);else{if(null==Z.getDerivedStateFromProps&&D!==N&&null!=E.componentWillReceiveProps&&E.componentWillReceiveProps(D,U),!E.__e&&(null!=E.shouldComponentUpdate&&!1===E.shouldComponentUpdate(D,E.__s,U)||c.__v===d.__v)){for(c.__v!==d.__v&&(E.props=D,E.state=E.__s,E.__d=!1),c.__e=d.__e,c.__k=d.__k,c.__k.forEach((function(l){l&&(l.__=c)})),B=0;B<E._sb.length;B++)E.__h.push(E._sb[B]);E._sb=[],E.__h.length&&m.push(E);break e}null!=E.componentWillUpdate&&E.componentWillUpdate(D,E.__s,U),null!=E.componentDidUpdate&&E.__h.push((function(){E.componentDidUpdate(N,P,L)}))}if(E.context=U,E.props=D,E.__P=l,E.__e=!1,H=pg.__r,z=0,"prototype"in Z&&Z.prototype.render){for(E.state=E.__s,E.__d=!1,H&&H(c),w=E.render(E.props,E.state,E.context),q=0;q<E._sb.length;q++)E.__h.push(E._sb[q]);E._sb=[]}else do{E.__d=!1,H&&H(c),w=E.render(E.props,E.state,E.context),E.state=E.__s}while(E.__d&&++z<25);E.state=E.__s,null!=E.getChildContext&&(h=Co(Co({},h),E.getChildContext())),M||null==E.getSnapshotBeforeUpdate||(L=E.getSnapshotBeforeUpdate(N,P)),Po(l,xg(V=null!=w&&w.type===xo&&null==w.key?w.props.children:w)?V:[V],c,d,h,p,f,m,y,_,b),E.base=c.__e,c.__u&=-161,E.__h.length&&m.push(E),j&&(E.__E=E.__=null)}catch(K){c.__v=null,_||null!=f?(c.__e=y,c.__u|=_?160:32,f[f.indexOf(y)]=null):(c.__e=d.__e,c.__k=d.__k),pg.__e(K,c,d)}else null==f&&c.__v===d.__v?(c.__k=d.__k,c.__e=d.__e):c.__e=function(l,c,d,h,p,f,m,y,_){var b,w,E,M,N,P,L,j=d.props,D=c.props,F=c.type;if("svg"===F&&(p=!0),null!=f)for(b=0;b<f.length;b++)if((N=f[b])&&"setAttribute"in N==!!F&&(F?N.localName===F:3===N.nodeType)){l=N,f[b]=null;break}if(null==l){if(null===F)return document.createTextNode(D);l=p?document.createElementNS("http://www.w3.org/2000/svg",F):document.createElement(F,D.is&&D),f=null,y=!1}if(null===F)j===D||y&&l.data===D||(l.data=D);else{if(f=f&&hg.call(l.childNodes),j=d.props||bg,!y&&null!=f)for(j={},b=0;b<l.attributes.length;b++)j[(N=l.attributes[b]).name]=N.value;for(b in j)N=j[b],"children"==b||("dangerouslySetInnerHTML"==b?E=N:"key"===b||b in D||Do(l,b,null,N,p));for(b in D)N=D[b],"children"==b?M=N:"dangerouslySetInnerHTML"==b?w=N:"value"==b?P=N:"checked"==b?L=N:"key"===b||y&&"function"!=typeof N||j[b]===N||Do(l,b,N,j[b],p);if(w)y||E&&(w.__html===E.__html||w.__html===l.innerHTML)||(l.innerHTML=w.__html),c.__k=[];else if(E&&(l.innerHTML=""),Po(l,xg(M)?M:[M],c,d,h,p&&"foreignObject"!==F,f,m,f?f[0]:d.__k&&Mo(d,0),y,_),null!=f)for(b=f.length;b--;)null!=f[b]&&Io(f[b]);y||(b="value",void 0!==P&&(P!==l[b]||"progress"===F&&!P||"option"===F&&P!==j[b])&&Do(l,b,P,j[b],!1),b="checked",void 0!==L&&L!==l[b]&&Do(l,b,L,j[b],!1))}return l}(d.__e,c,d,h,p,f,m,_,b);(w=pg.diffed)&&w(c)}function Vo(l,c,d){c.__d=void 0;for(var h=0;h<d.length;h++)$o(d[h],d[++h],d[++h]);pg.__c&&pg.__c(c,l),l.some((function(c){try{l=c.__h,c.__h=[],l.some((function(l){l.call(c)}))}catch(d){pg.__e(d,c.__v)}}))}function $o(l,c,d){try{"function"==typeof l?l(c):l.current=c}catch(h){pg.__e(h,d)}}function Wo(l,c,d){var h,p;if(pg.unmount&&pg.unmount(l),(h=l.ref)&&(h.current&&h.current!==l.__e||$o(h,null,c)),null!=(h=l.__c)){if(h.componentWillUnmount)try{h.componentWillUnmount()}catch(f){pg.__e(f,c)}h.base=h.__P=null,l.__c=void 0}if(h=l.__k)for(p=0;p<h.length;p++)h[p]&&Wo(h[p],c,d||"function"!=typeof l.type);d||null==l.__e||Io(l.__e),l.__=l.__e=l.__d=void 0}function Uo(l,c,d){return this.constructor(l,d)}function Zo(l,c,d){var h,p,f;pg.__&&pg.__(l,c),h=c.__k,p=[],f=[],Bo(c,l=c.__k=ko(xo,null,[l]),h||bg,bg,void 0!==c.ownerSVGElement,h?null:c.firstChild?hg.call(c.childNodes):null,p,h?h.__e:c.firstChild,!1,f),Vo(p,l,f)}hg=wg.slice,pg={__e:function(l,c,d,h){for(var p,f,m;c=c.__;)if((p=c.__c)&&!p.__)try{if((f=p.constructor)&&null!=f.getDerivedStateFromError&&(p.setState(f.getDerivedStateFromError(l)),m=p.__d),null!=p.componentDidCatch&&(p.componentDidCatch(l,h||{}),m=p.__d),m)return p.__E=p}catch(y){l=y}throw l}},fg=0,To.prototype.setState=function(l,c){var d;d=null!=this.__s&&this.__s!==this.state?this.__s:this.__s=Co({},this.state),"function"==typeof l&&(l=l(Co({},d),this.props)),l&&Co(d,l),null!=l&&this.__v&&(c&&this._sb.push(c),Ao(this))},To.prototype.forceUpdate=function(l){this.__v&&(this.__e=!0,l&&this.__h.push(l),Ao(this))},To.prototype.render=xo,mg=[],vg="function"==typeof Promise?Promise.prototype.then.bind(Promise.resolve()):setTimeout,yg=function(l,c){return l.__v.__b-c.__v.__b},No.__r=0,_g=0;var kg,Cg,Eg,Ig,Tg=0,Rg=[],Ag=[],Og=pg.__b,Mg=pg.__r,Ng=pg.diffed,Pg=pg.__c,Lg=pg.unmount;function sa(l,c){pg.__h&&pg.__h(Cg,l,Tg||c),Tg=0;var d=Cg.__H||(Cg.__H={__:[],__h:[]});return l>=d.__.length&&d.__.push({__V:Ag}),d.__[l]}function oa(l){return Tg=1,function(l,c){var d=sa(kg++,2);if(d.t=l,!d.__c&&(d.__=[_a(void 0,c),function(l){var c=d.__N?d.__N[0]:d.__[0],h=d.t(c,l);c!==h&&(d.__N=[h,d.__[1]],d.__c.setState({}))}],d.__c=Cg,!Cg.u)){var n2=function(l,c,p){if(!d.__c.__H)return!0;var f=d.__c.__H.__.filter((function(l){return l.__c}));if(f.every((function(l){return!l.__N})))return!h||h.call(this,l,c,p);var m=!1;return f.forEach((function(l){if(l.__N){var c=l.__[0];l.__=l.__N,l.__N=void 0,c!==l.__[0]&&(m=!0)}})),!(!m&&d.__c.props===l)&&(!h||h.call(this,l,c,p))};Cg.u=!0;var h=Cg.shouldComponentUpdate,p=Cg.componentWillUpdate;Cg.componentWillUpdate=function(l,c,d){if(this.__e){var f=h;h=void 0,n2(l,c,d),h=f}p&&p.call(this,l,c,d)},Cg.shouldComponentUpdate=n2}return d.__N||d.__}(_a,l)}function aa(l,c){var d=sa(kg++,3);!pg.__s&&ga(d.__H,c)&&(d.__=l,d.i=c,Cg.__H.__h.push(d))}function la(l){return Tg=5,ua((function(){return{current:l}}),[])}function ua(l,c){var d=sa(kg++,7);return ga(d.__H,c)?(d.__V=l(),d.i=c,d.__h=l,d.__V):d.__}function ca(l){var c=Cg.context[l.__c],d=sa(kg++,9);return d.c=l,c?(null==d.__&&(d.__=!0,c.sub(Cg)),c.props.value):l.__}function da(){for(var l;l=Rg.shift();)if(l.__P&&l.__H)try{l.__H.__h.forEach(va),l.__H.__h.forEach(fa),l.__H.__h=[]}catch(Ay){l.__H.__h=[],pg.__e(Ay,l.__v)}}pg.__b=function(l){Cg=null,Og&&Og(l)},pg.__r=function(l){Mg&&Mg(l),kg=0;var c=(Cg=l.__c).__H;c&&(Eg===Cg?(c.__h=[],Cg.__h=[],c.__.forEach((function(l){l.__N&&(l.__=l.__N),l.__V=Ag,l.__N=l.i=void 0}))):(c.__h.forEach(va),c.__h.forEach(fa),c.__h=[],kg=0)),Eg=Cg},pg.diffed=function(l){Ng&&Ng(l);var c=l.__c;c&&c.__H&&(c.__H.__h.length&&(1!==Rg.push(c)&&Ig===pg.requestAnimationFrame||((Ig=pg.requestAnimationFrame)||pa)(da)),c.__H.__.forEach((function(l){l.i&&(l.__H=l.i),l.__V!==Ag&&(l.__=l.__V),l.i=void 0,l.__V=Ag}))),Eg=Cg=null},pg.__c=function(l,c){c.some((function(l){try{l.__h.forEach(va),l.__h=l.__h.filter((function(l){return!l.__||fa(l)}))}catch(Oy){c.some((function(l){l.__h&&(l.__h=[])})),c=[],pg.__e(Oy,l.__v)}})),Pg&&Pg(l,c)},pg.unmount=function(l){Lg&&Lg(l);var c,d=l.__c;d&&d.__H&&(d.__H.__.forEach((function(l){try{va(l)}catch(d){c=d}})),d.__H=void 0,c&&pg.__e(c,d.__v))};var jg="function"==typeof requestAnimationFrame;function pa(l){var c,r2=function(){clearTimeout(d),jg&&cancelAnimationFrame(c),setTimeout(l)},d=setTimeout(r2,100);jg&&(c=requestAnimationFrame(r2))}function va(l){var c=Cg,d=l.__c;"function"==typeof d&&(l.__c=void 0,d()),Cg=c}function fa(l){var c=Cg;l.__c=l.__(),Cg=c}function ga(l,c){return!l||l.length!==c.length||c.some((function(c,d){return c!==l[d]}))}function _a(l,c){return"function"==typeof c?c(l):c}var Dg=function(l){return l.Button="button",l.Tab="tab",l.Selector="selector",l}({}),Fg=function(l){return l.TopLeft="top_left",l.TopRight="top_right",l.TopCenter="top_center",l.MiddleLeft="middle_left",l.MiddleRight="middle_right",l.MiddleCenter="middle_center",l.Left="left",l.Center="center",l.Right="right",l.NextToTrigger="next_to_trigger",l}({}),$g=function(l){return l.Popover="popover",l.API="api",l.Widget="widget",l.ExternalSurvey="external_survey",l}({}),Ug=function(l){return l.Open="open",l.MultipleChoice="multiple_choice",l.SingleChoice="single_choice",l.Rating="rating",l.Link="link",l}({}),Bg=function(l){return l.NextQuestion="next_question",l.End="end",l.ResponseBased="response_based",l.SpecificQuestion="specific_question",l}({}),Hg=function(l){return l.Once="once",l.Recurring="recurring",l.Always="always",l}({}),zg=function(l){return l.SHOWN="survey shown",l.DISMISSED="survey dismissed",l.SENT="survey sent",l}({}),qg=function(l){return l.SURVEY_ID="$survey_id",l.SURVEY_NAME="$survey_name",l.SURVEY_RESPONSE="$survey_response",l.SURVEY_ITERATION="$survey_iteration",l.SURVEY_ITERATION_START_DATE="$survey_iteration_start_date",l.SURVEY_PARTIALLY_COMPLETED="$survey_partially_completed",l.SURVEY_SUBMISSION_ID="$survey_submission_id",l.SURVEY_QUESTIONS="$survey_questions",l.SURVEY_COMPLETED="$survey_completed",l}({}),Wg=function(l){return l.Popover="popover",l.Inline="inline",l}({}),Vg=_m("[Surveys]");function Ta(l){return!(!l.start_date||l.end_date)}function Ma(l){var c;return!(null==(c=l.conditions)||null==(c=c.events)||null==(c=c.values)||!c.length)}function Ra(l){var c;return!(null==(c=l.conditions)||null==(c=c.actions)||null==(c=c.values)||!c.length)}var Zg="seenSurvey_",Gg="inProgressSurvey_",Pa=(l,c)=>{var d="$survey_"+c+"/"+l.id;return l.current_iteration&&l.current_iteration>0&&(d="$survey_"+c+"/"+l.id+"/"+l.current_iteration),d},Fa=l=>{var c=""+Zg+l.id;return l.current_iteration&&l.current_iteration>0&&(c=""+Zg+l.id+"_"+l.current_iteration),c},La=l=>{localStorage.getItem(Fa(l))||localStorage.setItem(Fa(l),"true")},Kg=[$g.Popover,$g.Widget,$g.API],Jg={ignoreConditions:!1,ignoreDelay:!1,displayType:Wg.Popover};Math.trunc||(Math.trunc=function(l){return l<0?Math.ceil(l):Math.floor(l)}),Number.isInteger||(Number.isInteger=function(l){return si(l)&&isFinite(l)&&Math.floor(l)===l});var Yg="0123456789abcdef";class qa{constructor(l){if(this.bytes=l,16!==l.length)throw new TypeError("not 128-bit length")}static fromFieldsV7(l,c,d,h){if(!Number.isInteger(l)||!Number.isInteger(c)||!Number.isInteger(d)||!Number.isInteger(h)||l<0||c<0||d<0||h<0||l>0xffffffffffff||c>4095||d>1073741823||h>4294967295)throw new RangeError("invalid field value");var p=new Uint8Array(16);return p[0]=l/Math.pow(2,40),p[1]=l/Math.pow(2,32),p[2]=l/Math.pow(2,24),p[3]=l/Math.pow(2,16),p[4]=l/Math.pow(2,8),p[5]=l,p[6]=112|c>>>8,p[7]=c,p[8]=128|d>>>24,p[9]=d>>>16,p[10]=d>>>8,p[11]=d,p[12]=h>>>24,p[13]=h>>>16,p[14]=h>>>8,p[15]=h,new qa(p)}toString(){for(var l="",c=0;c<this.bytes.length;c++)l=l+Yg.charAt(this.bytes[c]>>>4)+Yg.charAt(15&this.bytes[c]),3!==c&&5!==c&&7!==c&&9!==c||(l+="-");if(36!==l.length)throw new Error("Invalid UUIDv7 was generated");return l}clone(){return new qa(this.bytes.slice(0))}equals(l){return 0===this.compareTo(l)}compareTo(l){for(var c=0;c<16;c++){var d=this.bytes[c]-l.bytes[c];if(0!==d)return Math.sign(d)}return 0}}class Ba{constructor(){this._timestamp=0,this._counter=0,this._random=new Wa}generate(){var l=this.generateOrAbort();if(ei(l)){this._timestamp=0;var c=this.generateOrAbort();if(ei(c))throw new Error("Could not generate UUID after timestamp reset");return c}return l}generateOrAbort(){var l=Date.now();if(l>this._timestamp)this._timestamp=l,this._resetCounter();else{if(!(l+1e4>this._timestamp))return;this._counter++,this._counter>4398046511103&&(this._timestamp++,this._resetCounter())}return qa.fromFieldsV7(this._timestamp,Math.trunc(this._counter/Math.pow(2,30)),this._counter&Math.pow(2,30)-1,this._random.nextUint32())}_resetCounter(){this._counter=1024*this._random.nextUint32()+(1023&this._random.nextUint32())}}var Qg,$a=l=>{if("undefined"!=typeof UUIDV7_DENY_WEAK_RNG&&UUIDV7_DENY_WEAK_RNG)throw new Error("no cryptographically strong RNG available");for(var c=0;c<l.length;c++)l[c]=65536*Math.trunc(65536*Math.random())+Math.trunc(65536*Math.random());return l};sm&&!ei(sm.crypto)&&crypto.getRandomValues&&($a=l=>crypto.getRandomValues(l));class Wa{constructor(){this._buffer=new Uint32Array(8),this._cursor=1/0}nextUint32(){return this._cursor>=this._buffer.length&&($a(this._buffer),this._cursor=0),this._buffer[this._cursor++]}}var Ua=()=>Za().toString(),Za=()=>(Qg||(Qg=new Ba)).generate(),Xg="Mobile",ev="iOS",rv="Android",nv="Tablet",sv=rv+" "+nv,av="iPad",lv="Apple",cv=lv+" Watch",hv="Safari",pv="BlackBerry",mv="Samsung",yv=mv+"Browser",bv=mv+" Internet",wv="Chrome",Sv=wv+" OS",xv=wv+" "+ev,kv="Internet Explorer",Cv=kv+" "+Xg,Ev="Opera",Iv=Ev+" Mini",Tv="Edge",Rv="Microsoft "+Tv,Av="Firefox",Ov=Av+" "+ev,Mv="Nintendo",Nv="PlayStation",Pv="Xbox",Lv=rv+" "+Xg,jv=Xg+" "+hv,Dv="Windows",Fv=Dv+" Phone",$v="Nokia",Uv="Ouya",Bv="Generic",Hv=Bv+" "+Xg.toLowerCase(),zv=Bv+" "+nv.toLowerCase(),qv="Konqueror",Wv="(\\d+(\\.\\d+)?)",Vv=new RegExp("Version/"+Wv),Zv=new RegExp(Pv,"i"),Gv=new RegExp(Nv+" \\w+","i"),Kv=new RegExp(Mv+" \\w+","i"),Jv=new RegExp(pv+"|PlayBook|BB10","i"),Yv={"NT3.51":"NT 3.11","NT4.0":"NT 4.0","5.0":"2000",5.1:"XP",5.2:"XP","6.0":"Vista",6.1:"7",6.2:"8",6.3:"8.1",6.4:"10","10.0":"10"},Dl=function(l,c){return c=c||"",$r(l," OPR/")&&$r(l,"Mini")?Iv:$r(l," OPR/")?Ev:Jv.test(l)?pv:$r(l,"IE"+Xg)||$r(l,"WPDesktop")?Cv:$r(l,yv)?bv:$r(l,Tv)||$r(l,"Edg/")?Rv:$r(l,"FBIOS")?"Facebook "+Xg:$r(l,"UCWEB")||$r(l,"UCBrowser")?"UC Browser":$r(l,"CriOS")?xv:$r(l,"CrMo")||$r(l,wv)?wv:$r(l,rv)&&$r(l,hv)?Lv:$r(l,"FxiOS")?Ov:$r(l.toLowerCase(),qv.toLowerCase())?qv:((l,c)=>{return c&&$r(c,lv)||$r(d=l,hv)&&!$r(d,wv)&&!$r(d,rv);var d})(l,c)?$r(l,Xg)?jv:hv:$r(l,Av)?Av:$r(l,"MSIE")||$r(l,"Trident/")?kv:$r(l,"Gecko")?Av:""},Qv={[Cv]:[new RegExp("rv:"+Wv)],[Rv]:[new RegExp(Tv+"?\\/"+Wv)],[wv]:[new RegExp("("+wv+"|CrMo)\\/"+Wv)],[xv]:[new RegExp("CriOS\\/"+Wv)],"UC Browser":[new RegExp("(UCBrowser|UCWEB)\\/"+Wv)],[hv]:[Vv],[jv]:[Vv],[Ev]:[new RegExp("(Opera|OPR)\\/"+Wv)],[Av]:[new RegExp(Av+"\\/"+Wv)],[Ov]:[new RegExp("FxiOS\\/"+Wv)],[qv]:[new RegExp("Konqueror[:/]?"+Wv,"i")],[pv]:[new RegExp(pv+" "+Wv),Vv],[Lv]:[new RegExp("android\\s"+Wv,"i")],[bv]:[new RegExp(yv+"\\/"+Wv)],[kv]:[new RegExp("(rv:|MSIE )"+Wv)],Mozilla:[new RegExp("rv:"+Wv)]},ql=function(l,c){var d=Dl(l,c),h=Qv[d];if(ei(h))return null;for(var p=0;p<h.length;p++){var f=h[p],m=l.match(f);if(m)return parseFloat(m[m.length-2])}return null},Xv=[[new RegExp(Pv+"; "+Pv+" (.*?)[);]","i"),l=>[Pv,l&&l[1]||""]],[new RegExp(Mv,"i"),[Mv,""]],[new RegExp(Nv,"i"),[Nv,""]],[Jv,[pv,""]],[new RegExp(Dv,"i"),(l,c)=>{if(/Phone/.test(c)||/WPDesktop/.test(c))return[Fv,""];if(new RegExp(Xg).test(c)&&!/IEMobile\b/.test(c))return[Dv+" "+Xg,""];var d=/Windows NT ([0-9.]+)/i.exec(c);if(d&&d[1]){var h=d[1],p=Yv[h]||"";return/arm/i.test(c)&&(p="RT"),[Dv,p]}return[Dv,""]}],[/((iPhone|iPad|iPod).*?OS (\d+)_(\d+)_?(\d+)?|iPhone)/,l=>{if(l&&l[3]){var c=[l[3],l[4],l[5]||"0"];return[ev,c.join(".")]}return[ev,""]}],[/(watch.*\/(\d+\.\d+\.\d+)|watch os,(\d+\.\d+),)/i,l=>{var c="";return l&&l.length>=3&&(c=ei(l[2])?l[3]:l[2]),["watchOS",c]}],[new RegExp("("+rv+" (\\d+)\\.(\\d+)\\.?(\\d+)?|"+rv+")","i"),l=>{if(l&&l[2]){var c=[l[2],l[3],l[4]||"0"];return[rv,c.join(".")]}return[rv,""]}],[/Mac OS X (\d+)[_.](\d+)[_.]?(\d+)?/i,l=>{var c=["Mac OS X",""];if(l&&l[1]){var d=[l[1],l[2],l[3]||"0"];c[1]=d.join(".")}return c}],[/Mac/i,["Mac OS X",""]],[/CrOS/,[Sv,""]],[/Linux|debian/i,["Linux",""]]],Vl=function(l){return Kv.test(l)?Mv:Gv.test(l)?Nv:Zv.test(l)?Pv:new RegExp(Uv,"i").test(l)?Uv:new RegExp("("+Fv+"|WPDesktop)","i").test(l)?Fv:/iPad/.test(l)?av:/iPod/.test(l)?"iPod Touch":/iPhone/.test(l)?"iPhone":/(watch)(?: ?os[,/]|\d,\d\/)[\d.]+/i.test(l)?cv:Jv.test(l)?pv:/(kobo)\s(ereader|touch)/i.test(l)?"Kobo":new RegExp($v,"i").test(l)?$v:/(kf[a-z]{2}wi|aeo[c-r]{2})( bui|\))/i.test(l)||/(kf[a-z]+)( bui|\)).+silk\//i.test(l)?"Kindle Fire":/(Android|ZTE)/i.test(l)?!new RegExp(Xg).test(l)||/(9138B|TB782B|Nexus [97]|pixel c|HUAWEISHT|BTV|noble nook|smart ultra 6)/i.test(l)?/pixel[\daxl ]{1,6}/i.test(l)&&!/pixel c/i.test(l)||/(huaweimed-al00|tah-|APA|SM-G92|i980|zte|U304AA)/i.test(l)||/lmy47v/i.test(l)&&!/QTAQZ3/i.test(l)?rv:sv:rv:new RegExp("(pda|"+Xg+")","i").test(l)?Hv:new RegExp(nv,"i").test(l)&&!new RegExp(nv+" pc","i").test(l)?zv:""},$l=function(l){var c=Vl(l);return c===av||c===sv||"Kobo"===c||"Kindle Fire"===c||c===zv?nv:c===Mv||c===Pv||c===Nv||c===Uv?"Console":c===cv?"Wearable":c?Xg:"Desktop"},ey="$copy_autocapture",ty=function(l){return l.GZipJS="gzip-js",l.Base64="base64",l}({}),ry=Uint8Array,ny=Uint16Array,sy=Uint32Array,iy=new ry([0,0,0,0,0,0,0,0,1,1,1,1,2,2,2,2,3,3,3,3,4,4,4,4,5,5,5,5,0,0,0,0]),oy=new ry([0,0,0,0,1,1,2,2,3,3,4,4,5,5,6,6,7,7,8,8,9,9,10,10,11,11,12,12,13,13,0,0]),ay=new ry([16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15]),Jl=function(l,c){for(var d=new ny(31),h=0;h<31;++h)d[h]=c+=1<<l[h-1];var p=new sy(d[30]);for(h=1;h<30;++h)for(var f=d[h];f<d[h+1];++f)p[f]=f-d[h]<<5|h;return[d,p]},ly=Jl(iy,2),cy=ly[0],uy=ly[1];cy[28]=258,uy[258]=28;for(var dy=Jl(oy,0)[1],hy=new ny(32768),py=0;py<32768;++py){var fy=(43690&py)>>>1|(21845&py)<<1;fy=(61680&(fy=(52428&fy)>>>2|(13107&fy)<<2))>>>4|(3855&fy)<<4,hy[py]=((65280&fy)>>>8|(255&fy)<<8)>>>1}var ou=function(l,c,d){for(var h=l.length,p=0,f=new ny(c);p<h;++p)++f[l[p]-1];var m,y=new ny(c);for(p=0;p<c;++p)y[p]=y[p-1]+f[p-1]<<1;for(m=new ny(h),p=0;p<h;++p)m[p]=hy[y[l[p]-1]++]>>>15-l[p];return m},my=new ry(288);for(py=0;py<144;++py)my[py]=8;for(py=144;py<256;++py)my[py]=9;for(py=256;py<280;++py)my[py]=7;for(py=280;py<288;++py)my[py]=8;var gy=new ry(32);for(py=0;py<32;++py)gy[py]=5;var vy=ou(my,9),yy=ou(gy,5),du=function(l){return(l/8|0)+(7&l&&1)},hu=function(l,c,d){(null==d||d>l.length)&&(d=l.length);var h=new(l instanceof ny?ny:l instanceof sy?sy:ry)(d-c);return h.set(l.subarray(c,d)),h},pu=function(l,c,d){d<<=7&c;var h=c/8|0;l[h]|=d,l[h+1]|=d>>>8},vu=function(l,c,d){d<<=7&c;var h=c/8|0;l[h]|=d,l[h+1]|=d>>>8,l[h+2]|=d>>>16},fu=function(l,c){for(var d=[],h=0;h<l.length;++h)l[h]&&d.push({s:h,f:l[h]});var p=d.length,f=d.slice();if(!p)return[new ry(0),0];if(1==p){var m=new ry(d[0].s+1);return m[d[0].s]=1,[m,1]}d.sort((function(l,c){return l.f-c.f})),d.push({s:-1,f:25001});var y=d[0],_=d[1],b=0,w=1,E=2;for(d[0]={s:-1,f:y.f+_.f,l:y,r:_};w!=p-1;)y=d[d[b].f<d[E].f?b++:E++],_=d[b!=w&&d[b].f<d[E].f?b++:E++],d[w++]={s:-1,f:y.f+_.f,l:y,r:_};var M=f[0].s;for(h=1;h<p;++h)f[h].s>M&&(M=f[h].s);var N=new ny(M+1),P=gu(d[w-1],N,0);if(P>c){h=0;var L=0,j=P-c,D=1<<j;for(f.sort((function(l,c){return N[c.s]-N[l.s]||l.f-c.f}));h<p;++h){var F=f[h].s;if(!(N[F]>c))break;L+=D-(1<<P-N[F]),N[F]=c}for(L>>>=j;L>0;){var U=f[h].s;N[U]<c?L-=1<<c-N[U]++-1:++h}for(;h>=0&&L;--h){var B=f[h].s;N[B]==c&&(--N[B],++L)}P=c}return[new ry(N),P]},gu=function(l,c,d){return-1==l.s?Math.max(gu(l.l,c,d+1),gu(l.r,c,d+1)):c[l.s]=d},_u=function(l){for(var c=l.length;c&&!l[--c];);for(var d=new ny(++c),h=0,p=l[0],f=1,o2=function(l){d[h++]=l},m=1;m<=c;++m)if(l[m]==p&&m!=c)++f;else{if(!p&&f>2){for(;f>138;f-=138)o2(32754);f>2&&(o2(f>10?f-11<<5|28690:f-3<<5|12305),f=0)}else if(f>3){for(o2(p),--f;f>6;f-=6)o2(8304);f>2&&(o2(f-3<<5|8208),f=0)}for(;f--;)o2(p);f=1,p=l[m]}return[d.subarray(0,h),c]},mu=function(l,c){for(var d=0,h=0;h<c.length;++h)d+=l[h]*c[h];return d},yu=function(l,c,d){var h=d.length,p=du(c+2);l[p]=255&h,l[p+1]=h>>>8,l[p+2]=255^l[p],l[p+3]=255^l[p+1];for(var f=0;f<h;++f)l[p+f+4]=d[f];return 8*(p+4+h)},bu=function(l,c,d,h,p,f,m,y,_,b,w){pu(c,w++,d),++p[256];for(var E=fu(p,15),M=E[0],N=E[1],P=fu(f,15),L=P[0],j=P[1],D=_u(M),F=D[0],U=D[1],B=_u(L),H=B[0],z=B[1],q=new ny(19),V=0;V<F.length;++V)q[31&F[V]]++;for(V=0;V<H.length;++V)q[31&H[V]]++;for(var Z=fu(q,7),K=Z[0],Y=Z[1],ee=19;ee>4&&!K[ay[ee-1]];--ee);var ne,se,ie,oe,le=b+5<<3,ce=mu(p,my)+mu(f,gy)+m,pe=mu(p,M)+mu(f,L)+m+14+3*ee+mu(q,K)+(2*q[16]+3*q[17]+7*q[18]);if(le<=ce&&le<=pe)return yu(c,w,l.subarray(_,_+b));if(pu(c,w,1+(pe<ce)),w+=2,pe<ce){ne=ou(M,N),se=M,ie=ou(L,j),oe=L;var fe=ou(K,Y);for(pu(c,w,U-257),pu(c,w+5,z-1),pu(c,w+10,ee-4),w+=14,V=0;V<ee;++V)pu(c,w+3*V,K[ay[V]]);w+=3*ee;for(var ge=[F,H],be=0;be<2;++be){var Oe=ge[be];for(V=0;V<Oe.length;++V){var Ne=31&Oe[V];pu(c,w,fe[Ne]),w+=K[Ne],Ne>15&&(pu(c,w,Oe[V]>>>5&127),w+=Oe[V]>>>12)}}}else ne=vy,se=my,ie=yy,oe=gy;for(V=0;V<y;++V)if(h[V]>255){Ne=h[V]>>>18&31,vu(c,w,ne[Ne+257]),w+=se[Ne+257],Ne>7&&(pu(c,w,h[V]>>>23&31),w+=iy[Ne]);var De=31&h[V];vu(c,w,ie[De]),w+=oe[De],De>3&&(vu(c,w,h[V]>>>5&8191),w+=oy[De])}else vu(c,w,ne[h[V]]),w+=se[h[V]];return vu(c,w,ne[256]),w+se[256]},_y=new sy([65540,131080,131088,131104,262176,1048704,1048832,2114560,2117632]),by=function(){for(var l=new sy(256),c=0;c<256;++c){for(var d=c,h=9;--h;)d=(1&d&&3988292384)^d>>>1;l[c]=d}return l}(),Iu=function(l,c,d){for(;d;++c)l[c]=d,d>>>=8};function ku(l,c){void 0===c&&(c={});var d=function(){var l=4294967295;return{p:function(c){for(var d=l,h=0;h<c.length;++h)d=by[255&d^c[h]]^d>>>8;l=d},d:function(){return 4294967295^l}}}(),h=l.length;d.p(l);var p,f=function(l,c,d,h){return function(l,c,d,h,p){var f=l.length,m=new ry(h+f+5*(1+Math.floor(f/7e3))+p),y=m.subarray(h,m.length-p),_=0;if(!c||f<8)for(var b=0;b<=f;b+=65535){var w=b+65535;w<f?_=yu(y,_,l.subarray(b,w)):(y[b]=!0,_=yu(y,_,l.subarray(b,f)))}else{for(var E=_y[c-1],M=E>>>13,N=8191&E,P=(1<<d)-1,L=new ny(32768),j=new ny(P+1),D=Math.ceil(d/3),F=2*D,b3=function(c){return(l[c]^l[c+1]<<D^l[c+2]<<F)&P},U=new sy(25e3),B=new ny(288),H=new ny(32),z=0,q=0,V=(b=0,0),Z=0,K=0;b<f;++b){var Y=b3(b),ee=32767&b,ne=j[Y];if(L[ee]=ne,j[Y]=ee,Z<=b){var se=f-b;if((z>7e3||V>24576)&&se>423){_=bu(l,y,0,U,B,H,q,V,K,b-K,_),V=z=q=0,K=b;for(var ie=0;ie<286;++ie)B[ie]=0;for(ie=0;ie<30;++ie)H[ie]=0}var oe=2,le=0,ce=N,pe=ee-ne&32767;if(se>2&&Y==b3(b-pe))for(var fe=Math.min(M,se)-1,ge=Math.min(32767,b),be=Math.min(258,se);pe<=ge&&--ce&&ee!=ne;){if(l[b+oe]==l[b+oe-pe]){for(var Oe=0;Oe<be&&l[b+Oe]==l[b+Oe-pe];++Oe);if(Oe>oe){if(oe=Oe,le=pe,Oe>fe)break;var Ne=Math.min(pe,Oe-2),De=0;for(ie=0;ie<Ne;++ie){var Fe=b-pe+ie+32768&32767,Ue=Fe-L[Fe]+32768&32767;Ue>De&&(De=Ue,ne=Fe)}}}pe+=(ee=ne)-(ne=L[ee])+32768&32767}if(le){U[V++]=268435456|uy[oe]<<18|dy[le];var Be=31&uy[oe],He=31&dy[le];q+=iy[Be]+oy[He],++B[257+Be],++H[He],Z=b+oe,++z}else U[V++]=l[b],++B[l[b]]}}_=bu(l,y,!0,U,B,H,q,V,K,b-K,_)}return hu(m,0,h+du(_)+p)}(l,null==c.level?6:c.level,null==c.mem?Math.ceil(1.5*Math.max(8,Math.min(13,Math.log(l.length)))):12+c.mem,d,h)}(l,c,10+((p=c).filename&&p.filename.length+1||0),8),m=f.length;return function(l,c){var d=c.filename;if(l[0]=31,l[1]=139,l[2]=8,l[8]=c.level<2?4:9==c.level?2:0,l[9]=3,0!=c.mtime&&Iu(l,4,Math.floor(new Date(c.mtime||Date.now())/1e3)),d){l[3]=8;for(var h=0;h<=d.length;++h)l[h+10]=d.charCodeAt(h)}}(f,c),Iu(f,m-8,d.d()),Iu(f,m-4,h),f}var wy=!!pm||!!hm,Sy="text/plain",Mu=function(l,c,d){var h;void 0===d&&(d=!0);var[p,f]=l.split("?"),m=r$2({},c),y=null!==(h=null==f?void 0:f.split("&").map((l=>{var c,[h,p]=l.split("="),f=d&&null!==(c=m[h])&&void 0!==c?c:p;return delete m[h],h+"="+f})))&&void 0!==h?h:[],_=Tn(m);return _&&y.push(_),p+"?"+y.join("&")},Ru=(l,c)=>JSON.stringify(l,((l,c)=>"bigint"==typeof c?c.toString():c),c),Au=l=>{var c,{data:d,compression:h}=l;if(d){if(h===ty.GZipJS){var p=ku(function(l){var c=l.length;if("undefined"!=typeof TextEncoder)return(new TextEncoder).encode(l);for(var d=new ry(l.length+(l.length>>>1)),h=0,s3=function(l){d[h++]=l},p=0;p<c;++p){if(h+5>d.length){var f=new ry(h+8+(c-p<<1));f.set(d),d=f}var m=l.charCodeAt(p);m<128?s3(m):m<2048?(s3(192|m>>>6),s3(128|63&m)):m>55295&&m<57344?(s3(240|(m=65536+(1047552&m)|1023&l.charCodeAt(++p))>>>18),s3(128|m>>>12&63),s3(128|m>>>6&63),s3(128|63&m)):(s3(224|m>>>12),s3(128|m>>>6&63),s3(128|63&m))}return hu(d,0,h)}(Ru(d)),{mtime:0}),f=new Blob([p],{type:Sy});return{contentType:Sy,body:f,estimatedSize:f.size}}if(h===ty.Base64){var m=function(l){var c,d,h,p,f,m="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",y=0,_=0,b="",w=[];if(!l)return l;l=function(l){var c,d,h,p,f="";for(c=d=0,h=(l=(l+"").replace(/\r\n/g,"\n").replace(/\r/g,"\n")).length,p=0;p<h;p++){var m=l.charCodeAt(p),y=null;m<128?d++:y=m>127&&m<2048?String.fromCharCode(m>>6|192,63&m|128):String.fromCharCode(m>>12|224,m>>6&63|128,63&m|128),ii(y)||(d>c&&(f+=l.substring(c,d)),f+=y,c=d=p+1)}return d>c&&(f+=l.substring(c,l.length)),f}(l);do{c=(f=l.charCodeAt(y++)<<16|l.charCodeAt(y++)<<8|l.charCodeAt(y++))>>18&63,d=f>>12&63,h=f>>6&63,p=63&f,w[_++]=m.charAt(c)+m.charAt(d)+m.charAt(h)+m.charAt(p)}while(y<l.length);switch(b=w.join(""),l.length%3){case 1:b=b.slice(0,-2)+"==";break;case 2:b=b.slice(0,-1)+"="}return b}(Ru(d)),y=(c=m,"data="+encodeURIComponent("string"==typeof c?c:Ru(c)));return{contentType:"application/x-www-form-urlencoded",body:y,estimatedSize:new Blob([y]).size}}var _=Ru(d);return{contentType:"application/json",body:_,estimatedSize:new Blob([_]).size}}},xy=[];hm&&xy.push({transport:"fetch",method:l=>{var c,d,{contentType:h,body:p,estimatedSize:f}=null!==(c=Au(l))&&void 0!==c?c:{},m=new Headers;fn(l.headers,(function(l,c){m.append(c,l)})),h&&m.append("Content-Type",h);var y=l.url,_=null;if(fm){var b=new fm;_={signal:b.signal,timeout:setTimeout((()=>b.abort()),l.timeout)}}hm(y,r$2({method:(null==l?void 0:l.method)||"GET",headers:m,keepalive:"POST"===l.method&&(f||0)<52428.8,body:p,signal:null==(d=_)?void 0:d.signal},l.fetchOptions)).then((c=>c.text().then((d=>{var h={statusCode:c.status,text:d};if(200===c.status)try{h.json=JSON.parse(d)}catch(p){ym.error(p)}null==l.callback||l.callback(h)})))).catch((c=>{ym.error(c),null==l.callback||l.callback({statusCode:0,text:c})})).finally((()=>_?clearTimeout(_.timeout):null))}}),pm&&xy.push({transport:"XHR",method:l=>{var c,d=new pm;d.open(l.method||"GET",l.url,!0);var{contentType:h,body:p}=null!==(c=Au(l))&&void 0!==c?c:{};fn(l.headers,(function(l,c){d.setRequestHeader(c,l)})),h&&d.setRequestHeader("Content-Type",h),l.timeout&&(d.timeout=l.timeout),l.disableXHRCredentials||(d.withCredentials=!0),d.onreadystatechange=()=>{if(4===d.readyState){var c={statusCode:d.status,text:d.responseText};if(200===d.status)try{c.json=JSON.parse(d.responseText)}catch(h){}null==l.callback||l.callback(c)}},d.send(p)}}),null!=cm&&cm.sendBeacon&&xy.push({transport:"sendBeacon",method:l=>{var c=Mu(l.url,{beacon:"1"});try{var d,{contentType:h,body:p}=null!==(d=Au(l))&&void 0!==d?d:{},f="string"==typeof p?new Blob([p],{type:h}):p;cm.sendBeacon(c,f)}catch(m){}}});var Pu=function(l,c){if(!function(l){try{new RegExp(l)}catch(c){return!1}return!0}(c))return!1;try{return new RegExp(c).test(l)}catch(d){return!1}};function Fu(l,c,d){return Ru({distinct_id:l,userPropertiesToSet:c,userPropertiesToSetOnce:d})}var ky={exact:(l,c)=>c.some((c=>l.some((l=>c===l)))),is_not:(l,c)=>c.every((c=>l.every((l=>c!==l)))),regex:(l,c)=>c.some((c=>l.some((l=>Pu(c,l))))),not_regex:(l,c)=>c.every((c=>l.every((l=>!Pu(c,l))))),icontains:(l,c)=>c.map(Ou).some((c=>l.map(Ou).some((l=>c.includes(l))))),not_icontains:(l,c)=>c.map(Ou).every((c=>l.map(Ou).every((l=>!c.includes(l)))))},Ou=l=>l.toLowerCase(),Cy=_m("[Stylesheet Loader]"),Ey=sm,Iy=um;function Bu(l){return"$survey_response_"+l}var Ty="#020617",Ry={fontFamily:"inherit",backgroundColor:"#eeeded",submitButtonColor:"black",submitButtonTextColor:"white",ratingButtonColor:"white",ratingButtonActiveColor:"black",borderColor:"#c9c6c6",placeholder:"Start typing...",whiteLabel:!1,displayThankYouMessage:!0,thankYouMessageHeader:"Thank you for your feedback!",position:Fg.Right,widgetType:Dg.Tab,widgetLabel:"Feedback",widgetColor:"black",zIndex:"2147483647",disabledButtonOpacity:"0.6",maxWidth:"300px",textSubtleColor:"#939393",boxPadding:"20px 24px",boxShadow:"0 4px 12px rgba(0, 0, 0, 0.15)",borderRadius:"10px",shuffleQuestions:!1,surveyPopupDelaySeconds:void 0,outlineColor:"rgba(59, 130, 246, 0.8)",inputBackground:"white",inputTextColor:Ty,scrollbarThumbColor:"var(--ph-survey-border-color)",scrollbarTrackColor:"var(--ph-survey-background-color)"};function Wu(l){if("#"===l[0]){var c=l.replace(/^#/,"");return"rgb("+parseInt(c.slice(0,2),16)+","+parseInt(c.slice(2,4),16)+","+parseInt(c.slice(4,6),16)+")"}return"rgb(255, 255, 255)"}function Uu(l){var c;void 0===l&&(l=Ry.backgroundColor),"#"===l[0]&&(c=Wu(l)),l.startsWith("rgb")&&(c=l);var d={aliceblue:"#f0f8ff",antiquewhite:"#faebd7",aqua:"#00ffff",aquamarine:"#7fffd4",azure:"#f0ffff",beige:"#f5f5dc",bisque:"#ffe4c4",black:"#000000",blanchedalmond:"#ffebcd",blue:"#0000ff",blueviolet:"#8a2be2",brown:"#a52a2a",burlywood:"#deb887",cadetblue:"#5f9ea0",chartreuse:"#7fff00",chocolate:"#d2691e",coral:"#ff7f50",cornflowerblue:"#6495ed",cornsilk:"#fff8dc",crimson:"#dc143c",cyan:"#00ffff",darkblue:"#00008b",darkcyan:"#008b8b",darkgoldenrod:"#b8860b",darkgray:"#a9a9a9",darkgreen:"#006400",darkkhaki:"#bdb76b",darkmagenta:"#8b008b",darkolivegreen:"#556b2f",darkorange:"#ff8c00",darkorchid:"#9932cc",darkred:"#8b0000",darksalmon:"#e9967a",darkseagreen:"#8fbc8f",darkslateblue:"#483d8b",darkslategray:"#2f4f4f",darkturquoise:"#00ced1",darkviolet:"#9400d3",deeppink:"#ff1493",deepskyblue:"#00bfff",dimgray:"#696969",dodgerblue:"#1e90ff",firebrick:"#b22222",floralwhite:"#fffaf0",forestgreen:"#228b22",fuchsia:"#ff00ff",gainsboro:"#dcdcdc",ghostwhite:"#f8f8ff",gold:"#ffd700",goldenrod:"#daa520",gray:"#808080",green:"#008000",greenyellow:"#adff2f",honeydew:"#f0fff0",hotpink:"#ff69b4","indianred ":"#cd5c5c",indigo:"#4b0082",ivory:"#fffff0",khaki:"#f0e68c",lavender:"#e6e6fa",lavenderblush:"#fff0f5",lawngreen:"#7cfc00",lemonchiffon:"#fffacd",lightblue:"#add8e6",lightcoral:"#f08080",lightcyan:"#e0ffff",lightgoldenrodyellow:"#fafad2",lightgrey:"#d3d3d3",lightgreen:"#90ee90",lightpink:"#ffb6c1",lightsalmon:"#ffa07a",lightseagreen:"#20b2aa",lightskyblue:"#87cefa",lightslategray:"#778899",lightsteelblue:"#b0c4de",lightyellow:"#ffffe0",lime:"#00ff00",limegreen:"#32cd32",linen:"#faf0e6",magenta:"#ff00ff",maroon:"#800000",mediumaquamarine:"#66cdaa",mediumblue:"#0000cd",mediumorchid:"#ba55d3",mediumpurple:"#9370d8",mediumseagreen:"#3cb371",mediumslateblue:"#7b68ee",mediumspringgreen:"#00fa9a",mediumturquoise:"#48d1cc",mediumvioletred:"#c71585",midnightblue:"#191970",mintcream:"#f5fffa",mistyrose:"#ffe4e1",moccasin:"#ffe4b5",navajowhite:"#ffdead",navy:"#000080",oldlace:"#fdf5e6",olive:"#808000",olivedrab:"#6b8e23",orange:"#ffa500",orangered:"#ff4500",orchid:"#da70d6",palegoldenrod:"#eee8aa",palegreen:"#98fb98",paleturquoise:"#afeeee",palevioletred:"#d87093",papayawhip:"#ffefd5",peachpuff:"#ffdab9",peru:"#cd853f",pink:"#ffc0cb",plum:"#dda0dd",powderblue:"#b0e0e6",purple:"#800080",red:"#ff0000",rosybrown:"#bc8f8f",royalblue:"#4169e1",saddlebrown:"#8b4513",salmon:"#fa8072",sandybrown:"#f4a460",seagreen:"#2e8b57",seashell:"#fff5ee",sienna:"#a0522d",silver:"#c0c0c0",skyblue:"#87ceeb",slateblue:"#6a5acd",slategray:"#708090",snow:"#fffafa",springgreen:"#00ff7f",steelblue:"#4682b4",tan:"#d2b48c",teal:"#008080",thistle:"#d8bfd8",tomato:"#ff6347",turquoise:"#40e0d0",violet:"#ee82ee",wheat:"#f5deb3",white:"#ffffff",whitesmoke:"#f5f5f5",yellow:"#ffff00",yellowgreen:"#9acd32"}[l.toLowerCase()];if(d&&(c=Wu(d)),!c)return Ty;var h=c.match(/^rgba?\((\d+),\s*(\d+),\s*(\d+)(?:,\s*(\d+(?:\.\d+)?))?\)$/);if(h){var p=parseInt(h[1]),f=parseInt(h[2]),m=parseInt(h[3]);return Math.sqrt(p*p*.299+f*f*.587+m*m*.114)>127.5?Ty:"white"}return Ty}var Ay,Oy,zu=(l,c,d)=>{var h=cc(l),p=Iy.querySelector("."+h);if(p&&p.shadowRoot)return{shadow:p.shadowRoot,isNewlyCreated:!1};var f,m,y,_,b,w,E=Iy.createElement("div");f=E,m=l.type,y=l.appearance,_=r$2({},Ry,y),b=f.style,w=![Fg.Center,Fg.Left,Fg.Right].includes(_.position)||m===$g.Widget&&(null==y?void 0:y.widgetType)===Dg.Tab,b.setProperty("--ph-survey-font-family",function(l){if("inherit"===l)return"inherit";var c='BlinkMacSystemFont, "Inter", "Segoe UI", "Roboto", Helvetica, Arial, sans-serif, "Apple Color Emoji", "Segoe UI Emoji", "Segoe UI Symbol"';return l?l+", "+c:"-apple-system, "+c}(_.fontFamily)),b.setProperty("--ph-survey-box-padding",_.boxPadding),b.setProperty("--ph-survey-max-width",_.maxWidth),b.setProperty("--ph-survey-z-index",_.zIndex),b.setProperty("--ph-survey-border-color",_.borderColor),w?(b.setProperty("--ph-survey-border-radius",_.borderRadius),b.setProperty("--ph-survey-border-bottom","1.5px solid var(--ph-survey-border-color)")):(b.setProperty("--ph-survey-border-bottom","none"),b.setProperty("--ph-survey-border-radius",_.borderRadius+" "+_.borderRadius+" 0 0")),b.setProperty("--ph-survey-background-color",_.backgroundColor),b.setProperty("--ph-survey-box-shadow",_.boxShadow),b.setProperty("--ph-survey-disabled-button-opacity",_.disabledButtonOpacity),b.setProperty("--ph-survey-submit-button-color",_.submitButtonColor),b.setProperty("--ph-survey-submit-button-text-color",(null==y?void 0:y.submitButtonTextColor)||Uu(_.submitButtonColor)),b.setProperty("--ph-survey-rating-bg-color",_.ratingButtonColor),b.setProperty("--ph-survey-rating-text-color",Uu(_.ratingButtonColor)),b.setProperty("--ph-survey-rating-active-bg-color",_.ratingButtonActiveColor),b.setProperty("--ph-survey-rating-active-text-color",Uu(_.ratingButtonActiveColor)),b.setProperty("--ph-survey-text-primary-color",Uu(_.backgroundColor)),b.setProperty("--ph-survey-text-subtle-color",_.textSubtleColor),b.setProperty("--ph-widget-color",_.widgetColor),b.setProperty("--ph-widget-text-color",Uu(_.widgetColor)),b.setProperty("--ph-widget-z-index",_.zIndex),"white"===_.backgroundColor&&b.setProperty("--ph-survey-input-background","#f8f8f8"),b.setProperty("--ph-survey-input-background",_.inputBackground),b.setProperty("--ph-survey-input-text-color",Uu(_.inputBackground)),b.setProperty("--ph-survey-scrollbar-thumb-color",_.scrollbarThumbColor),b.setProperty("--ph-survey-scrollbar-track-color",_.scrollbarTrackColor),b.setProperty("--ph-survey-outline-color",_.outlineColor),E.className=h;var M=E.attachShadow({mode:"open"}),N=function(l){var c,d,h,p=(c=l,(h=Iy.createElement("style")).innerText=':host{--ph-survey-font-family:-apple-system,BlinkMacSystemFont,"Inter","Segoe UI","Roboto",Helvetica,Arial,sans-serif,"Apple Color Emoji","Segoe UI Emoji","Segoe UI Symbol";--ph-survey-box-padding:20px 24px;--ph-survey-max-width:300px;--ph-survey-z-index:2147483647;--ph-survey-border-color:#dcdcdc;--ph-survey-border-bottom:1.5px solid var(--ph-survey-border-color);--ph-survey-border-radius:10px;--ph-survey-background-color:#eeeded;--ph-survey-box-shadow:0 4px 12px rgba(0,0,0,.15);--ph-survey-submit-button-color:#000;--ph-survey-submit-button-text-color:#fff;--ph-survey-rating-bg-color:#fff;--ph-survey-rating-text-color:#020617;--ph-survey-rating-active-bg-color:#000;--ph-survey-rating-active-text-color:#fff;--ph-survey-text-primary-color:#020617;--ph-survey-text-subtle-color:#939393;--ph-widget-color:#e0a045;--ph-widget-text-color:#fff;--ph-survey-scrollbar-thumb-color:var(--ph-survey-border-color);--ph-survey-scrollbar-track-color:var(--ph-survey-background-color);--ph-survey-outline-color:rgba(59,130,246,.8);--ph-survey-input-background:#fff;--ph-survey-input-text-color:#020617;--ph-survey-disabled-button-opacity:0.6}.ph-survey{bottom:0;height:fit-content;margin:0;max-width:85%;min-width:300px;position:fixed;width:var(--ph-survey-max-width);z-index:var(--ph-survey-z-index)}.ph-survey h3,.ph-survey p{margin:0}.ph-survey *{box-sizing:border-box;color:var(--ph-survey-text-primary-color);font-family:var(--ph-survey-font-family)}.ph-survey .multiple-choice-options label,.ph-survey input[type=text],.ph-survey textarea{background:var(--ph-survey-input-background);border:1.5px solid var(--ph-survey-border-color);border-radius:4px;color:var(--ph-survey-input-text-color);padding:10px;transition:border-color .2s ease-out,box-shadow .2s ease-out,transform .15s ease-out}.ph-survey input[type=text],.ph-survey textarea{transition:border-color .2s ease-out,box-shadow .2s ease-out,transform .15s ease-out}.ph-survey input{margin:0}.ph-survey .form-submit:focus,.ph-survey .form-submit:focus-visible,.ph-survey input[type=checkbox]:focus,.ph-survey input[type=checkbox]:focus-visible,.ph-survey input[type=radio]:focus,.ph-survey input[type=radio]:focus-visible,.ph-survey input[type=text]:focus,.ph-survey input[type=text]:focus-visible,.ph-survey textarea:focus,.ph-survey textarea:focus-visible{border-color:var(--ph-survey-rating-active-bg-color);outline:1.5px solid var(--ph-survey-outline-color);outline-offset:2px}.ph-survey button:focus:not(:focus-visible),.ph-survey input[type=checkbox]:focus:not(:focus-visible),.ph-survey input[type=radio]:focus:not(:focus-visible),.ph-survey input[type=text]:focus:not(:focus-visible),.ph-survey textarea:focus:not(:focus-visible){outline:none}.ph-survey input[type=text]:hover:not(:focus),.ph-survey textarea:hover:not(:focus){border-color:var(--ph-survey-rating-active-bg-color)}@media (max-width:768px){.ph-survey input[type=text],.ph-survey textarea{font-size:1rem}}.ph-survey .form-cancel,.ph-survey .multiple-choice-options label,.ph-survey .rating-options-number,.ph-survey input[type=checkbox],.ph-survey input[type=radio]{border:1.5px solid var(--ph-survey-border-color)}.ph-survey .footer-branding,.ph-survey .form-cancel,.ph-survey .form-submit,.ph-survey .ratings-emoji,.ph-survey .ratings-number,.ph-survey input[type=checkbox],.ph-survey input[type=radio],.ph-survey label{transition:all .2s ease-out}@media (prefers-reduced-motion:no-preference){.ph-survey button:active,.ph-survey input[type=checkbox]:active,.ph-survey input[type=radio]:active,.ph-survey label:active{transition-duration:.1s}}.ph-survey-widget-tab{background:var(--ph-widget-color);border:none;border-radius:3px 3px 0 0;color:var(--ph-widget-text-color);cursor:pointer;padding:10px 12px;position:fixed;right:0;text-align:center;top:50%;transform:rotate(-90deg) translateY(-100%);transform-origin:right top;transition:padding-bottom .2s ease-out;z-index:var(--ph-survey-z-index)}.ph-survey-widget-tab:hover{padding-bottom:16px}@keyframes ph-survey-fade-in{0%{opacity:0}to{opacity:1}}.survey-box{gap:16px}.bottom-section,.survey-box{display:flex;flex-direction:column}.bottom-section{gap:8px}.thank-you-message-header~.bottom-section{padding-top:16px}.question-container,.thank-you-message{display:flex;flex-direction:column;gap:8px}.survey-question{font-size:14px;font-weight:500}.survey-question-description{font-size:13px;opacity:.8;padding-top:4px}.question-textarea-wrapper{display:flex;flex-direction:column}.survey-form{animation:ph-survey-fade-in .3s ease-out forwards}.survey-form,.thank-you-message{background:var(--ph-survey-background-color);border:1.5px solid var(--ph-survey-border-color);border-bottom:var(--ph-survey-border-bottom);border-radius:var(--ph-survey-border-radius);box-shadow:var(--ph-survey-box-shadow);margin:0;padding:var(--ph-survey-box-padding);position:relative;text-align:left;width:100%;z-index:var(--ph-survey-z-index)}.survey-form input[type=text],.survey-form textarea{min-width:100%}:is(.survey-form textarea):focus,:is(.survey-form textarea):focus-visible{box-shadow:0 4px 12px rgba(0,0,0,.08)}:is(.survey-form textarea):focus:not(:focus-visible){box-shadow:none}.survey-box:has(.survey-question:empty):not(:has(.survey-question-description)) .multiple-choice-options,.survey-box:has(.survey-question:empty):not(:has(.survey-question-description)) textarea{margin-top:0}.multiple-choice-options{border:none;display:flex;flex-direction:column;font-size:14px;gap:8px;margin:0;padding:1px 0}.multiple-choice-options .response-choice,.multiple-choice-options label{align-items:center;color:inherit;display:flex;gap:8px}.multiple-choice-options label{cursor:pointer;font-size:13px}:is(.multiple-choice-options label):hover:not(:has(input:checked)){border-color:var(--ph-survey-text-subtle-color);box-shadow:0 2px 8px rgba(0,0,0,.08)}:is(.multiple-choice-options label):has(input:checked){border-color:var(--ph-survey-rating-active-bg-color);box-shadow:0 1px 4px rgba(0,0,0,.05)}.choice-option-open:is(.multiple-choice-options label){flex-wrap:wrap}:is(.multiple-choice-options label) span{color:inherit}.multiple-choice-options input[type=checkbox],.multiple-choice-options input[type=radio]{appearance:none;-webkit-appearance:none;-moz-appearance:none;background:var(--ph-survey-input-background);border-radius:3px;cursor:pointer;flex-shrink:0;height:1rem;position:relative;transition:all .2s cubic-bezier(.4,0,.2,1),transform .15s ease-out;width:1rem;z-index:1}:is(.multiple-choice-options input[type=checkbox],.multiple-choice-options input[type=radio]):focus{transform:scale(1.05)}:is(.multiple-choice-options input[type=checkbox],.multiple-choice-options input[type=radio]):hover{border-color:var(--ph-survey-rating-active-bg-color);transform:scale(1.05)}:is(.multiple-choice-options input[type=checkbox],.multiple-choice-options input[type=radio]):active{transform:scale(.95)}:is(.multiple-choice-options input[type=checkbox],.multiple-choice-options input[type=radio]):checked{background:var(--ph-survey-rating-active-bg-color);border-color:var(--ph-survey-rating-active-bg-color);transform:scale(1)}:is(.multiple-choice-options input[type=checkbox],.multiple-choice-options input[type=radio]):checked:hover{transform:scale(1.05)}.multiple-choice-options input[type=checkbox]:checked:after{animation:ph-survey-checkmark-reveal .2s ease-out .1s forwards;border:solid var(--ph-survey-rating-active-text-color);border-width:0 2px 2px 0;height:8px;left:4px;transform:rotate(45deg) scale(0);width:4px}.multiple-choice-options input[type=radio]:checked:after{animation:ph-survey-radio-reveal .15s ease-out .05s forwards;background:var(--ph-survey-rating-active-text-color);border-radius:50%;height:6px;left:5px;top:5px;transform:scale(0);width:6px}.multiple-choice-options input[type=checkbox]:checked:after,.multiple-choice-options input[type=radio]:checked:after{box-sizing:content-box;content:"";position:absolute}.multiple-choice-options input[type=radio]{border-radius:50%}.multiple-choice-options input[type=radio]:checked{border:none}:is(.multiple-choice-options input[type=checkbox]:checked,.multiple-choice-options input[type=radio]:checked)~*{font-weight:700}:is(:is(.multiple-choice-options .choice-option-open) input[type=text])::placeholder{color:var(--ph-survey-text-subtle-color);font-weight:400}.rating-options-emoji{display:flex;justify-content:space-between}.ratings-emoji{background-color:transparent;border:none;font-size:16px;opacity:.5;padding:0}.ratings-emoji:hover{cursor:pointer;opacity:1;transform:scale(1.15)}.ratings-emoji.rating-active{opacity:1}.ratings-emoji svg{fill:var(--ph-survey-text-primary-color);transition:fill .2s ease-out}.rating-options-number{border-radius:6px;display:grid;grid-auto-columns:1fr;grid-auto-flow:column;overflow:hidden}.rating-options-number .ratings-number{border:none;border-right:1px solid var(--ph-survey-border-color);color:var(--ph-survey-rating-text-color);cursor:pointer;font-weight:700;text-align:center}:is(.rating-options-number .ratings-number):last-of-type{border-right:0}.rating-active:is(.rating-options-number .ratings-number){background:var(--ph-survey-rating-active-bg-color);color:var(--ph-survey-rating-active-text-color)}.ratings-number{background-color:var(--ph-survey-rating-bg-color);border:none;padding:8px 0}.ratings-number .rating-active{background-color:var(--ph-survey-rating-active-bg-color)}.ratings-number:hover{cursor:pointer}.rating-text{display:flex;flex-direction:row;font-size:11px;justify-content:space-between;opacity:.7}.form-submit{background:var(--ph-survey-submit-button-color);border:none;border-radius:6px;box-shadow:0 2px 0 rgba(0,0,0,.045);color:var(--ph-survey-submit-button-text-color);cursor:pointer;font-weight:700;min-width:100%;padding:12px;text-align:center;user-select:none}.form-submit:not([disabled]):hover{box-shadow:0 4px 8px rgba(0,0,0,.1);transform:scale(1.02)}.form-submit:not([disabled]):active{box-shadow:0 1px 2px rgba(0,0,0,.05);transform:scale(.98)}.form-submit[disabled]{cursor:not-allowed;opacity:var(--ph-survey-disabled-button-opacity)}.form-cancel{background:#fff;border-radius:100%;cursor:pointer;line-height:0;padding:12px;position:absolute;right:0;top:0;transform:translate(50%,-50%)}.form-cancel:hover{opacity:.7;transform:translate(50%,-50%) scale(1.1)}.footer-branding{align-items:center;display:flex;font-size:11px;font-weight:500;gap:4px;justify-content:center;opacity:.6;text-decoration:none}.footer-branding:hover{opacity:1}.footer-branding a{text-decoration:none}.thank-you-message{text-align:center}.thank-you-message-header{margin:10px 0 0}.thank-you-message-body{font-size:14px;opacity:.8}.limit-height{max-height:256px;overflow-x:hidden;overflow-y:auto;scrollbar-color:var(--ph-survey-scrollbar-thumb-color) var(--ph-survey-scrollbar-track-color);scrollbar-width:thin}.limit-height::-webkit-scrollbar{width:8px}.limit-height::-webkit-scrollbar-track{background:var(--ph-survey-scrollbar-track-color);border-radius:4px}.limit-height::-webkit-scrollbar-thumb{background-color:var(--ph-survey-scrollbar-thumb-color);border:2px solid var(--ph-survey-scrollbar-track-color);border-radius:4px}:is(.limit-height::-webkit-scrollbar-thumb):hover{background-color:var(--ph-survey-text-subtle-color)}.sr-only{clip:rect(0,0,0,0);border:0;height:1px;margin:-1px;overflow:hidden;padding:0;position:absolute;white-space:nowrap;width:1px}@media (prefers-reduced-motion:reduce){.ph-survey *{animation-duration:.01ms!important;animation-iteration-count:1!important;scroll-behavior:auto!important;transition-duration:.01ms!important}}@keyframes ph-survey-checkmark-reveal{0%{opacity:0;transform:rotate(45deg) scale(0)}50%{opacity:1;transform:rotate(45deg) scale(1.2)}to{opacity:1;transform:rotate(45deg) scale(1)}}@keyframes ph-survey-radio-reveal{0%{opacity:0;transform:scale(0)}50%{opacity:1;transform:scale(1.3)}to{opacity:1;transform:scale(1)}}',null!=c&&null!=(d=c.config)&&d.prepare_external_dependency_stylesheet&&(h=c.config.prepare_external_dependency_stylesheet(h)),h||(Cy.error("prepare_external_dependency_stylesheet returned null"),null));return null==p||p.setAttribute("data-ph-survey-style","true"),p}(c);if(N){var P=M.querySelector("style");P&&M.removeChild(P),M.appendChild(N)}return Iy.body.appendChild(E),{shadow:M,isNewlyCreated:!0}},ju=(l,c)=>{if(!c)return null;var d=l[Bu(c)];return zf(d)?[...d]:d},Gu=l=>{var{responses:c,survey:d,surveySubmissionId:h,posthog:p,isSurveyCompleted:f}=l;p?(La(d),p.capture(zg.SENT,r$2({[qg.SURVEY_NAME]:d.name,[qg.SURVEY_ID]:d.id,[qg.SURVEY_ITERATION]:d.current_iteration,[qg.SURVEY_ITERATION_START_DATE]:d.current_iteration_start_date,[qg.SURVEY_QUESTIONS]:d.questions.map((l=>({id:l.id,question:l.question,response:ju(c,l.id)}))),[qg.SURVEY_SUBMISSION_ID]:h,[qg.SURVEY_COMPLETED]:f,sessionRecordingUrl:null==p.get_session_replay_url?void 0:p.get_session_replay_url()},c,{$set:{[Pa(d,"responded")]:!0}})),f&&(Ey.dispatchEvent(new CustomEvent("PHSurveySent",{detail:{surveyId:d.id}})),uc(d))):Vg.error("[survey sent] event not captured, PostHog instance not found.")},Xu=l=>l.map((l=>({sort:Math.floor(10*Math.random()),value:l}))).sort(((l,c)=>l.sort-c.sort)).map((l=>l.value)),Ku=(l,c)=>l.length===c.length&&l.every(((l,d)=>l===c[d]))?c.reverse():c,Qu=l=>{var c,d,h,p;return!!(null!=(c=l.conditions)&&null!=(c=c.events)&&c.repeatedActivation&&(d=l,null!=(null==(h=d.conditions)||null==(h=h.events)||null==(h=h.values)?void 0:h.length)&&(null==(p=d.conditions)||null==(p=p.events)||null==(p=p.values)?void 0:p.length)>0))||l.schedule===Hg.Always||lc(l)},My=(Oy={__c:Ay="__cC"+_g++,__:{isPreviewMode:!1,previewPageIndex:0,onPopupSurveyDismissed:()=>{},isPopup:!0,onPreviewSubmit:()=>{},surveySubmissionId:""},Consumer:function(l,c){return l.children(c)},Provider:function(l){var c,d;return this.getChildContext||(c=[],(d={})[Ay]=this,this.getChildContext=function(){return d},this.shouldComponentUpdate=function(l){this.props.value!==l.value&&c.some((function(l){l.__e=!0,Ao(l)}))},this.sub=function(l){c.push(l);var d=l.componentWillUnmount;l.componentWillUnmount=function(){c.splice(c.indexOf(l),1),d&&d.call(l)}}),l.children}}).Provider.__=Oy.Consumer.contextType=Oy,tc=()=>ca(My),rc=l=>{var{component:c,children:d,renderAsHtml:h,style:p}=l;return function(l,c,d){var h,p,f,m,y=Co({},l.props);for(f in l.type&&l.type.defaultProps&&(m=l.type.defaultProps),c)"key"==f?h=c[f]:"ref"==f?p=c[f]:y[f]=void 0===c[f]&&void 0!==m?m[f]:c[f];return arguments.length>2&&(y.children=arguments.length>3?hg.call(arguments,2):d),Eo(l.type,y,h||l.key,p||l.ref,null)}(c,h?{dangerouslySetInnerHTML:{__html:d},style:p}:{children:d,style:p})};function ic(l){return null!=l?l:"icontains"}function nc(l){var c,d,h;if(null==(c=l.conditions)||!c.url)return!0;var p=null==Ey||null==(d=Ey.location)?void 0:d.href;if(!p)return!1;var f=[l.conditions.url],m=ic(null==(h=l.conditions)?void 0:h.urlMatchType);return ky[m](f,[p])}var sc=l=>{var c=""+Gg+l.id;return l.current_iteration&&l.current_iteration>0&&(c=""+Gg+l.id+"_"+l.current_iteration),c},oc=(l,c)=>{try{localStorage.setItem(sc(l),JSON.stringify(c))}catch(d){Vg.error("Error setting in-progress survey state in localStorage",d)}},ac=l=>{try{var c=localStorage.getItem(sc(l));if(c)return JSON.parse(c)}catch(d){Vg.error("Error getting in-progress survey state from localStorage",d)}return null},lc=l=>{var c=ac(l);return!ni(null==c?void 0:c.surveySubmissionId)},uc=l=>{try{localStorage.removeItem(sc(l))}catch(c){Vg.error("Error clearing in-progress survey state from localStorage",c)}};function cc(l,c){void 0===c&&(c=!1);var d="PostHogSurvey-"+l.id;return c?"."+d:d}var Ny=0;function hc(l,c,d,h,p,f){var m,y,_={};for(y in c)"ref"==y?m=c[y]:_[y]=c[y];var b={type:l,props:_,key:d,ref:m,__k:null,__:null,__b:0,__e:null,__d:void 0,__c:null,constructor:void 0,__v:--Ny,__i:-1,__u:0,__source:p,__self:f};if("function"==typeof l&&(m=l.defaultProps))for(y in m)void 0===_[y]&&(_[y]=m[y]);return pg.vnode&&pg.vnode(b),b}var Py=hc("svg",{className:"emoji-svg",xmlns:"http://www.w3.org/2000/svg",height:"48",viewBox:"0 -960 960 960",width:"48",children:hc("path",{d:"M626-533q22.5 0 38.25-15.75T680-587q0-22.5-15.75-38.25T626-641q-22.5 0-38.25 15.75T572-587q0 22.5 15.75 38.25T626-533Zm-292 0q22.5 0 38.25-15.75T388-587q0-22.5-15.75-38.25T334-641q-22.5 0-38.25 15.75T280-587q0 22.5 15.75 38.25T334-533Zm146 272q66 0 121.5-35.5T682-393h-52q-23 40-63 61.5T480.5-310q-46.5 0-87-21T331-393h-53q26 61 81 96.5T480-261Zm0 181q-83 0-156-31.5T197-197q-54-54-85.5-127T80-480q0-83 31.5-156T197-763q54-54 127-85.5T480-880q83 0 156 31.5T763-763q54 54 85.5 127T880-480q0 83-31.5 156T763-197q-54 54-127 85.5T480-80Zm0-400Zm0 340q142.375 0 241.188-98.812Q820-337.625 820-480t-98.812-241.188Q622.375-820 480-820t-241.188 98.812Q140-622.375 140-480t98.812 241.188Q337.625-140 480-140Z"})}),Ly=hc("svg",{className:"emoji-svg",xmlns:"http://www.w3.org/2000/svg",height:"48",viewBox:"0 -960 960 960",width:"48",children:hc("path",{d:"M626-533q22.5 0 38.25-15.75T680-587q0-22.5-15.75-38.25T626-641q-22.5 0-38.25 15.75T572-587q0 22.5 15.75 38.25T626-533Zm-292 0q22.5 0 38.25-15.75T388-587q0-22.5-15.75-38.25T334-641q-22.5 0-38.25 15.75T280-587q0 22.5 15.75 38.25T334-533Zm20 194h253v-49H354v49ZM480-80q-83 0-156-31.5T197-197q-54-54-85.5-127T80-480q0-83 31.5-156T197-763q54-54 127-85.5T480-880q83 0 156 31.5T763-763q54 54 85.5 127T880-480q0 83-31.5 156T763-197q-54 54-127 85.5T480-80Zm0-400Zm0 340q142.375 0 241.188-98.812Q820-337.625 820-480t-98.812-241.188Q622.375-820 480-820t-241.188 98.812Q140-622.375 140-480t98.812 241.188Q337.625-140 480-140Z"})}),jy=hc("svg",{className:"emoji-svg",xmlns:"http://www.w3.org/2000/svg",height:"48",viewBox:"0 -960 960 960",width:"48",children:hc("path",{d:"M626-533q22.5 0 38.25-15.75T680-587q0-22.5-15.75-38.25T626-641q-22.5 0-38.25 15.75T572-587q0 22.5 15.75 38.25T626-533Zm-292 0q22.5 0 38.25-15.75T388-587q0-22.5-15.75-38.25T334-641q-22.5 0-38.25 15.75T280-587q0 22.5 15.75 38.25T334-533Zm146.174 116Q413-417 358.5-379.5T278-280h53q22-42 62.173-65t87.5-23Q528-368 567.5-344.5T630-280h52q-25-63-79.826-100-54.826-37-122-37ZM480-80q-83 0-156-31.5T197-197q-54-54-85.5-127T80-480q0-83 31.5-156T197-763q54-54 127-85.5T480-880q83 0 156 31.5T763-763q54 54 85.5 127T880-480q0 83-31.5 156T763-197q-54 54-127 85.5T480-80Zm0-400Zm0 340q142.375 0 241.188-98.812Q820-337.625 820-480t-98.812-241.188Q622.375-820 480-820t-241.188 98.812Q140-622.375 140-480t98.812 241.188Q337.625-140 480-140Z"})}),Dy=hc("svg",{className:"emoji-svg",xmlns:"http://www.w3.org/2000/svg",height:"48",viewBox:"0 -960 960 960",width:"48",children:hc("path",{d:"M480-417q-67 0-121.5 37.5T278-280h404q-25-63-80-100t-122-37Zm-183-72 50-45 45 45 31-36-45-45 45-45-31-36-45 45-50-45-31 36 45 45-45 45 31 36Zm272 0 44-45 51 45 31-36-45-45 45-45-31-36-51 45-44-45-31 36 44 45-44 45 31 36ZM480-80q-83 0-156-31.5T197-197q-54-54-85.5-127T80-480q0-83 31.5-156T197-763q54-54 127-85.5T480-880q83 0 156 31.5T763-763q54 54 85.5 127T880-480q0 83-31.5 156T763-197q-54 54-127 85.5T480-80Zm0-400Zm0 340q142 0 241-99t99-241q0-142-99-241t-241-99q-142 0-241 99t-99 241q0 142 99 241t241 99Z"})}),Fy=hc("svg",{className:"emoji-svg",xmlns:"http://www.w3.org/2000/svg",height:"48",viewBox:"0 -960 960 960",width:"48",children:hc("path",{d:"M479.504-261Q537-261 585.5-287q48.5-26 78.5-72.4 6-11.6-.75-22.6-6.75-11-20.25-11H316.918Q303-393 296.5-382t-.5 22.6q30 46.4 78.5 72.4 48.5 26 105.004 26ZM347-578l27 27q7.636 8 17.818 8Q402-543 410-551q8-8 8-18t-8-18l-42-42q-8.8-9-20.9-9-12.1 0-21.1 9l-42 42q-8 7.636-8 17.818Q276-559 284-551q8 8 18 8t18-8l27-27Zm267 0 27 27q7.714 8 18 8t18-8q8-7.636 8-17.818Q685-579 677-587l-42-42q-8.8-9-20.9-9-12.1 0-21.1 9l-42 42q-8 7.714-8 18t8 18q7.636 8 17.818 8Q579-543 587-551l27-27ZM480-80q-83 0-156-31.5T197-197q-54-54-85.5-127T80-480q0-83 31.5-156T197-763q54-54 127-85.5T480-880q83 0 156 31.5T763-763q54 54 85.5 127T880-480q0 83-31.5 156T763-197q-54 54-127 85.5T480-80Zm0-400Zm0 340q142.375 0 241.188-98.812Q820-337.625 820-480t-98.812-241.188Q622.375-820 480-820t-241.188 98.812Q140-622.375 140-480t98.812 241.188Q337.625-140 480-140Z"})}),$y=hc("svg",{width:"12",height:"12",viewBox:"0 0 12 12",fill:"none",xmlns:"http://www.w3.org/2000/svg","aria-labelledby":"close-survey-title",children:[hc("title",{id:"close-survey-title",children:"Close survey"}),hc("path",{"fill-rule":"evenodd","clip-rule":"evenodd",d:"M0.164752 0.164752C0.384422 -0.0549175 0.740578 -0.0549175 0.960248 0.164752L6 5.20451L11.0398 0.164752C11.2594 -0.0549175 11.6156 -0.0549175 11.8352 0.164752C12.0549 0.384422 12.0549 0.740578 11.8352 0.960248L6.79549 6L11.8352 11.0398C12.0549 11.2594 12.0549 11.6156 11.8352 11.8352C11.6156 12.0549 11.2594 12.0549 11.0398 11.8352L6 6.79549L0.960248 11.8352C0.740578 12.0549 0.384422 12.0549 0.164752 11.8352C-0.0549175 11.6156 -0.0549175 11.2594 0.164752 11.0398L5.20451 6L0.164752 0.960248C-0.0549175 0.740578 -0.0549175 0.384422 0.164752 0.164752Z",fill:"black"})]}),Uy=hc("svg",{width:"77",height:"14",viewBox:"0 0 77 14",fill:"none",xmlns:"http://www.w3.org/2000/svg",children:[hc("g",{"clip-path":"url(#clip0_2415_6911)",children:[hc("mask",{id:"mask0_2415_6911",style:{maskType:"luminance"},maskUnits:"userSpaceOnUse",x:"0",y:"0",width:"77",height:"14",children:hc("path",{d:"M0.5 0H76.5V14H0.5V0Z",fill:"white"})}),hc("g",{mask:"url(#mask0_2415_6911)",children:[hc("path",{d:"M5.77226 8.02931C5.59388 8.37329 5.08474 8.37329 4.90634 8.02931L4.4797 7.20672C4.41155 7.07535 4.41155 6.9207 4.4797 6.78933L4.90634 5.96669C5.08474 5.62276 5.59388 5.62276 5.77226 5.96669L6.19893 6.78933C6.26709 6.9207 6.26709 7.07535 6.19893 7.20672L5.77226 8.02931ZM5.77226 12.6946C5.59388 13.0386 5.08474 13.0386 4.90634 12.6946L4.4797 11.872C4.41155 11.7406 4.41155 11.586 4.4797 11.4546L4.90634 10.632C5.08474 10.288 5.59388 10.288 5.77226 10.632L6.19893 11.4546C6.26709 11.586 6.26709 11.7406 6.19893 11.872L5.77226 12.6946Z",fill:"#1D4AFF"}),hc("path",{d:"M0.5 10.9238C0.5 10.508 1.02142 10.2998 1.32637 10.5938L3.54508 12.7327C3.85003 13.0267 3.63405 13.5294 3.20279 13.5294H0.984076C0.716728 13.5294 0.5 13.3205 0.5 13.0627V10.9238ZM0.5 8.67083C0.5 8.79459 0.551001 8.91331 0.641783 9.00081L5.19753 13.3927C5.28831 13.4802 5.41144 13.5294 5.53982 13.5294H8.0421C8.47337 13.5294 8.68936 13.0267 8.3844 12.7327L1.32637 5.92856C1.02142 5.63456 0.5 5.84278 0.5 6.25854V8.67083ZM0.5 4.00556C0.5 4.12932 0.551001 4.24802 0.641783 4.33554L10.0368 13.3927C10.1276 13.4802 10.2508 13.5294 10.3791 13.5294H12.8814C13.3127 13.5294 13.5287 13.0267 13.2237 12.7327L1.32637 1.26329C1.02142 0.969312 0.5 1.17752 0.5 1.59327V4.00556ZM5.33931 4.00556C5.33931 4.12932 5.39033 4.24802 5.4811 4.33554L14.1916 12.7327C14.4965 13.0267 15.0179 12.8185 15.0179 12.4028V9.99047C15.0179 9.86671 14.9669 9.74799 14.8762 9.66049L6.16568 1.26329C5.86071 0.969307 5.33931 1.17752 5.33931 1.59327V4.00556ZM11.005 1.26329C10.7 0.969307 10.1786 1.17752 10.1786 1.59327V4.00556C10.1786 4.12932 10.2296 4.24802 10.3204 4.33554L14.1916 8.06748C14.4965 8.36148 15.0179 8.15325 15.0179 7.7375V5.3252C15.0179 5.20144 14.9669 5.08272 14.8762 4.99522L11.005 1.26329Z",fill:"#F9BD2B"}),hc("path",{d:"M21.0852 10.981L16.5288 6.58843C16.2238 6.29443 15.7024 6.50266 15.7024 6.91841V13.0627C15.7024 13.3205 15.9191 13.5294 16.1865 13.5294H23.2446C23.5119 13.5294 23.7287 13.3205 23.7287 13.0627V12.5032C23.7287 12.2455 23.511 12.0396 23.2459 12.0063C22.4323 11.9042 21.6713 11.546 21.0852 10.981ZM18.0252 12.0365C17.5978 12.0365 17.251 11.7021 17.251 11.2901C17.251 10.878 17.5978 10.5436 18.0252 10.5436C18.4527 10.5436 18.7996 10.878 18.7996 11.2901C18.7996 11.7021 18.4527 12.0365 18.0252 12.0365Z",fill:"currentColor"}),hc("path",{d:"M0.5 13.0627C0.5 13.3205 0.716728 13.5294 0.984076 13.5294H3.20279C3.63405 13.5294 3.85003 13.0267 3.54508 12.7327L1.32637 10.5938C1.02142 10.2998 0.5 10.508 0.5 10.9238V13.0627ZM5.33931 5.13191L1.32637 1.26329C1.02142 0.969306 0.5 1.17752 0.5 1.59327V4.00556C0.5 4.12932 0.551001 4.24802 0.641783 4.33554L5.33931 8.86412V5.13191ZM1.32637 5.92855C1.02142 5.63455 0.5 5.84278 0.5 6.25853V8.67083C0.5 8.79459 0.551001 8.91331 0.641783 9.00081L5.33931 13.5294V9.79717L1.32637 5.92855Z",fill:"#1D4AFF"}),hc("path",{d:"M10.1787 5.3252C10.1787 5.20144 10.1277 5.08272 10.0369 4.99522L6.16572 1.26329C5.8608 0.969306 5.33936 1.17752 5.33936 1.59327V4.00556C5.33936 4.12932 5.39037 4.24802 5.48114 4.33554L10.1787 8.86412V5.3252ZM5.33936 13.5294H8.04214C8.47341 13.5294 8.6894 13.0267 8.38443 12.7327L5.33936 9.79717V13.5294ZM5.33936 5.13191V8.67083C5.33936 8.79459 5.39037 8.91331 5.48114 9.00081L10.1787 13.5294V9.99047C10.1787 9.86671 10.1277 9.74803 10.0369 9.66049L5.33936 5.13191Z",fill:"#F54E00"}),hc("path",{d:"M29.375 11.6667H31.3636V8.48772H33.0249C34.8499 8.48772 36.0204 7.4443 36.0204 5.83052C36.0204 4.21681 34.8499 3.17334 33.0249 3.17334H29.375V11.6667ZM31.3636 6.84972V4.81136H32.8236C33.5787 4.81136 34.0318 5.19958 34.0318 5.83052C34.0318 6.4615 33.5787 6.84972 32.8236 6.84972H31.3636ZM39.618 11.7637C41.5563 11.7637 42.9659 10.429 42.9659 8.60905C42.9659 6.78905 41.5563 5.45438 39.618 5.45438C37.6546 5.45438 36.2701 6.78905 36.2701 8.60905C36.2701 10.429 37.6546 11.7637 39.618 11.7637ZM38.1077 8.60905C38.1077 7.63838 38.7118 6.97105 39.618 6.97105C40.5116 6.97105 41.1157 7.63838 41.1157 8.60905C41.1157 9.57972 40.5116 10.2471 39.618 10.2471C38.7118 10.2471 38.1077 9.57972 38.1077 8.60905ZM46.1482 11.7637C47.6333 11.7637 48.6402 10.8658 48.6402 9.81025C48.6402 7.33505 45.2294 8.13585 45.2294 7.16518C45.2294 6.8983 45.5189 6.72843 45.9342 6.72843C46.3622 6.72843 46.8782 6.98318 47.0418 7.54132L48.527 6.94678C48.2375 6.06105 47.1677 5.45438 45.8713 5.45438C44.4743 5.45438 43.6058 6.25518 43.6058 7.21372C43.6058 9.53118 46.9663 8.88812 46.9663 9.84665C46.9663 10.1864 46.6391 10.417 46.1482 10.417C45.4434 10.417 44.9525 9.94376 44.8015 9.3735L43.3164 9.93158C43.6436 10.8537 44.6001 11.7637 46.1482 11.7637ZM53.4241 11.606L53.2982 10.0651C53.0843 10.1743 52.8074 10.2106 52.5808 10.2106C52.1278 10.2106 51.8257 9.89523 51.8257 9.34918V7.03172H53.3612V5.55145H51.8257V3.78001H49.9755V5.55145H48.9687V7.03172H49.9755V9.57972C49.9755 11.06 51.0202 11.7637 52.3921 11.7637C52.7696 11.7637 53.122 11.7031 53.4241 11.606ZM59.8749 3.17334V6.47358H56.376V3.17334H54.3874V11.6667H56.376V8.11158H59.8749V11.6667H61.8761V3.17334H59.8749ZM66.2899 11.7637C68.2281 11.7637 69.6378 10.429 69.6378 8.60905C69.6378 6.78905 68.2281 5.45438 66.2899 5.45438C64.3265 5.45438 62.942 6.78905 62.942 8.60905C62.942 10.429 64.3265 11.7637 66.2899 11.7637ZM64.7796 8.60905C64.7796 7.63838 65.3837 6.97105 66.2899 6.97105C67.1835 6.97105 67.7876 7.63838 67.7876 8.60905C67.7876 9.57972 67.1835 10.2471 66.2899 10.2471C65.3837 10.2471 64.7796 9.57972 64.7796 8.60905ZM73.2088 11.4725C73.901 11.4725 74.5177 11.242 74.845 10.8416V11.424C74.845 12.1034 74.2786 12.5767 73.4102 12.5767C72.7935 12.5767 72.2523 12.2854 72.1642 11.788L70.4776 12.0428C70.7042 13.1955 71.925 13.972 73.4102 13.972C75.361 13.972 76.6574 12.8679 76.6574 11.2298V5.55145H74.8324V6.07318C74.4926 5.69705 73.9136 5.45438 73.171 5.45438C71.409 5.45438 70.3014 6.61918 70.3014 8.46345C70.3014 10.3077 71.409 11.4725 73.2088 11.4725ZM72.1012 8.46345C72.1012 7.55345 72.655 6.97105 73.5109 6.97105C74.3793 6.97105 74.9331 7.55345 74.9331 8.46345C74.9331 9.37345 74.3793 9.95585 73.5109 9.95585C72.655 9.95585 72.1012 9.37345 72.1012 8.46345Z",fill:"currentColor"})]})]}),hc("defs",{children:hc("clipPath",{id:"clip0_2415_6911",children:hc("rect",{width:"76",height:"14",fill:"white",transform:"translate(0.5)"})})})]});function bc(){return hc("a",{href:"https://posthog.com/surveys",target:"_blank",rel:"noopener",className:"footer-branding",children:["Survey by ",Uy]})}function Sc(l){var{text:c,submitDisabled:d,appearance:h,onSubmit:p,link:f,onPreviewSubmit:m,skipSubmitButton:y}=l,{isPreviewMode:_}=ca(My);return hc("div",{className:"bottom-section",children:[!y&&hc("button",{className:"form-submit",disabled:d,"aria-label":"Submit survey",type:"button",onClick:()=>{f&&(null==sm||sm.open(f)),_?null==m||m():p()},children:c}),!h.whiteLabel&&hc(bc,{})]})}function wc(l){var{question:c,forceDisableHtml:d,htmlFor:h}=l;return hc("div",{class:"question-header",children:[hc(c.type===Ug.Open?"label":"h3",{className:"survey-question",htmlFor:h,children:c.question}),c.description&&rc({component:ko("p",{className:"survey-question-description"}),children:c.description,renderAsHtml:!d&&"text"!==c.descriptionContentType})]})}function Cc(l){var{onClick:c}=l,{isPreviewMode:d}=ca(My);return hc("button",{className:"form-cancel",onClick:c,disabled:d,"aria-label":"Close survey",type:"button",children:$y})}hc("svg",{width:"16",height:"12",viewBox:"0 0 16 12",fill:"none",xmlns:"http://www.w3.org/2000/svg",children:hc("path",{d:"M5.30769 10.6923L4.77736 11.2226C4.91801 11.3633 5.10878 11.4423 5.30769 11.4423C5.5066 11.4423 5.69737 11.3633 5.83802 11.2226L5.30769 10.6923ZM15.5303 1.53033C15.8232 1.23744 15.8232 0.762563 15.5303 0.46967C15.2374 0.176777 14.7626 0.176777 14.4697 0.46967L15.5303 1.53033ZM1.53033 5.85429C1.23744 5.56139 0.762563 5.56139 0.46967 5.85429C0.176777 6.14718 0.176777 6.62205 0.46967 6.91495L1.53033 5.85429ZM5.83802 11.2226L15.5303 1.53033L14.4697 0.46967L4.77736 10.162L5.83802 11.2226ZM0.46967 6.91495L4.77736 11.2226L5.83802 10.162L1.53033 5.85429L0.46967 6.91495Z",fill:"currentColor"})});var By=sm;function kc(l){var{header:c,description:d,contentType:h,forceDisableHtml:p,appearance:f,onClose:m}=l,{isPopup:y}=ca(My);return aa((()=>{var e4=l=>{"Enter"!==l.key&&"Escape"!==l.key||(l.preventDefault(),m())};return En(By,"keydown",e4),()=>{By.removeEventListener("keydown",e4)}}),[m]),hc("div",{className:"thank-you-message",role:"status",tabIndex:0,"aria-atomic":"true",children:[y&&hc(Cc,{onClick:()=>m()}),hc("h3",{className:"thank-you-message-header",children:c}),d&&rc({component:ko("p",{className:"thank-you-message-body"}),children:d,renderAsHtml:!p&&"text"!==h}),y&&hc(Sc,{text:f.thankYouMessageCloseButtonText||"Close",submitDisabled:!1,appearance:f,onSubmit:()=>m()})]})}var Ec=l=>zf(l)&&l.every((l=>ti(l)));function xc(l){var{question:c,forceDisableHtml:d,appearance:h,onSubmit:p,onPreviewSubmit:f,displayQuestionIndex:m,initialValue:y}=l,{isPreviewMode:_}=tc(),b=la(null),[w,E]=oa((()=>ti(y)?y:""));aa((()=>{setTimeout((()=>{var l;_||null==(l=b.current)||l.focus()}),100)}),[_]);var M="surveyQuestion"+m;return hc(xo,{children:[hc("div",{className:"question-container",children:[hc(wc,{question:c,forceDisableHtml:d,htmlFor:M}),hc("textarea",{ref:b,id:M,rows:4,placeholder:null==h?void 0:h.placeholder,onInput:l=>{E(l.currentTarget.value),l.stopPropagation()},onKeyDown:l=>{l.stopPropagation()},value:w})]}),hc(Sc,{text:c.buttonText||"Submit",submitDisabled:!w&&!c.optional,appearance:h,onSubmit:()=>p(w),onPreviewSubmit:()=>f(w)})]})}function Tc(l){var{question:c,forceDisableHtml:d,appearance:h,onSubmit:p,onPreviewSubmit:f}=l;return hc(xo,{children:[hc("div",{className:"question-container",children:hc(wc,{question:c,forceDisableHtml:d})}),hc(Sc,{text:c.buttonText||"Submit",submitDisabled:!1,link:c.link,appearance:h,onSubmit:()=>p("link clicked"),onPreviewSubmit:()=>f("link clicked")})]})}function Mc(l){var{question:c,forceDisableHtml:d,displayQuestionIndex:h,appearance:p,onSubmit:f,onPreviewSubmit:m,initialValue:y}=l,_=c.scale,b=10===c.scale?0:1,[w,E]=oa((()=>si(y)?y:zf(y)&&y.length>0&&si(parseInt(y[0]))?parseInt(y[0]):ti(y)&&si(parseInt(y))?parseInt(y):null)),{isPreviewMode:M}=tc(),p2=l=>M?m(l):f(l);return hc(xo,{children:[hc("div",{className:"question-container",children:[hc(wc,{question:c,forceDisableHtml:d}),hc("div",{className:"rating-section",children:[hc("div",{className:"rating-options",children:["emoji"===c.display&&hc("div",{className:"rating-options-emoji",children:(3===c.scale?Hy:zy).map(((l,d)=>hc("button",{"aria-label":"Rate "+(d+1),className:"ratings-emoji question-"+h+"-rating-"+d+" "+(d+1===w?"rating-active":""),value:d+1,type:"button",onClick:()=>{var l=d+1;E(l),c.skipSubmitButton&&p2(l)},children:l},d)))}),"number"===c.display&&hc("div",{className:"rating-options-number",style:{gridTemplateColumns:"repeat("+(_-b+1)+", minmax(0, 1fr))"},children:Dc(c.scale).map(((l,d)=>hc(Rc,{displayQuestionIndex:h,active:w===l,appearance:p,num:l,setActiveNumber:l=>{E(l),c.skipSubmitButton&&p2(l)}},d)))})]}),hc("div",{className:"rating-text",children:[hc("div",{children:c.lowerBoundLabel}),hc("div",{children:c.upperBoundLabel})]})]})]}),hc(Sc,{text:c.buttonText||(null==p?void 0:p.submitButtonText)||"Submit",submitDisabled:ii(w)&&!c.optional,appearance:p,onSubmit:()=>f(w),onPreviewSubmit:()=>m(w),skipSubmitButton:c.skipSubmitButton})]})}function Rc(l){var{num:c,active:d,displayQuestionIndex:h,setActiveNumber:p}=l;return hc("button",{"aria-label":"Rate "+c,className:"ratings-number question-"+h+"-rating-"+c+" "+(d?"rating-active":""),type:"button",onClick:()=>{p(c)},children:c})}function Ac(l){var{question:c,forceDisableHtml:d,displayQuestionIndex:h,appearance:p,onSubmit:f,onPreviewSubmit:m,initialValue:y}=l,_=la(null),b=ua((()=>(l=>{if(!l.shuffleOptions)return l.choices;var c=l.choices,d="";l.hasOpenChoice&&(d=c.pop());var h=Ku(c,Xu(c));return l.hasOpenChoice&&(l.choices.push(d),h.push(d)),h})(c)),[c]),[w,E]=oa((()=>{return l=y,d=c.type,ti(l)||Ec(l)?l:d===Ug.SingleChoice?null:[];var l,d})),[M,N]=oa((()=>((l,c)=>{if(ti(l)&&!c.includes(l))return{isSelected:!0,inputValue:l};if(Ec(l)){var d=l.find((l=>!c.includes(l)));if(d)return{isSelected:!0,inputValue:d}}return{isSelected:!1,inputValue:""}})(y,b))),{isPreviewMode:P}=tc(),L=c.type===Ug.SingleChoice,j=c.type===Ug.MultipleChoice,D=c.skipSubmitButton&&L&&!c.hasOpenChoice,y2=(l,c)=>{if(c){var d=!M.isSelected;return N((l=>r$2({},l,{isSelected:d,inputValue:d?l.inputValue:""}))),L&&E(""),void(d&&setTimeout((()=>{var l;return null==(l=_.current)?void 0:l.focus()}),75))}if(L)return E(l),N((l=>r$2({},l,{isSelected:!1,inputValue:""}))),void(D&&(f(l),P&&m(l)));j&&zf(w)&&(w.includes(l)?E(w.filter((c=>c!==l))):E([...w,l]))},b3=l=>{l.stopPropagation();var c=l.currentTarget.value;N((l=>r$2({},l,{inputValue:c}))),L&&E(c)},S2=l=>{l.stopPropagation(),"Enter"!==l.key||w3()||(l.preventDefault(),C2()),"Escape"===l.key&&(l.preventDefault(),N((l=>r$2({},l,{isSelected:!1,inputValue:""}))),L&&E(null))},w3=()=>!(c.optional||!ii(w)&&(!zf(w)||M.isSelected||0!==w.length)&&(!M.isSelected||""!==M.inputValue.trim())),C2=()=>{M.isSelected&&j?zf(w)&&(P?m([...w,M.inputValue]):f([...w,M.inputValue])):P?m(w):f(w)};return hc(xo,{children:[hc("div",{className:"question-container",children:[hc(wc,{question:c,forceDisableHtml:d}),hc("fieldset",{className:"multiple-choice-options limit-height",children:[hc("legend",{className:"sr-only",children:j?" Select all that apply":" Select one"}),b.map(((l,d)=>{var p=!!c.hasOpenChoice&&d===c.choices.length-1,f="surveyQuestion"+h+"Choice"+d,m=f+"Open",y=p?M.isSelected:L?w===l:zf(w)&&w.includes(l);return hc("label",{className:p?"choice-option-open":"",children:[hc("div",{className:"response-choice",children:[hc("input",{type:L?"radio":"checkbox",name:f,checked:y,onChange:()=>y2(l,p),id:f,"aria-controls":m}),hc("span",{children:p?l+":":l})]}),p&&hc("input",{type:"text",ref:_,id:m,name:"question"+h+"Open",value:M.inputValue,onKeyDown:S2,onInput:b3,onClick:c=>{M.isSelected||y2(l,!0),c.stopPropagation()},"aria-label":l+" - please specify"})]},d)}))]})]}),hc(Sc,{text:c.buttonText||"Submit",submitDisabled:w3(),appearance:p,onSubmit:C2,onPreviewSubmit:C2,skipSubmitButton:D})]})}var Hy=[jy,Ly,Py],zy=[Dy,jy,Ly,Py,Fy],qy=[1,2,3,4,5],Wy=[1,2,3,4,5,6,7],Vy=[0,1,2,3,4,5,6,7,8,9,10];function Dc(l){switch(l){case 5:default:return qy;case 7:return Wy;case 10:return Vy}}var Zy=sm,Gy=um,Ky="ph:show_survey_widget",Jy="PHWidgetSurveyClickListener";class zc{constructor(l){var c=this;this._surveyTimeouts=new Map,this._widgetSelectorListeners=new Map,this._prefillHandledSurveys=new Set,this.handlePopoverSurvey=l=>{var c;this._clearSurveyTimeout(l.id),this._addSurveyToFocus(l);var d=(null==(c=l.appearance)?void 0:c.surveyPopupDelaySeconds)||0,{shadow:h}=zu(l,this._posthog);if(d<=0)return Zo(hc(Xc,{posthog:this._posthog,survey:l,removeSurveyFromFocus:this._removeSurveyFromFocus}),h);var p=setTimeout((()=>{if(!nc(l))return this._removeSurveyFromFocus(l);Zo(hc(Xc,{posthog:this._posthog,survey:r$2({},l,{appearance:r$2({},l.appearance,{surveyPopupDelaySeconds:0})}),removeSurveyFromFocus:this._removeSurveyFromFocus}),h)}),1e3*d);this._surveyTimeouts.set(l.id,p)},this._handleWidget=l=>{var{shadow:c,isNewlyCreated:d}=zu(l,this._posthog);d&&Zo(hc(Jc,{posthog:this._posthog,survey:l},l.id),c)},this._removeWidgetSelectorListener=l=>{this._removeSurveyFromDom(l);var c=this._widgetSelectorListeners.get(l.id);c&&(c.element.removeEventListener("click",c.listener),c.element.removeAttribute(Jy),this._widgetSelectorListeners.delete(l.id),Vg.info("Removed click listener for survey "+l.id))},this._manageWidgetSelectorListener=(l,c)=>{var d=Gy.querySelector(c),h=this._widgetSelectorListeners.get(l.id);if(d){if(this._handleWidget(l),h){if(d===h.element)return;Vg.info("Selector element changed for survey "+l.id+". Re-attaching listener."),this._removeWidgetSelectorListener(l)}if(!d.hasAttribute(Jy)){var n2=c=>{var d,h;c.stopPropagation();var p=(null==(d=l.appearance)?void 0:d.position)===Fg.NextToTrigger?function(l,c){try{var d=l.getBoundingClientRect(),h=Zy.innerHeight,p=Zy.innerWidth,f=d.left+d.width/2-c/2;f+c>p-20&&(f=p-c-20),f<20&&(f=20);var m=h-d.bottom,y=d.top,_=m<250&&y>m;return{position:"fixed",top:_?"auto":d.bottom+12+"px",left:f+"px",right:"auto",bottom:_?h-d.top+12+"px":"auto",zIndex:Ry.zIndex}}catch(b){return Vg.warn("Failed to calculate trigger position:",b),null}}(c.currentTarget,parseInt((null==(h=l.appearance)?void 0:h.maxWidth)||Ry.maxWidth)):{};Zy.dispatchEvent(new CustomEvent(Ky,{detail:{surveyId:l.id,position:p}}))};En(d,"click",n2),d.setAttribute(Jy,"true"),this._widgetSelectorListeners.set(l.id,{element:d,listener:n2,survey:l}),Vg.info("Attached click listener for feedback button survey "+l.id)}}else h&&this._removeWidgetSelectorListener(l)},this.renderPopover=l=>{var{shadow:c}=zu(l,this._posthog);Zo(hc(Xc,{posthog:this._posthog,survey:l,removeSurveyFromFocus:this._removeSurveyFromFocus}),c)},this.renderSurvey=(l,c)=>{var d;null!=(d=this._posthog.config)&&null!=(d=d.surveys)&&d.prefillFromUrl&&this._handleUrlPrefill(l),Zo(hc(Xc,{posthog:this._posthog,survey:l,removeSurveyFromFocus:this._removeSurveyFromFocus,isPopup:!1}),c)},this.getActiveMatchingSurveys=function(l,d){var h;void 0===d&&(d=!1),null==(h=c._posthog)||h.surveys.getSurveys((d=>{var h=d.filter((l=>c.checkSurveyEligibility(l).eligible&&c._isSurveyConditionMatched(l)&&c._hasActionOrEventTriggeredSurvey(l)&&c._checkFlags(l)));l(h)}),d)},this.callSurveysAndEvaluateDisplayLogic=function(l){void 0===l&&(l=!1),c.getActiveMatchingSurveys((l=>{var d=l.filter((l=>l.type===$g.Popover||l.type===$g.Widget)),h=c._sortSurveysByAppearanceDelay(d),p=new Set;h.forEach((l=>{if(l.type===$g.Widget){var d,h,f,m;if((null==(d=l.appearance)?void 0:d.widgetType)===Dg.Tab)return void c._handleWidget(l);(null==(h=l.appearance)?void 0:h.widgetType)===Dg.Selector&&null!=(f=l.appearance)&&f.widgetSelector&&(p.add(l.id),c._manageWidgetSelectorListener(l,null==(m=l.appearance)?void 0:m.widgetSelector))}ii(c._surveyInFocus)&&l.type===$g.Popover&&c.handlePopoverSurvey(l)})),c._widgetSelectorListeners.forEach((l=>{var{survey:d}=l;p.has(d.id)||c._removeWidgetSelectorListener(d)}))}),l)},this._addSurveyToFocus=l=>{ii(this._surveyInFocus)||Vg.error("Survey "+this._surveyInFocus+" already in focus. Cannot add survey "+l.id+"."),this._surveyInFocus=l.id},this._removeSurveyFromFocus=l=>{this._surveyInFocus!==l.id&&Vg.error("Survey "+l.id+" is not in focus. Cannot remove survey "+l.id+"."),this._clearSurveyTimeout(l.id),this._clearAutoSubmitTimeout(),this._surveyInFocus=null,this._removeSurveyFromDom(l)},this._posthog=l,this._surveyInFocus=null}_clearSurveyTimeout(l){var c=this._surveyTimeouts.get(l);c&&(clearTimeout(c),this._surveyTimeouts.delete(l))}_sortSurveysByAppearanceDelay(l){return l.sort(((l,c)=>{var d,h,p=lc(l),f=lc(c);if(p&&!f)return-1;if(!p&&f)return 1;var m=l.schedule===Hg.Always,y=c.schedule===Hg.Always;return m&&!y?1:!m&&y?-1:((null==(d=l.appearance)?void 0:d.surveyPopupDelaySeconds)||0)-((null==(h=c.appearance)?void 0:h.surveyPopupDelaySeconds)||0)}))}_handleUrlPrefill(l){if(!this._prefillHandledSurveys.has(l.id))try{var c,{params:d,autoSubmit:h}=function(){var l={},c=!1,d=Zy.location.search.replace(/^\?/,"");if(!d)return{params:l,autoSubmit:c};var h=d.split("&");for(var p of h){var[f,m]=p.split("=");if(f&&!ei(m)){var y=decodeURIComponent(f),_=decodeURIComponent(m);if("auto_submit"!==y||"true"!==_){var b=y.match(/^q(\d+)$/);if(b){var w=parseInt(b[1],10);l[w]||(l[w]=[]),l[w].push(_)}}else c=!0}}return{params:l,autoSubmit:c}}();if(0===Object.keys(d).length)return;Vg.info("[Survey Prefill] Detected URL prefill parameters");var p=(_=d,b={},(y=l).questions.forEach(((l,c)=>{if(_[c]&&l.id){var d=_[c],h=Bu(l.id);try{switch(l.type){case Ug.SingleChoice:if(!l.choices||0===l.choices.length)return void ym.warn("[Survey Prefill] Question "+c+" has no choices");var p=parseInt(d[0],10);if(isNaN(p)||p<0||p>=l.choices.length)return void ym.warn("[Survey Prefill] Invalid choice index for q"+c+": "+d[0]);b[h]=l.choices[p];break;case Ug.MultipleChoice:if(!l.choices||0===l.choices.length)return void ym.warn("[Survey Prefill] Question "+c+" has no choices");var f=d.map((l=>parseInt(l,10))).filter((c=>!isNaN(c)&&c>=0&&c<l.choices.length));if(0===f.length)return void ym.warn("[Survey Prefill] No valid choices for q"+c);var m=[...new Set(f.map((c=>l.choices[c])))];m.length<f.length&&ym.warn("[Survey Prefill] Removed duplicate choices for q"+c),b[h]=m;break;case Ug.Rating:var y=parseInt(d[0],10),w=l.scale||10;if(isNaN(y)||y<0||y>w)return void ym.warn("[Survey Prefill] Invalid rating for q"+c+": "+d[0]+" (scale: 0-"+w+")");b[h]=y;break;default:ym.info("[Survey Prefill] Question type "+l.type+" does not support prefill")}}catch(E){ym.error("[Survey Prefill] Error converting q"+c+":",E)}}})),b);if(0===Object.keys(p).length)return void Vg.warn("[Survey Prefill] No valid responses after conversion");var f=Ua();oc(l,{surveySubmissionId:f,responses:p,lastQuestionIndex:0}),Vg.info("[Survey Prefill] Stored prefilled responses in localStorage");var m=h&&(null==(c=this._posthog.config.surveys)?void 0:c.autoSubmitIfComplete)&&function(l,c){return l.questions.every((l=>{if(l.optional)return!0;if(l.type===Ug.Link||l.type===Ug.Open)return!0;if(!l.id)return!1;var d=Bu(l.id);return c.hasOwnProperty(d)}))}(l,p);m&&this._scheduleAutoSubmit(l,p,f),this._prefillHandledSurveys.add(l.id)}catch(y){Vg.error("[Survey Prefill] Error handling URL prefill:",y)}var y,_,b}_scheduleAutoSubmit(l,c,d){var h,p,f=null!==(h=null==(p=this._posthog.config.surveys)?void 0:p.autoSubmitDelay)&&void 0!==h?h:800;Vg.info("[Survey Prefill] Auto-submit scheduled"),this._autoSubmitTimeout=setTimeout((()=>{Vg.info("[Survey Prefill] Auto-submitting survey"),Gu({responses:c,survey:l,surveySubmissionId:d,posthog:this._posthog,isSurveyCompleted:!0})}),f)}_isSurveyFeatureFlagEnabled(l,c){if(void 0===c&&(c=void 0),!l)return!0;var d=!!this._posthog.featureFlags.isFeatureEnabled(l,{send_event:!l.startsWith("survey-targeting-")}),h=!0;return c&&(h=this._posthog.featureFlags.getFeatureFlag(l,{send_event:!1})===c||"any"===c),d&&h}_isSurveyConditionMatched(l){return!l.conditions||nc(l)&&function(l){var c,d,h;if(null==(c=l.conditions)||!c.deviceTypes||0===(null==(d=l.conditions)?void 0:d.deviceTypes.length))return!0;if(!mm)return!1;var p=$l(mm);return ky[ic(null==(h=l.conditions)?void 0:h.deviceTypesMatchType)](l.conditions.deviceTypes,[p])}(l)&&function(l){var c;return null==(c=l.conditions)||!c.selector||!(null==Iy||!Iy.querySelector(l.conditions.selector))}(l)}_internalFlagCheckSatisfied(l){return Qu(l)||this._isSurveyFeatureFlagEnabled(l.internal_targeting_flag_key)||lc(l)}checkSurveyEligibility(l){var c,d,h={eligible:!0,reason:void 0};if(!Ta(l))return h.eligible=!1,h.reason="Survey is not running. It was completed on "+l.end_date,h;if(!Kg.includes(l.type))return h.eligible=!1,h.reason="Surveys of type "+l.type+" are never eligible to be shown in the app",h;var p,f=null==(c=l.conditions)?void 0:c.linkedFlagVariant;return this._isSurveyFeatureFlagEnabled(l.linked_flag_key,f)?this._isSurveyFeatureFlagEnabled(l.targeting_flag_key)?this._internalFlagCheckSatisfied(l)?(l=>{var c=localStorage.getItem("lastSeenSurveyDate");if(!l||!c)return!0;var d=new Date,h=Math.abs(d.getTime()-new Date(c).getTime());return Math.ceil(h/864e5)>l})(null==(d=l.conditions)?void 0:d.seenSurveyWaitPeriodInDays)?(p=l,localStorage.getItem(Fa(p))&&!Qu(p)?(h.eligible=!1,h.reason="Survey has already been seen and it can't be activated again",h):h):(h.eligible=!1,h.reason="Survey wait period has not passed",h):(h.eligible=!1,h.reason="Survey internal targeting flag is not enabled and survey cannot activate repeatedly and survey is not in progress",h):(h.eligible=!1,h.reason="Survey targeting feature flag is not enabled",h):(h.eligible=!1,h.reason=f?"Survey linked feature flag is not enabled for variant "+f:"Survey linked feature flag is not enabled",h)}_hasActionOrEventTriggeredSurvey(l){var c;if(!Ma(l)&&!Ra(l))return!0;var d=null==(c=this._posthog.surveys._surveyEventReceiver)?void 0:c.getSurveys();return!(null==d||!d.includes(l.id))}_checkFlags(l){var c;return null==(c=l.feature_flag_keys)||!c.length||l.feature_flag_keys.every((l=>{var{key:c,value:d}=l;return!c||!d||this._isSurveyFeatureFlagEnabled(d)}))}_removeSurveyFromDom(l){try{var c=Gy.querySelector(cc(l,!0));null!=c&&c.shadowRoot&&Zo(null,c.shadowRoot),null==c||c.remove()}catch(d){Vg.warn("Failed to remove survey "+l.id+" from DOM:",d)}}_clearAutoSubmitTimeout(){this._autoSubmitTimeout&&(clearTimeout(this._autoSubmitTimeout),this._autoSubmitTimeout=void 0)}getTestAPI(){return{addSurveyToFocus:this._addSurveyToFocus,removeSurveyFromFocus:this._removeSurveyFromFocus,surveyInFocus:this._surveyInFocus,surveyTimeouts:this._surveyTimeouts,handleWidget:this._handleWidget,handlePopoverSurvey:this.handlePopoverSurvey,manageWidgetSelectorListener:this._manageWidgetSelectorListener,sortSurveysByAppearanceDelay:this._sortSurveysByAppearanceDelay,checkFlags:this._checkFlags.bind(this),isSurveyFeatureFlagEnabled:this._isSurveyFeatureFlagEnabled.bind(this)}}}function jc(l,c){if(Gy&&Zy){var d,h=new zc(l);if(l.config.disable_surveys_automatic_display)return Vg.info("Surveys automatic display is disabled. Skipping call surveys and evaluate display logic."),h;if(!1===c)return Vg.info("There are no surveys to load or Surveys is disabled in the project settings."),h;h.callSurveysAndEvaluateDisplayLogic(!0);var n2=()=>{ei(d)&&(d=setInterval((()=>{h.callSurveysAndEvaluateDisplayLogic(!1)}),1e3))};return n2(),En(Gy,"visibilitychange",(()=>{Gy.hidden?ei(d)||(clearInterval(d),d=void 0):(h.callSurveysAndEvaluateDisplayLogic(!1),n2())})),h}}function Gc(l){var{survey:c,removeSurveyFromFocus:d=()=>{},setSurveyVisible:h,isPreviewMode:p=!1}=l;aa((()=>{var l;if(!p&&null!=(l=c.conditions)&&l.url){var s2=()=>{var l,p=c.type===$g.Widget,f=nc(c),m=(null==(l=c.appearance)?void 0:l.widgetType)===Dg.Tab&&p;if(!f)return Vg.info("Hiding survey "+c.id+" because URL does not match"),h(!1),d(c);m&&(Vg.info("Showing survey "+c.id+" because it is a feedback button tab and URL matches"),h(!0))};En(Zy,"popstate",s2),En(Zy,"hashchange",s2);var f=Zy.history.pushState,m=Zy.history.replaceState;return Zy.history.pushState=function(){for(var l=arguments.length,c=new Array(l),d=0;d<l;d++)c[d]=arguments[d];f.apply(this,c),s2()},Zy.history.replaceState=function(){for(var l=arguments.length,c=new Array(l),d=0;d<l;d++)c[d]=arguments[d];m.apply(this,c),s2()},()=>{Zy.removeEventListener("popstate",s2),Zy.removeEventListener("hashchange",s2),Zy.history.pushState=f,Zy.history.replaceState=m}}}),[p,c,d,h])}function Yc(l,c,d){if(void 0===c&&(c=Fg.Right),l===$g.ExternalSurvey)return{};switch(c){case Fg.TopLeft:return{top:"0",left:"0",transform:"translate(30px, 30px)"};case Fg.TopRight:return{top:"0",right:"0",transform:"translate(-30px, 30px)"};case Fg.TopCenter:return{top:"0",left:"50%",transform:"translate(-50%, 30px)"};case Fg.MiddleLeft:return{top:"50%",left:"0",transform:"translate(30px, -50%)"};case Fg.MiddleRight:return{top:"50%",right:"0",transform:"translate(-30px, -50%)"};case Fg.MiddleCenter:return{top:"50%",left:"50%",transform:"translate(-50%, -50%)"};case Fg.Left:return{left:"30px"};case Fg.Center:return{left:"50%",transform:"translateX(-50%)"};default:case Fg.Right:return{right:l===$g.Widget&&d===Dg.Tab?"60px":"30px"}}}function Xc(l){var c,d,h,p,f,m,{survey:y,forceDisableHtml:_,posthog:b,style:w={},previewPageIndex:E,removeSurveyFromFocus:M=()=>{},isPopup:N=!0,onPreviewSubmit:P=()=>{},onPopupSurveyDismissed:L=()=>{},onCloseConfirmationMessage:j=()=>{}}=l,D=la(null),F=Number.isInteger(E),U=null!=(c=y.appearance)&&c.surveyPopupDelaySeconds?1e3*y.appearance.surveyPopupDelaySeconds:0,{isPopupVisible:B,isSurveySent:H,hidePopupWithViewTransition:z}=function(l,c,d,h,p,f){var[m,y]=oa(h||0===d||l.type===$g.ExternalSurvey),[_,b]=oa(!1),c3=()=>{var t4=()=>{l.type===$g.Popover&&p(l),y(!1)};Gy.startViewTransition?Gy.startViewTransition((()=>{var l;null==f||null==(l=f.current)||l.remove()})).finished.then((()=>{setTimeout((()=>{t4()}),100)})):t4()},d3=c=>{c.detail.surveyId===l.id&&c3()};return aa((()=>{if(c){if(!h){var n4=c=>{var d,h;if(c.detail.surveyId===l.id){if(null==(d=l.appearance)||!d.displayThankYouMessage)return c3();b(!0),null!=(h=l.appearance)&&h.autoDisappear&&setTimeout((()=>{c3()}),5e3)}},s4=()=>{nc(l)&&(y(!0),Zy.dispatchEvent(new Event("PHSurveyShown")),c.capture(zg.SHOWN,{[qg.SURVEY_NAME]:l.name,[qg.SURVEY_ID]:l.id,[qg.SURVEY_ITERATION]:l.current_iteration,[qg.SURVEY_ITERATION_START_DATE]:l.current_iteration_start_date,sessionRecordingUrl:null==c.get_session_replay_url?void 0:c.get_session_replay_url()}),localStorage.setItem("lastSeenSurveyDate",(new Date).toISOString()))};if(En(Zy,"PHSurveyClosed",d3),En(Zy,"PHSurveySent",n4),d>0){var p=setTimeout(s4,d);return()=>{clearTimeout(p),Zy.removeEventListener("PHSurveyClosed",d3),Zy.removeEventListener("PHSurveySent",n4)}}return s4(),()=>{Zy.removeEventListener("PHSurveyClosed",d3),Zy.removeEventListener("PHSurveySent",n4)}}}else Vg.error("usePopupVisibility hook called without a PostHog instance.")}),[]),Gc({survey:l,removeSurveyFromFocus:p,setSurveyVisible:y,isPreviewMode:h}),{isPopupVisible:m,isSurveySent:_,setIsPopupVisible:y,hidePopupWithViewTransition:c3}}(y,b,U,F,M,D),q=H||E===y.questions.length,V=ua((()=>{var l=ac(y);return{isPreviewMode:F,previewPageIndex:E,onPopupSurveyDismissed:()=>{((l,c,d)=>{if(c){if(!d){var h=ac(l);c.capture(zg.DISMISSED,r$2({[qg.SURVEY_NAME]:l.name,[qg.SURVEY_ID]:l.id,[qg.SURVEY_ITERATION]:l.current_iteration,[qg.SURVEY_ITERATION_START_DATE]:l.current_iteration_start_date,[qg.SURVEY_PARTIALLY_COMPLETED]:Object.values((null==h?void 0:h.responses)||{}).filter((l=>!ni(l))).length>0,sessionRecordingUrl:null==c.get_session_replay_url?void 0:c.get_session_replay_url()},null==h?void 0:h.responses,{[qg.SURVEY_SUBMISSION_ID]:null==h?void 0:h.surveySubmissionId,[qg.SURVEY_QUESTIONS]:l.questions.map((l=>({id:l.id,question:l.question,response:ju((null==h?void 0:h.responses)||{},l.id)}))),$set:{[Pa(l,"dismissed")]:!0}})),uc(l),La(l),Ey.dispatchEvent(new CustomEvent("PHSurveyClosed",{detail:{surveyId:l.id}}))}}else Vg.error("[survey dismissed] event not captured, PostHog instance not found.")})(y,b,F),L()},isPopup:N||!1,surveySubmissionId:(null==l?void 0:l.surveySubmissionId)||Ua(),onPreviewSubmit:P,posthog:b}}),[F,E,N,b,y,L,P]);return B?hc(My.Provider,{value:V,children:hc("div",{className:"ph-survey",style:r$2({},Yc(y.type,null==(d=y.appearance)?void 0:d.position,null==(h=y.appearance)?void 0:h.widgetType),w),ref:D,children:q?hc(kc,{header:(null==(p=y.appearance)?void 0:p.thankYouMessageHeader)||"Thank you!",description:(null==(f=y.appearance)?void 0:f.thankYouMessageDescription)||"",forceDisableHtml:!!_,contentType:null==(m=y.appearance)?void 0:m.thankYouMessageDescriptionContentType,appearance:y.appearance||Ry,onClose:()=>{z(),j()}}):hc(Kc,{survey:y,forceDisableHtml:!!_,posthog:b})})}):null}function Kc(l){var{survey:c,forceDisableHtml:d,posthog:h}=l,[p,f]=oa((()=>{var l=ac(c);return null!=l&&l.responses&&Vg.info("Survey is already in progress, filling in initial responses"),(null==l?void 0:l.responses)||{}})),{previewPageIndex:m,onPopupSurveyDismissed:y,isPopup:_,onPreviewSubmit:b,surveySubmissionId:w,isPreviewMode:E}=ca(My),[M,N]=oa((()=>{var l=ac(c);return m||(null==l?void 0:l.lastQuestionIndex)||0})),P=ua((()=>(l=>l.appearance&&l.appearance.shuffleQuestions&&!l.enable_partial_responses?Ku(l.questions,Xu(l.questions)):l.questions)(c)),[c]);aa((()=>{E&&!ei(m)&&N(m)}),[m,E]);var L=P.at(M);return L?hc("form",{className:"survey-form",name:"surveyForm",children:[_&&hc(Cc,{onClick:()=>{y()}}),hc("div",{className:"survey-box",children:Qc({question:L,forceDisableHtml:d,displayQuestionIndex:M,appearance:c.appearance||Ry,onSubmit:l=>(l=>{var{res:d,displayQuestionIndex:m,questionId:y}=l;if(h)if(y){var _=Bu(y),b=r$2({},p,{[_]:d});f(b);var E=function(l,c,d){var h,p=l.questions[c],f=c+1;if(null==(h=p.branching)||!h.type)return c===l.questions.length-1?Bg.End:f;if(p.branching.type===Bg.End)return Bg.End;if(p.branching.type===Bg.SpecificQuestion){if(Number.isInteger(p.branching.index))return p.branching.index}else if(p.branching.type===Bg.ResponseBased){if(p.type===Ug.SingleChoice){var m,y=p.choices.indexOf(""+d);if(-1===y&&p.hasOpenChoice&&(y=p.choices.length-1),null!=(m=p.branching)&&null!=(m=m.responseValues)&&m.hasOwnProperty(y)){var _=p.branching.responseValues[y];return Number.isInteger(_)?_:_===Bg.End?Bg.End:f}}else if(p.type===Ug.Rating){var b;if("number"!=typeof d||!Number.isInteger(d))throw new Error("The response type must be an integer");var w=function(l,c){if(3===c){if(l<1||l>3)throw new Error("The response must be in range 1-3");return 1===l?"negative":2===l?"neutral":"positive"}if(5===c){if(l<1||l>5)throw new Error("The response must be in range 1-5");return l<=2?"negative":3===l?"neutral":"positive"}if(7===c){if(l<1||l>7)throw new Error("The response must be in range 1-7");return l<=3?"negative":4===l?"neutral":"positive"}if(10===c){if(l<0||l>10)throw new Error("The response must be in range 0-10");return l<=6?"detractors":l<=8?"passives":"promoters"}throw new Error("The scale must be one of: 3, 5, 7, 10")}(d,p.scale);if(null!=(b=p.branching)&&null!=(b=b.responseValues)&&b.hasOwnProperty(w)){var E=p.branching.responseValues[w];return Number.isInteger(E)?E:E===Bg.End?Bg.End:f}}return f}return Vg.warn("Falling back to next question index due to unexpected branching type"),f}(c,m,d),M=E===Bg.End;M||(N(E),oc(c,{surveySubmissionId:w,responses:b,lastQuestionIndex:E})),(c.enable_partial_responses||M)&&Gu({responses:b,survey:c,surveySubmissionId:w,isSurveyCompleted:M,posthog:h})}else Vg.error("onNextButtonClick called without a questionId.");else Vg.error("onNextButtonClick called without a PostHog instance.")})({res:l,displayQuestionIndex:M,questionId:L.id}),onPreviewSubmit:b,initialValue:L.id?p[Bu(L.id)]:void 0})})]}):null}function Jc(l){var c,d,h,p,f,{survey:m,forceDisableHtml:y,posthog:_,readOnly:b}=l,[w,E]=oa(!0),[M,N]=oa(!1),[P,L]=oa({}),g2=()=>{N(!M)};if(aa((()=>{var l;if(_){if(!b){"tab"===(null==(l=m.appearance)?void 0:l.widgetType)&&L({top:"50%",bottom:"auto"});var t3=l=>{var c,d=l;(null==(c=d.detail)?void 0:c.surveyId)===m.id&&(Vg.info("Received show event for feedback button survey "+m.id),L(d.detail.position||{}),g2())};return En(Zy,Ky,t3),()=>{Zy.removeEventListener(Ky,t3)}}}else Vg.error("FeedbackWidget called without a PostHog instance.")}),[_,b,m.id,null==(c=m.appearance)?void 0:c.widgetType,null==(d=m.appearance)?void 0:d.widgetSelector,null==(h=m.appearance)?void 0:h.borderColor]),Gc({survey:m,setSurveyVisible:E}),!w)return null;var _2=()=>{m.schedule!==Hg.Always&&E(!1),setTimeout((()=>{N(!1)}),200)};return hc(xo,{children:["tab"===(null==(p=m.appearance)?void 0:p.widgetType)&&hc("button",{className:"ph-survey-widget-tab",onClick:g2,disabled:b,children:(null==(f=m.appearance)?void 0:f.widgetLabel)||""}),M&&hc(Xc,{posthog:_,survey:m,forceDisableHtml:y,style:P,onPopupSurveyDismissed:_2,onCloseConfirmationMessage:_2})]})}var Qc=l=>{var{question:c,forceDisableHtml:d,displayQuestionIndex:h,appearance:p,onSubmit:f,onPreviewSubmit:m,initialValue:y}=l,_={forceDisableHtml:d,appearance:p,onPreviewSubmit:l=>{m(l)},onSubmit:l=>{f(l)},initialValue:y,displayQuestionIndex:h};switch(c.type){case Ug.Open:return ko(xc,r$2({},_,{question:c,key:c.id}));case Ug.Link:return ko(Tc,r$2({},_,{question:c,key:c.id}));case Ug.Rating:return ko(Mc,r$2({},_,{question:c,key:c.id}));case Ug.SingleChoice:case Ug.MultipleChoice:return ko(Ac,r$2({},_,{question:c,key:c.id}));default:return Vg.error("Unsupported question type: "+c.type),null}};gm.__PosthogExtensions__=gm.__PosthogExtensions__||{},gm.__PosthogExtensions__.generateSurveys=jc,gm.extendPostHogWithSurveys=jc;var Yy=_m("[Error tracking]");function td(){return new Li([new Oi,new zi,new Hi,new Di,new Ui,new Wi,new Bi,new Zi],[Ti,Ai])}class rd{constructor(l){var c,d;this._suppressionRules=[],this._errorPropertiesBuilder=td(),this._instance=l,this._suppressionRules=null!==(c=null==(d=this._instance.persistence)?void 0:d.get_property(Tm))&&void 0!==c?c:[]}onRemoteConfig(l){var c,d,h,p=null!==(c=null==(d=l.errorTracking)?void 0:d.suppressionRules)&&void 0!==c?c:[],f=null==(h=l.errorTracking)?void 0:h.captureExtensionExceptions;this._suppressionRules=p,this._instance.persistence&&this._instance.persistence.register({[Tm]:this._suppressionRules,[Rm]:f})}get _captureExtensionExceptions(){var l,c=!!this._instance.get_property(Rm),d=this._instance.config.error_tracking.captureExtensionExceptions;return null!==(l=null!=d?d:c)&&void 0!==l&&l}buildProperties(l,c){return this._errorPropertiesBuilder.buildFromUnknown(l,{syntheticException:null==c?void 0:c.syntheticException,mechanism:{handled:null==c?void 0:c.handled}})}sendExceptionEvent(l){var c=l.$exception_list;if(this._isExceptionList(c)){if(this._matchesSuppressionRule(c))return void Yy.info("Skipping exception capture because a suppression rule matched");if(!this._captureExtensionExceptions&&this._isExtensionException(c))return void Yy.info("Skipping exception capture because it was thrown by an extension");if(!this._instance.config.error_tracking.__capturePostHogExceptions&&this._isPostHogException(c))return void Yy.info("Skipping exception capture because it was thrown by the PostHog SDK")}return this._instance.capture("$exception",l,{_noTruncate:!0,_batchKey:"exceptionEvent"})}_matchesSuppressionRule(l){if(0===l.length)return!1;var c=l.reduce(((l,c)=>{var{type:d,value:h}=c;return ti(d)&&d.length>0&&l.$exception_types.push(d),ti(h)&&h.length>0&&l.$exception_values.push(h),l}),{$exception_types:[],$exception_values:[]});return this._suppressionRules.some((l=>{var d=l.values.map((l=>{var d,h=ky[l.operator],p=zf(l.value)?l.value:[l.value],f=null!==(d=c[l.key])&&void 0!==d?d:[];return p.length>0&&h(p,f)}));return"OR"===l.type?d.some(Boolean):d.every(Boolean)}))}_isExtensionException(l){var c=l.flatMap((l=>{var c,d;return null!==(c=null==(d=l.stacktrace)?void 0:d.frames)&&void 0!==c?c:[]}));return c.some((l=>l.filename&&l.filename.startsWith("chrome-extension://")))}_isPostHogException(l){if(l.length>0){var c,d,h,p,f=null!==(c=null==(d=l[0].stacktrace)?void 0:d.frames)&&void 0!==c?c:[],m=f[f.length-1];return null!==(h=null==m||null==(p=m.filename)?void 0:p.includes("posthog.com/static"))&&void 0!==h&&h}return!1}_isExceptionList(l){return!ni(l)&&zf(l)}}var Qy=_m("[ExceptionAutocapture]"),Xy=td();function sd(l){var{event:c,error:d}=l;return Xy.buildFromUnknown(d||c,{mechanism:{handled:!1}})}var e_={wrapOnError:l=>{var c=sm;c||Qy.info("window not available, cannot wrap onerror");var d=c.onerror;return c.onerror=function(){for(var c,h=arguments.length,p=new Array(h),f=0;f<h;f++)p[f]=arguments[f];var m=sd({event:p[0],error:p[4]});return l(m),null!==(c=null==d?void 0:d(...p))&&void 0!==c&&c},c.onerror.__POSTHOG_INSTRUMENTED__=!0,()=>{var l;null==(l=c.onerror)||delete l.__POSTHOG_INSTRUMENTED__,c.onerror=d}},wrapUnhandledRejection:l=>{var c=sm;c||Qy.info("window not available, cannot wrap onUnhandledRejection");var d=c.onunhandledrejection;return c.onunhandledrejection=function(h){var p,f=sd({event:h});return l(f),null!==(p=null==d?void 0:d.apply(c,[h]))&&void 0!==p&&p},c.onunhandledrejection.__POSTHOG_INSTRUMENTED__=!0,()=>{var l;null==(l=c.onunhandledrejection)||delete l.__POSTHOG_INSTRUMENTED__,c.onunhandledrejection=d}},wrapConsoleError:l=>{var c=console;c||Qy.info("console not available, cannot wrap console.error");var d=c.error;return c.error=function(){for(var c=arguments.length,h=new Array(c),p=0;p<c;p++)h[p]=arguments[p];var f=h.join(" "),m=sd({error:h.find((l=>l instanceof Error)),event:f});return l(m),null==d?void 0:d(...h)},c.error.__POSTHOG_INSTRUMENTED__=!0,()=>{var l;null==(l=c.error)||delete l.__POSTHOG_INSTRUMENTED__,c.error=d}}};gm.__PosthogExtensions__=gm.__PosthogExtensions__||{},gm.__PosthogExtensions__.errorWrappingFunctions=e_,gm.posthogErrorWrappingFunctions=e_;var ad=(l,c,d,h)=>{var p;try{p=new URL(h.url).hostname}catch(y){return}if(!zf(l)||l.includes(p)){if(d){var{sessionId:f,windowId:m}=d.checkAndGetSessionAndWindowId(!0);h.headers.set("X-POSTHOG-SESSION-ID",f),h.headers.set("X-POSTHOG-WINDOW-ID",m)}c!==Qm&&h.headers.set("X-POSTHOG-DISTINCT-ID",c)}};gm.__PosthogExtensions__=gm.__PosthogExtensions__||{};var t_={_patchFetch:(l,c,d)=>Nn(sm,"fetch",(h=>{return p=t$1((function*(p,f){var m=new Request(p,f);return ad(l,c,d,m),h(m)})),function(l,c){return p.apply(this,arguments)};var p})),_patchXHR:(l,c,d)=>Nn(sm.XMLHttpRequest.prototype,"open",(h=>function(p,f,m,y,_){void 0===m&&(m=!0);var b=new Request(f);return ad(l,c,d,b),h.call(this,p,b.url,m,y,_)}))};gm.__PosthogExtensions__.tracingHeadersPatchFns=t_,gm.postHogTracingHeadersPatchFns=t_;var r_,n_,dd=function(){var l=self.performance&&performance.getEntriesByType&&performance.getEntriesByType("navigation")[0];if(l&&l.responseStart>0&&l.responseStart<performance.now())return l},hd=function(l){if("loading"===document.readyState)return"loading";var c=dd();if(c){if(l<c.domInteractive)return"loading";if(0===c.domContentLoadedEventStart||l<c.domContentLoadedEventStart)return"dom-interactive";if(0===c.domComplete||l<c.domComplete)return"dom-content-loaded"}return"complete"},pd=function(l){var c=l.nodeName;return 1===l.nodeType?c.toLowerCase():c.toUpperCase().replace(/^#/,"")},vd=function(l,c){var d="";try{for(;l&&9!==l.nodeType;){var h=l,p=h.id?"#"+h.id:pd(h)+(h.classList&&h.classList.value&&h.classList.value.trim()&&h.classList.value.trim().length?"."+h.classList.value.trim().replace(/\s+/g,"."):"");if(d.length+p.length>(c||100)-1)return d||p;if(d=d?p+">"+d:p,h.id)break;l=h.parentNode}}catch(f){}return d},s_=-1,gd=function(){return s_},_d=function(l){addEventListener("pageshow",(function(c){c.persisted&&(s_=c.timeStamp,l(c))}),!0)},md=function(){var l=dd();return l&&l.activationStart||0},yd=function(l,c){var d=dd(),h="navigate";return gd()>=0?h="back-forward-cache":d&&(document.prerendering||md()>0?h="prerender":document.wasDiscarded?h="restore":d.type&&(h=d.type.replace(/_/g,"-"))),{name:l,value:void 0===c?-1:c,rating:"good",delta:0,entries:[],id:"v4-".concat(Date.now(),"-").concat(Math.floor(8999999999999*Math.random())+1e12),navigationType:h}},bd=function(l,c,d){try{if(PerformanceObserver.supportedEntryTypes.includes(l)){var h=new PerformanceObserver((function(l){Promise.resolve().then((function(){c(l.getEntries())}))}));return h.observe(Object.assign({type:l,buffered:!0},d||{})),h}}catch(p){}},Sd=function(l,c,d,h){var p,f;return function(m){var y,_;c.value>=0&&(m||h)&&((f=c.value-(p||0))||void 0===p)&&(p=c.value,c.delta=f,c.rating=(y=c.value)>(_=d)[1]?"poor":y>_[0]?"needs-improvement":"good",l(c))}},wd=function(l){requestAnimationFrame((function(){return requestAnimationFrame((function(){return l()}))}))},Cd=function(l){document.addEventListener("visibilitychange",(function(){"hidden"===document.visibilityState&&l()}))},Id=function(l){var c=!1;return function(){c||(l(),c=!0)}},i_=-1,Ed=function(){return"hidden"!==document.visibilityState||document.prerendering?1/0:0},xd=function(l){"hidden"===document.visibilityState&&i_>-1&&(i_="visibilitychange"===l.type?l.timeStamp:0,Md())},Td=function(){addEventListener("visibilitychange",xd,!0),addEventListener("prerenderingchange",xd,!0)},Md=function(){removeEventListener("visibilitychange",xd,!0),removeEventListener("prerenderingchange",xd,!0)},Rd=function(){return i_<0&&(i_=Ed(),Td(),_d((function(){setTimeout((function(){i_=Ed(),Td()}),0)}))),{get firstHiddenTime(){return i_}}},Ad=function(l){document.prerendering?addEventListener("prerenderingchange",(function(){return l()}),!0):l()},o_=[1800,3e3],Pd=function(l,c){c=c||{},Ad((function(){var d,h=Rd(),p=yd("FCP"),f=bd("paint",(function(l){l.forEach((function(l){"first-contentful-paint"===l.name&&(f.disconnect(),l.startTime<h.firstHiddenTime&&(p.value=Math.max(l.startTime-md(),0),p.entries.push(l),d(!0)))}))}));f&&(d=Sd(l,p,o_,c.reportAllChanges),_d((function(h){p=yd("FCP"),d=Sd(l,p,o_,c.reportAllChanges),wd((function(){p.value=performance.now()-h.timeStamp,d(!0)}))})))}))},a_=[.1,.25],l_=0,c_=1/0,u_=0,Hd=function(l){l.forEach((function(l){l.interactionId&&(c_=Math.min(c_,l.interactionId),u_=Math.max(u_,l.interactionId),l_=u_?(u_-c_)/7+1:0)}))},qd=function(){return r_?l_:performance.interactionCount||0},d_=[],h_=new Map,p_=0,f_=[],Zd=function(l){if(f_.forEach((function(c){return c(l)})),l.interactionId||"first-input"===l.entryType){var c=d_[d_.length-1],d=h_.get(l.interactionId);if(d||d_.length<10||l.duration>c.latency){if(d)l.duration>d.latency?(d.entries=[l],d.latency=l.duration):l.duration===d.latency&&l.startTime===d.entries[0].startTime&&d.entries.push(l);else{var h={id:l.interactionId,latency:l.duration,entries:[l]};h_.set(h.id,h),d_.push(h)}d_.sort((function(l,c){return c.latency-l.latency})),d_.length>10&&d_.splice(10).forEach((function(l){return h_.delete(l.id)}))}}},zd=function(l){var c=self.requestIdleCallback||self.setTimeout,d=-1;return l=Id(l),"hidden"===document.visibilityState?l():(d=c(l),Cd(l)),d},m_=[200,500],Gd=function(l,c){"PerformanceEventTiming"in self&&"interactionId"in PerformanceEventTiming.prototype&&(c=c||{},Ad((function(){var d;"interactionCount"in performance||r_||(r_=bd("event",Hd,{type:"event",buffered:!0,durationThreshold:0}));var h,p=yd("INP"),s2=function(l){zd((function(){l.forEach(Zd);var c,d=(c=Math.min(d_.length-1,Math.floor((qd()-p_)/50)),d_[c]);d&&d.latency!==p.value&&(p.value=d.latency,p.entries=d.entries,h())}))},f=bd("event",s2,{durationThreshold:null!==(d=c.durationThreshold)&&void 0!==d?d:40});h=Sd(l,p,m_,c.reportAllChanges),f&&(f.observe({type:"first-input",buffered:!0}),Cd((function(){s2(f.takeRecords()),h(!0)})),_d((function(){p_=qd(),d_.length=0,h_.clear(),p=yd("INP"),h=Sd(l,p,m_,c.reportAllChanges)})))})))},g_=[],v_=[],y_=0,b_=new WeakMap,w_=new Map,S_=-1,th=function(l){g_=g_.concat(l),rh()},rh=function(){S_<0&&(S_=zd(ih))},ih=function(){w_.size>10&&w_.forEach((function(l,c){h_.has(c)||w_.delete(c)}));var l=d_.map((function(l){return b_.get(l.entries[0])})),c=v_.length-50;v_=v_.filter((function(d,h){return h>=c||l.includes(d)}));for(var d=new Set,h=0;h<v_.length;h++){var p=v_[h];nh(p.startTime,p.processingEnd).forEach((function(l){d.add(l)}))}var f=g_.length-1-50;g_=g_.filter((function(l,c){return l.startTime>y_&&c>f||d.has(l)})),S_=-1};f_.push((function(l){l.interactionId&&l.target&&!w_.has(l.interactionId)&&w_.set(l.interactionId,l.target)}),(function(l){var c,d=l.startTime+l.duration;y_=Math.max(y_,l.processingEnd);for(var h=v_.length-1;h>=0;h--){var p=v_[h];if(Math.abs(d-p.renderTime)<=8){(c=p).startTime=Math.min(l.startTime,c.startTime),c.processingStart=Math.min(l.processingStart,c.processingStart),c.processingEnd=Math.max(l.processingEnd,c.processingEnd),c.entries.push(l);break}}c||(c={startTime:l.startTime,processingStart:l.processingStart,processingEnd:l.processingEnd,renderTime:d,entries:[l]},v_.push(c)),(l.interactionId||"first-input"===l.entryType)&&b_.set(l,c),rh()}));var nh=function(l,c){for(var d,h=[],p=0;d=g_[p];p++)if(!(d.startTime+d.duration<l)){if(d.startTime>c)break;h.push(d)}return h},x_=[2500,4e3],k_={},C_={onLCP:function(l,c){var d,h;d=function(c){var d=function(l){var c={timeToFirstByte:0,resourceLoadDelay:0,resourceLoadDuration:0,elementRenderDelay:l.value};if(l.entries.length){var d=dd();if(d){var h=d.activationStart||0,p=l.entries[l.entries.length-1],f=p.url&&performance.getEntriesByType("resource").filter((function(l){return l.name===p.url}))[0],m=Math.max(0,d.responseStart-h),y=Math.max(m,f?(f.requestStart||f.startTime)-h:0),_=Math.max(y,f?f.responseEnd-h:0),b=Math.max(_,p.startTime-h);c={element:vd(p.element),timeToFirstByte:m,resourceLoadDelay:y-m,resourceLoadDuration:_-y,elementRenderDelay:b-_,navigationEntry:d,lcpEntry:p},p.url&&(c.url=p.url),f&&(c.lcpResourceEntry=f)}}return Object.assign(l,{attribution:c})}(c);l(d)},h=(h=c)||{},Ad((function(){var l,c=Rd(),p=yd("LCP"),s2=function(d){h.reportAllChanges||(d=d.slice(-1)),d.forEach((function(d){d.startTime<c.firstHiddenTime&&(p.value=Math.max(d.startTime-md(),0),p.entries=[d],l())}))},f=bd("largest-contentful-paint",s2);if(f){l=Sd(d,p,x_,h.reportAllChanges);var m=Id((function(){k_[p.id]||(s2(f.takeRecords()),f.disconnect(),k_[p.id]=!0,l(!0))}));["keydown","click"].forEach((function(l){addEventListener(l,(function(){return zd(m)}),{once:!0,capture:!0})})),Cd(m),_d((function(c){p=yd("LCP"),l=Sd(d,p,x_,h.reportAllChanges),wd((function(){p.value=performance.now()-c.timeStamp,k_[p.id]=!0,l(!0)}))}))}}))},onCLS:function(l,c){var d,h;d=function(c){var d=function(l){var c,d={};if(l.entries.length){var h=l.entries.reduce((function(l,c){return l&&l.value>c.value?l:c}));if(h&&h.sources&&h.sources.length){var p=(c=h.sources).find((function(l){return l.node&&1===l.node.nodeType}))||c[0];p&&(d={largestShiftTarget:vd(p.node),largestShiftTime:h.startTime,largestShiftValue:h.value,largestShiftSource:p,largestShiftEntry:h,loadState:hd(h.startTime)})}}return Object.assign(l,{attribution:d})}(c);l(d)},h=(h=c)||{},Pd(Id((function(){var l,c=yd("CLS",0),p=0,f=[],o2=function(d){d.forEach((function(l){if(!l.hadRecentInput){var c=f[0],d=f[f.length-1];p&&l.startTime-d.startTime<1e3&&l.startTime-c.startTime<5e3?(p+=l.value,f.push(l)):(p=l.value,f=[l])}})),p>c.value&&(c.value=p,c.entries=f,l())},m=bd("layout-shift",o2);m&&(l=Sd(d,c,a_,h.reportAllChanges),Cd((function(){o2(m.takeRecords()),l(!0)})),_d((function(){p=0,c=yd("CLS",0),l=Sd(d,c,a_,h.reportAllChanges),wd((function(){return l()}))})),setTimeout(l,0))})))},onFCP:function(l,c){Pd((function(c){var d=function(l){var c={timeToFirstByte:0,firstByteToFCP:l.value,loadState:hd(gd())};if(l.entries.length){var d=dd(),h=l.entries[l.entries.length-1];if(d){var p=d.activationStart||0,f=Math.max(0,d.responseStart-p);c={timeToFirstByte:f,firstByteToFCP:l.value-f,loadState:hd(l.entries[0].startTime),navigationEntry:d,fcpEntry:h}}}return Object.assign(l,{attribution:c})}(c);l(d)}),c)},onINP:function(l,c){n_||(n_=bd("long-animation-frame",th)),Gd((function(c){var d,h,p,f,m,y,_,b,w,E,M,N,P=(h=(d=c).entries[0],p=b_.get(h),f=h.processingStart,m=p.processingEnd,y=p.entries.sort((function(l,c){return l.processingStart-c.processingStart})),_=nh(h.startTime,m),b=d.entries.find((function(l){return l.target})),w=b&&b.target||w_.get(h.interactionId),E=[h.startTime+h.duration,m].concat(_.map((function(l){return l.startTime+l.duration}))),M=Math.max.apply(Math,E),N={interactionTarget:vd(w),interactionTargetElement:w,interactionType:h.name.startsWith("key")?"keyboard":"pointer",interactionTime:h.startTime,nextPaintTime:M,processedEventEntries:y,longAnimationFrameEntries:_,inputDelay:f-h.startTime,processingDuration:m-f,presentationDelay:Math.max(M-m,0),loadState:hd(h.startTime)},Object.assign(d,{attribution:N}));l(P)}),c)}};gm.__PosthogExtensions__=gm.__PosthogExtensions__||{},gm.__PosthogExtensions__.postHogWebVitalsCallbacks=C_,gm.postHogWebVitalsCallbacks=C_;class lh{constructor(l){this.disabled=!1===l;var c=Jr(l)?l:{};this.thresholdPx=c.threshold_px||30,this.timeoutMs=c.timeout_ms||1e3,this.clickCount=c.click_count||3,this.clicks=[]}isRageClick(l,c,d){if(this.disabled)return!1;var h=this.clicks[this.clicks.length-1];if(h&&Math.abs(l-h.x)+Math.abs(c-h.y)<this.thresholdPx&&d-h.timestamp<this.timeoutMs){if(this.clicks.push({x:l,y:c,timestamp:d}),this.clicks.length===this.clickCount)return!0}else this.clicks=[{x:l,y:c,timestamp:d}];return!1}}var E_=_m("[AutoCapture]");function ch(l,c){return c.length>l?c.slice(0,l)+"...":c}function dh(l){if(l.previousElementSibling)return l.previousElementSibling;var c=l;do{c=c.previousSibling}while(c&&!ps(c));return c}function ph(l,c){for(var d,h,{e:p,maskAllElementAttributes:f,maskAllText:m,elementAttributeIgnoreList:y,elementsChainAsString:_}=c,b=[l],w=l;w.parentNode&&!vs(w,"body");)gs(w.parentNode)?(b.push(w.parentNode.host),w=w.parentNode.host):(b.push(w.parentNode),w=w.parentNode);var E,M=[],N={},P=!1,L=!1;if(fn(b,(l=>{var c=Rs(l);"a"===l.tagName.toLowerCase()&&(P=l.getAttribute("href"),P=c&&P&&Hs(P)&&P),$r(ys(l),"ph-no-capture")&&(L=!0),M.push(function(l,c,d,h){var p=l.tagName.toLowerCase(),f={tag_name:p};eg.indexOf(p)>-1&&!d&&("a"===p.toLowerCase()||"button"===p.toLowerCase()?f.$el_text=ch(1024,qs(l)):f.$el_text=ch(1024,Ss(l)));var m=ys(l);m.length>0&&(f.classes=m.filter((function(l){return""!==l}))),fn(l.attributes,(function(d){var p;if((!As(l)||-1!==["name","id","class","aria-label"].indexOf(d.name))&&(null==h||!h.includes(d.name))&&!c&&Hs(d.value)&&(p=d.name,!ti(p)||"_ngcontent"!==p.substring(0,10)&&"_nghost"!==p.substring(0,7))){var m=d.value;"class"===d.name&&(m=_s(m).join(" ")),f["attr__"+d.name]=ch(1024,m)}}));for(var y=1,_=1,b=l;b=dh(b);)y++,b.tagName===l.tagName&&_++;return f.nth_child=y,f.nth_of_type=_,f}(l,f,m,y));var d=function(l){if(!Rs(l))return{};var c={};return fn(l.attributes,(function(l){if(l.name&&0===l.name.indexOf("data-ph-capture-attribute")){var d=l.name.replace("data-ph-capture-attribute-",""),h=l.value;d&&h&&Hs(h)&&(c[d]=h)}})),c}(l);gn(N,d)})),L)return{props:{},explicitNoCapture:L};if(m||("a"===l.tagName.toLowerCase()||"button"===l.tagName.toLowerCase()?M[0].$el_text=qs(l):M[0].$el_text=Ss(l)),P){var j,D;M[0].attr__href=P;var F=null==(j=xn(P))?void 0:j.host,U=null==sm||null==(D=sm.location)?void 0:D.host;F&&U&&F!==U&&(E=P)}return{props:gn({$event_type:p.type,$ce_version:1},_?{}:{$elements:M},{$elements_chain:Vs(M)},null!=(d=M[0])&&d.$el_text?{$el_text:null==(h=M[0])?void 0:h.$el_text}:{},E&&"click"===p.type?{$external_click_url:E}:{},N)}}class vh{constructor(l){this._initialized=!1,this._isDisabledServerSide=null,this._elementsChainAsString=!1,this.instance=l,this.rageclicks=new lh(l.config.rageclick),this._elementSelectors=null}get _config(){var l,c,d=Jr(this.instance.config.autocapture)?this.instance.config.autocapture:{};return d.url_allowlist=null==(l=d.url_allowlist)?void 0:l.map((l=>new RegExp(l))),d.url_ignorelist=null==(c=d.url_ignorelist)?void 0:c.map((l=>new RegExp(l))),d}_addDomEventHandlers(){if(this.isBrowserSupported()){if(sm&&um){var e3=l=>{l=l||(null==sm?void 0:sm.event);try{this._captureEvent(l)}catch(c){E_.error("Failed to capture event",c)}};if(En(um,"submit",e3,{capture:!0}),En(um,"change",e3,{capture:!0}),En(um,"click",e3,{capture:!0}),this._config.capture_copied_text){var t2=l=>{l=l||(null==sm?void 0:sm.event),this._captureEvent(l,ey)};En(um,"copy",t2,{capture:!0}),En(um,"cut",t2,{capture:!0})}}}else E_.info("Disabling Automatic Event Collection because this browser is not supported")}startIfEnabled(){this.isEnabled&&!this._initialized&&(this._addDomEventHandlers(),this._initialized=!0)}onRemoteConfig(l){l.elementsChainAsString&&(this._elementsChainAsString=l.elementsChainAsString),this.instance.persistence&&this.instance.persistence.register({[Cm]:!!l.autocapture_opt_out}),this._isDisabledServerSide=!!l.autocapture_opt_out,this.startIfEnabled()}setElementSelectors(l){this._elementSelectors=l}getElementSelectors(l){var c,d=[];return null==(c=this._elementSelectors)||c.forEach((c=>{var h=null==um?void 0:um.querySelectorAll(c);null==h||h.forEach((h=>{l===h&&d.push(c)}))})),d}get isEnabled(){var l,c,d=null==(l=this.instance.persistence)?void 0:l.props[Cm],h=this._isDisabledServerSide;if(ii(h)&&!oi(d)&&!this.instance._shouldDisableFlags())return!1;var p=null!==(c=this._isDisabledServerSide)&&void 0!==c?c:!!d;return!!this.instance.config.autocapture&&!p}_captureEvent(l,c){if(void 0===c&&(c="$autocapture"),this.isEnabled){var d,h=ws(l);fs(h)&&(h=h.parentNode||null),"$autocapture"===c&&"click"===l.type&&l instanceof MouseEvent&&this.instance.config.rageclick&&null!=(d=this.rageclicks)&&d.isRageClick(l.clientX,l.clientY,(new Date).getTime())&&function(l,c){if(!sm||xs(l))return!1;var d,h;if(!1===(d=oi(c)?!!c&&tg:null!==(h=null==c?void 0:c.css_selector_ignorelist)&&void 0!==h?h:tg))return!1;var{targetElementList:p}=Ts(l,!1);return!Is(p,d)}(h,this.instance.config.rageclick)&&this._captureEvent(l,"$rageclick");var p=c===ey;if(h&&function(l,c,d,h,p){var f,m,y,_;if(void 0===d&&(d=void 0),!sm||xs(l))return!1;if(null!=(f=d)&&f.url_allowlist&&!ms(d.url_allowlist))return!1;if(null!=(m=d)&&m.url_ignorelist&&ms(d.url_ignorelist))return!1;if(null!=(y=d)&&y.dom_event_allowlist){var b=d.dom_event_allowlist;if(b&&!b.some((l=>c.type===l)))return!1}var{parentIsUsefulElement:w,targetElementList:E}=Ts(l,h);if(!function(l,c){var d=null==c?void 0:c.element_allowlist;if(ei(d))return!0;var h,n3=function(l){if(d.some((c=>l.tagName.toLowerCase()===c)))return{v:!0}};for(var p of l)if(h=n3(p))return h.v;return!1}(E,d))return!1;if(!Is(E,null==(_=d)?void 0:_.css_selector_allowlist))return!1;var M=sm.getComputedStyle(l);if(M&&"pointer"===M.getPropertyValue("cursor")&&"click"===c.type)return!0;var N=l.tagName.toLowerCase();switch(N){case"html":return!1;case"form":return(p||["submit"]).indexOf(c.type)>=0;case"input":case"select":case"textarea":return(p||["change","click"]).indexOf(c.type)>=0;default:return w?(p||["click"]).indexOf(c.type)>=0:(p||["click"]).indexOf(c.type)>=0&&(eg.indexOf(N)>-1||"true"===l.getAttribute("contenteditable"))}}(h,l,this._config,p,p?["copy","cut"]:void 0)){var{props:f,explicitNoCapture:m}=ph(h,{e:l,maskAllElementAttributes:this.instance.config.mask_all_element_attributes,maskAllText:this.instance.config.mask_all_text,elementAttributeIgnoreList:this._config.element_attribute_ignorelist,elementsChainAsString:this._elementsChainAsString});if(m)return!1;var y=this.getElementSelectors(h);if(y&&y.length>0&&(f.$element_selectors=y),c===ey){var _,b=bs(null==sm||null==(_=sm.getSelection())?void 0:_.toString()),w=l.type||"clipboard";if(!b)return!1;f.$selected_content=b,f.$copy_type=w}return this.instance.capture(c,f),!0}}}isBrowserSupported(){return Xr(null==um?void 0:um.querySelectorAll)}}var I_={};function gh(l){return function(l,c){var d=I_[l];if(d)return d;var h=c[l];if((l=>Xr(l)&&-1!==l.toString().indexOf("[native code]"))(h)&&!sm.Zone)return I_[l]=h.bind(c);var p=c.document;if(p&&Xr(p.createElement))try{var f=p.createElement("iframe");f.hidden=!0,p.head.appendChild(f);var m=f.contentWindow;m&&m[l]&&(h=m[l]),p.head.removeChild(f)}catch(y){ym.warn("Could not create sandbox iframe for "+l+" check, bailing to assignableWindow."+l+": ",y)}return h&&Xr(h)?I_[l]=h.bind(c):h}("MutationObserver",l)}function _h(l,c){return si(l)&&l>=c}class mh{_asRequiredConfig(l){var c,d,h,p,f=this._defaultConfig((null==l?void 0:l.__onCapture)||this._captureDeadClick.bind(this));return{element_attribute_ignorelist:null!==(c=null==l?void 0:l.element_attribute_ignorelist)&&void 0!==c?c:f.element_attribute_ignorelist,scroll_threshold_ms:null!==(d=null==l?void 0:l.scroll_threshold_ms)&&void 0!==d?d:f.scroll_threshold_ms,selection_change_threshold_ms:null!==(h=null==l?void 0:l.selection_change_threshold_ms)&&void 0!==h?h:f.selection_change_threshold_ms,mutation_threshold_ms:null!==(p=null==l?void 0:l.mutation_threshold_ms)&&void 0!==p?p:f.mutation_threshold_ms,__onCapture:f.__onCapture}}constructor(l,c){this._clicks=[],this._defaultConfig=l=>({element_attribute_ignorelist:[],scroll_threshold_ms:100,selection_change_threshold_ms:100,mutation_threshold_ms:2500,__onCapture:l}),this._onClick=l=>{var c,d,h=(d=ws(c=l))?{node:d,originalEvent:c,timestamp:Date.now()}:null;ii(h)||this._ignoreClick(h)||this._clicks.push(h),this._clicks.length&&ei(this._checkClickTimer)&&(this._checkClickTimer=gm.setTimeout((()=>{this._checkClicks()}),1e3))},this._onScroll=()=>{var l=Date.now();l%50==0&&this._clicks.forEach((c=>{ei(c.scrollDelayMs)&&(c.scrollDelayMs=l-c.timestamp)}))},this._onSelectionChange=()=>{this._lastSelectionChanged=Date.now()},this.instance=l,this._config=this._asRequiredConfig(c),this._onCapture=this._config.__onCapture}start(l){this._startClickObserver(),this._startScrollObserver(),this._startSelectionChangedObserver(),this._startMutationObserver(l)}_startMutationObserver(l){if(!this._mutationObserver){var c=gh(gm);this._mutationObserver=new c((l=>{this._onMutation(l)})),this._mutationObserver.observe(l,{attributes:!0,characterData:!0,childList:!0,subtree:!0})}}stop(){var l;null==(l=this._mutationObserver)||l.disconnect(),this._mutationObserver=void 0,gm.removeEventListener("click",this._onClick),gm.removeEventListener("scroll",this._onScroll,{capture:!0}),gm.removeEventListener("selectionchange",this._onSelectionChange)}_onMutation(l){this._lastMutation=Date.now()}_startClickObserver(){En(gm,"click",this._onClick)}_startScrollObserver(){En(gm,"scroll",this._onScroll,{capture:!0})}_startSelectionChangedObserver(){En(gm,"selectionchange",this._onSelectionChange)}_ignoreClick(l){return!l||(!!hs(l.node)||(!!this._clicks.some((c=>c.node===l.node&&Math.abs(c.timestamp-l.timestamp)<1e3))||!(!vs(l.node,"html")&&ps(l.node)&&!eg.includes(l.node.tagName.toLowerCase()))))}_checkClicks(){if(this._clicks.length){clearTimeout(this._checkClickTimer),this._checkClickTimer=void 0;var l=this._clicks;for(var c of(this._clicks=[],l)){var d;c.mutationDelayMs=null!==(d=c.mutationDelayMs)&&void 0!==d?d:this._lastMutation&&c.timestamp<=this._lastMutation?this._lastMutation-c.timestamp:void 0,c.absoluteDelayMs=Date.now()-c.timestamp,c.selectionChangedDelayMs=this._lastSelectionChanged&&c.timestamp<=this._lastSelectionChanged?this._lastSelectionChanged-c.timestamp:void 0;var h=_h(c.scrollDelayMs,this._config.scroll_threshold_ms),p=_h(c.selectionChangedDelayMs,this._config.selection_change_threshold_ms),f=_h(c.mutationDelayMs,this._config.mutation_threshold_ms),m=_h(c.absoluteDelayMs,1.1*this._config.mutation_threshold_ms),y=si(c.scrollDelayMs)&&c.scrollDelayMs<this._config.scroll_threshold_ms,_=si(c.mutationDelayMs)&&c.mutationDelayMs<this._config.mutation_threshold_ms,b=si(c.selectionChangedDelayMs)&&c.selectionChangedDelayMs<this._config.selection_change_threshold_ms;y||_||b||(h||f||m||p?this._onCapture(c,{$dead_click_last_mutation_timestamp:this._lastMutation,$dead_click_event_timestamp:c.timestamp,$dead_click_scroll_timeout:h,$dead_click_mutation_timeout:f,$dead_click_absolute_timeout:m,$dead_click_selection_changed_timeout:p}):c.absoluteDelayMs<this._config.mutation_threshold_ms&&this._clicks.push(c))}this._clicks.length&&ei(this._checkClickTimer)&&(this._checkClickTimer=gm.setTimeout((()=>{this._checkClicks()}),1e3))}}_captureDeadClick(l,c){this.instance.capture("$dead_click",r$2({},c,ph(l.node,{e:l.originalEvent,maskAllElementAttributes:this.instance.config.mask_all_element_attributes,maskAllText:this.instance.config.mask_all_text,elementAttributeIgnoreList:this._config.element_attribute_ignorelist,elementsChainAsString:!1}).props,{$dead_click_scroll_delay_ms:l.scrollDelayMs,$dead_click_mutation_delay_ms:l.mutationDelayMs,$dead_click_absolute_delay_ms:l.absoluteDelayMs,$dead_click_selection_changed_delay_ms:l.selectionChangedDelayMs}),{timestamp:new Date(l.timestamp)})}}gm.__PosthogExtensions__=gm.__PosthogExtensions__||{},gm.__PosthogExtensions__.initDeadClicksAutocapture=(l,c)=>new mh(l,c);var T_="",R_=/[a-z0-9][a-z0-9-]+\.[a-z]{2,}$/i;var A_={_is_supported:()=>!!um,_error:function(l){ym.error("cookieStore error: "+l)},_get:function(l){if(um){try{for(var c=l+"=",d=um.cookie.split(";").filter((l=>l.length)),h=0;h<d.length;h++){for(var p=d[h];" "==p.charAt(0);)p=p.substring(1,p.length);if(0===p.indexOf(c))return decodeURIComponent(p.substring(c.length,p.length))}}catch(f){}return null}},_parse:function(l){var c;try{c=JSON.parse(A_._get(l))||{}}catch(d){}return c},_set:function(l,c,d,h,p){if(um)try{var f="",m="",y=function(l,c){if(c){var d=function(l,c){if(void 0===c&&(c=um),T_)return T_;if(!c)return"";if(["localhost","127.0.0.1"].includes(l))return"";for(var d=l.split("."),h=Math.min(d.length,8),p="dmn_chk_"+Ua();!T_&&h--;){var f=d.slice(h).join("."),m=p+"=1;domain=."+f+";path=/";c.cookie=m+";max-age=3",c.cookie.includes(p)&&(c.cookie=m+";max-age=0",T_=f)}return T_}(l);if(!d){var h=(p=l.match(R_))?p[0]:"";h!==d&&ym.info("Warning: cookie subdomain discovery mismatch",h,d),d=h}return d?"; domain=."+d:""}var p;return""}(um.location.hostname,h);if(d){var _=new Date;_.setTime(_.getTime()+24*d*60*60*1e3),f="; expires="+_.toUTCString()}p&&(m="; secure");var b=l+"="+encodeURIComponent(JSON.stringify(c))+f+"; SameSite=Lax; path=/"+y+m;return b.length>3686.4&&ym.warn("cookieStore warning: large cookie, len="+b.length),um.cookie=b,b}catch(w){return}},_remove:function(l,c){if(null!=um&&um.cookie)try{A_._set(l,"",-1,c)}catch(d){return}}},O_=null,M_={_is_supported:function(){if(!ii(O_))return O_;var l=!0;if(ei(sm))l=!1;else try{var c="__mplssupport__";M_._set(c,"xyz"),'"xyz"'!==M_._get(c)&&(l=!1),M_._remove(c)}catch(d){l=!1}return l||ym.error("localStorage unsupported; falling back to cookie store"),O_=l,l},_error:function(l){ym.error("localStorage error: "+l)},_get:function(l){try{return null==sm?void 0:sm.localStorage.getItem(l)}catch(c){M_._error(c)}return null},_parse:function(l){try{return JSON.parse(M_._get(l))||{}}catch(c){}return null},_set:function(l,c){try{null==sm||sm.localStorage.setItem(l,JSON.stringify(c))}catch(d){M_._error(d)}},_remove:function(l){try{null==sm||sm.localStorage.removeItem(l)}catch(c){M_._error(c)}}},N_=["distinct_id",Pm,Lm,Jm,Km],P_=r$2({},M_,{_parse:function(l){try{var c={};try{c=A_._parse(l)||{}}catch(h){}var d=gn(c,JSON.parse(M_._get(l)||"{}"));return M_._set(l,d),d}catch(h){}return null},_set:function(l,c,d,h,p,f){try{M_._set(l,c,void 0,void 0,f);var m={};N_.forEach((l=>{c[l]&&(m[l]=c[l])})),Object.keys(m).length&&A_._set(l,m,d,h,p,f)}catch(y){M_._error(y)}},_remove:function(l,c){try{null==sm||sm.localStorage.removeItem(l),A_._remove(l,c)}catch(d){M_._error(d)}}}),L_={},j_={_is_supported:function(){return!0},_error:function(l){ym.error("memoryStorage error: "+l)},_get:function(l){return L_[l]||null},_parse:function(l){return L_[l]||null},_set:function(l,c){L_[l]=c},_remove:function(l){delete L_[l]}},D_=null,F_={_is_supported:function(){if(!ii(D_))return D_;if(D_=!0,ei(sm))D_=!1;else try{var l="__support__";F_._set(l,"xyz"),'"xyz"'!==F_._get(l)&&(D_=!1),F_._remove(l)}catch(c){D_=!1}return D_},_error:function(l){ym.error("sessionStorage error: ",l)},_get:function(l){try{return null==sm?void 0:sm.sessionStorage.getItem(l)}catch(c){F_._error(c)}return null},_parse:function(l){try{return JSON.parse(F_._get(l))||null}catch(c){}return null},_set:function(l,c){try{null==sm||sm.sessionStorage.setItem(l,JSON.stringify(c))}catch(d){F_._error(d)}},_remove:function(l){try{null==sm||sm.sessionStorage.removeItem(l)}catch(c){F_._error(c)}}},$_=function(l){return l[l.PENDING=-1]="PENDING",l[l.DENIED=0]="DENIED",l[l.GRANTED=1]="GRANTED",l}({});class Nh{constructor(l){this._instance=l}get _config(){return this._instance.config}get consent(){return this._getDnt()?$_.DENIED:this._storedConsent}isOptedOut(){return"always"===this._config.cookieless_mode||this.consent===$_.DENIED||this.consent===$_.PENDING&&(this._config.opt_out_capturing_by_default||"on_reject"===this._config.cookieless_mode)}isOptedIn(){return!this.isOptedOut()}isExplicitlyOptedOut(){return this.consent===$_.DENIED}optInOut(l){this._storage._set(this._storageKey,l?1:0,this._config.cookie_expiration,this._config.cross_subdomain_cookie,this._config.secure_cookie)}reset(){this._storage._remove(this._storageKey,this._config.cross_subdomain_cookie)}get _storageKey(){var{token:l,opt_out_capturing_cookie_prefix:c,consent_persistence_name:d}=this._instance.config;return d||(c?c+l:"__ph_opt_in_out_"+l)}get _storedConsent(){var l=this._storage._get(this._storageKey);return pi(l)?$_.GRANTED:$r(Wf,l)?$_.DENIED:$_.PENDING}get _storage(){if(!this._persistentStore){var l=this._config.opt_out_capturing_persistence_type;this._persistentStore="localStorage"===l?M_:A_;var c="localStorage"===l?A_:M_;c._get(this._storageKey)&&(this._persistentStore._get(this._storageKey)||this.optInOut(pi(c._get(this._storageKey))),c._remove(this._storageKey,this._config.cross_subdomain_cookie))}return this._persistentStore}_getDnt(){return!!this._config.respect_dnt&&!!kn([null==cm?void 0:cm.doNotTrack,null==cm?void 0:cm.msDoNotTrack,gm.doNotTrack],(l=>pi(l)))}}var U_=_m("[Dead Clicks]"),Fh=()=>!0,Lh=l=>{var c,d=!(null==(c=l.instance.persistence)||!c.get_property(Om)),h=l.instance.config.capture_dead_clicks;return oi(h)?h:d};class Oh{get lazyLoadedDeadClicksAutocapture(){return this._lazyLoadedDeadClicksAutocapture}constructor(l,c,d){this.instance=l,this.isEnabled=c,this.onCapture=d,this.startIfEnabled()}onRemoteConfig(l){this.instance.persistence&&this.instance.persistence.register({[Om]:null==l?void 0:l.captureDeadClicks}),this.startIfEnabled()}startIfEnabled(){this.isEnabled(this)&&this._loadScript((()=>{this._start()}))}_loadScript(l){var c,d;null!=(c=gm.__PosthogExtensions__)&&c.initDeadClicksAutocapture&&l(),null==(d=gm.__PosthogExtensions__)||null==d.loadExternalDependency||d.loadExternalDependency(this.instance,"dead-clicks-autocapture",(c=>{c?U_.error("failed to load script",c):l()}))}_start(){var l;if(um){if(!this._lazyLoadedDeadClicksAutocapture&&null!=(l=gm.__PosthogExtensions__)&&l.initDeadClicksAutocapture){var c=Jr(this.instance.config.capture_dead_clicks)?this.instance.config.capture_dead_clicks:{};c.__onCapture=this.onCapture,this._lazyLoadedDeadClicksAutocapture=gm.__PosthogExtensions__.initDeadClicksAutocapture(this.instance,c),this._lazyLoadedDeadClicksAutocapture.start(um),U_.info("starting...")}}else U_.error("`document` not found. Cannot start.")}stop(){this._lazyLoadedDeadClicksAutocapture&&(this._lazyLoadedDeadClicksAutocapture.stop(),this._lazyLoadedDeadClicksAutocapture=void 0,U_.info("stopping..."))}}var B_=_m("[ExceptionAutocapture]");class Hh{constructor(l){var c,d,h;this._startCapturing=()=>{var l;if(sm&&this.isEnabled&&null!=(l=gm.__PosthogExtensions__)&&l.errorWrappingFunctions){var c=gm.__PosthogExtensions__.errorWrappingFunctions.wrapOnError,d=gm.__PosthogExtensions__.errorWrappingFunctions.wrapUnhandledRejection,h=gm.__PosthogExtensions__.errorWrappingFunctions.wrapConsoleError;try{!this._unwrapOnError&&this._config.capture_unhandled_errors&&(this._unwrapOnError=c(this.captureException.bind(this))),!this._unwrapUnhandledRejection&&this._config.capture_unhandled_rejections&&(this._unwrapUnhandledRejection=d(this.captureException.bind(this))),!this._unwrapConsoleError&&this._config.capture_console_errors&&(this._unwrapConsoleError=h(this.captureException.bind(this)))}catch(p){B_.error("failed to start",p),this._stopCapturing()}}},this._instance=l,this._remoteEnabled=!(null==(c=this._instance.persistence)||!c.props[Im]),this._config=this._requiredConfig(),this._rateLimiter=new gi({refillRate:null!==(d=this._instance.config.error_tracking.__exceptionRateLimiterRefillRate)&&void 0!==d?d:1,bucketSize:null!==(h=this._instance.config.error_tracking.__exceptionRateLimiterBucketSize)&&void 0!==h?h:10,refillInterval:1e4,_logger:B_}),this.startIfEnabled()}_requiredConfig(){var l=this._instance.config.capture_exceptions,c={capture_unhandled_errors:!1,capture_unhandled_rejections:!1,capture_console_errors:!1};return Jr(l)?c=r$2({},c,l):(ei(l)?this._remoteEnabled:l)&&(c=r$2({},c,{capture_unhandled_errors:!0,capture_unhandled_rejections:!0})),c}get isEnabled(){return this._config.capture_console_errors||this._config.capture_unhandled_errors||this._config.capture_unhandled_rejections}startIfEnabled(){this.isEnabled&&(B_.info("enabled"),this._loadScript(this._startCapturing))}_loadScript(l){var c,d;null!=(c=gm.__PosthogExtensions__)&&c.errorWrappingFunctions&&l(),null==(d=gm.__PosthogExtensions__)||null==d.loadExternalDependency||d.loadExternalDependency(this._instance,"exception-autocapture",(c=>{if(c)return B_.error("failed to load script",c);l()}))}_stopCapturing(){var l,c,d;null==(l=this._unwrapOnError)||l.call(this),this._unwrapOnError=void 0,null==(c=this._unwrapUnhandledRejection)||c.call(this),this._unwrapUnhandledRejection=void 0,null==(d=this._unwrapConsoleError)||d.call(this),this._unwrapConsoleError=void 0}onRemoteConfig(l){var c=l.autocaptureExceptions;this._remoteEnabled=!!c||!1,this._config=this._requiredConfig(),this._instance.persistence&&this._instance.persistence.register({[Im]:this._remoteEnabled}),this.startIfEnabled()}captureException(l){var c,d,h=null!==(c=null==l||null==(d=l.$exception_list)||null==(d=d[0])?void 0:d.type)&&void 0!==c?c:"Exception";this._rateLimiter.consumeRateLimit(h)?B_.info("Skipping exception capture because of client rate limiting.",{exception:h}):this._instance.exceptions.sendExceptionEvent(l)}}class qh{constructor(l){var c;this._instance=l,this._lastPathname=(null==sm||null==(c=sm.location)?void 0:c.pathname)||""}get isEnabled(){return"history_change"===this._instance.config.capture_pageview}startIfEnabled(){this.isEnabled&&(ym.info("History API monitoring enabled, starting..."),this.monitorHistoryChanges())}stop(){this._popstateListener&&this._popstateListener(),this._popstateListener=void 0,ym.info("History API monitoring stopped")}monitorHistoryChanges(){var l,c;if(sm&&sm.history){var d=this;null!=(l=sm.history.pushState)&&l.__posthog_wrapped__||Nn(sm.history,"pushState",(l=>function(c,h,p){l.call(this,c,h,p),d._capturePageview("pushState")})),null!=(c=sm.history.replaceState)&&c.__posthog_wrapped__||Nn(sm.history,"replaceState",(l=>function(c,h,p){l.call(this,c,h,p),d._capturePageview("replaceState")})),this._setupPopstateListener()}}_capturePageview(l){try{var c,d=null==sm||null==(c=sm.location)?void 0:c.pathname;if(!d)return;d!==this._lastPathname&&this.isEnabled&&this._instance.capture("$pageview",{navigation_type:l}),this._lastPathname=d}catch(h){ym.error("Error capturing "+l+" pageview",h)}}_setupPopstateListener(){if(!this._popstateListener){var e3=()=>{this._capturePageview("popstate")};En(sm,"popstate",e3),this._popstateListener=()=>{sm&&sm.removeEventListener("popstate",e3)}}}}var H_=_m("[SegmentIntegration]");var z_="posthog-js";function Wh(l,c){var{organization:d,projectId:h,prefix:p,severityAllowList:f=["error"],sendExceptionsToPostHog:m=!0}=void 0===c?{}:c;return c=>{var y,_,b,w,E;if("*"!==f&&!f.includes(c.level)||!l.__loaded)return c;c.tags||(c.tags={});var M=l.requestRouter.endpointFor("ui","/project/"+l.config.token+"/person/"+l.get_distinct_id());c.tags["PostHog Person URL"]=M,l.sessionRecordingStarted()&&(c.tags["PostHog Recording URL"]=l.get_session_replay_url({withTimestamp:!0}));var N=(null==(y=c.exception)?void 0:y.values)||[],P=N.map((l=>r$2({},l,{stacktrace:l.stacktrace?r$2({},l.stacktrace,{type:"raw",frames:(l.stacktrace.frames||[]).map((l=>r$2({},l,{platform:"web:javascript"})))}):void 0}))),L={$exception_message:(null==(_=N[0])?void 0:_.value)||c.message,$exception_type:null==(b=N[0])?void 0:b.type,$exception_level:c.level,$exception_list:P,$sentry_event_id:c.event_id,$sentry_exception:c.exception,$sentry_exception_message:(null==(w=N[0])?void 0:w.value)||c.message,$sentry_exception_type:null==(E=N[0])?void 0:E.type,$sentry_tags:c.tags};return d&&h&&(L.$sentry_url=(p||"https://sentry.io/organizations/")+d+"/issues/?project="+h+"&query="+c.event_id),m&&l.exceptions.sendExceptionEvent(L),c}}class Uh{constructor(l,c,d,h,p,f){this.name=z_,this.setupOnce=function(m){m(Wh(l,{organization:c,projectId:d,prefix:h,severityAllowList:p,sendExceptionsToPostHog:null==f||f}))}}}var q_=null!=sm&&sm.location?An(sm.location.hash,"__posthog")||An(location.hash,"state"):null,W_="_postHogToolbarParams",V_=_m("[Toolbar]"),Z_=function(l){return l[l.UNINITIALIZED=0]="UNINITIALIZED",l[l.LOADING=1]="LOADING",l[l.LOADED=2]="LOADED",l}(Z_||{});class Yh{constructor(l){this.instance=l}_setToolbarState(l){gm.ph_toolbar_state=l}_getToolbarState(){var l;return null!==(l=gm.ph_toolbar_state)&&void 0!==l?l:Z_.UNINITIALIZED}maybeLoadToolbar(l,c,d){if(void 0===l&&(l=void 0),void 0===c&&(c=void 0),void 0===d&&(d=void 0),!sm||!um)return!1;l=null!=l?l:sm.location,d=null!=d?d:sm.history;try{if(!c){try{sm.localStorage.setItem("test","test"),sm.localStorage.removeItem("test")}catch(m){return!1}c=null==sm?void 0:sm.localStorage}var h,p=q_||An(l.hash,"__posthog")||An(l.hash,"state"),f=p?yn((()=>JSON.parse(atob(decodeURIComponent(p)))))||yn((()=>JSON.parse(decodeURIComponent(p)))):null;return f&&"ph_authorize"===f.action?((h=f).source="url",h&&Object.keys(h).length>0&&(f.desiredHash?l.hash=f.desiredHash:d?d.replaceState(d.state,"",l.pathname+l.search):l.hash="")):((h=JSON.parse(c.getItem(W_)||"{}")).source="localstorage",delete h.userIntent),!(!h.token||this.instance.config.token!==h.token||(this.loadToolbar(h),0))}catch(m){return!1}}_callLoadToolbar(l){var c=gm.ph_load_toolbar||gm.ph_load_editor;!ni(c)&&Xr(c)?c(l,this.instance):V_.warn("No toolbar load function found")}loadToolbar(l){var c=!(null==um||!um.getElementById(Ym));if(!sm||c)return!1;var d="custom"===this.instance.requestRouter.region&&this.instance.config.advanced_disable_toolbar_metrics,h=r$2({token:this.instance.config.token},l,{apiURL:this.instance.requestRouter.endpointFor("ui")},d?{instrument:!1}:{});if(sm.localStorage.setItem(W_,JSON.stringify(r$2({},h,{source:void 0}))),this._getToolbarState()===Z_.LOADED)this._callLoadToolbar(h);else if(this._getToolbarState()===Z_.UNINITIALIZED){var p;this._setToolbarState(Z_.LOADING),null==(p=gm.__PosthogExtensions__)||null==p.loadExternalDependency||p.loadExternalDependency(this.instance,"toolbar",(l=>{if(l)return V_.error("[Toolbar] Failed to load",l),void this._setToolbarState(Z_.UNINITIALIZED);this._setToolbarState(Z_.LOADED),this._callLoadToolbar(h)})),En(sm,"turbolinks:load",(()=>{this._setToolbarState(Z_.UNINITIALIZED),this.loadToolbar(h)}))}return!0}_loadEditor(l){return this.loadToolbar(l)}maybeLoadEditor(l,c,d){return void 0===l&&(l=void 0),void 0===c&&(c=void 0),void 0===d&&(d=void 0),this.maybeLoadToolbar(l,c,d)}}var G_=_m("[TracingHeaders]");class Kh{constructor(l){this._restoreXHRPatch=void 0,this._restoreFetchPatch=void 0,this._startCapturing=()=>{var l,c;ei(this._restoreXHRPatch)&&(null==(l=gm.__PosthogExtensions__)||null==(l=l.tracingHeadersPatchFns)||l._patchXHR(this._instance.config.__add_tracing_headers||[],this._instance.get_distinct_id(),this._instance.sessionManager)),ei(this._restoreFetchPatch)&&(null==(c=gm.__PosthogExtensions__)||null==(c=c.tracingHeadersPatchFns)||c._patchFetch(this._instance.config.__add_tracing_headers||[],this._instance.get_distinct_id(),this._instance.sessionManager))},this._instance=l}_loadScript(l){var c,d;null!=(c=gm.__PosthogExtensions__)&&c.tracingHeadersPatchFns&&l(),null==(d=gm.__PosthogExtensions__)||null==d.loadExternalDependency||d.loadExternalDependency(this._instance,"tracing-headers",(c=>{if(c)return G_.error("failed to load script",c);l()}))}startIfEnabledOrStop(){var l,c;this._instance.config.__add_tracing_headers?this._loadScript(this._startCapturing):(null==(l=this._restoreXHRPatch)||l.call(this),null==(c=this._restoreFetchPatch)||c.call(this),this._restoreXHRPatch=void 0,this._restoreFetchPatch=void 0)}}var K_="https?://(.*)",J_=["gclid","gclsrc","dclid","gbraid","wbraid","fbclid","msclkid","twclid","li_fat_id","igshid","ttclid","rdt_cid","epik","qclid","sccid","irclid","_kx"],Y_=_n(["utm_source","utm_medium","utm_campaign","utm_content","utm_term","gad_source","mc_cid"],J_),Q_="<masked>",X_=["li_fat_id"];function ip(l,c,d){if(!um)return{};var h,p=c?_n([],J_,d||[]):[],f=np(Rn(um.URL,p,Q_),l),m=(h={},fn(X_,(function(l){var c=A_._get(l);h[l]=c||null})),h);return gn(m,f)}function np(l,c){var d=Y_.concat(c||[]),h={};return fn(d,(function(c){var d=Mn(l,c);h[c]=d||null})),h}function sp(l){var c,d=(c=l)?0===c.search(K_+"google.([^/?]*)")?"google":0===c.search(K_+"bing.com")?"bing":0===c.search(K_+"yahoo.com")?"yahoo":0===c.search(K_+"duckduckgo.com")?"duckduckgo":null:null,h="yahoo"!=d?"q":"p",p={};if(!ii(d)){p.$search_engine=d;var f=um?Mn(um.referrer,h):"";f.length&&(p.ph_keyword=f)}return p}function op(){return navigator.language||navigator.userLanguage}function ap(){return(null==um?void 0:um.referrer)||"$direct"}function lp(l,c){var d=l?_n([],J_,c||[]):[],h=null==dm?void 0:dm.href.substring(0,1e3);return{r:ap().substring(0,1e3),u:h?Rn(h,d,Q_):void 0}}function up(l){var c,{r:d,u:h}=l,p={$referrer:d,$referring_domain:null==d?void 0:"$direct"==d?"$direct":null==(c=xn(d))?void 0:c.host};if(h){p.$current_url=h;var f=xn(h);p.$host=null==f?void 0:f.host,p.$pathname=null==f?void 0:f.pathname;var m=np(h);gn(p,m)}if(d){var y=sp(d);gn(p,y)}return p}function cp(){try{return Intl.DateTimeFormat().resolvedOptions().timeZone}catch(hh){return}}function dp(){try{return(new Date).getTimezoneOffset()}catch(hh){return}}var eb=_m("[Web Vitals]"),tb=9e5;class fp{constructor(l){var c;this._enabledServerSide=!1,this._initialized=!1,this._buffer={url:void 0,metrics:[],firstMetricTimestamp:void 0},this._flushToCapture=()=>{clearTimeout(this._delayedFlushTimer),0!==this._buffer.metrics.length&&(this._instance.capture("$web_vitals",this._buffer.metrics.reduce(((l,c)=>r$2({},l,{["$web_vitals_"+c.name+"_event"]:r$2({},c),["$web_vitals_"+c.name+"_value"]:c.value})),{})),this._buffer={url:void 0,metrics:[],firstMetricTimestamp:void 0})},this._addToBuffer=l=>{var c,d=null==(c=this._instance.sessionManager)?void 0:c.checkAndGetSessionAndWindowId(!0);if(ei(d))eb.error("Could not read session ID. Dropping metrics!");else{this._buffer=this._buffer||{url:void 0,metrics:[],firstMetricTimestamp:void 0};var h=this._currentURL();ei(h)||(ni(null==l?void 0:l.name)||ni(null==l?void 0:l.value)?eb.error("Invalid metric received",l):this._maxAllowedValue&&l.value>=this._maxAllowedValue?eb.error("Ignoring metric with value >= "+this._maxAllowedValue,l):(this._buffer.url!==h&&(this._flushToCapture(),this._delayedFlushTimer=setTimeout(this._flushToCapture,this.flushToCaptureTimeoutMs)),ei(this._buffer.url)&&(this._buffer.url=h),this._buffer.firstMetricTimestamp=ei(this._buffer.firstMetricTimestamp)?Date.now():this._buffer.firstMetricTimestamp,l.attribution&&l.attribution.interactionTargetElement&&(l.attribution.interactionTargetElement=void 0),this._buffer.metrics.push(r$2({},l,{$current_url:h,$session_id:d.sessionId,$window_id:d.windowId,timestamp:Date.now()})),this._buffer.metrics.length===this.allowedMetrics.length&&this._flushToCapture()))}},this._startCapturing=()=>{var l,c,d,h,p=gm.__PosthogExtensions__;ei(p)||ei(p.postHogWebVitalsCallbacks)||({onLCP:l,onCLS:c,onFCP:d,onINP:h}=p.postHogWebVitalsCallbacks),l&&c&&d&&h?(this.allowedMetrics.indexOf("LCP")>-1&&l(this._addToBuffer.bind(this)),this.allowedMetrics.indexOf("CLS")>-1&&c(this._addToBuffer.bind(this)),this.allowedMetrics.indexOf("FCP")>-1&&d(this._addToBuffer.bind(this)),this.allowedMetrics.indexOf("INP")>-1&&h(this._addToBuffer.bind(this)),this._initialized=!0):eb.error("web vitals callbacks not loaded - not starting")},this._instance=l,this._enabledServerSide=!(null==(c=this._instance.persistence)||!c.props[Am]),this.startIfEnabled()}get allowedMetrics(){var l,c,d=Jr(this._instance.config.capture_performance)?null==(l=this._instance.config.capture_performance)?void 0:l.web_vitals_allowed_metrics:void 0;return ei(d)?(null==(c=this._instance.persistence)?void 0:c.props[Mm])||["CLS","FCP","INP","LCP"]:d}get flushToCaptureTimeoutMs(){return(Jr(this._instance.config.capture_performance)?this._instance.config.capture_performance.web_vitals_delayed_flush_ms:void 0)||5e3}get _maxAllowedValue(){var l=Jr(this._instance.config.capture_performance)&&si(this._instance.config.capture_performance.__web_vitals_max_value)?this._instance.config.capture_performance.__web_vitals_max_value:tb;return 0<l&&l<=6e4?tb:l}get isEnabled(){var l=null==dm?void 0:dm.protocol;if("http:"!==l&&"https:"!==l)return eb.info("Web Vitals are disabled on non-http/https protocols"),!1;var c=Jr(this._instance.config.capture_performance)?this._instance.config.capture_performance.web_vitals:oi(this._instance.config.capture_performance)?this._instance.config.capture_performance:void 0;return oi(c)?c:this._enabledServerSide}startIfEnabled(){this.isEnabled&&!this._initialized&&(eb.info("enabled, starting..."),this._loadScript(this._startCapturing))}onRemoteConfig(l){var c=Jr(l.capturePerformance)&&!!l.capturePerformance.web_vitals,d=Jr(l.capturePerformance)?l.capturePerformance.web_vitals_allowed_metrics:void 0;this._instance.persistence&&(this._instance.persistence.register({[Am]:c}),this._instance.persistence.register({[Mm]:d})),this._enabledServerSide=c,this.startIfEnabled()}_loadScript(l){var c,d;null!=(c=gm.__PosthogExtensions__)&&c.postHogWebVitalsCallbacks&&l(),null==(d=gm.__PosthogExtensions__)||null==d.loadExternalDependency||d.loadExternalDependency(this._instance,"web-vitals",(c=>{c?eb.error("failed to load script",c):l()}))}_currentURL(){var l=sm?sm.location.href:void 0;if(l){var c=this._instance.config.mask_personal_data_properties,d=this._instance.config.custom_personal_data_properties,h=c?_n([],J_,d||[]):[];return Rn(l,h,Q_)}eb.error("Could not determine current URL")}}var rb=_m("[Heatmaps]");function _p(l){return Jr(l)&&"clientX"in l&&"clientY"in l&&si(l.clientX)&&si(l.clientY)}class mp{constructor(l){var c;this._enabledServerSide=!1,this._initialized=!1,this._flushInterval=null,this.instance=l,this._enabledServerSide=!(null==(c=this.instance.persistence)||!c.props[Em]),this.rageclicks=new lh(l.config.rageclick)}get flushIntervalMilliseconds(){var l=5e3;return Jr(this.instance.config.capture_heatmaps)&&this.instance.config.capture_heatmaps.flush_interval_milliseconds&&(l=this.instance.config.capture_heatmaps.flush_interval_milliseconds),l}get isEnabled(){return ei(this.instance.config.capture_heatmaps)?ei(this.instance.config.enable_heatmaps)?this._enabledServerSide:this.instance.config.enable_heatmaps:!1!==this.instance.config.capture_heatmaps}startIfEnabled(){if(this.isEnabled){if(this._initialized)return;rb.info("starting..."),this._setupListeners(),this._onVisibilityChange()}else{var l;clearInterval(null!==(l=this._flushInterval)&&void 0!==l?l:void 0),this._removeListeners(),this.getAndClearBuffer()}}onRemoteConfig(l){var c=!!l.heatmaps;this.instance.persistence&&this.instance.persistence.register({[Em]:c}),this._enabledServerSide=c,this.startIfEnabled()}getAndClearBuffer(){var l=this._buffer;return this._buffer=void 0,l}_onDeadClick(l){this._onClick(l.originalEvent,"deadclick")}_onVisibilityChange(){this._flushInterval&&clearInterval(this._flushInterval),this._flushInterval="visible"===(null==um?void 0:um.visibilityState)?setInterval(this._flush.bind(this),this.flushIntervalMilliseconds):null}_setupListeners(){sm&&um&&(this._flushHandler=this._flush.bind(this),En(sm,"beforeunload",this._flushHandler),this._onClickHandler=l=>this._onClick(l||(null==sm?void 0:sm.event)),En(um,"click",this._onClickHandler,{capture:!0}),this._onMouseMoveHandler=l=>this._onMouseMove(l||(null==sm?void 0:sm.event)),En(um,"mousemove",this._onMouseMoveHandler,{capture:!0}),this._deadClicksCapture=new Oh(this.instance,Fh,this._onDeadClick.bind(this)),this._deadClicksCapture.startIfEnabled(),this._onVisibilityChange_handler=this._onVisibilityChange.bind(this),En(um,"visibilitychange",this._onVisibilityChange_handler),this._initialized=!0)}_removeListeners(){var l;sm&&um&&(this._flushHandler&&sm.removeEventListener("beforeunload",this._flushHandler),this._onClickHandler&&um.removeEventListener("click",this._onClickHandler,{capture:!0}),this._onMouseMoveHandler&&um.removeEventListener("mousemove",this._onMouseMoveHandler,{capture:!0}),this._onVisibilityChange_handler&&um.removeEventListener("visibilitychange",this._onVisibilityChange_handler),clearTimeout(this._mouseMoveTimeout),null==(l=this._deadClicksCapture)||l.stop(),this._initialized=!1)}_getProperties(l,c){var d=this.instance.scrollManager.scrollY(),h=this.instance.scrollManager.scrollX(),p=this.instance.scrollManager.scrollElement(),f=function(l,c,d){for(var h=l;h&&ps(h)&&!vs(h,"body");){if(h===d)return!1;if($r(c,null==sm?void 0:sm.getComputedStyle(h).position))return!0;h=ks(h)}return!1}(ws(l),["fixed","sticky"],p);return{x:l.clientX+(f?0:h),y:l.clientY+(f?0:d),target_fixed:f,type:c}}_onClick(l,c){var d;if(void 0===c&&(c="click"),!hs(l.target)&&_p(l)){var h=this._getProperties(l,c);null!=(d=this.rageclicks)&&d.isRageClick(l.clientX,l.clientY,(new Date).getTime())&&this._capture(r$2({},h,{type:"rageclick"})),this._capture(h)}}_onMouseMove(l){!hs(l.target)&&_p(l)&&(clearTimeout(this._mouseMoveTimeout),this._mouseMoveTimeout=setTimeout((()=>{this._capture(this._getProperties(l,"mousemove"))}),500))}_capture(l){if(sm){var c=sm.location.href,d=this.instance.config.mask_personal_data_properties,h=this.instance.config.custom_personal_data_properties,p=d?_n([],J_,h||[]):[],f=Rn(c,p,Q_);this._buffer=this._buffer||{},this._buffer[f]||(this._buffer[f]=[]),this._buffer[f].push(l)}}_flush(){this._buffer&&!Qr(this._buffer)&&this.instance.capture("$$heatmap",{$heatmap_data:this.getAndClearBuffer()})}}class yp{constructor(l){this._instance=l}doPageView(l,c){var d,h=this._previousPageViewProperties(l,c);return this._currentPageview={pathname:null!==(d=null==sm?void 0:sm.location.pathname)&&void 0!==d?d:"",pageViewId:c,timestamp:l},this._instance.scrollManager.resetContext(),h}doPageLeave(l){var c;return this._previousPageViewProperties(l,null==(c=this._currentPageview)?void 0:c.pageViewId)}doEvent(){var l;return{$pageview_id:null==(l=this._currentPageview)?void 0:l.pageViewId}}_previousPageViewProperties(l,c){var d=this._currentPageview;if(!d)return{$pageview_id:c};var h={$pageview_id:c,$prev_pageview_id:d.pageViewId},p=this._instance.scrollManager.getContext();if(p&&!this._instance.config.disable_scroll_properties){var{maxScrollHeight:f,lastScrollY:m,maxScrollY:y,maxContentHeight:_,lastContentY:b,maxContentY:w}=p;if(!(ei(f)||ei(m)||ei(y)||ei(_)||ei(b)||ei(w))){f=Math.ceil(f),m=Math.ceil(m),y=Math.ceil(y),_=Math.ceil(_),b=Math.ceil(b),w=Math.ceil(w);var E=f<=1?1:fi(m/f,0,1,ym),M=f<=1?1:fi(y/f,0,1,ym),N=_<=1?1:fi(b/_,0,1,ym),P=_<=1?1:fi(w/_,0,1,ym);h=gn(h,{$prev_pageview_last_scroll:m,$prev_pageview_last_scroll_percentage:E,$prev_pageview_max_scroll:y,$prev_pageview_max_scroll_percentage:M,$prev_pageview_last_content:b,$prev_pageview_last_content_percentage:N,$prev_pageview_max_content:w,$prev_pageview_max_content_percentage:P})}}return d.pathname&&(h.$prev_pageview_pathname=d.pathname),d.timestamp&&(h.$prev_pageview_duration=(l.getTime()-d.timestamp.getTime())/1e3),h}}var nb=_m("[FeatureFlags]"),sb="$active_feature_flags",ib="$override_feature_flags",ob="$feature_flag_payloads",ab="$override_feature_flag_payloads",lb="$feature_flag_request_id",Ep=l=>{var c={};for(var[d,h]of mn(l||{}))h&&(c[d]=h);return c},cb=function(l){return l.FeatureFlags="feature_flags",l.Recordings="recordings",l}({});class Mp{constructor(l){this._override_warning=!1,this._hasLoadedFlags=!1,this._requestInFlight=!1,this._reloadingDisabled=!1,this._additionalReloadRequested=!1,this._flagsCalled=!1,this._flagsLoadedFromRemote=!1,this._instance=l,this.featureFlagEventHandlers=[]}_getValidEvaluationEnvironments(){var l=this._instance.config.evaluation_environments;return null!=l&&l.length?l.filter((l=>{var c=l&&"string"==typeof l&&l.trim().length>0;return c||nb.error("Invalid evaluation environment found:",l,"Expected non-empty string"),c})):[]}_shouldIncludeEvaluationEnvironments(){return this._getValidEvaluationEnvironments().length>0}flags(){if(this._instance.config.__preview_remote_config)this._flagsCalled=!0;else{var l=!this._reloadDebouncer&&(this._instance.config.advanced_disable_feature_flags||this._instance.config.advanced_disable_feature_flags_on_first_load);this._callFlagsEndpoint({disableFlags:l})}}get hasLoadedFlags(){return this._hasLoadedFlags}getFlags(){return Object.keys(this.getFlagVariants())}getFlagsWithDetails(){var l=this._instance.get_property(Fm),c=this._instance.get_property(ib),d=this._instance.get_property(ab);if(!d&&!c)return l||{};var h=gn({},l||{}),p=[...new Set([...Object.keys(d||{}),...Object.keys(c||{})])];for(var f of p){var m,y,_=h[f],b=null==c?void 0:c[f],w=ei(b)?null!==(m=null==_?void 0:_.enabled)&&void 0!==m&&m:!!b,E=ei(b)?_.variant:"string"==typeof b?b:void 0,M=null==d?void 0:d[f],N=r$2({},_,{enabled:w,variant:w?null!=E?E:null==_?void 0:_.variant:void 0});w!==(null==_?void 0:_.enabled)&&(N.original_enabled=null==_?void 0:_.enabled),E!==(null==_?void 0:_.variant)&&(N.original_variant=null==_?void 0:_.variant),M&&(N.metadata=r$2({},null==_?void 0:_.metadata,{payload:M,original_payload:null==_||null==(y=_.metadata)?void 0:y.payload})),h[f]=N}return this._override_warning||(nb.warn(" Overriding feature flag details!",{flagDetails:l,overriddenPayloads:d,finalDetails:h}),this._override_warning=!0),h}getFlagVariants(){var l=this._instance.get_property(jm),c=this._instance.get_property(ib);if(!c)return l||{};for(var d=gn({},l),h=Object.keys(c),p=0;p<h.length;p++)d[h[p]]=c[h[p]];return this._override_warning||(nb.warn(" Overriding feature flags!",{enabledFlags:l,overriddenFlags:c,finalFlags:d}),this._override_warning=!0),d}getFlagPayloads(){var l=this._instance.get_property(ob),c=this._instance.get_property(ab);if(!c)return l||{};for(var d=gn({},l||{}),h=Object.keys(c),p=0;p<h.length;p++)d[h[p]]=c[h[p]];return this._override_warning||(nb.warn(" Overriding feature flag payloads!",{flagPayloads:l,overriddenPayloads:c,finalPayloads:d}),this._override_warning=!0),d}reloadFeatureFlags(){this._reloadingDisabled||this._instance.config.advanced_disable_feature_flags||this._reloadDebouncer||(this._reloadDebouncer=setTimeout((()=>{this._callFlagsEndpoint()}),5))}_clearDebouncer(){clearTimeout(this._reloadDebouncer),this._reloadDebouncer=void 0}ensureFlagsLoaded(){this._hasLoadedFlags||this._requestInFlight||this._reloadDebouncer||this.reloadFeatureFlags()}setAnonymousDistinctId(l){this.$anon_distinct_id=l}setReloadingPaused(l){this._reloadingDisabled=l}_callFlagsEndpoint(l){var c;if(this._clearDebouncer(),!this._instance._shouldDisableFlags())if(this._requestInFlight)this._additionalReloadRequested=!0;else{var d={token:this._instance.config.token,distinct_id:this._instance.get_distinct_id(),groups:this._instance.getGroups(),$anon_distinct_id:this.$anon_distinct_id,person_properties:r$2({},(null==(c=this._instance.persistence)?void 0:c.get_initial_props())||{},this._instance.get_property($m)||{}),group_properties:this._instance.get_property(Um)};(null!=l&&l.disableFlags||this._instance.config.advanced_disable_feature_flags)&&(d.disable_flags=!0),this._shouldIncludeEvaluationEnvironments()&&(d.evaluation_environments=this._getValidEvaluationEnvironments());var h=this._instance.config.__preview_remote_config,p=h?"/flags/?v=2":"/flags/?v=2&config=true",f=this._instance.config.advanced_only_evaluate_survey_feature_flags?"&only_evaluate_survey_feature_flags=true":"",m=this._instance.requestRouter.endpointFor("flags",p+f);h&&(d.timezone=cp()),this._requestInFlight=!0,this._instance._send_request({method:"POST",url:m,data:d,compression:this._instance.config.disable_compression?void 0:ty.Base64,timeout:this._instance.config.feature_flag_request_timeout_ms,callback:l=>{var c,h,p=!0;if(200===l.statusCode&&(this._additionalReloadRequested||(this.$anon_distinct_id=void 0),p=!1),this._requestInFlight=!1,this._flagsCalled||(this._flagsCalled=!0,this._instance._onRemoteConfig(null!==(h=l.json)&&void 0!==h?h:{})),!d.disable_flags||this._additionalReloadRequested)if(this._flagsLoadedFromRemote=!p,l.json&&null!=(c=l.json.quotaLimited)&&c.includes(cb.FeatureFlags))nb.warn("You have hit your feature flags quota limit, and will not be able to load feature flags until the quota is reset.  Please visit https://posthog.com/docs/billing/limits-alerts to learn more.");else{var f;d.disable_flags||this.receivedFeatureFlags(null!==(f=l.json)&&void 0!==f?f:{},p),this._additionalReloadRequested&&(this._additionalReloadRequested=!1,this._callFlagsEndpoint())}}})}}getFeatureFlag(l,c){if(void 0===c&&(c={}),this._hasLoadedFlags||this.getFlags()&&this.getFlags().length>0){var d=this.getFlagVariants()[l],h=""+d,p=this._instance.get_property(lb)||void 0,f=this._instance.get_property(zm)||{};if((c.send_event||!("send_event"in c))&&(!(l in f)||!f[l].includes(h))){var m,y,_,b,w,E,M,N,P;zf(f[l])?f[l].push(h):f[l]=[h],null==(m=this._instance.persistence)||m.register({[zm]:f});var L=this.getFeatureFlagDetails(l),j={$feature_flag:l,$feature_flag_response:d,$feature_flag_payload:this.getFeatureFlagPayload(l)||null,$feature_flag_request_id:p,$feature_flag_bootstrapped_response:(null==(y=this._instance.config.bootstrap)||null==(y=y.featureFlags)?void 0:y[l])||null,$feature_flag_bootstrapped_payload:(null==(_=this._instance.config.bootstrap)||null==(_=_.featureFlagPayloads)?void 0:_[l])||null,$used_bootstrap_value:!this._flagsLoadedFromRemote};ei(null==L||null==(b=L.metadata)?void 0:b.version)||(j.$feature_flag_version=L.metadata.version);var D,F=null!==(w=null==L||null==(E=L.reason)?void 0:E.description)&&void 0!==w?w:null==L||null==(M=L.reason)?void 0:M.code;F&&(j.$feature_flag_reason=F),null!=L&&null!=(N=L.metadata)&&N.id&&(j.$feature_flag_id=L.metadata.id),ei(null==L?void 0:L.original_variant)&&ei(null==L?void 0:L.original_enabled)||(j.$feature_flag_original_response=ei(L.original_variant)?L.original_enabled:L.original_variant),null!=L&&null!=(P=L.metadata)&&P.original_payload&&(j.$feature_flag_original_payload=null==L||null==(D=L.metadata)?void 0:D.original_payload),this._instance.capture("$feature_flag_called",j)}return d}nb.warn('getFeatureFlag for key "'+l+"\" failed. Feature flags didn't load in time.")}getFeatureFlagDetails(l){return this.getFlagsWithDetails()[l]}getFeatureFlagPayload(l){return this.getFlagPayloads()[l]}getRemoteConfigPayload(l,c){var d=this._instance.config.token,h={distinct_id:this._instance.get_distinct_id(),token:d};this._shouldIncludeEvaluationEnvironments()&&(h.evaluation_environments=this._getValidEvaluationEnvironments()),this._instance._send_request({method:"POST",url:this._instance.requestRouter.endpointFor("flags","/flags/?v=2&config=true"),data:h,compression:this._instance.config.disable_compression?void 0:ty.Base64,timeout:this._instance.config.feature_flag_request_timeout_ms,callback:d=>{var h,p=null==(h=d.json)?void 0:h.featureFlagPayloads;c((null==p?void 0:p[l])||void 0)}})}isFeatureEnabled(l,c){if(void 0===c&&(c={}),this._hasLoadedFlags||this.getFlags()&&this.getFlags().length>0){var d=this.getFeatureFlag(l,c);return ei(d)?void 0:!!d}nb.warn('isFeatureEnabled for key "'+l+"\" failed. Feature flags didn't load in time.")}addFeatureFlagsHandler(l){this.featureFlagEventHandlers.push(l)}removeFeatureFlagsHandler(l){this.featureFlagEventHandlers=this.featureFlagEventHandlers.filter((c=>c!==l))}receivedFeatureFlags(l,c){if(this._instance.persistence){this._hasLoadedFlags=!0;var d=this.getFlagVariants(),h=this.getFlagPayloads(),p=this.getFlagsWithDetails();!function(l,c,d,h,p){void 0===d&&(d={}),void 0===h&&(h={}),void 0===p&&(p={});var f=(l=>{var c=l.flags;return c?(l.featureFlags=Object.fromEntries(Object.keys(c).map((l=>{var d;return[l,null!==(d=c[l].variant)&&void 0!==d?d:c[l].enabled]}))),l.featureFlagPayloads=Object.fromEntries(Object.keys(c).filter((l=>c[l].enabled)).filter((l=>{var d;return null==(d=c[l].metadata)?void 0:d.payload})).map((l=>{var d;return[l,null==(d=c[l].metadata)?void 0:d.payload]})))):nb.warn("Using an older version of the feature flags endpoint. Please upgrade your PostHog server to the latest version"),l})(l),m=f.flags,y=f.featureFlags,_=f.featureFlagPayloads;if(y){var b=l.requestId;if(zf(y)){nb.warn("v1 of the feature flags endpoint is deprecated. Please use the latest version.");var w={};if(y)for(var E=0;E<y.length;E++)w[y[E]]=!0;c&&c.register({[sb]:y,[jm]:w})}else{var M=y,N=_,P=m;l.errorsWhileComputingFlags&&(M=r$2({},d,M),N=r$2({},h,N),P=r$2({},p,P)),c&&c.register(r$2({[sb]:Object.keys(Ep(M)),[jm]:M||{},[ob]:N||{},[Fm]:P||{}},b?{[lb]:b}:{}))}}}(l,this._instance.persistence,d,h,p),this._fireFeatureFlagsCallbacks(c)}}override(l,c){void 0===c&&(c=!1),nb.warn("override is deprecated. Please use overrideFeatureFlags instead."),this.overrideFeatureFlags({flags:l,suppressWarning:c})}overrideFeatureFlags(l){if(!this._instance.__loaded||!this._instance.persistence)return nb.uninitializedWarning("posthog.featureFlags.overrideFeatureFlags");if(!1===l)return this._instance.persistence.unregister(ib),this._instance.persistence.unregister(ab),void this._fireFeatureFlagsCallbacks();if(l&&"object"==typeof l&&("flags"in l||"payloads"in l)){var c,d=l;if(this._override_warning=Boolean(null!==(c=d.suppressWarning)&&void 0!==c&&c),"flags"in d)if(!1===d.flags)this._instance.persistence.unregister(ib);else if(d.flags)if(zf(d.flags)){for(var h={},p=0;p<d.flags.length;p++)h[d.flags[p]]=!0;this._instance.persistence.register({[ib]:h})}else this._instance.persistence.register({[ib]:d.flags});return"payloads"in d&&(!1===d.payloads?this._instance.persistence.unregister(ab):d.payloads&&this._instance.persistence.register({[ab]:d.payloads})),void this._fireFeatureFlagsCallbacks()}this._fireFeatureFlagsCallbacks()}onFeatureFlags(l){if(this.addFeatureFlagsHandler(l),this._hasLoadedFlags){var{flags:c,flagVariants:d}=this._prepareFeatureFlagsForCallbacks();l(c,d)}return()=>this.removeFeatureFlagsHandler(l)}updateEarlyAccessFeatureEnrollment(l,c,d){var h,p=(this._instance.get_property(Dm)||[]).find((c=>c.flagKey===l)),f={["$feature_enrollment/"+l]:c},m={$feature_flag:l,$feature_enrollment:c,$set:f};p&&(m.$early_access_feature_name=p.name),d&&(m.$feature_enrollment_stage=d),this._instance.capture("$feature_enrollment_update",m),this.setPersonPropertiesForFlags(f,!1);var y=r$2({},this.getFlagVariants(),{[l]:c});null==(h=this._instance.persistence)||h.register({[sb]:Object.keys(Ep(y)),[jm]:y}),this._fireFeatureFlagsCallbacks()}getEarlyAccessFeatures(l,c,d){void 0===c&&(c=!1);var h=this._instance.get_property(Dm),p=d?"&"+d.map((l=>"stage="+l)).join("&"):"";if(h&&!c)return l(h);this._instance._send_request({url:this._instance.requestRouter.endpointFor("api","/api/early_access_features/?token="+this._instance.config.token+p),method:"GET",callback:c=>{var d,h;if(c.json){var p=c.json.earlyAccessFeatures;return null==(d=this._instance.persistence)||d.unregister(Dm),null==(h=this._instance.persistence)||h.register({[Dm]:p}),l(p)}}})}_prepareFeatureFlagsForCallbacks(){var l=this.getFlags(),c=this.getFlagVariants();return{flags:l.filter((l=>c[l])),flagVariants:Object.keys(c).filter((l=>c[l])).reduce(((l,d)=>(l[d]=c[d],l)),{})}}_fireFeatureFlagsCallbacks(l){var{flags:c,flagVariants:d}=this._prepareFeatureFlagsForCallbacks();this.featureFlagEventHandlers.forEach((h=>h(c,d,{errorsLoading:l})))}setPersonPropertiesForFlags(l,c){void 0===c&&(c=!0);var d=this._instance.get_property($m)||{};this._instance.register({[$m]:r$2({},d,l)}),c&&this._instance.reloadFeatureFlags()}resetPersonPropertiesForFlags(){this._instance.unregister($m)}setGroupPropertiesForFlags(l,c){void 0===c&&(c=!0);var d=this._instance.get_property(Um)||{};0!==Object.keys(d).length&&Object.keys(d).forEach((c=>{d[c]=r$2({},d[c],l[c]),delete l[c]})),this._instance.register({[Um]:r$2({},d,l)}),c&&this._instance.reloadFeatureFlags()}resetGroupPropertiesForFlags(l){if(l){var c=this._instance.get_property(Um)||{};this._instance.register({[Um]:r$2({},c,{[l]:{}})})}else this._instance.unregister(Um)}reset(){this._hasLoadedFlags=!1,this._requestInFlight=!1,this._reloadingDisabled=!1,this._additionalReloadRequested=!1,this._flagsCalled=!1,this._flagsLoadedFromRemote=!1,this.$anon_distinct_id=void 0,this._clearDebouncer(),this._override_warning=!1}}var ub=["cookie","localstorage","localstorage+cookie","sessionstorage","memory"];class Ap{constructor(l,c){var d,h;this._config=l,this.props={},this._campaign_params_saved=!1,this._name=(h="",(d=l).token&&(h=d.token.replace(/\+/g,"PL").replace(/\//g,"SL").replace(/=/g,"EQ")),d.persistence_name?"ph_"+d.persistence_name:"ph_"+h+"_posthog"),this._storage=this._buildStorage(l),this.load(),l.debug&&ym.info("Persistence loaded",l.persistence,r$2({},this.props)),this.update_config(l,l,c),this.save()}isDisabled(){return!!this._disabled}_buildStorage(l){-1===ub.indexOf(l.persistence.toLowerCase())&&(ym.critical("Unknown persistence type "+l.persistence+"; falling back to localStorage+cookie"),l.persistence="localStorage+cookie");var c=l.persistence.toLowerCase();return"localstorage"===c&&M_._is_supported()?M_:"localstorage+cookie"===c&&P_._is_supported()?P_:"sessionstorage"===c&&F_._is_supported()?F_:"memory"===c?j_:"cookie"===c?A_:P_._is_supported()?P_:A_}properties(){var l={};return fn(this.props,(function(c,d){if(d===jm&&Jr(c))for(var h=Object.keys(c),p=0;p<h.length;p++)l["$feature/"+h[p]]=c[h[p]];else m=d,y=!1,(ii(f=Xm)?y:lm&&f.indexOf===lm?-1!=f.indexOf(m):(fn(f,(function(l){if(y||(y=l===m))return bm})),y))||(l[d]=c);var f,m,y})),l}load(){if(!this._disabled){var l=this._storage._parse(this._name);l&&(this.props=gn({},l))}}save(){this._disabled||this._storage._set(this._name,this.props,this._expire_days,this._cross_subdomain,this._secure,this._config.debug)}remove(){this._storage._remove(this._name,!1),this._storage._remove(this._name,!0)}clear(){this.remove(),this.props={}}register_once(l,c,d){if(Jr(l)){ei(c)&&(c="None"),this._expire_days=ei(d)?this._default_expiry:d;var h=!1;if(fn(l,((l,d)=>{this.props.hasOwnProperty(d)&&this.props[d]!==c||(this.props[d]=l,h=!0)})),h)return this.save(),!0}return!1}register(l,c){if(Jr(l)){this._expire_days=ei(c)?this._default_expiry:c;var d=!1;if(fn(l,((c,h)=>{l.hasOwnProperty(h)&&this.props[h]!==c&&(this.props[h]=c,d=!0)})),d)return this.save(),!0}return!1}unregister(l){l in this.props&&(delete this.props[l],this.save())}update_campaign_params(){if(!this._campaign_params_saved){var l=ip(this._config.custom_campaign_params,this._config.mask_personal_data_properties,this._config.custom_personal_data_properties);Qr(Sn(l))||this.register(l),this._campaign_params_saved=!0}}update_search_keyword(){var l;this.register((l=null==um?void 0:um.referrer)?sp(l):{})}update_referrer_info(){var l;this.register_once({$referrer:ap(),$referring_domain:null!=um&&um.referrer&&(null==(l=xn(um.referrer))?void 0:l.host)||"$direct"},void 0)}set_initial_person_info(){this.props[Zm]||this.props[Gm]||this.register_once({[Km]:lp(this._config.mask_personal_data_properties,this._config.custom_personal_data_properties)},void 0)}get_initial_props(){var l={};fn([Gm,Zm],(c=>{var d=this.props[c];d&&fn(d,(function(c,d){l["$initial_"+Ur(d)]=c}))}));var c,d,h=this.props[Km];if(h){var p=(c=up(h),d={},fn(c,(function(l,c){d["$initial_"+Ur(c)]=l})),d);gn(l,p)}return l}safe_merge(l){return fn(this.props,(function(c,d){d in l||(l[d]=c)})),l}update_config(l,c,d){if(this._default_expiry=this._expire_days=l.cookie_expiration,this.set_disabled(l.disable_persistence||!!d),this.set_cross_subdomain(l.cross_subdomain_cookie),this.set_secure(l.secure_cookie),l.persistence!==c.persistence){var h=this._buildStorage(l),p=this.props;this.clear(),this._storage=h,this.props=p,this.save()}}set_disabled(l){this._disabled=l,this._disabled?this.remove():this.save()}set_cross_subdomain(l){l!==this._cross_subdomain&&(this._cross_subdomain=l,this.remove(),this.save())}set_secure(l){l!==this._secure&&(this._secure=l,this.remove(),this.save())}set_event_timer(l,c){var d=this.props[km]||{};d[l]=c,this.props[km]=d,this.save()}remove_event_timer(l){var c=(this.props[km]||{})[l];return ei(c)||(delete this.props[km][l],this.save()),c}get_property(l){return this.props[l]}set_property(l,c){this.props[l]=c,this.save()}}class Np{constructor(){this._events={},this._events={}}on(l,c){return this._events[l]||(this._events[l]=[]),this._events[l].push(c),()=>{this._events[l]=this._events[l].filter((l=>l!==c))}}emit(l,c){for(var d of this._events[l]||[])d(c);for(var h of this._events["*"]||[])h(l,c)}}class Pp{constructor(l){this._debugEventEmitter=new Np,this._checkStep=(l,c)=>this._checkStepEvent(l,c)&&this._checkStepUrl(l,c)&&this._checkStepElement(l,c),this._checkStepEvent=(l,c)=>null==c||!c.event||(null==l?void 0:l.event)===(null==c?void 0:c.event),this._instance=l,this._actionEvents=new Set,this._actionRegistry=new Set}init(){var l,c;ei(null==(l=this._instance)?void 0:l._addCaptureHook)||(null==(c=this._instance)||c._addCaptureHook(((l,c)=>{this.on(l,c)})))}register(l){var c,d;if(!ei(null==(c=this._instance)?void 0:c._addCaptureHook)&&(l.forEach((l=>{var c,d;null==(c=this._actionRegistry)||c.add(l),null==(d=l.steps)||d.forEach((l=>{var c;null==(c=this._actionEvents)||c.add((null==l?void 0:l.event)||"")}))})),null!=(d=this._instance)&&d.autocapture)){var h,p=new Set;l.forEach((l=>{var c;null==(c=l.steps)||c.forEach((l=>{null!=l&&l.selector&&p.add(null==l?void 0:l.selector)}))})),null==(h=this._instance)||h.autocapture.setElementSelectors(p)}}on(l,c){var d;null!=c&&0!=l.length&&(this._actionEvents.has(l)||this._actionEvents.has(null==c?void 0:c.event))&&this._actionRegistry&&(null==(d=this._actionRegistry)?void 0:d.size)>0&&this._actionRegistry.forEach((l=>{this._checkAction(c,l)&&this._debugEventEmitter.emit("actionCaptured",l.name)}))}_addActionHook(l){this.onAction("actionCaptured",(c=>l(c)))}_checkAction(l,c){if(null==(null==c?void 0:c.steps))return!1;for(var d of c.steps)if(this._checkStep(l,d))return!0;return!1}onAction(l,c){return this._debugEventEmitter.on(l,c)}_checkStepUrl(l,c){if(null!=c&&c.url){var d,h=null==l||null==(d=l.properties)?void 0:d.$current_url;if(!h||"string"!=typeof h)return!1;if(!Pp._matchString(h,null==c?void 0:c.url,(null==c?void 0:c.url_matching)||"contains"))return!1}return!0}static _matchString(l,c,d){switch(d){case"regex":return!!sm&&Pu(l,c);case"exact":return c===l;case"contains":var h=Pp._escapeStringRegexp(c).replace(/_/g,".").replace(/%/g,".*");return Pu(l,h);default:return!1}}static _escapeStringRegexp(l){return l.replace(/[|\\{}()[\]^$+*?.]/g,"\\$&").replace(/-/g,"\\x2d")}_checkStepElement(l,c){if((null!=c&&c.href||null!=c&&c.tag_name||null!=c&&c.text)&&!this._getElementsList(l).some((l=>!(null!=c&&c.href&&!Pp._matchString(l.href||"",null==c?void 0:c.href,(null==c?void 0:c.href_matching)||"exact")||null!=c&&c.tag_name&&l.tag_name!==(null==c?void 0:c.tag_name)||null!=c&&c.text&&!Pp._matchString(l.text||"",null==c?void 0:c.text,(null==c?void 0:c.text_matching)||"exact")&&!Pp._matchString(l.$el_text||"",null==c?void 0:c.text,(null==c?void 0:c.text_matching)||"exact")))))return!1;if(null!=c&&c.selector){var d,h=null==l||null==(d=l.properties)?void 0:d.$element_selectors;if(!h)return!1;if(!h.includes(null==c?void 0:c.selector))return!1}return!0}_getElementsList(l){return null==(null==l?void 0:l.properties.$elements)?[]:null==l?void 0:l.properties.$elements}}class Fp{constructor(l){this._instance=l,this._eventToSurveys=new Map,this._actionToSurveys=new Map}register(l){var c;ei(null==(c=this._instance)?void 0:c._addCaptureHook)||(this._setupEventBasedSurveys(l),this._setupActionBasedSurveys(l))}_setupActionBasedSurveys(l){var c=l.filter((l=>{var c,d;return(null==(c=l.conditions)?void 0:c.actions)&&(null==(d=l.conditions)||null==(d=d.actions)||null==(d=d.values)?void 0:d.length)>0}));0!==c.length&&(null==this._actionMatcher&&(this._actionMatcher=new Pp(this._instance),this._actionMatcher.init(),this._actionMatcher._addActionHook((l=>{this.onAction(l)}))),c.forEach((l=>{var c,d,h,p,f;l.conditions&&null!=(c=l.conditions)&&c.actions&&null!=(d=l.conditions)&&null!=(d=d.actions)&&d.values&&(null==(h=l.conditions)||null==(h=h.actions)||null==(h=h.values)?void 0:h.length)>0&&(null==(p=this._actionMatcher)||p.register(l.conditions.actions.values),null==(f=l.conditions)||null==(f=f.actions)||null==(f=f.values)||f.forEach((c=>{if(c&&c.name){var d=this._actionToSurveys.get(c.name);d&&d.push(l.id),this._actionToSurveys.set(c.name,d||[l.id])}})))})))}_setupEventBasedSurveys(l){var c;0!==l.filter((l=>{var c,d;return(null==(c=l.conditions)?void 0:c.events)&&(null==(d=l.conditions)||null==(d=d.events)||null==(d=d.values)?void 0:d.length)>0})).length&&(null==(c=this._instance)||c._addCaptureHook(((l,c)=>{this.onEvent(l,c)})),l.forEach((l=>{var c;null==(c=l.conditions)||null==(c=c.events)||null==(c=c.values)||c.forEach((c=>{if(c&&c.name){var d=this._eventToSurveys.get(c.name);d&&d.push(l.id),this._eventToSurveys.set(c.name,d||[l.id])}}))})))}onEvent(l,c){var d,h,p=(null==(d=this._instance)||null==(d=d.persistence)?void 0:d.props[Hm])||[];if(zg.SHOWN===l&&c&&p.length>0){var f;Vg.info("survey event matched, removing survey from activated surveys",{event:l,eventPayload:c,existingActivatedSurveys:p});var m=null==c||null==(f=c.properties)?void 0:f.$survey_id;if(m){var y=p.indexOf(m);y>=0&&(p.splice(y,1),this._updateActivatedSurveys(p))}}else if(this._eventToSurveys.has(l)){Vg.info("survey event name matched",{event:l,eventPayload:c,surveys:this._eventToSurveys.get(l)});var _=[];null==(h=this._instance)||h.getSurveys((c=>{_=c.filter((c=>{var d;return null==(d=this._eventToSurveys.get(l))?void 0:d.includes(c.id)}))}));var b=_.filter((d=>{var h,p=null==(h=d.conditions)||null==(h=h.events)||null==(h=h.values)?void 0:h.find((c=>c.name===l));return!!p&&(!p.propertyFilters||Object.entries(p.propertyFilters).every((l=>{var d,[h,p]=l,f=null==c||null==(d=c.properties)?void 0:d[h];if(ei(f)||ii(f))return!1;var m=[String(f)],y=ky[p.operator];return y?y(p.values,m):(Vg.warn("Unknown property comparison operator: "+p.operator),!1)})))}));this._updateActivatedSurveys(p.concat(b.map((l=>l.id))||[]))}}onAction(l){var c,d=(null==(c=this._instance)||null==(c=c.persistence)?void 0:c.props[Hm])||[];this._actionToSurveys.has(l)&&this._updateActivatedSurveys(d.concat(this._actionToSurveys.get(l)||[]))}_updateActivatedSurveys(l){var c;Vg.info("updating activated surveys",{activatedSurveys:l}),null==(c=this._instance)||null==(c=c.persistence)||c.register({[Hm]:[...new Set(l)]})}getSurveys(){var l;return(null==(l=this._instance)||null==(l=l.persistence)?void 0:l.props[Hm])||[]}getEventToSurveys(){return this._eventToSurveys}_getActionMatcher(){return this._actionMatcher}}class Lp{constructor(l){this._isSurveysEnabled=void 0,this._surveyManager=null,this._isFetchingSurveys=!1,this._isInitializingSurveys=!1,this._surveyCallbacks=[],this._instance=l,this._surveyEventReceiver=null}onRemoteConfig(l){if(!this._instance.config.disable_surveys){var c=l.surveys;if(ni(c))return Vg.warn("Flags not loaded yet. Not loading surveys.");var d=zf(c);this._isSurveysEnabled=d?c.length>0:c,Vg.info("flags response received, isSurveysEnabled: "+this._isSurveysEnabled),this.loadIfEnabled()}}reset(){localStorage.removeItem("lastSeenSurveyDate");for(var l=[],c=0;c<localStorage.length;c++){var d=localStorage.key(c);(null!=d&&d.startsWith(Zg)||null!=d&&d.startsWith(Gg))&&l.push(d)}l.forEach((l=>localStorage.removeItem(l)))}loadIfEnabled(){if(!this._surveyManager)if(this._isInitializingSurveys)Vg.info("Already initializing surveys, skipping...");else if(this._instance.config.disable_surveys)Vg.info("Disabled. Not loading surveys.");else if(this._instance.config.cookieless_mode&&this._instance.consent.isOptedOut())Vg.info("Not loading surveys in cookieless mode without consent.");else{var l=null==gm?void 0:gm.__PosthogExtensions__;if(l){if(!ei(this._isSurveysEnabled)||this._instance.config.advanced_enable_surveys){var c=this._isSurveysEnabled||this._instance.config.advanced_enable_surveys;this._isInitializingSurveys=!0;try{var d=l.generateSurveys;if(d)return void this._completeSurveyInitialization(d,c);var h=l.loadExternalDependency;if(!h)return void this._handleSurveyLoadError("PostHog loadExternalDependency extension not found.");h(this._instance,"surveys",(d=>{d||!l.generateSurveys?this._handleSurveyLoadError("Could not load surveys script",d):this._completeSurveyInitialization(l.generateSurveys,c)}))}catch(p){throw this._handleSurveyLoadError("Error initializing surveys",p),p}finally{this._isInitializingSurveys=!1}}}else Vg.error("PostHog Extensions not found.")}}_completeSurveyInitialization(l,c){this._surveyManager=l(this._instance,c),this._surveyEventReceiver=new Fp(this._instance),Vg.info("Surveys loaded successfully"),this._notifySurveyCallbacks({isLoaded:!0})}_handleSurveyLoadError(l,c){Vg.error(l,c),this._notifySurveyCallbacks({isLoaded:!1,error:l})}onSurveysLoaded(l){return this._surveyCallbacks.push(l),this._surveyManager&&this._notifySurveyCallbacks({isLoaded:!0}),()=>{this._surveyCallbacks=this._surveyCallbacks.filter((c=>c!==l))}}getSurveys(l,c){if(void 0===c&&(c=!1),this._instance.config.disable_surveys)return Vg.info("Disabled. Not loading surveys."),l([]);var d=this._instance.get_property(Bm);if(d&&!c)return l(d,{isLoaded:!0});if(this._isFetchingSurveys)return l([],{isLoaded:!1,error:"Surveys are already being loaded"});try{this._isFetchingSurveys=!0,this._instance._send_request({url:this._instance.requestRouter.endpointFor("api","/api/surveys/?token="+this._instance.config.token),method:"GET",timeout:this._instance.config.surveys_request_timeout_ms,callback:c=>{var d;this._isFetchingSurveys=!1;var h=c.statusCode;if(200!==h||!c.json){var p="Surveys API could not be loaded, status: "+h;return Vg.error(p),l([],{isLoaded:!1,error:p})}var f,m=c.json.surveys||[],y=m.filter((l=>Ta(l)&&(Ma(l)||Ra(l))));return y.length>0&&(null==(f=this._surveyEventReceiver)||f.register(y)),null==(d=this._instance.persistence)||d.register({[Bm]:m}),l(m,{isLoaded:!0})}})}catch(h){throw this._isFetchingSurveys=!1,h}}_notifySurveyCallbacks(l){for(var c of this._surveyCallbacks)try{if(!l.isLoaded)return c([],l);this.getSurveys(c)}catch(d){Vg.error("Error in survey callback",d)}}getActiveMatchingSurveys(l,c){if(void 0===c&&(c=!1),!ni(this._surveyManager))return this._surveyManager.getActiveMatchingSurveys(l,c);Vg.warn("init was not called")}_getSurveyById(l){var c=null;return this.getSurveys((d=>{var h;c=null!==(h=d.find((c=>c.id===l)))&&void 0!==h?h:null})),c}_checkSurveyEligibility(l){if(ni(this._surveyManager))return{eligible:!1,reason:"SDK is not enabled or survey functionality is not yet loaded"};var c="string"==typeof l?this._getSurveyById(l):l;return c?this._surveyManager.checkSurveyEligibility(c):{eligible:!1,reason:"Survey not found"}}canRenderSurvey(l){if(ni(this._surveyManager))return Vg.warn("init was not called"),{visible:!1,disabledReason:"SDK is not enabled or survey functionality is not yet loaded"};var c=this._checkSurveyEligibility(l);return{visible:c.eligible,disabledReason:c.reason}}canRenderSurveyAsync(l,c){return ni(this._surveyManager)?(Vg.warn("init was not called"),Promise.resolve({visible:!1,disabledReason:"SDK is not enabled or survey functionality is not yet loaded"})):new Promise((d=>{this.getSurveys((c=>{var h,p=null!==(h=c.find((c=>c.id===l)))&&void 0!==h?h:null;if(p){var f=this._checkSurveyEligibility(p);d({visible:f.eligible,disabledReason:f.reason})}else d({visible:!1,disabledReason:"Survey not found"})}),c)}))}renderSurvey(l,c){var d;if(ni(this._surveyManager))Vg.warn("init was not called");else{var h="string"==typeof l?this._getSurveyById(l):l;if(null!=h&&h.id)if(Kg.includes(h.type)){var p=null==um?void 0:um.querySelector(c);if(p)return null!=(d=h.appearance)&&d.surveyPopupDelaySeconds?(Vg.info("Rendering survey "+h.id+" with delay of "+h.appearance.surveyPopupDelaySeconds+" seconds"),void setTimeout((()=>{var l,c;Vg.info("Rendering survey "+h.id+" with delay of "+(null==(l=h.appearance)?void 0:l.surveyPopupDelaySeconds)+" seconds"),null==(c=this._surveyManager)||c.renderSurvey(h,p),Vg.info("Survey "+h.id+" rendered")}),1e3*h.appearance.surveyPopupDelaySeconds)):void this._surveyManager.renderSurvey(h,p);Vg.warn("Survey element not found")}else Vg.warn("Surveys of type "+h.type+" cannot be rendered in the app");else Vg.warn("Survey not found")}}displaySurvey(l,c){var d;if(ni(this._surveyManager))Vg.warn("init was not called");else{var h=this._getSurveyById(l);if(h){var p=h;if(null!=(d=h.appearance)&&d.surveyPopupDelaySeconds&&c.ignoreDelay&&(p=r$2({},h,{appearance:r$2({},h.appearance,{surveyPopupDelaySeconds:0})})),!1===c.ignoreConditions){var f=this.canRenderSurvey(h);if(!f.visible)return void Vg.warn("Survey is not eligible to be displayed: ",f.disabledReason)}c.displayType!==Wg.Inline?this._surveyManager.handlePopoverSurvey(p):this.renderSurvey(p,c.selector)}else Vg.warn("Survey not found")}}}var db=_m("[RateLimiter]");class Dp{constructor(l){var c,d;this.serverLimits={},this.lastEventRateLimited=!1,this.checkForLimiting=l=>{var c=l.text;if(c&&c.length)try{(JSON.parse(c).quota_limited||[]).forEach((l=>{db.info((l||"events")+" is quota limited."),this.serverLimits[l]=(new Date).getTime()+6e4}))}catch(d){return void db.warn('could not rate limit - continuing. Error: "'+(null==d?void 0:d.message)+'"',{text:c})}},this.instance=l,this.captureEventsPerSecond=(null==(c=l.config.rate_limiting)?void 0:c.events_per_second)||10,this.captureEventsBurstLimit=Math.max((null==(d=l.config.rate_limiting)?void 0:d.events_burst_limit)||10*this.captureEventsPerSecond,this.captureEventsPerSecond),this.lastEventRateLimited=this.clientRateLimitContext(!0).isRateLimited}clientRateLimitContext(l){var c,d,h;void 0===l&&(l=!1);var p=(new Date).getTime(),f=null!==(c=null==(d=this.instance.persistence)?void 0:d.get_property(Vm))&&void 0!==c?c:{tokens:this.captureEventsBurstLimit,last:p};f.tokens+=(p-f.last)/1e3*this.captureEventsPerSecond,f.last=p,f.tokens>this.captureEventsBurstLimit&&(f.tokens=this.captureEventsBurstLimit);var m=f.tokens<1;return m||l||(f.tokens=Math.max(0,f.tokens-1)),!m||this.lastEventRateLimited||l||this.instance.capture("$$client_ingestion_warning",{$$client_ingestion_warning_message:"posthog-js client rate limited. Config is set to "+this.captureEventsPerSecond+" events per second and "+this.captureEventsBurstLimit+" events burst limit."},{skip_client_rate_limiting:!0}),this.lastEventRateLimited=m,null==(h=this.instance.persistence)||h.set_property(Vm,f),{isRateLimited:m,remainingTokens:f.tokens}}isServerRateLimited(l){var c=this.serverLimits[l||"events"]||!1;return!1!==c&&(new Date).getTime()<c}}var hb=_m("[RemoteConfig]");class qp{constructor(l){this._instance=l}get remoteConfig(){var l;return null==(l=gm._POSTHOG_REMOTE_CONFIG)||null==(l=l[this._instance.config.token])?void 0:l.config}_loadRemoteConfigJs(l){var c,d;null!=(c=gm.__PosthogExtensions__)&&c.loadExternalDependency?null==(d=gm.__PosthogExtensions__)||null==d.loadExternalDependency||d.loadExternalDependency(this._instance,"remote-config",(()=>l(this.remoteConfig))):(hb.error("PostHog Extensions not found. Cannot load remote config."),l())}_loadRemoteConfigJSON(l){this._instance._send_request({method:"GET",url:this._instance.requestRouter.endpointFor("assets","/array/"+this._instance.config.token+"/config"),callback:c=>{l(c.json)}})}load(){try{if(this.remoteConfig)return hb.info("Using preloaded remote config",this.remoteConfig),void this._onRemoteConfig(this.remoteConfig);if(this._instance._shouldDisableFlags())return void hb.warn("Remote config is disabled. Falling back to local config.");this._loadRemoteConfigJs((l=>{if(!l)return hb.info("No config found after loading remote JS config. Falling back to JSON."),void this._loadRemoteConfigJSON((l=>{this._onRemoteConfig(l)}));this._onRemoteConfig(l)}))}catch(hh){hb.error("Error loading remote config",hh)}}_onRemoteConfig(l){l?this._instance.config.__preview_remote_config?(this._instance._onRemoteConfig(l),!1!==l.hasFeatureFlags&&this._instance.featureFlags.ensureFlagsLoaded()):hb.info("__preview_remote_config is disabled. Logging config instead",l):hb.error("Failed to fetch remote config from PostHog.")}}var pb=3e3;class Vp{constructor(l,c){this._isPaused=!0,this._queue=[],this._flushTimeoutMs=fi((null==c?void 0:c.flush_interval_ms)||pb,250,5e3,ym.createLogger("flush interval"),pb),this._sendRequest=l}enqueue(l){this._queue.push(l),this._flushTimeout||this._setFlushTimeout()}unload(){this._clearFlushTimeout();var l=this._queue.length>0?this._formatQueue():{},c=Object.values(l);[...c.filter((l=>0===l.url.indexOf("/e"))),...c.filter((l=>0!==l.url.indexOf("/e")))].map((l=>{this._sendRequest(r$2({},l,{transport:"sendBeacon"}))}))}enable(){this._isPaused=!1,this._setFlushTimeout()}_setFlushTimeout(){var l=this;this._isPaused||(this._flushTimeout=setTimeout((()=>{if(this._clearFlushTimeout(),this._queue.length>0){var c=this._formatQueue(),r2=function(){var h=c[d],p=(new Date).getTime();h.data&&zf(h.data)&&fn(h.data,(l=>{l.offset=Math.abs(l.timestamp-p),delete l.timestamp})),l._sendRequest(h)};for(var d in c)r2()}}),this._flushTimeoutMs))}_clearFlushTimeout(){clearTimeout(this._flushTimeout),this._flushTimeout=void 0}_formatQueue(){var l={};return fn(this._queue,(c=>{var d,h=c,p=(h?h.batchKey:null)||h.url;ei(l[p])&&(l[p]=r$2({},h,{data:[]})),null==(d=l[p].data)||d.push(h.data)})),this._queue=[],l}}var fb=["retriesPerformedSoFar"];class Wp{constructor(l){this._isPolling=!1,this._pollIntervalMs=3e3,this._queue=[],this._instance=l,this._queue=[],this._areWeOnline=!0,!ei(sm)&&"onLine"in sm.navigator&&(this._areWeOnline=sm.navigator.onLine,this._onlineListener=()=>{this._areWeOnline=!0,this._flush()},this._offlineListener=()=>{this._areWeOnline=!1},En(sm,"online",this._onlineListener),En(sm,"offline",this._offlineListener))}get length(){return this._queue.length}retriableRequest(l){var{retriesPerformedSoFar:c}=l,d=i$2(l,fb);si(c)&&c>0&&(d.url=Mu(d.url,{retry_count:c})),this._instance._send_request(r$2({},d,{callback:l=>{200!==l.statusCode&&(l.statusCode<400||l.statusCode>=500)&&(null!=c?c:0)<10?this._enqueue(r$2({retriesPerformedSoFar:c},d)):null==d.callback||d.callback(l)}}))}_enqueue(l){var c=l.retriesPerformedSoFar||0;l.retriesPerformedSoFar=c+1;var d,h,p,f,m,y=(d=c,h=3e3*Math.pow(2,d),p=h/2,f=Math.min(18e5,h),m=(Math.random()-.5)*(f-p),Math.ceil(f+m)),_=Date.now()+y;this._queue.push({retryAt:_,requestOptions:l});var b="Enqueued failed request for retry in "+y;navigator.onLine||(b+=" (Browser is offline)"),ym.warn(b),this._isPolling||(this._isPolling=!0,this._poll())}_poll(){if(this._poller&&clearTimeout(this._poller),0===this._queue.length)return this._isPolling=!1,void(this._poller=void 0);this._poller=setTimeout((()=>{this._areWeOnline&&this._queue.length>0&&this._flush(),this._poll()}),this._pollIntervalMs)}_flush(){var l=Date.now(),c=[],d=this._queue.filter((d=>d.retryAt<l||(c.push(d),!1)));if(this._queue=c,d.length>0)for(var{requestOptions:h}of d)this.retriableRequest(h)}unload(){for(var{requestOptions:l}of(this._poller&&(clearTimeout(this._poller),this._poller=void 0),this._isPolling=!1,ei(sm)||(this._onlineListener&&(sm.removeEventListener("online",this._onlineListener),this._onlineListener=void 0),this._offlineListener&&(sm.removeEventListener("offline",this._offlineListener),this._offlineListener=void 0)),this._queue))try{this._instance._send_request(r$2({},l,{transport:"sendBeacon"}))}catch(c){ym.error(c)}this._queue=[]}}class Up{constructor(l){this._updateScrollData=()=>{var l,c,d,h;this._context||(this._context={});var p=this.scrollElement(),f=this.scrollY(),m=p?Math.max(0,p.scrollHeight-p.clientHeight):0,y=f+((null==p?void 0:p.clientHeight)||0),_=(null==p?void 0:p.scrollHeight)||0;this._context.lastScrollY=Math.ceil(f),this._context.maxScrollY=Math.max(f,null!==(l=this._context.maxScrollY)&&void 0!==l?l:0),this._context.maxScrollHeight=Math.max(m,null!==(c=this._context.maxScrollHeight)&&void 0!==c?c:0),this._context.lastContentY=y,this._context.maxContentY=Math.max(y,null!==(d=this._context.maxContentY)&&void 0!==d?d:0),this._context.maxContentHeight=Math.max(_,null!==(h=this._context.maxContentHeight)&&void 0!==h?h:0)},this._instance=l}getContext(){return this._context}resetContext(){var l=this._context;return setTimeout(this._updateScrollData,0),l}startMeasuringScrollPosition(){En(sm,"scroll",this._updateScrollData,{capture:!0}),En(sm,"scrollend",this._updateScrollData,{capture:!0}),En(sm,"resize",this._updateScrollData)}scrollElement(){if(!this._instance.config.scroll_root_selector)return null==sm?void 0:sm.document.documentElement;var l=zf(this._instance.config.scroll_root_selector)?this._instance.config.scroll_root_selector:[this._instance.config.scroll_root_selector];for(var c of l){var d=null==sm?void 0:sm.document.querySelector(c);if(d)return d}}scrollY(){if(this._instance.config.scroll_root_selector){var l=this.scrollElement();return l&&l.scrollTop||0}return sm&&(sm.scrollY||sm.pageYOffset||sm.document.documentElement.scrollTop)||0}scrollX(){if(this._instance.config.scroll_root_selector){var l=this.scrollElement();return l&&l.scrollLeft||0}return sm&&(sm.scrollX||sm.pageXOffset||sm.document.documentElement.scrollLeft)||0}}var Zp=l=>lp(null==l?void 0:l.config.mask_personal_data_properties,null==l?void 0:l.config.custom_personal_data_properties);class zp{constructor(l,c,d,h){this._onSessionIdCallback=l=>{var c=this._getStored();if(!c||c.sessionId!==l){var d={sessionId:l,props:this._sessionSourceParamGenerator(this._instance)};this._persistence.register({[Wm]:d})}},this._instance=l,this._sessionIdManager=c,this._persistence=d,this._sessionSourceParamGenerator=h||Zp,this._sessionIdManager.onSessionId(this._onSessionIdCallback)}_getStored(){return this._persistence.props[Wm]}getSetOnceProps(){var l,c=null==(l=this._getStored())?void 0:l.props;return c?"r"in c?up(c):{$referring_domain:c.referringDomain,$pathname:c.initialPathName,utm_source:c.utm_source,utm_campaign:c.utm_campaign,utm_medium:c.utm_medium,utm_content:c.utm_content,utm_term:c.utm_term}:{}}getSessionProps(){var l={};return fn(Sn(this.getSetOnceProps()),((c,d)=>{"$current_url"===d&&(d="url"),l["$session_entry_"+Ur(d)]=c})),l}}var mb=_m("[SessionId]");class Gp{on(l,c){return this._eventEmitter.on(l,c)}constructor(l,c,d){var h;if(this._sessionIdChangedHandlers=[],this._beforeUnloadListener=void 0,this._eventEmitter=new Np,this._sessionHasBeenIdleTooLong=(l,c)=>Math.abs(l-c)>this.sessionTimeoutMs,!l.persistence)throw new Error("SessionIdManager requires a PostHogPersistence instance");if("always"===l.config.cookieless_mode)throw new Error('SessionIdManager cannot be used with cookieless_mode="always"');this._config=l.config,this._persistence=l.persistence,this._windowId=void 0,this._sessionId=void 0,this._sessionStartTimestamp=null,this._sessionActivityTimestamp=null,this._sessionIdGenerator=c||Ua,this._windowIdGenerator=d||Ua;var p=this._config.persistence_name||this._config.token,f=this._config.session_idle_timeout_seconds||1800;if(this._sessionTimeoutMs=1e3*fi(f,60,36e3,mb.createLogger("session_idle_timeout_seconds"),1800),l.register({$configured_session_timeout_ms:this._sessionTimeoutMs}),this._resetIdleTimer(),this._window_id_storage_key="ph_"+p+"_window_id",this._primary_window_exists_storage_key="ph_"+p+"_primary_window_exists",this._canUseSessionStorage()){var m=F_._parse(this._window_id_storage_key),y=F_._parse(this._primary_window_exists_storage_key);m&&!y?this._windowId=m:F_._remove(this._window_id_storage_key),F_._set(this._primary_window_exists_storage_key,!0)}if(null!=(h=this._config.bootstrap)&&h.sessionID)try{var _=(()=>{var l=this._config.bootstrap.sessionID.replace(/-/g,"");if(32!==l.length)throw new Error("Not a valid UUID");if("7"!==l[12])throw new Error("Not a UUIDv7");return parseInt(l.substring(0,12),16)})();this._setSessionId(this._config.bootstrap.sessionID,(new Date).getTime(),_)}catch(b){mb.error("Invalid sessionID in bootstrap",b)}this._listenToReloadWindow()}get sessionTimeoutMs(){return this._sessionTimeoutMs}onSessionId(l){return ei(this._sessionIdChangedHandlers)&&(this._sessionIdChangedHandlers=[]),this._sessionIdChangedHandlers.push(l),this._sessionId&&l(this._sessionId,this._windowId),()=>{this._sessionIdChangedHandlers=this._sessionIdChangedHandlers.filter((c=>c!==l))}}_canUseSessionStorage(){return"memory"!==this._config.persistence&&!this._persistence._disabled&&F_._is_supported()}_setWindowId(l){l!==this._windowId&&(this._windowId=l,this._canUseSessionStorage()&&F_._set(this._window_id_storage_key,l))}_getWindowId(){return this._windowId?this._windowId:this._canUseSessionStorage()?F_._parse(this._window_id_storage_key):null}_setSessionId(l,c,d){l===this._sessionId&&c===this._sessionActivityTimestamp&&d===this._sessionStartTimestamp||(this._sessionStartTimestamp=d,this._sessionActivityTimestamp=c,this._sessionId=l,this._persistence.register({[Pm]:[c,l,d]}))}_getSessionId(){if(this._sessionId&&this._sessionActivityTimestamp&&this._sessionStartTimestamp)return[this._sessionActivityTimestamp,this._sessionId,this._sessionStartTimestamp];var l=this._persistence.props[Pm];return zf(l)&&2===l.length&&l.push(l[0]),l||[0,null,0]}resetSessionId(){this._setSessionId(null,null,null)}destroy(){clearTimeout(this._enforceIdleTimeout),this._enforceIdleTimeout=void 0,this._beforeUnloadListener&&sm&&(sm.removeEventListener("beforeunload",this._beforeUnloadListener,{capture:!1}),this._beforeUnloadListener=void 0),this._sessionIdChangedHandlers=[]}_listenToReloadWindow(){this._beforeUnloadListener=()=>{this._canUseSessionStorage()&&F_._remove(this._primary_window_exists_storage_key)},En(sm,"beforeunload",this._beforeUnloadListener,{capture:!1})}checkAndGetSessionAndWindowId(l,c){if(void 0===l&&(l=!1),void 0===c&&(c=null),"always"===this._config.cookieless_mode)throw new Error('checkAndGetSessionAndWindowId should not be called with cookieless_mode="always"');var d=c||(new Date).getTime(),[h,p,f]=this._getSessionId(),m=this._getWindowId(),y=si(f)&&f>0&&Math.abs(d-f)>864e5,_=!1,b=!p,w=!b&&!l&&this._sessionHasBeenIdleTooLong(d,h);b||w||y?(p=this._sessionIdGenerator(),m=this._windowIdGenerator(),mb.info("new session ID generated",{sessionId:p,windowId:m,changeReason:{noSessionId:b,activityTimeout:w,sessionPastMaximumLength:y}}),f=d,_=!0):m||(m=this._windowIdGenerator(),_=!0);var E=0===h||!l||y?d:h,M=0===f?(new Date).getTime():f;return this._setWindowId(m),this._setSessionId(p,E,M),l||this._resetIdleTimer(),_&&this._sessionIdChangedHandlers.forEach((l=>l(p,m,_?{noSessionId:b,activityTimeout:w,sessionPastMaximumLength:y}:void 0))),{sessionId:p,windowId:m,sessionStartTimestamp:M,changeReason:_?{noSessionId:b,activityTimeout:w,sessionPastMaximumLength:y}:void 0,lastActivityTimestamp:h}}_resetIdleTimer(){clearTimeout(this._enforceIdleTimeout),this._enforceIdleTimeout=setTimeout((()=>{var[l]=this._getSessionId();if(this._sessionHasBeenIdleTooLong((new Date).getTime(),l)){var c=this._sessionId;this.resetSessionId(),this._eventEmitter.emit("forcedIdleReset",{idleSessionId:c})}}),1.1*this.sessionTimeoutMs)}}var gb=["$set_once","$set"],vb=_m("[SiteApps]");class Kp{constructor(l){this._instance=l,this._bufferedInvocations=[],this.apps={}}get isEnabled(){return!!this._instance.config.opt_in_site_apps}_eventCollector(l,c){if(c){var d=this.globalsForEvent(c);this._bufferedInvocations.push(d),this._bufferedInvocations.length>1e3&&(this._bufferedInvocations=this._bufferedInvocations.slice(10))}}get siteAppLoaders(){var l;return null==(l=gm._POSTHOG_REMOTE_CONFIG)||null==(l=l[this._instance.config.token])?void 0:l.siteApps}init(){if(this.isEnabled){var l=this._instance._addCaptureHook(this._eventCollector.bind(this));this._stopBuffering=()=>{l(),this._bufferedInvocations=[],this._stopBuffering=void 0}}}globalsForEvent(l){var c,d,h,p,f,m,y;if(!l)throw new Error("Event payload is required");var _={},b=this._instance.get_property("$groups")||[],w=this._instance.get_property("$stored_group_properties")||{};for(var[E,M]of Object.entries(w))_[E]={id:b[E],type:E,properties:M};var{$set_once:N,$set:P}=l;return{event:r$2({},i$2(l,gb),{properties:r$2({},l.properties,P?{$set:r$2({},null!==(c=null==(d=l.properties)?void 0:d.$set)&&void 0!==c?c:{},P)}:{},N?{$set_once:r$2({},null!==(h=null==(p=l.properties)?void 0:p.$set_once)&&void 0!==h?h:{},N)}:{}),elements_chain:null!==(f=null==(m=l.properties)?void 0:m.$elements_chain)&&void 0!==f?f:"",distinct_id:null==(y=l.properties)?void 0:y.distinct_id}),person:{properties:this._instance.get_property("$stored_person_properties")},groups:_}}setupSiteApp(l){var c=this.apps[l.id],r2=()=>{var d;!c.errored&&this._bufferedInvocations.length&&(vb.info("Processing "+this._bufferedInvocations.length+" events for site app with id "+l.id),this._bufferedInvocations.forEach((l=>null==c.processEvent?void 0:c.processEvent(l))),c.processedBuffer=!0),Object.values(this.apps).every((l=>l.processedBuffer||l.errored))&&(null==(d=this._stopBuffering)||d.call(this))},d=!1,n2=h=>{c.errored=!h,c.loaded=!0,vb.info("Site app with id "+l.id+" "+(h?"loaded":"errored")),d&&r2()};try{var{processEvent:h}=l.init({posthog:this._instance,callback:l=>{n2(l)}});h&&(c.processEvent=h),d=!0}catch(p){vb.error("Error while initializing PostHog app with config id "+l.id,p),n2(!1)}if(d&&c.loaded)try{r2()}catch(f){vb.error("Error while processing buffered events PostHog app with config id "+l.id,f),c.errored=!0}}_setupSiteApps(){var l=this.siteAppLoaders||[];for(var c of l)this.apps[c.id]={id:c.id,loaded:!1,errored:!1,processedBuffer:!1};for(var d of l)this.setupSiteApp(d)}_onCapturedEvent(l){if(0!==Object.keys(this.apps).length){var c=this.globalsForEvent(l);for(var d of Object.values(this.apps))try{null==d.processEvent||d.processEvent(c)}catch(h){vb.error("Error while processing event "+l.event+" for site app "+d.id,h)}}}onRemoteConfig(l){var c,d,h,p=this;if(null!=(c=this.siteAppLoaders)&&c.length)return this.isEnabled?(this._setupSiteApps(),void this._instance.on("eventCaptured",(l=>this._onCapturedEvent(l)))):void vb.error('PostHog site apps are disabled. Enable the "opt_in_site_apps" config to proceed.');if(null==(d=this._stopBuffering)||d.call(this),null!=(h=l.siteApps)&&h.length)if(this.isEnabled){var s2=function(l){var c;gm["__$$ph_site_app_"+l]=p._instance,null==(c=gm.__PosthogExtensions__)||null==c.loadSiteApp||c.loadSiteApp(p._instance,m,(c=>{if(c)return vb.error("Error while initializing PostHog app with config id "+l,c)}))};for(var{id:f,url:m}of l.siteApps)s2(f)}else vb.error('PostHog site apps are disabled. Enable the "opt_in_site_apps" config to proceed.')}}var Jp=function(l,c){if(!l)return!1;var d=l.userAgent;if(d&&Br(d,c))return!0;try{var h=null==l?void 0:l.userAgentData;if(null!=h&&h.brands&&h.brands.some((l=>Br(null==l?void 0:l.brand,c))))return!0}catch(p){}return!!l.webdriver},yb=function(l){return l.US="us",l.EU="eu",l.CUSTOM="custom",l}({}),_b="i.posthog.com";class tv{constructor(l){this._regionCache={},this.instance=l}get apiHost(){var l=this.instance.config.api_host.trim().replace(/\/$/,"");return"https://app.posthog.com"===l?"https://us.i.posthog.com":l}get flagsApiHost(){var l=this.instance.config.flags_api_host;return l?l.trim().replace(/\/$/,""):this.apiHost}get uiHost(){var l,c=null==(l=this.instance.config.ui_host)?void 0:l.replace(/\/$/,"");return c||(c=this.apiHost.replace("."+_b,".posthog.com")),"https://app.posthog.com"===c?"https://us.posthog.com":c}get region(){return this._regionCache[this.apiHost]||(/https:\/\/(app|us|us-assets)(\.i)?\.posthog\.com/i.test(this.apiHost)?this._regionCache[this.apiHost]=yb.US:/https:\/\/(eu|eu-assets)(\.i)?\.posthog\.com/i.test(this.apiHost)?this._regionCache[this.apiHost]=yb.EU:this._regionCache[this.apiHost]=yb.CUSTOM),this._regionCache[this.apiHost]}endpointFor(l,c){if(void 0===c&&(c=""),c&&(c="/"===c[0]?c:"/"+c),"ui"===l)return this.uiHost+c;if("flags"===l)return this.flagsApiHost+c;if(this.region===yb.CUSTOM)return this.apiHost+c;var d=_b+c;switch(l){case"assets":return"https://"+this.region+"-assets."+d;case"api":return"https://"+this.region+"."+d}}}var bb={icontains:(l,c)=>!!sm&&c.href.toLowerCase().indexOf(l.toLowerCase())>-1,not_icontains:(l,c)=>!!sm&&-1===c.href.toLowerCase().indexOf(l.toLowerCase()),regex:(l,c)=>!!sm&&Pu(c.href,l),not_regex:(l,c)=>!!sm&&!Pu(c.href,l),exact:(l,c)=>c.href===l,is_not:(l,c)=>c.href!==l};class iv{constructor(l){var c=this;this.getWebExperimentsAndEvaluateDisplayLogic=function(l){void 0===l&&(l=!1),c.getWebExperiments((l=>{iv._logInfo("retrieved web experiments from the server"),c._flagToExperiments=new Map,l.forEach((l=>{if(l.feature_flag_key){var d;c._flagToExperiments&&(iv._logInfo("setting flag key ",l.feature_flag_key," to web experiment ",l),null==(d=c._flagToExperiments)||d.set(l.feature_flag_key,l));var h=c._instance.getFeatureFlag(l.feature_flag_key);ti(h)&&l.variants[h]&&c._applyTransforms(l.name,h,l.variants[h].transforms)}else if(l.variants)for(var p in l.variants){var f=l.variants[p];iv._matchesTestVariant(f)&&c._applyTransforms(l.name,p,f.transforms)}}))}),l)},this._instance=l,this._instance.onFeatureFlags((l=>{this.onFeatureFlags(l)}))}onFeatureFlags(l){if(this._is_bot())iv._logInfo("Refusing to render web experiment since the viewer is a likely bot");else if(!this._instance.config.disable_web_experiments){if(ni(this._flagToExperiments))return this._flagToExperiments=new Map,this.loadIfEnabled(),void this.previewWebExperiment();iv._logInfo("applying feature flags",l),l.forEach((l=>{var c;if(this._flagToExperiments&&null!=(c=this._flagToExperiments)&&c.has(l)){var d,h=this._instance.getFeatureFlag(l),p=null==(d=this._flagToExperiments)?void 0:d.get(l);h&&null!=p&&p.variants[h]&&this._applyTransforms(p.name,h,p.variants[h].transforms)}}))}}previewWebExperiment(){var l=iv.getWindowLocation();if(null!=l&&l.search){var c=Mn(null==l?void 0:l.search,"__experiment_id"),d=Mn(null==l?void 0:l.search,"__experiment_variant");c&&d&&(iv._logInfo("previewing web experiments "+c+" && "+d),this.getWebExperiments((l=>{this._showPreviewWebExperiment(parseInt(c),d,l)}),!1,!0))}}loadIfEnabled(){this._instance.config.disable_web_experiments||this.getWebExperimentsAndEvaluateDisplayLogic()}getWebExperiments(l,c,d){if(this._instance.config.disable_web_experiments&&!d)return l([]);var h=this._instance.get_property("$web_experiments");if(h&&!c)return l(h);this._instance._send_request({url:this._instance.requestRouter.endpointFor("api","/api/web_experiments/?token="+this._instance.config.token),method:"GET",callback:c=>{if(200!==c.statusCode||!c.json)return l([]);var d=c.json.experiments||[];return l(d)}})}_showPreviewWebExperiment(l,c,d){var h=d.filter((c=>c.id===l));h&&h.length>0&&(iv._logInfo("Previewing web experiment ["+h[0].name+"] with variant ["+c+"]"),this._applyTransforms(h[0].name,c,h[0].variants[c].transforms))}static _matchesTestVariant(l){return!ni(l.conditions)&&iv._matchUrlConditions(l)&&iv._matchUTMConditions(l)}static _matchUrlConditions(l){var c;if(ni(l.conditions)||ni(null==(c=l.conditions)?void 0:c.url))return!0;var d,h,p,f=iv.getWindowLocation();return!!f&&(null==(d=l.conditions)||!d.url||bb[null!==(h=null==(p=l.conditions)?void 0:p.urlMatchType)&&void 0!==h?h:"icontains"](l.conditions.url,f))}static getWindowLocation(){return null==sm?void 0:sm.location}static _matchUTMConditions(l){var c;if(ni(l.conditions)||ni(null==(c=l.conditions)?void 0:c.utm))return!0;var d=ip();if(d.utm_source){var h,p,f,m,y,_,b,w,E=null==(h=l.conditions)||null==(h=h.utm)||!h.utm_campaign||(null==(p=l.conditions)||null==(p=p.utm)?void 0:p.utm_campaign)==d.utm_campaign,M=null==(f=l.conditions)||null==(f=f.utm)||!f.utm_source||(null==(m=l.conditions)||null==(m=m.utm)?void 0:m.utm_source)==d.utm_source,N=null==(y=l.conditions)||null==(y=y.utm)||!y.utm_medium||(null==(_=l.conditions)||null==(_=_.utm)?void 0:_.utm_medium)==d.utm_medium,P=null==(b=l.conditions)||null==(b=b.utm)||!b.utm_term||(null==(w=l.conditions)||null==(w=w.utm)?void 0:w.utm_term)==d.utm_term;return E&&N&&P&&M}return!1}static _logInfo(l){for(var c=arguments.length,d=new Array(c>1?c-1:0),h=1;h<c;h++)d[h-1]=arguments[h];ym.info("[WebExperiments] "+l,d)}_applyTransforms(l,c,d){this._is_bot()?iv._logInfo("Refusing to render web experiment since the viewer is a likely bot"):"control"!==c?d.forEach((d=>{if(d.selector){var h;iv._logInfo("applying transform of variant "+c+" for experiment "+l+" ",d);var p=null==(h=document)?void 0:h.querySelectorAll(d.selector);null==p||p.forEach((l=>{var c=l;d.html&&(c.innerHTML=d.html),d.css&&c.setAttribute("style",d.css)}))}})):iv._logInfo("Control variants leave the page unmodified.")}_is_bot(){return cm&&this._instance?Jp(cm,this._instance.config.custom_blocked_useragents):void 0}}var wb=_m("[PostHog ExternalIntegrations]"),Sb={intercom:"intercom-integration",crispChat:"crisp-chat-integration"};class ov{constructor(l){this._instance=l}_loadScript(l,c){var d;null==(d=gm.__PosthogExtensions__)||null==d.loadExternalDependency||d.loadExternalDependency(this._instance,l,(l=>{if(l)return wb.error("failed to load script",l);c()}))}startIfEnabledOrStop(){var l=this,t2=function(c){var h,p,f;!d||null!=(h=gm.__PosthogExtensions__)&&null!=(h=h.integrations)&&h[c]||l._loadScript(Sb[c],(()=>{var d;null==(d=gm.__PosthogExtensions__)||null==(d=d.integrations)||null==(d=d[c])||d.start(l._instance)})),!d&&null!=(p=gm.__PosthogExtensions__)&&null!=(p=p.integrations)&&p[c]&&(null==(f=gm.__PosthogExtensions__)||null==(f=f.integrations)||null==(f=f[c])||f.stop())};for(var[c,d]of Object.entries(null!==(h=this._instance.config.integrations)&&void 0!==h?h:{})){var h;t2(c)}}}var xb="[SessionRecording]",kb=_m(xb);class uv{get started(){var l;return!(null==(l=this._lazyLoadedSessionRecording)||!l.isStarted)}get status(){return this._lazyLoadedSessionRecording?this._lazyLoadedSessionRecording.status:this._receivedFlags&&!this._isRecordingEnabled?"disabled":"lazy_loading"}constructor(l){if(this._forceAllowLocalhostNetworkCapture=!1,this._receivedFlags=!1,this._persistFlagsOnSessionListener=void 0,this._instance=l,!this._instance.sessionManager)throw kb.error("started without valid sessionManager"),new Error(xb+" started without valid sessionManager. This is a bug.");if("always"===this._instance.config.cookieless_mode)throw new Error(xb+' cannot be used with cookieless_mode="always"')}get _isRecordingEnabled(){var l,c=!(null==(l=this._instance.get_property(Nm))||!l.enabled),d=!this._instance.config.disable_session_recording,h=this._instance.config.disable_session_recording||this._instance.consent.isOptedOut();return sm&&c&&d&&!h}startIfEnabledOrStop(l){var c;if(!this._isRecordingEnabled||null==(c=this._lazyLoadedSessionRecording)||!c.isStarted){var d=!ei(Object.assign)&&!ei(Array.from);this._isRecordingEnabled&&d?(this._lazyLoadAndStart(l),kb.info("starting")):this.stopRecording()}}_lazyLoadAndStart(l){var c,d,h;this._isRecordingEnabled&&(null!=gm&&null!=(c=gm.__PosthogExtensions__)&&null!=(c=c.rrweb)&&c.record&&null!=(d=gm.__PosthogExtensions__)&&d.initSessionRecording?this._onScriptLoaded(l):null==(h=gm.__PosthogExtensions__)||null==h.loadExternalDependency||h.loadExternalDependency(this._instance,this._scriptName,(c=>{if(c)return kb.error("could not load recorder",c);this._onScriptLoaded(l)})))}stopRecording(){var l,c;null==(l=this._persistFlagsOnSessionListener)||l.call(this),this._persistFlagsOnSessionListener=void 0,null==(c=this._lazyLoadedSessionRecording)||c.stop()}_resetSampling(){var l;null==(l=this._instance.persistence)||l.unregister(Lm)}_persistRemoteConfig(l){if(this._instance.persistence){var c,d,h=this._instance.persistence,s2=()=>{var c=!1===l.sessionRecording?void 0:l.sessionRecording,d=null==c?void 0:c.sampleRate,p=ni(d)?null:parseFloat(d);ni(p)&&this._resetSampling();var f=null==c?void 0:c.minimumDurationMilliseconds;h.register({[Nm]:r$2({enabled:!!c},c,{networkPayloadCapture:r$2({capturePerformance:l.capturePerformance},null==c?void 0:c.networkPayloadCapture),canvasRecording:{enabled:null==c?void 0:c.recordCanvas,fps:null==c?void 0:c.canvasFps,quality:null==c?void 0:c.canvasQuality},sampleRate:p,minimumDurationMilliseconds:ei(f)?null:f,endpoint:null==c?void 0:c.endpoint,triggerMatchType:null==c?void 0:c.triggerMatchType,masking:null==c?void 0:c.masking,urlTriggers:null==c?void 0:c.urlTriggers})})};s2(),null==(c=this._persistFlagsOnSessionListener)||c.call(this),this._persistFlagsOnSessionListener=null==(d=this._instance.sessionManager)?void 0:d.onSessionId(s2)}}onRemoteConfig(l){"sessionRecording"in l?!1!==l.sessionRecording?(this._persistRemoteConfig(l),this._receivedFlags=!0,this.startIfEnabledOrStop()):this._receivedFlags=!0:kb.info("skipping remote config with no sessionRecording",l)}log(l,c){var d;void 0===c&&(c="log"),null!=(d=this._lazyLoadedSessionRecording)&&d.log?this._lazyLoadedSessionRecording.log(l,c):kb.warn("log called before recorder was ready")}get _scriptName(){var l,c,d=null==(l=this._instance)||null==(l=l.persistence)?void 0:l.get_property(Nm);return(null==d||null==(c=d.scriptConfig)?void 0:c.script)||"lazy-recorder"}_onScriptLoaded(l){var c,d;if(null==(c=gm.__PosthogExtensions__)||!c.initSessionRecording)throw Error("Called on script loaded before session recording is available");this._lazyLoadedSessionRecording||(this._lazyLoadedSessionRecording=null==(d=gm.__PosthogExtensions__)?void 0:d.initSessionRecording(this._instance),this._lazyLoadedSessionRecording._forceAllowLocalhostNetworkCapture=this._forceAllowLocalhostNetworkCapture),this._lazyLoadedSessionRecording.start(l)}onRRwebEmit(l){var c;null==(c=this._lazyLoadedSessionRecording)||null==c.onRRwebEmit||c.onRRwebEmit(l)}overrideLinkedFlag(){var l,c;this._lazyLoadedSessionRecording||null==(c=this._instance.persistence)||c.register({$replay_override_linked_flag:!0}),null==(l=this._lazyLoadedSessionRecording)||l.overrideLinkedFlag()}overrideSampling(){var l,c;this._lazyLoadedSessionRecording||null==(c=this._instance.persistence)||c.register({$replay_override_sampling:!0}),null==(l=this._lazyLoadedSessionRecording)||l.overrideSampling()}overrideTrigger(l){var c,d;this._lazyLoadedSessionRecording||null==(d=this._instance.persistence)||d.register({["url"===l?"$replay_override_url_trigger":"$replay_override_event_trigger"]:!0}),null==(c=this._lazyLoadedSessionRecording)||c.overrideTrigger(l)}get sdkDebugProperties(){var l;return(null==(l=this._lazyLoadedSessionRecording)?void 0:l.sdkDebugProperties)||{$recording_status:this.status}}tryAddCustomEvent(l,c){var d;return!(null==(d=this._lazyLoadedSessionRecording)||!d.tryAddCustomEvent(l,c))}}var Cb={},dv=()=>{},Eb="posthog",Ib=!wy&&-1===(null==mm?void 0:mm.indexOf("MSIE"))&&-1===(null==mm?void 0:mm.indexOf("Mozilla")),vv=l=>{var c;return{api_host:"https://us.i.posthog.com",flags_api_host:null,ui_host:null,token:"",autocapture:!0,rageclick:!0,cross_subdomain_cookie:In(null==um?void 0:um.location),persistence:"localStorage+cookie",persistence_name:"",loaded:dv,save_campaign_params:!0,custom_campaign_params:[],custom_blocked_useragents:[],save_referrer:!0,capture_pageview:!(l&&l>="2025-05-24")||"history_change",capture_pageleave:"if_capture_pageview",defaults:null!=l?l:"unset",__preview_deferred_init_extensions:!1,debug:dm&&ti(null==dm?void 0:dm.search)&&-1!==dm.search.indexOf("__posthog_debug=true")||!1,cookie_expiration:365,upgrade:!1,disable_session_recording:!1,disable_persistence:!1,disable_web_experiments:!0,disable_surveys:!1,disable_surveys_automatic_display:!1,disable_external_dependency_loading:!1,enable_recording_console_log:void 0,secure_cookie:"https:"===(null==sm||null==(c=sm.location)?void 0:c.protocol),ip:!1,opt_out_capturing_by_default:!1,opt_out_persistence_by_default:!1,opt_out_useragent_filter:!1,opt_out_capturing_persistence_type:"localStorage",consent_persistence_name:null,opt_out_capturing_cookie_prefix:null,opt_in_site_apps:!1,property_denylist:[],respect_dnt:!1,sanitize_properties:null,request_headers:{},request_batching:!0,properties_string_max_length:65535,session_recording:l&&l>="2025-11-30"?{strictMinimumDuration:!0}:{},mask_all_element_attributes:!1,mask_all_text:!1,mask_personal_data_properties:!1,custom_personal_data_properties:[],advanced_disable_flags:!1,advanced_disable_decide:!1,advanced_disable_feature_flags:!1,advanced_disable_feature_flags_on_first_load:!1,advanced_only_evaluate_survey_feature_flags:!1,advanced_enable_surveys:!1,advanced_disable_toolbar_metrics:!1,feature_flag_request_timeout_ms:3e3,surveys_request_timeout_ms:1e4,on_request_error:l=>{var c="Bad HTTP status: "+l.statusCode+" "+l.text;ym.error(c)},get_device_id:l=>l,capture_performance:void 0,name:"posthog",bootstrap:{},disable_compression:!1,session_idle_timeout_seconds:1800,person_profiles:"identified_only",before_send:void 0,request_queue_config:{flush_interval_ms:pb},error_tracking:{},_onCapture:dv,__preview_eager_load_replay:!1}},fv=l=>{var c={};ei(l.process_person)||(c.person_profiles=l.process_person),ei(l.xhr_headers)||(c.request_headers=l.xhr_headers),ei(l.cookie_name)||(c.persistence_name=l.cookie_name),ei(l.disable_cookie)||(c.disable_persistence=l.disable_cookie),ei(l.store_google)||(c.save_campaign_params=l.store_google),ei(l.verbose)||(c.debug=l.verbose);var d=gn({},c,l);return zf(l.property_blacklist)&&(ei(l.property_denylist)?d.property_denylist=l.property_blacklist:zf(l.property_denylist)?d.property_denylist=[...l.property_blacklist,...l.property_denylist]:ym.error("Invalid value for property_denylist config: "+l.property_denylist)),d};class gv{constructor(){this.__forceAllowLocalhost=!1}get _forceAllowLocalhost(){return this.__forceAllowLocalhost}set _forceAllowLocalhost(l){ym.error("WebPerformanceObserver is deprecated and has no impact on network capture. Use `_forceAllowLocalhostNetworkCapture` on `posthog.sessionRecording`"),this.__forceAllowLocalhost=l}}class _v{get decideEndpointWasHit(){var l,c;return null!==(l=null==(c=this.featureFlags)?void 0:c.hasLoadedFlags)&&void 0!==l&&l}get flagsEndpointWasHit(){var l,c;return null!==(l=null==(c=this.featureFlags)?void 0:c.hasLoadedFlags)&&void 0!==l&&l}constructor(){this.webPerformance=new gv,this._personProcessingSetOncePropertiesSent=!1,this.version=vm.LIB_VERSION,this._internalEventEmitter=new Np,this._calculate_event_properties=this.calculateEventProperties.bind(this),this.config=vv(),this.SentryIntegration=Uh,this.sentryIntegration=l=>function(l,c){var d=Wh(l,c);return{name:z_,processEvent:l=>d(l)}}(this,l),this.__request_queue=[],this.__loaded=!1,this.analyticsDefaultEndpoint="/e/",this._initialPageviewCaptured=!1,this._visibilityStateListener=null,this._initialPersonProfilesConfig=null,this._cachedPersonProperties=null,this.featureFlags=new Mp(this),this.toolbar=new Yh(this),this.scrollManager=new Up(this),this.pageViewManager=new yp(this),this.surveys=new Lp(this),this.experiments=new iv(this),this.exceptions=new rd(this),this.rateLimiter=new Dp(this),this.requestRouter=new tv(this),this.consent=new Nh(this),this.externalIntegrations=new ov(this),this.people={set:(l,c,d)=>{var h=ti(l)?{[l]:c}:l;this.setPersonProperties(h),null==d||d({})},set_once:(l,c,d)=>{var h=ti(l)?{[l]:c}:l;this.setPersonProperties(void 0,h),null==d||d({})}},this.on("eventCaptured",(l=>ym.info('send "'+(null==l?void 0:l.event)+'"',l)))}init(l,c,d){if(d&&d!==Eb){var h,p=null!==(h=Cb[d])&&void 0!==h?h:new _v;return p._init(l,c,d),Cb[d]=p,Cb[Eb][d]=p,p}return this._init(l,c,d)}_init(l,c,d){var h;if(void 0===c&&(c={}),ei(l)||ri(l))return ym.critical("PostHog was initialized without a token. This likely indicates a misconfiguration. Please check the first argument passed to posthog.init()"),this;if(this.__loaded)return console.warn("[PostHog.js]","You have already initialized PostHog! Re-initializing is a no-op"),this;this.__loaded=!0,this.config={},c.debug=this._checkLocalStorageForDebug(c.debug),this._originalUserConfig=c,this._triggered_notifs=[],c.person_profiles&&(this._initialPersonProfilesConfig=c.person_profiles),this.set_config(gn({},vv(c.defaults),fv(c),{name:d,token:l})),this.config.on_xhr_error&&ym.error("on_xhr_error is deprecated. Use on_request_error instead"),this.compression=c.disable_compression?void 0:ty.GZipJS;var p=this._is_persistence_disabled();this.persistence=new Ap(this.config,p),this.sessionPersistence="sessionStorage"===this.config.persistence||"memory"===this.config.persistence?this.persistence:new Ap(r$2({},this.config,{persistence:"sessionStorage"}),p);var f=r$2({},this.persistence.props),m=r$2({},this.sessionPersistence.props);this.register({$initialization_time:(new Date).toISOString()}),this._requestQueue=new Vp((l=>this._send_retriable_request(l)),this.config.request_queue_config),this._retryQueue=new Wp(this),this.__request_queue=[];var y="always"===this.config.cookieless_mode||"on_reject"===this.config.cookieless_mode&&this.consent.isExplicitlyOptedOut();if(y||(this.sessionManager=new Gp(this),this.sessionPropsManager=new zp(this,this.sessionManager,this.persistence)),this.config.__preview_deferred_init_extensions?(ym.info("Deferring extension initialization to improve startup performance"),setTimeout((()=>{this._initExtensions(y)}),0)):(ym.info("Initializing extensions synchronously"),this._initExtensions(y)),vm.DEBUG=vm.DEBUG||this.config.debug,vm.DEBUG&&ym.info("Starting in debug mode",{this:this,config:c,thisC:r$2({},this.config),p:f,s:m}),void 0!==(null==(h=c.bootstrap)?void 0:h.distinctID)){var _,b,w=this.config.get_device_id(Ua()),E=null!=(_=c.bootstrap)&&_.isIdentifiedID?w:c.bootstrap.distinctID;this.persistence.set_property(qm,null!=(b=c.bootstrap)&&b.isIdentifiedID?"identified":"anonymous"),this.register({distinct_id:c.bootstrap.distinctID,$device_id:E})}if(this._hasBootstrappedFeatureFlags()){var M,N,P=Object.keys((null==(M=c.bootstrap)?void 0:M.featureFlags)||{}).filter((l=>{var d;return!(null==(d=c.bootstrap)||null==(d=d.featureFlags)||!d[l])})).reduce(((l,d)=>{var h;return l[d]=(null==(h=c.bootstrap)||null==(h=h.featureFlags)?void 0:h[d])||!1,l}),{}),L=Object.keys((null==(N=c.bootstrap)?void 0:N.featureFlagPayloads)||{}).filter((l=>P[l])).reduce(((l,d)=>{var h,p;return null!=(h=c.bootstrap)&&null!=(h=h.featureFlagPayloads)&&h[d]&&(l[d]=null==(p=c.bootstrap)||null==(p=p.featureFlagPayloads)?void 0:p[d]),l}),{});this.featureFlags.receivedFeatureFlags({featureFlags:P,featureFlagPayloads:L})}if(y)this.register_once({distinct_id:Qm,$device_id:null},"");else if(!this.get_distinct_id()){var j=this.config.get_device_id(Ua());this.register_once({distinct_id:j,$device_id:j},""),this.persistence.set_property(qm,"anonymous")}return En(sm,"onpagehide"in self?"pagehide":"unload",this._handle_unload.bind(this),{passive:!1}),this.toolbar.maybeLoadToolbar(),c.segment?function(l,c){var d=l.config.segment;if(!d)return c();!function(l,c){var d=l.config.segment;if(!d)return c();var i2=d=>{var i3=()=>d.anonymousId()||Ua();l.config.get_device_id=i3,d.id()&&(l.register({distinct_id:d.id(),$device_id:i3()}),l.persistence.set_property(qm,"identified")),c()},h=d.user();"then"in h&&Xr(h.then)?h.then((l=>i2(l))):i2(h)}(l,(()=>{d.register((l=>{Promise&&Promise.resolve||H_.warn("This browser does not have Promise support, and can not use the segment integration");var t3=(c,d)=>{if(!d)return c;c.event.userId||c.event.anonymousId===l.get_distinct_id()||(H_.info("No userId set, resetting PostHog"),l.reset()),c.event.userId&&c.event.userId!==l.get_distinct_id()&&(H_.info("UserId set, identifying with PostHog"),l.identify(c.event.userId));var h=l.calculateEventProperties(d,c.event.properties);return c.event.properties=Object.assign({},h,c.event.properties),c};return{name:"PostHog JS",type:"enrichment",version:"1.0.0",isLoaded:()=>!0,load:()=>Promise.resolve(),track:l=>t3(l,l.event.event),page:l=>t3(l,"$pageview"),identify:l=>t3(l,"$identify"),screen:l=>t3(l,"$screen")}})(l)).then((()=>{c()}))}))}(this,(()=>this._loaded())):this._loaded(),Xr(this.config._onCapture)&&this.config._onCapture!==dv&&(ym.warn("onCapture is deprecated. Please use `before_send` instead"),this.on("eventCaptured",(l=>this.config._onCapture(l.event,l)))),this.config.ip&&ym.warn('The `ip` config option has NO EFFECT AT ALL and has been deprecated. Use a custom transformation or "Discard IP data" project setting instead. See https://posthog.com/tutorials/web-redact-properties#hiding-customer-ip-address for more information.'),this}_initExtensions(l){var c=performance.now();this.historyAutocapture=new qh(this),this.historyAutocapture.startIfEnabled();var d=[];d.push((()=>{new Kh(this).startIfEnabledOrStop()})),d.push((()=>{var l;this.siteApps=new Kp(this),null==(l=this.siteApps)||l.init()})),l||d.push((()=>{this.sessionRecording=new uv(this),this.sessionRecording.startIfEnabledOrStop()})),this.config.disable_scroll_properties||d.push((()=>{this.scrollManager.startMeasuringScrollPosition()})),d.push((()=>{this.autocapture=new vh(this),this.autocapture.startIfEnabled()})),d.push((()=>{this.surveys.loadIfEnabled()})),d.push((()=>{this.heatmaps=new mp(this),this.heatmaps.startIfEnabled()})),d.push((()=>{this.webVitalsAutocapture=new fp(this)})),d.push((()=>{this.exceptionObserver=new Hh(this),this.exceptionObserver.startIfEnabled()})),d.push((()=>{this.deadClicksAutocapture=new Oh(this,Lh),this.deadClicksAutocapture.startIfEnabled()})),d.push((()=>{if(this._pendingRemoteConfig){var l=this._pendingRemoteConfig;this._pendingRemoteConfig=void 0,this._onRemoteConfig(l)}})),this._processInitTaskQueue(d,c)}_processInitTaskQueue(l,c){for(;l.length>0;){if(this.config.__preview_deferred_init_extensions&&performance.now()-c>=30&&l.length>0)return void setTimeout((()=>{this._processInitTaskQueue(l,c)}),0);var d=l.shift();if(d)try{d()}catch(p){ym.error("Error initializing extension:",p)}}var h=Math.round(performance.now()-c);this.register_for_session({$sdk_debug_extensions_init_method:this.config.__preview_deferred_init_extensions?"deferred":"synchronous",$sdk_debug_extensions_init_time_ms:h}),this.config.__preview_deferred_init_extensions&&ym.info("PostHog extensions initialized ("+h+"ms)")}_onRemoteConfig(l){var c,d,h,p,f,m,y,_;if(!um||!um.body)return ym.info("document not ready yet, trying again in 500 milliseconds..."),void setTimeout((()=>{this._onRemoteConfig(l)}),500);this.config.__preview_deferred_init_extensions&&(this._pendingRemoteConfig=l),this.compression=void 0,l.supportedCompression&&!this.config.disable_compression&&(this.compression=$r(l.supportedCompression,ty.GZipJS)?ty.GZipJS:$r(l.supportedCompression,ty.Base64)?ty.Base64:void 0),null!=(c=l.analytics)&&c.endpoint&&(this.analyticsDefaultEndpoint=l.analytics.endpoint),this.set_config({person_profiles:this._initialPersonProfilesConfig?this._initialPersonProfilesConfig:"identified_only"}),null==(d=this.siteApps)||d.onRemoteConfig(l),null==(h=this.sessionRecording)||h.onRemoteConfig(l),null==(p=this.autocapture)||p.onRemoteConfig(l),null==(f=this.heatmaps)||f.onRemoteConfig(l),this.surveys.onRemoteConfig(l),null==(m=this.webVitalsAutocapture)||m.onRemoteConfig(l),null==(y=this.exceptionObserver)||y.onRemoteConfig(l),this.exceptions.onRemoteConfig(l),null==(_=this.deadClicksAutocapture)||_.onRemoteConfig(l)}_loaded(){try{this.config.loaded(this)}catch(hh){ym.critical("`loaded` function failed",hh)}this._start_queue_if_opted_in(),this.config.capture_pageview&&setTimeout((()=>{(this.consent.isOptedIn()||"always"===this.config.cookieless_mode)&&this._captureInitialPageview()}),1),new qp(this).load(),this.featureFlags.flags()}_start_queue_if_opted_in(){var l;this.is_capturing()&&this.config.request_batching&&(null==(l=this._requestQueue)||l.enable())}_dom_loaded(){this.is_capturing()&&vn(this.__request_queue,(l=>this._send_retriable_request(l))),this.__request_queue=[],this._start_queue_if_opted_in()}_handle_unload(){var l,c;this.config.request_batching?(this._shouldCapturePageleave()&&this.capture("$pageleave"),null==(l=this._requestQueue)||l.unload(),null==(c=this._retryQueue)||c.unload()):this._shouldCapturePageleave()&&this.capture("$pageleave",null,{transport:"sendBeacon"})}_send_request(l){this.__loaded&&(Ib?this.__request_queue.push(l):this.rateLimiter.isServerRateLimited(l.batchKey)||(l.transport=l.transport||this.config.api_transport,l.url=Mu(l.url,{ip:this.config.ip?1:0}),l.headers=r$2({},this.config.request_headers),l.compression="best-available"===l.compression?this.compression:l.compression,l.disableXHRCredentials=this.config.__preview_disable_xhr_credentials,this.config.__preview_disable_beacon&&(l.disableTransport=["sendBeacon"]),l.fetchOptions=l.fetchOptions||this.config.fetch_options,(l=>{var c,d,h,p=r$2({},l);p.timeout=p.timeout||6e4,p.url=Mu(p.url,{_:(new Date).getTime().toString(),ver:vm.LIB_VERSION,compression:p.compression});var f=null!==(c=p.transport)&&void 0!==c?c:"fetch",m=xy.filter((l=>!p.disableTransport||!l.transport||!p.disableTransport.includes(l.transport))),y=null!==(d=null==(h=kn(m,(l=>l.transport===f)))?void 0:h.method)&&void 0!==d?d:m[0].method;if(!y)throw new Error("No available transport method");y(p)})(r$2({},l,{callback:c=>{var d,h;this.rateLimiter.checkForLimiting(c),c.statusCode>=400&&(null==(d=(h=this.config).on_request_error)||d.call(h,c)),null==l.callback||l.callback(c)}}))))}_send_retriable_request(l){this._retryQueue?this._retryQueue.retriableRequest(l):this._send_request(l)}_execute_array(l){var c,d=[],h=[],p=[];vn(l,(l=>{l&&(c=l[0],zf(c)?p.push(l):Xr(l)?l.call(this):zf(l)&&"alias"===c?d.push(l):zf(l)&&-1!==c.indexOf("capture")&&Xr(this[c])?p.push(l):h.push(l))}));var s2=function(l,c){vn(l,(function(l){if(zf(l[0])){var d=c;fn(l,(function(l){d=d[l[0]].apply(d,l.slice(1))}))}else this[l[0]].apply(this,l.slice(1))}),c)};s2(d,this),s2(h,this),s2(p,this)}_hasBootstrappedFeatureFlags(){var l,c;return(null==(l=this.config.bootstrap)?void 0:l.featureFlags)&&Object.keys(null==(c=this.config.bootstrap)?void 0:c.featureFlags).length>0||!1}push(l){this._execute_array([l])}capture(l,c,d){var h;if(this.__loaded&&this.persistence&&this.sessionPersistence&&this._requestQueue){if(this.is_capturing())if(!ei(l)&&ti(l)){var p=!this.config.opt_out_useragent_filter&&this._is_bot();if(!p||this.config.__preview_capture_bot_pageviews){var f=null!=d&&d.skip_client_rate_limiting?void 0:this.rateLimiter.clientRateLimitContext();if(null==f||!f.isRateLimited){null!=c&&c.$current_url&&!ti(null==c?void 0:c.$current_url)&&(ym.error("Invalid `$current_url` property provided to `posthog.capture`. Input must be a string. Ignoring provided value."),null==c||delete c.$current_url),this.sessionPersistence.update_search_keyword(),this.config.save_campaign_params&&this.sessionPersistence.update_campaign_params(),this.config.save_referrer&&this.sessionPersistence.update_referrer_info(),(this.config.save_campaign_params||this.config.save_referrer)&&this.persistence.set_initial_person_info();var m=new Date,y=(null==d?void 0:d.timestamp)||m,_=Ua(),b={uuid:_,event:l,properties:this.calculateEventProperties(l,c||{},y,_)};"$pageview"===l&&this.config.__preview_capture_bot_pageviews&&p&&(b.event="$bot_pageview",b.properties.$browser_type="bot"),f&&(b.properties.$lib_rate_limit_remaining_tokens=f.remainingTokens),(null==d?void 0:d.$set)&&(b.$set=null==d?void 0:d.$set);var w=this._calculate_set_once_properties(null==d?void 0:d.$set_once);if(w&&(b.$set_once=w),(b=function(l,c){return d=l,h=l=>ti(l)&&!ii(c)?l.slice(0,c):l,p=new Set,function e4(l,c){return l!==Object(l)?h?h(l):l:p.has(l)?void 0:(p.add(l),zf(l)?(d=[],vn(l,(l=>{d.push(e4(l))}))):(d={},fn(l,((l,c)=>{p.has(l)||(d[c]=e4(l,c))}))),d);var d}(d);var d,h,p}(b,null!=d&&d._noTruncate?null:this.config.properties_string_max_length)).timestamp=y,ei(null==d?void 0:d.timestamp)||(b.properties.$event_time_override_provided=!0,b.properties.$event_time_override_system_time=m),l===zg.DISMISSED||l===zg.SENT){var E=null==c?void 0:c[qg.SURVEY_ID],M=null==c?void 0:c[qg.SURVEY_ITERATION];La({id:E,current_iteration:M}),b.$set=r$2({},b.$set,{[Pa({id:E,current_iteration:M},l===zg.SENT?"responded":"dismissed")]:!0})}var N=r$2({},b.properties.$set,b.$set);if(Qr(N)||this.setPersonPropertiesForFlags(N),!ni(this.config.before_send)){var P=this._runBeforeSend(b);if(!P)return;b=P}this._internalEventEmitter.emit("eventCaptured",b);var L={method:"POST",url:null!==(h=null==d?void 0:d._url)&&void 0!==h?h:this.requestRouter.endpointFor("api",this.analyticsDefaultEndpoint),data:b,compression:"best-available",batchKey:null==d?void 0:d._batchKey};return!this.config.request_batching||d&&(null==d||!d._batchKey)||null!=d&&d.send_instantly?this._send_retriable_request(L):this._requestQueue.enqueue(L),b}ym.critical("This capture call is ignored due to client rate limiting.")}}else ym.error("No event name provided to posthog.capture")}else ym.uninitializedWarning("posthog.capture")}_addCaptureHook(l){return this.on("eventCaptured",(c=>l(c.event,c)))}calculateEventProperties(l,c,d,h,p){if(d=d||new Date,!this.persistence||!this.sessionPersistence)return c;var f=p?void 0:this.persistence.remove_event_timer(l),m=r$2({},c);if(m.token=this.config.token,m.$config_defaults=this.config.defaults,("always"==this.config.cookieless_mode||"on_reject"==this.config.cookieless_mode&&this.consent.isExplicitlyOptedOut())&&(m.$cookieless_mode=!0),"$snapshot"===l){var y=r$2({},this.persistence.properties(),this.sessionPersistence.properties());return m.distinct_id=y.distinct_id,(!ti(m.distinct_id)&&!si(m.distinct_id)||ri(m.distinct_id))&&ym.error("Invalid distinct_id for replay event. This indicates a bug in your implementation"),m}var _,b=function(l,c){if(!mm)return{};var d,h=l?_n([],J_,c||[]):[],[p,f]=function(l){for(var c=0;c<Xv.length;c++){var[d,h]=Xv[c],p=d.exec(l),f=p&&(Xr(h)?h(p,l):h);if(f)return f}return["",""]}(mm);return gn(Sn({$os:p,$os_version:f,$browser:Dl(mm,navigator.vendor),$device:Vl(mm),$device_type:$l(mm),$timezone:cp(),$timezone_offset:dp()}),{$current_url:Rn(null==dm?void 0:dm.href,h,Q_),$host:null==dm?void 0:dm.host,$pathname:null==dm?void 0:dm.pathname,$raw_user_agent:mm.length>1e3?mm.substring(0,997)+"...":mm,$browser_version:ql(mm,navigator.vendor),$browser_language:op(),$browser_language_prefix:(d=op(),"string"==typeof d?d.split("-")[0]:void 0),$screen_height:null==sm?void 0:sm.screen.height,$screen_width:null==sm?void 0:sm.screen.width,$viewport_height:null==sm?void 0:sm.innerHeight,$viewport_width:null==sm?void 0:sm.innerWidth,$lib:"web",$lib_version:vm.LIB_VERSION,$insert_id:Math.random().toString(36).substring(2,10)+Math.random().toString(36).substring(2,10),$time:Date.now()/1e3})}(this.config.mask_personal_data_properties,this.config.custom_personal_data_properties);if(this.sessionManager){var{sessionId:w,windowId:E}=this.sessionManager.checkAndGetSessionAndWindowId(p,d.getTime());m.$session_id=w,m.$window_id=E}this.sessionPropsManager&&gn(m,this.sessionPropsManager.getSessionProps());try{var M;this.sessionRecording&&gn(m,this.sessionRecording.sdkDebugProperties),m.$sdk_debug_retry_queue_size=null==(M=this._retryQueue)?void 0:M.length}catch(j){m.$sdk_debug_error_capturing_properties=String(j)}if(this.requestRouter.region===yb.CUSTOM&&(m.$lib_custom_api_host=this.config.api_host),_="$pageview"!==l||p?"$pageleave"!==l||p?this.pageViewManager.doEvent():this.pageViewManager.doPageLeave(d):this.pageViewManager.doPageView(d,h),m=gn(m,_),"$pageview"===l&&um&&(m.title=um.title),!ei(f)){var N=d.getTime()-f;m.$duration=parseFloat((N/1e3).toFixed(3))}mm&&this.config.opt_out_useragent_filter&&(m.$browser_type=this._is_bot()?"bot":"browser"),(m=gn({},b,this.persistence.properties(),this.sessionPersistence.properties(),m)).$is_identified=this._isIdentified(),zf(this.config.property_denylist)?fn(this.config.property_denylist,(function(l){delete m[l]})):ym.error("Invalid value for property_denylist config: "+this.config.property_denylist+" or property_blacklist config: "+this.config.property_blacklist);var P=this.config.sanitize_properties;P&&(ym.error("sanitize_properties is deprecated. Use before_send instead"),m=P(m,l));var L=this._hasPersonProcessing();return m.$process_person_profile=L,L&&!p&&this._requirePersonProcessing("_calculate_event_properties"),m}_calculate_set_once_properties(l){var c;if(!this.persistence||!this._hasPersonProcessing())return l;if(this._personProcessingSetOncePropertiesSent)return l;var d=this.persistence.get_initial_props(),h=null==(c=this.sessionPropsManager)?void 0:c.getSetOnceProps(),p=gn({},d,h||{},l||{}),f=this.config.sanitize_properties;return f&&(ym.error("sanitize_properties is deprecated. Use before_send instead"),p=f(p,"$set_once")),this._personProcessingSetOncePropertiesSent=!0,Qr(p)?void 0:p}register(l,c){var d;null==(d=this.persistence)||d.register(l,c)}register_once(l,c,d){var h;null==(h=this.persistence)||h.register_once(l,c,d)}register_for_session(l){var c;null==(c=this.sessionPersistence)||c.register(l)}unregister(l){var c;null==(c=this.persistence)||c.unregister(l)}unregister_for_session(l){var c;null==(c=this.sessionPersistence)||c.unregister(l)}_register_single(l,c){this.register({[l]:c})}getFeatureFlag(l,c){return this.featureFlags.getFeatureFlag(l,c)}getFeatureFlagPayload(l){var c=this.featureFlags.getFeatureFlagPayload(l);try{return JSON.parse(c)}catch(d){return c}}isFeatureEnabled(l,c){return this.featureFlags.isFeatureEnabled(l,c)}reloadFeatureFlags(){this.featureFlags.reloadFeatureFlags()}updateEarlyAccessFeatureEnrollment(l,c,d){this.featureFlags.updateEarlyAccessFeatureEnrollment(l,c,d)}getEarlyAccessFeatures(l,c,d){return void 0===c&&(c=!1),this.featureFlags.getEarlyAccessFeatures(l,c,d)}on(l,c){return this._internalEventEmitter.on(l,c)}onFeatureFlags(l){return this.featureFlags.onFeatureFlags(l)}onSurveysLoaded(l){return this.surveys.onSurveysLoaded(l)}onSessionId(l){var c,d;return null!==(c=null==(d=this.sessionManager)?void 0:d.onSessionId(l))&&void 0!==c?c:()=>{}}getSurveys(l,c){void 0===c&&(c=!1),this.surveys.getSurveys(l,c)}getActiveMatchingSurveys(l,c){void 0===c&&(c=!1),this.surveys.getActiveMatchingSurveys(l,c)}renderSurvey(l,c){this.surveys.renderSurvey(l,c)}displaySurvey(l,c){void 0===c&&(c=Jg),this.surveys.displaySurvey(l,c)}canRenderSurvey(l){return this.surveys.canRenderSurvey(l)}canRenderSurveyAsync(l,c){return void 0===c&&(c=!1),this.surveys.canRenderSurveyAsync(l,c)}identify(l,c,d){if(!this.__loaded||!this.persistence)return ym.uninitializedWarning("posthog.identify");if(si(l)&&(l=l.toString(),ym.warn("The first argument to posthog.identify was a number, but it should be a string. It has been converted to a string.")),l)if(["distinct_id","distinctid"].includes(l.toLowerCase()))ym.critical('The string "'+l+'" was set in posthog.identify which indicates an error. This ID should be unique to the user and not a hardcoded string.');else if(l!==Qm){if(this._requirePersonProcessing("posthog.identify")){var h=this.get_distinct_id();if(this.register({$user_id:l}),!this.get_property("$device_id")){var p=h;this.register_once({$had_persisted_distinct_id:!0,$device_id:p},"")}l!==h&&l!==this.get_property(xm)&&(this.unregister(xm),this.register({distinct_id:l}));var f="anonymous"===(this.persistence.get_property(qm)||"anonymous");l!==h&&f?(this.persistence.set_property(qm,"identified"),this.setPersonPropertiesForFlags(r$2({},d||{},c||{}),!1),this.capture("$identify",{distinct_id:l,$anon_distinct_id:h},{$set:c||{},$set_once:d||{}}),this._cachedPersonProperties=Fu(l,c,d),this.featureFlags.setAnonymousDistinctId(h)):(c||d)&&this.setPersonProperties(c,d),l!==h&&(this.reloadFeatureFlags(),this.unregister(zm))}}else ym.critical('The string "'+Qm+'" was set in posthog.identify which indicates an error. This ID is only used as a sentinel value.');else ym.error("Unique user id has not been set in posthog.identify")}setPersonProperties(l,c){if((l||c)&&this._requirePersonProcessing("posthog.setPersonProperties")){var d=Fu(this.get_distinct_id(),l,c);this._cachedPersonProperties!==d?(this.setPersonPropertiesForFlags(r$2({},c||{},l||{})),this.capture("$set",{$set:l||{},$set_once:c||{}}),this._cachedPersonProperties=d):ym.info("A duplicate setPersonProperties call was made with the same properties. It has been ignored.")}}group(l,c,d){if(l&&c){if(this._requirePersonProcessing("posthog.group")){var h=this.getGroups();h[l]!==c&&this.resetGroupPropertiesForFlags(l),this.register({$groups:r$2({},h,{[l]:c})}),d&&(this.capture("$groupidentify",{$group_type:l,$group_key:c,$group_set:d}),this.setGroupPropertiesForFlags({[l]:d})),h[l]===c||d||this.reloadFeatureFlags()}}else ym.error("posthog.group requires a group type and group key")}resetGroups(){this.register({$groups:{}}),this.resetGroupPropertiesForFlags(),this.reloadFeatureFlags()}setPersonPropertiesForFlags(l,c){void 0===c&&(c=!0),this.featureFlags.setPersonPropertiesForFlags(l,c)}resetPersonPropertiesForFlags(){this.featureFlags.resetPersonPropertiesForFlags()}setGroupPropertiesForFlags(l,c){void 0===c&&(c=!0),this._requirePersonProcessing("posthog.setGroupPropertiesForFlags")&&this.featureFlags.setGroupPropertiesForFlags(l,c)}resetGroupPropertiesForFlags(l){this.featureFlags.resetGroupPropertiesForFlags(l)}reset(l){var c,d,h,p;if(ym.info("reset"),!this.__loaded)return ym.uninitializedWarning("posthog.reset");var f=this.get_property("$device_id");if(this.consent.reset(),null==(c=this.persistence)||c.clear(),null==(d=this.sessionPersistence)||d.clear(),this.surveys.reset(),this.featureFlags.reset(),null==(h=this.persistence)||h.set_property(qm,"anonymous"),null==(p=this.sessionManager)||p.resetSessionId(),this._cachedPersonProperties=null,"always"===this.config.cookieless_mode)this.register_once({distinct_id:Qm,$device_id:null},"");else{var m=this.config.get_device_id(Ua());this.register_once({distinct_id:m,$device_id:l?m:f},"")}this.register({$last_posthog_reset:(new Date).toISOString()},1)}get_distinct_id(){return this.get_property("distinct_id")}getGroups(){return this.get_property("$groups")||{}}get_session_id(){var l,c;return null!==(l=null==(c=this.sessionManager)?void 0:c.checkAndGetSessionAndWindowId(!0).sessionId)&&void 0!==l?l:""}get_session_replay_url(l){if(!this.sessionManager)return"";var{sessionId:c,sessionStartTimestamp:d}=this.sessionManager.checkAndGetSessionAndWindowId(!0),h=this.requestRouter.endpointFor("ui","/project/"+this.config.token+"/replay/"+c);if(null!=l&&l.withTimestamp&&d){var p,f=null!==(p=l.timestampLookBack)&&void 0!==p?p:10;if(!d)return h;h+="?t="+Math.max(Math.floor(((new Date).getTime()-d)/1e3)-f,0)}return h}alias(l,c){return l===this.get_property(Sm)?(ym.critical("Attempting to create alias for existing People user - aborting."),-2):this._requirePersonProcessing("posthog.alias")?(ei(c)&&(c=this.get_distinct_id()),l!==c?(this._register_single(xm,l),this.capture("$create_alias",{alias:l,distinct_id:c})):(ym.warn("alias matches current distinct_id - skipping api call."),this.identify(l),-1)):void 0}set_config(l){var c=r$2({},this.config);if(Jr(l)){var d,h,p,f,m;gn(this.config,fv(l));var y=this._is_persistence_disabled();null==(d=this.persistence)||d.update_config(this.config,c,y),this.sessionPersistence="sessionStorage"===this.config.persistence||"memory"===this.config.persistence?this.persistence:new Ap(r$2({},this.config,{persistence:"sessionStorage"}),y);var _=this._checkLocalStorageForDebug(this.config.debug);oi(_)&&(this.config.debug=_),oi(this.config.debug)&&(this.config.debug?(vm.DEBUG=!0,M_._is_supported()&&M_._set("ph_debug","true"),ym.info("set_config",{config:l,oldConfig:c,newConfig:r$2({},this.config)})):(vm.DEBUG=!1,M_._is_supported()&&M_._remove("ph_debug"))),null==(h=this.sessionRecording)||h.startIfEnabledOrStop(),null==(p=this.autocapture)||p.startIfEnabled(),null==(f=this.heatmaps)||f.startIfEnabled(),this.surveys.loadIfEnabled(),this._sync_opt_out_with_persistence(),null==(m=this.externalIntegrations)||m.startIfEnabledOrStop()}}startSessionRecording(l){var c,d,h,p,f,m=!0===l,y={sampling:m||!(null==l||!l.sampling),linked_flag:m||!(null==l||!l.linked_flag),url_trigger:m||!(null==l||!l.url_trigger),event_trigger:m||!(null==l||!l.event_trigger)};Object.values(y).some(Boolean)&&(null==(c=this.sessionManager)||c.checkAndGetSessionAndWindowId(),y.sampling&&(null==(d=this.sessionRecording)||d.overrideSampling()),y.linked_flag&&(null==(h=this.sessionRecording)||h.overrideLinkedFlag()),y.url_trigger&&(null==(p=this.sessionRecording)||p.overrideTrigger("url")),y.event_trigger&&(null==(f=this.sessionRecording)||f.overrideTrigger("event")));this.set_config({disable_session_recording:!1})}stopSessionRecording(){this.set_config({disable_session_recording:!0})}sessionRecordingStarted(){var l;return!(null==(l=this.sessionRecording)||!l.started)}captureException(l,c){var d=new Error("PostHog syntheticException"),h=this.exceptions.buildProperties(l,{handled:!0,syntheticException:d});return this.exceptions.sendExceptionEvent(r$2({},h,c))}loadToolbar(l){return this.toolbar.loadToolbar(l)}get_property(l){var c;return null==(c=this.persistence)?void 0:c.props[l]}getSessionProperty(l){var c;return null==(c=this.sessionPersistence)?void 0:c.props[l]}toString(){var l,c=null!==(l=this.config.name)&&void 0!==l?l:Eb;return c!==Eb&&(c=Eb+"."+c),c}_isIdentified(){var l,c;return"identified"===(null==(l=this.persistence)?void 0:l.get_property(qm))||"identified"===(null==(c=this.sessionPersistence)?void 0:c.get_property(qm))}_hasPersonProcessing(){var l,c;return!("never"===this.config.person_profiles||"identified_only"===this.config.person_profiles&&!this._isIdentified()&&Qr(this.getGroups())&&(null==(l=this.persistence)||null==(l=l.props)||!l[xm])&&(null==(c=this.persistence)||null==(c=c.props)||!c[Jm]))}_shouldCapturePageleave(){return!0===this.config.capture_pageleave||"if_capture_pageview"===this.config.capture_pageleave&&(!0===this.config.capture_pageview||"history_change"===this.config.capture_pageview)}createPersonProfile(){this._hasPersonProcessing()||this._requirePersonProcessing("posthog.createPersonProfile")&&this.setPersonProperties({},{})}_requirePersonProcessing(l){return"never"===this.config.person_profiles?(ym.error(l+' was called, but process_person is set to "never". This call will be ignored.'),!1):(this._register_single(Jm,!0),!0)}_is_persistence_disabled(){if("always"===this.config.cookieless_mode)return!0;var l=this.consent.isOptedOut(),c=this.config.opt_out_persistence_by_default||"on_reject"===this.config.cookieless_mode;return this.config.disable_persistence||l&&!!c}_sync_opt_out_with_persistence(){var l,c,d,h,p=this._is_persistence_disabled();return(null==(l=this.persistence)?void 0:l._disabled)!==p&&(null==(d=this.persistence)||d.set_disabled(p)),(null==(c=this.sessionPersistence)?void 0:c._disabled)!==p&&(null==(h=this.sessionPersistence)||h.set_disabled(p)),p}opt_in_capturing(l){var c,d;"always"!==this.config.cookieless_mode?("on_reject"===this.config.cookieless_mode&&this.consent.isExplicitlyOptedOut()&&(this.reset(!0),null==(c=this.sessionManager)||c.destroy(),this.sessionManager=new Gp(this),this.persistence&&(this.sessionPropsManager=new zp(this,this.sessionManager,this.persistence)),this.sessionRecording=new uv(this),this.sessionRecording.startIfEnabledOrStop()),this.consent.optInOut(!0),this._sync_opt_out_with_persistence(),this._start_queue_if_opted_in(),"on_reject"==this.config.cookieless_mode&&this.surveys.loadIfEnabled(),(ei(null==l?void 0:l.captureEventName)||null!=l&&l.captureEventName)&&this.capture(null!==(d=null==l?void 0:l.captureEventName)&&void 0!==d?d:"$opt_in",null==l?void 0:l.captureProperties,{send_instantly:!0}),this.config.capture_pageview&&this._captureInitialPageview()):ym.warn('Consent opt in/out is not valid with cookieless_mode="always" and will be ignored')}opt_out_capturing(){var l,c;"always"!==this.config.cookieless_mode?("on_reject"===this.config.cookieless_mode&&this.consent.isOptedIn()&&this.reset(!0),this.consent.optInOut(!1),this._sync_opt_out_with_persistence(),"on_reject"===this.config.cookieless_mode&&(this.register({distinct_id:Qm,$device_id:null}),null==(l=this.sessionManager)||l.destroy(),this.sessionManager=void 0,this.sessionPropsManager=void 0,null==(c=this.sessionRecording)||c.stopRecording(),this.sessionRecording=void 0,this._captureInitialPageview())):ym.warn('Consent opt in/out is not valid with cookieless_mode="always" and will be ignored')}has_opted_in_capturing(){return this.consent.isOptedIn()}has_opted_out_capturing(){return this.consent.isOptedOut()}get_explicit_consent_status(){var l=this.consent.consent;return l===$_.GRANTED?"granted":l===$_.DENIED?"denied":"pending"}is_capturing(){return"always"===this.config.cookieless_mode||("on_reject"===this.config.cookieless_mode?this.consent.isExplicitlyOptedOut()||this.consent.isOptedIn():!this.has_opted_out_capturing())}clear_opt_in_out_capturing(){this.consent.reset(),this._sync_opt_out_with_persistence()}_is_bot(){return cm?Jp(cm,this.config.custom_blocked_useragents):void 0}_captureInitialPageview(){um&&("visible"===um.visibilityState?this._initialPageviewCaptured||(this._initialPageviewCaptured=!0,this.capture("$pageview",{title:um.title},{send_instantly:!0}),this._visibilityStateListener&&(um.removeEventListener("visibilitychange",this._visibilityStateListener),this._visibilityStateListener=null)):this._visibilityStateListener||(this._visibilityStateListener=this._captureInitialPageview.bind(this),En(um,"visibilitychange",this._visibilityStateListener)))}debug(l){!1===l?(null==sm||sm.console.log("You've disabled debug mode."),this.set_config({debug:!1})):(null==sm||sm.console.log("You're now in debug mode. All calls to PostHog will be logged in your console.\nYou can disable this with `posthog.debug(false)`."),this.set_config({debug:!0}))}_shouldDisableFlags(){var l,c,d,h,p,f,m=this._originalUserConfig||{};return"advanced_disable_flags"in m?!!m.advanced_disable_flags:!1!==this.config.advanced_disable_flags?!!this.config.advanced_disable_flags:!0===this.config.advanced_disable_decide?(ym.warn("Config field 'advanced_disable_decide' is deprecated. Please use 'advanced_disable_flags' instead. The old field will be removed in a future major version."),!0):(d="advanced_disable_decide",h=ym,p=(c="advanced_disable_flags")in(l=m)&&!ei(l[c]),f=d in l&&!ei(l[d]),p?l[c]:!!f&&(h&&h.warn("Config field '"+d+"' is deprecated. Please use '"+c+"' instead. The old field will be removed in a future major version."),l[d]))}_runBeforeSend(l){if(ni(this.config.before_send))return l;var c=zf(this.config.before_send)?this.config.before_send:[this.config.before_send],d=l;for(var h of c){if(d=h(d),ni(d)){var p="Event '"+l.event+"' was rejected in beforeSend function";return li(l.event)?ym.warn(p+". This can cause unexpected behavior."):ym.info(p),null}d.properties&&!Qr(d.properties)||ym.warn("Event '"+l.event+"' has no properties after beforeSend function, this is likely an error.")}return d}getPageViewId(){var l;return null==(l=this.pageViewManager._currentPageview)?void 0:l.pageViewId}captureTraceFeedback(l,c){this.capture("$ai_feedback",{$ai_trace_id:String(l),$ai_feedback_text:c})}captureTraceMetric(l,c,d){this.capture("$ai_metric",{$ai_trace_id:String(l),$ai_metric_name:c,$ai_metric_value:String(d)})}_checkLocalStorageForDebug(l){var c=oi(l)&&!l,d=M_._is_supported()&&"true"===M_._get("ph_debug");return!c&&(!!d||l)}}!function(l,c){for(var d=0;d<c.length;d++)l.prototype[c[d]]=bn(l.prototype[c[d]])}(_v,["identify"]);var Tb,Rb=(Tb=Cb[Eb]=new _v,function(){function e3(){e3.done||(e3.done=!0,Ib=!1,fn(Cb,(function(l){l._dom_loaded()})))}null!=um&&um.addEventListener?"complete"===um.readyState?e3():En(um,"DOMContentLoaded",e3,{capture:!1}):sm&&ym.error("Browser doesn't support `document.addEventListener` so PostHog couldn't be initialized")}(),Tb),Ab={};!function(){function t2(l,c,d,h,p,f,m){try{var y=l[f](m),_=y.value}catch(b){return void d(b)}y.done?c(_):Promise.resolve(_).then(h,p)}function e3(l){return function(){var c=this,d=arguments;return new Promise((function(h,p){var f=l.apply(c,d);function a22(l){t2(f,h,p,a22,h22,"next",l)}function h22(l){t2(f,h,p,a22,h22,"throw",l)}a22(void 0)}))}}function r2(){return r2=Object.assign?Object.assign.bind():function(l){for(var c=1;c<arguments.length;c++){var d=arguments[c];for(var h in d)({}).hasOwnProperty.call(d,h)&&(l[h]=d[h])}return l},r2.apply(null,arguments)}function i2(l,c){if(null==l)return{};var d={};for(var h in l)if({}.hasOwnProperty.call(l,h)){if(-1!==c.indexOf(h))continue;d[h]=l[h]}return d}var l,c,d=["inputs"],h=["inputId"],p=["inputs"],f=["inputId"],m=["type"],y=Object.defineProperty,c2=(l,c,d)=>{return f=d,(p="symbol"!=typeof c?c+"":c)in(h=l)?y(h,p,{enumerable:!0,configurable:!0,writable:!0,value:f}):h[p]=f;var h,p,f},_=Object.defineProperty,d2=(l,c,d)=>{return f=d,(p="symbol"!=typeof c?c+"":c)in(h=l)?_(h,p,{enumerable:!0,configurable:!0,writable:!0,value:f}):h[p]=f;var h,p,f},b=((c=b||{})[c.Document=0]="Document",c[c.DocumentType=1]="DocumentType",c[c.Element=2]="Element",c[c.Text=3]="Text",c[c.CDATA=4]="CDATA",c[c.Comment=5]="Comment",c),w={Node:["childNodes","parentNode","parentElement","textContent"],ShadowRoot:["host","styleSheets"],Element:["shadowRoot","querySelector","querySelectorAll"],MutationObserver:[]},E={Node:["contains","getRootNode"],ShadowRoot:["getSelection"],Element:[],MutationObserver:["constructor"]},M={};function w3(l){if(M[l])return M[l];var c,d,h,p,f=(c=l,((p=null==(h=null==(d=null==globalThis?void 0:globalThis.Zone)?void 0:d.__symbol__)?void 0:h.call(d,c))&&globalThis[p]?globalThis[p]:void 0)||globalThis[l]),m=f.prototype,y=l in w?w[l]:void 0,_=Boolean(y&&y.every((l=>{var c,d;return Boolean(null==(d=null==(c=Object.getOwnPropertyDescriptor(m,l))?void 0:c.get)?void 0:d.toString().includes("[native code]"))}))),b=l in E?E[l]:void 0,N=Boolean(b&&b.every((l=>{var c;return"function"==typeof m[l]&&(null==(c=m[l])?void 0:c.toString().includes("[native code]"))})));if(_&&N)return M[l]=f.prototype,f.prototype;try{var P=document.createElement("iframe");document.body.appendChild(P);var L=P.contentWindow;if(!L)return f.prototype;var j=L[l].prototype;return document.body.removeChild(P),j?M[l]=j:m}catch(c){return m}}var N={};function b3(l,c,d){var h,p=l+"."+String(d);if(N[p])return N[p].call(c);var f=w3(l),m=null==(h=Object.getOwnPropertyDescriptor(f,d))?void 0:h.get;return m?(N[p]=m,m.call(c)):c[d]}var C2_childNodes=function(l){return b3("Node",l,"childNodes")},C2_parentNode=function(l){return b3("Node",l,"parentNode")},C2_parentElement=function(l){return b3("Node",l,"parentElement")},C2_textContent=function(l){return b3("Node",l,"textContent")},C2_host=function(l){return l&&"host"in l?b3("ShadowRoot",l,"host"):null},C2_shadowRoot=function(l){return l&&"shadowRoot"in l?b3("Element",l,"shadowRoot"):null};function I2(l){return l.nodeType===l.ELEMENT_NODE}function M2(l){var c=l&&"host"in l&&"mode"in l&&C2_host(l)||null;return Boolean(c&&"shadowRoot"in c&&C2_shadowRoot(c)===l)}function R2(l){return"[object ShadowRoot]"===Object.prototype.toString.call(l)}function x2(l){try{var c=l.rules||l.cssRules;if(!c)return null;var d=l.href;return!d&&l.ownerNode&&(d=l.ownerNode.baseURI),(h=Array.from(c,(l=>_2(l,d))).join("")).includes(" background-clip: text;")&&!h.includes(" -webkit-background-clip: text;")&&(h=h.replace(/\sbackground-clip:\s*text;/g," -webkit-background-clip: text; background-clip: text;")),h}catch(p){return null}var h}function _2(l,c){var d;if("styleSheet"in l){var h;try{h=x2(l.styleSheet)||function(l){var{cssText:c}=l;if(c.split('"').length<3)return c;var d=["@import","url("+JSON.stringify(l.href)+")"];return""===l.layerName?d.push("layer"):l.layerName&&d.push("layer("+l.layerName+")"),l.supportsText&&d.push("supports("+l.supportsText+")"),l.media.length&&d.push(l.media.mediaText),d.join(" ")+";"}(l)}catch(m){h=l.cssText}try{if(h&&(null==(d=l.styleSheet)?void 0:d.href))return U2(h,l.styleSheet.href)}catch(y){}return h}var p,f=l.cssText;return function(l){return"selectorText"in l}(l)&&l.selectorText.includes(":")&&(p=/(\[(?:[\w-]+)[^\\])(:(?:[\w-]+)\])/gm,f=f.replace(p,"$1\\$2")),c?U2(f,c):f}class O2{constructor(){d2(this,"idNodeMap",new Map),d2(this,"nodeMetaMap",new WeakMap)}getId(l){var c;if(!l)return-1;var d=null==(c=this.getMeta(l))?void 0:c.id;return null!=d?d:-1}getNode(l){return this.idNodeMap.get(l)||null}getIds(){return Array.from(this.idNodeMap.keys())}getMeta(l){return this.nodeMetaMap.get(l)||null}removeNodeFromMap(l){var c=this.getId(l);this.idNodeMap.delete(c),l.childNodes&&l.childNodes.forEach((l=>this.removeNodeFromMap(l)))}has(l){return this.idNodeMap.has(l)}hasNode(l){return this.nodeMetaMap.has(l)}add(l,c){var d=c.id;this.idNodeMap.set(d,l),this.nodeMetaMap.set(l,c)}replace(l,c){var d=this.getNode(l);if(d){var h=this.nodeMetaMap.get(d);h&&this.nodeMetaMap.set(c,h)}this.idNodeMap.set(l,c)}reset(){this.idNodeMap=new Map,this.nodeMetaMap=new WeakMap}}function T2(l){var{element:c,maskInputOptions:d,tagName:h,type:p,value:f,maskInputFn:m}=l,y=f||"",_=p&&E2(p);return(d[h.toLowerCase()]||_&&d[_])&&(y=m?m(y,c):"*".repeat(y.length)),y}function E2(l){return l.toLowerCase()}var P="__rrweb_original__";function B2(l){var c=l.type;return l.hasAttribute("data-rr-is-password")?"password":c?E2(c):null}function L2(l,c){var d,h;try{h=new URL(l,null!=c?c:window.location.href)}catch(f){return null}var p=h.pathname.match(/\.([0-9a-z]+)(?:$)/i);return null!==(d=null==p?void 0:p[1])&&void 0!==d?d:null}var L=/url\((?:(')([^']*)'|(")(.*?)"|([^)]*))\)/gm,j=/^(?:[a-z+]+:)?\/\//i,D=/^www\..*/i,F=/^(data:)([^,]*),(.*)/i;function U2(l,c){return(l||"").replace(L,((l,d,h,p,f,m)=>{var y,_=h||f||m,b=d||p||"";if(!_)return l;if(j.test(_)||D.test(_))return"url("+b+_+b+")";if(F.test(_))return"url("+b+_+b+")";if("/"===_[0])return"url("+b+(((y=c).indexOf("//")>-1?y.split("/").slice(0,3).join("/"):y.split("/")[0]).split("?")[0]+_)+b+")";var w=c.split("/"),E=_.split("/");for(var M of(w.pop(),E))"."!==M&&(".."===M?w.pop():w.push(M));return"url("+b+w.join("/")+b+")"}))}var U,B,H=1,z=new RegExp("[^a-z0-9-_:]");function H3(){return H++}var q=/^[^ \t\n\r\u000c]+/,V=/^[, \t\n\r\u000c]+/,Z=new WeakMap;function X2(l,c){return c&&""!==c.trim()?Z2(l,c):c}function K3(l){return Boolean("svg"===l.tagName||l.ownerSVGElement)}function Z2(l,c){var d=Z.get(l);if(d||(d=l.createElement("a"),Z.set(l,d)),c){if(c.startsWith("blob:")||c.startsWith("data:"))return c}else c="";return d.setAttribute("href",c),d.href}function Q2(l,c,d,h){return h?"src"===d||"href"===d&&("use"!==c||"#"!==h[0])||"xlink:href"===d&&"#"!==h[0]?X2(l,h):"background"!==d||"table"!==c&&"td"!==c&&"th"!==c?"srcset"===d?function(l,c){if(""===c.trim())return c;var d=0;function i3(l){var h,p=l.exec(c.substring(d));return p?(h=p[0],d+=h.length,h):""}for(var h=[];i3(V),!(d>=c.length);){var p=i3(q);if(","===p.slice(-1))p=X2(l,p.substring(0,p.length-1)),h.push(p);else{var f="";p=X2(l,p);for(var m=!1;;){var y=c.charAt(d);if(""===y){h.push((p+f).trim());break}if(m)")"===y&&(m=!1);else{if(","===y){d+=1,h.push((p+f).trim());break}"("===y&&(m=!0)}f+=y,d+=1}}}return h.join(", ")}(l,h):"style"===d?U2(h,Z2(l)):"object"===c&&"data"===d?X2(l,h):h:X2(l,h):h}function tt2(l,c,d){return("video"===l||"audio"===l)&&"autoplay"===c}function et2(l,c,d){if(!l)return!1;if(l.nodeType!==l.ELEMENT_NODE)return!!d&&et2(C2_parentNode(l),c,d);for(var h=l.classList.length;h--;){var p=l.classList[h];if(c.test(p))return!0}return!!d&&et2(C2_parentNode(l),c,d)}function rt2(l,c,d,h){var p;if(I2(l)){if(!C2_childNodes(p=l).length)return!1}else{if(null===C2_parentElement(l))return!1;p=C2_parentElement(l)}try{if("string"==typeof c){if(h){if(p.closest("."+c))return!0}else if(p.classList.contains(c))return!0}else if(et2(p,c,h))return!0;if(d)if(h){if(p.closest(d))return!0}else if(p.matches(d))return!0}catch(f){}return!1}function nt2(l,c){return Array.from(l.styleSheets).find((l=>l.href===c))}function st2(l){return null==l?"":l.toLowerCase()}function ot2(l,c){var{doc:d,mirror:h,blockClass:p,blockSelector:f,maskTextClass:m,maskTextSelector:y,skipChild:_=!1,inlineStylesheet:w=!0,maskInputOptions:E={},maskTextFn:M,maskInputFn:N,slimDOMOptions:L,dataURLOptions:j={},inlineImages:D=!1,recordCanvas:F=!1,onSerialize:H,onIframeLoad:q,iframeLoadTimeout:V=5e3,onStylesheetLoad:Z,stylesheetLoadTimeout:K=5e3,keepIframeSrcFn:Y=()=>!1,newlyAddedElement:ee=!1}=c,{needsMask:ne}=c,{preserveWhiteSpace:se=!0}=c;ne||(ne=rt2(l,m,y,void 0===ne));var ie,oe=function(l,c){var{doc:d,mirror:h,blockClass:p,blockSelector:f,needsMask:m,inlineStylesheet:y,maskInputOptions:_={},maskTextFn:w,maskInputFn:E,dataURLOptions:M={},inlineImages:N,recordCanvas:L,keepIframeSrcFn:j,newlyAddedElement:D=!1}=c,F=function(l,c){if(c.hasNode(l)){var d=c.getId(l);return 1===d?void 0:d}}(d,h);switch(l.nodeType){case l.DOCUMENT_NODE:return"CSS1Compat"!==l.compatMode?{type:b.Document,childNodes:[],compatMode:l.compatMode}:{type:b.Document,childNodes:[]};case l.DOCUMENT_TYPE_NODE:return{type:b.DocumentType,name:l.name,publicId:l.publicId,systemId:l.systemId,rootId:F};case l.ELEMENT_NODE:return function(l,c){for(var d,{doc:h,blockClass:p,blockSelector:f,inlineStylesheet:m,maskInputOptions:y={},maskInputFn:_,dataURLOptions:w={},inlineImages:E,recordCanvas:M,keepIframeSrcFn:N,newlyAddedElement:L=!1,rootId:j}=c,D=function(l,c,d){try{if("string"==typeof c){if(l.classList.contains(c))return!0}else for(var h=l.classList.length;h--;){var p=l.classList[h];if(c.test(p))return!0}if(d)return l.matches(d)}catch(f){}return!1}(l,p,f),F=function(l){if(l instanceof HTMLFormElement)return"form";var c=E2(l.tagName);return z.test(c)?"div":c}(l),H={},q=l.attributes.length,V=0;V<q;V++){var Z=l.attributes[V];tt2(F,Z.name,Z.value)||(H[Z.name]=Q2(h,F,E2(Z.name),Z.value))}if("link"===F&&m){var K=l.href;if(K){var Y=nt2(h,K);!Y&&K.includes(".css")&&(Y=nt2(h,window.location.origin+"/"+K.replace(window.location.href,"")));var ee=null;Y&&(ee=x2(Y)),ee&&(delete H.rel,delete H.href,H._cssText=ee)}}if("style"===F&&l.sheet&&!(l.innerText||C2_textContent(l)||"").trim().length){var ne=x2(l.sheet);ne&&(H._cssText=ne)}if("input"===F||"textarea"===F||"select"===F){var se=l.value,ie=l.checked;"radio"!==H.type&&"checkbox"!==H.type&&"submit"!==H.type&&"button"!==H.type&&se?H.value=T2({element:l,type:B2(l),tagName:F,value:se,maskInputOptions:y,maskInputFn:_}):ie&&(H.checked=ie)}if("option"===F&&(l.selected&&!y.select?H.selected=!0:delete H.selected),"dialog"===F&&l.open)try{H.rr_open_mode=l.matches("dialog:modal")?"modal":"non-modal"}catch(Ne){H.rr_open_mode="modal",H.ph_rr_could_not_detect_modal=!0}if("canvas"===F&&M)if("2d"===l.__context)(function(l){var c=l.getContext("2d");if(!c)return!0;for(var d=0;d<l.width;d+=50)for(var h=0;h<l.height;h+=50){var p=c.getImageData,f=P in p?p[P]:p;if(new Uint32Array(f.call(c,d,h,Math.min(50,l.width-d),Math.min(50,l.height-h)).data.buffer).some((l=>0!==l)))return!1}return!0})(l)||(H.rr_dataURL=l.toDataURL(w.type,w.quality));else if(!("__context"in l)){var oe=l.toDataURL(w.type,w.quality),le=h.createElement("canvas");le.width=l.width,le.height=l.height,oe!==le.toDataURL(w.type,w.quality)&&(H.rr_dataURL=oe)}if("img"===F&&E){U||(U=h.createElement("canvas"),B=U.getContext("2d"));var ce=l,pe=ce.currentSrc||ce.getAttribute("src")||"<unknown-src>",fe=ce.crossOrigin,U22=()=>{ce.removeEventListener("load",U22);try{U.width=ce.naturalWidth,U.height=ce.naturalHeight,B.drawImage(ce,0,0),H.rr_dataURL=U.toDataURL(w.type,w.quality)}catch(Ne){if("anonymous"!==ce.crossOrigin)return ce.crossOrigin="anonymous",void(ce.complete&&0!==ce.naturalWidth?U22():ce.addEventListener("load",U22));console.warn("Cannot inline img src="+pe+"! Error: "+Ne)}"anonymous"===ce.crossOrigin&&(fe?H.crossOrigin=fe:ce.removeAttribute("crossorigin"))};ce.complete&&0!==ce.naturalWidth?U22():ce.addEventListener("load",U22)}if("audio"===F||"video"===F){var ge=H;ge.rr_mediaState=l.paused?"paused":"played",ge.rr_mediaCurrentTime=l.currentTime,ge.rr_mediaPlaybackRate=l.playbackRate,ge.rr_mediaMuted=l.muted,ge.rr_mediaLoop=l.loop,ge.rr_mediaVolume=l.volume}if(L||(l.scrollLeft&&(H.rr_scrollLeft=l.scrollLeft),l.scrollTop&&(H.rr_scrollTop=l.scrollTop)),D){var{width:be,height:Oe}=l.getBoundingClientRect();H={class:H.class,rr_width:be+"px",rr_height:Oe+"px"}}"iframe"!==F||N(H.src)||(l.contentDocument||(H.rr_src=H.src),delete H.src);try{customElements.get(F)&&(d=!0)}catch(Ne){}return{type:b.Element,tagName:F,attributes:H,childNodes:[],isSVG:K3(l)||void 0,needBlock:D,rootId:j,isCustom:d}}(l,{doc:d,blockClass:p,blockSelector:f,inlineStylesheet:y,maskInputOptions:_,maskInputFn:E,dataURLOptions:M,inlineImages:N,recordCanvas:L,keepIframeSrcFn:j,newlyAddedElement:D,rootId:F});case l.TEXT_NODE:return function(l,c){var d,{needsMask:h,maskTextFn:p,rootId:f}=c,m=C2_parentNode(l),y=m&&m.tagName,_=C2_textContent(l),w="STYLE"===y||void 0,E="SCRIPT"===y||void 0;if(w&&_){try{l.nextSibling||l.previousSibling||(null==(d=m.sheet)?void 0:d.cssRules)&&(_=x2(m.sheet))}catch(M){console.warn("Cannot get CSS styles from text's parentNode. Error: "+M,l)}_=U2(_,Z2(c.doc))}return E&&(_="SCRIPT_PLACEHOLDER"),!w&&!E&&_&&h&&(_=p?p(_,C2_parentElement(l)):_.replace(/[\S]/g,"*")),{type:b.Text,textContent:_||"",isStyle:w,rootId:f}}(l,{doc:d,needsMask:m,maskTextFn:w,rootId:F});case l.CDATA_SECTION_NODE:return{type:b.CDATA,textContent:"",rootId:F};case l.COMMENT_NODE:return{type:b.Comment,textContent:C2_textContent(l)||"",rootId:F};default:return!1}}(l,{doc:d,mirror:h,blockClass:p,blockSelector:f,needsMask:ne,inlineStylesheet:w,maskInputOptions:E,maskTextFn:M,maskInputFn:N,dataURLOptions:j,inlineImages:D,recordCanvas:F,keepIframeSrcFn:Y,newlyAddedElement:ee});if(!oe)return console.warn(l,"not serialized"),null;ie=h.hasNode(l)?h.getId(l):!function(l,c){if(c.comment&&l.type===b.Comment)return!0;if(l.type===b.Element){if(c.script&&("script"===l.tagName||"link"===l.tagName&&("preload"===l.attributes.rel&&"script"===l.attributes.as||"modulepreload"===l.attributes.rel)||"link"===l.tagName&&"prefetch"===l.attributes.rel&&"string"==typeof l.attributes.href&&"js"===L2(l.attributes.href)))return!0;if(c.headFavicon&&("link"===l.tagName&&"shortcut icon"===l.attributes.rel||"meta"===l.tagName&&(st2(l.attributes.name).match(/^msapplication-tile(image|color)$/)||"application-name"===st2(l.attributes.name)||"icon"===st2(l.attributes.rel)||"apple-touch-icon"===st2(l.attributes.rel)||"shortcut icon"===st2(l.attributes.rel))))return!0;if("meta"===l.tagName){if(c.headMetaDescKeywords&&st2(l.attributes.name).match(/^description|keywords$/))return!0;if(c.headMetaSocial&&(st2(l.attributes.property).match(/^(og|twitter|fb):/)||st2(l.attributes.name).match(/^(og|twitter):/)||"pinterest"===st2(l.attributes.name)))return!0;if(c.headMetaRobots&&("robots"===st2(l.attributes.name)||"googlebot"===st2(l.attributes.name)||"bingbot"===st2(l.attributes.name)))return!0;if(c.headMetaHttpEquiv&&void 0!==l.attributes["http-equiv"])return!0;if(c.headMetaAuthorship&&("author"===st2(l.attributes.name)||"generator"===st2(l.attributes.name)||"framework"===st2(l.attributes.name)||"publisher"===st2(l.attributes.name)||"progid"===st2(l.attributes.name)||st2(l.attributes.property).match(/^article:/)||st2(l.attributes.property).match(/^product:/)))return!0;if(c.headMetaVerification&&("google-site-verification"===st2(l.attributes.name)||"yandex-verification"===st2(l.attributes.name)||"csrf-token"===st2(l.attributes.name)||"p:domain_verify"===st2(l.attributes.name)||"verify-v1"===st2(l.attributes.name)||"verification"===st2(l.attributes.name)||"shopify-checkout-api-token"===st2(l.attributes.name)))return!0}}return!1}(oe,L)&&(se||oe.type!==b.Text||oe.isStyle||oe.textContent.replace(/^\s+|\s+$/gm,"").length)?H3():-2;var le=Object.assign(oe,{id:ie});if(h.add(l,le),-2===ie)return null;H&&H(l);var ce=!_;if(le.type===b.Element){ce=ce&&!le.needBlock,delete le.needBlock;var pe=C2_shadowRoot(l);pe&&R2(pe)&&(le.isShadowHost=!0)}if((le.type===b.Document||le.type===b.Element)&&ce){L.headWhitespace&&le.type===b.Element&&"head"===le.tagName&&(se=!1);var fe={doc:d,mirror:h,blockClass:p,blockSelector:f,needsMask:ne,maskTextClass:m,maskTextSelector:y,skipChild:_,inlineStylesheet:w,maskInputOptions:E,maskTextFn:M,maskInputFn:N,slimDOMOptions:L,dataURLOptions:j,inlineImages:D,recordCanvas:F,preserveWhiteSpace:se,onSerialize:H,onIframeLoad:q,iframeLoadTimeout:V,onStylesheetLoad:Z,stylesheetLoadTimeout:K,keepIframeSrcFn:Y};if(le.type===b.Element&&"textarea"===le.tagName&&void 0!==le.attributes.value);else for(var ge of Array.from(C2_childNodes(l))){var be=ot2(ge,fe);be&&le.childNodes.push(be)}var Oe=null;if(I2(l)&&(Oe=C2_shadowRoot(l)))for(var Ne of Array.from(C2_childNodes(Oe))){var De=ot2(Ne,fe);De&&(R2(Oe)&&(De.isShadow=!0),le.childNodes.push(De))}}var Fe=C2_parentNode(l);return Fe&&M2(Fe)&&R2(Fe)&&(le.isShadow=!0),le.type===b.Element&&"iframe"===le.tagName&&function(l,c,d){var h=l.contentWindow;if(h){var p,f=!1;try{p=h.document.readyState}catch(_){return}if("complete"===p){var m="about:blank";if(h.location.href!==m||l.src===m||""===l.src)return setTimeout(c,0),l.addEventListener("load",c);l.addEventListener("load",c)}else{var y=setTimeout((()=>{f||(c(),f=!0)}),d);l.addEventListener("load",(()=>{clearTimeout(y),f=!0,c()}))}}}(l,(()=>{var c=l.contentDocument;if(c&&q){var d=ot2(c,{doc:c,mirror:h,blockClass:p,blockSelector:f,needsMask:ne,maskTextClass:m,maskTextSelector:y,skipChild:!1,inlineStylesheet:w,maskInputOptions:E,maskTextFn:M,maskInputFn:N,slimDOMOptions:L,dataURLOptions:j,inlineImages:D,recordCanvas:F,preserveWhiteSpace:se,onSerialize:H,onIframeLoad:q,iframeLoadTimeout:V,onStylesheetLoad:Z,stylesheetLoadTimeout:K,keepIframeSrcFn:Y});d&&q(l,d)}}),V),le.type===b.Element&&"link"===le.tagName&&"string"==typeof le.attributes.rel&&("stylesheet"===le.attributes.rel||"preload"===le.attributes.rel&&"string"==typeof le.attributes.href&&"css"===L2(le.attributes.href))&&function(l,c,d){var h,p=!1;try{h=l.sheet}catch(m){return}if(!h){var f=setTimeout((()=>{p||(c(),p=!0)}),d);l.addEventListener("load",(()=>{clearTimeout(f),p=!0,c()}))}}(l,(()=>{if(Z){var c=ot2(l,{doc:d,mirror:h,blockClass:p,blockSelector:f,needsMask:ne,maskTextClass:m,maskTextSelector:y,skipChild:!1,inlineStylesheet:w,maskInputOptions:E,maskTextFn:M,maskInputFn:N,slimDOMOptions:L,dataURLOptions:j,inlineImages:D,recordCanvas:F,preserveWhiteSpace:se,onSerialize:H,onIframeLoad:q,iframeLoadTimeout:V,onStylesheetLoad:Z,stylesheetLoadTimeout:K,keepIframeSrcFn:Y});c&&Z(l,c)}}),K),le}var K,Y={exports:{}};var ee,ne,se,ie,oe,le,ce=function(l){if(l.__esModule)return l;var c=l.default;if("function"==typeof c){var d=function t3(){return this instanceof t3?Reflect.construct(c,arguments,this.constructor):c.apply(this,arguments)};d.prototype=c.prototype}else d={};return Object.defineProperty(d,"__esModule",{value:!0}),Object.keys(l).forEach((function(c){var h=Object.getOwnPropertyDescriptor(l,c);Object.defineProperty(d,c,h.get?h:{enumerable:!0,get:function(){return l[c]}})})),d}(Object.freeze(Object.defineProperty({__proto__:null,default:{}},Symbol.toStringTag,{value:"Module"})));function yt3(){if(ne)return ee;ne=1;var l=function(){if(K)return Y.exports;K=1;var l=String,e22=function(){return{isColorSupported:!1,reset:l,bold:l,dim:l,italic:l,underline:l,inverse:l,hidden:l,strikethrough:l,black:l,red:l,green:l,yellow:l,blue:l,magenta:l,cyan:l,white:l,gray:l,bgBlack:l,bgRed:l,bgGreen:l,bgYellow:l,bgBlue:l,bgMagenta:l,bgCyan:l,bgWhite:l,blackBright:l,redBright:l,greenBright:l,yellowBright:l,blueBright:l,magentaBright:l,cyanBright:l,whiteBright:l,bgBlackBright:l,bgRedBright:l,bgGreenBright:l,bgYellowBright:l,bgBlueBright:l,bgMagentaBright:l,bgCyanBright:l,bgWhiteBright:l}};return Y.exports=e22(),Y.exports.createColors=e22,Y.exports}(),c=ce;class r22 extends Error{constructor(l,c,d,h,p,f){super(l),this.name="CssSyntaxError",this.reason=l,p&&(this.file=p),h&&(this.source=h),f&&(this.plugin=f),void 0!==c&&void 0!==d&&("number"==typeof c?(this.line=c,this.column=d):(this.line=c.line,this.column=c.column,this.endLine=d.line,this.endColumn=d.column)),this.setMessage(),Error.captureStackTrace&&Error.captureStackTrace(this,r22)}setMessage(){this.message=this.plugin?this.plugin+": ":"",this.message+=this.file?this.file:"<css input>",void 0!==this.line&&(this.message+=":"+this.line+":"+this.column),this.message+=": "+this.reason}showSourceCode(d){if(!this.source)return"";var h=this.source;null==d&&(d=l.isColorSupported);var n22=l=>l,s22=l=>l,o22=l=>l;if(d){var{bold:p,gray:f,red:m}=l.createColors(!0);s22=l=>p(m(l)),n22=l=>f(l),c&&(o22=l=>c(l))}var y=h.split(/\r?\n/),_=Math.max(this.line-3,0),b=Math.min(this.line+2,y.length),w=String(b).length;return y.slice(_,b).map(((l,c)=>{var d=_+1+c,h=" "+(" "+d).slice(-w)+" | ";if(d===this.line){if(l.length>160){var p=Math.max(0,this.column-20),f=Math.max(this.column+20,this.endColumn+20),m=l.slice(p,f),y=n22(h.replace(/\d/g," "))+l.slice(0,Math.min(this.column-1,19)).replace(/[^\t]/g," ");return s22(">")+n22(h)+o22(m)+"\n "+y+s22("^")}var b=n22(h.replace(/\d/g," "))+l.slice(0,this.column-1).replace(/[^\t]/g," ");return s22(">")+n22(h)+o22(l)+"\n "+b+s22("^")}return" "+n22(h)+o22(l)})).join("\n")}toString(){var l=this.showSourceCode();return l&&(l="\n\n"+l+"\n"),this.name+": "+this.message+l}}return ee=r22,r22.default=r22,ee}function bt2(){if(ie)return se;ie=1;var l={after:"\n",beforeClose:"\n",beforeComment:"\n",beforeDecl:"\n",beforeOpen:" ",beforeRule:"\n",colon:": ",commentLeft:" ",commentRight:" ",emptyBody:"",indent:"    ",semicolon:!1};class e22{constructor(l){this.builder=l}atrule(l,c){var d="@"+l.name,h=l.params?this.rawValue(l,"params"):"";if(void 0!==l.raws.afterName?d+=l.raws.afterName:h&&(d+=" "),l.nodes)this.block(l,d+h);else{var p=(l.raws.between||"")+(c?";":"");this.builder(d+h+p,l)}}beforeAfter(l,c){var d;d="decl"===l.type?this.raw(l,null,"beforeDecl"):"comment"===l.type?this.raw(l,null,"beforeComment"):"before"===c?this.raw(l,null,"beforeRule"):this.raw(l,null,"beforeClose");for(var h=l.parent,p=0;h&&"root"!==h.type;)p+=1,h=h.parent;if(d.includes("\n")){var f=this.raw(l,null,"indent");if(f.length)for(var m=0;m<p;m++)d+=f}return d}block(l,c){var d,h=this.raw(l,"between","beforeOpen");this.builder(c+h+"{",l,"start"),l.nodes&&l.nodes.length?(this.body(l),d=this.raw(l,"after")):d=this.raw(l,"after","emptyBody"),d&&this.builder(d),this.builder("}",l,"end")}body(l){for(var c=l.nodes.length-1;c>0&&"comment"===l.nodes[c].type;)c-=1;for(var d=this.raw(l,"semicolon"),h=0;h<l.nodes.length;h++){var p=l.nodes[h],f=this.raw(p,"before");f&&this.builder(f),this.stringify(p,c!==h||d)}}comment(l){var c=this.raw(l,"left","commentLeft"),d=this.raw(l,"right","commentRight");this.builder("/*"+c+l.text+d+"*/",l)}decl(l,c){var d=this.raw(l,"between","colon"),h=l.prop+d+this.rawValue(l,"value");l.important&&(h+=l.raws.important||" !important"),c&&(h+=";"),this.builder(h,l)}document(l){this.body(l)}raw(c,d,h){var p;if(h||(h=d),d&&void 0!==(p=c.raws[d]))return p;var f=c.parent;if("before"===h){if(!f||"root"===f.type&&f.first===c)return"";if(f&&"document"===f.type)return""}if(!f)return l[h];var m=c.root();if(m.rawCache||(m.rawCache={}),void 0!==m.rawCache[h])return m.rawCache[h];if("before"===h||"after"===h)return this.beforeAfter(c,h);var y,_="raw"+((y=h)[0].toUpperCase()+y.slice(1));return this[_]?p=this[_](m,c):m.walk((l=>{if(void 0!==(p=l.raws[d]))return!1})),void 0===p&&(p=l[h]),m.rawCache[h]=p,p}rawBeforeClose(l){var c;return l.walk((l=>{if(l.nodes&&l.nodes.length>0&&void 0!==l.raws.after)return(c=l.raws.after).includes("\n")&&(c=c.replace(/[^\n]+$/,"")),!1})),c&&(c=c.replace(/\S/g,"")),c}rawBeforeComment(l,c){var d;return l.walkComments((l=>{if(void 0!==l.raws.before)return(d=l.raws.before).includes("\n")&&(d=d.replace(/[^\n]+$/,"")),!1})),void 0===d?d=this.raw(c,null,"beforeDecl"):d&&(d=d.replace(/\S/g,"")),d}rawBeforeDecl(l,c){var d;return l.walkDecls((l=>{if(void 0!==l.raws.before)return(d=l.raws.before).includes("\n")&&(d=d.replace(/[^\n]+$/,"")),!1})),void 0===d?d=this.raw(c,null,"beforeRule"):d&&(d=d.replace(/\S/g,"")),d}rawBeforeOpen(l){var c;return l.walk((l=>{if("decl"!==l.type&&void 0!==(c=l.raws.between))return!1})),c}rawBeforeRule(l){var c;return l.walk((d=>{if(d.nodes&&(d.parent!==l||l.first!==d)&&void 0!==d.raws.before)return(c=d.raws.before).includes("\n")&&(c=c.replace(/[^\n]+$/,"")),!1})),c&&(c=c.replace(/\S/g,"")),c}rawColon(l){var c;return l.walkDecls((l=>{if(void 0!==l.raws.between)return c=l.raws.between.replace(/[^\s:]/g,""),!1})),c}rawEmptyBody(l){var c;return l.walk((l=>{if(l.nodes&&0===l.nodes.length&&void 0!==(c=l.raws.after))return!1})),c}rawIndent(l){return l.raws.indent?l.raws.indent:(l.walk((d=>{var h=d.parent;if(h&&h!==l&&h.parent&&h.parent===l&&void 0!==d.raws.before){var p=d.raws.before.split("\n");return c=(c=p[p.length-1]).replace(/\S/g,""),!1}})),c);var c}rawSemicolon(l){var c;return l.walk((l=>{if(l.nodes&&l.nodes.length&&"decl"===l.last.type&&void 0!==(c=l.raws.semicolon))return!1})),c}rawValue(l,c){var d=l[c],h=l.raws[c];return h&&h.value===d?h.raw:d}root(l){this.body(l),l.raws.after&&this.builder(l.raws.after)}rule(l){this.block(l,this.rawValue(l,"selector")),l.raws.ownSemicolon&&this.builder(l.raws.ownSemicolon,l,"end")}stringify(l,c){if(!this[l.type])throw new Error("Unknown AST node type "+l.type+". Maybe you need to change PostCSS stringifier.");this[l.type](l,c)}}return se=e22,e22.default=e22,se}function St2(){if(le)return oe;le=1;var l=bt2();function e22(c,d){new l(d).stringify(c)}return oe=e22,e22.default=e22,oe}var pe,fe,ge,be,Oe,Ne,De,Fe,Ue,Be,He,qe,Ve,Je,tt,nt,it,ht,ft,gt,yt,_t,bt,wt,St,xt,kt,Et,It,Tt,At,Ot,Mt,Nt,Pt,Lt,jt,Dt,Ft,Bt,Ht,Wt,Vt,Zt,Gt,Kt,Yt,Qt,er,tr,rr,sr={};function ke2(){return pe||(pe=1,sr.isClean=Symbol("isClean"),sr.my=Symbol("my")),sr}function Ce2(){if(ge)return fe;ge=1;var l=yt3(),c=bt2(),d=St2(),{isClean:h,my:p}=ke2();function s22(l,c){var d=new l.constructor;for(var h in l)if(Object.prototype.hasOwnProperty.call(l,h)&&"proxyCache"!==h){var p=l[h],f=typeof p;"parent"===h&&"object"===f?c&&(d[h]=c):"source"===h?d[h]=p:Array.isArray(p)?d[h]=p.map((l=>s22(l,d))):("object"===f&&null!==p&&(p=s22(p)),d[h]=p)}return d}function o22(l,c){if(c&&void 0!==c.offset)return c.offset;for(var d=1,h=1,p=0,f=0;f<l.length;f++){if(h===c.line&&d===c.column){p=f;break}"\n"===l[f]?(d=1,h+=1):d+=1}return p}class a22{constructor(l){for(var c in void 0===l&&(l={}),this.raws={},this[h]=!1,this[p]=!0,l)if("nodes"===c)for(var d of(this.nodes=[],l[c]))"function"==typeof d.clone?this.append(d.clone()):this.append(d);else this[c]=l[c]}addToError(l){if(l.postcssNode=this,l.stack&&this.source&&/\n\s{4}at /.test(l.stack)){var c=this.source;l.stack=l.stack.replace(/\n\s{4}at /,"$&"+c.input.from+":"+c.start.line+":"+c.start.column+"$&")}return l}after(l){return this.parent.insertAfter(this,l),this}assign(l){for(var c in void 0===l&&(l={}),l)this[c]=l[c];return this}before(l){return this.parent.insertBefore(this,l),this}cleanRaws(l){delete this.raws.before,delete this.raws.after,l||delete this.raws.between}clone(l){void 0===l&&(l={});var c=s22(this);for(var d in l)c[d]=l[d];return c}cloneAfter(l){void 0===l&&(l={});var c=this.clone(l);return this.parent.insertAfter(this,c),c}cloneBefore(l){void 0===l&&(l={});var c=this.clone(l);return this.parent.insertBefore(this,c),c}error(c,d){if(void 0===d&&(d={}),this.source){var{end:h,start:p}=this.rangeBy(d);return this.source.input.error(c,{column:p.column,line:p.line},{column:h.column,line:h.line},d)}return new l(c)}getProxyProcessor(){return{get:(l,c)=>"proxyOf"===c?l:"root"===c?()=>l.root().toProxy():l[c],set:(l,c,d)=>(l[c]===d||(l[c]=d,"prop"!==c&&"value"!==c&&"name"!==c&&"params"!==c&&"important"!==c&&"text"!==c||l.markDirty()),!0)}}markClean(){this[h]=!0}markDirty(){if(this[h]){this[h]=!1;for(var l=this;l=l.parent;)l[h]=!1}}next(){if(this.parent){var l=this.parent.index(this);return this.parent.nodes[l+1]}}positionBy(l){var c=this.source.start;if(l.index)c=this.positionInside(l.index);else if(l.word){var d="document"in this.source.input?this.source.input.document:this.source.input.css,h=d.slice(o22(d,this.source.start),o22(d,this.source.end)).indexOf(l.word);-1!==h&&(c=this.positionInside(h))}return c}positionInside(l){for(var c=this.source.start.column,d=this.source.start.line,h=("document"in this.source.input?this.source.input.document:this.source.input.css),p=o22(h,this.source.start),f=p+l,m=p;m<f;m++)"\n"===h[m]?(c=1,d+=1):c+=1;return{column:c,line:d}}prev(){if(this.parent){var l=this.parent.index(this);return this.parent.nodes[l-1]}}rangeBy(l){var c={column:this.source.start.column,line:this.source.start.line},d=this.source.end?{column:this.source.end.column+1,line:this.source.end.line}:{column:c.column+1,line:c.line};if(l.word){var h="document"in this.source.input?this.source.input.document:this.source.input.css,p=h.slice(o22(h,this.source.start),o22(h,this.source.end)).indexOf(l.word);-1!==p&&(c=this.positionInside(p),d=this.positionInside(p+l.word.length))}else l.start?c={column:l.start.column,line:l.start.line}:l.index&&(c=this.positionInside(l.index)),l.end?d={column:l.end.column,line:l.end.line}:"number"==typeof l.endIndex?d=this.positionInside(l.endIndex):l.index&&(d=this.positionInside(l.index+1));return(d.line<c.line||d.line===c.line&&d.column<=c.column)&&(d={column:c.column+1,line:c.line}),{end:d,start:c}}raw(l,d){return(new c).raw(this,l,d)}remove(){return this.parent&&this.parent.removeChild(this),this.parent=void 0,this}replaceWith(){if(this.parent){for(var l=this,c=!1,d=arguments.length,h=new Array(d),p=0;p<d;p++)h[p]=arguments[p];for(var f of h)f===this?c=!0:c?(this.parent.insertAfter(l,f),l=f):this.parent.insertBefore(l,f);c||this.remove()}return this}root(){for(var l=this;l.parent&&"document"!==l.parent.type;)l=l.parent;return l}toJSON(l,c){var d={},h=null==c;c=c||new Map;var p=0;for(var f in this)if(Object.prototype.hasOwnProperty.call(this,f)&&"parent"!==f&&"proxyCache"!==f){var m=this[f];if(Array.isArray(m))d[f]=m.map((l=>"object"==typeof l&&l.toJSON?l.toJSON(null,c):l));else if("object"==typeof m&&m.toJSON)d[f]=m.toJSON(null,c);else if("source"===f){var y=c.get(m.input);null==y&&(y=p,c.set(m.input,p),p++),d[f]={end:m.end,inputId:y,start:m.start}}else d[f]=m}return h&&(d.inputs=[...c.keys()].map((l=>l.toJSON()))),d}toProxy(){return this.proxyCache||(this.proxyCache=new Proxy(this,this.getProxyProcessor())),this.proxyCache}toString(l){void 0===l&&(l=d),l.stringify&&(l=l.stringify);var c="";return l(this,(l=>{c+=l})),c}warn(l,c,d){var h={node:this};for(var p in d)h[p]=d[p];return l.warn(c,h)}get proxyOf(){return this}}return fe=a22,a22.default=a22,fe}function Ie2(){if(Oe)return be;Oe=1;var l=Ce2();class e22 extends l{constructor(l){super(l),this.type="comment"}}return be=e22,e22.default=e22,be}function Me2(){if(De)return Ne;De=1;var l=Ce2();class e22 extends l{constructor(l){l&&void 0!==l.value&&"string"!=typeof l.value&&(l=r2({},l,{value:String(l.value)})),super(l),this.type="decl"}get variable(){return this.prop.startsWith("--")||"$"===this.prop[0]}}return Ne=e22,e22.default=e22,Ne}function Re2(){if(Ue)return Fe;Ue=1;var l,c,d,h,p=Ie2(),f=Me2(),m=Ce2(),{isClean:y,my:_}=ke2();function u22(l){return l.map((l=>(l.nodes&&(l.nodes=u22(l.nodes)),delete l.source,l)))}function l22(l){if(l[y]=!1,l.proxyOf.nodes)for(var c of l.proxyOf.nodes)l22(c)}class c22 extends m{append(){for(var l=arguments.length,c=new Array(l),d=0;d<l;d++)c[d]=arguments[d];for(var h of c){var p=this.normalize(h,this.last);for(var f of p)this.proxyOf.nodes.push(f)}return this.markDirty(),this}cleanRaws(l){if(super.cleanRaws(l),this.nodes)for(var c of this.nodes)c.cleanRaws(l)}each(l){if(this.proxyOf.nodes){for(var c,d,h=this.getIterator();this.indexes[h]<this.proxyOf.nodes.length&&(c=this.indexes[h],!1!==(d=l(this.proxyOf.nodes[c],c)));)this.indexes[h]+=1;return delete this.indexes[h],d}}every(l){return this.nodes.every(l)}getIterator(){this.lastEach||(this.lastEach=0),this.indexes||(this.indexes={}),this.lastEach+=1;var l=this.lastEach;return this.indexes[l]=0,l}getProxyProcessor(){return{get:(l,c)=>"proxyOf"===c?l:l[c]?"each"===c||"string"==typeof c&&c.startsWith("walk")?function(){for(var d=arguments.length,h=new Array(d),p=0;p<d;p++)h[p]=arguments[p];return l[c](...h.map((l=>"function"==typeof l?(c,d)=>l(c.toProxy(),d):l)))}:"every"===c||"some"===c?d=>l[c]((function(l){for(var c=arguments.length,h=new Array(c>1?c-1:0),p=1;p<c;p++)h[p-1]=arguments[p];return d(l.toProxy(),...h)})):"root"===c?()=>l.root().toProxy():"nodes"===c?l.nodes.map((l=>l.toProxy())):"first"===c||"last"===c?l[c].toProxy():l[c]:l[c],set:(l,c,d)=>(l[c]===d||(l[c]=d,"name"!==c&&"params"!==c&&"selector"!==c||l.markDirty()),!0)}}index(l){return"number"==typeof l?l:(l.proxyOf&&(l=l.proxyOf),this.proxyOf.nodes.indexOf(l))}insertAfter(l,c){var d,h=this.index(l),p=this.normalize(c,this.proxyOf.nodes[h]).reverse();for(var f of(h=this.index(l),p))this.proxyOf.nodes.splice(h+1,0,f);for(var m in this.indexes)h<(d=this.indexes[m])&&(this.indexes[m]=d+p.length);return this.markDirty(),this}insertBefore(l,c){var d,h=this.index(l),p=0===h&&"prepend",f=this.normalize(c,this.proxyOf.nodes[h],p).reverse();for(var m of(h=this.index(l),f))this.proxyOf.nodes.splice(h,0,m);for(var y in this.indexes)h<=(d=this.indexes[y])&&(this.indexes[y]=d+f.length);return this.markDirty(),this}normalize(d,m){if("string"==typeof d)d=u22(c(d).nodes);else if(void 0===d)d=[];else if(Array.isArray(d))for(var b of d=d.slice(0))b.parent&&b.parent.removeChild(b,"ignore");else if("root"===d.type&&"document"!==this.type)for(var w of d=d.nodes.slice(0))w.parent&&w.parent.removeChild(w,"ignore");else if(d.type)d=[d];else if(d.prop){if(void 0===d.value)throw new Error("Value field is missed in node creation");"string"!=typeof d.value&&(d.value=String(d.value)),d=[new f(d)]}else if(d.selector||d.selectors)d=[new h(d)];else if(d.name)d=[new l(d)];else{if(!d.text)throw new Error("Unknown node type in node creation");d=[new p(d)]}return d.map((l=>(l[_]||c22.rebuild(l),(l=l.proxyOf).parent&&l.parent.removeChild(l),l[y]&&l22(l),l.raws||(l.raws={}),void 0===l.raws.before&&m&&void 0!==m.raws.before&&(l.raws.before=m.raws.before.replace(/\S/g,"")),l.parent=this.proxyOf,l)))}prepend(){for(var l=arguments.length,c=new Array(l),d=0;d<l;d++)c[d]=arguments[d];for(var h of c=c.reverse()){var p=this.normalize(h,this.first,"prepend").reverse();for(var f of p)this.proxyOf.nodes.unshift(f);for(var m in this.indexes)this.indexes[m]=this.indexes[m]+p.length}return this.markDirty(),this}push(l){return l.parent=this,this.proxyOf.nodes.push(l),this}removeAll(){for(var l of this.proxyOf.nodes)l.parent=void 0;return this.proxyOf.nodes=[],this.markDirty(),this}removeChild(l){var c;for(var d in l=this.index(l),this.proxyOf.nodes[l].parent=void 0,this.proxyOf.nodes.splice(l,1),this.indexes)(c=this.indexes[d])>=l&&(this.indexes[d]=c-1);return this.markDirty(),this}replaceValues(l,c,d){return d||(d=c,c={}),this.walkDecls((h=>{c.props&&!c.props.includes(h.prop)||c.fast&&!h.value.includes(c.fast)||(h.value=h.value.replace(l,d))})),this.markDirty(),this}some(l){return this.nodes.some(l)}walk(l){return this.each(((c,d)=>{var h;try{h=l(c,d)}catch(p){throw c.addToError(p)}return!1!==h&&c.walk&&(h=c.walk(l)),h}))}walkAtRules(l,c){return c?l instanceof RegExp?this.walk(((d,h)=>{if("atrule"===d.type&&l.test(d.name))return c(d,h)})):this.walk(((d,h)=>{if("atrule"===d.type&&d.name===l)return c(d,h)})):(c=l,this.walk(((l,d)=>{if("atrule"===l.type)return c(l,d)})))}walkComments(l){return this.walk(((c,d)=>{if("comment"===c.type)return l(c,d)}))}walkDecls(l,c){return c?l instanceof RegExp?this.walk(((d,h)=>{if("decl"===d.type&&l.test(d.prop))return c(d,h)})):this.walk(((d,h)=>{if("decl"===d.type&&d.prop===l)return c(d,h)})):(c=l,this.walk(((l,d)=>{if("decl"===l.type)return c(l,d)})))}walkRules(l,c){return c?l instanceof RegExp?this.walk(((d,h)=>{if("rule"===d.type&&l.test(d.selector))return c(d,h)})):this.walk(((d,h)=>{if("rule"===d.type&&d.selector===l)return c(d,h)})):(c=l,this.walk(((l,d)=>{if("rule"===l.type)return c(l,d)})))}get first(){if(this.proxyOf.nodes)return this.proxyOf.nodes[0]}get last(){if(this.proxyOf.nodes)return this.proxyOf.nodes[this.proxyOf.nodes.length-1]}}return c22.registerParse=l=>{c=l},c22.registerRule=l=>{h=l},c22.registerAtRule=c=>{l=c},c22.registerRoot=l=>{d=l},Fe=c22,c22.default=c22,c22.rebuild=c=>{"atrule"===c.type?Object.setPrototypeOf(c,l.prototype):"rule"===c.type?Object.setPrototypeOf(c,h.prototype):"decl"===c.type?Object.setPrototypeOf(c,f.prototype):"comment"===c.type?Object.setPrototypeOf(c,p.prototype):"root"===c.type&&Object.setPrototypeOf(c,d.prototype),c[_]=!0,c.nodes&&c.nodes.forEach((l=>{c22.rebuild(l)}))},Fe}function xe2(){if(He)return Be;He=1;var l=Re2();class e22 extends l{constructor(l){super(l),this.type="atrule"}append(){return this.proxyOf.nodes||(this.nodes=[]),super.append(...arguments)}prepend(){return this.proxyOf.nodes||(this.nodes=[]),super.prepend(...arguments)}}return Be=e22,e22.default=e22,l.registerAtRule(e22),Be}function _e3(){if(Ve)return qe;Ve=1;var l,c,d=Re2();class n22 extends d{constructor(l){super(r2({type:"document"},l)),this.nodes||(this.nodes=[])}toResult(d){return void 0===d&&(d={}),new l(new c,this,d).stringify()}}return n22.registerLazyResult=c=>{l=c},n22.registerProcessor=l=>{c=l},qe=n22,n22.default=n22,qe}function Te2(){if(it)return nt;it=1;var{existsSync:l,readFileSync:c}=ce,{dirname:d,join:h}=ce,{SourceMapConsumer:p,SourceMapGenerator:f}=ce;class o22{constructor(l,c){if(!1!==c.map){this.loadAnnotation(l),this.inline=this.startWith(this.annotation,"data:");var h=c.map?c.map.prev:void 0,p=this.loadMap(c.from,h);!this.mapFile&&c.from&&(this.mapFile=c.from),this.mapFile&&(this.root=d(this.mapFile)),p&&(this.text=p)}}consumer(){return this.consumerCache||(this.consumerCache=new p(this.text)),this.consumerCache}decodeInline(l){var c=l.match(/^data:application\/json;charset=utf-?8,/)||l.match(/^data:application\/json,/);if(c)return decodeURIComponent(l.substr(c[0].length));var d,h=l.match(/^data:application\/json;charset=utf-?8;base64,/)||l.match(/^data:application\/json;base64,/);if(h)return d=l.substr(h[0].length),Buffer?Buffer.from(d,"base64").toString():window.atob(d);var p=l.match(/data:application\/json;([^,]+),/)[1];throw new Error("Unsupported source map encoding "+p)}getAnnotationURL(l){return l.replace(/^\/\*\s*# sourceMappingURL=/,"").trim()}isMap(l){return"object"==typeof l&&("string"==typeof l.mappings||"string"==typeof l._mappings||Array.isArray(l.sections))}loadAnnotation(l){var c=l.match(/\/\*\s*# sourceMappingURL=/g);if(c){var d=l.lastIndexOf(c.pop()),h=l.indexOf("*/",d);d>-1&&h>-1&&(this.annotation=this.getAnnotationURL(l.substring(d,h)))}}loadFile(h){if(this.root=d(h),l(h))return this.mapFile=h,c(h,"utf-8").toString().trim()}loadMap(l,c){if(!1===c)return!1;if(c){if("string"==typeof c)return c;if("function"!=typeof c){if(c instanceof p)return f.fromSourceMap(c).toString();if(c instanceof f)return c.toString();if(this.isMap(c))return JSON.stringify(c);throw new Error("Unsupported previous source map format: "+c.toString())}var m=c(l);if(m){var y=this.loadFile(m);if(!y)throw new Error("Unable to load previous source map: "+m.toString());return y}}else{if(this.inline)return this.decodeInline(this.annotation);if(this.annotation){var _=this.annotation;return l&&(_=h(d(l),_)),this.loadFile(_)}}}startWith(l,c){return!!l&&l.substr(0,c.length)===c}withContent(){return!!(this.consumer().sourcesContent&&this.consumer().sourcesContent.length>0)}}return nt=o22,o22.default=o22,nt}function Ee2(){if(ft)return ht;ft=1;var{nanoid:l}=tt?Je:(tt=1,Je={nanoid:function(l){void 0===l&&(l=21);for(var c="",d=0|l;d--;)c+="useandom-26T198340PX75pxJACKVERYMINDBUSHWOLF_GQZbfghjklqvwyzrict"[64*Math.random()|0];return c},customAlphabet:function(l,c){return void 0===c&&(c=21),function(d){void 0===d&&(d=c);for(var h="",p=0|d;p--;)h+=l[Math.random()*l.length|0];return h}}}),{isAbsolute:c,resolve:d}=ce,{SourceMapConsumer:h,SourceMapGenerator:p}=ce,{fileURLToPath:f,pathToFileURL:m}=ce,y=yt3(),_=Te2(),b=ce,w=Symbol("fromOffsetCache"),E=Boolean(h&&p),M=Boolean(d&&c);class v22{constructor(h,p){if(void 0===p&&(p={}),null==h||"object"==typeof h&&!h.toString)throw new Error("PostCSS received "+h+" instead of CSS string");if(this.css=h.toString(),"\ufeff"===this.css[0]||"\ufffe"===this.css[0]?(this.hasBOM=!0,this.css=this.css.slice(1)):this.hasBOM=!1,this.document=this.css,p.document&&(this.document=p.document.toString()),p.from&&(!M||/^\w+:\/\//.test(p.from)||c(p.from)?this.file=p.from:this.file=d(p.from)),M&&E){var f=new _(this.css,p);if(f.text){this.map=f;var m=f.consumer().file;!this.file&&m&&(this.file=this.mapResolve(m))}}this.file||(this.id="<input css "+l(6)+">"),this.map&&(this.map.file=this.from)}error(l,c,d,h){var p,f,_;if(void 0===h&&(h={}),c&&"object"==typeof c){var b=c,w=d;if("number"==typeof b.offset){var E=this.fromOffset(b.offset);c=E.line,d=E.col}else c=b.line,d=b.column;if("number"==typeof w.offset){var M=this.fromOffset(w.offset);f=M.line,p=M.col}else f=w.line,p=w.column}else if(!d){var N=this.fromOffset(c);c=N.line,d=N.col}var P=this.origin(c,d,f,p);return(_=P?new y(l,void 0===P.endLine?P.line:{column:P.column,line:P.line},void 0===P.endLine?P.column:{column:P.endColumn,line:P.endLine},P.source,P.file,h.plugin):new y(l,void 0===f?c:{column:d,line:c},void 0===f?d:{column:p,line:f},this.css,this.file,h.plugin)).input={column:d,endColumn:p,endLine:f,line:c,source:this.css},this.file&&(m&&(_.input.url=m(this.file).toString()),_.input.file=this.file),_}fromOffset(l){var c;if(this[w])c=this[w];else{var d=this.css.split("\n");c=new Array(d.length);for(var h=0,p=0,f=d.length;p<f;p++)c[p]=h,h+=d[p].length+1;this[w]=c}var m=0;if(l>=c[c.length-1])m=c.length-1;else for(var y,_=c.length-2;m<_;)if(l<c[y=m+(_-m>>1)])_=y-1;else{if(!(l>=c[y+1])){m=y;break}m=y+1}return{col:l-c[m]+1,line:m+1}}mapResolve(l){return/^\w+:\/\//.test(l)?l:d(this.map.consumer().sourceRoot||this.map.root||".",l)}origin(l,d,h,p){if(!this.map)return!1;var y,_,b=this.map.consumer(),w=b.originalPositionFor({column:d,line:l});if(!w.source)return!1;"number"==typeof h&&(y=b.originalPositionFor({column:p,line:h})),_=c(w.source)?m(w.source):new URL(w.source,this.map.consumer().sourceRoot||m(this.map.mapFile));var E={column:w.column,endColumn:y&&y.column,endLine:y&&y.line,line:w.line,url:_.toString()};if("file:"===_.protocol){if(!f)throw new Error("file: protocol is not available in this PostCSS build");E.file=f(_)}var M=b.sourceContentFor(w.source);return M&&(E.source=M),E}toJSON(){var l={};for(var c of["hasBOM","css","file","id"])null!=this[c]&&(l[c]=this[c]);return this.map&&(l.map=r2({},this.map),l.map.consumerCache&&(l.map.consumerCache=void 0)),l}get from(){return this.file||this.id}}return ht=v22,v22.default=v22,b&&b.registerInput&&b.registerInput(v22),ht}function Ae2(){if(yt)return gt;yt=1;var l,c,d=Re2();class i22 extends d{constructor(l){super(l),this.type="root",this.nodes||(this.nodes=[])}normalize(l,c,d){var h=super.normalize(l);if(c)if("prepend"===d)this.nodes.length>1?c.raws.before=this.nodes[1].raws.before:delete c.raws.before;else if(this.first!==c)for(var p of h)p.raws.before=c.raws.before;return h}removeChild(l,c){var d=this.index(l);return!c&&0===d&&this.nodes.length>1&&(this.nodes[1].raws.before=this.nodes[d].raws.before),super.removeChild(l)}toResult(d){return void 0===d&&(d={}),new l(new c,this,d).stringify()}}return i22.registerLazyResult=c=>{l=c},i22.registerProcessor=l=>{c=l},gt=i22,i22.default=i22,d.registerRoot(i22),gt}function Be2(){if(bt)return _t;bt=1;var l={comma:c=>l.split(c,[","],!0),space:c=>l.split(c,[" ","\n","\t"]),split(l,c,d){var h=[],p="",f=!1,m=0,y=!1,_="",b=!1;for(var w of l)b?b=!1:"\\"===w?b=!0:y?w===_&&(y=!1):'"'===w||"'"===w?(y=!0,_=w):"("===w?m+=1:")"===w?m>0&&(m-=1):0===m&&c.includes(w)&&(f=!0),f?(""!==p&&h.push(p.trim()),p="",f=!1):p+=w;return(d||""!==p)&&h.push(p.trim()),h}};return _t=l,l.default=l,_t}function Le2(){if(St)return wt;St=1;var l=Re2(),c=Be2();class r22 extends l{constructor(l){super(l),this.type="rule",this.nodes||(this.nodes=[])}get selectors(){return c.comma(this.selector)}set selectors(l){var c=this.selector?this.selector.match(/,\s*/):null,d=c?c[0]:","+this.raw("between","beforeOpen");this.selector=l.join(d)}}return wt=r22,r22.default=r22,l.registerRule(r22),wt}function Fe2(){if(It)return Et;It=1;var{dirname:l,relative:c,resolve:d,sep:h}=ce,{SourceMapConsumer:p,SourceMapGenerator:f}=ce,{pathToFileURL:m}=ce,y=Ee2(),_=Boolean(p&&f),b=Boolean(l&&d&&c&&h);return Et=class{constructor(l,c,d,h){this.stringify=l,this.mapOpts=d.map||{},this.root=c,this.opts=d,this.css=h,this.originalCSS=h,this.usesFileUrls=!this.mapOpts.from&&this.mapOpts.absolute,this.memoizedFileURLs=new Map,this.memoizedPaths=new Map,this.memoizedURLs=new Map}addAnnotation(){var l;l=this.isInline()?"data:application/json;base64,"+this.toBase64(this.map.toString()):"string"==typeof this.mapOpts.annotation?this.mapOpts.annotation:"function"==typeof this.mapOpts.annotation?this.mapOpts.annotation(this.opts.to,this.root):this.outputFile()+".map";var c="\n";this.css.includes("\r\n")&&(c="\r\n"),this.css+=c+"/*# sourceMappingURL="+l+" */"}applyPrevMaps(){for(var c of this.previous()){var d=this.toUrl(this.path(c.file)),h=c.root||l(c.file),f=void 0;!1===this.mapOpts.sourcesContent?(f=new p(c.text)).sourcesContent&&(f.sourcesContent=null):f=c.consumer(),this.map.applySourceMap(f,d,this.toUrl(this.path(h)))}}clearAnnotation(){if(!1!==this.mapOpts.annotation)if(this.root)for(var l,c=this.root.nodes.length-1;c>=0;c--)"comment"===(l=this.root.nodes[c]).type&&l.text.startsWith("# sourceMappingURL=")&&this.root.removeChild(c);else this.css&&(this.css=this.css.replace(/\n*\/\*#[\S\s]*?\*\/$/gm,""))}generate(){if(this.clearAnnotation(),b&&_&&this.isMap())return this.generateMap();var l="";return this.stringify(this.root,(c=>{l+=c})),[l]}generateMap(){if(this.root)this.generateString();else if(1===this.previous().length){var l=this.previous()[0].consumer();l.file=this.outputFile(),this.map=f.fromSourceMap(l,{ignoreInvalidMapping:!0})}else this.map=new f({file:this.outputFile(),ignoreInvalidMapping:!0}),this.map.addMapping({generated:{column:0,line:1},original:{column:0,line:1},source:this.opts.from?this.toUrl(this.path(this.opts.from)):"<no source>"});return this.isSourcesContent()&&this.setSourcesContent(),this.root&&this.previous().length>0&&this.applyPrevMaps(),this.isAnnotation()&&this.addAnnotation(),this.isInline()?[this.css]:[this.css,this.map]}generateString(){this.css="",this.map=new f({file:this.outputFile(),ignoreInvalidMapping:!0});var l,c,d=1,h=1,p="<no source>",m={generated:{column:0,line:0},original:{column:0,line:0},source:""};this.stringify(this.root,((f,y,_)=>{if(this.css+=f,y&&"end"!==_&&(m.generated.line=d,m.generated.column=h-1,y.source&&y.source.start?(m.source=this.sourcePath(y),m.original.line=y.source.start.line,m.original.column=y.source.start.column-1,this.map.addMapping(m)):(m.source=p,m.original.line=1,m.original.column=0,this.map.addMapping(m))),(c=f.match(/\n/g))?(d+=c.length,l=f.lastIndexOf("\n"),h=f.length-l):h+=f.length,y&&"start"!==_){var b=y.parent||{raws:{}};("decl"===y.type||"atrule"===y.type&&!y.nodes)&&y===b.last&&!b.raws.semicolon||(y.source&&y.source.end?(m.source=this.sourcePath(y),m.original.line=y.source.end.line,m.original.column=y.source.end.column-1,m.generated.line=d,m.generated.column=h-2,this.map.addMapping(m)):(m.source=p,m.original.line=1,m.original.column=0,m.generated.line=d,m.generated.column=h-1,this.map.addMapping(m)))}}))}isAnnotation(){return!!this.isInline()||(void 0!==this.mapOpts.annotation?this.mapOpts.annotation:!this.previous().length||this.previous().some((l=>l.annotation)))}isInline(){if(void 0!==this.mapOpts.inline)return this.mapOpts.inline;var l=this.mapOpts.annotation;return(void 0===l||!0===l)&&(!this.previous().length||this.previous().some((l=>l.inline)))}isMap(){return void 0!==this.opts.map?!!this.opts.map:this.previous().length>0}isSourcesContent(){return void 0!==this.mapOpts.sourcesContent?this.mapOpts.sourcesContent:!this.previous().length||this.previous().some((l=>l.withContent()))}outputFile(){return this.opts.to?this.path(this.opts.to):this.opts.from?this.path(this.opts.from):"to.css"}path(h){if(this.mapOpts.absolute)return h;if(60===h.charCodeAt(0))return h;if(/^\w+:\/\//.test(h))return h;var p=this.memoizedPaths.get(h);if(p)return p;var f=this.opts.to?l(this.opts.to):".";"string"==typeof this.mapOpts.annotation&&(f=l(d(f,this.mapOpts.annotation)));var m=c(f,h);return this.memoizedPaths.set(h,m),m}previous(){if(!this.previousMaps)if(this.previousMaps=[],this.root)this.root.walk((l=>{if(l.source&&l.source.input.map){var c=l.source.input.map;this.previousMaps.includes(c)||this.previousMaps.push(c)}}));else{var l=new y(this.originalCSS,this.opts);l.map&&this.previousMaps.push(l.map)}return this.previousMaps}setSourcesContent(){var l={};if(this.root)this.root.walk((c=>{if(c.source){var d=c.source.input.from;if(d&&!l[d]){l[d]=!0;var h=this.usesFileUrls?this.toFileUrl(d):this.toUrl(this.path(d));this.map.setSourceContent(h,c.source.input.css)}}}));else if(this.css){var c=this.opts.from?this.toUrl(this.path(this.opts.from)):"<no source>";this.map.setSourceContent(c,this.css)}}sourcePath(l){return this.mapOpts.from?this.toUrl(this.mapOpts.from):this.usesFileUrls?this.toFileUrl(l.source.input.from):this.toUrl(this.path(l.source.input.from))}toBase64(l){return Buffer?Buffer.from(l).toString("base64"):window.btoa(unescape(encodeURIComponent(l)))}toFileUrl(l){var c=this.memoizedFileURLs.get(l);if(c)return c;if(m){var d=m(l).toString();return this.memoizedFileURLs.set(l,d),d}throw new Error("`map.absolute` option is not available in this PostCSS build")}toUrl(l){var c=this.memoizedURLs.get(l);if(c)return c;"\\"===h&&(l=l.replace(/\\/g,"/"));var d=encodeURI(l).replace(/[#?]/g,encodeURIComponent);return this.memoizedURLs.set(l,d),d}}}function Ne2(){if(At)return Tt;At=1;var l="'".charCodeAt(0),c='"'.charCodeAt(0),d="\\".charCodeAt(0),h="/".charCodeAt(0),p="\n".charCodeAt(0),f=" ".charCodeAt(0),m="\f".charCodeAt(0),y="\t".charCodeAt(0),_="\r".charCodeAt(0),b="[".charCodeAt(0),w="]".charCodeAt(0),E="(".charCodeAt(0),M=")".charCodeAt(0),N="{".charCodeAt(0),P="}".charCodeAt(0),L=";".charCodeAt(0),j="*".charCodeAt(0),D=":".charCodeAt(0),F="@".charCodeAt(0),U=/[\t\n\f\r "#'()/;[\\\]{}]/g,B=/[\t\n\f\r !"#'():;@[\\\]{}]|\/(?=\*)/g,H=/.[\r\n"'(/\\]/,z=/[\da-f]/i;return Tt=function(q,V){void 0===V&&(V={});var Z,K,Y,ee,ne,se,ie,oe,le,ce,pe=q.css.valueOf(),fe=V.ignoreErrors,ge=pe.length,be=0,Oe=[],Ne=[];function W22(l){throw q.error("Unclosed "+l,be)}return{back:function(l){Ne.push(l)},endOfFile:function(){return 0===Ne.length&&be>=ge},nextToken:function(q){if(Ne.length)return Ne.pop();if(!(be>=ge)){var V=!!q&&q.ignoreUnclosed;switch(Z=pe.charCodeAt(be)){case p:case f:case y:case _:case m:ee=be;do{ee+=1,Z=pe.charCodeAt(ee)}while(Z===f||Z===p||Z===y||Z===_||Z===m);se=["space",pe.slice(be,ee)],be=ee-1;break;case b:case w:case N:case P:case D:case L:case M:var De=String.fromCharCode(Z);se=[De,De,be];break;case E:if(ce=Oe.length?Oe.pop()[1]:"",le=pe.charCodeAt(be+1),"url"===ce&&le!==l&&le!==c&&le!==f&&le!==p&&le!==y&&le!==m&&le!==_){ee=be;do{if(ie=!1,-1===(ee=pe.indexOf(")",ee+1))){if(fe||V){ee=be;break}W22("bracket")}for(oe=ee;pe.charCodeAt(oe-1)===d;)oe-=1,ie=!ie}while(ie);se=["brackets",pe.slice(be,ee+1),be,ee],be=ee}else ee=pe.indexOf(")",be+1),K=pe.slice(be,ee+1),-1===ee||H.test(K)?se=["(","(",be]:(se=["brackets",K,be,ee],be=ee);break;case l:case c:ne=Z===l?"'":'"',ee=be;do{if(ie=!1,-1===(ee=pe.indexOf(ne,ee+1))){if(fe||V){ee=be+1;break}W22("string")}for(oe=ee;pe.charCodeAt(oe-1)===d;)oe-=1,ie=!ie}while(ie);se=["string",pe.slice(be,ee+1),be,ee],be=ee;break;case F:U.lastIndex=be+1,U.test(pe),ee=0===U.lastIndex?pe.length-1:U.lastIndex-2,se=["at-word",pe.slice(be,ee+1),be,ee],be=ee;break;case d:for(ee=be,Y=!0;pe.charCodeAt(ee+1)===d;)ee+=1,Y=!Y;if(Z=pe.charCodeAt(ee+1),Y&&Z!==h&&Z!==f&&Z!==p&&Z!==y&&Z!==_&&Z!==m&&(ee+=1,z.test(pe.charAt(ee)))){for(;z.test(pe.charAt(ee+1));)ee+=1;pe.charCodeAt(ee+1)===f&&(ee+=1)}se=["word",pe.slice(be,ee+1),be,ee],be=ee;break;default:Z===h&&pe.charCodeAt(be+1)===j?(0===(ee=pe.indexOf("*/",be+2)+1)&&(fe||V?ee=pe.length:W22("comment")),se=["comment",pe.slice(be,ee+1),be,ee],be=ee):(B.lastIndex=be+1,B.test(pe),ee=0===B.lastIndex?pe.length-1:B.lastIndex-2,se=["word",pe.slice(be,ee+1),be,ee],Oe.push(se),be=ee)}return be++,se}},position:function(){return be}}}}function je2(){if(Mt)return Ot;Mt=1;var l=xe2(),c=Ie2(),d=Me2(),h=Ae2(),p=Le2(),f=Ne2(),m={empty:!0,space:!0};return Ot=class{constructor(l){this.input=l,this.root=new h,this.current=this.root,this.spaces="",this.semicolon=!1,this.createTokenizer(),this.root.source={input:l,start:{column:1,line:1,offset:0}}}atrule(c){var d,h,p,f=new l;f.name=c[1].slice(1),""===f.name&&this.unnamedAtrule(f,c),this.init(f,c[2]);for(var m=!1,y=!1,_=[],b=[];!this.tokenizer.endOfFile();){if("("===(d=(c=this.tokenizer.nextToken())[0])||"["===d?b.push("("===d?")":"]"):"{"===d&&b.length>0?b.push("}"):d===b[b.length-1]&&b.pop(),0===b.length){if(";"===d){f.source.end=this.getPosition(c[2]),f.source.end.offset++,this.semicolon=!0;break}if("{"===d){y=!0;break}if("}"===d){if(_.length>0){for(h=_[p=_.length-1];h&&"space"===h[0];)h=_[--p];h&&(f.source.end=this.getPosition(h[3]||h[2]),f.source.end.offset++)}this.end(c);break}_.push(c)}else _.push(c);if(this.tokenizer.endOfFile()){m=!0;break}}f.raws.between=this.spacesAndCommentsFromEnd(_),_.length?(f.raws.afterName=this.spacesAndCommentsFromStart(_),this.raw(f,"params",_),m&&(c=_[_.length-1],f.source.end=this.getPosition(c[3]||c[2]),f.source.end.offset++,this.spaces=f.raws.between,f.raws.between="")):(f.raws.afterName="",f.params=""),y&&(f.nodes=[],this.current=f)}checkMissedSemicolon(l){var c=this.colon(l);if(!1!==c){for(var d,h=0,p=c-1;p>=0&&("space"===(d=l[p])[0]||2!==(h+=1));p--);throw this.input.error("Missed semicolon","word"===d[0]?d[3]+1:d[2])}}colon(l){var c,d,h,p=0;for(var[f,m]of l.entries()){if("("===(h=(d=m)[0])&&(p+=1),")"===h&&(p-=1),0===p&&":"===h){if(c){if("word"===c[0]&&"progid"===c[1])continue;return f}this.doubleColon(d)}c=d}return!1}comment(l){var d=new c;this.init(d,l[2]),d.source.end=this.getPosition(l[3]||l[2]),d.source.end.offset++;var h=l[1].slice(2,-2);if(/^\s*$/.test(h))d.text="",d.raws.left=h,d.raws.right="";else{var p=h.match(/^(\s*)([^]*\S)(\s*)$/);d.text=p[2],d.raws.left=p[1],d.raws.right=p[3]}}createTokenizer(){this.tokenizer=f(this.input)}decl(l,c){var h=new d;this.init(h,l[0][2]);var p,f=l[l.length-1];for(";"===f[0]&&(this.semicolon=!0,l.pop()),h.source.end=this.getPosition(f[3]||f[2]||function(l){for(var c=l.length-1;c>=0;c--){var d=l[c],h=d[3]||d[2];if(h)return h}}(l)),h.source.end.offset++;"word"!==l[0][0];)1===l.length&&this.unknownWord(l),h.raws.before+=l.shift()[1];for(h.source.start=this.getPosition(l[0][2]),h.prop="";l.length;){var m=l[0][0];if(":"===m||"space"===m||"comment"===m)break;h.prop+=l.shift()[1]}for(h.raws.between="";l.length;){if(":"===(p=l.shift())[0]){h.raws.between+=p[1];break}"word"===p[0]&&/\w/.test(p[1])&&this.unknownWord([p]),h.raws.between+=p[1]}"_"!==h.prop[0]&&"*"!==h.prop[0]||(h.raws.before+=h.prop[0],h.prop=h.prop.slice(1));for(var y,_=[];l.length&&("space"===(y=l[0][0])||"comment"===y);)_.push(l.shift());this.precheckMissedSemicolon(l);for(var b=l.length-1;b>=0;b--){if("!important"===(p=l[b])[1].toLowerCase()){h.important=!0;var w=this.stringFrom(l,b);" !important"!==(w=this.spacesFromEnd(l)+w)&&(h.raws.important=w);break}if("important"===p[1].toLowerCase()){for(var E=l.slice(0),M="",N=b;N>0;N--){var P=E[N][0];if(M.trim().startsWith("!")&&"space"!==P)break;M=E.pop()[1]+M}M.trim().startsWith("!")&&(h.important=!0,h.raws.important=M,l=E)}if("space"!==p[0]&&"comment"!==p[0])break}l.some((l=>"space"!==l[0]&&"comment"!==l[0]))&&(h.raws.between+=_.map((l=>l[1])).join(""),_=[]),this.raw(h,"value",_.concat(l),c),h.value.includes(":")&&!c&&this.checkMissedSemicolon(l)}doubleColon(l){throw this.input.error("Double colon",{offset:l[2]},{offset:l[2]+l[1].length})}emptyRule(l){var c=new p;this.init(c,l[2]),c.selector="",c.raws.between="",this.current=c}end(l){this.current.nodes&&this.current.nodes.length&&(this.current.raws.semicolon=this.semicolon),this.semicolon=!1,this.current.raws.after=(this.current.raws.after||"")+this.spaces,this.spaces="",this.current.parent?(this.current.source.end=this.getPosition(l[2]),this.current.source.end.offset++,this.current=this.current.parent):this.unexpectedClose(l)}endFile(){this.current.parent&&this.unclosedBlock(),this.current.nodes&&this.current.nodes.length&&(this.current.raws.semicolon=this.semicolon),this.current.raws.after=(this.current.raws.after||"")+this.spaces,this.root.source.end=this.getPosition(this.tokenizer.position())}freeSemicolon(l){if(this.spaces+=l[1],this.current.nodes){var c=this.current.nodes[this.current.nodes.length-1];c&&"rule"===c.type&&!c.raws.ownSemicolon&&(c.raws.ownSemicolon=this.spaces,this.spaces="")}}getPosition(l){var c=this.input.fromOffset(l);return{column:c.col,line:c.line,offset:l}}init(l,c){this.current.push(l),l.source={input:this.input,start:this.getPosition(c)},l.raws.before=this.spaces,this.spaces="","comment"!==l.type&&(this.semicolon=!1)}other(l){for(var c=!1,d=null,h=!1,p=null,f=[],m=l[1].startsWith("--"),y=[],_=l;_;){if(d=_[0],y.push(_),"("===d||"["===d)p||(p=_),f.push("("===d?")":"]");else if(m&&h&&"{"===d)p||(p=_),f.push("}");else if(0===f.length){if(";"===d){if(h)return void this.decl(y,m);break}if("{"===d)return void this.rule(y);if("}"===d){this.tokenizer.back(y.pop()),c=!0;break}":"===d&&(h=!0)}else d===f[f.length-1]&&(f.pop(),0===f.length&&(p=null));_=this.tokenizer.nextToken()}if(this.tokenizer.endOfFile()&&(c=!0),f.length>0&&this.unclosedBracket(p),c&&h){if(!m)for(;y.length&&("space"===(_=y[y.length-1][0])||"comment"===_);)this.tokenizer.back(y.pop());this.decl(y,m)}else this.unknownWord(y)}parse(){for(var l;!this.tokenizer.endOfFile();)switch((l=this.tokenizer.nextToken())[0]){case"space":this.spaces+=l[1];break;case";":this.freeSemicolon(l);break;case"}":this.end(l);break;case"comment":this.comment(l);break;case"at-word":this.atrule(l);break;case"{":this.emptyRule(l);break;default:this.other(l)}this.endFile()}precheckMissedSemicolon(){}raw(l,c,d,h){for(var p,f,y,_,b=d.length,w="",E=!0,M=0;M<b;M+=1)"space"!==(f=(p=d[M])[0])||M!==b-1||h?"comment"===f?(_=d[M-1]?d[M-1][0]:"empty",y=d[M+1]?d[M+1][0]:"empty",m[_]||m[y]||","===w.slice(-1)?E=!1:w+=p[1]):w+=p[1]:E=!1;if(!E){var N=d.reduce(((l,c)=>l+c[1]),"");l.raws[c]={raw:N,value:w}}l[c]=w}rule(l){l.pop();var c=new p;this.init(c,l[0][2]),c.raws.between=this.spacesAndCommentsFromEnd(l),this.raw(c,"selector",l),this.current=c}spacesAndCommentsFromEnd(l){for(var c,d="";l.length&&("space"===(c=l[l.length-1][0])||"comment"===c);)d=l.pop()[1]+d;return d}spacesAndCommentsFromStart(l){for(var c,d="";l.length&&("space"===(c=l[0][0])||"comment"===c);)d+=l.shift()[1];return d}spacesFromEnd(l){for(var c="";l.length&&"space"===l[l.length-1][0];)c=l.pop()[1]+c;return c}stringFrom(l,c){for(var d="",h=c;h<l.length;h++)d+=l[h][1];return l.splice(c,l.length-c),d}unclosedBlock(){var l=this.current.source.start;throw this.input.error("Unclosed block",l.line,l.column)}unclosedBracket(l){throw this.input.error("Unclosed bracket",{offset:l[2]},{offset:l[2]+1})}unexpectedClose(l){throw this.input.error("Unexpected }",{offset:l[2]},{offset:l[2]+1})}unknownWord(l){throw this.input.error("Unknown word",{offset:l[0][2]},{offset:l[0][2]+l[0][1].length})}unnamedAtrule(l,c){throw this.input.error("At-rule without name",{offset:c[2]},{offset:c[2]+c[1].length})}}}function De2(){if(Pt)return Nt;Pt=1;var l=Re2(),c=Ee2(),d=je2();function i22(l,h){var p=new c(l,h),f=new d(p);try{f.parse()}catch(m){throw m}return f.root}return Nt=i22,i22.default=i22,l.registerParse(i22),Nt}function Ue2(){if(jt)return Lt;jt=1;class t22{constructor(l,c){if(void 0===c&&(c={}),this.type="warning",this.text=l,c.node&&c.node.source){var d=c.node.rangeBy(c);this.line=d.start.line,this.column=d.start.column,this.endLine=d.end.line,this.endColumn=d.end.column}for(var h in c)this[h]=c[h]}toString(){return this.node?this.node.error(this.text,{index:this.index,plugin:this.plugin,word:this.word}).message:this.plugin?this.plugin+": "+this.text:this.text}}return Lt=t22,t22.default=t22,Lt}function Pe2(){if(Ft)return Dt;Ft=1;var l=Ue2();class e22{constructor(l,c,d){this.processor=l,this.messages=[],this.root=c,this.opts=d,this.css=void 0,this.map=void 0}toString(){return this.css}warn(c,d){void 0===d&&(d={}),d.plugin||this.lastPlugin&&this.lastPlugin.postcssPlugin&&(d.plugin=this.lastPlugin.postcssPlugin);var h=new l(c,d);return this.messages.push(h),h}warnings(){return this.messages.filter((l=>"warning"===l.type))}get content(){return this.css}}return Dt=e22,e22.default=e22,Dt}function We2(){if(Ht)return Bt;Ht=1;var l=Re2(),c=_e3(),d=Fe2(),h=De2(),p=Pe2(),f=Ae2(),m=St2(),{isClean:y,my:_}=ke2(),b={atrule:"AtRule",comment:"Comment",decl:"Declaration",document:"Document",root:"Root",rule:"Rule"},w={AtRule:!0,AtRuleExit:!0,Comment:!0,CommentExit:!0,Declaration:!0,DeclarationExit:!0,Document:!0,DocumentExit:!0,Once:!0,OnceExit:!0,postcssPlugin:!0,prepare:!0,Root:!0,RootExit:!0,Rule:!0,RuleExit:!0},E={Once:!0,postcssPlugin:!0,prepare:!0};function m22(l){return"object"==typeof l&&"function"==typeof l.then}function g22(l){var c=!1,d=b[l.type];return"decl"===l.type?c=l.prop.toLowerCase():"atrule"===l.type&&(c=l.name.toLowerCase()),c&&l.append?[d,d+"-"+c,0,d+"Exit",d+"Exit-"+c]:c?[d,d+"-"+c,d+"Exit",d+"Exit-"+c]:l.append?[d,0,d+"Exit"]:[d,d+"Exit"]}function w22(l){return{eventIndex:0,events:"document"===l.type?["Document",0,"DocumentExit"]:"root"===l.type?["Root",0,"RootExit"]:g22(l),iterator:0,node:l,visitorIndex:0,visitors:[]}}function y22(l){return l[y]=!1,l.nodes&&l.nodes.forEach((l=>y22(l))),l}var M={};class S22{constructor(c,d,f){var m;if(this.stringified=!1,this.processed=!1,"object"!=typeof d||null===d||"root"!==d.type&&"document"!==d.type)if(d instanceof S22||d instanceof p)m=y22(d.root),d.map&&(void 0===f.map&&(f.map={}),f.map.inline||(f.map.inline=!1),f.map.prev=d.map);else{var y=h;f.syntax&&(y=f.syntax.parse),f.parser&&(y=f.parser),y.parse&&(y=y.parse);try{m=y(d,f)}catch(b){this.processed=!0,this.error=b}m&&!m[_]&&l.rebuild(m)}else m=y22(d);this.result=new p(c,m,f),this.helpers=r2({},M,{postcss:M,result:this.result}),this.plugins=this.processor.plugins.map((l=>"object"==typeof l&&l.prepare?r2({},l,l.prepare(this.result)):l))}async(){return this.error?Promise.reject(this.error):this.processed?Promise.resolve(this.result):(this.processing||(this.processing=this.runAsync()),this.processing)}catch(l){return this.async().catch(l)}finally(l){return this.async().then(l,l)}getAsyncError(){throw new Error("Use process(css).then(cb) to work with async plugins")}handleError(l,c){var d=this.result.lastPlugin;try{if(c&&c.addToError(l),this.error=l,"CssSyntaxError"!==l.name||l.plugin)d.postcssVersion,0;else l.plugin=d.postcssPlugin,l.setMessage()}catch(h){console&&console.error&&console.error(h)}return l}prepareVisitors(){this.listeners={};var t3=(l,c,d)=>{this.listeners[c]||(this.listeners[c]=[]),this.listeners[c].push([l,d])};for(var l of this.plugins)if("object"==typeof l)for(var c in l){if(!w[c]&&/^[A-Z]/.test(c))throw new Error("Unknown event "+c+" in "+l.postcssPlugin+". Try to update PostCSS ("+this.processor.version+" now).");if(!E[c])if("object"==typeof l[c])for(var d in l[c])t3(l,"*"===d?c:c+"-"+d.toLowerCase(),l[c][d]);else"function"==typeof l[c]&&t3(l,c,l[c])}this.hasListener=Object.keys(this.listeners).length>0}runAsync(){var l=this;return e3((function*(){l.plugin=0;for(var c=0;c<l.plugins.length;c++){var d=l.plugins[c],h=l.runOnRoot(d);if(m22(h))try{yield h}catch(E){throw l.handleError(E)}}if(l.prepareVisitors(),l.hasListener){for(var p=l.result.root;!p[y];){p[y]=!0;for(var f=[w22(p)];f.length>0;){var m=l.visitTick(f);if(m22(m))try{yield m}catch(E){var _=f[f.length-1].node;throw l.handleError(E,_)}}}if(l.listeners.OnceExit){var h3=function*(c){l.result.lastPlugin=b;try{if("document"===p.type){var d=p.nodes.map((d=>c(d,l.helpers)));yield Promise.all(d)}else yield c(p,l.helpers)}catch(h){throw l.handleError(h)}};for(var[b,w]of l.listeners.OnceExit)yield*h3(w)}}return l.processed=!0,l.stringify()}))()}runOnRoot(l){this.result.lastPlugin=l;try{if("object"==typeof l&&l.Once){if("document"===this.result.root.type){var c=this.result.root.nodes.map((c=>l.Once(c,this.helpers)));return m22(c[0])?Promise.all(c):c}return l.Once(this.result.root,this.helpers)}if("function"==typeof l)return l(this.result.root,this.result)}catch(d){throw this.handleError(d)}}stringify(){if(this.error)throw this.error;if(this.stringified)return this.result;this.stringified=!0,this.sync();var l=this.result.opts,c=m;l.syntax&&(c=l.syntax.stringify),l.stringifier&&(c=l.stringifier),c.stringify&&(c=c.stringify);var h=new d(c,this.result.root,this.result.opts).generate();return this.result.css=h[0],this.result.map=h[1],this.result}sync(){if(this.error)throw this.error;if(this.processed)return this.result;if(this.processed=!0,this.processing)throw this.getAsyncError();for(var l of this.plugins)if(m22(this.runOnRoot(l)))throw this.getAsyncError();if(this.prepareVisitors(),this.hasListener){for(var c=this.result.root;!c[y];)c[y]=!0,this.walkSync(c);if(this.listeners.OnceExit)if("document"===c.type)for(var d of c.nodes)this.visitSync(this.listeners.OnceExit,d);else this.visitSync(this.listeners.OnceExit,c)}return this.result}then(l,c){return this.async().then(l,c)}toString(){return this.css}visitSync(l,c){for(var[d,h]of l){this.result.lastPlugin=d;var p=void 0;try{p=h(c,this.helpers)}catch(f){throw this.handleError(f,c.proxyOf)}if("root"!==c.type&&"document"!==c.type&&!c.parent)return!0;if(m22(p))throw this.getAsyncError()}}visitTick(l){var c=l[l.length-1],{node:d,visitors:h}=c;if("root"===d.type||"document"===d.type||d.parent){if(h.length>0&&c.visitorIndex<h.length){var[p,f]=h[c.visitorIndex];c.visitorIndex+=1,c.visitorIndex===h.length&&(c.visitors=[],c.visitorIndex=0),this.result.lastPlugin=p;try{return f(d.toProxy(),this.helpers)}catch(E){throw this.handleError(E,d)}}if(0!==c.iterator){for(var m,_=c.iterator;m=d.nodes[d.indexes[_]];)if(d.indexes[_]+=1,!m[y])return m[y]=!0,void l.push(w22(m));c.iterator=0,delete d.indexes[_]}for(var b=c.events;c.eventIndex<b.length;){var w=b[c.eventIndex];if(c.eventIndex+=1,0===w)return void(d.nodes&&d.nodes.length&&(d[y]=!0,c.iterator=d.getIterator()));if(this.listeners[w])return void(c.visitors=this.listeners[w])}l.pop()}else l.pop()}walkSync(l){l[y]=!0;var c=g22(l);for(var d of c)if(0===d)l.nodes&&l.each((l=>{l[y]||this.walkSync(l)}));else{var h=this.listeners[d];if(h&&this.visitSync(h,l.toProxy()))return}}warnings(){return this.sync().warnings()}get content(){return this.stringify().content}get css(){return this.stringify().css}get map(){return this.stringify().map}get messages(){return this.sync().messages}get opts(){return this.result.opts}get processor(){return this.result.processor}get root(){return this.sync().root}get[Symbol.toStringTag](){return"LazyResult"}}return S22.registerPostcss=l=>{M=l},Bt=S22,S22.default=S22,f.registerLazyResult(S22),c.registerLazyResult(S22),Bt}function ze2(){if(Yt)return Kt;Yt=1;var l=xe2(),c=Ie2(),p=Re2(),f=yt3(),m=Me2(),y=_e3(),_=function(){if(kt)return xt;kt=1;var l=xe2(),c=Ie2(),p=Me2(),f=Ee2(),m=Te2(),y=Ae2(),_=Le2();function c3(b,w){if(Array.isArray(b))return b.map((l=>c3(l)));var{inputs:E}=b,M=i2(b,d);if(E)for(var N of(w=[],E)){var P=r2({},N,{__proto__:f.prototype});P.map&&(P.map=r2({},P.map,{__proto__:m.prototype})),w.push(P)}if(M.nodes&&(M.nodes=b.nodes.map((l=>c3(l,w)))),M.source){var L=M.source,{inputId:j}=L,D=i2(L,h);M.source=D,null!=j&&(M.source.input=w[j])}if("root"===M.type)return new y(M);if("decl"===M.type)return new p(M);if("rule"===M.type)return new _(M);if("comment"===M.type)return new c(M);if("atrule"===M.type)return new l(M);throw new Error("Unknown node type: "+b.type)}return xt=c3,c3.default=c3,xt}(),b=Ee2(),w=We2(),E=Be2(),M=Ce2(),N=De2(),P=function(){if(Gt)return Zt;Gt=1;var l=_e3(),c=We2(),d=function(){if(Vt)return Wt;Vt=1;var l=Fe2(),c=De2(),d=Pe2(),h=St2();class s22{constructor(c,p,f){var m;p=p.toString(),this.stringified=!1,this._processor=c,this._css=p,this._opts=f,this._map=void 0;var y=h;this.result=new d(this._processor,m,this._opts),this.result.css=p;var _=this;Object.defineProperty(this.result,"root",{get:()=>_.root});var b=new l(y,m,this._opts,p);if(b.isMap()){var[w,E]=b.generate();w&&(this.result.css=w),E&&(this.result.map=E)}else b.clearAnnotation(),this.result.css=b.css}async(){return this.error?Promise.reject(this.error):Promise.resolve(this.result)}catch(l){return this.async().catch(l)}finally(l){return this.async().then(l,l)}sync(){if(this.error)throw this.error;return this.result}then(l,c){return this.async().then(l,c)}toString(){return this._css}warnings(){return[]}get content(){return this.result.css}get css(){return this.result.css}get map(){return this.result.map}get messages(){return[]}get opts(){return this.result.opts}get processor(){return this.result.processor}get root(){if(this._root)return this._root;var l,d=c;try{l=d(this._css,this._opts)}catch(h){this.error=h}if(this.error)throw this.error;return this._root=l,l}get[Symbol.toStringTag](){return"NoWorkResult"}}return Wt=s22,s22.default=s22,Wt}(),h=Ae2();class n22{constructor(l){void 0===l&&(l=[]),this.version="8.5.1",this.plugins=this.normalize(l)}normalize(l){var c=[];for(var d of l)if(!0===d.postcss?d=d():d.postcss&&(d=d.postcss),"object"==typeof d&&Array.isArray(d.plugins))c=c.concat(d.plugins);else if("object"==typeof d&&d.postcssPlugin)c.push(d);else if("function"==typeof d)c.push(d);else if("object"!=typeof d||!d.parse&&!d.stringify)throw new Error(d+" is not a PostCSS plugin");return c}process(l,h){return void 0===h&&(h={}),this.plugins.length||h.parser||h.stringifier||h.syntax?new c(this,l,h):new d(this,l,h)}use(l){return this.plugins=this.plugins.concat(this.normalize([l])),this}}return Zt=n22,n22.default=n22,h.registerProcessor(n22),l.registerProcessor(n22),Zt}(),L=Pe2(),j=Ae2(),D=Le2(),F=St2(),U=Ue2();function k22(){for(var l=arguments.length,c=new Array(l),d=0;d<l;d++)c[d]=arguments[d];return 1===c.length&&Array.isArray(c[0])&&(c=c[0]),new P(c)}return k22.plugin=function(l,c){var d,h=!1;function n3(){console&&console.warn&&!h&&(h=!0,console.warn(l+": postcss.plugin was deprecated. Migration guide:\nhttps://evilmartians.com/chronicles/postcss-8-plugin-migration"),Ab.LANG&&Ab.LANG.startsWith("cn")&&console.warn(l+": \u91cc\u9762 postcss.plugin \u88ab\u5f03\u7528. \u8fc1\u79fb\u6307\u5357:\nhttps://www.w3ctech.com/topic/2226"));var d=c(...arguments);return d.postcssPlugin=l,d.postcssVersion=(new P).version,d}return Object.defineProperty(n3,"postcss",{get:()=>(d||(d=n3()),d)}),n3.process=function(l,c,d){return k22([n3(d)]).process(l,c)},n3},k22.stringify=F,k22.parse=N,k22.fromJSON=_,k22.list=E,k22.comment=l=>new c(l),k22.atRule=c=>new l(c),k22.decl=l=>new m(l),k22.rule=l=>new D(l),k22.root=l=>new j(l),k22.document=l=>new y(l),k22.CssSyntaxError=f,k22.Declaration=m,k22.Container=p,k22.Processor=P,k22.Document=y,k22.Comment=c,k22.Warning=U,k22.AtRule=l,k22.Result=L,k22.Input=b,k22.Rule=D,k22.Root=j,k22.Node=M,w.registerPostcss(k22),Kt=k22,k22.default=k22,Kt}!function(){if(rr)return tr;rr=1;var{Input:l}=ze2(),c=function(){if(er)return Qt;er=1;var l=Ie2(),c=je2(),d=Ne2();return Qt=class extends c{checkMissedSemicolon(){}comment(c){var d=new l;this.init(d,c[2]);var h=this.input.fromOffset(c[3])||this.input.fromOffset(this.input.css.length-1);d.source.end={column:h.col,line:h.line,offset:c[3]+1};var p=c[1].slice(2);if("*/"===p.slice(-2)&&(p=p.slice(0,-2)),/^\s*$/.test(p))d.text="",d.raws.left=p,d.raws.right="";else{var f=p.match(/^(\s*)([^]*\S)(\s*)$/);d.text=f[2],d.raws.left=f[1],d.raws.right=f[3]}}createTokenizer(){this.tokenizer=d(this.input,{ignoreErrors:!0})}decl(l){l.length>1&&l.some((l=>"word"===l[0]))&&super.decl(l)}doubleColon(){}endFile(){for(this.current.nodes&&this.current.nodes.length&&(this.current.raws.semicolon=this.semicolon),this.current.raws.after=(this.current.raws.after||"")+this.spaces;this.current.parent;)this.current=this.current.parent,this.current.raws.after="";this.root.source.end=this.getPosition(this.tokenizer.position())}precheckMissedSemicolon(l){var c=this.colon(l);if(!1!==c){var d,h;for(d=c-1;d>=0&&"word"!==l[d][0];d--);if(!(0===d||d<0)){for(h=d-1;h>=0;h--)if("space"!==l[h][0]){h+=1;break}var p=l.slice(d),f=l.slice(h,d);l.splice(h,l.length-h),this.spaces=f.map((l=>l[1])).join(""),this.decl(p)}}}unclosedBracket(){}unexpectedClose(){this.current.raws.after+="}"}unknownWord(l){this.spaces+=l.map((l=>l[1])).join("")}unnamedAtrule(l){l.name=""}}}();tr=function(d,h){var p=new l(d,h),f=new c(p);return f.parse(),f.root}}();var or=function(l){return l&&l.__esModule&&Object.prototype.hasOwnProperty.call(l,"default")?l.default:l}(ze2());or.stringify,or.fromJSON,or.plugin,or.parse,or.list,or.document,or.comment,or.atRule,or.rule,or.decl,or.root,or.CssSyntaxError,or.Declaration,or.Container,or.Processor,or.Document,or.Comment,or.Warning,or.AtRule,or.Result,or.Input,or.Rule,or.Root,or.Node;var ar=Object.defineProperty,Ve2=(l,c,d)=>{return f=d,(p="symbol"!=typeof c?c+"":c)in(h=l)?ar(h,p,{enumerable:!0,configurable:!0,writable:!0,value:f}):h[p]=f;var h,p,f};var ur,dr={exports:{}};var pr,fr,gr,vr,wr,Sr,kr=function(l){if(l.__esModule)return l;var c=l.default;if("function"==typeof c){var d=function t3(){return this instanceof t3?Reflect.construct(c,arguments,this.constructor):c.apply(this,arguments)};d.prototype=c.prototype}else d={};return Object.defineProperty(d,"__esModule",{value:!0}),Object.keys(l).forEach((function(c){var h=Object.getOwnPropertyDescriptor(l,c);Object.defineProperty(d,c,h.get?h:{enumerable:!0,get:function(){return l[c]}})})),d}(Object.freeze(Object.defineProperty({__proto__:null,default:{}},Symbol.toStringTag,{value:"Module"})));function or2(){if(fr)return pr;fr=1;var l=function(){if(ur)return dr.exports;ur=1;var l=String,e22=function(){return{isColorSupported:!1,reset:l,bold:l,dim:l,italic:l,underline:l,inverse:l,hidden:l,strikethrough:l,black:l,red:l,green:l,yellow:l,blue:l,magenta:l,cyan:l,white:l,gray:l,bgBlack:l,bgRed:l,bgGreen:l,bgYellow:l,bgBlue:l,bgMagenta:l,bgCyan:l,bgWhite:l,blackBright:l,redBright:l,greenBright:l,yellowBright:l,blueBright:l,magentaBright:l,cyanBright:l,whiteBright:l,bgBlackBright:l,bgRedBright:l,bgGreenBright:l,bgYellowBright:l,bgBlueBright:l,bgMagentaBright:l,bgCyanBright:l,bgWhiteBright:l}};return dr.exports=e22(),dr.exports.createColors=e22,dr.exports}(),c=kr;class r22 extends Error{constructor(l,c,d,h,p,f){super(l),this.name="CssSyntaxError",this.reason=l,p&&(this.file=p),h&&(this.source=h),f&&(this.plugin=f),void 0!==c&&void 0!==d&&("number"==typeof c?(this.line=c,this.column=d):(this.line=c.line,this.column=c.column,this.endLine=d.line,this.endColumn=d.column)),this.setMessage(),Error.captureStackTrace&&Error.captureStackTrace(this,r22)}setMessage(){this.message=this.plugin?this.plugin+": ":"",this.message+=this.file?this.file:"<css input>",void 0!==this.line&&(this.message+=":"+this.line+":"+this.column),this.message+=": "+this.reason}showSourceCode(d){if(!this.source)return"";var h=this.source;null==d&&(d=l.isColorSupported);var n22=l=>l,s22=l=>l,o22=l=>l;if(d){var{bold:p,gray:f,red:m}=l.createColors(!0);s22=l=>p(m(l)),n22=l=>f(l),c&&(o22=l=>c(l))}var y=h.split(/\r?\n/),_=Math.max(this.line-3,0),b=Math.min(this.line+2,y.length),w=String(b).length;return y.slice(_,b).map(((l,c)=>{var d=_+1+c,h=" "+(" "+d).slice(-w)+" | ";if(d===this.line){if(l.length>160){var p=Math.max(0,this.column-20),f=Math.max(this.column+20,this.endColumn+20),m=l.slice(p,f),y=n22(h.replace(/\d/g," "))+l.slice(0,Math.min(this.column-1,19)).replace(/[^\t]/g," ");return s22(">")+n22(h)+o22(m)+"\n "+y+s22("^")}var b=n22(h.replace(/\d/g," "))+l.slice(0,this.column-1).replace(/[^\t]/g," ");return s22(">")+n22(h)+o22(l)+"\n "+b+s22("^")}return" "+n22(h)+o22(l)})).join("\n")}toString(){var l=this.showSourceCode();return l&&(l="\n\n"+l+"\n"),this.name+": "+this.message+l}}return pr=r22,r22.default=r22,pr}function ar2(){if(vr)return gr;vr=1;var l={after:"\n",beforeClose:"\n",beforeComment:"\n",beforeDecl:"\n",beforeOpen:" ",beforeRule:"\n",colon:": ",commentLeft:" ",commentRight:" ",emptyBody:"",indent:"    ",semicolon:!1};class e22{constructor(l){this.builder=l}atrule(l,c){var d="@"+l.name,h=l.params?this.rawValue(l,"params"):"";if(void 0!==l.raws.afterName?d+=l.raws.afterName:h&&(d+=" "),l.nodes)this.block(l,d+h);else{var p=(l.raws.between||"")+(c?";":"");this.builder(d+h+p,l)}}beforeAfter(l,c){var d;d="decl"===l.type?this.raw(l,null,"beforeDecl"):"comment"===l.type?this.raw(l,null,"beforeComment"):"before"===c?this.raw(l,null,"beforeRule"):this.raw(l,null,"beforeClose");for(var h=l.parent,p=0;h&&"root"!==h.type;)p+=1,h=h.parent;if(d.includes("\n")){var f=this.raw(l,null,"indent");if(f.length)for(var m=0;m<p;m++)d+=f}return d}block(l,c){var d,h=this.raw(l,"between","beforeOpen");this.builder(c+h+"{",l,"start"),l.nodes&&l.nodes.length?(this.body(l),d=this.raw(l,"after")):d=this.raw(l,"after","emptyBody"),d&&this.builder(d),this.builder("}",l,"end")}body(l){for(var c=l.nodes.length-1;c>0&&"comment"===l.nodes[c].type;)c-=1;for(var d=this.raw(l,"semicolon"),h=0;h<l.nodes.length;h++){var p=l.nodes[h],f=this.raw(p,"before");f&&this.builder(f),this.stringify(p,c!==h||d)}}comment(l){var c=this.raw(l,"left","commentLeft"),d=this.raw(l,"right","commentRight");this.builder("/*"+c+l.text+d+"*/",l)}decl(l,c){var d=this.raw(l,"between","colon"),h=l.prop+d+this.rawValue(l,"value");l.important&&(h+=l.raws.important||" !important"),c&&(h+=";"),this.builder(h,l)}document(l){this.body(l)}raw(c,d,h){var p;if(h||(h=d),d&&void 0!==(p=c.raws[d]))return p;var f=c.parent;if("before"===h){if(!f||"root"===f.type&&f.first===c)return"";if(f&&"document"===f.type)return""}if(!f)return l[h];var m=c.root();if(m.rawCache||(m.rawCache={}),void 0!==m.rawCache[h])return m.rawCache[h];if("before"===h||"after"===h)return this.beforeAfter(c,h);var y,_="raw"+((y=h)[0].toUpperCase()+y.slice(1));return this[_]?p=this[_](m,c):m.walk((l=>{if(void 0!==(p=l.raws[d]))return!1})),void 0===p&&(p=l[h]),m.rawCache[h]=p,p}rawBeforeClose(l){var c;return l.walk((l=>{if(l.nodes&&l.nodes.length>0&&void 0!==l.raws.after)return(c=l.raws.after).includes("\n")&&(c=c.replace(/[^\n]+$/,"")),!1})),c&&(c=c.replace(/\S/g,"")),c}rawBeforeComment(l,c){var d;return l.walkComments((l=>{if(void 0!==l.raws.before)return(d=l.raws.before).includes("\n")&&(d=d.replace(/[^\n]+$/,"")),!1})),void 0===d?d=this.raw(c,null,"beforeDecl"):d&&(d=d.replace(/\S/g,"")),d}rawBeforeDecl(l,c){var d;return l.walkDecls((l=>{if(void 0!==l.raws.before)return(d=l.raws.before).includes("\n")&&(d=d.replace(/[^\n]+$/,"")),!1})),void 0===d?d=this.raw(c,null,"beforeRule"):d&&(d=d.replace(/\S/g,"")),d}rawBeforeOpen(l){var c;return l.walk((l=>{if("decl"!==l.type&&void 0!==(c=l.raws.between))return!1})),c}rawBeforeRule(l){var c;return l.walk((d=>{if(d.nodes&&(d.parent!==l||l.first!==d)&&void 0!==d.raws.before)return(c=d.raws.before).includes("\n")&&(c=c.replace(/[^\n]+$/,"")),!1})),c&&(c=c.replace(/\S/g,"")),c}rawColon(l){var c;return l.walkDecls((l=>{if(void 0!==l.raws.between)return c=l.raws.between.replace(/[^\s:]/g,""),!1})),c}rawEmptyBody(l){var c;return l.walk((l=>{if(l.nodes&&0===l.nodes.length&&void 0!==(c=l.raws.after))return!1})),c}rawIndent(l){return l.raws.indent?l.raws.indent:(l.walk((d=>{var h=d.parent;if(h&&h!==l&&h.parent&&h.parent===l&&void 0!==d.raws.before){var p=d.raws.before.split("\n");return c=(c=p[p.length-1]).replace(/\S/g,""),!1}})),c);var c}rawSemicolon(l){var c;return l.walk((l=>{if(l.nodes&&l.nodes.length&&"decl"===l.last.type&&void 0!==(c=l.raws.semicolon))return!1})),c}rawValue(l,c){var d=l[c],h=l.raws[c];return h&&h.value===d?h.raw:d}root(l){this.body(l),l.raws.after&&this.builder(l.raws.after)}rule(l){this.block(l,this.rawValue(l,"selector")),l.raws.ownSemicolon&&this.builder(l.raws.ownSemicolon,l,"end")}stringify(l,c){if(!this[l.type])throw new Error("Unknown AST node type "+l.type+". Maybe you need to change PostCSS stringifier.");this[l.type](l,c)}}return gr=e22,e22.default=e22,gr}function hr2(){if(Sr)return wr;Sr=1;var l=ar2();function e22(c,d){new l(d).stringify(c)}return wr=e22,e22.default=e22,wr}var Cr,Er,Ir,Tr,Rr,Ar,Or,Mr,jr,zr,qr,Vr,Zr,Gr,Kr,Yr,en,tn,rn,nn,sn,an,ln,un,dn,hn,pn,wn,Cn,On,Ln,jn,Dn,Fn,$n,Un,Bn,Hn,zn,qn,Wn,Vn,Zn,Gn,Kn,Jn,Yn,Qn,Xn,es,ts,rs={};function ui2(){return Cr||(Cr=1,rs.isClean=Symbol("isClean"),rs.my=Symbol("my")),rs}function li2(){if(Ir)return Er;Ir=1;var l=or2(),c=ar2(),d=hr2(),{isClean:h,my:p}=ui2();function s22(l,c){var d=new l.constructor;for(var h in l)if(Object.prototype.hasOwnProperty.call(l,h)&&"proxyCache"!==h){var p=l[h],f=typeof p;"parent"===h&&"object"===f?c&&(d[h]=c):"source"===h?d[h]=p:Array.isArray(p)?d[h]=p.map((l=>s22(l,d))):("object"===f&&null!==p&&(p=s22(p)),d[h]=p)}return d}function o22(l,c){if(c&&void 0!==c.offset)return c.offset;for(var d=1,h=1,p=0,f=0;f<l.length;f++){if(h===c.line&&d===c.column){p=f;break}"\n"===l[f]?(d=1,h+=1):d+=1}return p}class a22{constructor(l){for(var c in void 0===l&&(l={}),this.raws={},this[h]=!1,this[p]=!0,l)if("nodes"===c)for(var d of(this.nodes=[],l[c]))"function"==typeof d.clone?this.append(d.clone()):this.append(d);else this[c]=l[c]}addToError(l){if(l.postcssNode=this,l.stack&&this.source&&/\n\s{4}at /.test(l.stack)){var c=this.source;l.stack=l.stack.replace(/\n\s{4}at /,"$&"+c.input.from+":"+c.start.line+":"+c.start.column+"$&")}return l}after(l){return this.parent.insertAfter(this,l),this}assign(l){for(var c in void 0===l&&(l={}),l)this[c]=l[c];return this}before(l){return this.parent.insertBefore(this,l),this}cleanRaws(l){delete this.raws.before,delete this.raws.after,l||delete this.raws.between}clone(l){void 0===l&&(l={});var c=s22(this);for(var d in l)c[d]=l[d];return c}cloneAfter(l){void 0===l&&(l={});var c=this.clone(l);return this.parent.insertAfter(this,c),c}cloneBefore(l){void 0===l&&(l={});var c=this.clone(l);return this.parent.insertBefore(this,c),c}error(c,d){if(void 0===d&&(d={}),this.source){var{end:h,start:p}=this.rangeBy(d);return this.source.input.error(c,{column:p.column,line:p.line},{column:h.column,line:h.line},d)}return new l(c)}getProxyProcessor(){return{get:(l,c)=>"proxyOf"===c?l:"root"===c?()=>l.root().toProxy():l[c],set:(l,c,d)=>(l[c]===d||(l[c]=d,"prop"!==c&&"value"!==c&&"name"!==c&&"params"!==c&&"important"!==c&&"text"!==c||l.markDirty()),!0)}}markClean(){this[h]=!0}markDirty(){if(this[h]){this[h]=!1;for(var l=this;l=l.parent;)l[h]=!1}}next(){if(this.parent){var l=this.parent.index(this);return this.parent.nodes[l+1]}}positionBy(l){var c=this.source.start;if(l.index)c=this.positionInside(l.index);else if(l.word){var d="document"in this.source.input?this.source.input.document:this.source.input.css,h=d.slice(o22(d,this.source.start),o22(d,this.source.end)).indexOf(l.word);-1!==h&&(c=this.positionInside(h))}return c}positionInside(l){for(var c=this.source.start.column,d=this.source.start.line,h=("document"in this.source.input?this.source.input.document:this.source.input.css),p=o22(h,this.source.start),f=p+l,m=p;m<f;m++)"\n"===h[m]?(c=1,d+=1):c+=1;return{column:c,line:d}}prev(){if(this.parent){var l=this.parent.index(this);return this.parent.nodes[l-1]}}rangeBy(l){var c={column:this.source.start.column,line:this.source.start.line},d=this.source.end?{column:this.source.end.column+1,line:this.source.end.line}:{column:c.column+1,line:c.line};if(l.word){var h="document"in this.source.input?this.source.input.document:this.source.input.css,p=h.slice(o22(h,this.source.start),o22(h,this.source.end)).indexOf(l.word);-1!==p&&(c=this.positionInside(p),d=this.positionInside(p+l.word.length))}else l.start?c={column:l.start.column,line:l.start.line}:l.index&&(c=this.positionInside(l.index)),l.end?d={column:l.end.column,line:l.end.line}:"number"==typeof l.endIndex?d=this.positionInside(l.endIndex):l.index&&(d=this.positionInside(l.index+1));return(d.line<c.line||d.line===c.line&&d.column<=c.column)&&(d={column:c.column+1,line:c.line}),{end:d,start:c}}raw(l,d){return(new c).raw(this,l,d)}remove(){return this.parent&&this.parent.removeChild(this),this.parent=void 0,this}replaceWith(){if(this.parent){for(var l=this,c=!1,d=arguments.length,h=new Array(d),p=0;p<d;p++)h[p]=arguments[p];for(var f of h)f===this?c=!0:c?(this.parent.insertAfter(l,f),l=f):this.parent.insertBefore(l,f);c||this.remove()}return this}root(){for(var l=this;l.parent&&"document"!==l.parent.type;)l=l.parent;return l}toJSON(l,c){var d={},h=null==c;c=c||new Map;var p=0;for(var f in this)if(Object.prototype.hasOwnProperty.call(this,f)&&"parent"!==f&&"proxyCache"!==f){var m=this[f];if(Array.isArray(m))d[f]=m.map((l=>"object"==typeof l&&l.toJSON?l.toJSON(null,c):l));else if("object"==typeof m&&m.toJSON)d[f]=m.toJSON(null,c);else if("source"===f){var y=c.get(m.input);null==y&&(y=p,c.set(m.input,p),p++),d[f]={end:m.end,inputId:y,start:m.start}}else d[f]=m}return h&&(d.inputs=[...c.keys()].map((l=>l.toJSON()))),d}toProxy(){return this.proxyCache||(this.proxyCache=new Proxy(this,this.getProxyProcessor())),this.proxyCache}toString(l){void 0===l&&(l=d),l.stringify&&(l=l.stringify);var c="";return l(this,(l=>{c+=l})),c}warn(l,c,d){var h={node:this};for(var p in d)h[p]=d[p];return l.warn(c,h)}get proxyOf(){return this}}return Er=a22,a22.default=a22,Er}function ci2(){if(Rr)return Tr;Rr=1;var l=li2();class e22 extends l{constructor(l){super(l),this.type="comment"}}return Tr=e22,e22.default=e22,Tr}function fi2(){if(Or)return Ar;Or=1;var l=li2();class e22 extends l{constructor(l){l&&void 0!==l.value&&"string"!=typeof l.value&&(l=r2({},l,{value:String(l.value)})),super(l),this.type="decl"}get variable(){return this.prop.startsWith("--")||"$"===this.prop[0]}}return Ar=e22,e22.default=e22,Ar}function di2(){if(jr)return Mr;jr=1;var l,c,d,h,p=ci2(),f=fi2(),m=li2(),{isClean:y,my:_}=ui2();function u22(l){return l.map((l=>(l.nodes&&(l.nodes=u22(l.nodes)),delete l.source,l)))}function l22(l){if(l[y]=!1,l.proxyOf.nodes)for(var c of l.proxyOf.nodes)l22(c)}class c22 extends m{append(){for(var l=arguments.length,c=new Array(l),d=0;d<l;d++)c[d]=arguments[d];for(var h of c){var p=this.normalize(h,this.last);for(var f of p)this.proxyOf.nodes.push(f)}return this.markDirty(),this}cleanRaws(l){if(super.cleanRaws(l),this.nodes)for(var c of this.nodes)c.cleanRaws(l)}each(l){if(this.proxyOf.nodes){for(var c,d,h=this.getIterator();this.indexes[h]<this.proxyOf.nodes.length&&(c=this.indexes[h],!1!==(d=l(this.proxyOf.nodes[c],c)));)this.indexes[h]+=1;return delete this.indexes[h],d}}every(l){return this.nodes.every(l)}getIterator(){this.lastEach||(this.lastEach=0),this.indexes||(this.indexes={}),this.lastEach+=1;var l=this.lastEach;return this.indexes[l]=0,l}getProxyProcessor(){return{get:(l,c)=>"proxyOf"===c?l:l[c]?"each"===c||"string"==typeof c&&c.startsWith("walk")?function(){for(var d=arguments.length,h=new Array(d),p=0;p<d;p++)h[p]=arguments[p];return l[c](...h.map((l=>"function"==typeof l?(c,d)=>l(c.toProxy(),d):l)))}:"every"===c||"some"===c?d=>l[c]((function(l){for(var c=arguments.length,h=new Array(c>1?c-1:0),p=1;p<c;p++)h[p-1]=arguments[p];return d(l.toProxy(),...h)})):"root"===c?()=>l.root().toProxy():"nodes"===c?l.nodes.map((l=>l.toProxy())):"first"===c||"last"===c?l[c].toProxy():l[c]:l[c],set:(l,c,d)=>(l[c]===d||(l[c]=d,"name"!==c&&"params"!==c&&"selector"!==c||l.markDirty()),!0)}}index(l){return"number"==typeof l?l:(l.proxyOf&&(l=l.proxyOf),this.proxyOf.nodes.indexOf(l))}insertAfter(l,c){var d,h=this.index(l),p=this.normalize(c,this.proxyOf.nodes[h]).reverse();for(var f of(h=this.index(l),p))this.proxyOf.nodes.splice(h+1,0,f);for(var m in this.indexes)h<(d=this.indexes[m])&&(this.indexes[m]=d+p.length);return this.markDirty(),this}insertBefore(l,c){var d,h=this.index(l),p=0===h&&"prepend",f=this.normalize(c,this.proxyOf.nodes[h],p).reverse();for(var m of(h=this.index(l),f))this.proxyOf.nodes.splice(h,0,m);for(var y in this.indexes)h<=(d=this.indexes[y])&&(this.indexes[y]=d+f.length);return this.markDirty(),this}normalize(d,m){if("string"==typeof d)d=u22(c(d).nodes);else if(void 0===d)d=[];else if(Array.isArray(d))for(var b of d=d.slice(0))b.parent&&b.parent.removeChild(b,"ignore");else if("root"===d.type&&"document"!==this.type)for(var w of d=d.nodes.slice(0))w.parent&&w.parent.removeChild(w,"ignore");else if(d.type)d=[d];else if(d.prop){if(void 0===d.value)throw new Error("Value field is missed in node creation");"string"!=typeof d.value&&(d.value=String(d.value)),d=[new f(d)]}else if(d.selector||d.selectors)d=[new h(d)];else if(d.name)d=[new l(d)];else{if(!d.text)throw new Error("Unknown node type in node creation");d=[new p(d)]}return d.map((l=>(l[_]||c22.rebuild(l),(l=l.proxyOf).parent&&l.parent.removeChild(l),l[y]&&l22(l),l.raws||(l.raws={}),void 0===l.raws.before&&m&&void 0!==m.raws.before&&(l.raws.before=m.raws.before.replace(/\S/g,"")),l.parent=this.proxyOf,l)))}prepend(){for(var l=arguments.length,c=new Array(l),d=0;d<l;d++)c[d]=arguments[d];for(var h of c=c.reverse()){var p=this.normalize(h,this.first,"prepend").reverse();for(var f of p)this.proxyOf.nodes.unshift(f);for(var m in this.indexes)this.indexes[m]=this.indexes[m]+p.length}return this.markDirty(),this}push(l){return l.parent=this,this.proxyOf.nodes.push(l),this}removeAll(){for(var l of this.proxyOf.nodes)l.parent=void 0;return this.proxyOf.nodes=[],this.markDirty(),this}removeChild(l){var c;for(var d in l=this.index(l),this.proxyOf.nodes[l].parent=void 0,this.proxyOf.nodes.splice(l,1),this.indexes)(c=this.indexes[d])>=l&&(this.indexes[d]=c-1);return this.markDirty(),this}replaceValues(l,c,d){return d||(d=c,c={}),this.walkDecls((h=>{c.props&&!c.props.includes(h.prop)||c.fast&&!h.value.includes(c.fast)||(h.value=h.value.replace(l,d))})),this.markDirty(),this}some(l){return this.nodes.some(l)}walk(l){return this.each(((c,d)=>{var h;try{h=l(c,d)}catch(p){throw c.addToError(p)}return!1!==h&&c.walk&&(h=c.walk(l)),h}))}walkAtRules(l,c){return c?l instanceof RegExp?this.walk(((d,h)=>{if("atrule"===d.type&&l.test(d.name))return c(d,h)})):this.walk(((d,h)=>{if("atrule"===d.type&&d.name===l)return c(d,h)})):(c=l,this.walk(((l,d)=>{if("atrule"===l.type)return c(l,d)})))}walkComments(l){return this.walk(((c,d)=>{if("comment"===c.type)return l(c,d)}))}walkDecls(l,c){return c?l instanceof RegExp?this.walk(((d,h)=>{if("decl"===d.type&&l.test(d.prop))return c(d,h)})):this.walk(((d,h)=>{if("decl"===d.type&&d.prop===l)return c(d,h)})):(c=l,this.walk(((l,d)=>{if("decl"===l.type)return c(l,d)})))}walkRules(l,c){return c?l instanceof RegExp?this.walk(((d,h)=>{if("rule"===d.type&&l.test(d.selector))return c(d,h)})):this.walk(((d,h)=>{if("rule"===d.type&&d.selector===l)return c(d,h)})):(c=l,this.walk(((l,d)=>{if("rule"===l.type)return c(l,d)})))}get first(){if(this.proxyOf.nodes)return this.proxyOf.nodes[0]}get last(){if(this.proxyOf.nodes)return this.proxyOf.nodes[this.proxyOf.nodes.length-1]}}return c22.registerParse=l=>{c=l},c22.registerRule=l=>{h=l},c22.registerAtRule=c=>{l=c},c22.registerRoot=l=>{d=l},Mr=c22,c22.default=c22,c22.rebuild=c=>{"atrule"===c.type?Object.setPrototypeOf(c,l.prototype):"rule"===c.type?Object.setPrototypeOf(c,h.prototype):"decl"===c.type?Object.setPrototypeOf(c,f.prototype):"comment"===c.type?Object.setPrototypeOf(c,p.prototype):"root"===c.type&&Object.setPrototypeOf(c,d.prototype),c[_]=!0,c.nodes&&c.nodes.forEach((l=>{c22.rebuild(l)}))},Mr}function vi2(){if(qr)return zr;qr=1;var l=di2();class e22 extends l{constructor(l){super(l),this.type="atrule"}append(){return this.proxyOf.nodes||(this.nodes=[]),super.append(...arguments)}prepend(){return this.proxyOf.nodes||(this.nodes=[]),super.prepend(...arguments)}}return zr=e22,e22.default=e22,l.registerAtRule(e22),zr}function pi2(){if(Zr)return Vr;Zr=1;var l,c,d=di2();class n22 extends d{constructor(l){super(r2({type:"document"},l)),this.nodes||(this.nodes=[])}toResult(d){return void 0===d&&(d={}),new l(new c,this,d).stringify()}}return n22.registerLazyResult=c=>{l=c},n22.registerProcessor=l=>{c=l},Vr=n22,n22.default=n22,Vr}function gi2(){if(en)return Yr;en=1;var{existsSync:l,readFileSync:c}=kr,{dirname:d,join:h}=kr,{SourceMapConsumer:p,SourceMapGenerator:f}=kr;class o22{constructor(l,c){if(!1!==c.map){this.loadAnnotation(l),this.inline=this.startWith(this.annotation,"data:");var h=c.map?c.map.prev:void 0,p=this.loadMap(c.from,h);!this.mapFile&&c.from&&(this.mapFile=c.from),this.mapFile&&(this.root=d(this.mapFile)),p&&(this.text=p)}}consumer(){return this.consumerCache||(this.consumerCache=new p(this.text)),this.consumerCache}decodeInline(l){var c=l.match(/^data:application\/json;charset=utf-?8,/)||l.match(/^data:application\/json,/);if(c)return decodeURIComponent(l.substr(c[0].length));var d,h=l.match(/^data:application\/json;charset=utf-?8;base64,/)||l.match(/^data:application\/json;base64,/);if(h)return d=l.substr(h[0].length),Buffer?Buffer.from(d,"base64").toString():window.atob(d);var p=l.match(/data:application\/json;([^,]+),/)[1];throw new Error("Unsupported source map encoding "+p)}getAnnotationURL(l){return l.replace(/^\/\*\s*# sourceMappingURL=/,"").trim()}isMap(l){return"object"==typeof l&&("string"==typeof l.mappings||"string"==typeof l._mappings||Array.isArray(l.sections))}loadAnnotation(l){var c=l.match(/\/\*\s*# sourceMappingURL=/g);if(c){var d=l.lastIndexOf(c.pop()),h=l.indexOf("*/",d);d>-1&&h>-1&&(this.annotation=this.getAnnotationURL(l.substring(d,h)))}}loadFile(h){if(this.root=d(h),l(h))return this.mapFile=h,c(h,"utf-8").toString().trim()}loadMap(l,c){if(!1===c)return!1;if(c){if("string"==typeof c)return c;if("function"!=typeof c){if(c instanceof p)return f.fromSourceMap(c).toString();if(c instanceof f)return c.toString();if(this.isMap(c))return JSON.stringify(c);throw new Error("Unsupported previous source map format: "+c.toString())}var m=c(l);if(m){var y=this.loadFile(m);if(!y)throw new Error("Unable to load previous source map: "+m.toString());return y}}else{if(this.inline)return this.decodeInline(this.annotation);if(this.annotation){var _=this.annotation;return l&&(_=h(d(l),_)),this.loadFile(_)}}}startWith(l,c){return!!l&&l.substr(0,c.length)===c}withContent(){return!!(this.consumer().sourcesContent&&this.consumer().sourcesContent.length>0)}}return Yr=o22,o22.default=o22,Yr}function wi2(){if(rn)return tn;rn=1;var{nanoid:l}=Kr?Gr:(Kr=1,Gr={nanoid:function(l){void 0===l&&(l=21);for(var c="",d=0|l;d--;)c+="useandom-26T198340PX75pxJACKVERYMINDBUSHWOLF_GQZbfghjklqvwyzrict"[64*Math.random()|0];return c},customAlphabet:function(l,c){return void 0===c&&(c=21),function(d){void 0===d&&(d=c);for(var h="",p=0|d;p--;)h+=l[Math.random()*l.length|0];return h}}}),{isAbsolute:c,resolve:d}=kr,{SourceMapConsumer:h,SourceMapGenerator:p}=kr,{fileURLToPath:f,pathToFileURL:m}=kr,y=or2(),_=gi2(),b=kr,w=Symbol("fromOffsetCache"),E=Boolean(h&&p),M=Boolean(d&&c);class v22{constructor(h,p){if(void 0===p&&(p={}),null==h||"object"==typeof h&&!h.toString)throw new Error("PostCSS received "+h+" instead of CSS string");if(this.css=h.toString(),"\ufeff"===this.css[0]||"\ufffe"===this.css[0]?(this.hasBOM=!0,this.css=this.css.slice(1)):this.hasBOM=!1,this.document=this.css,p.document&&(this.document=p.document.toString()),p.from&&(!M||/^\w+:\/\//.test(p.from)||c(p.from)?this.file=p.from:this.file=d(p.from)),M&&E){var f=new _(this.css,p);if(f.text){this.map=f;var m=f.consumer().file;!this.file&&m&&(this.file=this.mapResolve(m))}}this.file||(this.id="<input css "+l(6)+">"),this.map&&(this.map.file=this.from)}error(l,c,d,h){var p,f,_;if(void 0===h&&(h={}),c&&"object"==typeof c){var b=c,w=d;if("number"==typeof b.offset){var E=this.fromOffset(b.offset);c=E.line,d=E.col}else c=b.line,d=b.column;if("number"==typeof w.offset){var M=this.fromOffset(w.offset);f=M.line,p=M.col}else f=w.line,p=w.column}else if(!d){var N=this.fromOffset(c);c=N.line,d=N.col}var P=this.origin(c,d,f,p);return(_=P?new y(l,void 0===P.endLine?P.line:{column:P.column,line:P.line},void 0===P.endLine?P.column:{column:P.endColumn,line:P.endLine},P.source,P.file,h.plugin):new y(l,void 0===f?c:{column:d,line:c},void 0===f?d:{column:p,line:f},this.css,this.file,h.plugin)).input={column:d,endColumn:p,endLine:f,line:c,source:this.css},this.file&&(m&&(_.input.url=m(this.file).toString()),_.input.file=this.file),_}fromOffset(l){var c;if(this[w])c=this[w];else{var d=this.css.split("\n");c=new Array(d.length);for(var h=0,p=0,f=d.length;p<f;p++)c[p]=h,h+=d[p].length+1;this[w]=c}var m=0;if(l>=c[c.length-1])m=c.length-1;else for(var y,_=c.length-2;m<_;)if(l<c[y=m+(_-m>>1)])_=y-1;else{if(!(l>=c[y+1])){m=y;break}m=y+1}return{col:l-c[m]+1,line:m+1}}mapResolve(l){return/^\w+:\/\//.test(l)?l:d(this.map.consumer().sourceRoot||this.map.root||".",l)}origin(l,d,h,p){if(!this.map)return!1;var y,_,b=this.map.consumer(),w=b.originalPositionFor({column:d,line:l});if(!w.source)return!1;"number"==typeof h&&(y=b.originalPositionFor({column:p,line:h})),_=c(w.source)?m(w.source):new URL(w.source,this.map.consumer().sourceRoot||m(this.map.mapFile));var E={column:w.column,endColumn:y&&y.column,endLine:y&&y.line,line:w.line,url:_.toString()};if("file:"===_.protocol){if(!f)throw new Error("file: protocol is not available in this PostCSS build");E.file=f(_)}var M=b.sourceContentFor(w.source);return M&&(E.source=M),E}toJSON(){var l={};for(var c of["hasBOM","css","file","id"])null!=this[c]&&(l[c]=this[c]);return this.map&&(l.map=r2({},this.map),l.map.consumerCache&&(l.map.consumerCache=void 0)),l}get from(){return this.file||this.id}}return tn=v22,v22.default=v22,b&&b.registerInput&&b.registerInput(v22),tn}function yi2(){if(sn)return nn;sn=1;var l,c,d=di2();class i22 extends d{constructor(l){super(l),this.type="root",this.nodes||(this.nodes=[])}normalize(l,c,d){var h=super.normalize(l);if(c)if("prepend"===d)this.nodes.length>1?c.raws.before=this.nodes[1].raws.before:delete c.raws.before;else if(this.first!==c)for(var p of h)p.raws.before=c.raws.before;return h}removeChild(l,c){var d=this.index(l);return!c&&0===d&&this.nodes.length>1&&(this.nodes[1].raws.before=this.nodes[d].raws.before),super.removeChild(l)}toResult(d){return void 0===d&&(d={}),new l(new c,this,d).stringify()}}return i22.registerLazyResult=c=>{l=c},i22.registerProcessor=l=>{c=l},nn=i22,i22.default=i22,d.registerRoot(i22),nn}function bi2(){if(ln)return an;ln=1;var l={comma:c=>l.split(c,[","],!0),space:c=>l.split(c,[" ","\n","\t"]),split(l,c,d){var h=[],p="",f=!1,m=0,y=!1,_="",b=!1;for(var w of l)b?b=!1:"\\"===w?b=!0:y?w===_&&(y=!1):'"'===w||"'"===w?(y=!0,_=w):"("===w?m+=1:")"===w?m>0&&(m-=1):0===m&&c.includes(w)&&(f=!0),f?(""!==p&&h.push(p.trim()),p="",f=!1):p+=w;return(d||""!==p)&&h.push(p.trim()),h}};return an=l,l.default=l,an}function Si2(){if(dn)return un;dn=1;var l=di2(),c=bi2();class r22 extends l{constructor(l){super(l),this.type="rule",this.nodes||(this.nodes=[])}get selectors(){return c.comma(this.selector)}set selectors(l){var c=this.selector?this.selector.match(/,\s*/):null,d=c?c[0]:","+this.raw("between","beforeOpen");this.selector=l.join(d)}}return un=r22,r22.default=r22,l.registerRule(r22),un}function ki2(){if(Cn)return wn;Cn=1;var{dirname:l,relative:c,resolve:d,sep:h}=kr,{SourceMapConsumer:p,SourceMapGenerator:f}=kr,{pathToFileURL:m}=kr,y=wi2(),_=Boolean(p&&f),b=Boolean(l&&d&&c&&h);return wn=class{constructor(l,c,d,h){this.stringify=l,this.mapOpts=d.map||{},this.root=c,this.opts=d,this.css=h,this.originalCSS=h,this.usesFileUrls=!this.mapOpts.from&&this.mapOpts.absolute,this.memoizedFileURLs=new Map,this.memoizedPaths=new Map,this.memoizedURLs=new Map}addAnnotation(){var l;l=this.isInline()?"data:application/json;base64,"+this.toBase64(this.map.toString()):"string"==typeof this.mapOpts.annotation?this.mapOpts.annotation:"function"==typeof this.mapOpts.annotation?this.mapOpts.annotation(this.opts.to,this.root):this.outputFile()+".map";var c="\n";this.css.includes("\r\n")&&(c="\r\n"),this.css+=c+"/*# sourceMappingURL="+l+" */"}applyPrevMaps(){for(var c of this.previous()){var d=this.toUrl(this.path(c.file)),h=c.root||l(c.file),f=void 0;!1===this.mapOpts.sourcesContent?(f=new p(c.text)).sourcesContent&&(f.sourcesContent=null):f=c.consumer(),this.map.applySourceMap(f,d,this.toUrl(this.path(h)))}}clearAnnotation(){if(!1!==this.mapOpts.annotation)if(this.root)for(var l,c=this.root.nodes.length-1;c>=0;c--)"comment"===(l=this.root.nodes[c]).type&&l.text.startsWith("# sourceMappingURL=")&&this.root.removeChild(c);else this.css&&(this.css=this.css.replace(/\n*\/\*#[\S\s]*?\*\/$/gm,""))}generate(){if(this.clearAnnotation(),b&&_&&this.isMap())return this.generateMap();var l="";return this.stringify(this.root,(c=>{l+=c})),[l]}generateMap(){if(this.root)this.generateString();else if(1===this.previous().length){var l=this.previous()[0].consumer();l.file=this.outputFile(),this.map=f.fromSourceMap(l,{ignoreInvalidMapping:!0})}else this.map=new f({file:this.outputFile(),ignoreInvalidMapping:!0}),this.map.addMapping({generated:{column:0,line:1},original:{column:0,line:1},source:this.opts.from?this.toUrl(this.path(this.opts.from)):"<no source>"});return this.isSourcesContent()&&this.setSourcesContent(),this.root&&this.previous().length>0&&this.applyPrevMaps(),this.isAnnotation()&&this.addAnnotation(),this.isInline()?[this.css]:[this.css,this.map]}generateString(){this.css="",this.map=new f({file:this.outputFile(),ignoreInvalidMapping:!0});var l,c,d=1,h=1,p="<no source>",m={generated:{column:0,line:0},original:{column:0,line:0},source:""};this.stringify(this.root,((f,y,_)=>{if(this.css+=f,y&&"end"!==_&&(m.generated.line=d,m.generated.column=h-1,y.source&&y.source.start?(m.source=this.sourcePath(y),m.original.line=y.source.start.line,m.original.column=y.source.start.column-1,this.map.addMapping(m)):(m.source=p,m.original.line=1,m.original.column=0,this.map.addMapping(m))),(c=f.match(/\n/g))?(d+=c.length,l=f.lastIndexOf("\n"),h=f.length-l):h+=f.length,y&&"start"!==_){var b=y.parent||{raws:{}};("decl"===y.type||"atrule"===y.type&&!y.nodes)&&y===b.last&&!b.raws.semicolon||(y.source&&y.source.end?(m.source=this.sourcePath(y),m.original.line=y.source.end.line,m.original.column=y.source.end.column-1,m.generated.line=d,m.generated.column=h-2,this.map.addMapping(m)):(m.source=p,m.original.line=1,m.original.column=0,m.generated.line=d,m.generated.column=h-1,this.map.addMapping(m)))}}))}isAnnotation(){return!!this.isInline()||(void 0!==this.mapOpts.annotation?this.mapOpts.annotation:!this.previous().length||this.previous().some((l=>l.annotation)))}isInline(){if(void 0!==this.mapOpts.inline)return this.mapOpts.inline;var l=this.mapOpts.annotation;return(void 0===l||!0===l)&&(!this.previous().length||this.previous().some((l=>l.inline)))}isMap(){return void 0!==this.opts.map?!!this.opts.map:this.previous().length>0}isSourcesContent(){return void 0!==this.mapOpts.sourcesContent?this.mapOpts.sourcesContent:!this.previous().length||this.previous().some((l=>l.withContent()))}outputFile(){return this.opts.to?this.path(this.opts.to):this.opts.from?this.path(this.opts.from):"to.css"}path(h){if(this.mapOpts.absolute)return h;if(60===h.charCodeAt(0))return h;if(/^\w+:\/\//.test(h))return h;var p=this.memoizedPaths.get(h);if(p)return p;var f=this.opts.to?l(this.opts.to):".";"string"==typeof this.mapOpts.annotation&&(f=l(d(f,this.mapOpts.annotation)));var m=c(f,h);return this.memoizedPaths.set(h,m),m}previous(){if(!this.previousMaps)if(this.previousMaps=[],this.root)this.root.walk((l=>{if(l.source&&l.source.input.map){var c=l.source.input.map;this.previousMaps.includes(c)||this.previousMaps.push(c)}}));else{var l=new y(this.originalCSS,this.opts);l.map&&this.previousMaps.push(l.map)}return this.previousMaps}setSourcesContent(){var l={};if(this.root)this.root.walk((c=>{if(c.source){var d=c.source.input.from;if(d&&!l[d]){l[d]=!0;var h=this.usesFileUrls?this.toFileUrl(d):this.toUrl(this.path(d));this.map.setSourceContent(h,c.source.input.css)}}}));else if(this.css){var c=this.opts.from?this.toUrl(this.path(this.opts.from)):"<no source>";this.map.setSourceContent(c,this.css)}}sourcePath(l){return this.mapOpts.from?this.toUrl(this.mapOpts.from):this.usesFileUrls?this.toFileUrl(l.source.input.from):this.toUrl(this.path(l.source.input.from))}toBase64(l){return Buffer?Buffer.from(l).toString("base64"):window.btoa(unescape(encodeURIComponent(l)))}toFileUrl(l){var c=this.memoizedFileURLs.get(l);if(c)return c;if(m){var d=m(l).toString();return this.memoizedFileURLs.set(l,d),d}throw new Error("`map.absolute` option is not available in this PostCSS build")}toUrl(l){var c=this.memoizedURLs.get(l);if(c)return c;"\\"===h&&(l=l.replace(/\\/g,"/"));var d=encodeURI(l).replace(/[#?]/g,encodeURIComponent);return this.memoizedURLs.set(l,d),d}}}function Ci2(){if(Ln)return On;Ln=1;var l="'".charCodeAt(0),c='"'.charCodeAt(0),d="\\".charCodeAt(0),h="/".charCodeAt(0),p="\n".charCodeAt(0),f=" ".charCodeAt(0),m="\f".charCodeAt(0),y="\t".charCodeAt(0),_="\r".charCodeAt(0),b="[".charCodeAt(0),w="]".charCodeAt(0),E="(".charCodeAt(0),M=")".charCodeAt(0),N="{".charCodeAt(0),P="}".charCodeAt(0),L=";".charCodeAt(0),j="*".charCodeAt(0),D=":".charCodeAt(0),F="@".charCodeAt(0),U=/[\t\n\f\r "#'()/;[\\\]{}]/g,B=/[\t\n\f\r !"#'():;@[\\\]{}]|\/(?=\*)/g,H=/.[\r\n"'(/\\]/,z=/[\da-f]/i;return On=function(q,V){void 0===V&&(V={});var Z,K,Y,ee,ne,se,ie,oe,le,ce,pe=q.css.valueOf(),fe=V.ignoreErrors,ge=pe.length,be=0,Oe=[],Ne=[];function W22(l){throw q.error("Unclosed "+l,be)}return{back:function(l){Ne.push(l)},endOfFile:function(){return 0===Ne.length&&be>=ge},nextToken:function(q){if(Ne.length)return Ne.pop();if(!(be>=ge)){var V=!!q&&q.ignoreUnclosed;switch(Z=pe.charCodeAt(be)){case p:case f:case y:case _:case m:ee=be;do{ee+=1,Z=pe.charCodeAt(ee)}while(Z===f||Z===p||Z===y||Z===_||Z===m);se=["space",pe.slice(be,ee)],be=ee-1;break;case b:case w:case N:case P:case D:case L:case M:var De=String.fromCharCode(Z);se=[De,De,be];break;case E:if(ce=Oe.length?Oe.pop()[1]:"",le=pe.charCodeAt(be+1),"url"===ce&&le!==l&&le!==c&&le!==f&&le!==p&&le!==y&&le!==m&&le!==_){ee=be;do{if(ie=!1,-1===(ee=pe.indexOf(")",ee+1))){if(fe||V){ee=be;break}W22("bracket")}for(oe=ee;pe.charCodeAt(oe-1)===d;)oe-=1,ie=!ie}while(ie);se=["brackets",pe.slice(be,ee+1),be,ee],be=ee}else ee=pe.indexOf(")",be+1),K=pe.slice(be,ee+1),-1===ee||H.test(K)?se=["(","(",be]:(se=["brackets",K,be,ee],be=ee);break;case l:case c:ne=Z===l?"'":'"',ee=be;do{if(ie=!1,-1===(ee=pe.indexOf(ne,ee+1))){if(fe||V){ee=be+1;break}W22("string")}for(oe=ee;pe.charCodeAt(oe-1)===d;)oe-=1,ie=!ie}while(ie);se=["string",pe.slice(be,ee+1),be,ee],be=ee;break;case F:U.lastIndex=be+1,U.test(pe),ee=0===U.lastIndex?pe.length-1:U.lastIndex-2,se=["at-word",pe.slice(be,ee+1),be,ee],be=ee;break;case d:for(ee=be,Y=!0;pe.charCodeAt(ee+1)===d;)ee+=1,Y=!Y;if(Z=pe.charCodeAt(ee+1),Y&&Z!==h&&Z!==f&&Z!==p&&Z!==y&&Z!==_&&Z!==m&&(ee+=1,z.test(pe.charAt(ee)))){for(;z.test(pe.charAt(ee+1));)ee+=1;pe.charCodeAt(ee+1)===f&&(ee+=1)}se=["word",pe.slice(be,ee+1),be,ee],be=ee;break;default:Z===h&&pe.charCodeAt(be+1)===j?(0===(ee=pe.indexOf("*/",be+2)+1)&&(fe||V?ee=pe.length:W22("comment")),se=["comment",pe.slice(be,ee+1),be,ee],be=ee):(B.lastIndex=be+1,B.test(pe),ee=0===B.lastIndex?pe.length-1:B.lastIndex-2,se=["word",pe.slice(be,ee+1),be,ee],Oe.push(se),be=ee)}return be++,se}},position:function(){return be}}}}function Ii2(){if(Dn)return jn;Dn=1;var l=vi2(),c=ci2(),d=fi2(),h=yi2(),p=Si2(),f=Ci2(),m={empty:!0,space:!0};return jn=class{constructor(l){this.input=l,this.root=new h,this.current=this.root,this.spaces="",this.semicolon=!1,this.createTokenizer(),this.root.source={input:l,start:{column:1,line:1,offset:0}}}atrule(c){var d,h,p,f=new l;f.name=c[1].slice(1),""===f.name&&this.unnamedAtrule(f,c),this.init(f,c[2]);for(var m=!1,y=!1,_=[],b=[];!this.tokenizer.endOfFile();){if("("===(d=(c=this.tokenizer.nextToken())[0])||"["===d?b.push("("===d?")":"]"):"{"===d&&b.length>0?b.push("}"):d===b[b.length-1]&&b.pop(),0===b.length){if(";"===d){f.source.end=this.getPosition(c[2]),f.source.end.offset++,this.semicolon=!0;break}if("{"===d){y=!0;break}if("}"===d){if(_.length>0){for(h=_[p=_.length-1];h&&"space"===h[0];)h=_[--p];h&&(f.source.end=this.getPosition(h[3]||h[2]),f.source.end.offset++)}this.end(c);break}_.push(c)}else _.push(c);if(this.tokenizer.endOfFile()){m=!0;break}}f.raws.between=this.spacesAndCommentsFromEnd(_),_.length?(f.raws.afterName=this.spacesAndCommentsFromStart(_),this.raw(f,"params",_),m&&(c=_[_.length-1],f.source.end=this.getPosition(c[3]||c[2]),f.source.end.offset++,this.spaces=f.raws.between,f.raws.between="")):(f.raws.afterName="",f.params=""),y&&(f.nodes=[],this.current=f)}checkMissedSemicolon(l){var c=this.colon(l);if(!1!==c){for(var d,h=0,p=c-1;p>=0&&("space"===(d=l[p])[0]||2!==(h+=1));p--);throw this.input.error("Missed semicolon","word"===d[0]?d[3]+1:d[2])}}colon(l){var c,d,h,p=0;for(var[f,m]of l.entries()){if("("===(h=(d=m)[0])&&(p+=1),")"===h&&(p-=1),0===p&&":"===h){if(c){if("word"===c[0]&&"progid"===c[1])continue;return f}this.doubleColon(d)}c=d}return!1}comment(l){var d=new c;this.init(d,l[2]),d.source.end=this.getPosition(l[3]||l[2]),d.source.end.offset++;var h=l[1].slice(2,-2);if(/^\s*$/.test(h))d.text="",d.raws.left=h,d.raws.right="";else{var p=h.match(/^(\s*)([^]*\S)(\s*)$/);d.text=p[2],d.raws.left=p[1],d.raws.right=p[3]}}createTokenizer(){this.tokenizer=f(this.input)}decl(l,c){var h=new d;this.init(h,l[0][2]);var p,f=l[l.length-1];for(";"===f[0]&&(this.semicolon=!0,l.pop()),h.source.end=this.getPosition(f[3]||f[2]||function(l){for(var c=l.length-1;c>=0;c--){var d=l[c],h=d[3]||d[2];if(h)return h}}(l)),h.source.end.offset++;"word"!==l[0][0];)1===l.length&&this.unknownWord(l),h.raws.before+=l.shift()[1];for(h.source.start=this.getPosition(l[0][2]),h.prop="";l.length;){var m=l[0][0];if(":"===m||"space"===m||"comment"===m)break;h.prop+=l.shift()[1]}for(h.raws.between="";l.length;){if(":"===(p=l.shift())[0]){h.raws.between+=p[1];break}"word"===p[0]&&/\w/.test(p[1])&&this.unknownWord([p]),h.raws.between+=p[1]}"_"!==h.prop[0]&&"*"!==h.prop[0]||(h.raws.before+=h.prop[0],h.prop=h.prop.slice(1));for(var y,_=[];l.length&&("space"===(y=l[0][0])||"comment"===y);)_.push(l.shift());this.precheckMissedSemicolon(l);for(var b=l.length-1;b>=0;b--){if("!important"===(p=l[b])[1].toLowerCase()){h.important=!0;var w=this.stringFrom(l,b);" !important"!==(w=this.spacesFromEnd(l)+w)&&(h.raws.important=w);break}if("important"===p[1].toLowerCase()){for(var E=l.slice(0),M="",N=b;N>0;N--){var P=E[N][0];if(M.trim().startsWith("!")&&"space"!==P)break;M=E.pop()[1]+M}M.trim().startsWith("!")&&(h.important=!0,h.raws.important=M,l=E)}if("space"!==p[0]&&"comment"!==p[0])break}l.some((l=>"space"!==l[0]&&"comment"!==l[0]))&&(h.raws.between+=_.map((l=>l[1])).join(""),_=[]),this.raw(h,"value",_.concat(l),c),h.value.includes(":")&&!c&&this.checkMissedSemicolon(l)}doubleColon(l){throw this.input.error("Double colon",{offset:l[2]},{offset:l[2]+l[1].length})}emptyRule(l){var c=new p;this.init(c,l[2]),c.selector="",c.raws.between="",this.current=c}end(l){this.current.nodes&&this.current.nodes.length&&(this.current.raws.semicolon=this.semicolon),this.semicolon=!1,this.current.raws.after=(this.current.raws.after||"")+this.spaces,this.spaces="",this.current.parent?(this.current.source.end=this.getPosition(l[2]),this.current.source.end.offset++,this.current=this.current.parent):this.unexpectedClose(l)}endFile(){this.current.parent&&this.unclosedBlock(),this.current.nodes&&this.current.nodes.length&&(this.current.raws.semicolon=this.semicolon),this.current.raws.after=(this.current.raws.after||"")+this.spaces,this.root.source.end=this.getPosition(this.tokenizer.position())}freeSemicolon(l){if(this.spaces+=l[1],this.current.nodes){var c=this.current.nodes[this.current.nodes.length-1];c&&"rule"===c.type&&!c.raws.ownSemicolon&&(c.raws.ownSemicolon=this.spaces,this.spaces="")}}getPosition(l){var c=this.input.fromOffset(l);return{column:c.col,line:c.line,offset:l}}init(l,c){this.current.push(l),l.source={input:this.input,start:this.getPosition(c)},l.raws.before=this.spaces,this.spaces="","comment"!==l.type&&(this.semicolon=!1)}other(l){for(var c=!1,d=null,h=!1,p=null,f=[],m=l[1].startsWith("--"),y=[],_=l;_;){if(d=_[0],y.push(_),"("===d||"["===d)p||(p=_),f.push("("===d?")":"]");else if(m&&h&&"{"===d)p||(p=_),f.push("}");else if(0===f.length){if(";"===d){if(h)return void this.decl(y,m);break}if("{"===d)return void this.rule(y);if("}"===d){this.tokenizer.back(y.pop()),c=!0;break}":"===d&&(h=!0)}else d===f[f.length-1]&&(f.pop(),0===f.length&&(p=null));_=this.tokenizer.nextToken()}if(this.tokenizer.endOfFile()&&(c=!0),f.length>0&&this.unclosedBracket(p),c&&h){if(!m)for(;y.length&&("space"===(_=y[y.length-1][0])||"comment"===_);)this.tokenizer.back(y.pop());this.decl(y,m)}else this.unknownWord(y)}parse(){for(var l;!this.tokenizer.endOfFile();)switch((l=this.tokenizer.nextToken())[0]){case"space":this.spaces+=l[1];break;case";":this.freeSemicolon(l);break;case"}":this.end(l);break;case"comment":this.comment(l);break;case"at-word":this.atrule(l);break;case"{":this.emptyRule(l);break;default:this.other(l)}this.endFile()}precheckMissedSemicolon(){}raw(l,c,d,h){for(var p,f,y,_,b=d.length,w="",E=!0,M=0;M<b;M+=1)"space"!==(f=(p=d[M])[0])||M!==b-1||h?"comment"===f?(_=d[M-1]?d[M-1][0]:"empty",y=d[M+1]?d[M+1][0]:"empty",m[_]||m[y]||","===w.slice(-1)?E=!1:w+=p[1]):w+=p[1]:E=!1;if(!E){var N=d.reduce(((l,c)=>l+c[1]),"");l.raws[c]={raw:N,value:w}}l[c]=w}rule(l){l.pop();var c=new p;this.init(c,l[0][2]),c.raws.between=this.spacesAndCommentsFromEnd(l),this.raw(c,"selector",l),this.current=c}spacesAndCommentsFromEnd(l){for(var c,d="";l.length&&("space"===(c=l[l.length-1][0])||"comment"===c);)d=l.pop()[1]+d;return d}spacesAndCommentsFromStart(l){for(var c,d="";l.length&&("space"===(c=l[0][0])||"comment"===c);)d+=l.shift()[1];return d}spacesFromEnd(l){for(var c="";l.length&&"space"===l[l.length-1][0];)c=l.pop()[1]+c;return c}stringFrom(l,c){for(var d="",h=c;h<l.length;h++)d+=l[h][1];return l.splice(c,l.length-c),d}unclosedBlock(){var l=this.current.source.start;throw this.input.error("Unclosed block",l.line,l.column)}unclosedBracket(l){throw this.input.error("Unclosed bracket",{offset:l[2]},{offset:l[2]+1})}unexpectedClose(l){throw this.input.error("Unexpected }",{offset:l[2]},{offset:l[2]+1})}unknownWord(l){throw this.input.error("Unknown word",{offset:l[0][2]},{offset:l[0][2]+l[0][1].length})}unnamedAtrule(l,c){throw this.input.error("At-rule without name",{offset:c[2]},{offset:c[2]+c[1].length})}}}function Mi2(){if($n)return Fn;$n=1;var l=di2(),c=wi2(),d=Ii2();function i22(l,h){var p=new c(l,h),f=new d(p);try{f.parse()}catch(m){throw m}return f.root}return Fn=i22,i22.default=i22,l.registerParse(i22),Fn}function Ri2(){if(Bn)return Un;Bn=1;class t22{constructor(l,c){if(void 0===c&&(c={}),this.type="warning",this.text=l,c.node&&c.node.source){var d=c.node.rangeBy(c);this.line=d.start.line,this.column=d.start.column,this.endLine=d.end.line,this.endColumn=d.end.column}for(var h in c)this[h]=c[h]}toString(){return this.node?this.node.error(this.text,{index:this.index,plugin:this.plugin,word:this.word}).message:this.plugin?this.plugin+": "+this.text:this.text}}return Un=t22,t22.default=t22,Un}function xi2(){if(zn)return Hn;zn=1;var l=Ri2();class e22{constructor(l,c,d){this.processor=l,this.messages=[],this.root=c,this.opts=d,this.css=void 0,this.map=void 0}toString(){return this.css}warn(c,d){void 0===d&&(d={}),d.plugin||this.lastPlugin&&this.lastPlugin.postcssPlugin&&(d.plugin=this.lastPlugin.postcssPlugin);var h=new l(c,d);return this.messages.push(h),h}warnings(){return this.messages.filter((l=>"warning"===l.type))}get content(){return this.css}}return Hn=e22,e22.default=e22,Hn}function Oi2(){if(Wn)return qn;Wn=1;var l=di2(),c=pi2(),d=ki2(),h=Mi2(),p=xi2(),f=yi2(),m=hr2(),{isClean:y,my:_}=ui2(),b={atrule:"AtRule",comment:"Comment",decl:"Declaration",document:"Document",root:"Root",rule:"Rule"},w={AtRule:!0,AtRuleExit:!0,Comment:!0,CommentExit:!0,Declaration:!0,DeclarationExit:!0,Document:!0,DocumentExit:!0,Once:!0,OnceExit:!0,postcssPlugin:!0,prepare:!0,Root:!0,RootExit:!0,Rule:!0,RuleExit:!0},E={Once:!0,postcssPlugin:!0,prepare:!0};function m22(l){return"object"==typeof l&&"function"==typeof l.then}function g22(l){var c=!1,d=b[l.type];return"decl"===l.type?c=l.prop.toLowerCase():"atrule"===l.type&&(c=l.name.toLowerCase()),c&&l.append?[d,d+"-"+c,0,d+"Exit",d+"Exit-"+c]:c?[d,d+"-"+c,d+"Exit",d+"Exit-"+c]:l.append?[d,0,d+"Exit"]:[d,d+"Exit"]}function w22(l){return{eventIndex:0,events:"document"===l.type?["Document",0,"DocumentExit"]:"root"===l.type?["Root",0,"RootExit"]:g22(l),iterator:0,node:l,visitorIndex:0,visitors:[]}}function y22(l){return l[y]=!1,l.nodes&&l.nodes.forEach((l=>y22(l))),l}var M={};class S22{constructor(c,d,f){var m;if(this.stringified=!1,this.processed=!1,"object"!=typeof d||null===d||"root"!==d.type&&"document"!==d.type)if(d instanceof S22||d instanceof p)m=y22(d.root),d.map&&(void 0===f.map&&(f.map={}),f.map.inline||(f.map.inline=!1),f.map.prev=d.map);else{var y=h;f.syntax&&(y=f.syntax.parse),f.parser&&(y=f.parser),y.parse&&(y=y.parse);try{m=y(d,f)}catch(b){this.processed=!0,this.error=b}m&&!m[_]&&l.rebuild(m)}else m=y22(d);this.result=new p(c,m,f),this.helpers=r2({},M,{postcss:M,result:this.result}),this.plugins=this.processor.plugins.map((l=>"object"==typeof l&&l.prepare?r2({},l,l.prepare(this.result)):l))}async(){return this.error?Promise.reject(this.error):this.processed?Promise.resolve(this.result):(this.processing||(this.processing=this.runAsync()),this.processing)}catch(l){return this.async().catch(l)}finally(l){return this.async().then(l,l)}getAsyncError(){throw new Error("Use process(css).then(cb) to work with async plugins")}handleError(l,c){var d=this.result.lastPlugin;try{if(c&&c.addToError(l),this.error=l,"CssSyntaxError"!==l.name||l.plugin)d.postcssVersion,0;else l.plugin=d.postcssPlugin,l.setMessage()}catch(h){console&&console.error&&console.error(h)}return l}prepareVisitors(){this.listeners={};var t3=(l,c,d)=>{this.listeners[c]||(this.listeners[c]=[]),this.listeners[c].push([l,d])};for(var l of this.plugins)if("object"==typeof l)for(var c in l){if(!w[c]&&/^[A-Z]/.test(c))throw new Error("Unknown event "+c+" in "+l.postcssPlugin+". Try to update PostCSS ("+this.processor.version+" now).");if(!E[c])if("object"==typeof l[c])for(var d in l[c])t3(l,"*"===d?c:c+"-"+d.toLowerCase(),l[c][d]);else"function"==typeof l[c]&&t3(l,c,l[c])}this.hasListener=Object.keys(this.listeners).length>0}runAsync(){var l=this;return e3((function*(){l.plugin=0;for(var c=0;c<l.plugins.length;c++){var d=l.plugins[c],h=l.runOnRoot(d);if(m22(h))try{yield h}catch(E){throw l.handleError(E)}}if(l.prepareVisitors(),l.hasListener){for(var p=l.result.root;!p[y];){p[y]=!0;for(var f=[w22(p)];f.length>0;){var m=l.visitTick(f);if(m22(m))try{yield m}catch(E){var _=f[f.length-1].node;throw l.handleError(E,_)}}}if(l.listeners.OnceExit){var h3=function*(c){l.result.lastPlugin=b;try{if("document"===p.type){var d=p.nodes.map((d=>c(d,l.helpers)));yield Promise.all(d)}else yield c(p,l.helpers)}catch(h){throw l.handleError(h)}};for(var[b,w]of l.listeners.OnceExit)yield*h3(w)}}return l.processed=!0,l.stringify()}))()}runOnRoot(l){this.result.lastPlugin=l;try{if("object"==typeof l&&l.Once){if("document"===this.result.root.type){var c=this.result.root.nodes.map((c=>l.Once(c,this.helpers)));return m22(c[0])?Promise.all(c):c}return l.Once(this.result.root,this.helpers)}if("function"==typeof l)return l(this.result.root,this.result)}catch(d){throw this.handleError(d)}}stringify(){if(this.error)throw this.error;if(this.stringified)return this.result;this.stringified=!0,this.sync();var l=this.result.opts,c=m;l.syntax&&(c=l.syntax.stringify),l.stringifier&&(c=l.stringifier),c.stringify&&(c=c.stringify);var h=new d(c,this.result.root,this.result.opts).generate();return this.result.css=h[0],this.result.map=h[1],this.result}sync(){if(this.error)throw this.error;if(this.processed)return this.result;if(this.processed=!0,this.processing)throw this.getAsyncError();for(var l of this.plugins)if(m22(this.runOnRoot(l)))throw this.getAsyncError();if(this.prepareVisitors(),this.hasListener){for(var c=this.result.root;!c[y];)c[y]=!0,this.walkSync(c);if(this.listeners.OnceExit)if("document"===c.type)for(var d of c.nodes)this.visitSync(this.listeners.OnceExit,d);else this.visitSync(this.listeners.OnceExit,c)}return this.result}then(l,c){return this.async().then(l,c)}toString(){return this.css}visitSync(l,c){for(var[d,h]of l){this.result.lastPlugin=d;var p=void 0;try{p=h(c,this.helpers)}catch(f){throw this.handleError(f,c.proxyOf)}if("root"!==c.type&&"document"!==c.type&&!c.parent)return!0;if(m22(p))throw this.getAsyncError()}}visitTick(l){var c=l[l.length-1],{node:d,visitors:h}=c;if("root"===d.type||"document"===d.type||d.parent){if(h.length>0&&c.visitorIndex<h.length){var[p,f]=h[c.visitorIndex];c.visitorIndex+=1,c.visitorIndex===h.length&&(c.visitors=[],c.visitorIndex=0),this.result.lastPlugin=p;try{return f(d.toProxy(),this.helpers)}catch(E){throw this.handleError(E,d)}}if(0!==c.iterator){for(var m,_=c.iterator;m=d.nodes[d.indexes[_]];)if(d.indexes[_]+=1,!m[y])return m[y]=!0,void l.push(w22(m));c.iterator=0,delete d.indexes[_]}for(var b=c.events;c.eventIndex<b.length;){var w=b[c.eventIndex];if(c.eventIndex+=1,0===w)return void(d.nodes&&d.nodes.length&&(d[y]=!0,c.iterator=d.getIterator()));if(this.listeners[w])return void(c.visitors=this.listeners[w])}l.pop()}else l.pop()}walkSync(l){l[y]=!0;var c=g22(l);for(var d of c)if(0===d)l.nodes&&l.each((l=>{l[y]||this.walkSync(l)}));else{var h=this.listeners[d];if(h&&this.visitSync(h,l.toProxy()))return}}warnings(){return this.sync().warnings()}get content(){return this.stringify().content}get css(){return this.stringify().css}get map(){return this.stringify().map}get messages(){return this.sync().messages}get opts(){return this.result.opts}get processor(){return this.result.processor}get root(){return this.sync().root}get[Symbol.toStringTag](){return"LazyResult"}}return S22.registerPostcss=l=>{M=l},qn=S22,S22.default=S22,f.registerLazyResult(S22),c.registerLazyResult(S22),qn}function Ei2(){if(Yn)return Jn;Yn=1;var l=vi2(),c=ci2(),d=di2(),h=or2(),m=fi2(),y=pi2(),_=function(){if(pn)return hn;pn=1;var l=vi2(),c=ci2(),d=fi2(),h=wi2(),m=gi2(),y=yi2(),_=Si2();function c3(b,w){if(Array.isArray(b))return b.map((l=>c3(l)));var{inputs:E}=b,M=i2(b,p);if(E)for(var N of(w=[],E)){var P=r2({},N,{__proto__:h.prototype});P.map&&(P.map=r2({},P.map,{__proto__:m.prototype})),w.push(P)}if(M.nodes&&(M.nodes=b.nodes.map((l=>c3(l,w)))),M.source){var L=M.source,{inputId:j}=L,D=i2(L,f);M.source=D,null!=j&&(M.source.input=w[j])}if("root"===M.type)return new y(M);if("decl"===M.type)return new d(M);if("rule"===M.type)return new _(M);if("comment"===M.type)return new c(M);if("atrule"===M.type)return new l(M);throw new Error("Unknown node type: "+b.type)}return hn=c3,c3.default=c3,hn}(),b=wi2(),w=Oi2(),E=bi2(),M=li2(),N=Mi2(),P=function(){if(Kn)return Gn;Kn=1;var l=pi2(),c=Oi2(),d=function(){if(Zn)return Vn;Zn=1;var l=ki2(),c=Mi2(),d=xi2(),h=hr2();class s22{constructor(c,p,f){var m;p=p.toString(),this.stringified=!1,this._processor=c,this._css=p,this._opts=f,this._map=void 0;var y=h;this.result=new d(this._processor,m,this._opts),this.result.css=p;var _=this;Object.defineProperty(this.result,"root",{get:()=>_.root});var b=new l(y,m,this._opts,p);if(b.isMap()){var[w,E]=b.generate();w&&(this.result.css=w),E&&(this.result.map=E)}else b.clearAnnotation(),this.result.css=b.css}async(){return this.error?Promise.reject(this.error):Promise.resolve(this.result)}catch(l){return this.async().catch(l)}finally(l){return this.async().then(l,l)}sync(){if(this.error)throw this.error;return this.result}then(l,c){return this.async().then(l,c)}toString(){return this._css}warnings(){return[]}get content(){return this.result.css}get css(){return this.result.css}get map(){return this.result.map}get messages(){return[]}get opts(){return this.result.opts}get processor(){return this.result.processor}get root(){if(this._root)return this._root;var l,d=c;try{l=d(this._css,this._opts)}catch(h){this.error=h}if(this.error)throw this.error;return this._root=l,l}get[Symbol.toStringTag](){return"NoWorkResult"}}return Vn=s22,s22.default=s22,Vn}(),h=yi2();class n22{constructor(l){void 0===l&&(l=[]),this.version="8.5.1",this.plugins=this.normalize(l)}normalize(l){var c=[];for(var d of l)if(!0===d.postcss?d=d():d.postcss&&(d=d.postcss),"object"==typeof d&&Array.isArray(d.plugins))c=c.concat(d.plugins);else if("object"==typeof d&&d.postcssPlugin)c.push(d);else if("function"==typeof d)c.push(d);else if("object"!=typeof d||!d.parse&&!d.stringify)throw new Error(d+" is not a PostCSS plugin");return c}process(l,h){return void 0===h&&(h={}),this.plugins.length||h.parser||h.stringifier||h.syntax?new c(this,l,h):new d(this,l,h)}use(l){return this.plugins=this.plugins.concat(this.normalize([l])),this}}return Gn=n22,n22.default=n22,h.registerProcessor(n22),l.registerProcessor(n22),Gn}(),L=xi2(),j=yi2(),D=Si2(),F=hr2(),U=Ri2();function k22(){for(var l=arguments.length,c=new Array(l),d=0;d<l;d++)c[d]=arguments[d];return 1===c.length&&Array.isArray(c[0])&&(c=c[0]),new P(c)}return k22.plugin=function(l,c){var d,h=!1;function n3(){console&&console.warn&&!h&&(h=!0,console.warn(l+": postcss.plugin was deprecated. Migration guide:\nhttps://evilmartians.com/chronicles/postcss-8-plugin-migration"),Ab.LANG&&Ab.LANG.startsWith("cn")&&console.warn(l+": \u91cc\u9762 postcss.plugin \u88ab\u5f03\u7528. \u8fc1\u79fb\u6307\u5357:\nhttps://www.w3ctech.com/topic/2226"));var d=c(...arguments);return d.postcssPlugin=l,d.postcssVersion=(new P).version,d}return Object.defineProperty(n3,"postcss",{get:()=>(d||(d=n3()),d)}),n3.process=function(l,c,d){return k22([n3(d)]).process(l,c)},n3},k22.stringify=F,k22.parse=N,k22.fromJSON=_,k22.list=E,k22.comment=l=>new c(l),k22.atRule=c=>new l(c),k22.decl=l=>new m(l),k22.rule=l=>new D(l),k22.root=l=>new j(l),k22.document=l=>new y(l),k22.CssSyntaxError=h,k22.Declaration=m,k22.Container=d,k22.Processor=P,k22.Document=y,k22.Comment=c,k22.Warning=U,k22.AtRule=l,k22.Result=L,k22.Input=b,k22.Rule=D,k22.Root=j,k22.Node=M,w.registerPostcss(k22),Jn=k22,k22.default=k22,Jn}!function(){if(ts)return es;ts=1;var{Input:l}=Ei2(),c=function(){if(Xn)return Qn;Xn=1;var l=ci2(),c=Ii2(),d=Ci2();return Qn=class extends c{checkMissedSemicolon(){}comment(c){var d=new l;this.init(d,c[2]);var h=this.input.fromOffset(c[3])||this.input.fromOffset(this.input.css.length-1);d.source.end={column:h.col,line:h.line,offset:c[3]+1};var p=c[1].slice(2);if("*/"===p.slice(-2)&&(p=p.slice(0,-2)),/^\s*$/.test(p))d.text="",d.raws.left=p,d.raws.right="";else{var f=p.match(/^(\s*)([^]*\S)(\s*)$/);d.text=f[2],d.raws.left=f[1],d.raws.right=f[3]}}createTokenizer(){this.tokenizer=d(this.input,{ignoreErrors:!0})}decl(l){l.length>1&&l.some((l=>"word"===l[0]))&&super.decl(l)}doubleColon(){}endFile(){for(this.current.nodes&&this.current.nodes.length&&(this.current.raws.semicolon=this.semicolon),this.current.raws.after=(this.current.raws.after||"")+this.spaces;this.current.parent;)this.current=this.current.parent,this.current.raws.after="";this.root.source.end=this.getPosition(this.tokenizer.position())}precheckMissedSemicolon(l){var c=this.colon(l);if(!1!==c){var d,h;for(d=c-1;d>=0&&"word"!==l[d][0];d--);if(!(0===d||d<0)){for(h=d-1;h>=0;h--)if("space"!==l[h][0]){h+=1;break}var p=l.slice(d),f=l.slice(h,d);l.splice(h,l.length-h),this.spaces=f.map((l=>l[1])).join(""),this.decl(p)}}}unclosedBracket(){}unexpectedClose(){this.current.raws.after+="}"}unknownWord(l){this.spaces+=l.map((l=>l[1])).join("")}unnamedAtrule(l){l.name=""}}}();es=function(d,h){var p=new l(d,h),f=new c(p);return f.parse(),f.root}}();var ns=function(l){return l&&l.__esModule&&Object.prototype.hasOwnProperty.call(l,"default")?l.default:l}(Ei2());ns.stringify,ns.fromJSON,ns.plugin,ns.parse,ns.list,ns.document,ns.comment,ns.atRule,ns.rule,ns.decl,ns.root,ns.CssSyntaxError,ns.Declaration,ns.Container,ns.Processor,ns.Document,ns.Comment,ns.Warning,ns.AtRule,ns.Result,ns.Input,ns.Rule,ns.Root,ns.Node;class Bi2{constructor(){Ve2(this,"parentElement",null),Ve2(this,"parentNode",null),Ve2(this,"ownerDocument"),Ve2(this,"firstChild",null),Ve2(this,"lastChild",null),Ve2(this,"previousSibling",null),Ve2(this,"nextSibling",null),Ve2(this,"ELEMENT_NODE",1),Ve2(this,"TEXT_NODE",3),Ve2(this,"nodeType"),Ve2(this,"nodeName"),Ve2(this,"RRNodeType")}get childNodes(){for(var l=[],c=this.firstChild;c;)l.push(c),c=c.nextSibling;return l}contains(l){if(!(l instanceof Bi2))return!1;if(l.ownerDocument!==this.ownerDocument)return!1;if(l===this)return!0;for(;l.parentNode;){if(l.parentNode===this)return!0;l=l.parentNode}return!1}appendChild(l){throw new Error("RRDomException: Failed to execute 'appendChild' on 'RRNode': This RRNode type does not support this method.")}insertBefore(l,c){throw new Error("RRDomException: Failed to execute 'insertBefore' on 'RRNode': This RRNode type does not support this method.")}removeChild(l){throw new Error("RRDomException: Failed to execute 'removeChild' on 'RRNode': This RRNode type does not support this method.")}toString(){return"RRNode"}}var ss={Node:["childNodes","parentNode","parentElement","textContent"],ShadowRoot:["host","styleSheets"],Element:["shadowRoot","querySelector","querySelectorAll"],MutationObserver:[]},is={Node:["contains","getRootNode"],ShadowRoot:["getSelection"],Element:[],MutationObserver:["constructor"]},os={};function ji2(l){if(os[l])return os[l];var c,d,h,p,f=(c=l,((p=null==(h=null==(d=null==globalThis?void 0:globalThis.Zone)?void 0:d.__symbol__)?void 0:h.call(d,c))&&globalThis[p]?globalThis[p]:void 0)||globalThis[l]),m=f.prototype,y=l in ss?ss[l]:void 0,_=Boolean(y&&y.every((l=>{var c,d;return Boolean(null==(d=null==(c=Object.getOwnPropertyDescriptor(m,l))?void 0:c.get)?void 0:d.toString().includes("[native code]"))}))),b=l in is?is[l]:void 0,w=Boolean(b&&b.every((l=>{var c;return"function"==typeof m[l]&&(null==(c=m[l])?void 0:c.toString().includes("[native code]"))})));if(_&&w)return os[l]=f.prototype,f.prototype;try{var E=document.createElement("iframe");document.body.appendChild(E);var M=E.contentWindow;if(!M)return f.prototype;var N=M[l].prototype;return document.body.removeChild(E),N?os[l]=N:m}catch(c){return m}}var as={};function Ui2(l,c,d){var h,p=l+"."+String(d);if(as[p])return as[p].call(c);var f=ji2(l),m=null==(h=Object.getOwnPropertyDescriptor(f,d))?void 0:h.get;return m?(as[p]=m,m.call(c)):c[d]}var ls={};function $i2(l,c,d){var h=l+"."+String(d);if(ls[h])return ls[h].bind(c);var p=ji2(l)[d];return"function"!=typeof p?c[d]:(ls[h]=p,p.bind(c))}function Wi2(){return ji2("MutationObserver").constructor}function qi2(l,c,d){try{if(!(c in l))return()=>{};var h=l[c],p=d(h);return"function"==typeof p&&(p.prototype=p.prototype||{},Object.defineProperties(p,{__rrweb_original__:{enumerable:!1,value:h}})),l[c]=p,()=>{l[c]=h}}catch(f){return()=>{}}}var zi2_childNodes=function(l){return Ui2("Node",l,"childNodes")},zi2_parentNode=function(l){return Ui2("Node",l,"parentNode")},zi2_parentElement=function(l){return Ui2("Node",l,"parentElement")},zi2_textContent=function(l){return Ui2("Node",l,"textContent")},zi2_contains=function(l,c){return $i2("Node",l,"contains")(c)},zi2_getRootNode=function(l){return $i2("Node",l,"getRootNode")()},zi2_host=function(l){return l&&"host"in l?Ui2("ShadowRoot",l,"host"):null},zi2_shadowRoot=function(l){return l&&"shadowRoot"in l?Ui2("Element",l,"shadowRoot"):null};function Gi2(l,c,d){void 0===d&&(d=document);var h={capture:!0,passive:!0};return d.addEventListener(l,c,h),()=>d.removeEventListener(l,c,h)}var cs="Please stop import mirror directly. Instead of that,\r\nnow you can use replayer.getMirror() to access the mirror instance of a replayer,\r\nor you can use record.mirror to access the mirror instance during recording.",us={map:{},getId:()=>(console.error(cs),-1),getNode:()=>(console.error(cs),null),removeNodeFromMap(){console.error(cs)},has:()=>(console.error(cs),!1),reset(){console.error(cs)}};function Ji2(l,c,d){void 0===d&&(d={});var h=null,p=0;return function(){for(var f=arguments.length,m=new Array(f),y=0;y<f;y++)m[y]=arguments[y];var _=Date.now();p||!1!==d.leading||(p=_);var b=c-(_-p),w=this;b<=0||b>c?(h&&(clearTimeout(h),h=null),p=_,l.apply(w,m)):h||!1===d.trailing||(h=setTimeout((()=>{p=!1===d.leading?0:Date.now(),h=null,l.apply(w,m)}),b))}}function Yi2(l,c,d,h,p){void 0===p&&(p=window);var f=p.Object.getOwnPropertyDescriptor(l,c);return p.Object.defineProperty(l,c,h?d:{set(l){setTimeout((()=>{d.set.call(this,l)}),0),f&&f.set&&f.set.call(this,l)}}),()=>Yi2(l,c,f||{},!0)}"undefined"!=typeof window&&window.Proxy&&window.Reflect&&(us=new Proxy(us,{get:(l,c,d)=>("map"===c&&console.error(cs),Reflect.get(l,c,d))}));var ds=Date.now;function Ki2(l){var c,d,h,p,f=l.document;return{left:f.scrollingElement?f.scrollingElement.scrollLeft:void 0!==l.pageXOffset?l.pageXOffset:f.documentElement.scrollLeft||(null==f?void 0:f.body)&&(null==(c=zi2_parentElement(f.body))?void 0:c.scrollLeft)||(null==(d=null==f?void 0:f.body)?void 0:d.scrollLeft)||0,top:f.scrollingElement?f.scrollingElement.scrollTop:void 0!==l.pageYOffset?l.pageYOffset:(null==f?void 0:f.documentElement.scrollTop)||(null==f?void 0:f.body)&&(null==(h=zi2_parentElement(f.body))?void 0:h.scrollTop)||(null==(p=null==f?void 0:f.body)?void 0:p.scrollTop)||0}}function Zi2(){return window.innerHeight||document.documentElement&&document.documentElement.clientHeight||document.body&&document.body.clientHeight}function Qi2(){return window.innerWidth||document.documentElement&&document.documentElement.clientWidth||document.body&&document.body.clientWidth}function tn2(l){return l?l.nodeType===l.ELEMENT_NODE?l:zi2_parentElement(l):null}function en2(l,c,d,h){if(!l)return!1;var p=tn2(l);if(!p)return!1;try{if("string"==typeof c){if(p.classList.contains(c))return!0;if(h&&null!==p.closest("."+c))return!0}else if(et2(p,c,h))return!0}catch(f){}if(d){if(p.matches(d))return!0;if(h&&null!==p.closest(d))return!0}return!1}function rn2(l,c,d){return!("TITLE"!==l.tagName||!d.headTitleMutations)||-2===c.getId(l)}function nn2(l,c){if(M2(l))return!1;var d=c.getId(l);if(!c.has(d))return!0;var h=zi2_parentNode(l);return(!h||h.nodeType!==l.DOCUMENT_NODE)&&(!h||nn2(h,c))}function sn2(l){return Boolean(l.changedTouches)}function on2(l,c){return Boolean("IFRAME"===l.nodeName&&c.getMeta(l))}function an2(l,c){return Boolean("LINK"===l.nodeName&&l.nodeType===l.ELEMENT_NODE&&l.getAttribute&&"stylesheet"===l.getAttribute("rel")&&c.getMeta(l))}function hn2(l){return!!l&&(l instanceof Bi2&&"shadowRoot"in l?Boolean(l.shadowRoot):Boolean(zi2_shadowRoot(l)))}/[1-9][0-9]{12}/.test(Date.now().toString())||(ds=()=>(new Date).getTime());class un2{constructor(){c2(this,"id",1),c2(this,"styleIDMap",new WeakMap),c2(this,"idStyleMap",new Map)}getId(l){var c;return null!==(c=this.styleIDMap.get(l))&&void 0!==c?c:-1}has(l){return this.styleIDMap.has(l)}add(l,c){return this.has(l)?this.getId(l):(d=void 0===c?this.id++:c,this.styleIDMap.set(l,d),this.idStyleMap.set(d,l),d);var d}getStyle(l){return this.idStyleMap.get(l)||null}reset(){this.styleIDMap=new WeakMap,this.idStyleMap=new Map,this.id=1}generateId(){return this.id++}}function ln2(l){var c,d=null;return"getRootNode"in l&&(null==(c=zi2_getRootNode(l))?void 0:c.nodeType)===Node.DOCUMENT_FRAGMENT_NODE&&zi2_host(zi2_getRootNode(l))&&(d=zi2_host(zi2_getRootNode(l))),d}function fn2(l){var c=l.ownerDocument;return!!c&&(zi2_contains(c,l)||function(l){var c=l.ownerDocument;if(!c)return!1;var d=function(l){for(var c,d=l;c=ln2(d);)d=c;return d}(l);return zi2_contains(c,d)}(l))}var Cs=(l=>(l[l.DomContentLoaded=0]="DomContentLoaded",l[l.Load=1]="Load",l[l.FullSnapshot=2]="FullSnapshot",l[l.IncrementalSnapshot=3]="IncrementalSnapshot",l[l.Meta=4]="Meta",l[l.Custom=5]="Custom",l[l.Plugin=6]="Plugin",l))(Cs||{}),Es=(l=>(l[l.Mutation=0]="Mutation",l[l.MouseMove=1]="MouseMove",l[l.MouseInteraction=2]="MouseInteraction",l[l.Scroll=3]="Scroll",l[l.ViewportResize=4]="ViewportResize",l[l.Input=5]="Input",l[l.TouchMove=6]="TouchMove",l[l.MediaInteraction=7]="MediaInteraction",l[l.StyleSheetRule=8]="StyleSheetRule",l[l.CanvasMutation=9]="CanvasMutation",l[l.Font=10]="Font",l[l.Log=11]="Log",l[l.Drag=12]="Drag",l[l.StyleDeclaration=13]="StyleDeclaration",l[l.Selection=14]="Selection",l[l.AdoptedStyleSheet=15]="AdoptedStyleSheet",l[l.CustomElement=16]="CustomElement",l))(Es||{}),Os=(l=>(l[l.MouseUp=0]="MouseUp",l[l.MouseDown=1]="MouseDown",l[l.Click=2]="Click",l[l.ContextMenu=3]="ContextMenu",l[l.DblClick=4]="DblClick",l[l.Focus=5]="Focus",l[l.Blur=6]="Blur",l[l.TouchStart=7]="TouchStart",l[l.TouchMove_Departed=8]="TouchMove_Departed",l[l.TouchEnd=9]="TouchEnd",l[l.TouchCancel=10]="TouchCancel",l))(Os||{}),Ms=(l=>(l[l.Mouse=0]="Mouse",l[l.Pen=1]="Pen",l[l.Touch=2]="Touch",l))(Ms||{}),Ns=(l=>(l[l["2D"]=0]="2D",l[l.WebGL=1]="WebGL",l[l.WebGL2=2]="WebGL2",l))(Ns||{}),Ps=(l=>(l[l.Play=0]="Play",l[l.Pause=1]="Pause",l[l.Seeked=2]="Seeked",l[l.VolumeChange=3]="VolumeChange",l[l.RateChange=4]="RateChange",l))(Ps||{}),Ls=(l=>(l[l.Document=0]="Document",l[l.DocumentType=1]="DocumentType",l[l.Element=2]="Element",l[l.Text=3]="Text",l[l.CDATA=4]="CDATA",l[l.Comment=5]="Comment",l))(Ls||{});function bn2(l){return"__ln"in l}class Sn2{constructor(){c2(this,"length",0),c2(this,"head",null),c2(this,"tail",null)}get(l){if(l>=this.length)throw new Error("Position outside of list range");for(var c=this.head,d=0;d<l;d++)c=(null==c?void 0:c.next)||null;return c}addNode(l){var c={value:l,previous:null,next:null};if(l.__ln=c,l.previousSibling&&bn2(l.previousSibling)){var d=l.previousSibling.__ln.next;c.next=d,c.previous=l.previousSibling.__ln,l.previousSibling.__ln.next=c,d&&(d.previous=c)}else if(l.nextSibling&&bn2(l.nextSibling)&&l.nextSibling.__ln.previous){var h=l.nextSibling.__ln.previous;c.previous=h,c.next=l.nextSibling.__ln,l.nextSibling.__ln.previous=c,h&&(h.next=c)}else this.head&&(this.head.previous=c),c.next=this.head,this.head=c;null===c.next&&(this.tail=c),this.length++}removeNode(l){var c=l.__ln;this.head&&(c.previous?(c.previous.next=c.next,c.next?c.next.previous=c.previous:this.tail=c.previous):(this.head=c.next,this.head?this.head.previous=null:this.tail=null),l.__ln&&delete l.__ln,this.length--)}}var Ds,Cn2=(l,c)=>l+"@"+c;class In2{constructor(){c2(this,"frozen",!1),c2(this,"locked",!1),c2(this,"texts",[]),c2(this,"attributes",[]),c2(this,"attributeMap",new WeakMap),c2(this,"removes",[]),c2(this,"mapRemoves",[]),c2(this,"movedMap",{}),c2(this,"addedSet",new Set),c2(this,"movedSet",new Set),c2(this,"droppedSet",new Set),c2(this,"removesSubTreeCache",new Set),c2(this,"mutationCb"),c2(this,"blockClass"),c2(this,"blockSelector"),c2(this,"maskTextClass"),c2(this,"maskTextSelector"),c2(this,"inlineStylesheet"),c2(this,"maskInputOptions"),c2(this,"maskTextFn"),c2(this,"maskInputFn"),c2(this,"keepIframeSrcFn"),c2(this,"recordCanvas"),c2(this,"inlineImages"),c2(this,"slimDOMOptions"),c2(this,"dataURLOptions"),c2(this,"doc"),c2(this,"mirror"),c2(this,"iframeManager"),c2(this,"stylesheetManager"),c2(this,"shadowDomManager"),c2(this,"canvasManager"),c2(this,"processedNodeManager"),c2(this,"unattachedDoc"),c2(this,"processMutations",(l=>{l.forEach(this.processMutation),this.emit()})),c2(this,"emit",(()=>{if(!this.frozen&&!this.locked){for(var l=[],c=new Set,d=new Sn2,i22=l=>{for(var c=l,d=-2;-2===d;)d=(c=c&&c.nextSibling)&&this.mirror.getId(c);return d},n22=h=>{var p=zi2_parentNode(h);if(p&&fn2(h)&&"TEXTAREA"!==p.tagName){var f=M2(p)?this.mirror.getId(ln2(h)):this.mirror.getId(p),m=i22(h);if(-1===f||-1===m)return d.addNode(h);var y=ot2(h,{doc:this.doc,mirror:this.mirror,blockClass:this.blockClass,blockSelector:this.blockSelector,maskTextClass:this.maskTextClass,maskTextSelector:this.maskTextSelector,skipChild:!0,newlyAddedElement:!0,inlineStylesheet:this.inlineStylesheet,maskInputOptions:this.maskInputOptions,maskTextFn:this.maskTextFn,maskInputFn:this.maskInputFn,slimDOMOptions:this.slimDOMOptions,dataURLOptions:this.dataURLOptions,recordCanvas:this.recordCanvas,inlineImages:this.inlineImages,onSerialize:l=>{on2(l,this.mirror)&&this.iframeManager.addIframe(l),an2(l,this.mirror)&&this.stylesheetManager.trackLinkElement(l),hn2(h)&&this.shadowDomManager.addShadowRoot(zi2_shadowRoot(h),this.doc)},onIframeLoad:(l,c)=>{this.iframeManager.attachIframe(l,c),this.shadowDomManager.observeAttachShadow(l)},onStylesheetLoad:(l,c)=>{this.stylesheetManager.attachLinkElement(l,c)}});y&&(l.push({parentId:f,nextId:m,node:y}),c.add(y.id))}};this.mapRemoves.length;)this.mirror.removeNodeFromMap(this.mapRemoves.shift());for(var h of this.movedSet)Rn2(this.removesSubTreeCache,h,this.mirror)&&!this.movedSet.has(zi2_parentNode(h))||n22(h);for(var p of this.addedSet)xn2(this.droppedSet,p)||Rn2(this.removesSubTreeCache,p,this.mirror)?xn2(this.movedSet,p)?n22(p):this.droppedSet.add(p):n22(p);for(var f=null;d.length;){var m=null;if(f){var y=this.mirror.getId(zi2_parentNode(f.value)),_=i22(f.value);-1!==y&&-1!==_&&(m=f)}if(!m)for(var b=d.tail;b;){var w=b;if(b=b.previous,w){var E=this.mirror.getId(zi2_parentNode(w.value));if(-1===i22(w.value))continue;if(-1!==E){m=w;break}var M=w.value,N=zi2_parentNode(M);if(N&&N.nodeType===Node.DOCUMENT_FRAGMENT_NODE){var P=zi2_host(N);if(-1!==this.mirror.getId(P)){m=w;break}}}}if(!m){for(;d.head;)d.removeNode(d.head.value);break}f=m.previous,d.removeNode(m.value),n22(m.value)}var L={texts:this.texts.map((l=>{var c=l.node,d=zi2_parentNode(c);return d&&"TEXTAREA"===d.tagName&&this.genTextAreaValueMutation(d),{id:this.mirror.getId(c),value:l.value}})).filter((l=>!c.has(l.id))).filter((l=>this.mirror.has(l.id))),attributes:this.attributes.map((l=>{var{attributes:c}=l;if("string"==typeof c.style){var d=JSON.stringify(l.styleDiff),h=JSON.stringify(l._unchangedStyles);d.length<c.style.length&&(d+h).split("var(").length===c.style.split("var(").length&&(c.style=l.styleDiff)}return{id:this.mirror.getId(l.node),attributes:c}})).filter((l=>!c.has(l.id))).filter((l=>this.mirror.has(l.id))),removes:this.removes,adds:l};(L.texts.length||L.attributes.length||L.removes.length||L.adds.length)&&(this.texts=[],this.attributes=[],this.attributeMap=new WeakMap,this.removes=[],this.addedSet=new Set,this.movedSet=new Set,this.droppedSet=new Set,this.removesSubTreeCache=new Set,this.movedMap={},this.mutationCb(L))}})),c2(this,"genTextAreaValueMutation",(l=>{var c=this.attributeMap.get(l);c||(c={node:l,attributes:{},styleDiff:{},_unchangedStyles:{}},this.attributes.push(c),this.attributeMap.set(l,c)),c.attributes.value=Array.from(zi2_childNodes(l),(l=>zi2_textContent(l)||"")).join("")})),c2(this,"processMutation",(l=>{if(!rn2(l.target,this.mirror,this.slimDOMOptions))switch(l.type){case"characterData":var c=zi2_textContent(l.target);en2(l.target,this.blockClass,this.blockSelector,!1)||c===l.oldValue||this.texts.push({value:rt2(l.target,this.maskTextClass,this.maskTextSelector,!0)&&c?this.maskTextFn?this.maskTextFn(c,tn2(l.target)):c.replace(/[\S]/g,"*"):c,node:l.target});break;case"attributes":var d=l.target,h=l.attributeName,p=l.target.getAttribute(h);if("value"===h){var f=B2(d);p=T2({element:d,maskInputOptions:this.maskInputOptions,tagName:d.tagName,type:f,value:p,maskInputFn:this.maskInputFn})}if(en2(l.target,this.blockClass,this.blockSelector,!1)||p===l.oldValue)return;var m=this.attributeMap.get(l.target);if("IFRAME"===d.tagName&&"src"===h&&!this.keepIframeSrcFn(p)){if(d.contentDocument)return;h="rr_src"}if(m||(m={node:l.target,attributes:{},styleDiff:{},_unchangedStyles:{}},this.attributes.push(m),this.attributeMap.set(l.target,m)),"type"===h&&"INPUT"===d.tagName&&"password"===(l.oldValue||"").toLowerCase()&&d.setAttribute("data-rr-is-password","true"),!tt2(d.tagName,h))if(m.attributes[h]=Q2(this.doc,E2(d.tagName),E2(h),p),"style"===h){if(!this.unattachedDoc)try{this.unattachedDoc=document.implementation.createHTMLDocument()}catch(M){this.unattachedDoc=this.doc}var y=this.unattachedDoc.createElement("span");for(var _ of(l.oldValue&&y.setAttribute("style",l.oldValue),Array.from(d.style))){var b=d.style.getPropertyValue(_),w=d.style.getPropertyPriority(_);b!==y.style.getPropertyValue(_)||w!==y.style.getPropertyPriority(_)?m.styleDiff[_]=""===w?b:[b,w]:m._unchangedStyles[_]=[b,w]}for(var E of Array.from(y.style))""===d.style.getPropertyValue(E)&&(m.styleDiff[E]=!1)}else"open"===h&&"DIALOG"===d.tagName&&(d.matches("dialog:modal")?m.attributes.rr_open_mode="modal":m.attributes.rr_open_mode="non-modal");break;case"childList":if(en2(l.target,this.blockClass,this.blockSelector,!0))return;if("TEXTAREA"===l.target.tagName)return void this.genTextAreaValueMutation(l.target);l.addedNodes.forEach((c=>this.genAdds(c,l.target))),l.removedNodes.forEach((c=>{var d,h=this.mirror.getId(c),p=M2(l.target)?this.mirror.getId(zi2_host(l.target)):this.mirror.getId(l.target);en2(l.target,this.blockClass,this.blockSelector,!1)||rn2(c,this.mirror,this.slimDOMOptions)||(d=c,-1===this.mirror.getId(d))||(this.addedSet.has(c)?(Mn2(this.addedSet,c),this.droppedSet.add(c)):this.addedSet.has(l.target)&&-1===h||nn2(l.target,this.mirror)||(this.movedSet.has(c)&&this.movedMap[Cn2(h,p)]?Mn2(this.movedSet,c):(this.removes.push({parentId:p,id:h,isShadow:!(!M2(l.target)||!R2(l.target))||void 0}),function(l,c){for(var d=[l];d.length;){var h=d.pop();c.has(h)||(c.add(h),zi2_childNodes(h).forEach((l=>d.push(l))))}}(c,this.removesSubTreeCache))),this.mapRemoves.push(c))}))}})),c2(this,"genAdds",((l,c)=>{if(!this.processedNodeManager.inOtherBuffer(l,this)&&!this.addedSet.has(l)&&!this.movedSet.has(l)){if(this.mirror.hasNode(l)){if(rn2(l,this.mirror,this.slimDOMOptions))return;this.movedSet.add(l);var d=null;c&&this.mirror.hasNode(c)&&(d=this.mirror.getId(c)),d&&-1!==d&&(this.movedMap[Cn2(this.mirror.getId(l),d)]=!0)}else this.addedSet.add(l),this.droppedSet.delete(l);en2(l,this.blockClass,this.blockSelector,!1)||(zi2_childNodes(l).forEach((l=>this.genAdds(l))),hn2(l)&&zi2_childNodes(zi2_shadowRoot(l)).forEach((c=>{this.processedNodeManager.add(c,this),this.genAdds(c,l)})))}}))}init(l){["mutationCb","blockClass","blockSelector","maskTextClass","maskTextSelector","inlineStylesheet","maskInputOptions","maskTextFn","maskInputFn","keepIframeSrcFn","recordCanvas","inlineImages","slimDOMOptions","dataURLOptions","doc","mirror","iframeManager","stylesheetManager","shadowDomManager","canvasManager","processedNodeManager"].forEach((c=>{this[c]=l[c]}))}freeze(){this.frozen=!0,this.canvasManager.freeze()}unfreeze(){this.frozen=!1,this.canvasManager.unfreeze(),this.emit()}isFrozen(){return this.frozen}lock(){this.locked=!0,this.canvasManager.lock()}unlock(){this.locked=!1,this.canvasManager.unlock(),this.emit()}reset(){this.shadowDomManager.reset(),this.canvasManager.reset()}}function Mn2(l,c){l.delete(c),zi2_childNodes(c).forEach((c=>Mn2(l,c)))}function Rn2(l,c,d){return 0!==l.size&&(h=l,!!(p=zi2_parentNode(c))&&h.has(p));var h,p}function xn2(l,c){return 0!==l.size&&_n2(l,c)}function _n2(l,c){var d=zi2_parentNode(c);return!!d&&(!!l.has(d)||_n2(l,d))}var On2=l=>Ds?function(){try{return l(...arguments)}catch(c){if(Ds&&!0===Ds(c))return;throw c}}:l,Fs=[];function En2(l){try{if("composedPath"in l){var c=l.composedPath();if(c.length)return c[0]}else if("path"in l&&l.path.length)return l.path[0]}catch(d){}return l&&l.target}function An2(l,c){var d=new In2;Fs.push(d),d.init(l);var h=new(Wi2())(On2(d.processMutations.bind(d)));return h.observe(c,{attributes:!0,attributeOldValue:!0,characterData:!0,characterDataOldValue:!0,childList:!0,subtree:!0}),h}function Ln2(l){var{scrollCb:c,doc:d,mirror:h,blockClass:p,blockSelector:f,sampling:m}=l;return Gi2("scroll",On2(Ji2(On2((l=>{var m=En2(l);if(m&&!en2(m,p,f,!0)){var y=h.getId(m);if(m===d&&d.defaultView){var _=Ki2(d.defaultView);c({id:y,x:_.left,y:_.top})}else c({id:y,x:m.scrollLeft,y:m.scrollTop})}})),m.scroll||100)),d)}var Us=["INPUT","TEXTAREA","SELECT"],Zs=new WeakMap;function jn2(l){return function(l,c){if($n2("CSSGroupingRule")&&l.parentRule instanceof CSSGroupingRule||$n2("CSSMediaRule")&&l.parentRule instanceof CSSMediaRule||$n2("CSSSupportsRule")&&l.parentRule instanceof CSSSupportsRule||$n2("CSSConditionRule")&&l.parentRule instanceof CSSConditionRule){var d=Array.from(l.parentRule.cssRules).indexOf(l);c.unshift(d)}else if(l.parentStyleSheet){var h=Array.from(l.parentStyleSheet.cssRules).indexOf(l);c.unshift(h)}return c}(l,[])}function Dn2(l,c,d){var h,p;return l?(l.ownerNode?h=c.getId(l.ownerNode):p=d.getId(l),{styleId:p,id:h}):{}}function Un2(l,c){var d,h,p,f,{mirror:m,stylesheetManager:y}=l;f="#document"===c.nodeName?m.getId(c):m.getId(zi2_host(c));var _="#document"===c.nodeName?null==(d=c.defaultView)?void 0:d.Document:null==(p=null==(h=c.ownerDocument)?void 0:h.defaultView)?void 0:p.ShadowRoot,b=(null==_?void 0:_.prototype)?Object.getOwnPropertyDescriptor(null==_?void 0:_.prototype,"adoptedStyleSheets"):void 0;return null!==f&&-1!==f&&_&&b?(Object.defineProperty(c,"adoptedStyleSheets",{configurable:b.configurable,enumerable:b.enumerable,get(){var l;return null==(l=b.get)?void 0:l.call(this)},set(l){var c,d=null==(c=b.set)?void 0:c.call(this,l);if(null!==f&&-1!==f)try{y.adoptStyleSheets(l,f)}catch(h){}return d}}),On2((()=>{Object.defineProperty(c,"adoptedStyleSheets",{configurable:b.configurable,enumerable:b.enumerable,get:b.get,set:b.set})}))):()=>{}}function Pn2(l,c){void 0===c&&(c={});var d,h=l.doc.defaultView;if(!h)return()=>{};!function(l,c){var{mutationCb:d,mousemoveCb:h,mouseInteractionCb:p,scrollCb:f,viewportResizeCb:m,inputCb:y,mediaInteractionCb:_,styleSheetRuleCb:b,styleDeclarationCb:w,canvasMutationCb:E,fontCb:M,selectionCb:N,customElementCb:P}=l;l.mutationCb=function(){c.mutation&&c.mutation(...arguments),d(...arguments)},l.mousemoveCb=function(){c.mousemove&&c.mousemove(...arguments),h(...arguments)},l.mouseInteractionCb=function(){c.mouseInteraction&&c.mouseInteraction(...arguments),p(...arguments)},l.scrollCb=function(){c.scroll&&c.scroll(...arguments),f(...arguments)},l.viewportResizeCb=function(){c.viewportResize&&c.viewportResize(...arguments),m(...arguments)},l.inputCb=function(){c.input&&c.input(...arguments),y(...arguments)},l.mediaInteractionCb=function(){c.mediaInteaction&&c.mediaInteaction(...arguments),_(...arguments)},l.styleSheetRuleCb=function(){c.styleSheetRule&&c.styleSheetRule(...arguments),b(...arguments)},l.styleDeclarationCb=function(){c.styleDeclaration&&c.styleDeclaration(...arguments),w(...arguments)},l.canvasMutationCb=function(){c.canvasMutation&&c.canvasMutation(...arguments),E(...arguments)},l.fontCb=function(){c.font&&c.font(...arguments),M(...arguments)},l.selectionCb=function(){c.selection&&c.selection(...arguments),N(...arguments)},l.customElementCb=function(){c.customElement&&c.customElement(...arguments),P(...arguments)}}(l,c),l.recordDOM&&(d=An2(l,l.doc));var p=function(l){var{mousemoveCb:c,sampling:d,doc:h,mirror:p}=l;if(!1===d.mousemove)return()=>{};var f,m="number"==typeof d.mousemove?d.mousemove:50,y="number"==typeof d.mousemoveCallback?d.mousemoveCallback:500,_=[],b=Ji2(On2((l=>{var d=Date.now()-f;c(_.map((l=>(l.timeOffset-=d,l))),l),_=[],f=null})),y),w=On2(Ji2(On2((l=>{var c=En2(l),{clientX:d,clientY:h}=sn2(l)?l.changedTouches[0]:l;f||(f=ds()),_.push({x:d,y:h,id:p.getId(c),timeOffset:ds()-f}),b("undefined"!=typeof DragEvent&&l instanceof DragEvent?Es.Drag:l instanceof MouseEvent?Es.MouseMove:Es.TouchMove)})),m,{trailing:!1})),E=[Gi2("mousemove",w,h),Gi2("touchmove",w,h),Gi2("drag",w,h)];return On2((()=>{E.forEach((l=>l()))}))}(l),f=function(l){var{mouseInteractionCb:c,doc:d,mirror:h,blockClass:p,blockSelector:f,sampling:m}=l;if(!1===m.mouseInteraction)return()=>{};var y=!0===m.mouseInteraction||void 0===m.mouseInteraction?{}:m.mouseInteraction,_=[],b=null;return Object.keys(Os).filter((l=>Number.isNaN(Number(l))&&!l.endsWith("_Departed")&&!1!==y[l])).forEach((l=>{var m=E2(l),y=(l=>d=>{var m=En2(d);if(!en2(m,p,f,!0)){var y=null,_=l;if("pointerType"in d){switch(d.pointerType){case"mouse":y=Ms.Mouse;break;case"touch":y=Ms.Touch;break;case"pen":y=Ms.Pen}y===Ms.Touch?Os[l]===Os.MouseDown?_="TouchStart":Os[l]===Os.MouseUp&&(_="TouchEnd"):Ms.Pen}else sn2(d)&&(y=Ms.Touch);null!==y?(b=y,(_.startsWith("Touch")&&y===Ms.Touch||_.startsWith("Mouse")&&y===Ms.Mouse)&&(y=null)):Os[l]===Os.Click&&(y=b,b=null);var w=sn2(d)?d.changedTouches[0]:d;if(w){var E=h.getId(m),{clientX:M,clientY:N}=w;On2(c)(r2({type:Os[_],id:E,x:M,y:N},null!==y&&{pointerType:y}))}}})(l);if(window.PointerEvent)switch(Os[l]){case Os.MouseDown:case Os.MouseUp:m=m.replace("mouse","pointer");break;case Os.TouchStart:case Os.TouchEnd:return}_.push(Gi2(m,y,d))})),On2((()=>{_.forEach((l=>l()))}))}(l),m=Ln2(l),y=function(l,c){var{viewportResizeCb:d}=l,{win:h}=c,p=-1,f=-1;return Gi2("resize",On2(Ji2(On2((()=>{var l=Zi2(),c=Qi2();p===l&&f===c||(d({width:Number(c),height:Number(l)}),p=l,f=c)})),200)),h)}(l,{win:h}),_=function(l){var{inputCb:c,doc:d,mirror:h,blockClass:p,blockSelector:f,ignoreClass:m,ignoreSelector:y,maskInputOptions:_,maskInputFn:b,sampling:w,userTriggeredOnInput:E}=l;function d3(l){var c=En2(l),h=l.isTrusted,w=c&&c.tagName;if(c&&"OPTION"===w&&(c=zi2_parentElement(c)),c&&w&&!(Us.indexOf(w)<0)&&!en2(c,p,f,!0)&&!(c.classList.contains(m)||y&&c.matches(y))){var M=c.value,N=!1,P=B2(c)||"";"radio"===P||"checkbox"===P?N=c.checked:(_[w.toLowerCase()]||_[P])&&(M=T2({element:c,maskInputOptions:_,tagName:w,type:P,value:M,maskInputFn:b})),v3(c,E?{text:M,isChecked:N,userTriggered:h}:{text:M,isChecked:N});var L=c.name;"radio"===P&&L&&N&&d.querySelectorAll('input[type="radio"][name="'+L+'"]').forEach((l=>{if(l!==c){var d=l.value;v3(l,E?{text:d,isChecked:!N,userTriggered:!1}:{text:d,isChecked:!N})}}))}}function v3(l,d){var p=Zs.get(l);if(!p||p.text!==d.text||p.isChecked!==d.isChecked){Zs.set(l,d);var f=h.getId(l);On2(c)(r2({},d,{id:f}))}}var M=("last"===w.input?["change"]:["input","change"]).map((l=>Gi2(l,On2(d3),d))),N=d.defaultView;if(!N)return()=>{M.forEach((l=>l()))};var P=N.Object.getOwnPropertyDescriptor(N.HTMLInputElement.prototype,"value"),L=[[N.HTMLInputElement.prototype,"value"],[N.HTMLInputElement.prototype,"checked"],[N.HTMLSelectElement.prototype,"value"],[N.HTMLTextAreaElement.prototype,"value"],[N.HTMLSelectElement.prototype,"selectedIndex"],[N.HTMLOptionElement.prototype,"selected"]];return P&&P.set&&M.push(...L.map((l=>Yi2(l[0],l[1],{set(){On2(d3)({target:this,isTrusted:!1})}},!1,N)))),On2((()=>{M.forEach((l=>l()))}))}(l),b=function(l){var{mediaInteractionCb:c,blockClass:d,blockSelector:h,mirror:p,sampling:f,doc:m}=l,y=On2((l=>Ji2(On2((f=>{var m=En2(f);if(m&&!en2(m,d,h,!0)){var{currentTime:y,volume:_,muted:b,playbackRate:w,loop:E}=m;c({type:l,id:p.getId(m),currentTime:y,volume:_,muted:b,playbackRate:w,loop:E})}})),f.media||500))),_=[Gi2("play",y(Ps.Play),m),Gi2("pause",y(Ps.Pause),m),Gi2("seeked",y(Ps.Seeked),m),Gi2("volumechange",y(Ps.VolumeChange),m),Gi2("ratechange",y(Ps.RateChange),m)];return On2((()=>{_.forEach((l=>l()))}))}(l),c22=()=>{},f22=()=>{},d22=()=>{},v22=()=>{};l.recordDOM&&(c22=function(l,c){var{styleSheetRuleCb:d,mirror:h,stylesheetManager:p}=l,{win:f}=c;if(!f.CSSStyleSheet||!f.CSSStyleSheet.prototype)return()=>{};var m=f.CSSStyleSheet.prototype.insertRule;f.CSSStyleSheet.prototype.insertRule=new Proxy(m,{apply:On2(((l,c,f)=>{var[m,y]=f,{id:_,styleId:b}=Dn2(c,h,p.styleMirror);return(_&&-1!==_||b&&-1!==b)&&d({id:_,styleId:b,adds:[{rule:m,index:y}]}),l.apply(c,f)}))}),f.CSSStyleSheet.prototype.addRule=function(l,c,d){void 0===d&&(d=this.cssRules.length);var h=l+" { "+c+" }";return f.CSSStyleSheet.prototype.insertRule.apply(this,[h,d])};var y,_,b=f.CSSStyleSheet.prototype.deleteRule;f.CSSStyleSheet.prototype.deleteRule=new Proxy(b,{apply:On2(((l,c,f)=>{var[m]=f,{id:y,styleId:_}=Dn2(c,h,p.styleMirror);return(y&&-1!==y||_&&-1!==_)&&d({id:y,styleId:_,removes:[{index:m}]}),l.apply(c,f)}))}),f.CSSStyleSheet.prototype.removeRule=function(l){return f.CSSStyleSheet.prototype.deleteRule.apply(this,[l])},f.CSSStyleSheet.prototype.replace&&(y=f.CSSStyleSheet.prototype.replace,f.CSSStyleSheet.prototype.replace=new Proxy(y,{apply:On2(((l,c,f)=>{var[m]=f,{id:y,styleId:_}=Dn2(c,h,p.styleMirror);return(y&&-1!==y||_&&-1!==_)&&d({id:y,styleId:_,replace:m}),l.apply(c,f)}))})),f.CSSStyleSheet.prototype.replaceSync&&(_=f.CSSStyleSheet.prototype.replaceSync,f.CSSStyleSheet.prototype.replaceSync=new Proxy(_,{apply:On2(((l,c,f)=>{var[m]=f,{id:y,styleId:_}=Dn2(c,h,p.styleMirror);return(y&&-1!==y||_&&-1!==_)&&d({id:y,styleId:_,replaceSync:m}),l.apply(c,f)}))}));var w={};Wn2("CSSGroupingRule")?w.CSSGroupingRule=f.CSSGroupingRule:(Wn2("CSSMediaRule")&&(w.CSSMediaRule=f.CSSMediaRule),Wn2("CSSConditionRule")&&(w.CSSConditionRule=f.CSSConditionRule),Wn2("CSSSupportsRule")&&(w.CSSSupportsRule=f.CSSSupportsRule));var E={};return Object.entries(w).forEach((l=>{var[c,f]=l;E[c]={insertRule:f.prototype.insertRule,deleteRule:f.prototype.deleteRule},f.prototype.insertRule=new Proxy(E[c].insertRule,{apply:On2(((l,c,f)=>{var[m,y]=f,{id:_,styleId:b}=Dn2(c.parentStyleSheet,h,p.styleMirror);return(_&&-1!==_||b&&-1!==b)&&d({id:_,styleId:b,adds:[{rule:m,index:[...jn2(c),y||0]}]}),l.apply(c,f)}))}),f.prototype.deleteRule=new Proxy(E[c].deleteRule,{apply:On2(((l,c,f)=>{var[m]=f,{id:y,styleId:_}=Dn2(c.parentStyleSheet,h,p.styleMirror);return(y&&-1!==y||_&&-1!==_)&&d({id:y,styleId:_,removes:[{index:[...jn2(c),m]}]}),l.apply(c,f)}))})})),On2((()=>{f.CSSStyleSheet.prototype.insertRule=m,f.CSSStyleSheet.prototype.deleteRule=b,y&&(f.CSSStyleSheet.prototype.replace=y),_&&(f.CSSStyleSheet.prototype.replaceSync=_),Object.entries(w).forEach((l=>{var[c,d]=l;d.prototype.insertRule=E[c].insertRule,d.prototype.deleteRule=E[c].deleteRule}))}))}(l,{win:h}),f22=Un2(l,l.doc),d22=function(l,c){var{styleDeclarationCb:d,mirror:h,ignoreCSSAttributes:p,stylesheetManager:f}=l,{win:m}=c,y=m.CSSStyleDeclaration.prototype.setProperty;m.CSSStyleDeclaration.prototype.setProperty=new Proxy(y,{apply:On2(((l,c,m)=>{var _,[b,w,E]=m;if(p.has(b))return y.apply(c,[b,w,E]);var{id:M,styleId:N}=Dn2(null==(_=c.parentRule)?void 0:_.parentStyleSheet,h,f.styleMirror);return(M&&-1!==M||N&&-1!==N)&&d({id:M,styleId:N,set:{property:b,value:w,priority:E},index:jn2(c.parentRule)}),l.apply(c,m)}))});var _=m.CSSStyleDeclaration.prototype.removeProperty;return m.CSSStyleDeclaration.prototype.removeProperty=new Proxy(_,{apply:On2(((l,c,m)=>{var y,[b]=m;if(p.has(b))return _.apply(c,[b]);var{id:w,styleId:E}=Dn2(null==(y=c.parentRule)?void 0:y.parentStyleSheet,h,f.styleMirror);return(w&&-1!==w||E&&-1!==E)&&d({id:w,styleId:E,remove:{property:b},index:jn2(c.parentRule)}),l.apply(c,m)}))}),On2((()=>{m.CSSStyleDeclaration.prototype.setProperty=y,m.CSSStyleDeclaration.prototype.removeProperty=_}))}(l,{win:h}),l.collectFonts&&(v22=function(l){var{fontCb:c,doc:d}=l,h=d.defaultView;if(!h)return()=>{};var p=[],f=new WeakMap,m=h.FontFace;h.FontFace=function(l,c,d){var h=new m(l,c,d);return f.set(h,{family:l,buffer:"string"!=typeof c,descriptors:d,fontSource:"string"==typeof c?c:JSON.stringify(Array.from(new Uint8Array(c)))}),h};var y=qi2(d.fonts,"add",(function(l){return function(d){return setTimeout(On2((()=>{var l=f.get(d);l&&(c(l),f.delete(d))})),0),l.apply(this,[d])}}));return p.push((()=>{h.FontFace=m})),p.push(y),On2((()=>{p.forEach((l=>l()))}))}(l)));var w=function(l){var{doc:c,mirror:d,blockClass:h,blockSelector:p,selectionCb:f}=l,m=!0,y=On2((()=>{var l=c.getSelection();if(!(!l||m&&(null==l?void 0:l.isCollapsed))){m=l.isCollapsed||!1;for(var y=[],_=l.rangeCount||0,b=0;b<_;b++){var w=l.getRangeAt(b),{startContainer:E,startOffset:M,endContainer:N,endOffset:P}=w;en2(E,h,p,!0)||en2(N,h,p,!0)||y.push({start:d.getId(E),startOffset:M,end:d.getId(N),endOffset:P})}f({ranges:y})}}));return y(),Gi2("selectionchange",y)}(l),E=function(l){var{doc:c,customElementCb:d}=l,h=c.defaultView;return h&&h.customElements?qi2(h.customElements,"define",(function(l){return function(c,h,p){try{d({define:{name:c}})}catch(f){console.warn("Custom element callback failed for "+c)}return l.apply(this,[c,h,p])}})):()=>{}}(l),M=[];for(var N of l.plugins)M.push(N.observer(N.callback,h,N.options));return On2((()=>{Fs.forEach((l=>l.reset())),null==d||d.disconnect(),p(),f(),m(),y(),_(),b(),c22(),f22(),d22(),v22(),w(),E(),M.forEach((l=>l())),Fs.length=0}))}function $n2(l){return void 0!==window[l]}function Wn2(l){return Boolean(void 0!==window[l]&&window[l].prototype&&"insertRule"in window[l].prototype&&"deleteRule"in window[l].prototype)}class qn2{constructor(l){c2(this,"iframeIdToRemoteIdMap",new WeakMap),c2(this,"iframeRemoteIdToIdMap",new WeakMap),this.generateIdFn=l}getId(l,c,d,h){var p=d||this.getIdToRemoteIdMap(l),f=h||this.getRemoteIdToIdMap(l),m=p.get(c);return m||(m=this.generateIdFn(),p.set(c,m),f.set(m,c)),m}getIds(l,c){var d=this.getIdToRemoteIdMap(l),h=this.getRemoteIdToIdMap(l);return c.map((c=>this.getId(l,c,d,h)))}getRemoteId(l,c,d){var h=d||this.getRemoteIdToIdMap(l);return"number"!=typeof c?c:h.get(c)||-1}getRemoteIds(l,c){var d=this.getRemoteIdToIdMap(l);return c.map((c=>this.getRemoteId(l,c,d)))}reset(l){if(!l)return this.iframeIdToRemoteIdMap=new WeakMap,void(this.iframeRemoteIdToIdMap=new WeakMap);this.iframeIdToRemoteIdMap.delete(l),this.iframeRemoteIdToIdMap.delete(l)}getIdToRemoteIdMap(l){var c=this.iframeIdToRemoteIdMap.get(l);return c||(c=new Map,this.iframeIdToRemoteIdMap.set(l,c)),c}getRemoteIdToIdMap(l){var c=this.iframeRemoteIdToIdMap.get(l);return c||(c=new Map,this.iframeRemoteIdToIdMap.set(l,c)),c}}class zn2{constructor(l){c2(this,"iframes",new WeakMap),c2(this,"crossOriginIframeMap",new WeakMap),c2(this,"crossOriginIframeMirror",new qn2(H3)),c2(this,"crossOriginIframeStyleMirror"),c2(this,"crossOriginIframeRootIdMap",new WeakMap),c2(this,"mirror"),c2(this,"mutationCb"),c2(this,"wrappedEmit"),c2(this,"loadListener"),c2(this,"stylesheetManager"),c2(this,"recordCrossOriginIframes"),c2(this,"messageHandler"),c2(this,"nestedIframeListeners",new Map),this.mutationCb=l.mutationCb,this.wrappedEmit=l.wrappedEmit,this.stylesheetManager=l.stylesheetManager,this.recordCrossOriginIframes=l.recordCrossOriginIframes,this.crossOriginIframeStyleMirror=new qn2(this.stylesheetManager.styleMirror.generateId.bind(this.stylesheetManager.styleMirror)),this.mirror=l.mirror,this.messageHandler=this.handleMessage.bind(this),this.recordCrossOriginIframes&&window.addEventListener("message",this.messageHandler)}addIframe(l){this.iframes.set(l,!0),l.contentWindow&&this.crossOriginIframeMap.set(l.contentWindow,l)}addLoadListener(l){this.loadListener=l}removeLoadListener(){this.loadListener=void 0}attachIframe(l,c){var d;this.mutationCb({adds:[{parentId:this.mirror.getId(l),nextId:null,node:c}],removes:[],texts:[],attributes:[],isAttachIframe:!0});var h=l.contentWindow;if(this.recordCrossOriginIframes&&h&&!this.nestedIframeListeners.has(h)){var p=this.handleMessage.bind(this);this.nestedIframeListeners.set(h,p),h.addEventListener("message",p)}null==(d=this.loadListener)||d.call(this,l),l.contentDocument&&l.contentDocument.adoptedStyleSheets&&l.contentDocument.adoptedStyleSheets.length>0&&this.stylesheetManager.adoptStyleSheets(l.contentDocument.adoptedStyleSheets,this.mirror.getId(l.contentDocument))}handleMessage(l){var c=l;if("rrweb"===c.data.type&&c.origin===c.data.origin&&l.source){var d=this.crossOriginIframeMap.get(l.source);if(d){var h=this.transformCrossOriginEvent(d,c.data.event);h&&this.wrappedEmit(h,c.data.isCheckout)}}}transformCrossOriginEvent(l,c){var d;switch(c.type){case Cs.FullSnapshot:this.crossOriginIframeMirror.reset(l),this.crossOriginIframeStyleMirror.reset(l),this.replaceIdOnNode(c.data.node,l);var h=c.data.node.id;return this.crossOriginIframeRootIdMap.set(l,h),this.patchRootIdOnNode(c.data.node,h),{timestamp:c.timestamp,type:Cs.IncrementalSnapshot,data:{source:Es.Mutation,adds:[{parentId:this.mirror.getId(l),nextId:null,node:c.data.node}],removes:[],texts:[],attributes:[],isAttachIframe:!0}};case Cs.Meta:case Cs.Load:case Cs.DomContentLoaded:return!1;case Cs.Plugin:return c;case Cs.Custom:return this.replaceIds(c.data.payload,l,["id","parentId","previousId","nextId"]),c;case Cs.IncrementalSnapshot:switch(c.data.source){case Es.Mutation:return c.data.adds.forEach((c=>{this.replaceIds(c,l,["parentId","nextId","previousId"]),this.replaceIdOnNode(c.node,l);var d=this.crossOriginIframeRootIdMap.get(l);d&&this.patchRootIdOnNode(c.node,d)})),c.data.removes.forEach((c=>{this.replaceIds(c,l,["parentId","id"])})),c.data.attributes.forEach((c=>{this.replaceIds(c,l,["id"])})),c.data.texts.forEach((c=>{this.replaceIds(c,l,["id"])})),c;case Es.Drag:case Es.TouchMove:case Es.MouseMove:return c.data.positions.forEach((c=>{this.replaceIds(c,l,["id"])})),c;case Es.ViewportResize:return!1;case Es.MediaInteraction:case Es.MouseInteraction:case Es.Scroll:case Es.CanvasMutation:case Es.Input:return this.replaceIds(c.data,l,["id"]),c;case Es.StyleSheetRule:case Es.StyleDeclaration:return this.replaceIds(c.data,l,["id"]),this.replaceStyleIds(c.data,l,["styleId"]),c;case Es.Font:return c;case Es.Selection:return c.data.ranges.forEach((c=>{this.replaceIds(c,l,["start","end"])})),c;case Es.AdoptedStyleSheet:return this.replaceIds(c.data,l,["id"]),this.replaceStyleIds(c.data,l,["styleIds"]),null==(d=c.data.styles)||d.forEach((c=>{this.replaceStyleIds(c,l,["styleId"])})),c}}return!1}replace(l,c,d,h){for(var p of h)(Array.isArray(c[p])||"number"==typeof c[p])&&(Array.isArray(c[p])?c[p]=l.getIds(d,c[p]):c[p]=l.getId(d,c[p]));return c}replaceIds(l,c,d){return this.replace(this.crossOriginIframeMirror,l,c,d)}replaceStyleIds(l,c,d){return this.replace(this.crossOriginIframeStyleMirror,l,c,d)}replaceIdOnNode(l,c){this.replaceIds(l,c,["id","rootId"]),"childNodes"in l&&l.childNodes.forEach((l=>{this.replaceIdOnNode(l,c)}))}patchRootIdOnNode(l,c){l.type===Ls.Document||l.rootId||(l.rootId=c),"childNodes"in l&&l.childNodes.forEach((l=>{this.patchRootIdOnNode(l,c)}))}destroy(){this.recordCrossOriginIframes&&window.removeEventListener("message",this.messageHandler),this.nestedIframeListeners.forEach(((l,c)=>{c.removeEventListener("message",l)})),this.nestedIframeListeners.clear()}}class Gn2{constructor(l){c2(this,"shadowDoms",new WeakSet),c2(this,"mutationCb"),c2(this,"scrollCb"),c2(this,"bypassOptions"),c2(this,"mirror"),c2(this,"restoreHandlers",[]),this.mutationCb=l.mutationCb,this.scrollCb=l.scrollCb,this.bypassOptions=l.bypassOptions,this.mirror=l.mirror,this.init()}init(){this.reset(),this.patchAttachShadow(Element,document)}addShadowRoot(l,c){if(R2(l)&&!this.shadowDoms.has(l)){this.shadowDoms.add(l);var d=An2(r2({},this.bypassOptions,{doc:c,mutationCb:this.mutationCb,mirror:this.mirror,shadowDomManager:this}),l);this.restoreHandlers.push((()=>d.disconnect())),this.restoreHandlers.push(Ln2(r2({},this.bypassOptions,{scrollCb:this.scrollCb,doc:l,mirror:this.mirror}))),setTimeout((()=>{l.adoptedStyleSheets&&l.adoptedStyleSheets.length>0&&this.bypassOptions.stylesheetManager.adoptStyleSheets(l.adoptedStyleSheets,this.mirror.getId(zi2_host(l))),this.restoreHandlers.push(Un2({mirror:this.mirror,stylesheetManager:this.bypassOptions.stylesheetManager},l))}),0)}}observeAttachShadow(l){l.contentWindow&&l.contentDocument&&this.patchAttachShadow(l.contentWindow.Element,l.contentDocument)}patchAttachShadow(l,c){var d=this;this.restoreHandlers.push(qi2(l.prototype,"attachShadow",(function(l){return function(h){var p=l.call(this,h),f=zi2_shadowRoot(this);return f&&fn2(this)&&d.addShadowRoot(f,c),p}})))}reset(){this.restoreHandlers.forEach((l=>{try{l()}catch(c){}})),this.restoreHandlers=[],this.shadowDoms=new WeakSet}}for(var Gs="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",hi="undefined"==typeof Uint8Array?[]:new Uint8Array(256),mi=0;mi<64;mi++)hi[Gs.charCodeAt(mi)]=mi;var vi=new Map,Xn2=(l,c,d)=>{if(l&&(Qn2(l,c)||"object"==typeof l)){var h=(f=d,m=l.constructor.name,(y=vi.get(f))||(y=new Map,vi.set(f,y)),y.has(m)||y.set(m,[]),y.get(m)),p=h.indexOf(l);return-1===p&&(p=h.length,h.push(l)),p}var f,m,y};function Kn2(l,c,d){if(l instanceof Array)return l.map((l=>Kn2(l,c,d)));if(null===l)return l;if(l instanceof Float32Array||l instanceof Float64Array||l instanceof Int32Array||l instanceof Uint32Array||l instanceof Uint8Array||l instanceof Uint16Array||l instanceof Int16Array||l instanceof Int8Array||l instanceof Uint8ClampedArray)return{rr_type:l.constructor.name,args:[Object.values(l)]};if(l instanceof ArrayBuffer)return{rr_type:l.constructor.name,base64:function(l){var c,d=new Uint8Array(l),h=d.length,p="";for(c=0;c<h;c+=3)p+=Gs[d[c]>>2],p+=Gs[(3&d[c])<<4|d[c+1]>>4],p+=Gs[(15&d[c+1])<<2|d[c+2]>>6],p+=Gs[63&d[c+2]];return h%3==2?p=p.substring(0,p.length-1)+"=":h%3==1&&(p=p.substring(0,p.length-2)+"=="),p}(l)};if(l instanceof DataView)return{rr_type:l.constructor.name,args:[Kn2(l.buffer,c,d),l.byteOffset,l.byteLength]};if(l instanceof HTMLImageElement){var h=l.constructor.name,{src:p}=l;return{rr_type:h,src:p}}return l instanceof HTMLCanvasElement?{rr_type:"HTMLImageElement",src:l.toDataURL()}:l instanceof ImageData?{rr_type:l.constructor.name,args:[Kn2(l.data,c,d),l.width,l.height]}:Qn2(l,c)||"object"==typeof l?{rr_type:l.constructor.name,index:Xn2(l,c,d)}:l}var Zn2=(l,c,d)=>l.map((l=>Kn2(l,c,d))),Qn2=(l,c)=>{var d=["WebGLActiveInfo","WebGLBuffer","WebGLFramebuffer","WebGLProgram","WebGLRenderbuffer","WebGLShader","WebGLShaderPrecisionFormat","WebGLTexture","WebGLUniformLocation","WebGLVertexArrayObject","WebGLVertexArrayObjectOES"].filter((l=>"function"==typeof c[l]));return Boolean(d.find((d=>l instanceof c[d])))};function ts2(l,c,d,h){var p=[];try{var f=qi2(l.HTMLCanvasElement.prototype,"getContext",(function(l){return function(p){for(var f=arguments.length,m=new Array(f>1?f-1:0),y=1;y<f;y++)m[y-1]=arguments[y];if(!en2(this,c,d,!0)){var _=function(l){return"experimental-webgl"===l?"webgl":l}(p);if("__context"in this||(this.__context=_),h&&["webgl","webgl2"].includes(_))if(m[0]&&"object"==typeof m[0]){var b=m[0];b.preserveDrawingBuffer||(b.preserveDrawingBuffer=!0)}else m.splice(0,1,{preserveDrawingBuffer:!0})}return l.apply(this,[p,...m])}}));p.push(f)}catch(m){console.error("failed to patch HTMLCanvasElement.prototype.getContext")}return()=>{p.forEach((l=>l()))}}function es2(l,c,d,h,p,f){var m=[],y=Object.getOwnPropertyNames(l),h22=function(y){if(["isContextLost","canvas","drawingBufferWidth","drawingBufferHeight"].includes(y))return 0;try{if("function"!=typeof l[y])return 0;var _=qi2(l,y,(function(l){return function(){for(var m=arguments.length,_=new Array(m),b=0;b<m;b++)_[b]=arguments[b];var w=l.apply(this,_);if(Xn2(w,f,this),"tagName"in this.canvas&&!en2(this.canvas,h,p,!0)){var E=Zn2(_,f,this),M={type:c,property:y,args:E};d(this.canvas,M)}return w}}));m.push(_)}catch(w){var b=Yi2(l,y,{set(l){d(this.canvas,{type:c,property:y,args:[l],setter:!0})}});m.push(b)}};for(var _ of y)h22(_);return m}var yi,_i,wi,xi='(function() {\n  "use strict";\n  var chars = "ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/";\n  var lookup = typeof Uint8Array === "undefined" ? [] : new Uint8Array(256);\n  for (var i = 0; i < chars.length; i++) {\n    lookup[chars.charCodeAt(i)] = i;\n  }\n  var encode = function(arraybuffer) {\n    var bytes = new Uint8Array(arraybuffer), i2, len = bytes.length, base64 = "";\n    for (i2 = 0; i2 < len; i2 += 3) {\n      base64 += chars[bytes[i2] >> 2];\n      base64 += chars[(bytes[i2] & 3) << 4 | bytes[i2 + 1] >> 4];\n      base64 += chars[(bytes[i2 + 1] & 15) << 2 | bytes[i2 + 2] >> 6];\n      base64 += chars[bytes[i2 + 2] & 63];\n    }\n    if (len % 3 === 2) {\n      base64 = base64.substring(0, base64.length - 1) + "=";\n    } else if (len % 3 === 1) {\n      base64 = base64.substring(0, base64.length - 2) + "==";\n    }\n    return base64;\n  };\n  const lastBlobMap = /* @__PURE__ */ new Map();\n  const transparentBlobMap = /* @__PURE__ */ new Map();\n  async function getTransparentBlobFor(width, height, dataURLOptions) {\n    const id = `${width}-${height}`;\n    if ("OffscreenCanvas" in globalThis) {\n      if (transparentBlobMap.has(id)) return transparentBlobMap.get(id);\n      const offscreen = new OffscreenCanvas(width, height);\n      offscreen.getContext("2d");\n      const blob = await offscreen.convertToBlob(dataURLOptions);\n      const arrayBuffer = await blob.arrayBuffer();\n      const base64 = encode(arrayBuffer);\n      transparentBlobMap.set(id, base64);\n      return base64;\n    } else {\n      return "";\n    }\n  }\n  const worker = self;\n  worker.onmessage = async function(e) {\n    if ("OffscreenCanvas" in globalThis) {\n      const { id, bitmap, width, height, dataURLOptions } = e.data;\n      const transparentBase64 = getTransparentBlobFor(\n        width,\n        height,\n        dataURLOptions\n      );\n      const offscreen = new OffscreenCanvas(width, height);\n      const ctx = offscreen.getContext("2d");\n      ctx.drawImage(bitmap, 0, 0);\n      bitmap.close();\n      const blob = await offscreen.convertToBlob(dataURLOptions);\n      const type = blob.type;\n      const arrayBuffer = await blob.arrayBuffer();\n      const base64 = encode(arrayBuffer);\n      if (!lastBlobMap.has(id) && await transparentBase64 === base64) {\n        lastBlobMap.set(id, base64);\n        return worker.postMessage({ id });\n      }\n      if (lastBlobMap.get(id) === base64) return worker.postMessage({ id });\n      worker.postMessage({\n        id,\n        type,\n        base64,\n        width,\n        height\n      });\n      lastBlobMap.set(id, base64);\n    } else {\n      return worker.postMessage({ id: e.data.id });\n    }\n  };\n})();\n//# sourceMappingURL=image-bitmap-data-url-worker-IJpC7g_b.js.map\n',ki="undefined"!=typeof self&&self.Blob&&new Blob([xi],{type:"text/javascript;charset=utf-8"});function as2(l){var c;try{if(!(c=ki&&(self.URL||self.webkitURL).createObjectURL(ki)))throw"";var d=new Worker(c,{name:null==l?void 0:l.name});return d.addEventListener("error",(()=>{(self.URL||self.webkitURL).revokeObjectURL(c)})),d}catch(h){return new Worker("data:text/javascript;charset=utf-8,"+encodeURIComponent(xi),{name:null==l?void 0:l.name})}finally{c&&(self.URL||self.webkitURL).revokeObjectURL(c)}}class hs2{constructor(l){c2(this,"pendingCanvasMutations",new Map),c2(this,"rafStamps",{latestId:0,invokeId:null}),c2(this,"mirror"),c2(this,"mutationCb"),c2(this,"resetObservers"),c2(this,"frozen",!1),c2(this,"locked",!1),c2(this,"processMutation",((l,c)=>{!(this.rafStamps.invokeId&&this.rafStamps.latestId!==this.rafStamps.invokeId)&&this.rafStamps.invokeId||(this.rafStamps.invokeId=this.rafStamps.latestId),this.pendingCanvasMutations.has(l)||this.pendingCanvasMutations.set(l,[]),this.pendingCanvasMutations.get(l).push(c)}));var{sampling:c="all",win:d,blockClass:h,blockSelector:p,recordCanvas:f,dataURLOptions:m}=l;this.mutationCb=l.mutationCb,this.mirror=l.mirror,f&&"all"===c&&this.initCanvasMutationObserver(d,h,p),f&&"number"==typeof c&&this.initCanvasFPSObserver(c,d,h,p,{dataURLOptions:m})}reset(){this.pendingCanvasMutations.clear(),this.resetObservers&&this.resetObservers()}freeze(){this.frozen=!0}unfreeze(){this.frozen=!1}lock(){this.locked=!0}unlock(){this.locked=!1}initCanvasFPSObserver(l,c,d,h,p){var f=this,m=ts2(c,d,h,!0),y=new Map,_=new as2;_.onmessage=l=>{var{id:c}=l.data;if(y.set(c,!1),"base64"in l.data){var{base64:d,type:h,width:p,height:f}=l.data;this.mutationCb({id:c,type:Ns["2D"],commands:[{property:"clearRect",args:[0,0,p,f]},{property:"drawImage",args:[{rr_type:"ImageBitmap",args:[{rr_type:"Blob",data:[{rr_type:"ArrayBuffer",base64:d}],type:h}]},0,0]}]})}};var b,w=1e3/l,E=0,d22=l=>{var m,M,N;E&&l-E<w||(E=l,(m=[],M=l=>{l.querySelectorAll("canvas").forEach((l=>{en2(l,d,h,!0)||m.push(l)})),l.querySelectorAll("*").forEach((l=>{l.shadowRoot&&M(l.shadowRoot)}))},M(c.document),m).forEach((N=e3((function*(l){var c,d=f.mirror.getId(l);if(!y.get(d)&&0!==l.width&&0!==l.height){if(y.set(d,!0),["webgl","webgl2"].includes(l.__context)){var h=l.getContext(l.__context);!1===(null==(c=null==h?void 0:h.getContextAttributes())?void 0:c.preserveDrawingBuffer)&&h.clear(h.COLOR_BUFFER_BIT)}var m=l.clientWidth||l.width,b=l.clientHeight||l.height,w=yield createImageBitmap(l,{resizeWidth:m,resizeHeight:b});_.postMessage({id:d,bitmap:w,width:m,height:b,dataURLOptions:p.dataURLOptions},[w])}})),function(l){return N.apply(this,arguments)}))),b=requestAnimationFrame(d22)};b=requestAnimationFrame(d22),this.resetObservers=()=>{m(),cancelAnimationFrame(b)}}initCanvasMutationObserver(l,c,d){this.startRAFTimestamping(),this.startPendingCanvasMutationFlusher();var h,p,f,m,y,_=ts2(l,c,d,!1),b=function(l,c,d,h){var p=[],f=Object.getOwnPropertyNames(c.CanvasRenderingContext2D.prototype),o22=function(f){try{if("function"!=typeof c.CanvasRenderingContext2D.prototype[f])return 1;var m=qi2(c.CanvasRenderingContext2D.prototype,f,(function(p){return function(){for(var m=arguments.length,y=new Array(m),_=0;_<m;_++)y[_]=arguments[_];return en2(this.canvas,d,h,!0)||setTimeout((()=>{var d=Zn2(y,c,this);l(this.canvas,{type:Ns["2D"],property:f,args:d})}),0),p.apply(this,y)}}));p.push(m)}catch(_){var y=Yi2(c.CanvasRenderingContext2D.prototype,f,{set(c){l(this.canvas,{type:Ns["2D"],property:f,args:[c],setter:!0})}});p.push(y)}};for(var m of f)o22(m);return()=>{p.forEach((l=>l()))}}(this.processMutation.bind(this),l,c,d),w=(h=this.processMutation.bind(this),f=c,m=d,(y=[]).push(...es2((p=l).WebGLRenderingContext.prototype,Ns.WebGL,h,f,m,p)),void 0!==p.WebGL2RenderingContext&&y.push(...es2(p.WebGL2RenderingContext.prototype,Ns.WebGL2,h,f,m,p)),()=>{y.forEach((l=>l()))});this.resetObservers=()=>{_(),b(),w()}}startPendingCanvasMutationFlusher(){requestAnimationFrame((()=>this.flushPendingCanvasMutations()))}startRAFTimestamping(){var t22=l=>{this.rafStamps.latestId=l,requestAnimationFrame(t22)};requestAnimationFrame(t22)}flushPendingCanvasMutations(){this.pendingCanvasMutations.forEach(((l,c)=>{var d=this.mirror.getId(c);this.flushPendingCanvasMutationFor(c,d)})),requestAnimationFrame((()=>this.flushPendingCanvasMutations()))}flushPendingCanvasMutationFor(l,c){if(!this.frozen&&!this.locked){var d=this.pendingCanvasMutations.get(l);if(d&&-1!==c){var h=d.map((l=>i2(l,m))),{type:p}=d[0];this.mutationCb({id:c,type:p,commands:h}),this.pendingCanvasMutations.delete(l)}}}}class us2{constructor(l){c2(this,"trackedLinkElements",new WeakSet),c2(this,"mutationCb"),c2(this,"adoptedStyleSheetCb"),c2(this,"styleMirror",new un2),this.mutationCb=l.mutationCb,this.adoptedStyleSheetCb=l.adoptedStyleSheetCb}attachLinkElement(l,c){"_cssText"in c.attributes&&this.mutationCb({adds:[],removes:[],texts:[],attributes:[{id:c.id,attributes:c.attributes}]}),this.trackLinkElement(l)}trackLinkElement(l){this.trackedLinkElements.has(l)||(this.trackedLinkElements.add(l),this.trackStylesheetInLinkElement(l))}adoptStyleSheets(l,c){var d=this;if(0!==l.length){var h={id:c,styleIds:[]},p=[],s22=function(l){var c;d.styleMirror.has(l)?c=d.styleMirror.getId(l):(c=d.styleMirror.add(l),p.push({styleId:c,rules:Array.from(l.rules||CSSRule,((c,d)=>({rule:_2(c,l.href),index:d})))})),h.styleIds.push(c)};for(var f of l)s22(f);p.length>0&&(h.styles=p),this.adoptedStyleSheetCb(h)}}reset(){this.styleMirror.reset(),this.trackedLinkElements=new WeakSet}trackStylesheetInLinkElement(l){}}class ls2{constructor(){c2(this,"nodeMap",new WeakMap),c2(this,"active",!1)}inOtherBuffer(l,c){var d=this.nodeMap.get(l);return d&&Array.from(d).some((l=>l!==c))}add(l,c){this.active||(this.active=!0,requestAnimationFrame((()=>{this.nodeMap=new WeakMap,this.active=!1}))),this.nodeMap.set(l,(this.nodeMap.get(l)||new Set).add(c))}destroy(){}}var Ei=!1;try{if(2!==Array.from([1],(l=>2*l))[0]){var Ri=document.createElement("iframe");document.body.appendChild(Ri),Array.from=(null==(l=Ri.contentWindow)?void 0:l.Array.from)||Array.from,document.body.removeChild(Ri)}}catch(c){console.debug("Unable to override Array.from",c)}var Mi,Ni,Pi=new O2;function ms2(l){void 0===l&&(l={});var{emit:c,checkoutEveryNms:d,checkoutEveryNth:h,blockClass:p="rr-block",blockSelector:f=null,ignoreClass:m="rr-ignore",ignoreSelector:y=null,maskTextClass:_="rr-mask",maskTextSelector:b=null,inlineStylesheet:w=!0,maskAllInputs:E,maskInputOptions:M,slimDOMOptions:N,maskInputFn:P,maskTextFn:L,hooks:j,packFn:D,sampling:F={},dataURLOptions:U={},mousemoveWait:B,recordDOM:H=!0,recordCanvas:z=!1,recordCrossOriginIframes:q=!1,recordAfter:V=("DOMContentLoaded"===l.recordAfter?l.recordAfter:"load"),userTriggeredOnInput:Z=!1,collectFonts:K=!1,inlineImages:Y=!1,plugins:ee,keepIframeSrcFn:ne=()=>!1,ignoreCSSAttributes:se=new Set([]),errorHandler:ie}=l;Ds=ie;var oe=!q||window.parent===window,le=!1;if(!oe)try{window.parent.document&&(le=!1)}catch(pe){le=!0}if(oe&&!c)throw new Error("emit function is required");if(!oe&&!le)return()=>{};void 0!==B&&void 0===F.mousemove&&(F.mousemove=B),Pi.reset();var ce,pe,fe=!0===E?{color:!0,date:!0,"datetime-local":!0,email:!0,month:!0,number:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0,textarea:!0,select:!0,password:!0}:void 0!==M?M:{password:!0},ge=!0===N||"all"===N?{script:!0,comment:!0,headFavicon:!0,headWhitespace:!0,headMetaSocial:!0,headMetaRobots:!0,headMetaHttpEquiv:!0,headMetaVerification:!0,headMetaAuthorship:"all"===N,headMetaDescKeywords:"all"===N,headTitleMutations:"all"===N}:N||{};void 0===pe&&(pe=window),"NodeList"in pe&&!pe.NodeList.prototype.forEach&&(pe.NodeList.prototype.forEach=Array.prototype.forEach),"DOMTokenList"in pe&&!pe.DOMTokenList.prototype.forEach&&(pe.DOMTokenList.prototype.forEach=Array.prototype.forEach);var be=0,P22=l=>{for(var c of ee||[])c.eventProcessor&&(l=c.eventProcessor(l));return D&&!le&&(l=D(l)),l};yi=(l,p)=>{var f,m=l;if(m.timestamp=ds(),!(null==(f=Fs[0])?void 0:f.isFrozen())||m.type===Cs.FullSnapshot||m.type===Cs.IncrementalSnapshot&&m.data.source===Es.Mutation||Fs.forEach((l=>l.unfreeze())),oe)null==c||c(P22(m),p);else if(le){var y={type:"rrweb",event:P22(m),origin:window.location.origin,isCheckout:p};window.parent.postMessage(y,"*")}if(m.type===Cs.FullSnapshot)ce=m,be=0;else if(m.type===Cs.IncrementalSnapshot){if(m.data.source===Es.Mutation&&m.data.isAttachIframe)return;be++;var _=h&&be>=h,b=d&&m.timestamp-ce.timestamp>d;(_||b)&&_i(!0)}};var W22=l=>{yi({type:Cs.IncrementalSnapshot,data:r2({source:Es.Mutation},l)})},q22=l=>yi({type:Cs.IncrementalSnapshot,data:r2({source:Es.Scroll},l)}),z22=l=>yi({type:Cs.IncrementalSnapshot,data:r2({source:Es.CanvasMutation},l)}),Oe=new us2({mutationCb:W22,adoptedStyleSheetCb:l=>yi({type:Cs.IncrementalSnapshot,data:r2({source:Es.AdoptedStyleSheet},l)})}),Ne=new zn2({mirror:Pi,mutationCb:W22,stylesheetManager:Oe,recordCrossOriginIframes:q,wrappedEmit:yi});for(var De of ee||[])De.getMirror&&De.getMirror({nodeMirror:Pi,crossOriginIframeMirror:Ne.crossOriginIframeMirror,crossOriginIframeStyleMirror:Ne.crossOriginIframeStyleMirror});var Fe=new ls2;wi=new hs2({recordCanvas:z,mutationCb:z22,win:window,blockClass:p,blockSelector:f,mirror:Pi,sampling:F.canvas,dataURLOptions:U});var Ue=new Gn2({mutationCb:W22,scrollCb:q22,bypassOptions:{blockClass:p,blockSelector:f,maskTextClass:_,maskTextSelector:b,inlineStylesheet:w,maskInputOptions:fe,dataURLOptions:U,maskTextFn:L,maskInputFn:P,recordCanvas:z,inlineImages:Y,sampling:F,slimDOMOptions:ge,iframeManager:Ne,stylesheetManager:Oe,canvasManager:wi,keepIframeSrcFn:ne,processedNodeManager:Fe},mirror:Pi});_i=function(l){if(void 0===l&&(l=!1),H){yi({type:Cs.Meta,data:{href:window.location.href,width:Qi2(),height:Zi2()}},l),Oe.reset(),Ue.init(),Fs.forEach((l=>l.lock()));var c=function(l,c){var{mirror:d=new O2,blockClass:h="rr-block",blockSelector:p=null,maskTextClass:f="rr-mask",maskTextSelector:m=null,inlineStylesheet:y=!0,inlineImages:_=!1,recordCanvas:b=!1,maskAllInputs:w=!1,maskTextFn:E,maskInputFn:M,slimDOM:N=!1,dataURLOptions:P,preserveWhiteSpace:L,onSerialize:j,onIframeLoad:D,iframeLoadTimeout:F,onStylesheetLoad:U,stylesheetLoadTimeout:B,keepIframeSrcFn:H=()=>!1}=c||{};return ot2(l,{doc:l,mirror:d,blockClass:h,blockSelector:p,maskTextClass:f,maskTextSelector:m,skipChild:!1,inlineStylesheet:y,maskInputOptions:!0===w?{color:!0,date:!0,"datetime-local":!0,email:!0,month:!0,number:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0,textarea:!0,select:!0,password:!0}:!1===w?{password:!0}:w,maskTextFn:E,maskInputFn:M,slimDOMOptions:!0===N||"all"===N?{script:!0,comment:!0,headFavicon:!0,headWhitespace:!0,headMetaDescKeywords:"all"===N,headMetaSocial:!0,headMetaRobots:!0,headMetaHttpEquiv:!0,headMetaAuthorship:!0,headMetaVerification:!0}:!1===N?{}:N,dataURLOptions:P,inlineImages:_,recordCanvas:b,preserveWhiteSpace:L,onSerialize:j,onIframeLoad:D,iframeLoadTimeout:F,onStylesheetLoad:U,stylesheetLoadTimeout:B,keepIframeSrcFn:H,newlyAddedElement:!1})}(document,{mirror:Pi,blockClass:p,blockSelector:f,maskTextClass:_,maskTextSelector:b,inlineStylesheet:w,maskAllInputs:fe,maskTextFn:L,maskInputFn:P,slimDOM:ge,dataURLOptions:U,recordCanvas:z,inlineImages:Y,onSerialize:l=>{on2(l,Pi)&&Ne.addIframe(l),an2(l,Pi)&&Oe.trackLinkElement(l),hn2(l)&&Ue.addShadowRoot(zi2_shadowRoot(l),document)},onIframeLoad:(l,c)=>{Ne.attachIframe(l,c),Ue.observeAttachShadow(l)},onStylesheetLoad:(l,c)=>{Oe.attachLinkElement(l,c)},keepIframeSrcFn:ne});if(!c)return console.warn("Failed to snapshot the document");yi({type:Cs.FullSnapshot,data:{node:c,initialOffset:Ki2(window)}},l),Fs.forEach((l=>l.unlock())),document.adoptedStyleSheets&&document.adoptedStyleSheets.length>0&&Oe.adoptStyleSheets(document.adoptedStyleSheets,Pi.getId(document))}};try{var Be=[],K22=l=>{var c;return On2(Pn2)({mutationCb:W22,mousemoveCb:(l,c)=>yi({type:Cs.IncrementalSnapshot,data:{source:c,positions:l}}),mouseInteractionCb:l=>yi({type:Cs.IncrementalSnapshot,data:r2({source:Es.MouseInteraction},l)}),scrollCb:q22,viewportResizeCb:l=>yi({type:Cs.IncrementalSnapshot,data:r2({source:Es.ViewportResize},l)}),inputCb:l=>yi({type:Cs.IncrementalSnapshot,data:r2({source:Es.Input},l)}),mediaInteractionCb:l=>yi({type:Cs.IncrementalSnapshot,data:r2({source:Es.MediaInteraction},l)}),styleSheetRuleCb:l=>yi({type:Cs.IncrementalSnapshot,data:r2({source:Es.StyleSheetRule},l)}),styleDeclarationCb:l=>yi({type:Cs.IncrementalSnapshot,data:r2({source:Es.StyleDeclaration},l)}),canvasMutationCb:z22,fontCb:l=>yi({type:Cs.IncrementalSnapshot,data:r2({source:Es.Font},l)}),selectionCb:l=>{yi({type:Cs.IncrementalSnapshot,data:r2({source:Es.Selection},l)})},customElementCb:l=>{yi({type:Cs.IncrementalSnapshot,data:r2({source:Es.CustomElement},l)})},blockClass:p,ignoreClass:m,ignoreSelector:y,maskTextClass:_,maskTextSelector:b,maskInputOptions:fe,inlineStylesheet:w,sampling:F,recordDOM:H,recordCanvas:z,inlineImages:Y,userTriggeredOnInput:Z,collectFonts:K,doc:l,maskInputFn:P,maskTextFn:L,keepIframeSrcFn:ne,blockSelector:f,slimDOMOptions:ge,dataURLOptions:U,mirror:Pi,iframeManager:Ne,stylesheetManager:Oe,shadowDomManager:Ue,processedNodeManager:Fe,canvasManager:wi,ignoreCSSAttributes:se,plugins:(null==(c=null==ee?void 0:ee.filter((l=>l.observer)))?void 0:c.map((l=>({observer:l.observer,options:l.options,callback:c=>yi({type:Cs.Plugin,data:{plugin:l.name,payload:c}})}))))||[]},j)};Ne.addLoadListener((l=>{try{Be.push(K22(l.contentDocument))}catch(c){console.warn(c)}}));var Z22=()=>{_i(),Be.push(K22(document)),Ei=!0};return"interactive"===document.readyState||"complete"===document.readyState?Z22():(Be.push(Gi2("DOMContentLoaded",(()=>{yi({type:Cs.DomContentLoaded,data:{}}),"DOMContentLoaded"===V&&Z22()}))),Be.push(Gi2("load",(()=>{yi({type:Cs.Load,data:{}}),"load"===V&&Z22()}),window))),()=>{Be.forEach((l=>l())),Fe.destroy(),Ne.removeLoadListener(),Ne.destroy(),Ei=!1,Ds=void 0}}catch(pe){console.warn(pe)}}ms2.addCustomEvent=(l,c)=>{if(!Ei)throw new Error("please add custom event after start recording");yi({type:Cs.Custom,data:{tag:l,payload:c}})},ms2.freezePage=()=>{Fs.forEach((l=>l.freeze()))},ms2.takeFullSnapshot=l=>{if(!Ei)throw new Error("please take full snapshot after start recording");_i(l)},ms2.mirror=Pi,(Ni=Mi||(Mi={}))[Ni.NotStarted=0]="NotStarted",Ni[Ni.Running=1]="Running",Ni[Ni.Stopped=2]="Stopped";var{addCustomEvent:ji}=ms2,{freezePage:Fi}=ms2,{takeFullSnapshot:qi}=ms2,Vi=Object.defineProperty,Ss2=(l,c,d)=>{return f=d,(p="symbol"!=typeof c?c+"":c)in(h=l)?Vi(h,p,{enumerable:!0,configurable:!0,writable:!0,value:f}):h[p]=f;var h,p,f};class ks2{constructor(l){Ss2(this,"fileName"),Ss2(this,"functionName"),Ss2(this,"lineNumber"),Ss2(this,"columnNumber"),this.fileName=l.fileName||"",this.functionName=l.functionName||"",this.lineNumber=l.lineNumber,this.columnNumber=l.columnNumber}toString(){var l=this.lineNumber||"",c=this.columnNumber||"";return this.functionName?this.functionName+" ("+this.fileName+":"+l+":"+c+")":this.fileName+":"+l+":"+c}}var Gi=/(^|@)\S+:\d+/,Ki=/^\s*at .*(\S+:\d+|\(native\))/m,Ji=/^(eval@)?(\[native code])?$/,Yi={parse:function(l){return l?void 0!==l.stacktrace||void 0!==l["opera#sourceloc"]?this.parseOpera(l):l.stack&&l.stack.match(Ki)?this.parseV8OrIE(l):l.stack?this.parseFFOrSafari(l):[]:[]},extractLocation:function(l){if(-1===l.indexOf(":"))return[l];var c=/(.+?)(?::(\d+))?(?::(\d+))?$/.exec(l.replace(/[()]/g,""));if(!c)throw new Error("Cannot parse given url: "+l);return[c[1],c[2]||void 0,c[3]||void 0]},parseV8OrIE:function(l){return l.stack.split("\n").filter((function(l){return!!l.match(Ki)}),this).map((function(l){l.indexOf("(eval ")>-1&&(l=l.replace(/eval code/g,"eval").replace(/(\(eval at [^()]*)|(\),.*$)/g,""));var c=l.replace(/^\s+/,"").replace(/\(eval code/g,"("),d=c.match(/ (\((.+):(\d+):(\d+)\)$)/),h=(c=d?c.replace(d[0],""):c).split(/\s+/).slice(1),p=this.extractLocation(d?d[1]:h.pop()),f=h.join(" ")||void 0,m=["eval","<anonymous>"].indexOf(p[0])>-1?void 0:p[0];return new ks2({functionName:f,fileName:m,lineNumber:p[1],columnNumber:p[2]})}),this)},parseFFOrSafari:function(l){return l.stack.split("\n").filter((function(l){return!l.match(Ji)}),this).map((function(l){if(l.indexOf(" > eval")>-1&&(l=l.replace(/ line (\d+)(?: > eval line \d+)* > eval:\d+:\d+/g,":$1")),-1===l.indexOf("@")&&-1===l.indexOf(":"))return new ks2({functionName:l});var c=/((.*".+"[^@]*)?[^@]*)(?:@)/,d=l.match(c),h=d&&d[1]?d[1]:void 0,p=this.extractLocation(l.replace(c,""));return new ks2({functionName:h,fileName:p[0],lineNumber:p[1],columnNumber:p[2]})}),this)},parseOpera:function(l){return!l.stacktrace||l.message.indexOf("\n")>-1&&l.message.split("\n").length>l.stacktrace.split("\n").length?this.parseOpera9(l):l.stack?this.parseOpera11(l):this.parseOpera10(l)},parseOpera9:function(l){for(var c=/Line (\d+).*script (?:in )?(\S+)/i,d=l.message.split("\n"),h=[],p=2,f=d.length;p<f;p+=2){var m=c.exec(d[p]);m&&h.push(new ks2({fileName:m[2],lineNumber:parseFloat(m[1])}))}return h},parseOpera10:function(l){for(var c=/Line (\d+).*script (?:in )?(\S+)(?:: In function (\S+))?$/i,d=l.stacktrace.split("\n"),h=[],p=0,f=d.length;p<f;p+=2){var m=c.exec(d[p]);m&&h.push(new ks2({functionName:m[3]||void 0,fileName:m[2],lineNumber:parseFloat(m[1])}))}return h},parseOpera11:function(l){return l.stack.split("\n").filter((function(l){return!!l.match(Gi)&&!l.match(/^Error created at/)}),this).map((function(l){var c=l.split("@"),d=this.extractLocation(c.pop()),h=(c.shift()||"").replace(/<anonymous function(: (\w+))?>/,"$2").replace(/\([^)]*\)/g,"")||void 0;return new ks2({functionName:h,fileName:d[0],lineNumber:d[1],columnNumber:d[2]})}),this)}};function xs2(l){if(!l||!l.outerHTML)return"";for(var c="";l.parentElement;){var d=l.localName;if(!d)break;d=d.toLowerCase();var h=l.parentElement,p=[];if(h.children&&h.children.length>0)for(var f=0;f<h.children.length;f++){var m=h.children[f];m.localName&&m.localName.toLowerCase&&m.localName.toLowerCase()===d&&p.push(m)}p.length>1&&(d+=":eq("+p.indexOf(l)+")"),c=d+(c?">"+c:""),l=h}return c}function _s2(l){return"[object Object]"===Object.prototype.toString.call(l)}function Os2(l,c){if(0===c)return!0;var d=Object.keys(l);for(var h of d)if(_s2(l[h])&&Os2(l[h],c-1))return!0;return!1}function Ts2(l,c){var d={numOfKeysLimit:50,depthOfLimit:4};Object.assign(d,c);var h=[],p=[];return JSON.stringify(l,(function(l,c){if(h.length>0){var f=h.indexOf(this);~f?h.splice(f+1):h.push(this),~f?p.splice(f,1/0,l):p.push(l),~h.indexOf(c)&&(c=h[0]===c?"[Circular ~]":"[Circular ~."+p.slice(0,h.indexOf(c)).join(".")+"]")}else h.push(c);if(null===c)return c;if(void 0===c)return"undefined";if(_s2(m=c)&&Object.keys(m).length>d.numOfKeysLimit||"function"==typeof m||_s2(m)&&Os2(m,d.depthOfLimit))return function(l){var c=l.toString();return d.stringLengthLimit&&c.length>d.stringLengthLimit&&(c=c.slice(0,d.stringLengthLimit)+"..."),c}(c);var m;if("bigint"==typeof c)return c.toString()+"n";if(c instanceof Event){var y={};for(var _ in c){var b=c[_];Array.isArray(b)?y[_]=xs2(b.length?b[0]:null):y[_]=b}return y}return c instanceof Node?c instanceof HTMLElement?c?c.outerHTML:"":c.nodeName:c instanceof Error?c.stack?c.stack+"\nEnd of stack for Error object":c.name+": "+c.message:c}))}var Qi={level:["assert","clear","count","countReset","debug","dir","dirxml","error","group","groupCollapsed","groupEnd","info","log","table","time","timeEnd","timeLog","trace","warn"],lengthThreshold:1e3,logger:"console"};function As2(l,c,d){var h,p=d?Object.assign({},Qi,d):Qi,f=p.logger;if(!f)return()=>{};h="string"==typeof f?c[f]:f;var m=0,y=!1,_=[];if(p.level.includes("error")){var u22=c=>{var d=c.message,h=c.error,f=Yi.parse(h).map((l=>l.toString())),m=[Ts2(d,p.stringifyOptions)];l({level:"error",trace:f,payload:m})};c.addEventListener("error",u22),_.push((()=>{c.removeEventListener("error",u22)}));var l22=c=>{var d,h;c.reason instanceof Error?h=[Ts2("Uncaught (in promise) "+(d=c.reason).name+": "+d.message,p.stringifyOptions)]:(d=new Error,h=[Ts2("Uncaught (in promise)",p.stringifyOptions),Ts2(c.reason,p.stringifyOptions)]);var f=Yi.parse(d).map((l=>l.toString()));l({level:"error",trace:f,payload:h})};c.addEventListener("unhandledrejection",l22),_.push((()=>{c.removeEventListener("unhandledrejection",l22)}))}for(var b of p.level)_.push(f22(h,b));return()=>{_.forEach((l=>l()))};function f22(c,d){var h=this;return c[d]?function(c,f){try{if(!(f in c))return()=>{};var _=c[f],b=(f=>function(){for(var _=arguments.length,b=new Array(_),w=0;w<_;w++)b[w]=arguments[w];if(f.apply(h,b),!("assert"===d&&b[0]||y)){y=!0;try{var E=Yi.parse(new Error).map((l=>l.toString())).splice(1),M=("assert"===d?b.slice(1):b).map((l=>Ts2(l,p.stringifyOptions)));++m<p.lengthThreshold?l({level:d,trace:E,payload:M}):m===p.lengthThreshold&&l({level:"warn",trace:[],payload:[Ts2("The number of log records reached the threshold.")]})}catch(c){f("rrweb logger error:",c,...b)}finally{y=!1}}})(_);return"function"==typeof b&&(b.prototype=b.prototype||{},Object.defineProperties(b,{__rrweb_original__:{enumerable:!1,value:_}})),c[f]=b,()=>{c[f]=_}}catch(w){return()=>{}}}(c,d):()=>{}}}var Bs2=l=>({name:"rrweb/console@1",observer:As2,options:l}),Xi="undefined"!=typeof window?window:void 0,ro="undefined"!=typeof globalThis?globalThis:Xi,oo=Array.prototype.forEach,ao=null==ro?void 0:ro.navigator,co=null==ro?void 0:ro.document;null==ro||ro.location,null==ro||ro.fetch,null!=ro&&ro.XMLHttpRequest&&"withCredentials"in new ro.XMLHttpRequest&&ro.XMLHttpRequest,null==ro||ro.AbortController,null==ao||ao.userAgent;var ho=null!=Xi?Xi:{},po=Array.isArray,fo=Object.prototype,mo=fo.hasOwnProperty,go=fo.toString,vo=po||function(l){return"[object Array]"===go.call(l)},Hs2=l=>"function"==typeof l,Vs2=l=>l===Object(l)&&!vo(l),Js2=l=>void 0===l,Ys2=l=>"[object String]"==go.call(l),Xs2=l=>null===l,Ks2=l=>Js2(l)||Xs2(l),Zs2=l=>"[object Number]"==go.call(l),Qs2=l=>"[object Boolean]"===go.call(l),to2=l=>l instanceof FormData;function eo2(l,c,d,h,p){return c>d&&(h.warn("min cannot be greater than max."),c=d),Zs2(l)?l>d?(h.warn(" cannot be  greater than max: "+d+". Using max value instead."),d):l<c?(h.warn(" cannot be less than min: "+c+". Using min value instead."),c):l:(h.warn(" must be a number. using max or fallback. max: "+d+", fallback: "+p),eo2(p||d,c,d,h))}class ro2{constructor(l){this.t={},this.i=l.i,this.o=eo2(l.bucketSize,0,100,l.h),this.u=eo2(l.refillRate,0,this.o,l.h),this.v=eo2(l.refillInterval,0,864e5,l.h)}m(l,c){var d=c-l.lastAccess,h=Math.floor(d/this.v);if(h>0){var p=h*this.u;l.tokens=Math.min(l.tokens+p,this.o),l.lastAccess=l.lastAccess+h*this.v}}consumeRateLimit(l){var c,d=Date.now(),h=String(l),p=this.t[h];return p?this.m(p,d):(p={tokens:this.o,lastAccess:d},this.t[h]=p),0===p.tokens||(p.tokens--,0===p.tokens&&(null==(c=this.i)||c.call(this,l)),0===p.tokens)}stop(){this.t={}}}var yo="1.292.0",so2=l=>{var c={S:function(c){if(Xi&&ho.POSTHOG_DEBUG&&!Js2(Xi.console)&&Xi.console){for(var d=("__rrweb_original__"in Xi.console[c]?Xi.console[c].__rrweb_original__:Xi.console[c]),h=arguments.length,p=new Array(h>1?h-1:0),f=1;f<h;f++)p[f-1]=arguments[f];d(l,...p)}},info:function(){for(var l=arguments.length,d=new Array(l),h=0;h<l;h++)d[h]=arguments[h];c.S("log",...d)},warn:function(){for(var l=arguments.length,d=new Array(l),h=0;h<l;h++)d[h]=arguments[h];c.S("warn",...d)},error:function(){for(var l=arguments.length,d=new Array(l),h=0;h<l;h++)d[h]=arguments[h];c.S("error",...d)},critical:function(){for(var c=arguments.length,d=new Array(c),h=0;h<c;h++)d[h]=arguments[h];console.error(l,...d)},uninitializedWarning:l=>{c.error("You must initialize PostHog before calling "+l)},createLogger:c=>so2(l+" "+c)};return c},_o=so2("[PostHog.js]"),bo=_o.createLogger,wo={};function uo2(l,c,d){if(!Ks2(l)){if(vo(l))return function(l,c,d){if(vo(l))if(oo&&l.forEach===oo)l.forEach(c,d);else if("length"in l&&l.length===+l.length)for(var h=0,p=l.length;h<p;h++)if(h in l&&c.call(d,l[h],h)===wo)return}(l,c,d);if(to2(l)){for(var h of l.entries())if(c.call(d,h[1],h[0])===wo)return}else for(var p in l)if(mo.call(l,p)&&c.call(d,l[p],p)===wo)return}}function lo2(l,c,d,h){var{capture:p=!1,passive:f=!0}={};null==l||l.addEventListener(c,d,{capture:p,passive:f})}var So=["localhost","127.0.0.1"],fo2=l=>{var c=null==co?void 0:co.createElement("a");return Js2(c)?null:(c.href=l,c)};function po2(l,c,d){try{if(!(c in l))return()=>{};var h=l[c],p=d(h);return Hs2(p)&&(p.prototype=p.prototype||{},Object.defineProperties(p,{__posthog_wrapped__:{enumerable:!1,value:!0}})),l[c]=p,()=>{l[c]=h}}catch(f){return()=>{}}}function mo2(l,c){var d,h=function(l){try{return"string"==typeof l?new URL(l).hostname:"url"in l?new URL(l.url).hostname:l.hostname}catch(c){return null}}(l),p={hostname:h,isHostDenied:!1};if(null==(d=c.payloadHostDenyList)||!d.length||null==h||!h.trim().length)return p;for(var f of c.payloadHostDenyList)if(h.endsWith(f))return{hostname:h,isHostDenied:!0};return p}var jo="$session_is_sampled",zo="$session_past_minimum_duration",Go="$session_recording_url_trigger_activated_session",Ko="$session_recording_event_trigger_activated_session",Jo=new RegExp("(4[0-9]{12}(?:[0-9]{3})?)|(5[1-5][0-9]{14})|(6(?:011|5[0-9]{2})[0-9]{12})|(3[47][0-9]{13})|(3(?:0[0-5]|[68][0-9])[0-9]{11})|((?:2131|1800|35[0-9]{3})[0-9]{11})"),Yo=new RegExp("(\\d{3}-?\\d{2}-?\\d{4})"),Qo="[SessionRecording]",Xo="redacted",ea={initiatorTypes:["audio","beacon","body","css","early-hint","embed","fetch","frame","iframe","icon","image","img","input","link","navigation","object","ping","script","track","video","xmlhttprequest"],maskRequestFn:l=>l,recordHeaders:!1,recordBody:!1,recordInitialRequests:!1,recordPerformance:!1,performanceEntryTypeToObserve:["first-input","navigation","paint","resource"],payloadSizeLimitBytes:1e6,payloadHostDenyList:[".lr-ingest.io",".ingest.sentry.io",".clarity.ms","analytics.google.com","bam.nr-data.net"]},ta=["authorization","x-forwarded-for","authorization","cookie","set-cookie","x-api-key","x-real-ip","remote-addr","forwarded","proxy-authorization","x-csrf-token","x-csrftoken","x-xsrf-token"],ra=["password","secret","passwd","api_key","apikey","auth","credentials","mysql_pwd","privatekey","private_key","token"],na=["/s/","/e/","/i/"];function Oo2(l,c,d,h){if(Ks2(l))return l;var p=(null==c?void 0:c["content-length"])||new Blob([l]).size;return Ys2(p)&&(p=parseInt(p)),p>d?Qo+" "+h+" body too large to record ("+p+" bytes)":l}function To2(l,c){if(Ks2(l))return l;var d=l;return function(l){if(Ks2(l))return!1;if(Ys2(l)){if(l=function(l){return l.trim()}(l),Jo.test((l||"").replace(/[- ]/g,"")))return!1;if(Yo.test(l))return!1}return!0}(d)||(d=Qo+" "+c+" body "+Xo),uo2(ra,(l=>{var h,p;null!=(h=d)&&h.length&&-1!==(null==(p=d)?void 0:p.indexOf(l))&&(d=Qo+" "+c+" body "+Xo+" as might contain: "+l)})),d}var ia=bo("[Recorder]"),Bo2=l=>"navigation"===l.entryType,Lo2=l=>"resource"===l.entryType;function No2(l,c){return!!c&&(Qs2(c)||c[l])}function jo2(l){var{type:c,recordBody:d,headers:h,url:p}=l;function s22(l){var c=Object.keys(h).find((l=>"content-type"===l.toLowerCase())),d=c&&h[c];return l.some((l=>null==d?void 0:d.includes(l)))}if(!d)return!1;if(function t3(l){try{return"string"==typeof l?l.startsWith("blob:"):l instanceof URL?"blob:"===l.protocol:l instanceof Request&&t3(l.url)}catch(c){return!1}}(p))return!1;if(Qs2(d))return!0;if(vo(d))return s22(d);var f=d[c];return Qs2(f)?f:s22(f)}function Do2(l,c,d,h,p,f){return Uo2.apply(this,arguments)}function Uo2(){return Uo2=e3((function*(l,c,d,h,p,f){return void 0===f&&(f=0),f>10?(ia.warn("Failed to get performance entry for request",{url:d,initiatorType:c}),null):function(l,c){for(var d=l.length-1;d>=0;d-=1)if(c(l[d]))return l[d]}(l.performance.getEntriesByName(d),(l=>Lo2(l)&&l.initiatorType===c&&(Js2(h)||l.startTime>=h)&&(Js2(p)||l.startTime<=p)))||(yield new Promise((l=>setTimeout(l,50*f))),Do2(l,c,d,h,p,f+1))})),Uo2.apply(this,arguments)}function Po2(l){var{body:c,options:d,url:h}=l;if(Ks2(c))return null;var{hostname:p,isHostDenied:f}=mo2(h,d);if(f)return p+" is in deny list";if(Ys2(c))return c;if((l=>l instanceof Document)(c))return c.textContent;if(to2(c))return function(l,c){var d,h;void 0===c&&(c="&");var p=[];return uo2(l,(function(l,c){Js2(l)||Js2(c)||"undefined"===c||(d=encodeURIComponent(l instanceof File?l.name:l.toString()),h=encodeURIComponent(c),p[p.length]=h+"="+d)})),p.join(c)}(c);if(Vs2(c))try{return JSON.stringify(c)}catch(m){return"[SessionReplay] Failed to stringify response object"}return"[SessionReplay] Cannot read body of type "+toString.call(c)}var $o2=l=>!Xs2(l)&&("navigation"===l.entryType||"resource"===l.entryType);function Wo2(l){var{entry:c,method:d,status:h,networkRequest:p,isInitial:f,start:m,end:y,url:_,initiatorType:b}=l;m=c?c.startTime:m,y=c?c.responseEnd:y;var w=Math.floor(Date.now()-performance.now()),E=Math.floor(w+(m||0)),M=[r2({},c?c.toJSON():{name:_},{startTime:Js2(m)?void 0:Math.round(m),endTime:Js2(y)?void 0:Math.round(y),timeOrigin:w,timestamp:E,method:d,initiatorType:b||(c?c.initiatorType:void 0),status:h,requestHeaders:p.requestHeaders,requestBody:p.requestBody,responseHeaders:p.responseHeaders,responseBody:p.responseBody,isInitial:f})];if($o2(c))for(var N of c.serverTiming||[])M.push({timeOrigin:w,timestamp:E,startTime:Math.round(c.startTime),name:N.name,duration:N.duration,entryType:"serverTiming"});return M}var ha=["video/","audio/"];function zo2(l){return new Promise(((c,d)=>{var h=setTimeout((()=>c("[SessionReplay] Timeout while trying to read body")),500);try{l.clone().text().then((l=>c(l)),(l=>d(l))).finally((()=>clearTimeout(h)))}catch(p){clearTimeout(h),c("[SessionReplay] Failed to read body")}}))}function Go2(){return(Go2=e3((function*(l){var{r:c,options:d,url:h}=l,{hostname:p,isHostDenied:f}=mo2(h,d);return f?Promise.resolve(p+" is in deny list"):zo2(c)}))).apply(this,arguments)}function Ho2(){return(Ho2=e3((function*(l){var{r:c,options:d,url:h}=l,p=function(l){var c,{r:d,options:h,url:p}=l;if("chunked"===d.headers.get("Transfer-Encoding"))return"Chunked Transfer-Encoding is not supported";var f=null==(c=d.headers.get("Content-Type"))?void 0:c.toLowerCase(),m=ha.some((l=>null==f?void 0:f.startsWith(l)));if(f&&m)return"Content-Type "+f+" is not supported";var{hostname:y,isHostDenied:_}=mo2(p,h);return _?y+" is in deny list":null}({r:c,options:d,url:h});return Xs2(p)?zo2(c):Promise.resolve(p)}))).apply(this,arguments)}var ma=null;function Yo2(l,c,d){if(!("performance"in c))return()=>{};if(ma)return ia.warn("Network observer already initialised, doing nothing"),()=>{};var h=d?Object.assign({},ea,d):ea,s22=c=>{var d=[];c.requests.forEach((l=>{var c=h.maskRequestFn(l);c&&d.push(c)})),d.length>0&&l(r2({},c,{requests:d}))},p=function(l,c,d){if(d.recordInitialRequests){var h=c.performance.getEntries().filter((l=>Bo2(l)||Lo2(l)&&d.initiatorTypes.includes(l.initiatorType)));l({requests:h.flatMap((l=>Wo2({entry:l,method:void 0,status:void 0,networkRequest:{},isInitial:!0}))),isInitial:!0})}var p=new c.PerformanceObserver((c=>{var h=c.getEntries().filter((l=>{return Bo2(l)||Lo2(l)&&d.initiatorTypes.includes(l.initiatorType)&&(c=l,!d.recordBody&&!d.recordHeaders||"xmlhttprequest"!==c.initiatorType&&"fetch"!==c.initiatorType);var c}));l({requests:h.flatMap((l=>Wo2({entry:l,method:void 0,status:void 0,networkRequest:{}})))})})),f=PerformanceObserver.supportedEntryTypes.filter((l=>d.performanceEntryTypeToObserve.includes(l)));return p.observe({entryTypes:f}),()=>{p.disconnect()}}(s22,c,h),a22=()=>{},h22=()=>{};return(h.recordHeaders||h.recordBody)&&(a22=function(l,c,d){if(!d.initiatorTypes.includes("xmlhttprequest"))return()=>{};var h=No2("request",d.recordHeaders),p=No2("response",d.recordHeaders),f=po2(c.XMLHttpRequest.prototype,"open",(f=>function(m,y,_,b,w){void 0===_&&(_=!0);var E,M,N=this,P=new Request(y),L={},j={},D=N.setRequestHeader.bind(N);N.setRequestHeader=(l,c)=>(j[l]=c,D(l,c)),h&&(L.requestHeaders=j);var F=N.send.bind(N);N.send=l=>(jo2({type:"request",headers:j,url:y,recordBody:d.recordBody})&&(L.requestBody=Po2({body:l,options:d,url:y})),E=c.performance.now(),F(l));var y22=()=>{if(N.readyState===N.DONE){N.removeEventListener("readystatechange",y22),M=c.performance.now();var h={};N.getAllResponseHeaders().trim().split(/[\r\n]+/).forEach((l=>{var c=l.split(": "),d=c.shift(),p=c.join(": ");d&&(h[d]=p)})),p&&(L.responseHeaders=h),jo2({type:"response",headers:h,url:y,recordBody:d.recordBody})&&(L.responseBody=Po2({body:N.response,options:d,url:y})),Do2(c,"xmlhttprequest",P.url,E,M).then((c=>{var d=Wo2({entry:c,method:m,status:null==N?void 0:N.status,networkRequest:L,start:E,end:M,url:y.toString(),initiatorType:"xmlhttprequest"});l({requests:d})})).catch((()=>{}))}};N.addEventListener("readystatechange",y22),f.call(N,m,y.toString(),_,b,w)}));return()=>{f()}}(s22,c,h),h22=function(l,c,d){if(!d.initiatorTypes.includes("fetch"))return()=>{};var h=No2("request",d.recordHeaders),p=No2("response",d.recordHeaders),f=po2(c,"fetch",(f=>{return m=e3((function*(m,y){var _,b,w,E=new Request(m,y),M={};try{var N={};E.headers.forEach(((l,c)=>{N[c]=l})),h&&(M.requestHeaders=N),jo2({type:"request",headers:N,url:m,recordBody:d.recordBody})&&(M.requestBody=yield function(l){return Go2.apply(this,arguments)}({r:E,options:d,url:m})),b=c.performance.now(),_=yield f(E),w=c.performance.now();var P={};return _.headers.forEach(((l,c)=>{P[c]=l})),p&&(M.responseHeaders=P),jo2({type:"response",headers:P,url:m,recordBody:d.recordBody})&&(M.responseBody=yield function(l){return Ho2.apply(this,arguments)}({r:_,options:d,url:m})),_}finally{Do2(c,"fetch",E.url,b,w).then((c=>{var d,h=Wo2({entry:c,method:E.method,status:null==(d=_)?void 0:d.status,networkRequest:M,start:b,end:w,url:E.url,initiatorType:"fetch"});l({requests:h})})).catch((()=>{}))}})),function(l,c){return m.apply(this,arguments)};var m}));return()=>{f()}}(s22,c,h)),ma=()=>{p(),a22(),h22()}}var Xo2=l=>({name:"rrweb/network@1",observer:Yo2,options:l}),ya=function(l){return l[l.DomContentLoaded=0]="DomContentLoaded",l[l.Load=1]="Load",l[l.FullSnapshot=2]="FullSnapshot",l[l.IncrementalSnapshot=3]="IncrementalSnapshot",l[l.Meta=4]="Meta",l[l.Custom=5]="Custom",l[l.Plugin=6]="Plugin",l}({}),ba=function(l){return l[l.Mutation=0]="Mutation",l[l.MouseMove=1]="MouseMove",l[l.MouseInteraction=2]="MouseInteraction",l[l.Scroll=3]="Scroll",l[l.ViewportResize=4]="ViewportResize",l[l.Input=5]="Input",l[l.TouchMove=6]="TouchMove",l[l.MediaInteraction=7]="MediaInteraction",l[l.StyleSheetRule=8]="StyleSheetRule",l[l.CanvasMutation=9]="CanvasMutation",l[l.Font=10]="Font",l[l.Log=11]="Log",l[l.Drag=12]="Drag",l[l.StyleDeclaration=13]="StyleDeclaration",l[l.Selection=14]="Selection",l[l.AdoptedStyleSheet=15]="AdoptedStyleSheet",l[l.CustomElement=16]="CustomElement",l}({}),wa="disabled",Sa="sampled",xa="active",ka="buffering",Ca="paused",Ea="trigger",Ia=Ea+"_activated",Aa=Ea+"_pending",Oa=Ea+"_"+wa;function ha2(l,c){return c.some((c=>"regex"===c.matching&&new RegExp(c.url).test(l)))}class ua2{constructor(l){this.k=l}triggerStatus(l){var c=this.k.map((c=>c.triggerStatus(l)));return c.includes(Ia)?Ia:c.includes(Aa)?Aa:Oa}stop(){this.k.forEach((l=>l.stop()))}}class la2{constructor(l){this.k=l}triggerStatus(l){var c=new Set;for(var d of this.k)c.add(d.triggerStatus(l));switch(c.delete(Oa),c.size){case 0:return Oa;case 1:return Array.from(c)[0];default:return Aa}}stop(){this.k.forEach((l=>l.stop()))}}class ca2{triggerStatus(){return Aa}stop(){}}var fa2=l=>"sessionRecording"in l;class da2{constructor(l){this.C=[],this.I=[],this.urlBlocked=!1,this._instance=l}onConfig(l){var c,d;this.C=(fa2(l)?Vs2(l.sessionRecording)?null==(c=l.sessionRecording)?void 0:c.urlTriggers:[]:null==l?void 0:l.urlTriggers)||[],this.I=(fa2(l)?Vs2(l.sessionRecording)?null==(d=l.sessionRecording)?void 0:d.urlBlocklist:[]:null==l?void 0:l.urlBlocklist)||[]}onRemoteConfig(l){this.onConfig(l)}M(l){var c;return 0===this.C.length?Oa:(null==(c=this._instance)?void 0:c.get_property(Go))===l?Ia:Aa}triggerStatus(l){var c=this.M(l),d=c===Ia?Ia:c===Aa?Aa:Oa;return this._instance.register_for_session({$sdk_debug_replay_url_trigger_status:d}),d}checkUrlTriggerConditions(l,c,d){if(void 0!==Xi&&Xi.location.href){var h=Xi.location.href,p=this.urlBlocked,f=ha2(h,this.I);p&&f||(f&&!p?l():!f&&p&&c(),ha2(h,this.C)&&d("url"))}}stop(){}}class va2{constructor(l){this.linkedFlag=null,this.linkedFlagSeen=!1,this.R=()=>{},this._instance=l}triggerStatus(){var l=Aa;return Ks2(this.linkedFlag)&&(l=Oa),this.linkedFlagSeen&&(l=Ia),this._instance.register_for_session({$sdk_debug_replay_linked_flag_trigger_status:l}),l}onConfig(l,c){var d;if(this.linkedFlag=(fa2(l)?Vs2(l.sessionRecording)?null==(d=l.sessionRecording)?void 0:d.linkedFlag:null:null==l?void 0:l.linkedFlag)||null,!Ks2(this.linkedFlag)&&!this.linkedFlagSeen){var h=Ys2(this.linkedFlag)?this.linkedFlag:this.linkedFlag.flag,p=Ys2(this.linkedFlag)?null:this.linkedFlag.variant;this.R=this._instance.onFeatureFlags(((l,d)=>{var f=!1;if(Vs2(d)&&h in d){var m=d[h];f=Qs2(m)?!0===m:p?m===p:!!m}this.linkedFlagSeen=f,f&&c(h,p)}))}}onRemoteConfig(l,c){this.onConfig(l,c)}stop(){this.R()}}class pa2{constructor(l){this.O=[],this._instance=l}onConfig(l){var c;this.O=(fa2(l)?Vs2(l.sessionRecording)?null==(c=l.sessionRecording)?void 0:c.eventTriggers:[]:null==l?void 0:l.eventTriggers)||[]}onRemoteConfig(l){this.onConfig(l)}T(l){var c;return 0===this.O.length?Oa:(null==(c=this._instance)?void 0:c.get_property(Ko))===l?Ia:Aa}triggerStatus(l){var c=this.T(l),d=c===Ia?Ia:c===Aa?Aa:Oa;return this._instance.register_for_session({$sdk_debug_replay_event_trigger_status:d}),d}stop(){}}function ma2(l){return l.isRecordingEnabled?ka:wa}function ga2(l){if(!l.receivedFlags)return ka;if(!l.isRecordingEnabled)return wa;if(l.urlTriggerMatching.urlBlocked)return Ca;var c=!0===l.isSampled,d=new ua2([l.eventTriggerMatching,l.urlTriggerMatching,l.linkedFlagMatching]).triggerStatus(l.sessionId);return c?Sa:d===Ia?xa:d===Aa?ka:!1===l.isSampled?wa:xa}function wa2(l){if(!l.receivedFlags)return ka;if(!l.isRecordingEnabled)return wa;if(l.urlTriggerMatching.urlBlocked)return Ca;var c=new la2([l.eventTriggerMatching,l.urlTriggerMatching,l.linkedFlagMatching]).triggerStatus(l.sessionId),d=c!==Oa,h=Qs2(l.isSampled);return d&&c===Aa?ka:d&&c===Oa||h&&!l.isSampled?wa:!0===l.isSampled?Sa:xa}function ya2(l){var c,d;return(null==(c=JSON.stringify(l,(d=[],function(l,c){if(Vs2(c)){for(;d.length>0&&d[d.length-1]!==this;)d.pop();return d.includes(c)?"[Circular]":(d.push(c),c)}return c})))?void 0:c.length)||0}var Na=Uint8Array,ja=Uint16Array,Da=Uint32Array,Ha=new Na([0,0,0,0,0,0,0,0,1,1,1,1,2,2,2,2,3,3,3,3,4,4,4,4,5,5,5,5,0,0,0,0]),za=new Na([0,0,0,0,1,1,2,2,3,3,4,4,5,5,6,6,7,7,8,8,9,9,10,10,11,11,12,12,13,13,0,0]),Va=new Na([16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15]),Ra2=function(l,c){for(var d=new ja(31),h=0;h<31;++h)d[h]=c+=1<<l[h-1];var p=new Da(d[30]);for(h=1;h<30;++h)for(var f=d[h];f<d[h+1];++f)p[f]=f-d[h]<<5|h;return[d,p]},Ga=Ra2(Ha,2),Ka=Ga[0],Ja=Ga[1];Ka[28]=258,Ja[258]=28;for(var Ya=Ra2(za,0)[1],Qa=new ja(32768),Xa=0;Xa<32768;++Xa){var el=(43690&Xa)>>>1|(21845&Xa)<<1;el=(61680&(el=(52428&el)>>>2|(13107&el)<<2))>>>4|(3855&el)<<4,Qa[Xa]=((65280&el)>>>8|(255&el)<<8)>>>1}var La2=function(l,c,d){for(var h=l.length,p=0,f=new ja(c);p<h;++p)++f[l[p]-1];var m,y=new ja(c);for(p=0;p<c;++p)y[p]=y[p-1]+f[p-1]<<1;for(m=new ja(h),p=0;p<h;++p)m[p]=Qa[y[l[p]-1]++]>>>15-l[p];return m},tl=new Na(288);for(Xa=0;Xa<144;++Xa)tl[Xa]=8;for(Xa=144;Xa<256;++Xa)tl[Xa]=9;for(Xa=256;Xa<280;++Xa)tl[Xa]=7;for(Xa=280;Xa<288;++Xa)tl[Xa]=8;var rl=new Na(32);for(Xa=0;Xa<32;++Xa)rl[Xa]=5;var nl=La2(tl,9),sl=La2(rl,5),Ua2=function(l){return(l/8|0)+(7&l&&1)},Pa2=function(l,c,d){(null==d||d>l.length)&&(d=l.length);var h=new(l instanceof ja?ja:l instanceof Da?Da:Na)(d-c);return h.set(l.subarray(c,d)),h},$a2=function(l,c,d){d<<=7&c;var h=c/8|0;l[h]|=d,l[h+1]|=d>>>8},Wa2=function(l,c,d){d<<=7&c;var h=c/8|0;l[h]|=d,l[h+1]|=d>>>8,l[h+2]|=d>>>16},qa2=function(l,c){for(var d=[],h=0;h<l.length;++h)l[h]&&d.push({s:h,f:l[h]});var p=d.length,f=d.slice();if(!p)return[new Na(0),0];if(1==p){var m=new Na(d[0].s+1);return m[d[0].s]=1,[m,1]}d.sort((function(l,c){return l.f-c.f})),d.push({s:-1,f:25001});var y=d[0],_=d[1],b=0,w=1,E=2;for(d[0]={s:-1,f:y.f+_.f,l:y,r:_};w!=p-1;)y=d[d[b].f<d[E].f?b++:E++],_=d[b!=w&&d[b].f<d[E].f?b++:E++],d[w++]={s:-1,f:y.f+_.f,l:y,r:_};var M=f[0].s;for(h=1;h<p;++h)f[h].s>M&&(M=f[h].s);var N=new ja(M+1),P=za2(d[w-1],N,0);if(P>c){h=0;var L=0,j=P-c,D=1<<j;for(f.sort((function(l,c){return N[c.s]-N[l.s]||l.f-c.f}));h<p;++h){var F=f[h].s;if(!(N[F]>c))break;L+=D-(1<<P-N[F]),N[F]=c}for(L>>>=j;L>0;){var U=f[h].s;N[U]<c?L-=1<<c-N[U]++-1:++h}for(;h>=0&&L;--h){var B=f[h].s;N[B]==c&&(--N[B],++L)}P=c}return[new Na(N),P]},za2=function(l,c,d){return-1==l.s?Math.max(za2(l.l,c,d+1),za2(l.r,c,d+1)):c[l.s]=d},Ga2=function(l){for(var c=l.length;c&&!l[--c];);for(var d=new ja(++c),h=0,p=l[0],f=1,o22=function(l){d[h++]=l},m=1;m<=c;++m)if(l[m]==p&&m!=c)++f;else{if(!p&&f>2){for(;f>138;f-=138)o22(32754);f>2&&(o22(f>10?f-11<<5|28690:f-3<<5|12305),f=0)}else if(f>3){for(o22(p),--f;f>6;f-=6)o22(8304);f>2&&(o22(f-3<<5|8208),f=0)}for(;f--;)o22(p);f=1,p=l[m]}return[d.subarray(0,h),c]},Ha2=function(l,c){for(var d=0,h=0;h<c.length;++h)d+=l[h]*c[h];return d},Va2=function(l,c,d){var h=d.length,p=Ua2(c+2);l[p]=255&h,l[p+1]=h>>>8,l[p+2]=255^l[p],l[p+3]=255^l[p+1];for(var f=0;f<h;++f)l[p+f+4]=d[f];return 8*(p+4+h)},Ja2=function(l,c,d,h,p,f,m,y,_,b,w){$a2(c,w++,d),++p[256];for(var E=qa2(p,15),M=E[0],N=E[1],P=qa2(f,15),L=P[0],j=P[1],D=Ga2(M),F=D[0],U=D[1],B=Ga2(L),H=B[0],z=B[1],q=new ja(19),V=0;V<F.length;++V)q[31&F[V]]++;for(V=0;V<H.length;++V)q[31&H[V]]++;for(var Z=qa2(q,7),K=Z[0],Y=Z[1],ee=19;ee>4&&!K[Va[ee-1]];--ee);var ne,se,ie,oe,le=b+5<<3,ce=Ha2(p,tl)+Ha2(f,rl)+m,pe=Ha2(p,M)+Ha2(f,L)+m+14+3*ee+Ha2(q,K)+(2*q[16]+3*q[17]+7*q[18]);if(le<=ce&&le<=pe)return Va2(c,w,l.subarray(_,_+b));if($a2(c,w,1+(pe<ce)),w+=2,pe<ce){ne=La2(M,N),se=M,ie=La2(L,j),oe=L;var fe=La2(K,Y);for($a2(c,w,U-257),$a2(c,w+5,z-1),$a2(c,w+10,ee-4),w+=14,V=0;V<ee;++V)$a2(c,w+3*V,K[Va[V]]);w+=3*ee;for(var ge=[F,H],be=0;be<2;++be){var Oe=ge[be];for(V=0;V<Oe.length;++V){var Ne=31&Oe[V];$a2(c,w,fe[Ne]),w+=K[Ne],Ne>15&&($a2(c,w,Oe[V]>>>5&127),w+=Oe[V]>>>12)}}}else ne=nl,se=tl,ie=sl,oe=rl;for(V=0;V<y;++V)if(h[V]>255){Ne=h[V]>>>18&31,Wa2(c,w,ne[Ne+257]),w+=se[Ne+257],Ne>7&&($a2(c,w,h[V]>>>23&31),w+=Ha[Ne]);var De=31&h[V];Wa2(c,w,ie[De]),w+=oe[De],De>3&&(Wa2(c,w,h[V]>>>5&8191),w+=za[De])}else Wa2(c,w,ne[h[V]]),w+=se[h[V]];return Wa2(c,w,ne[256]),w+se[256]},il=new Da([65540,131080,131088,131104,262176,1048704,1048832,2114560,2117632]),ol=function(){for(var l=new Da(256),c=0;c<256;++c){for(var d=c,h=9;--h;)d=(1&d&&3988292384)^d>>>1;l[c]=d}return l}(),Qa2=function(l,c,d){for(;d;++c)l[c]=d,d>>>=8};class rh2{constructor(l,c){var d,h;void 0===c&&(c={}),this.A={},this.B=l=>{if(!this.A[l]){var c,d;this.A[l]=!0;var h=this.L(l);null==(c=(d=this.F).onBlockedNode)||c.call(d,l,h)}},this.N=l=>{var c=this.L(l);if("svg"!==(null==c?void 0:c.nodeName)&&c instanceof Element){var d=c.closest("svg");if(d)return[this._rrweb.mirror.getId(d),d]}return[l,c]},this.L=l=>this._rrweb.mirror.getNode(l),this.j=l=>{var c,d,h,p,f,m,y,_;return(null!==(c=null==(d=l.removes)?void 0:d.length)&&void 0!==c?c:0)+(null!==(h=null==(p=l.attributes)?void 0:p.length)&&void 0!==h?h:0)+(null!==(f=null==(m=l.texts)?void 0:m.length)&&void 0!==f?f:0)+(null!==(y=null==(_=l.adds)?void 0:_.length)&&void 0!==y?y:0)},this.throttleMutations=l=>{if(3!==l.type||0!==l.data.source)return l;var c=l.data,d=this.j(c);c.attributes&&(c.attributes=c.attributes.filter((l=>{var[c]=this.N(l.id);return!this.D.consumeRateLimit(c)&&l})));var h=this.j(c);return 0!==h||d===h?l:void 0},this._rrweb=l,this.F=c,this.D=new ro2({bucketSize:null!==(d=this.F.bucketSize)&&void 0!==d?d:100,refillRate:null!==(h=this.F.refillRate)&&void 0!==h?h:10,refillInterval:1e3,i:this.B,h:_o})}reset(){this.A={}}stop(){this.D.stop(),this.reset()}}var al="$sess_rec_flush_size";class sh2{constructor(l){if(!l.persistence)throw new Error("it is not valid to not have persistence and be this far into setting up the application");this.U=l.get_property.bind(l),this.P=l.persistence.set_property.bind(l.persistence)}trackSize(l){var c=(Number(this.U(al))||0)+l;this.P(al,c)}reset(){return this.P(al,0)}get currentTrackedSize(){return Number(this.U(al))||0}}var ll="[SessionRecording]",cl=bo(ll),ul=[ba.MouseMove,ba.MouseInteraction,ba.Scroll,ba.ViewportResize,ba.Input,ba.TouchMove,ba.MediaInteraction,ba.Drag],lh2=l=>({rrwebMethod:l,enqueuedAt:Date.now(),attempt:1});function ch2(){var l;return null==ho||null==(l=ho.__PosthogExtensions__)||null==(l=l.rrweb)?void 0:l.record}function fh2(l){return function(l){for(var c="",d=0;d<l.length;){var h=l[d++];c+=String.fromCharCode(h)}return c}(function(l,c){void 0===c&&(c={});var d=function(){var l=4294967295;return{p:function(c){for(var d=l,h=0;h<c.length;++h)d=ol[255&d^c[h]]^d>>>8;l=d},d:function(){return 4294967295^l}}}(),h=l.length;d.p(l);var p=function(l,c,d,h){return function(l,c,d,h,p){var f=l.length,m=new Na(h+f+5*(1+Math.floor(f/7e3))+p),y=m.subarray(h,m.length-p),_=0;if(!c||f<8)for(var b=0;b<=f;b+=65535){var w=b+65535;w<f?_=Va2(y,_,l.subarray(b,w)):(y[b]=!0,_=Va2(y,_,l.subarray(b,f)))}else{for(var E=il[c-1],M=E>>>13,N=8191&E,P=(1<<d)-1,L=new ja(32768),j=new ja(P+1),D=Math.ceil(d/3),F=2*D,b22=function(c){return(l[c]^l[c+1]<<D^l[c+2]<<F)&P},U=new Da(25e3),B=new ja(288),H=new ja(32),z=0,q=0,V=(b=0,0),Z=0,K=0;b<f;++b){var Y=b22(b),ee=32767&b,ne=j[Y];if(L[ee]=ne,j[Y]=ee,Z<=b){var se=f-b;if((z>7e3||V>24576)&&se>423){_=Ja2(l,y,0,U,B,H,q,V,K,b-K,_),V=z=q=0,K=b;for(var ie=0;ie<286;++ie)B[ie]=0;for(ie=0;ie<30;++ie)H[ie]=0}var oe=2,le=0,ce=N,pe=ee-ne&32767;if(se>2&&Y==b22(b-pe))for(var fe=Math.min(M,se)-1,ge=Math.min(32767,b),be=Math.min(258,se);pe<=ge&&--ce&&ee!=ne;){if(l[b+oe]==l[b+oe-pe]){for(var Oe=0;Oe<be&&l[b+Oe]==l[b+Oe-pe];++Oe);if(Oe>oe){if(oe=Oe,le=pe,Oe>fe)break;var Ne=Math.min(pe,Oe-2),De=0;for(ie=0;ie<Ne;++ie){var Fe=b-pe+ie+32768&32767,Ue=Fe-L[Fe]+32768&32767;Ue>De&&(De=Ue,ne=Fe)}}}pe+=(ee=ne)-(ne=L[ee])+32768&32767}if(le){U[V++]=268435456|Ja[oe]<<18|Ya[le];var Be=31&Ja[oe],He=31&Ya[le];q+=Ha[Be]+za[He],++B[257+Be],++H[He],Z=b+oe,++z}else U[V++]=l[b],++B[l[b]]}}_=Ja2(l,y,!0,U,B,H,q,V,K,b-K,_)}return Pa2(m,0,h+Ua2(_)+p)}(l,null==c.level?6:c.level,null==c.mem?Math.ceil(1.5*Math.max(8,Math.min(13,Math.log(l.length)))):12+c.mem,d,h)}(l,c,function(l){return 10+(l.filename&&l.filename.length+1||0)}(c),8),f=p.length;return function(l,c){var d=c.filename;if(l[0]=31,l[1]=139,l[2]=8,l[8]=c.level<2?4:9==c.level?2:0,l[9]=3,0!=c.mtime&&Qa2(l,4,Math.floor(new Date(c.mtime||Date.now())/1e3)),d){l[3]=8;for(var h=0;h<=d.length;++h)l[h+10]=d.charCodeAt(h)}}(p,c),Qa2(p,f-8,d.d()),Qa2(p,f-4,h),p}(function(l){var c=l.length;if("undefined"!=typeof TextEncoder)return(new TextEncoder).encode(l);for(var d=new Na(l.length+(l.length>>>1)),h=0,s22=function(l){d[h++]=l},p=0;p<c;++p){if(h+5>d.length){var f=new Na(h+8+(c-p<<1));f.set(d),d=f}var m=l.charCodeAt(p);m<128?s22(m):m<2048?(s22(192|m>>>6),s22(128|63&m)):m>55295&&m<57344?(s22(240|(m=65536+(1047552&m)|1023&l.charCodeAt(++p))>>>18),s22(128|m>>>12&63),s22(128|m>>>6&63),s22(128|63&m)):(s22(224|m>>>12),s22(128|m>>>6&63),s22(128|63&m))}return Pa2(d,0,h)}(JSON.stringify(l))))}function dh2(l,c){return l.type===ya.Custom&&l.data.tag===c}function vh2(l){return dh2(l,"sessionIdle")}function ph2(l){return dh2(l,"$session_ending")}function mh2(l){return dh2(l,"$session_starting")}function gh2(l,c){if(void 0===c&&(c=6606028.8),l.size>=c&&l.data.length>1){var d=Math.floor(l.data.length/2),h=l.data.slice(0,d),p=l.data.slice(d);return[gh2({size:ya2(h),data:h,sessionId:l.sessionId,windowId:l.windowId}),gh2({size:ya2(p),data:p,sessionId:l.sessionId,windowId:l.windowId})].flatMap((l=>l))}return[l]}class wh2{get sessionId(){return this.$}get W(){if(!this._instance.sessionManager)throw new Error(ll+" must be started with a valid sessionManager.");return this._instance.sessionManager}get q(){return this._instance.config.session_recording.session_idle_threshold_ms||3e5}get G(){var l=this._instance.get_property(jo);return Qs2(l)?l:Ys2(l)?l===this.sessionId:null}get H(){var l,c=null==(l=this.V)?void 0:l.sampleRate;return Zs2(c)?c:null}get J(){var l,c=null==(l=this.V)?void 0:l.minimumDurationMilliseconds;return Zs2(c)?c:null}constructor(l){this.Y="/s/",this._forceAllowLocalhostNetworkCapture=!1,this.X=void 0,this.K=Date.now(),this.Z=[],this.tt="unknown",this.et=new ca2,this.rt=void 0,this.it=void 0,this.nt=ma2,this.st=void 0,this.ot=void 0,this.ht=void 0,this.ut=void 0,this.lt=(l,c,d)=>{if(d){var h,p,f,m=!d.noSessionId&&(d.activityTimeout||d.sessionPastMaximumLength);m&&(h=this.$,p=this.ct,this.ft("$session_ending",{nextSessionId:l,nextWindowId:c,changeReason:d,lastActivityTimestamp:this.K,flushed_size:null==(f=this.dt)?void 0:f.currentTrackedSize})),this.dt&&this.dt.reset(),this.ft("$session_id_change",{sessionId:l,windowId:c,changeReason:d}),this.vt(),this.X||this.start("session_id_changed"),m&&this.ft("$session_starting",{previousSessionId:h,previousWindowId:p,changeReason:d,lastActivityTimestamp:this.K}),Zs2(this.H)&&Ks2(this.ht)&&this.gt(l)}},this.wt=()=>{var l;return(null==(l=this._instance.persistence)?void 0:l.props[zo])===this.$},this.yt=()=>{var l,c;if(0===this.bt.data.length)return null;var d=null==(l=this.bt.data[0])?void 0:l.timestamp,h=null==(c=this.bt.data[this.bt.data.length-1])?void 0:c.timestamp;return Zs2(d)&&Zs2(h)?h-d:null},this.St=()=>{var l,c,d=this.J;if(!Zs2(d))return!1;if(null===(l=null==(c=this._instance.config.session_recording)?void 0:c.strictMinimumDuration)||void 0===l||!l){var h=this.kt;return Zs2(h)&&h>=0&&h<d}if(this.wt())return!1;var p,f=this.yt();return!(!Xs2(f)&&f>=d&&(null==(p=this._instance.persistence)||p.register({[zo]:this.$}),1))},this.Ct=()=>{this.It()},this.Mt=()=>{this.ft("browser offline",{})},this.Rt=()=>{this.ft("browser online",{})},this.xt=()=>{if(null!=co&&co.visibilityState){var l="window "+co.visibilityState;this.ft(l,{})}},this._instance=l;var{sessionId:c,windowId:d}=this.W.checkAndGetSessionAndWindowId();this.$=c,this.ct=d,this._t=new va2(this._instance),this.Ot=new da2(this._instance),this.Tt=new pa2(this._instance),this.bt=this.Et(),this.q>=this.W.sessionTimeoutMs&&cl.warn("session_idle_threshold_ms ("+this.q+") is greater than the session timeout ("+this.W.sessionTimeoutMs+"). Session will never be detected as idle"),this.dt=new sh2(this._instance)}get At(){var l,c,d,h,p,f,m,y=null==(l=this.V)?void 0:l.masking,_={maskAllInputs:null==(c=this._instance.config.session_recording)?void 0:c.maskAllInputs,maskTextSelector:null==(d=this._instance.config.session_recording)?void 0:d.maskTextSelector,blockSelector:null==(h=this._instance.config.session_recording)?void 0:h.blockSelector},b=null!==(p=null==_?void 0:_.maskAllInputs)&&void 0!==p?p:null==y?void 0:y.maskAllInputs,w=null!==(f=null==_?void 0:_.maskTextSelector)&&void 0!==f?f:null==y?void 0:y.maskTextSelector,E=null!==(m=null==_?void 0:_.blockSelector)&&void 0!==m?m:null==y?void 0:y.blockSelector;return Js2(b)&&Js2(w)&&Js2(E)?void 0:{maskAllInputs:null==b||b,maskTextSelector:w,blockSelector:E}}get Bt(){var l,c,d,h,p,f,m,y=this._instance.config.session_recording.captureCanvas,_=null==(l=this.V)?void 0:l.canvasRecording,b=null!==(c=null!==(d=null==y?void 0:y.recordCanvas)&&void 0!==d?d:null==_?void 0:_.enabled)&&void 0!==c&&c,w=null!==(h=null!==(p=null==y?void 0:y.canvasFps)&&void 0!==p?p:null==_?void 0:_.fps)&&void 0!==h?h:4,E=null!==(f=null!==(m=null==y?void 0:y.canvasQuality)&&void 0!==m?m:null==_?void 0:_.quality)&&void 0!==f?f:.4;if("string"==typeof E){var M=parseFloat(E);E=isNaN(M)?.4:M}return{enabled:b,fps:eo2(w,0,12,bo("canvas recording fps"),4),quality:eo2(E,0,1,bo("canvas recording quality"),.4)}}get Lt(){var l,c=!(null==(l=this.V)||!l.consoleLogRecordingEnabled),d=this._instance.config.enable_recording_console_log;return null!=d?d:c}get Ft(){var l,c,d,h=null==(l=this.V)?void 0:l.networkPayloadCapture,p={recordHeaders:null==(c=this._instance.config.session_recording)?void 0:c.recordHeaders,recordBody:null==(d=this._instance.config.session_recording)?void 0:d.recordBody},f=(null==p?void 0:p.recordHeaders)||(null==h?void 0:h.recordHeaders),m=(null==p?void 0:p.recordBody)||(null==h?void 0:h.recordBody),y=Vs2(this._instance.config.capture_performance)?this._instance.config.capture_performance.network_timing:this._instance.config.capture_performance,_=!!(Qs2(y)?y:null==h?void 0:h.capturePerformance);return f||m||_?{recordHeaders:f,recordBody:m,recordPerformance:_}:void 0}Nt(){var l,c,d=[],h=null==(l=ho.__PosthogExtensions__)||null==(l=l.rrwebPlugins)?void 0:l.getRecordConsolePlugin;h&&this.Lt&&d.push(h());var p=null==(c=ho.__PosthogExtensions__)||null==(c=c.rrwebPlugins)?void 0:c.getRecordNetworkPlugin;return this.Ft&&Hs2(p)&&(!So.includes(location.hostname)||this._forceAllowLocalhostNetworkCapture?d.push(p(((l,c)=>{var d,h,p,f={payloadSizeLimitBytes:ea.payloadSizeLimitBytes,performanceEntryTypeToObserve:[...ea.performanceEntryTypeToObserve],payloadHostDenyList:[...c.payloadHostDenyList||[],...ea.payloadHostDenyList]},m=!1!==l.session_recording.recordHeaders&&c.recordHeaders,y=!1!==l.session_recording.recordBody&&c.recordBody,_=!1!==l.capture_performance&&c.recordPerformance,b=(d=f,p=Math.min(1e6,null!==(h=d.payloadSizeLimitBytes)&&void 0!==h?h:1e6),l=>(null!=l&&l.requestBody&&(l.requestBody=Oo2(l.requestBody,l.requestHeaders,p,"Request")),null!=l&&l.responseBody&&(l.responseBody=Oo2(l.responseBody,l.responseHeaders,p,"Response")),l)),c22=c=>{return b(((l,c)=>{var d,h=fo2(l.name),p=0===c.indexOf("http")?null==(d=fo2(c))?void 0:d.pathname:c;"/"===p&&(p="");var f=null==h?void 0:h.pathname.replace(p||"","");if(!(h&&f&&na.some((l=>0===f.indexOf(l)))))return l})((h=(d=c).requestHeaders,Ks2(h)||uo2(Object.keys(null!=h?h:{}),(l=>{ta.includes(l.toLowerCase())&&(h[l]=Xo)})),d),l.api_host));var d,h},w=Hs2(l.session_recording.maskNetworkRequestFn);return w&&Hs2(l.session_recording.maskCapturedNetworkRequestFn)&&_o.warn("Both `maskNetworkRequestFn` and `maskCapturedNetworkRequestFn` are defined. `maskNetworkRequestFn` will be ignored."),w&&(l.session_recording.maskCapturedNetworkRequestFn=c=>{var d=l.session_recording.maskNetworkRequestFn({url:c.name});return r2({},c,{name:null==d?void 0:d.url})}),f.maskRequestFn=Hs2(l.session_recording.maskCapturedNetworkRequestFn)?c=>{var d,h=c22(c);return h&&null!==(d=null==l.session_recording.maskCapturedNetworkRequestFn?void 0:l.session_recording.maskCapturedNetworkRequestFn(h))&&void 0!==d?d:void 0}:l=>function(l){if(!Js2(l))return l.requestBody=To2(l.requestBody,"Request"),l.responseBody=To2(l.responseBody,"Response"),l}(c22(l)),r2({},ea,f,{recordHeaders:m,recordBody:y,recordPerformance:_,recordInitialRequests:_})})(this._instance.config,this.Ft))):cl.info("NetworkCapture not started because we are on localhost.")),d}jt(l){var c=this._instance.config.session_recording;if(c.maskNetworkRequestFn){var d,h={url:l};return null==(d=h=c.maskNetworkRequestFn(h))?void 0:d.url}return l}Dt(l){try{return l.rrwebMethod(),!0}catch(c){return this.Z.length<10?this.Z.push({enqueuedAt:l.enqueuedAt||Date.now(),attempt:l.attempt+1,rrwebMethod:l.rrwebMethod}):cl.warn("could not emit queued rrweb event.",c,l),!1}}ft(l,c){return this.Dt(lh2((()=>ch2().addCustomEvent(l,c))))}Ut(){try{if(this._instance.config.capture_pageview||!Xi)return;var l=new URL(Xi.location.href),c=l.origin+l.pathname+l.search,d=this.jt(c);this.Pt!==d&&(this.Pt=d,this.ft("$url_changed",{href:d}))}catch(h){}}$t(){if(this.Z.length){var l=[...this.Z];this.Z=[],l.forEach((l=>{Date.now()-l.enqueuedAt<=2e3&&this.Dt(l)}))}}Wt(){return this.Dt(lh2((()=>ch2().takeFullSnapshot())))}get qt(){var l,c;return this.et.triggerStatus(this.sessionId)!==Aa||["sampled","active"].includes(this.status)?null!==(l=null==(c=this._instance.config.session_recording)?void 0:c.full_snapshot_interval_millis)&&void 0!==l?l:3e5:6e4}zt(){if(this.Gt&&clearInterval(this.Gt),!0!==this.tt){var l=this.qt;l&&(this.Gt=setInterval((()=>{this.Wt()}),l))}}Ht(){this.Ot.urlBlocked||(this.Ot.urlBlocked=!0,clearInterval(this.Gt),cl.info("recording paused due to URL blocker"),this.ft("recording paused",{reason:"url blocker"}))}Vt(){this.Ot.urlBlocked&&(this.Ot.urlBlocked=!1,this.Wt(),this.zt(),this.ft("recording resumed",{reason:"left blocked url"}),cl.info("recording resumed"))}Jt(l){var c;this.et.triggerStatus(this.sessionId)===Aa&&(null==(c=this._instance)||null==(c=c.persistence)||c.register({["url"===l?Go:Ko]:this.$}),this.It(),this.Yt(l+"_trigger_matched"))}get isStarted(){return!!this.X}get V(){var l=this._instance.get_property("$session_recording_remote_config");if(l)return Vs2(l)?l:JSON.parse(l)}Xt(l,c){var d;this._instance.get_property(l)&&(c(),null==(d=this._instance.persistence)||d.unregister(l))}start(l){var c,d=this.V;if(d){var{sessionId:h,windowId:p}=this.W.checkAndGetSessionAndWindowId();this.$=h,this.ct=p,null!=d&&d.endpoint&&(this.Y=null==d?void 0:d.endpoint),"any"===(null==d?void 0:d.triggerMatchType)?(this.nt=ga2,this.et=new ua2([this.Tt,this.Ot])):(this.nt=wa2,this.et=new la2([this.Tt,this.Ot])),this._instance.register_for_session({$sdk_debug_replay_remote_trigger_matching_config:null==d?void 0:d.triggerMatchType}),this.Ot.onConfig(d),this.Tt.onConfig(d),null==(c=this.it)||c.call(this),this.Kt(),this._t.onConfig(d,((l,c)=>{this.Yt("linked_flag_matched",{flag:l,variant:c})})),this.Xt("$replay_override_sampling",(()=>{this.overrideSampling()})),this.Xt("$replay_override_linked_flag",(()=>{this.overrideLinkedFlag()})),this.Xt("$replay_override_event_trigger",(()=>{this.overrideTrigger("event")})),this.Xt("$replay_override_url_trigger",(()=>{this.overrideTrigger("url")})),this.gt(this.sessionId),this.Zt(),lo2(Xi,"beforeunload",this.Ct),lo2(Xi,"offline",this.Mt),lo2(Xi,"online",this.Rt),lo2(Xi,"visibilitychange",this.xt),this.st||(this.st=this.W.onSessionId(this.lt)),this.ot||(this.ot=this.W.on("forcedIdleReset",(()=>{this.vt(),this.tt="unknown",this.stop(),this.ut=this.W.onSessionId(((l,c,d)=>{var h;null==(h=this.ut)||h.call(this),this.ut=void 0,this.lt(l,c,d)}))}))),Ks2(this.rt)&&(this.rt=this._instance.on("eventCaptured",(l=>{try{if("$pageview"===l.event){var c=null!=l&&l.properties.$current_url?this.jt(null==l?void 0:l.properties.$current_url):"";if(!c)return;this.ft("$pageview",{href:c})}}catch(d){cl.error("Could not add $pageview to rrweb session",d)}}))),this.status===xa&&this.Yt(l||"recording_initialized")}else cl.info("remote config must be stored in persistence before recording can start")}stop(){var l,c,d,h,p,f,m,y;null==Xi||Xi.removeEventListener("beforeunload",this.Ct),null==Xi||Xi.removeEventListener("offline",this.Mt),null==Xi||Xi.removeEventListener("online",this.Rt),null==Xi||Xi.removeEventListener("visibilitychange",this.xt),this.It(),this.Et(),clearInterval(this.Gt),this.Qt(),null==(l=this.rt)||l.call(this),this.rt=void 0,null==(c=this.it)||c.call(this),this.it=void 0,null==(d=this.st)||d.call(this),this.st=void 0,null==(h=this.ot)||h.call(this),this.ot=void 0,null==(p=this.ht)||p.call(this),this.ht=void 0,null==(f=this.ut)||f.call(this),this.ut=void 0,this.Tt.stop(),this.Ot.stop(),this._t.stop(),null==(m=this.te)||m.stop(),this.Z=[],null==(y=this.X)||y.call(this),this.X=void 0,cl.info("stopped")}onRRwebEmit(l){var c,d;if(this.$t(),l&&Vs2(l)){if(l.type===ya.Meta){var h=this.jt(l.data.href);if(this.Pt=h,!h)return;l.data.href=h}else this.Ut();if(this.Ot.checkUrlTriggerConditions((()=>this.Ht()),(()=>this.Vt()),(l=>this.Jt(l))),!this.Ot.urlBlocked||(p=l).type===ya.Custom&&"recording paused"===p.data.tag){var p,f;l.type===ya.FullSnapshot&&(this.zt(),null==(f=this.te)||f.reset()),l.type===ya.FullSnapshot&&this.et.triggerStatus(this.sessionId)===Aa&&this.ee();var m=this.te?this.te.throttleMutations(l):l;if(m){var y=function(l){var c=l;if(c&&Vs2(c)&&6===c.type&&Vs2(c.data)&&"rrweb/console@1"===c.data.plugin){c.data.payload.payload.length>10&&(c.data.payload.payload=c.data.payload.payload.slice(0,10),c.data.payload.payload.push("...[truncated]"));for(var d=[],h=0;h<c.data.payload.payload.length;h++)c.data.payload.payload[h]&&c.data.payload.payload[h].length>2e3?d.push(c.data.payload.payload[h].slice(0,2e3)+"...[truncated]"):d.push(c.data.payload.payload[h]);return c.data.payload.payload=d,l}return l}(m);if(this.re(y),!0!==this.tt||(vh2(d=y)||ph2(d)||mh2(d))){if(vh2(y)){var _=y.data.payload;if(_){var b=_.lastActivityTimestamp,w=_.threshold;y.timestamp=b+w}}if(ph2(y)||mh2(y)){var E=y.data.payload;null!=E&&E.lastActivityTimestamp&&(y.timestamp=E.lastActivityTimestamp)}var M=null===(c=this._instance.config.session_recording.compress_events)||void 0===c||c?function(l){try{if(l.type===ya.FullSnapshot)return r2({},l,{data:fh2(l.data),cv:"2024-10"});if(l.type===ya.IncrementalSnapshot&&l.data.source===ba.Mutation)return r2({},l,{cv:"2024-10",data:r2({},l.data,{texts:fh2(l.data.texts),attributes:fh2(l.data.attributes),removes:fh2(l.data.removes),adds:fh2(l.data.adds)})});if(l.type===ya.IncrementalSnapshot&&l.data.source===ba.StyleSheetRule)return r2({},l,{cv:"2024-10",data:r2({},l.data,{adds:l.data.adds?fh2(l.data.adds):void 0,removes:l.data.removes?fh2(l.data.removes):void 0})})}catch(c){cl.error("could not compress event - will use uncompressed event",c)}return l}(y):y,N={$snapshot_bytes:ya2(M),$snapshot_data:M,$session_id:this.$,$window_id:this.ct};this.status!==wa?this.ie(N):this.Et()}}}}}get status(){return this.nt({receivedFlags:!0,isRecordingEnabled:!0,isSampled:this.G,urlTriggerMatching:this.Ot,eventTriggerMatching:this.Tt,linkedFlagMatching:this._t,sessionId:this.sessionId})}log(l,c){var d;void 0===c&&(c="log"),null==(d=this._instance.sessionRecording)||d.onRRwebEmit({type:6,data:{plugin:"rrweb/console@1",payload:{level:c,trace:[],payload:[JSON.stringify(l)]}},timestamp:Date.now()})}overrideLinkedFlag(){this._t.linkedFlagSeen=!0,this.Wt(),this.Yt("linked_flag_overridden")}overrideSampling(){var l;null==(l=this._instance.persistence)||l.register({[jo]:this.sessionId}),this.Wt(),this.Yt("sampling_overridden")}overrideTrigger(l){this.Jt(l)}Qt(){this.ne&&(clearTimeout(this.ne),this.ne=void 0)}It(){this.Qt();var l=this.St();return this.status===ka||this.status===Ca||this.status===wa||l?(this.ne=setTimeout((()=>{this.It()}),2e3),this.bt):(this.bt.data.length>0&&gh2(this.bt).forEach((l=>{var c;null==(c=this.dt)||c.trackSize(l.size),this.se({$snapshot_bytes:l.size,$snapshot_data:l.data,$session_id:l.sessionId,$window_id:l.windowId,$lib:"web",$lib_version:yo})})),this.Et())}ie(l){var c,d=2+((null==(c=this.bt)?void 0:c.data.length)||0);!this.tt&&(this.bt.size+l.$snapshot_bytes+d>943718.4||this.bt.sessionId!==this.$)&&(this.bt=this.It()),this.bt.size+=l.$snapshot_bytes,this.bt.data.push(l.$snapshot_data),this.ne||this.tt||(this.ne=setTimeout((()=>{this.It()}),2e3))}se(l){this._instance.capture("$snapshot",l,{_url:this._instance.requestRouter.endpointFor("api",this.Y),_noTruncate:!0,_batchKey:"recordings",skip_client_rate_limiting:!0})}get kt(){var l,c,d=null==(l=this.bt)?void 0:l.data[(null==(c=this.bt)?void 0:c.data.length)-1],{sessionStartTimestamp:h}=this.W.checkAndGetSessionAndWindowId(!0);return d?d.timestamp-h:null}ee(){if(!this.bt||0===this.bt.data.length)return this.Et();for(var l=-1,c=this.bt.data.length-1;c>=0;c--)if(this.bt.data[c].type===ya.Meta){l=c;break}return l>=0?(this.bt.data=this.bt.data.slice(l),this.bt.size=this.bt.data.reduce(((l,c)=>l+ya2(c)),0),this.bt):this.Et()}Et(){return this.bt={size:0,data:[],sessionId:this.$,windowId:this.ct},this.bt}Yt(l,c){this._instance.register_for_session({$session_recording_start_reason:l}),cl.info(l.replace("_"," "),c),-1===["recording_initialized","session_id_changed"].indexOf(l)&&this.ft(l,c)}oe(l){var c;return 3===l.type&&-1!==ul.indexOf(null==(c=l.data)?void 0:c.source)}re(l){var c=this.oe(l);c||this.tt||l.timestamp-this.K>this.q&&(this.tt=!0,clearInterval(this.Gt),this.ft("sessionIdle",{eventTimestamp:l.timestamp,lastActivityTimestamp:this.K,threshold:this.q,bufferLength:this.bt.data.length,bufferSize:this.bt.size}),this.It());var d=!1;if(c&&(this.K=l.timestamp,this.tt)){var h="unknown"===this.tt;this.tt=!1,h||(this.ft("sessionNoLongerIdle",{reason:"user activity",type:l.type}),d=!0)}if(!this.tt){var{windowId:p,sessionId:f}=this.W.checkAndGetSessionAndWindowId(!c,l.timestamp),m=this.$!==f,y=this.ct!==p;this.ct=p,this.$=f,m||y?(this.stop(),this.start("session_id_changed")):d&&this.zt()}}vt(){var l,c,d,h;null==(l=this._instance)||null==(l=l.persistence)||l.unregister(Ko),null==(c=this._instance)||null==(c=c.persistence)||c.unregister(Go),null==(d=this._instance)||null==(d=d.persistence)||d.unregister(jo),null==(h=this._instance)||null==(h=h.persistence)||h.unregister(zo)}gt(l){var c,d=this.$!==l,h=this.H;if(Zs2(h)){var p=this.G,f=d||!Qs2(p),m=f?function(l,c){return function(l){for(var c=0,d=0;d<l.length;d++)c=(c<<5)-c+l.charCodeAt(d),c|=0;return Math.abs(c)}(l)%100<eo2(100*c,0,100,_o)}(l,h):p;f&&(m?this.Yt(Sa):cl.warn("Sample rate ("+h+") has determined that this sessionId ("+l+") will not be sent to the server."),this.ft("samplingDecisionMade",{sampleRate:h,isSampled:m})),null==(c=this._instance.persistence)||c.register({[jo]:!!m&&l})}else{var y;null==(y=this._instance.persistence)||y.unregister(jo)}}Kt(){0!==this.Tt.O.length&&Ks2(this.it)&&(this.it=this._instance.on("eventCaptured",(l=>{try{this.Tt.O.includes(l.event)&&this.Jt("event")}catch(c){cl.error("Could not activate event trigger",c)}})))}get sdkDebugProperties(){var l,{sessionStartTimestamp:c}=this.W.checkAndGetSessionAndWindowId(!0);return{$recording_status:this.status,$sdk_debug_replay_internal_buffer_length:this.bt.data.length,$sdk_debug_replay_internal_buffer_size:this.bt.size,$sdk_debug_current_session_duration:this.kt,$sdk_debug_session_start:c,$sdk_debug_replay_flushed_size:null==(l=this.dt)?void 0:l.currentTrackedSize}}Zt(){var l;if(!this.X){var c,d,h,p={blockClass:"ph-no-capture",blockSelector:void 0,ignoreClass:"ph-ignore-input",maskTextClass:"ph-mask",maskTextSelector:void 0,maskTextFn:void 0,maskAllInputs:!0,maskInputOptions:{password:!0},maskInputFn:void 0,slimDOMOptions:{},collectFonts:!1,inlineStylesheet:!0,recordCrossOriginIframes:!1},f=this._instance.config.session_recording;for(var[m,y]of Object.entries(f||{}))m in p&&("maskInputOptions"===m?p.maskInputOptions=r2({password:!0},y):p[m]=y);this.Bt&&this.Bt.enabled&&(p.recordCanvas=!0,p.sampling={canvas:this.Bt.fps},p.dataURLOptions={type:"image/webp",quality:this.Bt.quality}),this.At&&(p.maskAllInputs=null===(c=this.At.maskAllInputs)||void 0===c||c,p.maskTextSelector=null!==(d=this.At.maskTextSelector)&&void 0!==d?d:void 0,p.blockSelector=null!==(h=this.At.blockSelector)&&void 0!==h?h:void 0);var _=ch2();if(_){this.te=null!==(l=this.te)&&void 0!==l?l:new rh2(_,{refillRate:this._instance.config.session_recording.__mutationThrottlerRefillRate,bucketSize:this._instance.config.session_recording.__mutationThrottlerBucketSize,onBlockedNode:(l,c)=>{var d="Too many mutations on node '"+l+"'. Rate limiting. This could be due to SVG animations or something similar";cl.info(d,{node:c}),this.log(ll+" "+d,"warn")}});var b=this.Nt();this.X=_(r2({emit:l=>{this.onRRwebEmit(l)},plugins:b},p)),this.K=Date.now(),this.tt=Qs2(this.tt)?this.tt:"unknown",this.tryAddCustomEvent("$remote_config_received",this.V),this.ft("$session_options",{sessionRecordingOptions:p,activePlugins:b.map((l=>null==l?void 0:l.name))}),this.ft("$posthog_config",{config:this._instance.config})}else cl.error("_startRecorder was called but rrwebRecord is not available. This indicates something has gone wrong.")}}tryAddCustomEvent(l,c){return this.ft(l,c)}}ho.__PosthogExtensions__=ho.__PosthogExtensions__||{},ho.__PosthogExtensions__.rrwebPlugins={getRecordConsolePlugin:Bs2,getRecordNetworkPlugin:Xo2},ho.__PosthogExtensions__.rrweb={record:ms2,version:"v2"},ho.__PosthogExtensions__.initSessionRecording=l=>new wh2(l),ho.rrweb={record:ms2,version:"v2"},ho.rrwebConsoleRecord={getRecordConsolePlugin:Bs2},ho.getRecordNetworkPlugin=Xo2}();const Ob="telemetry_session_id";let Mb=null;function generateUUID(){return"undefined"!=typeof crypto&&"randomUUID"in crypto?crypto.randomUUID():`${Date.now().toString(16)}-${Math.random().toString(16).slice(2,10)}-${Math.random().toString(16).slice(2,10)}`}async function getSessionId(){if(Mb)return Mb;const l=await async function(){try{return(await er.storage.local.get([Ob]))[Ob]??null}catch(l){return console.warn("[Telemetry] Failed to read distinct id:",l),null}}();if(l)return Mb=l,l;const c=generateUUID();return Mb=c,await async function(l){try{await er.storage.local.set({[Ob]:l})}catch(c){console.warn("[Telemetry] Failed to persist distinct id:",c)}}(c),c}function getSessionIdSync(){return Mb||(Mb=generateUUID(),getSessionId().catch(console.error),Mb)}const Nb=class _ConfirmitPostHogManager{constructor(){__publicField(this,"isInitialized",!1)}static getInstance(){return _ConfirmitPostHogManager.instance||(_ConfirmitPostHogManager.instance=new _ConfirmitPostHogManager),_ConfirmitPostHogManager.instance}initialize(l){if(!this.isInitialized)try{const c=getSessionIdSync();Rb.init("phc_9EXhTA8aIYO7hvqRzboyf5IqPUhi26NrFy93lzPbfFV",{api_host:l.apiHost,persistence:l.persistence||"localStorage",autocapture:l.autocapture??!0,disable_session_recording:l.disable_session_recording??!0,capture_pageview:l.capture_pageview??!1,disable_cookie:!0,disable_external_dependency_loading:!0,bootstrap:{distinctID:c},loaded:()=>{console.log("[PostHog] PostHog initialized successfully"),l.debug&&console.log("[PostHog] Debug mode enabled")}}),this.isInitialized=!0}catch(c){console.error("[PostHog] Failed to initialize PostHog:",c)}}track(l,c){if(this.isInitialized)try{Rb.capture(l,{...c,timestamp:(new Date).toISOString(),extension_version:chrome?.runtime?.getManifest?.()?.version||"unknown"})}catch(d){console.error("[PostHog] Failed to track event:",d)}}identify(l,c){if(this.isInitialized)try{Rb.identify(l,c)}catch(d){console.error("[PostHog] Failed to identify user:",d)}}identifyWithContext(l,c,d){if(this.isInitialized)try{const h={...d,surveyId:c,timestamp:(new Date).toISOString()};Rb.identify(l,h),console.log("[PostHog] User identified with context:",l,c)}catch(h){console.error("[PostHog] Failed to identify user with context:",h)}}shutdown(){if(this.isInitialized)try{console.log("[PostHog] Shutting down PostHog tracking"),Rb.reset(),this.isInitialized=!1,console.log("[PostHog] PostHog shut down successfully")}catch(l){console.error("[PostHog] Error during shutdown:",l)}else console.log("[PostHog] Not initialized, skipping shutdown")}reset(){this.isInitialized&&Rb.reset()}};__publicField(Nb,"instance");const Pb=Nb.getInstance(),Lb=Object.prototype.toString;function isError(l){switch(Lb.call(l)){case"[object Error]":case"[object Exception]":case"[object DOMException]":return!0;default:return isInstanceOf(l,Error)}}function isBuiltin(l,c){return Lb.call(l)===`[object ${c}]`}function isErrorEvent$2(l){return isBuiltin(l,"ErrorEvent")}function isDOMError(l){return isBuiltin(l,"DOMError")}function isString$1(l){return isBuiltin(l,"String")}function isParameterizedString(l){return"object"==typeof l&&null!==l&&"__sentry_template_string__"in l&&"__sentry_template_values__"in l}function isPrimitive$1(l){return null===l||isParameterizedString(l)||"object"!=typeof l&&"function"!=typeof l}function isPlainObject$3(l){return isBuiltin(l,"Object")}function isEvent(l){return"undefined"!=typeof Event&&isInstanceOf(l,Event)}function isThenable(l){return Boolean(l&&l.then&&"function"==typeof l.then)}function isNaN$1(l){return"number"==typeof l&&l!=l}function isInstanceOf(l,c){try{return l instanceof c}catch(d){return!1}}function isVueViewModel(l){return!("object"!=typeof l||null===l||!l.__isVue&&!l._isVue)}function truncate(l,c=0){return"string"!=typeof l||0===c||l.length<=c?l:`${l.slice(0,c)}...`}function safeJoin(l,c){if(!Array.isArray(l))return"";const d=[];for(let h=0;h<l.length;h++){const c=l[h];try{isVueViewModel(c)?d.push("[VueViewModel]"):d.push(String(c))}catch(hh){d.push("[value cannot be serialized]")}}return d.join(c)}function isMatchingPattern(l,c,d=!1){return!!isString$1(l)&&(isBuiltin(c,"RegExp")?c.test(l):!!isString$1(c)&&(d?l===c:l.includes(c)))}function stringMatchesSomePattern(l,c=[],d=!1){return c.some((c=>isMatchingPattern(l,c,d)))}function applyAggregateErrorsToEvent(l,c,d=250,h,p,f,m){if(!(f.exception&&f.exception.values&&m&&isInstanceOf(m.originalException,Error)))return;const y=f.exception.values.length>0?f.exception.values[f.exception.values.length-1]:void 0;var _,b;y&&(f.exception.values=(_=aggregateExceptionsFromError(l,c,p,m.originalException,h,f.exception.values,y,0),b=d,_.map((l=>(l.value&&(l.value=truncate(l.value,b)),l)))))}function aggregateExceptionsFromError(l,c,d,h,p,f,m,y){if(f.length>=d+1)return f;let _=[...f];if(isInstanceOf(h[p],Error)){applyExceptionGroupFieldsForParentException(m,y);const f=l(c,h[p]),b=_.length;applyExceptionGroupFieldsForChildException(f,p,b,y),_=aggregateExceptionsFromError(l,c,d,h[p],p,[f,..._],f,b)}return Array.isArray(h.errors)&&h.errors.forEach(((h,f)=>{if(isInstanceOf(h,Error)){applyExceptionGroupFieldsForParentException(m,y);const b=l(c,h),w=_.length;applyExceptionGroupFieldsForChildException(b,`errors[${f}]`,w,y),_=aggregateExceptionsFromError(l,c,d,h,p,[b,..._],b,w)}})),_}function applyExceptionGroupFieldsForParentException(l,c){l.mechanism=l.mechanism||{type:"generic",handled:!0},l.mechanism={...l.mechanism,..."AggregateError"===l.type&&{is_exception_group:!0},exception_id:c}}function applyExceptionGroupFieldsForChildException(l,c,d,h){l.mechanism=l.mechanism||{type:"generic",handled:!0},l.mechanism={...l.mechanism,type:"chained",source:c,exception_id:d,parent_id:h}}function isGlobalObj(l){return l&&l.Math==Math?l:void 0}const jb="object"==typeof globalThis&&isGlobalObj(globalThis)||"object"==typeof window&&isGlobalObj(window)||"object"==typeof self&&isGlobalObj(self)||"object"==typeof global&&isGlobalObj(global)||function(){return this}()||{};function getGlobalObject(){return jb}function getGlobalSingleton(l,c,d){const h=d||jb,p=h.__SENTRY__=h.__SENTRY__||{};return p[l]||(p[l]=c())}const Db=getGlobalObject();function htmlTreeAsString(l,c={}){if(!l)return"<unknown>";try{let d=l;const h=5,p=[];let f=0,m=0;const y=" > ",_=y.length;let b;const w=Array.isArray(c)?c:c.keyAttrs,E=!Array.isArray(c)&&c.maxStringLength||80;for(;d&&f++<h&&(b=_htmlElementAsString(d,w),!("html"===b||f>1&&m+p.length*_+b.length>=E));)p.push(b),m+=b.length,d=d.parentNode;return p.reverse().join(y)}catch(d){return"<unknown>"}}function _htmlElementAsString(l,c){const d=l,h=[];let p,f,m,y,_;if(!d||!d.tagName)return"";if(Db.HTMLElement&&d instanceof HTMLElement&&d.dataset&&d.dataset.sentryComponent)return d.dataset.sentryComponent;h.push(d.tagName.toLowerCase());const b=c&&c.length?c.filter((l=>d.getAttribute(l))).map((l=>[l,d.getAttribute(l)])):null;if(b&&b.length)b.forEach((l=>{h.push(`[${l[0]}="${l[1]}"]`)}));else if(d.id&&h.push(`#${d.id}`),p=d.className,p&&isString$1(p))for(f=p.split(/\s+/),_=0;_<f.length;_++)h.push(`.${f[_]}`);const w=["aria-label","type","name","title","alt"];for(_=0;_<w.length;_++)m=w[_],y=d.getAttribute(m),y&&h.push(`[${m}="${y}"]`);return h.join("")}function getComponentName(l){if(!Db.HTMLElement)return null;let c=l;for(let d=0;d<5;d++){if(!c)return null;if(c instanceof HTMLElement&&c.dataset.sentryComponent)return c.dataset.sentryComponent;c=c.parentNode}return null}const Fb="undefined"==typeof __SENTRY_DEBUG__||__SENTRY_DEBUG__,$b=["debug","info","warn","error","log","assert","trace"],Ub={};function consoleSandbox(l){if(!("console"in jb))return l();const c=jb.console,d={},h=Object.keys(Ub);h.forEach((l=>{const h=Ub[l];d[l]=c[l],c[l]=h}));try{return l()}finally{h.forEach((l=>{c[l]=d[l]}))}}const Bb=function(){let l=!1;const c={enable:()=>{l=!0},disable:()=>{l=!1},isEnabled:()=>l};return Fb?$b.forEach((d=>{c[d]=(...c)=>{l&&consoleSandbox((()=>{jb.console[d](`Sentry Logger [${d}]:`,...c)}))}})):$b.forEach((l=>{c[l]=()=>{}})),c}(),Hb=/^(?:(\w+):)\/\/(?:(\w+)(?::(\w+)?)?@)([\w.-]+)(?::(\d+))?\/(.+)/;function dsnToString(l,c=!1){const{host:d,path:h,pass:p,port:f,projectId:m,protocol:y,publicKey:_}=l;return`${y}://${_}${c&&p?`:${p}`:""}@${d}${f?`:${f}`:""}/${h?`${h}/`:h}${m}`}function dsnFromComponents(l){return{protocol:l.protocol,publicKey:l.publicKey||"",pass:l.pass||"",host:l.host,port:l.port||"",path:l.path||"",projectId:l.projectId}}function makeDsn(l){const c="string"==typeof l?function(l){const c=Hb.exec(l);if(!c)return void consoleSandbox((()=>{console.error(`Invalid Sentry Dsn: ${l}`)}));const[d,h,p="",f,m="",y]=c.slice(1);let _="",b=y;const w=b.split("/");if(w.length>1&&(_=w.slice(0,-1).join("/"),b=w.pop()),b){const l=b.match(/^\d+/);l&&(b=l[0])}return dsnFromComponents({host:f,pass:p,path:_,projectId:b,port:m,protocol:d,publicKey:h})}(l):dsnFromComponents(l);if(c&&function(l){if(!Fb)return!0;const{port:c,projectId:d,protocol:h}=l;return!(["protocol","publicKey","host","projectId"].find((c=>!l[c]&&(Bb.error(`Invalid Sentry Dsn: ${c} missing`),!0)))||(d.match(/^\d+$/)?function(l){return"http"===l||"https"===l}(h)?c&&isNaN(parseInt(c,10))&&(Bb.error(`Invalid Sentry Dsn: Invalid port ${c}`),1):(Bb.error(`Invalid Sentry Dsn: Invalid protocol ${h}`),1):(Bb.error(`Invalid Sentry Dsn: Invalid projectId ${d}`),1)))}(c))return c}class SentryError extends Error{constructor(l,c="warn"){super(l),this.message=l,this.name=new.target.prototype.constructor.name,Object.setPrototypeOf(this,new.target.prototype),this.logLevel=c}}function fill(l,c,d){if(!(c in l))return;const h=l[c],p=d(h);"function"==typeof p&&markFunctionWrapped(p,h),l[c]=p}function addNonEnumerableProperty(l,c,d){try{Object.defineProperty(l,c,{value:d,writable:!0,configurable:!0})}catch(h){Fb&&Bb.log(`Failed to add non-enumerable property "${c}" to object`,l)}}function markFunctionWrapped(l,c){try{const d=c.prototype||{};l.prototype=c.prototype=d,addNonEnumerableProperty(l,"__sentry_original__",c)}catch(d){}}function getOriginalFunction(l){return l.__sentry_original__}function convertToPlainObject(l){if(isError(l))return{message:l.message,name:l.name,stack:l.stack,...getOwnProperties(l)};if(isEvent(l)){const c={type:l.type,target:serializeEventTarget(l.target),currentTarget:serializeEventTarget(l.currentTarget),...getOwnProperties(l)};return"undefined"!=typeof CustomEvent&&isInstanceOf(l,CustomEvent)&&(c.detail=l.detail),c}return l}function serializeEventTarget(l){try{return c=l,"undefined"!=typeof Element&&isInstanceOf(c,Element)?htmlTreeAsString(l):Object.prototype.toString.call(l)}catch(d){return"<unknown>"}var c}function getOwnProperties(l){if("object"==typeof l&&null!==l){const c={};for(const d in l)Object.prototype.hasOwnProperty.call(l,d)&&(c[d]=l[d]);return c}return{}}function dropUndefinedKeys(l){return _dropUndefinedKeys(l,new Map)}function _dropUndefinedKeys(l,c){if(function(l){if(!isPlainObject$3(l))return!1;try{const c=Object.getPrototypeOf(l).constructor.name;return!c||"Object"===c}catch(hh){return!0}}(l)){const d=c.get(l);if(void 0!==d)return d;const h={};c.set(l,h);for(const p of Object.keys(l))void 0!==l[p]&&(h[p]=_dropUndefinedKeys(l[p],c));return h}if(Array.isArray(l)){const d=c.get(l);if(void 0!==d)return d;const h=[];return c.set(l,h),l.forEach((l=>{h.push(_dropUndefinedKeys(l,c))})),h}return l}const zb=/\(error: (.*)\)/,qb=/captureMessage|captureException/;function createStackParser(...l){const c=l.sort(((l,c)=>l[0]-c[0])).map((l=>l[1]));return(l,d=0)=>{const h=[],p=l.split("\n");for(let f=d;f<p.length;f++){const l=p[f];if(l.length>1024)continue;const d=zb.test(l)?l.replace(zb,"$1"):l;if(!d.match(/\S*Error: /)){for(const l of c){const c=l(d);if(c){h.push(c);break}}if(h.length>=50)break}}return function(l){if(!l.length)return[];const c=Array.from(l);/sentryWrapped/.test(c[c.length-1].function||"")&&c.pop();c.reverse(),qb.test(c[c.length-1].function||"")&&(c.pop(),qb.test(c[c.length-1].function||"")&&c.pop());return c.slice(0,50).map((l=>({...l,filename:l.filename||c[c.length-1].filename,function:l.function||"?"})))}(h)}}const Wb="<anonymous>";function getFunctionName(l){try{return l&&"function"==typeof l&&l.name||Wb}catch(hh){return Wb}}const Vb={},Zb={};function addHandler$1(l,c){Vb[l]=Vb[l]||[],Vb[l].push(c)}function maybeInstrument(l,c){Zb[l]||(c(),Zb[l]=!0)}function triggerHandlers$1(l,c){const d=l&&Vb[l];if(d)for(const h of d)try{h(c)}catch(hh){Fb&&Bb.error(`Error while triggering instrumentation handler.\nType: ${l}\nName: ${getFunctionName(h)}\nError:`,hh)}}function instrumentConsole(){"console"in jb&&$b.forEach((function(l){l in jb.console&&fill(jb.console,l,(function(c){return Ub[l]=c,function(...c){triggerHandlers$1("console",{args:c,level:l});const d=Ub[l];d&&d.apply(jb.console,c)}}))}))}function uuid4(){const l=jb,c=l.crypto||l.msCrypto;let getRandomByte=()=>16*Math.random();try{if(c&&c.randomUUID)return c.randomUUID().replace(/-/g,"");c&&c.getRandomValues&&(getRandomByte=()=>{const l=new Uint8Array(1);return c.getRandomValues(l),l[0]})}catch(d){}return"10000000100040008000100000000000".replace(/[018]/g,(l=>(l^(15&getRandomByte())>>l/4).toString(16)))}function getFirstException(l){return l.exception&&l.exception.values?l.exception.values[0]:void 0}function getEventDescription(l){const{message:c,event_id:d}=l;if(c)return c;const h=getFirstException(l);return h?h.type&&h.value?`${h.type}: ${h.value}`:h.type||h.value||d||"<unknown>":d||"<unknown>"}function addExceptionTypeValue(l,c,d){const h=l.exception=l.exception||{},p=h.values=h.values||[],f=p[0]=p[0]||{};f.value||(f.value=c||""),f.type||(f.type="Error")}function addExceptionMechanism(l,c){const d=getFirstException(l);if(!d)return;const h=d.mechanism;if(d.mechanism={type:"generic",handled:!0,...h,...c},c&&"data"in c){const l={...h&&h.data,...c.data};d.mechanism.data=l}}function checkOrSetAlreadyCaught(l){if(l&&l.__sentry_captured__)return!0;try{addNonEnumerableProperty(l,"__sentry_captured__",!0)}catch(c){}return!1}function arrayify(l){return Array.isArray(l)?l:[l]}const Gb=jb;let Kb,Jb,Yb;function addClickKeypressInstrumentationHandler(l){addHandler$1("dom",l),maybeInstrument("dom",instrumentDOM)}function instrumentDOM(){if(!Gb.document)return;const l=triggerHandlers$1.bind(null,"dom"),c=makeDOMEventHandler(l,!0);Gb.document.addEventListener("click",c,!1),Gb.document.addEventListener("keypress",c,!1),["EventTarget","Node"].forEach((c=>{const d=Gb[c]&&Gb[c].prototype;d&&d.hasOwnProperty&&d.hasOwnProperty("addEventListener")&&(fill(d,"addEventListener",(function(c){return function(d,h,p){if("click"===d||"keypress"==d)try{const h=this,f=h.__sentry_instrumentation_handlers__=h.__sentry_instrumentation_handlers__||{},m=f[d]=f[d]||{refCount:0};if(!m.handler){const h=makeDOMEventHandler(l);m.handler=h,c.call(this,d,h,p)}m.refCount++}catch(hh){}return c.call(this,d,h,p)}})),fill(d,"removeEventListener",(function(l){return function(c,d,h){if("click"===c||"keypress"==c)try{const d=this,p=d.__sentry_instrumentation_handlers__||{},f=p[c];f&&(f.refCount--,f.refCount<=0&&(l.call(this,c,f.handler,h),f.handler=void 0,delete p[c]),0===Object.keys(p).length&&delete d.__sentry_instrumentation_handlers__)}catch(hh){}return l.call(this,c,d,h)}})))}))}function makeDOMEventHandler(l,c=!1){return d=>{if(!d||d._sentryCaptured)return;const h=function(l){try{return l.target}catch(hh){return null}}(d);if(function(l,c){return"keypress"===l&&(!c||!c.tagName||"INPUT"!==c.tagName&&"TEXTAREA"!==c.tagName&&!c.isContentEditable)}(d.type,h))return;addNonEnumerableProperty(d,"_sentryCaptured",!0),h&&!h._sentryId&&addNonEnumerableProperty(h,"_sentryId",uuid4());const p="keypress"===d.type?"input":d.type;if(!function(l){if(l.type!==Jb)return!1;try{if(!l.target||l.target._sentryId!==Yb)return!1}catch(hh){}return!0}(d)){l({event:d,name:p,global:c}),Jb=d.type,Yb=h?h._sentryId:void 0}clearTimeout(Kb),Kb=Gb.setTimeout((()=>{Yb=void 0,Jb=void 0}),1e3)}}const Qb=getGlobalObject();function supportsFetch(){if(!("fetch"in Qb))return!1;try{return new Headers,new Request("http://www.example.com"),new Response,!0}catch(hh){return!1}}function isNativeFetch(l){return l&&/^function fetch\(\)\s+\{\s+\[native code\]\s+\}$/.test(l.toString())}function addFetchInstrumentationHandler(l){const c="fetch";addHandler$1(c,l),maybeInstrument(c,instrumentFetch)}function instrumentFetch(){(function(){if("string"==typeof EdgeRuntime)return!0;if(!supportsFetch())return!1;if(isNativeFetch(Qb.fetch))return!0;let l=!1;const c=Qb.document;if(c&&"function"==typeof c.createElement)try{const d=c.createElement("iframe");d.hidden=!0,c.head.appendChild(d),d.contentWindow&&d.contentWindow.fetch&&(l=isNativeFetch(d.contentWindow.fetch)),c.head.removeChild(d)}catch(d){Fb&&Bb.warn("Could not create sandbox iframe for pure fetch check, bailing to window.fetch: ",d)}return l})()&&fill(jb,"fetch",(function(l){return function(...c){const{method:d,url:h}=function(l){if(0===l.length)return{method:"GET",url:""};if(2===l.length){const[c,d]=l;return{url:getUrlFromResource(c),method:hasProp(d,"method")?String(d.method).toUpperCase():"GET"}}const c=l[0];return{url:getUrlFromResource(c),method:hasProp(c,"method")?String(c.method).toUpperCase():"GET"}}(c),p={args:c,fetchData:{method:d,url:h},startTimestamp:Date.now()};return triggerHandlers$1("fetch",{...p}),l.apply(jb,c).then((l=>(triggerHandlers$1("fetch",{...p,endTimestamp:Date.now(),response:l}),l)),(l=>{throw triggerHandlers$1("fetch",{...p,endTimestamp:Date.now(),error:l}),l}))}}))}function hasProp(l,c){return!!l&&"object"==typeof l&&!!l[c]}function getUrlFromResource(l){return"string"==typeof l?l:l?hasProp(l,"url")?l.url:l.toString?l.toString():"":""}let Xb=null;function addGlobalErrorInstrumentationHandler(l){const c="error";addHandler$1(c,l),maybeInstrument(c,instrumentError)}function instrumentError(){Xb=jb.onerror,jb.onerror=function(l,c,d,h,p){return triggerHandlers$1("error",{column:h,error:p,line:d,msg:l,url:c}),!(!Xb||Xb.__SENTRY_LOADER__)&&Xb.apply(this,arguments)},jb.onerror.__SENTRY_INSTRUMENTED__=!0}let ew=null;function addGlobalUnhandledRejectionInstrumentationHandler(l){const c="unhandledrejection";addHandler$1(c,l),maybeInstrument(c,instrumentUnhandledRejection)}function instrumentUnhandledRejection(){ew=jb.onunhandledrejection,jb.onunhandledrejection=function(l){return triggerHandlers$1("unhandledrejection",l),!(ew&&!ew.__SENTRY_LOADER__)||ew.apply(this,arguments)},jb.onunhandledrejection.__SENTRY_INSTRUMENTED__=!0}const tw=getGlobalObject();const rw=jb;let nw;function addHistoryInstrumentationHandler(l){const c="history";addHandler$1(c,l),maybeInstrument(c,instrumentHistory)}function instrumentHistory(){if(!function(){const l=tw.chrome,c=l&&l.app&&l.app.runtime,d="history"in tw&&!!tw.history.pushState&&!!tw.history.replaceState;return!c&&d}())return;const l=rw.onpopstate;function historyReplacementFunction(l){return function(...c){const d=c.length>2?c[2]:void 0;if(d){const l=nw,c=String(d);nw=c;triggerHandlers$1("history",{from:l,to:c})}return l.apply(this,c)}}rw.onpopstate=function(...c){const d=rw.location.href,h=nw;nw=d;if(triggerHandlers$1("history",{from:h,to:d}),l)try{return l.apply(this,c)}catch(p){}},fill(rw.history,"pushState",historyReplacementFunction),fill(rw.history,"replaceState",historyReplacementFunction)}const sw=jb,iw="__sentry_xhr_v3__";function addXhrInstrumentationHandler(l){addHandler$1("xhr",l),maybeInstrument("xhr",instrumentXHR)}function instrumentXHR(){if(!sw.XMLHttpRequest)return;const l=XMLHttpRequest.prototype;fill(l,"open",(function(l){return function(...c){const d=Date.now(),h=isString$1(c[0])?c[0].toUpperCase():void 0,p=function(l){if(isString$1(l))return l;try{return l.toString()}catch(c){}return}(c[1]);if(!h||!p)return l.apply(this,c);this[iw]={method:h,url:p,request_headers:{}},"POST"===h&&p.match(/sentry_key/)&&(this.__sentry_own_request__=!0);const onreadystatechangeHandler=()=>{const l=this[iw];if(l&&4===this.readyState){try{l.status_code=this.status}catch(hh){}triggerHandlers$1("xhr",{args:[h,p],endTimestamp:Date.now(),startTimestamp:d,xhr:this})}};return"onreadystatechange"in this&&"function"==typeof this.onreadystatechange?fill(this,"onreadystatechange",(function(l){return function(...c){return onreadystatechangeHandler(),l.apply(this,c)}})):this.addEventListener("readystatechange",onreadystatechangeHandler),fill(this,"setRequestHeader",(function(l){return function(...c){const[d,h]=c,p=this[iw];return p&&isString$1(d)&&isString$1(h)&&(p.request_headers[d.toLowerCase()]=h),l.apply(this,c)}})),l.apply(this,c)}})),fill(l,"send",(function(l){return function(...c){const d=this[iw];if(!d)return l.apply(this,c);void 0!==c[0]&&(d.body=c[0]);return triggerHandlers$1("xhr",{args:[d.method,d.url],startTimestamp:Date.now(),xhr:this}),l.apply(this,c)}}))}function isNodeEnv(){return!("undefined"!=typeof __SENTRY_BROWSER_BUNDLE__&&__SENTRY_BROWSER_BUNDLE__)&&"[object process]"===Object.prototype.toString.call("undefined"!=typeof process?process:0)}function isBrowser$1(){return"undefined"!=typeof window&&(!isNodeEnv()||void 0!==jb.process&&"renderer"===jb.process.type)}function normalize(l,c=100,d=1/0){try{return visit("",l,c,d)}catch(h){return{ERROR:`**non-serializable** (${h})`}}}function normalizeToSize(l,c=3,d=102400){const h=normalize(l,c);return p=h,function(l){return~-encodeURI(l).split(/%..|./).length}(JSON.stringify(p))>d?normalizeToSize(l,c-1,d):h;var p}function visit(l,c,d=1/0,h=1/0,p=function(){const l="function"==typeof WeakSet,c=l?new WeakSet:[];return[function(d){if(l)return!!c.has(d)||(c.add(d),!1);for(let l=0;l<c.length;l++)if(c[l]===d)return!0;return c.push(d),!1},function(d){if(l)c.delete(d);else for(let l=0;l<c.length;l++)if(c[l]===d){c.splice(l,1);break}}]}()){const[f,m]=p;if(null==c||["number","boolean","string"].includes(typeof c)&&!isNaN$1(c))return c;const y=function(l,c){try{if("domain"===l&&c&&"object"==typeof c&&c._events)return"[Domain]";if("domainEmitter"===l)return"[DomainEmitter]";if("undefined"!=typeof global&&c===global)return"[Global]";if("undefined"!=typeof window&&c===window)return"[Window]";if("undefined"!=typeof document&&c===document)return"[Document]";if(isVueViewModel(c))return"[VueViewModel]";if(isPlainObject$3(d=c)&&"nativeEvent"in d&&"preventDefault"in d&&"stopPropagation"in d)return"[SyntheticEvent]";if("number"==typeof c&&c!=c)return"[NaN]";if("function"==typeof c)return`[Function: ${getFunctionName(c)}]`;if("symbol"==typeof c)return`[${String(c)}]`;if("bigint"==typeof c)return`[BigInt: ${String(c)}]`;const h=function(l){const c=Object.getPrototypeOf(l);return c?c.constructor.name:"null prototype"}(c);return/^HTML(\w*)Element$/.test(h)?`[HTMLElement: ${h}]`:`[object ${h}]`}catch(h){return`**non-serializable** (${h})`}var d}(l,c);if(!y.startsWith("[object "))return y;if(c.__sentry_skip_normalization__)return c;const _="number"==typeof c.__sentry_override_normalization_depth__?c.__sentry_override_normalization_depth__:d;if(0===_)return y.replace("object ","");if(f(c))return"[Circular ~]";const b=c;if(b&&"function"==typeof b.toJSON)try{return visit("",b.toJSON(),_-1,h,p)}catch(N){}const w=Array.isArray(c)?[]:{};let E=0;const M=convertToPlainObject(c);for(const P in M){if(!Object.prototype.hasOwnProperty.call(M,P))continue;if(E>=h){w[P]="[MaxProperties ~]";break}const l=M[P];w[P]=visit(P,l,_-1,h,p),E++}return m(c),w}var ow;function resolvedSyncPromise(l){return new SyncPromise((c=>{c(l)}))}function rejectedSyncPromise(l){return new SyncPromise(((c,d)=>{d(l)}))}!function(l){l[l.PENDING=0]="PENDING";l[l.RESOLVED=1]="RESOLVED";l[l.REJECTED=2]="REJECTED"}(ow||(ow={}));class SyncPromise{constructor(l){SyncPromise.prototype.__init.call(this),SyncPromise.prototype.__init2.call(this),SyncPromise.prototype.__init3.call(this),SyncPromise.prototype.__init4.call(this),this._state=ow.PENDING,this._handlers=[];try{l(this._resolve,this._reject)}catch(hh){this._reject(hh)}}then(l,c){return new SyncPromise(((d,h)=>{this._handlers.push([!1,c=>{if(l)try{d(l(c))}catch(hh){h(hh)}else d(c)},l=>{if(c)try{d(c(l))}catch(hh){h(hh)}else h(l)}]),this._executeHandlers()}))}catch(l){return this.then((l=>l),l)}finally(l){return new SyncPromise(((c,d)=>{let h,p;return this.then((c=>{p=!1,h=c,l&&l()}),(c=>{p=!0,h=c,l&&l()})).then((()=>{p?d(h):c(h)}))}))}__init(){this._resolve=l=>{this._setResult(ow.RESOLVED,l)}}__init2(){this._reject=l=>{this._setResult(ow.REJECTED,l)}}__init3(){this._setResult=(l,c)=>{this._state===ow.PENDING&&(isThenable(c)?c.then(this._resolve,this._reject):(this._state=l,this._value=c,this._executeHandlers()))}}__init4(){this._executeHandlers=()=>{if(this._state===ow.PENDING)return;const l=this._handlers.slice();this._handlers=[],l.forEach((l=>{l[0]||(this._state===ow.RESOLVED&&l[1](this._value),this._state===ow.REJECTED&&l[2](this._value),l[0]=!0)}))}}}function makePromiseBuffer(l){const c=[];function remove2(l){return c.splice(c.indexOf(l),1)[0]}return{$:c,add:function(d){if(!(void 0===l||c.length<l))return rejectedSyncPromise(new SentryError("Not adding Promise because buffer limit was reached."));const h=d();return-1===c.indexOf(h)&&c.push(h),h.then((()=>remove2(h))).then(null,(()=>remove2(h).then(null,(()=>{})))),h},drain:function(l){return new SyncPromise(((d,h)=>{let p=c.length;if(!p)return d(!0);const f=setTimeout((()=>{l&&l>0&&d(!1)}),l);c.forEach((l=>{resolvedSyncPromise(l).then((()=>{--p||(clearTimeout(f),d(!0))}),h)}))}))}}}function parseUrl(l){if(!l)return{};const c=l.match(/^(([^:/?#]+):)?(\/\/([^/?#]*))?([^?#]*)(\?([^#]*))?(#(.*))?$/);if(!c)return{};const d=c[6]||"",h=c[8]||"";return{host:c[4],path:c[5],protocol:c[2],search:d,hash:h,relative:c[5]+d+h}}const aw=["fatal","error","warning","log","info","debug"];function severityLevelFromString(l){return"warn"===l?"warning":aw.includes(l)?l:"log"}function dateTimestampInSeconds(){return Date.now()/1e3}const lw=function(){const{performance:l}=jb;if(!l||!l.now)return dateTimestampInSeconds;const c=Date.now()-l.now(),d=null==l.timeOrigin?c:l.timeOrigin;return()=>(d+l.now())/1e3}(),cw=(()=>{const{performance:l}=jb;if(!l||!l.now)return;const c=36e5,d=l.now(),h=Date.now(),p=l.timeOrigin?Math.abs(l.timeOrigin+d-h):c,f=p<c,m=l.timing&&l.timing.navigationStart,y="number"==typeof m?Math.abs(m+d-h):c;return f||y<c?p<=y?l.timeOrigin:m:h})(),uw="baggage",dw="sentry-",hw=/^sentry-/;function dynamicSamplingContextToSentryBaggageHeader(l){if(!l)return;return function(l){if(0===Object.keys(l).length)return;return Object.entries(l).reduce(((l,[c,d],h)=>{const p=`${encodeURIComponent(c)}=${encodeURIComponent(d)}`,f=0===h?p:`${l},${p}`;return f.length>8192?(Fb&&Bb.warn(`Not adding key: ${c} with val: ${d} to baggage header due to exceeding baggage size limits.`),l):f}),"")}(Object.entries(l).reduce(((l,[c,d])=>(d&&(l[`${dw}${c}`]=d),l)),{}))}function baggageHeaderToObject(l){return l.split(",").map((l=>l.split("=").map((l=>decodeURIComponent(l.trim()))))).reduce(((l,[c,d])=>(l[c]=d,l)),{})}const pw=new RegExp("^[ \\t]*([0-9a-f]{32})?-?([0-9a-f]{16})?-?([01])?[ \\t]*$");function propagationContextFromHeaders(l,c){const d=function(l){if(!l)return;const c=l.match(pw);if(!c)return;let d;return"1"===c[3]?d=!0:"0"===c[3]&&(d=!1),{traceId:c[1],parentSampled:d,parentSpanId:c[2]}}(l),h=function(l){if(!isString$1(l)&&!Array.isArray(l))return;let c={};if(Array.isArray(l))c=l.reduce(((l,c)=>{const d=baggageHeaderToObject(c);for(const h of Object.keys(d))l[h]=d[h];return l}),{});else{if(!l)return;c=baggageHeaderToObject(l)}const d=Object.entries(c).reduce(((l,[c,d])=>(c.match(hw)&&(l[c.slice(7)]=d),l)),{});return Object.keys(d).length>0?d:void 0}(c),{traceId:p,parentSpanId:f,parentSampled:m}=d||{};return d?{traceId:p||uuid4(),parentSpanId:f||uuid4().substring(16),spanId:uuid4().substring(16),sampled:m,dsc:h||{}}:{traceId:p||uuid4(),spanId:uuid4().substring(16)}}function generateSentryTraceHeader(l=uuid4(),c=uuid4().substring(16),d){let h="";return void 0!==d&&(h=d?"-1":"-0"),`${l}-${c}${h}`}function createEnvelope(l,c=[]){return[l,c]}function addItemToEnvelope(l,c){const[d,h]=l;return[d,[...h,c]]}function forEachEnvelopeItem(l,c){const d=l[1];for(const h of d){if(c(h,h[0].type))return!0}return!1}function encodeUTF8(l,c){return(c||new TextEncoder).encode(l)}function serializeEnvelope(l,c){const[d,h]=l;let p=JSON.stringify(d);function append(l){"string"==typeof p?p="string"==typeof l?p+l:[encodeUTF8(p,c),l]:p.push("string"==typeof l?encodeUTF8(l,c):l)}for(const f of h){const[l,c]=f;if(append(`\n${JSON.stringify(l)}\n`),"string"==typeof c||c instanceof Uint8Array)append(c);else{let l;try{l=JSON.stringify(c)}catch(hh){l=JSON.stringify(normalize(c))}append(l)}}return"string"==typeof p?p:function(l){const c=l.reduce(((l,c)=>l+c.length),0),d=new Uint8Array(c);let h=0;for(const p of l)d.set(p,h),h+=p.length;return d}(p)}function createAttachmentEnvelopeItem(l,c){const d="string"==typeof l.data?encodeUTF8(l.data,c):l.data;return[dropUndefinedKeys({type:"attachment",length:d.length,filename:l.filename,content_type:l.contentType,attachment_type:l.attachmentType}),d]}const fw={session:"session",sessions:"session",attachment:"attachment",transaction:"transaction",event:"error",client_report:"internal",user_report:"default",profile:"profile",replay_event:"replay",replay_recording:"replay",check_in:"monitor",feedback:"feedback",span:"span",statsd:"metric_bucket"};function envelopeItemTypeToDataCategory(l){return fw[l]}function getSdkMetadataForEnvelopeHeader(l){if(!l||!l.sdk)return;const{name:c,version:d}=l.sdk;return{name:c,version:d}}function createEventEnvelopeHeaders(l,c,d,h){const p=l.sdkProcessingMetadata&&l.sdkProcessingMetadata.dynamicSamplingContext;return{event_id:l.event_id,sent_at:(new Date).toISOString(),...c&&{sdk:c},...!!d&&h&&{dsn:dsnToString(h)},...p&&{trace:dropUndefinedKeys({...p})}}}function isRateLimited(l,c,d=Date.now()){return function(l,c){return l[c]||l.all||0}(l,c)>d}function updateRateLimits(l,{statusCode:c,headers:d},h=Date.now()){const p={...l},f=d&&d["x-sentry-rate-limits"],m=d&&d["retry-after"];if(f)for(const y of f.trim().split(",")){const[l,c,,,d]=y.split(":",5),f=parseInt(l,10),m=1e3*(isNaN(f)?60:f);if(c)for(const y of c.split(";"))"metric_bucket"===y&&d&&!d.split(";").includes("custom")||(p[y]=h+m);else p.all=h+m}else m?p.all=h+function(l,c=Date.now()){const d=parseInt(`${l}`,10);if(!isNaN(d))return 1e3*d;const h=Date.parse(`${l}`);return isNaN(h)?6e4:h-c}(m,h):429===c&&(p.all=h+6e4);return p}function _optionalChain(l){let c,d=l[0],h=1;for(;h<l.length;){const p=l[h],f=l[h+1];if(h+=2,("optionalAccess"===p||"optionalCall"===p)&&null==d)return;"access"===p||"optionalAccess"===p?(c=d,d=f(d)):"call"!==p&&"optionalCall"!==p||(d=f(((...l)=>d.call(c,...l))),c=void 0)}return d}const mw="undefined"==typeof __SENTRY_DEBUG__||__SENTRY_DEBUG__,gw="production";function getGlobalEventProcessors(){return getGlobalSingleton("globalEventProcessors",(()=>[]))}function addGlobalEventProcessor(l){getGlobalEventProcessors().push(l)}function notifyEventProcessors(l,c,d,h=0){return new SyncPromise(((p,f)=>{const m=l[h];if(null===c||"function"!=typeof m)p(c);else{const y=m({...c},d);mw&&m.id&&null===y&&Bb.log(`Event processor "${m.id}" dropped event`),isThenable(y)?y.then((c=>notifyEventProcessors(l,c,d,h+1).then(p))).then(null,f):notifyEventProcessors(l,y,d,h+1).then(p).then(null,f)}}))}function makeSession$1(l){const c=lw(),d={sid:uuid4(),init:!0,timestamp:c,started:c,duration:0,status:"ok",errors:0,ignoreDuration:!1,toJSON:()=>function(l){return dropUndefinedKeys({sid:`${l.sid}`,init:l.init,started:new Date(1e3*l.started).toISOString(),timestamp:new Date(1e3*l.timestamp).toISOString(),status:l.status,errors:l.errors,did:"number"==typeof l.did||"string"==typeof l.did?`${l.did}`:void 0,duration:l.duration,abnormal_mechanism:l.abnormal_mechanism,attrs:{release:l.release,environment:l.environment,ip_address:l.ipAddress,user_agent:l.userAgent}})}(d)};return l&&updateSession(d,l),d}function updateSession(l,c={}){if(c.user&&(!l.ipAddress&&c.user.ip_address&&(l.ipAddress=c.user.ip_address),l.did||c.did||(l.did=c.user.id||c.user.email||c.user.username)),l.timestamp=c.timestamp||lw(),c.abnormal_mechanism&&(l.abnormal_mechanism=c.abnormal_mechanism),c.ignoreDuration&&(l.ignoreDuration=c.ignoreDuration),c.sid&&(l.sid=32===c.sid.length?c.sid:uuid4()),void 0!==c.init&&(l.init=c.init),!l.did&&c.did&&(l.did=`${c.did}`),"number"==typeof c.started&&(l.started=c.started),l.ignoreDuration)l.duration=void 0;else if("number"==typeof c.duration)l.duration=c.duration;else{const c=l.timestamp-l.started;l.duration=c>=0?c:0}c.release&&(l.release=c.release),c.environment&&(l.environment=c.environment),!l.ipAddress&&c.ipAddress&&(l.ipAddress=c.ipAddress),!l.userAgent&&c.userAgent&&(l.userAgent=c.userAgent),"number"==typeof c.errors&&(l.errors=c.errors),c.status&&(l.status=c.status)}function closeSession(l,c){let d={};"ok"===l.status&&(d={status:"exited"}),updateSession(l,d)}function spanToTraceContext(l){const{spanId:c,traceId:d}=l.spanContext(),{data:h,op:p,parent_span_id:f,status:m,tags:y,origin:_}=spanToJSON(l);return dropUndefinedKeys({data:h,op:p,parent_span_id:f,span_id:c,status:m,tags:y,trace_id:d,origin:_})}function spanToTraceHeader(l){const{traceId:c,spanId:d}=l.spanContext();return generateSentryTraceHeader(c,d,spanIsSampled(l))}function spanTimeInputToSeconds(l){return"number"==typeof l?ensureTimestampInSeconds(l):Array.isArray(l)?l[0]+l[1]/1e9:l instanceof Date?ensureTimestampInSeconds(l.getTime()):lw()}function ensureTimestampInSeconds(l){return l>9999999999?l/1e3:l}function spanToJSON(l){return function(l){return"function"==typeof l.getSpanJSON}(l)?l.getSpanJSON():"function"==typeof l.toJSON?l.toJSON():{}}function spanIsSampled(l){const{traceFlags:c}=l.spanContext();return Boolean(1&c)}function prepareEvent(l,c,d,h,p,f){const{normalizeDepth:m=3,normalizeMaxBreadth:y=1e3}=l,_={...c,event_id:c.event_id||d.event_id||uuid4(),timestamp:c.timestamp||dateTimestampInSeconds()},b=d.integrations||l.integrations.map((l=>l.name));!function(l,c){const{environment:d,release:h,dist:p,maxValueLength:f=250}=c;"environment"in l||(l.environment="environment"in c?d:gw);void 0===l.release&&void 0!==h&&(l.release=h);void 0===l.dist&&void 0!==p&&(l.dist=p);l.message&&(l.message=truncate(l.message,f));const m=l.exception&&l.exception.values&&l.exception.values[0];m&&m.value&&(m.value=truncate(m.value,f));const y=l.request;y&&y.url&&(y.url=truncate(y.url,f))}(_,l),function(l,c){c.length>0&&(l.sdk=l.sdk||{},l.sdk.integrations=[...l.sdk.integrations||[],...c])}(_,b),void 0===c.type&&function(l,c){const d=jb._sentryDebugIds;if(!d)return;let h;const p=vw.get(c);p?h=p:(h=new Map,vw.set(c,h));const f=Object.keys(d).reduce(((l,p)=>{let f;const m=h.get(p);m?f=m:(f=c(p),h.set(p,f));for(let c=f.length-1;c>=0;c--){const h=f[c];if(h.filename){l[h.filename]=d[p];break}}return l}),{});try{l.exception.values.forEach((l=>{l.stacktrace.frames.forEach((l=>{l.filename&&(l.debug_id=f[l.filename])}))}))}catch(hh){}}(_,l.stackParser);const w=function(l,c){if(!c)return l;const d=l?l.clone():new Scope;return d.update(c),d}(h,d.captureContext);d.mechanism&&addExceptionMechanism(_,d.mechanism);const E=p&&p.getEventProcessors?p.getEventProcessors():[],M=function(){yw||(yw=new Scope);return yw}().getScopeData();if(f){mergeScopeData(M,f.getScopeData())}if(w){mergeScopeData(M,w.getScopeData())}const N=[...d.attachments||[],...M.attachments];N.length&&(d.attachments=N),applyScopeDataToEvent(_,M);return notifyEventProcessors([...E,...getGlobalEventProcessors(),...M.eventProcessors],_,d).then((l=>(l&&function(l){const c={};try{l.exception.values.forEach((l=>{l.stacktrace.frames.forEach((l=>{l.debug_id&&(l.abs_path?c[l.abs_path]=l.debug_id:l.filename&&(c[l.filename]=l.debug_id),delete l.debug_id)}))}))}catch(hh){}if(0===Object.keys(c).length)return;l.debug_meta=l.debug_meta||{},l.debug_meta.images=l.debug_meta.images||[];const d=l.debug_meta.images;Object.keys(c).forEach((l=>{d.push({type:"sourcemap",code_file:l,debug_id:c[l]})}))}(l),"number"==typeof m&&m>0?function(l,c,d){if(!l)return null;const h={...l,...l.breadcrumbs&&{breadcrumbs:l.breadcrumbs.map((l=>({...l,...l.data&&{data:normalize(l.data,c,d)}})))},...l.user&&{user:normalize(l.user,c,d)},...l.contexts&&{contexts:normalize(l.contexts,c,d)},...l.extra&&{extra:normalize(l.extra,c,d)}};l.contexts&&l.contexts.trace&&h.contexts&&(h.contexts.trace=l.contexts.trace,l.contexts.trace.data&&(h.contexts.trace.data=normalize(l.contexts.trace.data,c,d)));l.spans&&(h.spans=l.spans.map((l=>{const h=spanToJSON(l).data;return h&&(l.data=normalize(h,c,d)),l})));return h}(l,m,y):l)))}const vw=new WeakMap;function captureException(l,c){return getCurrentHub().captureException(l,void 0)}function captureMessage(l,c){const d="string"==typeof c?c:void 0,h="string"!=typeof c?{captureContext:c}:void 0;return getCurrentHub().captureMessage(l,d,h)}function captureEvent(l,c){return getCurrentHub().captureEvent(l,c)}function addBreadcrumb(l,c){getCurrentHub().addBreadcrumb(l,c)}function setContext(l,c){getCurrentHub().setContext(l,c)}function withScope(...l){const c=getCurrentHub();if(2===l.length){const[d,h]=l;return d?c.withScope((()=>(c.getStackTop().scope=d,h(d)))):c.withScope(h)}return c.withScope(l[0])}function getClient(){return getCurrentHub().getClient()}function getCurrentScope$1(){return getCurrentHub().getScope()}function startSession(l){const c=getClient(),d=getIsolationScope(),h=getCurrentScope$1(),{release:p,environment:f=gw}=c&&c.getOptions()||{},{userAgent:m}=jb.navigator||{},y=makeSession$1({release:p,environment:f,user:h.getUser()||d.getUser(),...m&&{userAgent:m},...l}),_=d.getSession();return _&&"ok"===_.status&&updateSession(_,{status:"exited"}),endSession(),d.setSession(y),h.setSession(y),y}function endSession(){const l=getIsolationScope(),c=getCurrentScope$1(),d=c.getSession()||l.getSession();d&&closeSession(d),_sendSessionUpdate(),l.setSession(),c.setSession()}function _sendSessionUpdate(){const l=getIsolationScope(),c=getCurrentScope$1(),d=getClient(),h=c.getSession()||l.getSession();h&&d&&d.captureSession&&d.captureSession(h)}function captureSession(l=!1){l?endSession():_sendSessionUpdate()}function getRootSpan(l){return l.transaction}function getDynamicSamplingContextFromClient(l,c,d){const h=c.getOptions(),{publicKey:p}=c.getDsn()||{},{segment:f}=d&&d.getUser()||{},m=dropUndefinedKeys({environment:h.environment||gw,release:h.release,user_segment:f,public_key:p,trace_id:l});return c.emit&&c.emit("createDsc",m),m}function getDynamicSamplingContextFromSpan(l){const c=getClient();if(!c)return{};const d=getDynamicSamplingContextFromClient(spanToJSON(l).trace_id||"",c,getCurrentScope$1()),h=getRootSpan(l);if(!h)return d;const p=h&&h._frozenDynamicSamplingContext;if(p)return p;const{sampleRate:f,source:m}=h.metadata;null!=f&&(d.sample_rate=`${f}`);const y=spanToJSON(h);return m&&"url"!==m&&(d.transaction=y.description),d.sampled=String(spanIsSampled(h)),c.emit&&c.emit("createDsc",d),d}function applyScopeDataToEvent(l,c){const{fingerprint:d,span:h,breadcrumbs:p,sdkProcessingMetadata:f}=c;!function(l,c){const{extra:d,tags:h,user:p,contexts:f,level:m,transactionName:y}=c,_=dropUndefinedKeys(d);_&&Object.keys(_).length&&(l.extra={..._,...l.extra});const b=dropUndefinedKeys(h);b&&Object.keys(b).length&&(l.tags={...b,...l.tags});const w=dropUndefinedKeys(p);w&&Object.keys(w).length&&(l.user={...w,...l.user});const E=dropUndefinedKeys(f);E&&Object.keys(E).length&&(l.contexts={...E,...l.contexts});m&&(l.level=m);y&&(l.transaction=y)}(l,c),h&&function(l,c){l.contexts={trace:spanToTraceContext(c),...l.contexts};const d=getRootSpan(c);if(d){l.sdkProcessingMetadata={dynamicSamplingContext:getDynamicSamplingContextFromSpan(c),...l.sdkProcessingMetadata};const h=spanToJSON(d).description;h&&(l.tags={transaction:h,...l.tags})}}(l,h),function(l,c){l.fingerprint=l.fingerprint?arrayify(l.fingerprint):[],c&&(l.fingerprint=l.fingerprint.concat(c));l.fingerprint&&!l.fingerprint.length&&delete l.fingerprint}(l,d),function(l,c){const d=[...l.breadcrumbs||[],...c];l.breadcrumbs=d.length?d:void 0}(l,p),function(l,c){l.sdkProcessingMetadata={...l.sdkProcessingMetadata,...c}}(l,f)}function mergeScopeData(l,c){const{extra:d,tags:h,user:p,contexts:f,level:m,sdkProcessingMetadata:y,breadcrumbs:_,fingerprint:b,eventProcessors:w,attachments:E,propagationContext:M,transactionName:N,span:P}=c;mergeAndOverwriteScopeData(l,"extra",d),mergeAndOverwriteScopeData(l,"tags",h),mergeAndOverwriteScopeData(l,"user",p),mergeAndOverwriteScopeData(l,"contexts",f),mergeAndOverwriteScopeData(l,"sdkProcessingMetadata",y),m&&(l.level=m),N&&(l.transactionName=N),P&&(l.span=P),_.length&&(l.breadcrumbs=[...l.breadcrumbs,..._]),b.length&&(l.fingerprint=[...l.fingerprint,...b]),w.length&&(l.eventProcessors=[...l.eventProcessors,...w]),E.length&&(l.attachments=[...l.attachments,...E]),l.propagationContext={...l.propagationContext,...M}}function mergeAndOverwriteScopeData(l,c,d){if(d&&Object.keys(d).length){l[c]={...l[c]};for(const h in d)Object.prototype.hasOwnProperty.call(d,h)&&(l[c][h]=d[h])}}let yw;class Scope{constructor(){this._notifyingListeners=!1,this._scopeListeners=[],this._eventProcessors=[],this._breadcrumbs=[],this._attachments=[],this._user={},this._tags={},this._extra={},this._contexts={},this._sdkProcessingMetadata={},this._propagationContext=generatePropagationContext()}static clone(l){return l?l.clone():new Scope}clone(){const l=new Scope;return l._breadcrumbs=[...this._breadcrumbs],l._tags={...this._tags},l._extra={...this._extra},l._contexts={...this._contexts},l._user=this._user,l._level=this._level,l._span=this._span,l._session=this._session,l._transactionName=this._transactionName,l._fingerprint=this._fingerprint,l._eventProcessors=[...this._eventProcessors],l._requestSession=this._requestSession,l._attachments=[...this._attachments],l._sdkProcessingMetadata={...this._sdkProcessingMetadata},l._propagationContext={...this._propagationContext},l._client=this._client,l}setClient(l){this._client=l}getClient(){return this._client}addScopeListener(l){this._scopeListeners.push(l)}addEventProcessor(l){return this._eventProcessors.push(l),this}setUser(l){return this._user=l||{email:void 0,id:void 0,ip_address:void 0,segment:void 0,username:void 0},this._session&&updateSession(this._session,{user:l}),this._notifyScopeListeners(),this}getUser(){return this._user}getRequestSession(){return this._requestSession}setRequestSession(l){return this._requestSession=l,this}setTags(l){return this._tags={...this._tags,...l},this._notifyScopeListeners(),this}setTag(l,c){return this._tags={...this._tags,[l]:c},this._notifyScopeListeners(),this}setExtras(l){return this._extra={...this._extra,...l},this._notifyScopeListeners(),this}setExtra(l,c){return this._extra={...this._extra,[l]:c},this._notifyScopeListeners(),this}setFingerprint(l){return this._fingerprint=l,this._notifyScopeListeners(),this}setLevel(l){return this._level=l,this._notifyScopeListeners(),this}setTransactionName(l){return this._transactionName=l,this._notifyScopeListeners(),this}setContext(l,c){return null===c?delete this._contexts[l]:this._contexts[l]=c,this._notifyScopeListeners(),this}setSpan(l){return this._span=l,this._notifyScopeListeners(),this}getSpan(){return this._span}getTransaction(){const l=this._span;return l&&l.transaction}setSession(l){return l?this._session=l:delete this._session,this._notifyScopeListeners(),this}getSession(){return this._session}update(l){if(!l)return this;const c="function"==typeof l?l(this):l;if(c instanceof Scope){const l=c.getScopeData();this._tags={...this._tags,...l.tags},this._extra={...this._extra,...l.extra},this._contexts={...this._contexts,...l.contexts},l.user&&Object.keys(l.user).length&&(this._user=l.user),l.level&&(this._level=l.level),l.fingerprint.length&&(this._fingerprint=l.fingerprint),c.getRequestSession()&&(this._requestSession=c.getRequestSession()),l.propagationContext&&(this._propagationContext=l.propagationContext)}else if(isPlainObject$3(c)){const c=l;this._tags={...this._tags,...c.tags},this._extra={...this._extra,...c.extra},this._contexts={...this._contexts,...c.contexts},c.user&&(this._user=c.user),c.level&&(this._level=c.level),c.fingerprint&&(this._fingerprint=c.fingerprint),c.requestSession&&(this._requestSession=c.requestSession),c.propagationContext&&(this._propagationContext=c.propagationContext)}return this}clear(){return this._breadcrumbs=[],this._tags={},this._extra={},this._user={},this._contexts={},this._level=void 0,this._transactionName=void 0,this._fingerprint=void 0,this._requestSession=void 0,this._span=void 0,this._session=void 0,this._notifyScopeListeners(),this._attachments=[],this._propagationContext=generatePropagationContext(),this}addBreadcrumb(l,c){const d="number"==typeof c?c:100;if(d<=0)return this;const h={timestamp:dateTimestampInSeconds(),...l},p=this._breadcrumbs;return p.push(h),this._breadcrumbs=p.length>d?p.slice(-d):p,this._notifyScopeListeners(),this}getLastBreadcrumb(){return this._breadcrumbs[this._breadcrumbs.length-1]}clearBreadcrumbs(){return this._breadcrumbs=[],this._notifyScopeListeners(),this}addAttachment(l){return this._attachments.push(l),this}getAttachments(){return this.getScopeData().attachments}clearAttachments(){return this._attachments=[],this}getScopeData(){const{_breadcrumbs:l,_attachments:c,_contexts:d,_tags:h,_extra:p,_user:f,_level:m,_fingerprint:y,_eventProcessors:_,_propagationContext:b,_sdkProcessingMetadata:w,_transactionName:E,_span:M}=this;return{breadcrumbs:l,attachments:c,contexts:d,tags:h,extra:p,user:f,level:m,fingerprint:y||[],eventProcessors:_,propagationContext:b,sdkProcessingMetadata:w,transactionName:E,span:M}}applyToEvent(l,c={},d=[]){applyScopeDataToEvent(l,this.getScopeData());return notifyEventProcessors([...d,...getGlobalEventProcessors(),...this._eventProcessors],l,c)}setSDKProcessingMetadata(l){return this._sdkProcessingMetadata={...this._sdkProcessingMetadata,...l},this}setPropagationContext(l){return this._propagationContext=l,this}getPropagationContext(){return this._propagationContext}captureException(l,c){const d=c&&c.event_id?c.event_id:uuid4();if(!this._client)return Bb.warn("No client configured on scope - will not capture exception!"),d;const h=new Error("Sentry syntheticException");return this._client.captureException(l,{originalException:l,syntheticException:h,...c,event_id:d},this),d}captureMessage(l,c,d){const h=d&&d.event_id?d.event_id:uuid4();if(!this._client)return Bb.warn("No client configured on scope - will not capture message!"),h;const p=new Error(l);return this._client.captureMessage(l,c,{originalException:l,syntheticException:p,...d,event_id:h},this),h}captureEvent(l,c){const d=c&&c.event_id?c.event_id:uuid4();return this._client?(this._client.captureEvent(l,{...c,event_id:d},this),d):(Bb.warn("No client configured on scope - will not capture event!"),d)}_notifyScopeListeners(){this._notifyingListeners||(this._notifyingListeners=!0,this._scopeListeners.forEach((l=>{l(this)})),this._notifyingListeners=!1)}}function generatePropagationContext(){return{traceId:uuid4(),spanId:uuid4().substring(16)}}const _w="7.120.3",bw=parseFloat(_w),ww=100;class Hub{constructor(l,c,d,h=bw){let p,f;this._version=h,c?p=c:(p=new Scope,p.setClient(l)),d?f=d:(f=new Scope,f.setClient(l)),this._stack=[{scope:p}],l&&this.bindClient(l),this._isolationScope=f}isOlderThan(l){return this._version<l}bindClient(l){const c=this.getStackTop();c.client=l,c.scope.setClient(l),l&&l.setupIntegrations&&l.setupIntegrations()}pushScope(){const l=this.getScope().clone();return this.getStack().push({client:this.getClient(),scope:l}),l}popScope(){return!(this.getStack().length<=1)&&!!this.getStack().pop()}withScope(l){const c=this.pushScope();let d;try{d=l(c)}catch(hh){throw this.popScope(),hh}return isThenable(d)?d.then((l=>(this.popScope(),l)),(l=>{throw this.popScope(),l})):(this.popScope(),d)}getClient(){return this.getStackTop().client}getScope(){return this.getStackTop().scope}getIsolationScope(){return this._isolationScope}getStack(){return this._stack}getStackTop(){return this._stack[this._stack.length-1]}captureException(l,c){const d=this._lastEventId=c&&c.event_id?c.event_id:uuid4(),h=new Error("Sentry syntheticException");return this.getScope().captureException(l,{originalException:l,syntheticException:h,...c,event_id:d}),d}captureMessage(l,c,d){const h=this._lastEventId=d&&d.event_id?d.event_id:uuid4(),p=new Error(l);return this.getScope().captureMessage(l,c,{originalException:l,syntheticException:p,...d,event_id:h}),h}captureEvent(l,c){const d=c&&c.event_id?c.event_id:uuid4();return l.type||(this._lastEventId=d),this.getScope().captureEvent(l,{...c,event_id:d}),d}lastEventId(){return this._lastEventId}addBreadcrumb(l,c){const{scope:d,client:h}=this.getStackTop();if(!h)return;const{beforeBreadcrumb:p=null,maxBreadcrumbs:f=ww}=h.getOptions&&h.getOptions()||{};if(f<=0)return;const m={timestamp:dateTimestampInSeconds(),...l},y=p?consoleSandbox((()=>p(m,c))):m;null!==y&&(h.emit&&h.emit("beforeAddBreadcrumb",y,c),d.addBreadcrumb(y,f))}setUser(l){this.getScope().setUser(l),this.getIsolationScope().setUser(l)}setTags(l){this.getScope().setTags(l),this.getIsolationScope().setTags(l)}setExtras(l){this.getScope().setExtras(l),this.getIsolationScope().setExtras(l)}setTag(l,c){this.getScope().setTag(l,c),this.getIsolationScope().setTag(l,c)}setExtra(l,c){this.getScope().setExtra(l,c),this.getIsolationScope().setExtra(l,c)}setContext(l,c){this.getScope().setContext(l,c),this.getIsolationScope().setContext(l,c)}configureScope(l){const{scope:c,client:d}=this.getStackTop();d&&l(c)}run(l){const c=makeMain(this);try{l(this)}finally{makeMain(c)}}getIntegration(l){const c=this.getClient();if(!c)return null;try{return c.getIntegration(l)}catch(d){return mw&&Bb.warn(`Cannot retrieve integration ${l.id} from the current Hub`),null}}startTransaction(l,c){const d=this._callExtensionMethod("startTransaction",l,c);if(mw&&!d){this.getClient()?Bb.warn("Tracing extension 'startTransaction' has not been added. Call 'addTracingExtensions' before calling 'init':\nSentry.addTracingExtensions();\nSentry.init({...});\n"):Bb.warn("Tracing extension 'startTransaction' is missing. You should 'init' the SDK before calling 'startTransaction'")}return d}traceHeaders(){return this._callExtensionMethod("traceHeaders")}captureSession(l=!1){if(l)return this.endSession();this._sendSessionUpdate()}endSession(){const l=this.getStackTop().scope,c=l.getSession();c&&closeSession(c),this._sendSessionUpdate(),l.setSession()}startSession(l){const{scope:c,client:d}=this.getStackTop(),{release:h,environment:p=gw}=d&&d.getOptions()||{},{userAgent:f}=jb.navigator||{},m=makeSession$1({release:h,environment:p,user:c.getUser(),...f&&{userAgent:f},...l}),y=c.getSession&&c.getSession();return y&&"ok"===y.status&&updateSession(y,{status:"exited"}),this.endSession(),c.setSession(m),m}shouldSendDefaultPii(){const l=this.getClient(),c=l&&l.getOptions();return Boolean(c&&c.sendDefaultPii)}_sendSessionUpdate(){const{scope:l,client:c}=this.getStackTop(),d=l.getSession();d&&c&&c.captureSession&&c.captureSession(d)}_callExtensionMethod(l,...c){const d=getMainCarrier().__SENTRY__;if(d&&d.extensions&&"function"==typeof d.extensions[l])return d.extensions[l].apply(this,c);mw&&Bb.warn(`Extension method ${l} couldn't be found, doing nothing.`)}}function getMainCarrier(){return jb.__SENTRY__=jb.__SENTRY__||{extensions:{},hub:void 0},jb}function makeMain(l){const c=getMainCarrier(),d=getHubFromCarrier(c);return setHubOnCarrier(c,l),d}function getCurrentHub(){const l=getMainCarrier();if(l.__SENTRY__&&l.__SENTRY__.acs){const c=l.__SENTRY__.acs.getCurrentHub();if(c)return c}return function(l=getMainCarrier()){c=l,c&&c.__SENTRY__&&c.__SENTRY__.hub&&!getHubFromCarrier(l).isOlderThan(bw)||setHubOnCarrier(l,new Hub);var c;return getHubFromCarrier(l)}(l)}function getIsolationScope(){return getCurrentHub().getIsolationScope()}function getHubFromCarrier(l){return getGlobalSingleton("hub",(()=>new Hub),l)}function setHubOnCarrier(l,c){if(!l)return!1;return(l.__SENTRY__=l.__SENTRY__||{}).hub=c,!0}function getActiveTransaction(l){return getCurrentHub().getScope().getTransaction()}let Sw=!1;function errorCallback(){const l=getActiveTransaction();if(l){const c="internal_error";mw&&Bb.log(`[Tracing] Transaction: ${c} -> Global error occured`),l.setStatus(c)}}var xw;function setHttpStatus(l,c){l.setTag("http.status_code",String(c)),l.setData("http.response.status_code",c);const d=function(l){if(l<400&&l>=100)return"ok";if(l>=400&&l<500)switch(l){case 401:return"unauthenticated";case 403:return"permission_denied";case 404:return"not_found";case 409:return"already_exists";case 413:return"failed_precondition";case 429:return"resource_exhausted";default:return"invalid_argument"}if(l>=500&&l<600)switch(l){case 501:return"unimplemented";case 503:return"unavailable";case 504:return"deadline_exceeded";default:return"internal_error"}return"unknown_error"}(c);"unknown_error"!==d&&l.setStatus(d)}function hasTracingEnabled(l){if("boolean"==typeof __SENTRY_TRACING__&&!__SENTRY_TRACING__)return!1;const c=getClient(),d=l||c&&c.getOptions();return!!d&&(d.enableTracing||"tracesSampleRate"in d||"tracesSampler"in d)}function startInactiveSpan(l){if(!hasTracingEnabled())return;const c=function(l){if(l.startTime){const c={...l};return c.startTimestamp=spanTimeInputToSeconds(l.startTime),delete c.startTime,c}return l}(l),d=getCurrentHub(),h=l.scope?l.scope.getSpan():getCurrentScope$1().getSpan();if(l.onlyIfParent&&!h)return;const p=(l.scope||getCurrentScope$1()).clone();return function(l,{parentSpan:c,spanContext:d,forceTransaction:h,scope:p}){if(!hasTracingEnabled())return;const f=getIsolationScope();let m;if(c&&!h)m=c.startChild(d);else if(c){const h=getDynamicSamplingContextFromSpan(c),{traceId:p,spanId:f}=c.spanContext(),y=spanIsSampled(c);m=l.startTransaction({traceId:p,parentSpanId:f,parentSampled:y,...d,metadata:{dynamicSamplingContext:h,...d.metadata}})}else{const{traceId:c,dsc:h,parentSpanId:y,sampled:_}={...f.getPropagationContext(),...p.getPropagationContext()};m=l.startTransaction({traceId:c,parentSpanId:y,parentSampled:_,...d,metadata:{dynamicSamplingContext:h,...d.metadata}})}return p.setSpan(m),function(l,c,d){l&&(addNonEnumerableProperty(l,Cw,d),addNonEnumerableProperty(l,kw,c))}(m,p,f),m}(d,{parentSpan:h,spanContext:c,forceTransaction:l.forceTransaction,scope:p})}errorCallback.tag="sentry_tracingErrorCallback",function(l){l.Ok="ok";l.DeadlineExceeded="deadline_exceeded";l.Unauthenticated="unauthenticated";l.PermissionDenied="permission_denied";l.NotFound="not_found";l.ResourceExhausted="resource_exhausted";l.InvalidArgument="invalid_argument";l.Unimplemented="unimplemented";l.Unavailable="unavailable";l.InternalError="internal_error";l.UnknownError="unknown_error";l.Cancelled="cancelled";l.AlreadyExists="already_exists";l.FailedPrecondition="failed_precondition";l.Aborted="aborted";l.OutOfRange="out_of_range";l.DataLoss="data_loss"}(xw||(xw={}));const kw="_sentryScope",Cw="_sentryIsolationScope";const Ew="sentry.source",Iw="sentry.sample_rate",Tw="sentry.op",Rw="sentry.origin";class SpanRecorder{constructor(l=1e3){this._maxlen=l,this.spans=[]}add(l){this.spans.length>this._maxlen?l.spanRecorder=void 0:this.spans.push(l)}}class Span{constructor(l={}){this._traceId=l.traceId||uuid4(),this._spanId=l.spanId||uuid4().substring(16),this._startTime=l.startTimestamp||lw(),this.tags=l.tags?{...l.tags}:{},this.data=l.data?{...l.data}:{},this.instrumenter=l.instrumenter||"sentry",this._attributes={},this.setAttributes({[Rw]:l.origin||"manual",[Tw]:l.op,...l.attributes}),this._name=l.name||l.description,l.parentSpanId&&(this._parentSpanId=l.parentSpanId),"sampled"in l&&(this._sampled=l.sampled),l.status&&(this._status=l.status),l.endTimestamp&&(this._endTime=l.endTimestamp),void 0!==l.exclusiveTime&&(this._exclusiveTime=l.exclusiveTime),this._measurements=l.measurements?{...l.measurements}:{}}get name(){return this._name||""}set name(l){this.updateName(l)}get description(){return this._name}set description(l){this._name=l}get traceId(){return this._traceId}set traceId(l){this._traceId=l}get spanId(){return this._spanId}set spanId(l){this._spanId=l}set parentSpanId(l){this._parentSpanId=l}get parentSpanId(){return this._parentSpanId}get sampled(){return this._sampled}set sampled(l){this._sampled=l}get attributes(){return this._attributes}set attributes(l){this._attributes=l}get startTimestamp(){return this._startTime}set startTimestamp(l){this._startTime=l}get endTimestamp(){return this._endTime}set endTimestamp(l){this._endTime=l}get status(){return this._status}set status(l){this._status=l}get op(){return this._attributes[Tw]}set op(l){this.setAttribute(Tw,l)}get origin(){return this._attributes[Rw]}set origin(l){this.setAttribute(Rw,l)}spanContext(){const{_spanId:l,_traceId:c,_sampled:d}=this;return{spanId:l,traceId:c,traceFlags:d?1:0}}startChild(l){const c=new Span({...l,parentSpanId:this._spanId,sampled:this._sampled,traceId:this._traceId});c.spanRecorder=this.spanRecorder,c.spanRecorder&&c.spanRecorder.add(c);const d=getRootSpan(this);if(c.transaction=d,mw&&d){const h=`[Tracing] Starting '${l&&l.op||"< unknown op >"}' span on transaction '${spanToJSON(c).description||"< unknown name >"}' (${d.spanContext().spanId}).`;Bb.log(h),this._logMessage=h}return c}setTag(l,c){return this.tags={...this.tags,[l]:c},this}setData(l,c){return this.data={...this.data,[l]:c},this}setAttribute(l,c){void 0===c?delete this._attributes[l]:this._attributes[l]=c}setAttributes(l){Object.keys(l).forEach((c=>this.setAttribute(c,l[c])))}setStatus(l){return this._status=l,this}setHttpStatus(l){return setHttpStatus(this,l),this}setName(l){this.updateName(l)}updateName(l){return this._name=l,this}isSuccess(){return"ok"===this._status}finish(l){return this.end(l)}end(l){if(this._endTime)return;const c=getRootSpan(this);if(mw&&c&&c.spanContext().spanId!==this._spanId){const l=this._logMessage;l&&Bb.log(l.replace("Starting","Finishing"))}this._endTime=spanTimeInputToSeconds(l)}toTraceparent(){return spanToTraceHeader(this)}toContext(){return dropUndefinedKeys({data:this._getData(),description:this._name,endTimestamp:this._endTime,op:this.op,parentSpanId:this._parentSpanId,sampled:this._sampled,spanId:this._spanId,startTimestamp:this._startTime,status:this._status,tags:this.tags,traceId:this._traceId})}updateWithContext(l){return this.data=l.data||{},this._name=l.name||l.description,this._endTime=l.endTimestamp,this.op=l.op,this._parentSpanId=l.parentSpanId,this._sampled=l.sampled,this._spanId=l.spanId||this._spanId,this._startTime=l.startTimestamp||this._startTime,this._status=l.status,this.tags=l.tags||{},this._traceId=l.traceId||this._traceId,this}getTraceContext(){return spanToTraceContext(this)}getSpanJSON(){return dropUndefinedKeys({data:this._getData(),description:this._name,op:this._attributes[Tw],parent_span_id:this._parentSpanId,span_id:this._spanId,start_timestamp:this._startTime,status:this._status,tags:Object.keys(this.tags).length>0?this.tags:void 0,timestamp:this._endTime,trace_id:this._traceId,origin:this._attributes[Rw],_metrics_summary:void 0,profile_id:this._attributes.profile_id,exclusive_time:this._exclusiveTime,measurements:Object.keys(this._measurements).length>0?this._measurements:void 0})}isRecording(){return!this._endTime&&!!this._sampled}toJSON(){return this.getSpanJSON()}_getData(){const{data:l,_attributes:c}=this,d=Object.keys(l).length>0,h=Object.keys(c).length>0;if(d||h)return d&&h?{...l,...c}:d?l:c}}class Transaction extends Span{constructor(l,c){super(l),this._contexts={},this._hub=c||getCurrentHub(),this._name=l.name||"",this._metadata={...l.metadata},this._trimEnd=l.trimEnd,this.transaction=this;const d=this._metadata.dynamicSamplingContext;d&&(this._frozenDynamicSamplingContext={...d})}get name(){return this._name}set name(l){this.setName(l)}get metadata(){return{source:"custom",spanMetadata:{},...this._metadata,...this._attributes[Ew]&&{source:this._attributes[Ew]},...this._attributes[Iw]&&{sampleRate:this._attributes[Iw]}}}set metadata(l){this._metadata=l}setName(l,c="custom"){this._name=l,this.setAttribute(Ew,c)}updateName(l){return this._name=l,this}initSpanRecorder(l=1e3){this.spanRecorder||(this.spanRecorder=new SpanRecorder(l)),this.spanRecorder.add(this)}setContext(l,c){null===c?delete this._contexts[l]:this._contexts[l]=c}setMeasurement(l,c,d=""){this._measurements[l]={value:c,unit:d}}setMetadata(l){this._metadata={...this._metadata,...l}}end(l){const c=spanTimeInputToSeconds(l),d=this._finishTransaction(c);if(d)return this._hub.captureEvent(d)}toContext(){return dropUndefinedKeys({...super.toContext(),name:this._name,trimEnd:this._trimEnd})}updateWithContext(l){return super.updateWithContext(l),this._name=l.name||"",this._trimEnd=l.trimEnd,this}getDynamicSamplingContext(){return getDynamicSamplingContextFromSpan(this)}setHub(l){this._hub=l}getProfileId(){if(void 0!==this._contexts&&void 0!==this._contexts.profile)return this._contexts.profile.profile_id}_finishTransaction(l){if(void 0!==this._endTime)return;this._name||(mw&&Bb.warn("Transaction has no name, falling back to `<unlabeled transaction>`."),this._name="<unlabeled transaction>"),super.end(l);const c=this._hub.getClient();if(c&&c.emit&&c.emit("finishTransaction",this),!0!==this._sampled)return mw&&Bb.log("[Tracing] Discarding transaction because its trace was not chosen to be sampled."),void(c&&c.recordDroppedEvent("sample_rate","transaction"));const d=this.spanRecorder?this.spanRecorder.spans.filter((l=>l!==this&&spanToJSON(l).timestamp)):[];if(this._trimEnd&&d.length>0){const l=d.map((l=>spanToJSON(l).timestamp)).filter(Boolean);this._endTime=l.reduce(((l,c)=>l>c?l:c))}const{scope:h,isolationScope:p}={scope:(f=this)[kw],isolationScope:f[Cw]};var f;const{metadata:m}=this,{source:y}=m,_={contexts:{...this._contexts,trace:spanToTraceContext(this)},spans:d,start_timestamp:this._startTime,tags:this.tags,timestamp:this._endTime,transaction:this._name,type:"transaction",sdkProcessingMetadata:{...m,capturedSpanScope:h,capturedSpanIsolationScope:p,...dropUndefinedKeys({dynamicSamplingContext:getDynamicSamplingContextFromSpan(this)})},_metrics_summary:void 0,...y&&{transaction_info:{source:y}}};return Object.keys(this._measurements).length>0&&(mw&&Bb.log("[Measurements] Adding measurements to transaction",JSON.stringify(this._measurements,void 0,2)),_.measurements=this._measurements),mw&&Bb.log(`[Tracing] Finishing ${this.op} transaction: ${this._name}.`),_}}const Aw={idleTimeout:1e3,finalTimeout:3e4,heartbeatInterval:5e3},Ow=["heartbeatFailed","idleTimeout","documentHidden","finalTimeout","externalFinish","cancelled"];class IdleTransactionSpanRecorder extends SpanRecorder{constructor(l,c,d,h){super(h),this._pushActivity=l,this._popActivity=c,this.transactionSpanId=d}add(l){if(l.spanContext().spanId!==this.transactionSpanId){const c=l.end;l.end=(...d)=>(this._popActivity(l.spanContext().spanId),c.apply(l,d)),void 0===spanToJSON(l).timestamp&&this._pushActivity(l.spanContext().spanId)}super.add(l)}}class IdleTransaction extends Transaction{constructor(l,c,d=Aw.idleTimeout,h=Aw.finalTimeout,p=Aw.heartbeatInterval,f=!1,m=!1){super(l,c),this._idleHub=c,this._idleTimeout=d,this._finalTimeout=h,this._heartbeatInterval=p,this._onScope=f,this.activities={},this._heartbeatCounter=0,this._finished=!1,this._idleTimeoutCanceledPermanently=!1,this._beforeFinishCallbacks=[],this._finishReason=Ow[4],this._autoFinishAllowed=!m,f&&(mw&&Bb.log(`Setting idle transaction on scope. Span ID: ${this.spanContext().spanId}`),c.getScope().setSpan(this)),m||this._restartIdleTimeout(),setTimeout((()=>{this._finished||(this.setStatus("deadline_exceeded"),this._finishReason=Ow[3],this.end())}),this._finalTimeout)}end(l){const c=spanTimeInputToSeconds(l);if(this._finished=!0,this.activities={},"ui.action.click"===this.op&&this.setAttribute("finishReason",this._finishReason),this.spanRecorder){mw&&Bb.log("[Tracing] finishing IdleTransaction",new Date(1e3*c).toISOString(),this.op);for(const l of this._beforeFinishCallbacks)l(this,c);this.spanRecorder.spans=this.spanRecorder.spans.filter((l=>{if(l.spanContext().spanId===this.spanContext().spanId)return!0;spanToJSON(l).timestamp||(l.setStatus("cancelled"),l.end(c),mw&&Bb.log("[Tracing] cancelling span since transaction ended early",JSON.stringify(l,void 0,2)));const{start_timestamp:d,timestamp:h}=spanToJSON(l),p=d&&d<c,f=(this._finalTimeout+this._idleTimeout)/1e3,m=h&&d&&h-d<f;if(mw){const c=JSON.stringify(l,void 0,2);p?m||Bb.log("[Tracing] discarding Span since it finished after Transaction final timeout",c):Bb.log("[Tracing] discarding Span since it happened after Transaction was finished",c)}return p&&m})),mw&&Bb.log("[Tracing] flushing IdleTransaction")}else mw&&Bb.log("[Tracing] No active IdleTransaction");if(this._onScope){const l=this._idleHub.getScope();l.getTransaction()===this&&l.setSpan(void 0)}return super.end(l)}registerBeforeFinishCallback(l){this._beforeFinishCallbacks.push(l)}initSpanRecorder(l){if(!this.spanRecorder){const pushActivity=l=>{this._finished||this._pushActivity(l)},popActivity=l=>{this._finished||this._popActivity(l)};this.spanRecorder=new IdleTransactionSpanRecorder(pushActivity,popActivity,this.spanContext().spanId,l),mw&&Bb.log("Starting heartbeat"),this._pingHeartbeat()}this.spanRecorder.add(this)}cancelIdleTimeout(l,{restartOnChildSpanChange:c}={restartOnChildSpanChange:!0}){this._idleTimeoutCanceledPermanently=!1===c,this._idleTimeoutID&&(clearTimeout(this._idleTimeoutID),this._idleTimeoutID=void 0,0===Object.keys(this.activities).length&&this._idleTimeoutCanceledPermanently&&(this._finishReason=Ow[5],this.end(l)))}setFinishReason(l){this._finishReason=l}sendAutoFinishSignal(){this._autoFinishAllowed||(mw&&Bb.log("[Tracing] Received finish signal for idle transaction."),this._restartIdleTimeout(),this._autoFinishAllowed=!0)}_restartIdleTimeout(l){this.cancelIdleTimeout(),this._idleTimeoutID=setTimeout((()=>{this._finished||0!==Object.keys(this.activities).length||(this._finishReason=Ow[1],this.end(l))}),this._idleTimeout)}_pushActivity(l){this.cancelIdleTimeout(void 0,{restartOnChildSpanChange:!this._idleTimeoutCanceledPermanently}),mw&&Bb.log(`[Tracing] pushActivity: ${l}`),this.activities[l]=!0,mw&&Bb.log("[Tracing] new activities count",Object.keys(this.activities).length)}_popActivity(l){if(this.activities[l]&&(mw&&Bb.log(`[Tracing] popActivity ${l}`),delete this.activities[l],mw&&Bb.log("[Tracing] new activities count",Object.keys(this.activities).length)),0===Object.keys(this.activities).length){const l=lw();this._idleTimeoutCanceledPermanently?this._autoFinishAllowed&&(this._finishReason=Ow[5],this.end(l)):this._restartIdleTimeout(l+this._idleTimeout/1e3)}}_beat(){if(this._finished)return;const l=Object.keys(this.activities).join("");l===this._prevHeartbeatString?this._heartbeatCounter++:this._heartbeatCounter=1,this._prevHeartbeatString=l,this._heartbeatCounter>=3?this._autoFinishAllowed&&(mw&&Bb.log("[Tracing] Transaction finished because of no change for 3 heart beats"),this.setStatus("deadline_exceeded"),this._finishReason=Ow[0],this.end()):this._pingHeartbeat()}_pingHeartbeat(){mw&&Bb.log(`pinging Heartbeat -> current counter: ${this._heartbeatCounter}`),setTimeout((()=>{this._beat()}),this._heartbeatInterval)}}function sampleTransaction(l,c,d){if(!hasTracingEnabled(c))return l.sampled=!1,l;if(void 0!==l.sampled)return l.setAttribute(Iw,Number(l.sampled)),l;let h;return"function"==typeof c.tracesSampler?(h=c.tracesSampler(d),l.setAttribute(Iw,Number(h))):void 0!==d.parentSampled?h=d.parentSampled:void 0!==c.tracesSampleRate?(h=c.tracesSampleRate,l.setAttribute(Iw,Number(h))):(h=1,l.setAttribute(Iw,h)),isValidSampleRate(h)?h?(l.sampled=Math.random()<h,l.sampled?(mw&&Bb.log(`[Tracing] starting ${l.op} transaction - ${spanToJSON(l).description}`),l):(mw&&Bb.log(`[Tracing] Discarding transaction because it's not included in the random sample (sampling rate = ${Number(h)})`),l)):(mw&&Bb.log("[Tracing] Discarding transaction because "+("function"==typeof c.tracesSampler?"tracesSampler returned 0 or false":"a negative sampling decision was inherited or tracesSampleRate is set to 0")),l.sampled=!1,l):(mw&&Bb.warn("[Tracing] Discarding transaction because of invalid sample rate."),l.sampled=!1,l)}function isValidSampleRate(l){return isNaN$1(l)||"number"!=typeof l&&"boolean"!=typeof l?(mw&&Bb.warn(`[Tracing] Given sample rate is invalid. Sample rate must be a boolean or a number between 0 and 1. Got ${JSON.stringify(l)} of type ${JSON.stringify(typeof l)}.`),!1):!(l<0||l>1)||(mw&&Bb.warn(`[Tracing] Given sample rate is invalid. Sample rate must be between 0 and 1. Got ${l}.`),!1)}function traceHeaders(){const l=this.getScope().getSpan();return l?{"sentry-trace":spanToTraceHeader(l)}:{}}function _startTransaction(l,c){const d=this.getClient(),h=d&&d.getOptions()||{},p=h.instrumenter||"sentry",f=l.instrumenter||"sentry";p!==f&&(mw&&Bb.error(`A transaction was started with instrumenter=\`${f}\`, but the SDK is configured with the \`${p}\` instrumenter.\nThe transaction will not be sampled. Please use the ${p} instrumentation to start transactions.`),l.sampled=!1);let m=new Transaction(l,this);return m=sampleTransaction(m,h,{name:l.name,parentSampled:l.parentSampled,transactionContext:l,attributes:{...l.data,...l.attributes},...c}),m.isRecording()&&m.initSpanRecorder(h._experiments&&h._experiments.maxSpans),d&&d.emit&&d.emit("startTransaction",m),m}function startIdleTransaction(l,c,d,h,p,f,m,y=!1){const _=l.getClient(),b=_&&_.getOptions()||{};let w=new IdleTransaction(c,l,d,h,m,p,y);return w=sampleTransaction(w,b,{name:c.name,parentSampled:c.parentSampled,transactionContext:c,attributes:{...c.data,...c.attributes},...f}),w.isRecording()&&w.initSpanRecorder(b._experiments&&b._experiments.maxSpans),_&&_.emit&&_.emit("startTransaction",w),w}function addTracingExtensions(){const l=getMainCarrier();l.__SENTRY__&&(l.__SENTRY__.extensions=l.__SENTRY__.extensions||{},l.__SENTRY__.extensions.startTransaction||(l.__SENTRY__.extensions.startTransaction=_startTransaction),l.__SENTRY__.extensions.traceHeaders||(l.__SENTRY__.extensions.traceHeaders=traceHeaders),Sw||(Sw=!0,addGlobalErrorInstrumentationHandler(errorCallback),addGlobalUnhandledRejectionInstrumentationHandler(errorCallback)))}function _encodedAuth(l,c){return d={sentry_key:l.publicKey,sentry_version:"7",...c&&{sentry_client:`${c.name}/${c.version}`}},Object.keys(d).map((l=>`${encodeURIComponent(l)}=${encodeURIComponent(d[l])}`)).join("&");var d}const Mw=[];function getIntegrationsToSetup(l){const c=l.defaultIntegrations||[],d=l.integrations;let h;c.forEach((l=>{l.isDefaultInstance=!0})),h=Array.isArray(d)?[...c,...d]:"function"==typeof d?arrayify(d(c)):c;const p=function(l){const c={};return l.forEach((l=>{const{name:d}=l,h=c[d];h&&!h.isDefaultInstance&&l.isDefaultInstance||(c[d]=l)})),Object.keys(c).map((l=>c[l]))}(h),f=function(l,c){for(let d=0;d<l.length;d++)if(!0===c(l[d]))return d;return-1}(p,(l=>"Debug"===l.name));if(-1!==f){const[l]=p.splice(f,1);p.push(l)}return p}function afterSetupIntegrations(l,c){for(const d of c)d&&d.afterAllSetup&&d.afterAllSetup(l)}function setupIntegration(l,c,d){if(d[c.name])mw&&Bb.log(`Integration skipped because it was already installed: ${c.name}`);else{if(d[c.name]=c,-1===Mw.indexOf(c.name)&&(c.setupOnce(addGlobalEventProcessor,getCurrentHub),Mw.push(c.name)),c.setup&&"function"==typeof c.setup&&c.setup(l),l.on&&"function"==typeof c.preprocessEvent){const d=c.preprocessEvent.bind(c);l.on("preprocessEvent",((c,h)=>d(c,h,l)))}if(l.addEventProcessor&&"function"==typeof c.processEvent){const d=c.processEvent.bind(c),h=Object.assign(((c,h)=>d(c,h,l)),{id:c.name});l.addEventProcessor(h)}mw&&Bb.log(`Integration installed: ${c.name}`)}}function convertIntegrationFnToClass(l,c){return Object.assign((function(...l){return c(...l)}),{id:l})}function createMetricEnvelope(l,c,d,h){const p={sent_at:(new Date).toISOString()};d&&d.sdk&&(p.sdk={name:d.sdk.name,version:d.sdk.version}),h&&c&&(p.dsn=dsnToString(c));const f=function(l){const c=function(l){let c="";for(const d of l){const l=Object.entries(d.tags),h=l.length>0?`|#${l.map((([l,c])=>`${l}:${c}`)).join(",")}`:"";c+=`${d.name}@${d.unit}:${d.metric}|${d.metricType}${h}|T${d.timestamp}\n`}return c}(l);return[{type:"statsd",length:c.length},c]}(l);return createEnvelope(p,[f])}const Nw="Not capturing exception because it's already been captured.";class BaseClient{constructor(l){if(this._options=l,this._integrations={},this._integrationsInitialized=!1,this._numProcessing=0,this._outcomes={},this._hooks={},this._eventProcessors=[],l.dsn?this._dsn=makeDsn(l.dsn):mw&&Bb.warn("No DSN provided, client will not send events."),this._dsn){const c=function(l,c={}){const d="string"==typeof c?c:c.tunnel,h="string"!=typeof c&&c._metadata?c._metadata.sdk:void 0;return d||`${function(l){return`${function(l){const c=l.protocol?`${l.protocol}:`:"",d=l.port?`:${l.port}`:"";return`${c}//${l.host}${d}${l.path?`/${l.path}`:""}/api/`}(l)}${l.projectId}/envelope/`}(l)}?${_encodedAuth(l,h)}`}(this._dsn,l);this._transport=l.transport({tunnel:this._options.tunnel,recordDroppedEvent:this.recordDroppedEvent.bind(this),...l.transportOptions,url:c})}}captureException(l,c,d){if(checkOrSetAlreadyCaught(l))return void(mw&&Bb.log(Nw));let h=c&&c.event_id;return this._process(this.eventFromException(l,c).then((l=>this._captureEvent(l,c,d))).then((l=>{h=l}))),h}captureMessage(l,c,d,h){let p=d&&d.event_id;const f=isParameterizedString(l)?l:String(l),m=isPrimitive$1(l)?this.eventFromMessage(f,c,d):this.eventFromException(l,d);return this._process(m.then((l=>this._captureEvent(l,d,h))).then((l=>{p=l}))),p}captureEvent(l,c,d){if(c&&c.originalException&&checkOrSetAlreadyCaught(c.originalException))return void(mw&&Bb.log(Nw));let h=c&&c.event_id;const p=(l.sdkProcessingMetadata||{}).capturedSpanScope;return this._process(this._captureEvent(l,c,p||d).then((l=>{h=l}))),h}captureSession(l){"string"!=typeof l.release?mw&&Bb.warn("Discarded session because of missing or non-string release"):(this.sendSession(l),updateSession(l,{init:!1}))}getDsn(){return this._dsn}getOptions(){return this._options}getSdkMetadata(){return this._options._metadata}getTransport(){return this._transport}flush(l){const c=this._transport;return c?(this.metricsAggregator&&this.metricsAggregator.flush(),this._isClientDoneProcessing(l).then((d=>c.flush(l).then((l=>d&&l))))):resolvedSyncPromise(!0)}close(l){return this.flush(l).then((l=>(this.getOptions().enabled=!1,this.metricsAggregator&&this.metricsAggregator.close(),l)))}getEventProcessors(){return this._eventProcessors}addEventProcessor(l){this._eventProcessors.push(l)}setupIntegrations(l){(l&&!this._integrationsInitialized||this._isEnabled()&&!this._integrationsInitialized)&&this._setupIntegrations()}init(){this._isEnabled()&&this._setupIntegrations()}getIntegrationById(l){return this.getIntegrationByName(l)}getIntegrationByName(l){return this._integrations[l]}getIntegration(l){try{return this._integrations[l.id]||null}catch(c){return mw&&Bb.warn(`Cannot retrieve integration ${l.id} from the current Client`),null}}addIntegration(l){const c=this._integrations[l.name];setupIntegration(this,l,this._integrations),c||afterSetupIntegrations(this,[l])}sendEvent(l,c={}){this.emit("beforeSendEvent",l,c);let d=function(l,c,d,h){const p=getSdkMetadataForEnvelopeHeader(d),f=l.type&&"replay_event"!==l.type?l.type:"event";!function(l,c){c&&(l.sdk=l.sdk||{},l.sdk.name=l.sdk.name||c.name,l.sdk.version=l.sdk.version||c.version,l.sdk.integrations=[...l.sdk.integrations||[],...c.integrations||[]],l.sdk.packages=[...l.sdk.packages||[],...c.packages||[]])}(l,d&&d.sdk);const m=createEventEnvelopeHeaders(l,p,h,c);return delete l.sdkProcessingMetadata,createEnvelope(m,[[{type:f},l]])}(l,this._dsn,this._options._metadata,this._options.tunnel);for(const p of c.attachments||[])d=addItemToEnvelope(d,createAttachmentEnvelopeItem(p,this._options.transportOptions&&this._options.transportOptions.textEncoder));const h=this._sendEnvelope(d);h&&h.then((c=>this.emit("afterSendEvent",l,c)),null)}sendSession(l){const c=function(l,c,d,h){const p=getSdkMetadataForEnvelopeHeader(d);return createEnvelope({sent_at:(new Date).toISOString(),...p&&{sdk:p},...!!h&&c&&{dsn:dsnToString(c)}},["aggregates"in l?[{type:"sessions"},l]:[{type:"session"},l.toJSON()]])}(l,this._dsn,this._options._metadata,this._options.tunnel);this._sendEnvelope(c)}recordDroppedEvent(l,c,d){if(this._options.sendClientReports){const h="number"==typeof d?d:1,p=`${l}:${c}`;mw&&Bb.log(`Recording outcome: "${p}"${h>1?` (${h} times)`:""}`),this._outcomes[p]=(this._outcomes[p]||0)+h}}captureAggregateMetrics(l){mw&&Bb.log(`Flushing aggregated metrics, number of metrics: ${l.length}`);const c=createMetricEnvelope(l,this._dsn,this._options._metadata,this._options.tunnel);this._sendEnvelope(c)}on(l,c){this._hooks[l]||(this._hooks[l]=[]),this._hooks[l].push(c)}emit(l,...c){this._hooks[l]&&this._hooks[l].forEach((l=>l(...c)))}_setupIntegrations(){const{integrations:l}=this._options;this._integrations=function(l,c){const d={};return c.forEach((c=>{c&&setupIntegration(l,c,d)})),d}(this,l),afterSetupIntegrations(this,l),this._integrationsInitialized=!0}_updateSessionFromEvent(l,c){let d=!1,h=!1;const p=c.exception&&c.exception.values;if(p){h=!0;for(const l of p){const c=l.mechanism;if(c&&!1===c.handled){d=!0;break}}}const f="ok"===l.status;(f&&0===l.errors||f&&d)&&(updateSession(l,{...d&&{status:"crashed"},errors:l.errors||Number(h||d)}),this.captureSession(l))}_isClientDoneProcessing(l){return new SyncPromise((c=>{let d=0;const h=setInterval((()=>{0==this._numProcessing?(clearInterval(h),c(!0)):(d+=1,l&&d>=l&&(clearInterval(h),c(!1)))}),1)}))}_isEnabled(){return!1!==this.getOptions().enabled&&void 0!==this._transport}_prepareEvent(l,c,d,h=getIsolationScope()){const p=this.getOptions(),f=Object.keys(this._integrations);return!c.integrations&&f.length>0&&(c.integrations=f),this.emit("preprocessEvent",l,c),prepareEvent(p,l,c,d,this,h).then((l=>{if(null===l)return l;const c={...h.getPropagationContext(),...d?d.getPropagationContext():void 0};if(!(l.contexts&&l.contexts.trace)&&c){const{traceId:h,spanId:p,parentSpanId:f,dsc:m}=c;l.contexts={trace:{trace_id:h,span_id:p,parent_span_id:f},...l.contexts};const y=m||getDynamicSamplingContextFromClient(h,this,d);l.sdkProcessingMetadata={dynamicSamplingContext:y,...l.sdkProcessingMetadata}}return l}))}_captureEvent(l,c={},d){return this._processEvent(l,c,d).then((l=>l.event_id),(l=>{if(mw){const c=l;"log"===c.logLevel?Bb.log(c.message):Bb.warn(c)}}))}_processEvent(l,c,d){const h=this.getOptions(),{sampleRate:p}=h,f=isTransactionEvent$1(l),m=isErrorEvent$1(l),y=l.type||"error",_=`before send for type \`${y}\``;if(m&&"number"==typeof p&&Math.random()>p)return this.recordDroppedEvent("sample_rate","error",l),rejectedSyncPromise(new SentryError(`Discarding event because it's not included in the random sample (sampling rate = ${p})`,"log"));const b="replay_event"===y?"replay":y,w=(l.sdkProcessingMetadata||{}).capturedSpanIsolationScope;return this._prepareEvent(l,c,d,w).then((d=>{if(null===d)throw this.recordDroppedEvent("event_processor",b,l),new SentryError("An event processor returned `null`, will not send event.","log");if(c.data&&!0===c.data.__sentry__)return d;const p=function(l,c,d){const{beforeSend:h,beforeSendTransaction:p}=l;if(isErrorEvent$1(c)&&h)return h(c,d);if(isTransactionEvent$1(c)&&p){if(c.spans){const l=c.spans.length;c.sdkProcessingMetadata={...c.sdkProcessingMetadata,spanCountBeforeProcessing:l}}return p(c,d)}return c}(h,d,c);return function(l,c){const d=`${c} must return \`null\` or a valid event.`;if(isThenable(l))return l.then((l=>{if(!isPlainObject$3(l)&&null!==l)throw new SentryError(d);return l}),(l=>{throw new SentryError(`${c} rejected with ${l}`)}));if(!isPlainObject$3(l)&&null!==l)throw new SentryError(d);return l}(p,_)})).then((h=>{if(null===h){if(this.recordDroppedEvent("before_send",b,l),f){const c=1+(l.spans||[]).length;this.recordDroppedEvent("before_send","span",c)}throw new SentryError(`${_} returned \`null\`, will not send event.`,"log")}const p=d&&d.getSession();if(!f&&p&&this._updateSessionFromEvent(p,h),f){const l=(h.sdkProcessingMetadata&&h.sdkProcessingMetadata.spanCountBeforeProcessing||0)-(h.spans?h.spans.length:0);l>0&&this.recordDroppedEvent("before_send","span",l)}const m=h.transaction_info;if(f&&m&&h.transaction!==l.transaction){const l="custom";h.transaction_info={...m,source:l}}return this.sendEvent(h,c),h})).then(null,(l=>{if(l instanceof SentryError)throw l;throw this.captureException(l,{data:{__sentry__:!0},originalException:l}),new SentryError(`Event processing pipeline threw an error, original event will not be sent. Details have been sent as a new event.\nReason: ${l}`)}))}_process(l){this._numProcessing++,l.then((l=>(this._numProcessing--,l)),(l=>(this._numProcessing--,l)))}_sendEnvelope(l){if(this.emit("beforeEnvelope",l),this._isEnabled()&&this._transport)return this._transport.send(l).then(null,(l=>{mw&&Bb.error("Error while sending event:",l)}));mw&&Bb.error("Transport disabled")}_clearOutcomes(){const l=this._outcomes;return this._outcomes={},Object.keys(l).map((c=>{const[d,h]=c.split(":");return{reason:d,category:h,quantity:l[c]}}))}}function isErrorEvent$1(l){return void 0===l.type}function isTransactionEvent$1(l){return"transaction"===l.type}function initAndBind(l,c){!0===c.debug&&(mw?Bb.enable():consoleSandbox((()=>{console.warn("[Sentry] Cannot initialize SDK with `debug` option using a non-debug bundle.")})));getCurrentScope$1().update(c.initialScope);const d=new l(c);!function(l){const c=getCurrentHub().getStackTop();c.client=l,c.scope.setClient(l)}(d),function(l){l.init?l.init():l.setupIntegrations&&l.setupIntegrations()}(d)}function createTransport(l,c,d=makePromiseBuffer(l.bufferSize||30)){let h={};function send(p){const f=[];if(forEachEnvelopeItem(p,((c,d)=>{const p=envelopeItemTypeToDataCategory(d);if(isRateLimited(h,p)){const h=getEventForEnvelopeItem(c,d);l.recordDroppedEvent("ratelimit_backoff",p,h)}else f.push(c)})),0===f.length)return resolvedSyncPromise();const m=createEnvelope(p[0],f),recordEnvelopeLoss=c=>{forEachEnvelopeItem(m,((d,h)=>{const p=getEventForEnvelopeItem(d,h);l.recordDroppedEvent(c,envelopeItemTypeToDataCategory(h),p)}))};return d.add((()=>c({body:serializeEnvelope(m,l.textEncoder)}).then((l=>(void 0!==l.statusCode&&(l.statusCode<200||l.statusCode>=300)&&mw&&Bb.warn(`Sentry responded with status code ${l.statusCode} to sent event.`),h=updateRateLimits(h,l),l)),(l=>{throw recordEnvelopeLoss("network_error"),l})))).then((l=>l),(l=>{if(l instanceof SentryError)return mw&&Bb.error("Skipped sending event because buffer is full."),recordEnvelopeLoss("queue_overflow"),resolvedSyncPromise();throw l}))}return send.__sentry__baseTransport__=!0,{send:send,flush:l=>d.drain(l)}}function getEventForEnvelopeItem(l,c){if("event"===c||"transaction"===c)return Array.isArray(l)?l[1]:void 0}function createSpanItem(l){return[{type:"span"},l]}function isSentryRequestUrl(l,c){const d=c&&function(l){return void 0!==l.getClient}(c)?c.getClient():c,h=d&&d.getDsn(),p=d&&d.getOptions().tunnel;return function(l,c){return!!c&&l.includes(c.host)}(l,h)||function(l,c){if(!c)return!1;return removeTrailingSlash(l)===removeTrailingSlash(c)}(l,p)}function removeTrailingSlash(l){return"/"===l[l.length-1]?l.slice(0,-1):l}const Pw=[/^Script error\.?$/,/^Javascript error: Script error\.? on line 0$/,/^ResizeObserver loop completed with undelivered notifications.$/,/^Cannot redefine property: googletag$/],Lw=[/^.*\/healthcheck$/,/^.*\/healthy$/,/^.*\/live$/,/^.*\/ready$/,/^.*\/heartbeat$/,/^.*\/health$/,/^.*\/healthz$/],jw="InboundFilters",inboundFiltersIntegration=(l={})=>({name:jw,setupOnce(){},processEvent(c,d,h){const p=h.getOptions(),f=function(l={},c={}){return{allowUrls:[...l.allowUrls||[],...c.allowUrls||[]],denyUrls:[...l.denyUrls||[],...c.denyUrls||[]],ignoreErrors:[...l.ignoreErrors||[],...c.ignoreErrors||[],...l.disableErrorDefaults?[]:Pw],ignoreTransactions:[...l.ignoreTransactions||[],...c.ignoreTransactions||[],...l.disableTransactionDefaults?[]:Lw],ignoreInternal:void 0===l.ignoreInternal||l.ignoreInternal}}(l,p);return function(l,c){if(c.ignoreInternal&&function(l){try{return"SentryError"===l.exception.values[0].type}catch(hh){}return!1}(l))return mw&&Bb.warn(`Event dropped due to being internal Sentry Error.\nEvent: ${getEventDescription(l)}`),!0;if(function(l,c){if(l.type||!c||!c.length)return!1;return function(l){const c=[];l.message&&c.push(l.message);let d;try{d=l.exception.values[l.exception.values.length-1]}catch(hh){}d&&d.value&&(c.push(d.value),d.type&&c.push(`${d.type}: ${d.value}`));mw&&0===c.length&&Bb.error(`Could not extract message for event ${getEventDescription(l)}`);return c}(l).some((l=>stringMatchesSomePattern(l,c)))}(l,c.ignoreErrors))return mw&&Bb.warn(`Event dropped due to being matched by \`ignoreErrors\` option.\nEvent: ${getEventDescription(l)}`),!0;if(function(l,c){if("transaction"!==l.type||!c||!c.length)return!1;const d=l.transaction;return!!d&&stringMatchesSomePattern(d,c)}(l,c.ignoreTransactions))return mw&&Bb.warn(`Event dropped due to being matched by \`ignoreTransactions\` option.\nEvent: ${getEventDescription(l)}`),!0;if(function(l,c){if(!c||!c.length)return!1;const d=_getEventFilterUrl(l);return!!d&&stringMatchesSomePattern(d,c)}(l,c.denyUrls))return mw&&Bb.warn(`Event dropped due to being matched by \`denyUrls\` option.\nEvent: ${getEventDescription(l)}.\nUrl: ${_getEventFilterUrl(l)}`),!0;if(!function(l,c){if(!c||!c.length)return!0;const d=_getEventFilterUrl(l);return!d||stringMatchesSomePattern(d,c)}(l,c.allowUrls))return mw&&Bb.warn(`Event dropped due to not being matched by \`allowUrls\` option.\nEvent: ${getEventDescription(l)}.\nUrl: ${_getEventFilterUrl(l)}`),!0;return!1}(c,f)?null:c}});function _getEventFilterUrl(l){try{let c;try{c=l.exception.values[0].stacktrace.frames}catch(hh){}return c?function(l=[]){for(let c=l.length-1;c>=0;c--){const d=l[c];if(d&&"<anonymous>"!==d.filename&&"[native code]"!==d.filename)return d.filename||null}return null}(c):null}catch(c){return mw&&Bb.error(`Cannot extract url for event ${getEventDescription(l)}`),null}}let Dw;convertIntegrationFnToClass(jw,inboundFiltersIntegration);const Fw="FunctionToString",$w=new WeakMap,functionToStringIntegration=()=>({name:Fw,setupOnce(){Dw=Function.prototype.toString;try{Function.prototype.toString=function(...l){const c=getOriginalFunction(this),d=$w.has(getClient())&&void 0!==c?c:this;return Dw.apply(d,l)}}catch(hh){}},setup(l){$w.set(l,!0)}});convertIntegrationFnToClass(Fw,functionToStringIntegration);const Uw="undefined"==typeof __SENTRY_DEBUG__||__SENTRY_DEBUG__,Bw=jb;const bindReporter=(l,c,d)=>{let h,p;return f=>{c.value>=0&&(f||d)&&(p=c.value-(h||0),(p||void 0===h)&&(h=c.value,c.delta=p,l(c)))}},getNavigationEntry=()=>Bw.__WEB_VITALS_POLYFILL__?Bw.performance&&(performance.getEntriesByType&&performance.getEntriesByType("navigation")[0]||(()=>{const l=Bw.performance.timing,c=Bw.performance.navigation.type,d={entryType:"navigation",startTime:0,type:2==c?"back_forward":1===c?"reload":"navigate"};for(const h in l)"navigationStart"!==h&&"toJSON"!==h&&(d[h]=Math.max(l[h]-l.navigationStart,0));return d})()):Bw.performance&&performance.getEntriesByType&&performance.getEntriesByType("navigation")[0],getActivationStart=()=>{const l=getNavigationEntry();return l&&l.activationStart||0},initMetric=(l,c)=>{const d=getNavigationEntry();let h="navigate";return d&&(h=Bw.document&&Bw.document.prerendering||getActivationStart()>0?"prerender":d.type.replace(/_/g,"-")),{name:l,value:void 0===c?-1:c,rating:"good",delta:0,entries:[],id:`v3-${Date.now()}-${Math.floor(8999999999999*Math.random())+1e12}`,navigationType:h}},observe=(l,c,d)=>{try{if(PerformanceObserver.supportedEntryTypes.includes(l)){const h=new PerformanceObserver((l=>{c(l.getEntries())}));return h.observe(Object.assign({type:l,buffered:!0},d||{})),h}}catch(hh){}},onHidden=(l,c)=>{const onHiddenOrPageHide=d=>{"pagehide"!==d.type&&"hidden"!==Bw.document.visibilityState||(l(d),c&&(removeEventListener("visibilitychange",onHiddenOrPageHide,!0),removeEventListener("pagehide",onHiddenOrPageHide,!0)))};Bw.document&&(addEventListener("visibilitychange",onHiddenOrPageHide,!0),addEventListener("pagehide",onHiddenOrPageHide,!0))};let Hw=-1;const getVisibilityWatcher=()=>(Hw<0&&(Bw.document&&Bw.document.visibilityState&&(Hw="hidden"!==Bw.document.visibilityState||Bw.document.prerendering?1/0:0),onHidden((({timeStamp:l})=>{Hw=l}),!0)),{get firstHiddenTime(){return Hw}});let zw=0,qw=1/0,Ww=0;const updateEstimate=l=>{l.forEach((l=>{l.interactionId&&(qw=Math.min(qw,l.interactionId),Ww=Math.max(Ww,l.interactionId),zw=Ww?(Ww-qw)/7+1:0)}))};let Vw;const getInteractionCountForNavigation=()=>Vw?zw:performance.interactionCount||0,Zw=[],Gw={},processEntry=l=>{const c=Zw[Zw.length-1],d=Gw[l.interactionId];if(d||Zw.length<10||l.duration>c.latency){if(d)d.entries.push(l),d.latency=Math.max(d.latency,l.duration);else{const c={id:l.interactionId,latency:l.duration,entries:[l]};Gw[c.id]=c,Zw.push(c)}Zw.sort(((l,c)=>c.latency-l.latency)),Zw.splice(10).forEach((l=>{delete Gw[l.id]}))}},onINP=(l,c)=>{c=c||{},"interactionCount"in performance||Vw||(Vw=observe("event",updateEstimate,{type:"event",buffered:!0,durationThreshold:0}));const d=initMetric("INP");let h;const handleEntries=l=>{l.forEach((l=>{if(l.interactionId&&processEntry(l),"first-input"===l.entryType){!Zw.some((c=>c.entries.some((c=>l.duration===c.duration&&l.startTime===c.startTime))))&&processEntry(l)}}));const c=(()=>{const l=Math.min(Zw.length-1,Math.floor(getInteractionCountForNavigation()/50));return Zw[l]})();c&&c.latency!==d.value&&(d.value=c.latency,d.entries=c.entries,h())},p=observe("event",handleEntries,{durationThreshold:c.durationThreshold||40});h=bindReporter(l,d,c.reportAllChanges),p&&(p.observe({type:"first-input",buffered:!0}),onHidden((()=>{handleEntries(p.takeRecords()),d.value<0&&getInteractionCountForNavigation()>0&&(d.value=0,d.entries=[]),h(!0)})))},Kw={},whenReady=l=>{Bw.document&&(Bw.document.prerendering?addEventListener("prerenderingchange",(()=>whenReady(l)),!0):"complete"!==Bw.document.readyState?addEventListener("load",(()=>whenReady(l)),!0):setTimeout(l,0))},Jw={},Yw={};let Qw,Xw,eS,tS,rS;function addLcpInstrumentationHandler(l,c=!1){return addMetricObserver("lcp",l,instrumentLcp,eS,c)}function addPerformanceInstrumentationHandler(l,c){return addHandler(l,c),Yw[l]||(!function(l){const c={};"event"===l&&(c.durationThreshold=0);observe(l,(c=>{triggerHandlers(l,{entries:c})}),c)}(l),Yw[l]=!0),getCleanupCallback(l,c)}function triggerHandlers(l,c){const d=Jw[l];if(d&&d.length)for(const h of d)try{h(c)}catch(hh){Uw&&Bb.error(`Error while triggering instrumentation handler.\nType: ${l}\nName: ${getFunctionName(h)}\nError:`,hh)}}function instrumentCls(){return((l,c={})=>{const d=initMetric("CLS",0);let h,p=0,f=[];const handleEntries=l=>{l.forEach((l=>{if(!l.hadRecentInput){const c=f[0],m=f[f.length-1];p&&0!==f.length&&l.startTime-m.startTime<1e3&&l.startTime-c.startTime<5e3?(p+=l.value,f.push(l)):(p=l.value,f=[l]),p>d.value&&(d.value=p,d.entries=f,h&&h())}}))},m=observe("layout-shift",handleEntries);if(m){h=bindReporter(l,d,c.reportAllChanges);const stopListening=()=>{handleEntries(m.takeRecords()),h(!0)};return onHidden(stopListening),stopListening}})((l=>{triggerHandlers("cls",{metric:l}),Qw=l}),{reportAllChanges:!0})}function instrumentFid(){return(l=>{const c=getVisibilityWatcher(),d=initMetric("FID");let h;const handleEntry=l=>{l.startTime<c.firstHiddenTime&&(d.value=l.processingStart-l.startTime,d.entries.push(l),h(!0))},handleEntries=l=>{l.forEach(handleEntry)},p=observe("first-input",handleEntries);h=bindReporter(l,d),p&&onHidden((()=>{handleEntries(p.takeRecords()),p.disconnect()}),!0)})((l=>{triggerHandlers("fid",{metric:l}),Xw=l}))}function instrumentLcp(){return(l=>{const c=getVisibilityWatcher(),d=initMetric("LCP");let h;const handleEntries=l=>{const p=l[l.length-1];if(p){const l=Math.max(p.startTime-getActivationStart(),0);l<c.firstHiddenTime&&(d.value=l,d.entries=[p],h())}},p=observe("largest-contentful-paint",handleEntries);if(p){h=bindReporter(l,d);const stopListening=()=>{Kw[d.id]||(handleEntries(p.takeRecords()),p.disconnect(),Kw[d.id]=!0,h(!0))};return["keydown","click"].forEach((l=>{Bw.document&&addEventListener(l,stopListening,{once:!0,capture:!0})})),onHidden(stopListening,!0),stopListening}})((l=>{triggerHandlers("lcp",{metric:l}),eS=l}))}function instrumentTtfb(){return((l,c)=>{c=c||{};const d=initMetric("TTFB"),h=bindReporter(l,d,c.reportAllChanges);whenReady((()=>{const l=getNavigationEntry();if(l){if(d.value=Math.max(l.responseStart-getActivationStart(),0),d.value<0||d.value>performance.now())return;d.entries=[l],h(!0)}}))})((l=>{triggerHandlers("ttfb",{metric:l}),tS=l}))}function instrumentInp(){return onINP((l=>{triggerHandlers("inp",{metric:l}),rS=l}))}function addMetricObserver(l,c,d,h,p=!1){let f;return addHandler(l,c),Yw[l]||(f=d(),Yw[l]=!0),h&&c({metric:h}),getCleanupCallback(l,c,p?f:void 0)}function addHandler(l,c){Jw[l]=Jw[l]||[],Jw[l].push(c)}function getCleanupCallback(l,c,d){return()=>{d&&d();const h=Jw[l];if(!h)return;const p=h.indexOf(c);-1!==p&&h.splice(p,1)}}function isMeasurementValue(l){return"number"==typeof l&&isFinite(l)}function _startChild(l,{startTimestamp:c,...d}){return c&&l.startTimestamp>c&&(l.startTimestamp=c),l.startChild({startTimestamp:c,...d})}function msToSec(l){return l/1e3}function getBrowserPerformanceAPI(){return Bw&&Bw.addEventListener&&Bw.performance}let nS,sS,iS=0,oS={};function startTrackingWebVitals(){const l=getBrowserPerformanceAPI();if(l&&cw){l.mark&&Bw.performance.mark("sentry-tracing-init");const c=addMetricObserver("fid",(({metric:l})=>{const c=l.entries[l.entries.length-1];if(!c)return;const d=msToSec(cw),h=msToSec(c.startTime);Uw&&Bb.log("[Measurements] Adding FID"),oS.fid={value:l.value,unit:"millisecond"},oS["mark.fid"]={value:d+h,unit:"second"}}),instrumentFid,Xw),d=function(l,c=!1){return addMetricObserver("cls",l,instrumentCls,Qw,c)}((({metric:l})=>{const c=l.entries[l.entries.length-1];c&&(Uw&&Bb.log("[Measurements] Adding CLS"),oS.cls={value:l.value,unit:""},sS=c)}),!0),h=addLcpInstrumentationHandler((({metric:l})=>{const c=l.entries[l.entries.length-1];c&&(Uw&&Bb.log("[Measurements] Adding LCP"),oS.lcp={value:l.value,unit:"millisecond"},nS=c)}),!0),p=function(l){return addMetricObserver("ttfb",l,instrumentTtfb,tS)}((({metric:l})=>{l.entries[l.entries.length-1]&&(Uw&&Bb.log("[Measurements] Adding TTFB"),oS.ttfb={value:l.value,unit:"millisecond"})}));return()=>{c(),d(),h(),p()}}return()=>{}}function startTrackingINP(l,c){if(getBrowserPerformanceAPI()&&cw){const d=function(l,c){return d=({metric:d})=>{if(void 0===d.value)return;const h=d.entries.find((l=>l.duration===d.value&&void 0!==aS[l.name])),p=getClient();if(!h||!p)return;const f=aS[h.name],m=p.getOptions(),y=msToSec(cw+h.startTime),_=msToSec(d.value),b=void 0!==h.interactionId?l[h.interactionId]:void 0;if(void 0===b)return;const{routeName:w,parentContext:E,activeTransaction:M,user:N,replayId:P}=b,L=void 0!==N?N.email||N.id||N.ip_address:void 0,j=void 0!==M?M.getProfileId():void 0,D=new Span({startTimestamp:y,endTimestamp:y+_,op:`ui.interaction.${f}`,name:htmlTreeAsString(h.target),attributes:{release:m.release,environment:m.environment,transaction:w,...void 0!==L&&""!==L?{user:L}:{},...void 0!==j?{profile_id:j}:{},...void 0!==P?{replay_id:P}:{}},exclusiveTime:d.value,measurements:{inp:{value:d.value,unit:"millisecond"}}}),F=function(l,c,d){if(!hasTracingEnabled(c))return!1;let h;return h=void 0!==l&&"function"==typeof c.tracesSampler?c.tracesSampler({transactionContext:l,name:l.name,parentSampled:l.parentSampled,attributes:{...l.data,...l.attributes},location:Bw.location}):void 0!==l&&void 0!==l.sampled?l.sampled:void 0!==c.tracesSampleRate?c.tracesSampleRate:1,isValidSampleRate(h)?!0===h?d:!1===h?0:h*d:(Uw&&Bb.warn("[Tracing] Discarding interaction span because of invalid sample rate."),!1)}(E,m,c);if(F&&Math.random()<F){const l=D?function(l,c){const d={sent_at:(new Date).toISOString()};return c&&(d.dsn=dsnToString(c)),createEnvelope(d,l.map(createSpanItem))}([D],p.getDsn()):void 0,c=p&&p.getTransport();c&&l&&c.send(l).then(null,(l=>{Uw&&Bb.error("Error while sending interaction:",l)}))}},addMetricObserver("inp",d,instrumentInp,rS);var d}(l,c);return()=>{d()}}return()=>{}}const aS={click:"click",pointerdown:"click",pointerup:"click",mousedown:"click",mouseup:"click",touchstart:"click",touchend:"click",mouseover:"hover",mouseout:"hover",mouseenter:"hover",mouseleave:"hover",pointerover:"hover",pointerout:"hover",pointerenter:"hover",pointerleave:"hover",dragstart:"drag",dragend:"drag",drag:"drag",dragenter:"drag",dragleave:"drag",dragover:"drag",drop:"drag",keydown:"press",keyup:"press",keypress:"press",input:"press"};function addPerformanceEntries(l){const c=getBrowserPerformanceAPI();if(!c||!Bw.performance.getEntries||!cw)return;Uw&&Bb.log("[Tracing] Adding & adjusting spans using Performance API");const d=msToSec(cw),h=c.getEntries(),{op:p,start_timestamp:f}=spanToJSON(l);if(h.slice(iS).forEach((c=>{const h=msToSec(c.startTime),p=msToSec(c.duration);if(!("navigation"===l.op&&f&&d+h<f))switch(c.entryType){case"navigation":!function(l,c,d){["unloadEvent","redirect","domContentLoadedEvent","loadEvent","connect"].forEach((h=>{_addPerformanceNavigationTiming(l,c,h,d)})),_addPerformanceNavigationTiming(l,c,"secureConnection",d,"TLS/SSL","connectEnd"),_addPerformanceNavigationTiming(l,c,"fetch",d,"cache","domainLookupStart"),_addPerformanceNavigationTiming(l,c,"domainLookup",d,"DNS"),function(l,c,d){c.responseEnd&&(_startChild(l,{op:"browser",origin:"auto.browser.browser.metrics",description:"request",startTimestamp:d+msToSec(c.requestStart),endTimestamp:d+msToSec(c.responseEnd)}),_startChild(l,{op:"browser",origin:"auto.browser.browser.metrics",description:"response",startTimestamp:d+msToSec(c.responseStart),endTimestamp:d+msToSec(c.responseEnd)}))}(l,c,d)}(l,c,d);break;case"mark":case"paint":case"measure":{!function(l,c,d,h,p){const f=p+d,m=f+h;_startChild(l,{description:c.name,endTimestamp:m,op:c.entryType,origin:"auto.resource.browser.metrics",startTimestamp:f})}(l,c,h,p,d);const f=getVisibilityWatcher(),m=c.startTime<f.firstHiddenTime;"first-paint"===c.name&&m&&(Uw&&Bb.log("[Measurements] Adding FP"),oS.fp={value:c.startTime,unit:"millisecond"}),"first-contentful-paint"===c.name&&m&&(Uw&&Bb.log("[Measurements] Adding FCP"),oS.fcp={value:c.startTime,unit:"millisecond"});break}case"resource":!function(l,c,d,h,p,f){if("xmlhttprequest"===c.initiatorType||"fetch"===c.initiatorType)return;const m=parseUrl(d),y={};setResourceEntrySizeData(y,c,"transferSize","http.response_transfer_size"),setResourceEntrySizeData(y,c,"encodedBodySize","http.response_content_length"),setResourceEntrySizeData(y,c,"decodedBodySize","http.decoded_response_content_length"),"renderBlockingStatus"in c&&(y["resource.render_blocking_status"]=c.renderBlockingStatus);m.protocol&&(y["url.scheme"]=m.protocol.split(":").pop());m.host&&(y["server.address"]=m.host);y["url.same_origin"]=d.includes(Bw.location.origin);const _=f+h,b=_+p;_startChild(l,{description:d.replace(Bw.location.origin,""),endTimestamp:b,op:c.initiatorType?`resource.${c.initiatorType}`:"resource.other",origin:"auto.resource.browser.metrics",startTimestamp:_,data:y})}(l,c,c.name,h,p,d)}})),iS=Math.max(h.length-1,0),function(l){const c=Bw.navigator;if(!c)return;const d=c.connection;d&&(d.effectiveType&&l.setTag("effectiveConnectionType",d.effectiveType),d.type&&l.setTag("connectionType",d.type),isMeasurementValue(d.rtt)&&(oS["connection.rtt"]={value:d.rtt,unit:"millisecond"}));isMeasurementValue(c.deviceMemory)&&l.setTag("deviceMemory",`${c.deviceMemory} GB`);isMeasurementValue(c.hardwareConcurrency)&&l.setTag("hardwareConcurrency",String(c.hardwareConcurrency))}(l),"pageload"===p){!function(l){const c=getNavigationEntry();if(!c)return;const{responseStart:d,requestStart:h}=c;h<=d&&(Uw&&Bb.log("[Measurements] Adding TTFB Request Time"),l["ttfb.requestTime"]={value:d-h,unit:"millisecond"})}(oS),["fcp","fp","lcp"].forEach((l=>{if(!oS[l]||!f||d>=f)return;const c=oS[l].value,h=d+msToSec(c),p=Math.abs(1e3*(h-f)),m=p-c;Uw&&Bb.log(`[Measurements] Normalized ${l} from ${c} to ${p} (${m})`),oS[l].value=p}));const c=oS["mark.fid"];c&&oS.fid&&(_startChild(l,{description:"first input delay",endTimestamp:c.value+msToSec(oS.fid.value),op:"ui.action",origin:"auto.ui.browser.metrics",startTimestamp:c.value}),delete oS["mark.fid"]),"fcp"in oS||delete oS.cls,Object.keys(oS).forEach((l=>{!function(l,c,d){const h=getActiveTransaction();h&&h.setMeasurement(l,c,d)}(l,oS[l].value,oS[l].unit)})),function(l){nS&&(Uw&&Bb.log("[Measurements] Adding LCP Data"),nS.element&&l.setTag("lcp.element",htmlTreeAsString(nS.element)),nS.id&&l.setTag("lcp.id",nS.id),nS.url&&l.setTag("lcp.url",nS.url.trim().slice(0,200)),l.setTag("lcp.size",nS.size));sS&&sS.sources&&(Uw&&Bb.log("[Measurements] Adding CLS Data"),sS.sources.forEach(((c,d)=>l.setTag(`cls.source.${d+1}`,htmlTreeAsString(c.node)))))}(l)}nS=void 0,sS=void 0,oS={}}function _addPerformanceNavigationTiming(l,c,d,h,p,f){const m=f?c[f]:c[`${d}End`],y=c[`${d}Start`];y&&m&&_startChild(l,{op:"browser",origin:"auto.browser.browser.metrics",description:p||d,startTimestamp:h+msToSec(y),endTimestamp:h+msToSec(m)})}function setResourceEntrySizeData(l,c,d,h){const p=c[d];null!=p&&p<2147483647&&(l[h]=p)}function instrumentFetchRequest(l,c,d,h,p="auto.http.browser"){if(!hasTracingEnabled()||!l.fetchData)return;const f=c(l.fetchData.url);if(l.endTimestamp&&f){const c=l.fetchData.__span;if(!c)return;const d=h[c];return void(d&&(!function(l,c){if(c.response){setHttpStatus(l,c.response.status);const d=c.response&&c.response.headers&&c.response.headers.get("content-length");if(d){const c=parseInt(d);c>0&&l.setAttribute("http.response_content_length",c)}}else c.error&&l.setStatus("internal_error");l.end()}(d,l),delete h[c]))}const m=getCurrentScope$1(),y=getClient(),{method:_,url:b}=l.fetchData,w=function(l){try{return new URL(l).href}catch(hh){return}}(b),E=w?parseUrl(w).host:void 0,M=f?startInactiveSpan({name:`${_} ${b}`,onlyIfParent:!0,attributes:{url:b,type:"fetch","http.method":_,"http.url":w,"server.address":E,[Rw]:p},op:"http.client"}):void 0;if(M&&(l.fetchData.__span=M.spanContext().spanId,h[M.spanContext().spanId]=M),d(l.fetchData.url)&&y){const c=l.args[0];l.args[1]=l.args[1]||{};const d=l.args[1];d.headers=function(l,c,d,h,p){const f=p||d.getSpan(),m=getIsolationScope(),{traceId:y,spanId:_,sampled:b,dsc:w}={...m.getPropagationContext(),...d.getPropagationContext()},E=f?spanToTraceHeader(f):generateSentryTraceHeader(y,_,b),M=dynamicSamplingContextToSentryBaggageHeader(w||(f?getDynamicSamplingContextFromSpan(f):getDynamicSamplingContextFromClient(y,c,d))),N=h.headers||("undefined"!=typeof Request&&isInstanceOf(l,Request)?l.headers:void 0);if(N){if("undefined"!=typeof Headers&&isInstanceOf(N,Headers)){const l=new Headers(N);return l.append("sentry-trace",E),M&&l.append(uw,M),l}if(Array.isArray(N)){const l=[...N,["sentry-trace",E]];return M&&l.push([uw,M]),l}{const l="baggage"in N?N.baggage:void 0,c=[];return Array.isArray(l)?c.push(...l):l&&c.push(l),M&&c.push(M),{...N,"sentry-trace":E,baggage:c.length>0?c.join(","):void 0}}}return{"sentry-trace":E,baggage:M}}(c,y,m,d,M)}return M}const lS=["localhost",/^\/(?!\/)/],cS={traceFetch:!0,traceXHR:!0,enableHTTPTimings:!0,tracingOrigins:lS,tracePropagationTargets:lS};function instrumentOutgoingRequests(l){const{traceFetch:c,traceXHR:d,tracePropagationTargets:h,tracingOrigins:p,shouldCreateSpanForRequest:f,enableHTTPTimings:m}={traceFetch:cS.traceFetch,traceXHR:cS.traceXHR,...l},y="function"==typeof f?f:l=>!0,shouldAttachHeadersWithTargets=l=>function(l,c){return stringMatchesSomePattern(l,c||lS)}(l,h||p),_={};c&&addFetchInstrumentationHandler((l=>{const c=instrumentFetchRequest(l,y,shouldAttachHeadersWithTargets,_);if(c){const d=getFullURL(l.fetchData.url),h=d?parseUrl(d).host:void 0;c.setAttributes({"http.url":d,"server.address":h})}m&&c&&addHTTPTimings(c)})),d&&addXhrInstrumentationHandler((l=>{const c=function(l,c,d,h){const p=l.xhr,f=p&&p[iw];if(!hasTracingEnabled()||!p||p.__sentry_own_request__||!f)return;const m=c(f.url);if(l.endTimestamp&&m){const l=p.__sentry_xhr_span_id__;if(!l)return;const c=h[l];return void(c&&void 0!==f.status_code&&(setHttpStatus(c,f.status_code),c.end(),delete h[l]))}const y=getCurrentScope$1(),_=getIsolationScope(),b=getFullURL(f.url),w=b?parseUrl(b).host:void 0,E=m?startInactiveSpan({name:`${f.method} ${f.url}`,onlyIfParent:!0,attributes:{type:"xhr","http.method":f.method,"http.url":b,url:f.url,"server.address":w,[Rw]:"auto.http.browser"},op:"http.client"}):void 0;E&&(p.__sentry_xhr_span_id__=E.spanContext().spanId,h[p.__sentry_xhr_span_id__]=E);const M=getClient();if(p.setRequestHeader&&d(f.url)&&M){const{traceId:l,spanId:c,sampled:d,dsc:h}={..._.getPropagationContext(),...y.getPropagationContext()};!function(l,c,d){try{l.setRequestHeader("sentry-trace",c),d&&l.setRequestHeader(uw,d)}catch(h){}}(p,E?spanToTraceHeader(E):generateSentryTraceHeader(l,c,d),dynamicSamplingContextToSentryBaggageHeader(h||(E?getDynamicSamplingContextFromSpan(E):getDynamicSamplingContextFromClient(l,M,y))))}return E}(l,y,shouldAttachHeadersWithTargets,_);m&&c&&addHTTPTimings(c)}))}function addHTTPTimings(l){const{url:c}=spanToJSON(l).data||{};if(!c||"string"!=typeof c)return;const d=addPerformanceInstrumentationHandler("resource",(({entries:h})=>{h.forEach((h=>{if(function(l){return"resource"===l.entryType&&"initiatorType"in l&&"string"==typeof l.nextHopProtocol&&("fetch"===l.initiatorType||"xmlhttprequest"===l.initiatorType)}(h)&&h.name.endsWith(c)){(function(l){const{name:c,version:d}=function(l){let c="unknown",d="unknown",h="";for(const p of l){if("/"===p){[c,d]=l.split("/");break}if(!isNaN(Number(p))){c="h"===h?"http":h,d=l.split(h)[1];break}h+=p}h===l&&(c=h);return{name:c,version:d}}(l.nextHopProtocol),h=[];if(h.push(["network.protocol.version",d],["network.protocol.name",c]),!cw)return h;return[...h,["http.request.redirect_start",getAbsoluteTime$1(l.redirectStart)],["http.request.fetch_start",getAbsoluteTime$1(l.fetchStart)],["http.request.domain_lookup_start",getAbsoluteTime$1(l.domainLookupStart)],["http.request.domain_lookup_end",getAbsoluteTime$1(l.domainLookupEnd)],["http.request.connect_start",getAbsoluteTime$1(l.connectStart)],["http.request.secure_connection_start",getAbsoluteTime$1(l.secureConnectionStart)],["http.request.connection_end",getAbsoluteTime$1(l.connectEnd)],["http.request.request_start",getAbsoluteTime$1(l.requestStart)],["http.request.response_start",getAbsoluteTime$1(l.responseStart)],["http.request.response_end",getAbsoluteTime$1(l.responseEnd)]]})(h).forEach((c=>l.setAttribute(...c))),setTimeout(d)}}))}))}function getAbsoluteTime$1(l=0){return((cw||performance.timeOrigin)+l)/1e3}function getFullURL(l){try{return new URL(l,Bw.location.origin).href}catch(hh){return}}const uS={...Aw,markBackgroundTransactions:!0,routingInstrumentation:function(l,c=!0,d=!0){if(!Bw||!Bw.location)return void(Uw&&Bb.warn("Could not initialize routing instrumentation due to invalid location"));let h,p=Bw.location.href;c&&(h=l({name:Bw.location.pathname,startTimestamp:cw?cw/1e3:void 0,op:"pageload",origin:"auto.pageload.browser",metadata:{source:"url"}})),d&&addHistoryInstrumentationHandler((({to:c,from:d})=>{void 0===d&&p&&-1!==p.indexOf(c)?p=void 0:d!==c&&(p=void 0,h&&(Uw&&Bb.log(`[Tracing] Finishing current transaction with op: ${h.op}`),h.end()),h=l({name:Bw.location.pathname,op:"navigation",origin:"auto.navigation.browser",metadata:{source:"url"}}))}))},startTransactionOnLocationChange:!0,startTransactionOnPageLoad:!0,enableLongTask:!0,enableInp:!1,interactionsSampleRate:1,_experiments:{},...cS};class BrowserTracing{constructor(l){this.name="BrowserTracing",this._hasSetTracePropagationTargets=!1,addTracingExtensions(),Uw&&(this._hasSetTracePropagationTargets=!(!l||!l.tracePropagationTargets&&!l.tracingOrigins)),this.options={...uS,...l},void 0!==this.options._experiments.enableLongTask&&(this.options.enableLongTask=this.options._experiments.enableLongTask),l&&!l.tracePropagationTargets&&l.tracingOrigins&&(this.options.tracePropagationTargets=l.tracingOrigins),this._collectWebVitals=startTrackingWebVitals(),this._interactionIdToRouteNameMapping={},this.options.enableInp&&startTrackingINP(this._interactionIdToRouteNameMapping,this.options.interactionsSampleRate),this.options.enableLongTask&&addPerformanceInstrumentationHandler("longtask",(({entries:l})=>{for(const c of l){const l=getActiveTransaction();if(!l)return;const d=msToSec(cw+c.startTime),h=msToSec(c.duration);l.startChild({description:"Main UI thread blocked",op:"ui.long-task",origin:"auto.ui.browser.metrics",startTimestamp:d,endTimestamp:d+h})}})),this.options._experiments.enableInteractions&&addPerformanceInstrumentationHandler("event",(({entries:l})=>{for(const c of l){const l=getActiveTransaction();if(!l)return;if("click"===c.name){const d=msToSec(cw+c.startTime),h=msToSec(c.duration),p={description:htmlTreeAsString(c.target),op:`ui.interaction.${c.name}`,origin:"auto.ui.browser.metrics",startTimestamp:d,endTimestamp:d+h},f=getComponentName(c.target);f&&(p.attributes={"ui.component_name":f}),l.startChild(p)}}})),this._latestRoute={name:void 0,context:void 0}}setupOnce(l,c){this._getCurrentHub=c;const d=c().getClient(),h=d&&d.getOptions(),{routingInstrumentation:p,startTransactionOnLocationChange:f,startTransactionOnPageLoad:m,markBackgroundTransactions:y,traceFetch:_,traceXHR:b,shouldCreateSpanForRequest:w,enableHTTPTimings:E,_experiments:M}=this.options,N=h&&h.tracePropagationTargets,P=N||this.options.tracePropagationTargets;Uw&&this._hasSetTracePropagationTargets&&N&&Bb.warn("[Tracing] The `tracePropagationTargets` option was set in the BrowserTracing integration and top level `Sentry.init`. The top level `Sentry.init` value is being used."),p((l=>{const d=this._createRouteTransaction(l);return this.options._experiments.onStartRouteTransaction&&this.options._experiments.onStartRouteTransaction(d,l,c),d}),m,f),y&&(Bw.document?Bw.document.addEventListener("visibilitychange",(()=>{const l=getActiveTransaction();if(Bw.document.hidden&&l){const c="cancelled",{op:d,status:h}=spanToJSON(l);Uw&&Bb.log(`[Tracing] Transaction: ${c} -> since tab moved to the background, op: ${d}`),h||l.setStatus(c),l.setTag("visibilitychange","document.hidden"),l.end()}})):Uw&&Bb.warn("[Tracing] Could not set up background tab detection due to lack of global document")),M.enableInteractions&&this._registerInteractionListener(),this.options.enableInp&&this._registerInpInteractionListener(),instrumentOutgoingRequests({traceFetch:_,traceXHR:b,tracePropagationTargets:P,shouldCreateSpanForRequest:w,enableHTTPTimings:E})}_createRouteTransaction(l){if(!this._getCurrentHub)return void(Uw&&Bb.warn(`[Tracing] Did not create ${l.op} transaction because _getCurrentHub is invalid.`));const c=this._getCurrentHub(),{beforeNavigate:d,idleTimeout:h,finalTimeout:p,heartbeatInterval:f}=this.options,m="pageload"===l.op;let y;if(m){const c=m?getMetaContent("sentry-trace"):"",d=m?getMetaContent("baggage"):void 0,{traceId:h,dsc:p,parentSpanId:f,sampled:_}=propagationContextFromHeaders(c,d);y={traceId:h,parentSpanId:f,parentSampled:_,...l,metadata:{...l.metadata,dynamicSamplingContext:p},trimEnd:!0}}else y={trimEnd:!0,...l};const _="function"==typeof d?d(y):y,b=void 0===_?{...y,sampled:!1}:_;b.metadata=b.name!==y.name?{...b.metadata,source:"custom"}:b.metadata,this._latestRoute.name=b.name,this._latestRoute.context=b,!1===b.sampled&&Uw&&Bb.log(`[Tracing] Will not send ${b.op} transaction because of beforeNavigate.`),Uw&&Bb.log(`[Tracing] Starting ${b.op} transaction on scope`);const{location:w}=Bw,E=startIdleTransaction(c,b,h,p,!0,{location:w},f,m);return m&&Bw.document&&(Bw.document.addEventListener("readystatechange",(()=>{["interactive","complete"].includes(Bw.document.readyState)&&E.sendAutoFinishSignal()})),["interactive","complete"].includes(Bw.document.readyState)&&E.sendAutoFinishSignal()),E.registerBeforeFinishCallback((l=>{this._collectWebVitals(),addPerformanceEntries(l)})),E}_registerInteractionListener(){let l;const registerInteractionTransaction=()=>{const{idleTimeout:c,finalTimeout:d,heartbeatInterval:h}=this.options,p="ui.action.click",f=getActiveTransaction();if(f&&f.op&&["navigation","pageload"].includes(f.op))return void(Uw&&Bb.warn(`[Tracing] Did not create ${p} transaction because a pageload or navigation transaction is in progress.`));if(l&&(l.setFinishReason("interactionInterrupted"),l.end(),l=void 0),!this._getCurrentHub)return void(Uw&&Bb.warn(`[Tracing] Did not create ${p} transaction because _getCurrentHub is invalid.`));if(!this._latestRoute.name)return void(Uw&&Bb.warn(`[Tracing] Did not create ${p} transaction because _latestRouteName is missing.`));const m=this._getCurrentHub(),{location:y}=Bw,_={name:this._latestRoute.name,op:p,trimEnd:!0,data:{[Ew]:this._latestRoute.context?getSource(this._latestRoute.context):"url"}};l=startIdleTransaction(m,_,c,d,!0,{location:y},h)};["click"].forEach((l=>{Bw.document&&addEventListener(l,registerInteractionTransaction,{once:!1,capture:!0})}))}_registerInpInteractionListener(){const handleEntries=({entries:l})=>{const c=getClient(),d=void 0!==c&&void 0!==c.getIntegrationByName?c.getIntegrationByName("Replay"):void 0,h=void 0!==d?d.getReplayId():void 0,p=getActiveTransaction(),f=getCurrentScope$1(),m=void 0!==f?f.getUser():void 0;l.forEach((l=>{if(function(l){return"duration"in l}(l)){const c=l.interactionId;if(void 0===c)return;const d=this._interactionIdToRouteNameMapping[c],f=l.duration,y=l.startTime,_=Object.keys(this._interactionIdToRouteNameMapping),b=_.length>0?_.reduce(((l,c)=>this._interactionIdToRouteNameMapping[l].duration<this._interactionIdToRouteNameMapping[c].duration?l:c)):void 0;if("first-input"===l.entryType){if(_.map((l=>this._interactionIdToRouteNameMapping[l])).some((l=>l.duration===f&&l.startTime===y)))return}if(!c)return;if(d)d.duration=Math.max(d.duration,f);else if(_.length<10||void 0===b||f>this._interactionIdToRouteNameMapping[b].duration){const l=this._latestRoute.name,d=this._latestRoute.context;l&&d&&(b&&Object.keys(this._interactionIdToRouteNameMapping).length>=10&&delete this._interactionIdToRouteNameMapping[b],this._interactionIdToRouteNameMapping[c]={routeName:l,duration:f,parentContext:d,user:m,activeTransaction:p,replayId:h,startTime:y})}}}))};addPerformanceInstrumentationHandler("event",handleEntries),addPerformanceInstrumentationHandler("first-input",handleEntries)}}function getMetaContent(l){const c=(d=`meta[name=${l}]`,Db.document&&Db.document.querySelector?Db.document.querySelector(d):null);var d;return c?c.getAttribute("content"):void 0}function getSource(l){const c=l.attributes&&l.attributes[Ew],d=l.data&&l.data[Ew],h=l.metadata&&l.metadata.source;return c||d||h}const dS=jb;let hS=0;function shouldIgnoreOnError(){return hS>0}function wrap(l,c={},d){if("function"!=typeof l)return l;try{const c=l.__sentry_wrapped__;if(c)return"function"==typeof c?c:l;if(getOriginalFunction(l))return l}catch(hh){return l}const sentryWrapped=function(){const d=Array.prototype.slice.call(arguments);try{const h=d.map((l=>wrap(l,c)));return l.apply(this,h)}catch(h){throw hS++,setTimeout((()=>{hS--})),withScope((l=>{l.addEventProcessor((l=>(c.mechanism&&(addExceptionTypeValue(l,void 0),addExceptionMechanism(l,c.mechanism)),l.extra={...l.extra,arguments:d},l))),captureException(h)})),h}};try{for(const c in l)Object.prototype.hasOwnProperty.call(l,c)&&(sentryWrapped[c]=l[c])}catch(h){}markFunctionWrapped(sentryWrapped,l),addNonEnumerableProperty(l,"__sentry_wrapped__",sentryWrapped);try{Object.getOwnPropertyDescriptor(sentryWrapped,"name").configurable&&Object.defineProperty(sentryWrapped,"name",{get:()=>l.name})}catch(h){}return sentryWrapped}const pS="undefined"==typeof __SENTRY_DEBUG__||__SENTRY_DEBUG__;function exceptionFromError(l,c){const d=parseStackFrames(l,c),h={type:c&&c.name,value:extractMessage(c)};return d.length&&(h.stacktrace={frames:d}),void 0===h.type&&""===h.value&&(h.value="Unrecoverable error caught"),h}function eventFromError(l,c){return{exception:{values:[exceptionFromError(l,c)]}}}function parseStackFrames(l,c){const d=c.stacktrace||c.stack||"",h=function(l){if(l){if("number"==typeof l.framesToPop)return l.framesToPop;if(fS.test(l.message))return 1}return 0}(c);try{return l(d,h)}catch(hh){}return[]}const fS=/Minified React error #\d+;/i;function extractMessage(l){const c=l&&l.message;return c?c.error&&"string"==typeof c.error.message?c.error.message:c:"No error message"}function eventFromUnknownInput(l,c,d,h,p){let f;if(isErrorEvent$2(c)&&c.error){return eventFromError(l,c.error)}if(isDOMError(c)||isBuiltin(c,"DOMException")){const p=c;if("stack"in c)f=eventFromError(l,c);else{const c=p.name||(isDOMError(p)?"DOMError":"DOMException"),m=p.message?`${c}: ${p.message}`:c;f=eventFromString(l,m,d,h),addExceptionTypeValue(f,m)}return"code"in p&&(f.tags={...f.tags,"DOMException.code":`${p.code}`}),f}if(isError(c))return eventFromError(l,c);if(isPlainObject$3(c)||isEvent(c)){return f=function(l,c,d,h){const p=getClient(),f=p&&p.getOptions().normalizeDepth,m={exception:{values:[{type:isEvent(c)?c.constructor.name:h?"UnhandledRejection":"Error",value:getNonErrorObjectExceptionValue(c,{isUnhandledRejection:h})}]},extra:{__serialized__:normalizeToSize(c,f)}};if(d){const c=parseStackFrames(l,d);c.length&&(m.exception.values[0].stacktrace={frames:c})}return m}(l,c,d,p),addExceptionMechanism(f,{synthetic:!0}),f}return f=eventFromString(l,c,d,h),addExceptionTypeValue(f,`${c}`),addExceptionMechanism(f,{synthetic:!0}),f}function eventFromString(l,c,d,h){const p={};if(h&&d){const h=parseStackFrames(l,d);h.length&&(p.exception={values:[{value:c,stacktrace:{frames:h}}]})}if(isParameterizedString(c)){const{__sentry_template_string__:l,__sentry_template_values__:d}=c;return p.logentry={message:l,params:d},p}return p.message=c,p}function getNonErrorObjectExceptionValue(l,{isUnhandledRejection:c}){const d=function(l,c=40){const d=Object.keys(convertToPlainObject(l));if(d.sort(),!d.length)return"[object has no keys]";if(d[0].length>=c)return truncate(d[0],c);for(let h=d.length;h>0;h--){const l=d.slice(0,h).join(", ");if(!(l.length>c))return h===d.length?l:truncate(l,c)}return""}(l),h=c?"promise rejection":"exception";if(isErrorEvent$2(l))return`Event \`ErrorEvent\` captured as ${h} with message \`${l.message}\``;if(isEvent(l)){return`Event \`${function(l){try{const c=Object.getPrototypeOf(l);return c?c.constructor.name:void 0}catch(hh){}}(l)}\` (type=${l.type}) captured as ${h}`}return`Object captured as ${h} with keys: ${d}`}class BrowserClient extends BaseClient{constructor(l){!function(l,c,d=[c],h="npm"){const p=l._metadata||{};p.sdk||(p.sdk={name:`sentry.javascript.${c}`,packages:d.map((l=>({name:`${h}:@sentry/${l}`,version:_w}))),version:_w}),l._metadata=p}(l,"browser",["browser"],dS.SENTRY_SDK_SOURCE||"npm"),super(l),l.sendClientReports&&dS.document&&dS.document.addEventListener("visibilitychange",(()=>{"hidden"===dS.document.visibilityState&&this._flushOutcomes()}))}eventFromException(l,c){return function(l,c,d,h){const p=eventFromUnknownInput(l,c,d&&d.syntheticException||void 0,h);return addExceptionMechanism(p),p.level="error",d&&d.event_id&&(p.event_id=d.event_id),resolvedSyncPromise(p)}(this._options.stackParser,l,c,this._options.attachStacktrace)}eventFromMessage(l,c="info",d){return function(l,c,d="info",h,p){const f=eventFromString(l,c,h&&h.syntheticException||void 0,p);return f.level=d,h&&h.event_id&&(f.event_id=h.event_id),resolvedSyncPromise(f)}(this._options.stackParser,l,c,d,this._options.attachStacktrace)}captureUserFeedback(l){if(!this._isEnabled())return void(pS&&Bb.warn("SDK not enabled, will not capture user feedback."));const c=function(l,{metadata:c,tunnel:d,dsn:h}){const p={event_id:l.event_id,sent_at:(new Date).toISOString(),...c&&c.sdk&&{sdk:{name:c.sdk.name,version:c.sdk.version}},...!!d&&!!h&&{dsn:dsnToString(h)}},f=function(l){return[{type:"user_report"},l]}(l);return createEnvelope(p,[f])}(l,{metadata:this.getSdkMetadata(),dsn:this.getDsn(),tunnel:this.getOptions().tunnel});this._sendEnvelope(c)}_prepareEvent(l,c,d){return l.platform=l.platform||"javascript",super._prepareEvent(l,c,d)}_flushOutcomes(){const l=this._clearOutcomes();if(0===l.length)return void(pS&&Bb.log("No outcomes to send"));if(!this._dsn)return void(pS&&Bb.log("No dsn provided, will not send outcomes"));pS&&Bb.log("Sending outcomes:",l);const c=(d=l,createEnvelope((h=this._options.tunnel&&dsnToString(this._dsn))?{dsn:h}:{},[[{type:"client_report"},{timestamp:dateTimestampInSeconds(),discarded_events:d}]]));var d,h;this._sendEnvelope(c)}}let mS;function makeFetchTransport(l,c=function(){if(mS)return mS;if(isNativeFetch(dS.fetch))return mS=dS.fetch.bind(dS);const l=dS.document;let c=dS.fetch;if(l&&"function"==typeof l.createElement)try{const d=l.createElement("iframe");d.hidden=!0,l.head.appendChild(d);const h=d.contentWindow;h&&h.fetch&&(c=h.fetch),l.head.removeChild(d)}catch(hh){pS&&Bb.warn("Could not create sandbox iframe for pure fetch check, bailing to window.fetch: ",hh)}return mS=c.bind(dS)}()){let d=0,h=0;return createTransport(l,(function(p){const f=p.body.length;d+=f,h++;const m={body:p.body,method:"POST",referrerPolicy:"origin",headers:l.headers,keepalive:d<=6e4&&h<15,...l.fetchOptions};try{return c(l.url,m).then((l=>(d-=f,h--,{statusCode:l.status,headers:{"x-sentry-rate-limits":l.headers.get("X-Sentry-Rate-Limits"),"retry-after":l.headers.get("Retry-After")}})))}catch(hh){return mS=void 0,d-=f,h--,rejectedSyncPromise(hh)}}))}function makeXHRTransport(l){return createTransport(l,(function(c){return new SyncPromise(((d,h)=>{const p=new XMLHttpRequest;p.onerror=h,p.onreadystatechange=()=>{4===p.readyState&&d({statusCode:p.status,headers:{"x-sentry-rate-limits":p.getResponseHeader("X-Sentry-Rate-Limits"),"retry-after":p.getResponseHeader("Retry-After")}})},p.open("POST",l.url);for(const c in l.headers)Object.prototype.hasOwnProperty.call(l.headers,c)&&p.setRequestHeader(c,l.headers[c]);p.send(c.body)}))}))}const gS="?";function createFrame(l,c,d,h){const p={filename:l,function:c,in_app:!0};return void 0!==d&&(p.lineno=d),void 0!==h&&(p.colno=h),p}const vS=/^\s*at (?:(.+?\)(?: \[.+\])?|.*?) ?\((?:address at )?)?(?:async )?((?:<anonymous>|[-a-z]+:|.*bundle|\/)?.*?)(?::(\d+))?(?::(\d+))?\)?\s*$/i,yS=/\((\S*)(?::(\d+))(?::(\d+))\)/,_S=/^\s*(.*?)(?:\((.*?)\))?(?:^|@)?((?:[-a-z]+)?:\/.*?|\[native code\]|[^@]*(?:bundle|\d+\.js)|\/[\w\-. /=]+)(?::(\d+))?(?::(\d+))?\s*$/i,bS=/(\S+) line (\d+)(?: > eval line \d+)* > eval/i,wS=/^\s*at (?:((?:\[object object\])?.+) )?\(?((?:[-a-z]+):.*?):(\d+)(?::(\d+))?\)?\s*$/i,SS=createStackParser(...[[30,l=>{const c=vS.exec(l);if(c){if(c[2]&&0===c[2].indexOf("eval")){const l=yS.exec(c[2]);l&&(c[2]=l[1],c[3]=l[2],c[4]=l[3])}const[l,d]=extractSafariExtensionDetails(c[1]||gS,c[2]);return createFrame(d,l,c[3]?+c[3]:void 0,c[4]?+c[4]:void 0)}}],[50,l=>{const c=_S.exec(l);if(c){if(c[3]&&c[3].indexOf(" > eval")>-1){const l=bS.exec(c[3]);l&&(c[1]=c[1]||"eval",c[3]=l[1],c[4]=l[2],c[5]="")}let l=c[3],d=c[1]||gS;return[d,l]=extractSafariExtensionDetails(d,l),createFrame(l,d,c[4]?+c[4]:void 0,c[5]?+c[5]:void 0)}}],[40,l=>{const c=wS.exec(l);return c?createFrame(c[2],c[1]||gS,+c[3],c[4]?+c[4]:void 0):void 0}]]),extractSafariExtensionDetails=(l,c)=>{const d=-1!==l.indexOf("safari-extension"),h=-1!==l.indexOf("safari-web-extension");return d||h?[-1!==l.indexOf("@")?l.split("@")[0]:gS,d?`safari-extension:${c}`:`safari-web-extension:${c}`]:[l,c]},xS=1024,kS="Breadcrumbs",breadcrumbsIntegration=(l={})=>{const c={console:!0,dom:!0,fetch:!0,history:!0,sentry:!0,xhr:!0,...l};return{name:kS,setupOnce(){},setup(l){c.console&&function(l){const c="console";addHandler$1(c,l),maybeInstrument(c,instrumentConsole)}(function(l){return function(c){if(getClient()!==l)return;const d={category:"console",data:{arguments:c.args,logger:"console"},level:severityLevelFromString(c.level),message:safeJoin(c.args," ")};if("assert"===c.level){if(!1!==c.args[0])return;d.message=`Assertion failed: ${safeJoin(c.args.slice(1)," ")||"console.assert"}`,d.data.arguments=c.args.slice(1)}addBreadcrumb(d,{input:c.args,level:c.level})}}(l)),c.dom&&addClickKeypressInstrumentationHandler(function(l,c){return function(d){if(getClient()!==l)return;let h,p,f="object"==typeof c?c.serializeAttribute:void 0,m="object"==typeof c&&"number"==typeof c.maxStringLength?c.maxStringLength:void 0;m&&m>xS&&(pS&&Bb.warn(`\`dom.maxStringLength\` cannot exceed 1024, but a value of ${m} was configured. Sentry will use 1024 instead.`),m=xS),"string"==typeof f&&(f=[f]);try{const l=d.event,c=function(l){return!!l&&!!l.target}(l)?l.target:l;h=htmlTreeAsString(c,{keyAttrs:f,maxStringLength:m}),p=getComponentName(c)}catch(hh){h="<unknown>"}if(0===h.length)return;const y={category:`ui.${d.name}`,message:h};p&&(y.data={"ui.component_name":p}),addBreadcrumb(y,{event:d.event,name:d.name,global:d.global})}}(l,c.dom)),c.xhr&&addXhrInstrumentationHandler(function(l){return function(c){if(getClient()!==l)return;const{startTimestamp:d,endTimestamp:h}=c,p=c.xhr[iw];if(!d||!h||!p)return;const{method:f,url:m,status_code:y,body:_}=p;addBreadcrumb({category:"xhr",data:{method:f,url:m,status_code:y},type:"http"},{xhr:c.xhr,input:_,startTimestamp:d,endTimestamp:h})}}(l)),c.fetch&&addFetchInstrumentationHandler(function(l){return function(c){if(getClient()!==l)return;const{startTimestamp:d,endTimestamp:h}=c;if(h&&(!c.fetchData.url.match(/sentry_key/)||"POST"!==c.fetchData.method))if(c.error){addBreadcrumb({category:"fetch",data:c.fetchData,level:"error",type:"http"},{data:c.error,input:c.args,startTimestamp:d,endTimestamp:h})}else{const l=c.response;addBreadcrumb({category:"fetch",data:{...c.fetchData,status_code:l&&l.status},type:"http"},{input:c.args,response:l,startTimestamp:d,endTimestamp:h})}}}(l)),c.history&&addHistoryInstrumentationHandler(function(l){return function(c){if(getClient()!==l)return;let d=c.from,h=c.to;const p=parseUrl(dS.location.href);let f=d?parseUrl(d):void 0;const m=parseUrl(h);f&&f.path||(f=p),p.protocol===m.protocol&&p.host===m.host&&(h=m.relative),p.protocol===f.protocol&&p.host===f.host&&(d=f.relative),addBreadcrumb({category:"navigation",data:{from:d,to:h}})}}(l)),c.sentry&&l.on&&l.on("beforeSendEvent",function(l){return function(c){getClient()===l&&addBreadcrumb({category:"sentry."+("transaction"===c.type?"transaction":"event"),event_id:c.event_id,level:c.level,message:getEventDescription(c)},{event:c})}}(l))}}};convertIntegrationFnToClass(kS,breadcrumbsIntegration);const CS="Dedupe",dedupeIntegration=()=>{let l;return{name:CS,setupOnce(){},processEvent(c){if(c.type)return c;try{if(function(l,c){if(!c)return!1;if(function(l,c){const d=l.message,h=c.message;if(!d&&!h)return!1;if(d&&!h||!d&&h)return!1;if(d!==h)return!1;if(!_isSameFingerprint(l,c))return!1;if(!_isSameStacktrace(l,c))return!1;return!0}(l,c))return!0;if(function(l,c){const d=_getExceptionFromEvent(c),h=_getExceptionFromEvent(l);if(!d||!h)return!1;if(d.type!==h.type||d.value!==h.value)return!1;if(!_isSameFingerprint(l,c))return!1;if(!_isSameStacktrace(l,c))return!1;return!0}(l,c))return!0;return!1}(c,l))return pS&&Bb.warn("Event dropped due to being a duplicate of previously captured event."),null}catch(d){}return l=c}}};function _isSameStacktrace(l,c){let d=_getFramesFromEvent(l),h=_getFramesFromEvent(c);if(!d&&!h)return!0;if(d&&!h||!d&&h)return!1;if(h.length!==d.length)return!1;for(let p=0;p<h.length;p++){const l=h[p],c=d[p];if(l.filename!==c.filename||l.lineno!==c.lineno||l.colno!==c.colno||l.function!==c.function)return!1}return!0}function _isSameFingerprint(l,c){let d=l.fingerprint,h=c.fingerprint;if(!d&&!h)return!0;if(d&&!h||!d&&h)return!1;try{return!(d.join("")!==h.join(""))}catch(p){return!1}}function _getExceptionFromEvent(l){return l.exception&&l.exception.values&&l.exception.values[0]}function _getFramesFromEvent(l){const c=l.exception;if(c)try{return c.values[0].stacktrace.frames}catch(d){return}}convertIntegrationFnToClass(CS,dedupeIntegration);const ES="GlobalHandlers",globalHandlersIntegration=(l={})=>{const c={onerror:!0,onunhandledrejection:!0,...l};return{name:ES,setupOnce(){Error.stackTraceLimit=50},setup(l){c.onerror&&(!function(l){addGlobalErrorInstrumentationHandler((c=>{const{stackParser:d,attachStacktrace:h}=getOptions();if(getClient()!==l||shouldIgnoreOnError())return;const{msg:p,url:f,line:m,column:y,error:_}=c,b=void 0===_&&isString$1(p)?function(l,c,d,h){const p=/^(?:[Uu]ncaught (?:exception: )?)?(?:((?:Eval|Internal|Range|Reference|Syntax|Type|URI|)Error): )?(.*)$/i;let f=isErrorEvent$2(l)?l.message:l,m="Error";const y=f.match(p);y&&(m=y[1],f=y[2]);const _={exception:{values:[{type:m,value:f}]}};return _enhanceEventWithInitialFrame(_,c,d,h)}(p,f,m,y):_enhanceEventWithInitialFrame(eventFromUnknownInput(d,_||p,void 0,h,!1),f,m,y);b.level="error",captureEvent(b,{originalException:_,mechanism:{handled:!1,type:"onerror"}})}))}(l),globalHandlerLog("onerror")),c.onunhandledrejection&&(!function(l){addGlobalUnhandledRejectionInstrumentationHandler((c=>{const{stackParser:d,attachStacktrace:h}=getOptions();if(getClient()!==l||shouldIgnoreOnError())return;const p=function(l){if(isPrimitive$1(l))return l;const c=l;try{if("reason"in c)return c.reason;if("detail"in c&&"reason"in c.detail)return c.detail.reason}catch(d){}return l}(c),f=isPrimitive$1(p)?{exception:{values:[{type:"UnhandledRejection",value:`Non-Error promise rejection captured with value: ${String(p)}`}]}}:eventFromUnknownInput(d,p,void 0,h,!0);f.level="error",captureEvent(f,{originalException:p,mechanism:{handled:!1,type:"onunhandledrejection"}})}))}(l),globalHandlerLog("onunhandledrejection"))}}};function _enhanceEventWithInitialFrame(l,c,d,h){const p=l.exception=l.exception||{},f=p.values=p.values||[],m=f[0]=f[0]||{},y=m.stacktrace=m.stacktrace||{},_=y.frames=y.frames||[],b=isNaN(parseInt(h,10))?void 0:h,w=isNaN(parseInt(d,10))?void 0:d,E=isString$1(c)&&c.length>0?c:function(){try{return Db.document.location.href}catch(l){return""}}();return 0===_.length&&_.push({colno:b,filename:E,function:"?",in_app:!0,lineno:w}),l}function globalHandlerLog(l){pS&&Bb.log(`Global Handler attached: ${l}`)}function getOptions(){const l=getClient();return l&&l.getOptions()||{stackParser:()=>[],attachStacktrace:!1}}convertIntegrationFnToClass(ES,globalHandlersIntegration);const IS="HttpContext",httpContextIntegration=()=>({name:IS,setupOnce(){},preprocessEvent(l){if(!dS.navigator&&!dS.location&&!dS.document)return;const c=l.request&&l.request.url||dS.location&&dS.location.href,{referrer:d}=dS.document||{},{userAgent:h}=dS.navigator||{},p={...l.request&&l.request.headers,...d&&{Referer:d},...h&&{"User-Agent":h}},f={...l.request,...c&&{url:c},headers:p};l.request=f}});convertIntegrationFnToClass(IS,httpContextIntegration);const TS="LinkedErrors",linkedErrorsIntegration=(l={})=>{const c=l.limit||5,d=l.key||"cause";return{name:TS,setupOnce(){},preprocessEvent(l,h,p){const f=p.getOptions();applyAggregateErrorsToEvent(exceptionFromError,f.stackParser,f.maxValueLength,d,c,l,h)}}};convertIntegrationFnToClass(TS,linkedErrorsIntegration);const RS=["EventTarget","Window","Node","ApplicationCache","AudioTrackList","BroadcastChannel","ChannelMergerNode","CryptoOperation","EventSource","FileReader","HTMLUnknownElement","IDBDatabase","IDBRequest","IDBTransaction","KeyOperation","MediaController","MessagePort","ModalWindow","Notification","SVGElementInstance","Screen","SharedWorker","TextTrack","TextTrackCue","TextTrackList","WebSocket","WebSocketWorker","Worker","XMLHttpRequest","XMLHttpRequestEventTarget","XMLHttpRequestUpload"],AS="TryCatch",browserApiErrorsIntegration=(l={})=>{const c={XMLHttpRequest:!0,eventTarget:!0,requestAnimationFrame:!0,setInterval:!0,setTimeout:!0,...l};return{name:AS,setupOnce(){c.setTimeout&&fill(dS,"setTimeout",_wrapTimeFunction),c.setInterval&&fill(dS,"setInterval",_wrapTimeFunction),c.requestAnimationFrame&&fill(dS,"requestAnimationFrame",_wrapRAF),c.XMLHttpRequest&&"XMLHttpRequest"in dS&&fill(XMLHttpRequest.prototype,"send",_wrapXHR);const l=c.eventTarget;if(l){(Array.isArray(l)?l:RS).forEach(_wrapEventTarget)}}}};function _wrapTimeFunction(l){return function(...c){const d=c[0];return c[0]=wrap(d,{mechanism:{data:{function:getFunctionName(l)},handled:!1,type:"instrument"}}),l.apply(this,c)}}function _wrapRAF(l){return function(c){return l.apply(this,[wrap(c,{mechanism:{data:{function:"requestAnimationFrame",handler:getFunctionName(l)},handled:!1,type:"instrument"}})])}}function _wrapXHR(l){return function(...c){const d=this;return["onload","onerror","onprogress","onreadystatechange"].forEach((l=>{l in d&&"function"==typeof d[l]&&fill(d,l,(function(c){const d={mechanism:{data:{function:l,handler:getFunctionName(c)},handled:!1,type:"instrument"}},h=getOriginalFunction(c);return h&&(d.mechanism.data.handler=getFunctionName(h)),wrap(c,d)}))})),l.apply(this,c)}}function _wrapEventTarget(l){const c=dS,d=c[l]&&c[l].prototype;d&&d.hasOwnProperty&&d.hasOwnProperty("addEventListener")&&(fill(d,"addEventListener",(function(c){return function(d,h,p){try{"function"==typeof h.handleEvent&&(h.handleEvent=wrap(h.handleEvent,{mechanism:{data:{function:"handleEvent",handler:getFunctionName(h),target:l},handled:!1,type:"instrument"}}))}catch(f){}return c.apply(this,[d,wrap(h,{mechanism:{data:{function:"addEventListener",handler:getFunctionName(h),target:l},handled:!1,type:"instrument"}}),p])}})),fill(d,"removeEventListener",(function(l){return function(c,d,h){const p=d;try{const d=p&&p.__sentry_wrapped__;d&&l.call(this,c,d,h)}catch(hh){}return l.call(this,c,p,h)}})))}convertIntegrationFnToClass(AS,browserApiErrorsIntegration);const OS=[inboundFiltersIntegration(),functionToStringIntegration(),browserApiErrorsIntegration(),breadcrumbsIntegration(),globalHandlersIntegration(),linkedErrorsIntegration(),dedupeIntegration(),httpContextIntegration()];function init(l={}){void 0===l.defaultIntegrations&&(l.defaultIntegrations=[...OS]),void 0===l.release&&("string"==typeof __SENTRY_RELEASE__&&(l.release=__SENTRY_RELEASE__),dS.SENTRY_RELEASE&&dS.SENTRY_RELEASE.id&&(l.release=dS.SENTRY_RELEASE.id)),void 0===l.autoSessionTracking&&(l.autoSessionTracking=!0),void 0===l.sendClientReports&&(l.sendClientReports=!0);const c={...l,stackParser:(d=l.stackParser||SS,Array.isArray(d)?createStackParser(...d):d),integrations:getIntegrationsToSetup(l),transport:l.transport||(supportsFetch()?makeFetchTransport:makeXHRTransport)};var d;initAndBind(BrowserClient,c),l.autoSessionTracking&&function(){if(void 0===dS.document)return void(pS&&Bb.warn("Session tracking in non-browser environment with @sentry/browser is not supported."));startSession({ignoreDuration:!0}),captureSession(),addHistoryInstrumentationHandler((({from:l,to:c})=>{void 0!==l&&l!==c&&(startSession({ignoreDuration:!0}),captureSession())}))}()}const MS=jb,NS="sentryReplaySession",PS="Unable to send Replay",LS=15e4,jS=5e3,DS=2e7,FS=36e5;function _optionalChain$5(l){let c,d=l[0],h=1;for(;h<l.length;){const p=l[h],f=l[h+1];if(h+=2,("optionalAccess"===p||"optionalCall"===p)&&null==d)return;"access"===p||"optionalAccess"===p?(c=d,d=f(d)):"call"!==p&&"optionalCall"!==p||(d=f(((...l)=>d.call(c,...l))),c=void 0)}return d}var $S,US;function isShadowRoot$1(l){const c=_optionalChain$5([l,"optionalAccess",l=>l.host]);return Boolean(_optionalChain$5([c,"optionalAccess",l=>l.shadowRoot])===l)}function isNativeShadowDom(l){return"[object ShadowRoot]"===Object.prototype.toString.call(l)}function stringifyStylesheet(l){try{const d=l.rules||l.cssRules;return d?((c=Array.from(d,stringifyRule).join("")).includes(" background-clip: text;")&&!c.includes(" -webkit-background-clip: text;")&&(c=c.replace(" background-clip: text;"," -webkit-background-clip: text; background-clip: text;")),c):null}catch(d){return null}var c}function stringifyRule(l){let c;if(function(l){return"styleSheet"in l}(l))try{c=stringifyStylesheet(l.styleSheet)||function(l){const{cssText:c}=l;if(c.split('"').length<3)return c;const d=["@import",`url(${JSON.stringify(l.href)})`];return""===l.layerName?d.push("layer"):l.layerName&&d.push(`layer(${l.layerName})`),l.supportsText&&d.push(`supports(${l.supportsText})`),l.media.length&&d.push(l.media.mediaText),d.join(" ")+";"}(l)}catch(d){}else if(function(l){return"selectorText"in l}(l)&&l.selectorText.includes(":"))return function(l){const c=/(\[(?:[\w-]+)[^\\])(:(?:[\w-]+)\])/gm;return l.replace(c,"$1\\$2")}(l.cssText);return c||l.cssText}(US=$S||($S={}))[US.Document=0]="Document",US[US.DocumentType=1]="DocumentType",US[US.Element=2]="Element",US[US.Text=3]="Text",US[US.CDATA=4]="CDATA",US[US.Comment=5]="Comment";class Mirror{constructor(){this.idNodeMap=new Map,this.nodeMetaMap=new WeakMap}getId(l){if(!l)return-1;const c=_optionalChain$5([this,"access",l=>l.getMeta,"call",c=>c(l),"optionalAccess",l=>l.id]);return h=()=>-1,null!=(d=c)?d:h();var d,h}getNode(l){return this.idNodeMap.get(l)||null}getIds(){return Array.from(this.idNodeMap.keys())}getMeta(l){return this.nodeMetaMap.get(l)||null}removeNodeFromMap(l){const c=this.getId(l);this.idNodeMap.delete(c),l.childNodes&&l.childNodes.forEach((l=>this.removeNodeFromMap(l)))}has(l){return this.idNodeMap.has(l)}hasNode(l){return this.nodeMetaMap.has(l)}add(l,c){const d=c.id;this.idNodeMap.set(d,l),this.nodeMetaMap.set(l,c)}replace(l,c){const d=this.getNode(l);if(d){const l=this.nodeMetaMap.get(d);l&&this.nodeMetaMap.set(c,l)}this.idNodeMap.set(l,c)}reset(){this.idNodeMap=new Map,this.nodeMetaMap=new WeakMap}}function shouldMaskInput({maskInputOptions:l,tagName:c,type:d}){return"OPTION"===c&&(c="SELECT"),Boolean(l[c.toLowerCase()]||d&&l[d]||"password"===d||"INPUT"===c&&!d&&l.text)}function maskInputValue({isMasked:l,element:c,value:d,maskInputFn:h}){let p=d||"";return l?(h&&(p=h(p,c)),"*".repeat(p.length)):p}function toLowerCase(l){return l.toLowerCase()}function toUpperCase(l){return l.toUpperCase()}const BS="__rrweb_original__";function getInputType(l){const c=l.type;return l.hasAttribute("data-rr-is-password")?"password":c?toLowerCase(c):null}function getInputValue(l,c,d){return"INPUT"!==c||"radio"!==d&&"checkbox"!==d?l.value:l.getAttribute("value")||""}let HS=1;const zS=new RegExp("[^a-z0-9-_:]");function genId(){return HS++}let qS,WS;const VS=/url\((?:(')([^']*)'|(")(.*?)"|([^)]*))\)/gm,ZS=/^(?:[a-z+]+:)?\/\//i,GS=/^www\..*/i,KS=/^(data:)([^,]*),(.*)/i;function absoluteToStylesheet(l,c){return(l||"").replace(VS,((l,d,h,p,f,m)=>{const y=h||f||m,_=d||p||"";if(!y)return l;if(ZS.test(y)||GS.test(y))return`url(${_}${y}${_})`;if(KS.test(y))return`url(${_}${y}${_})`;if("/"===y[0])return`url(${_}${function(l){let c="";return c=l.indexOf("//")>-1?l.split("/").slice(0,3).join("/"):l.split("/")[0],c=c.split("?")[0],c}(c)+y}${_})`;const b=c.split("/"),w=y.split("/");b.pop();for(const c of w)"."!==c&&(".."===c?b.pop():b.push(c));return`url(${_}${b.join("/")}${_})`}))}const JS=/^[^ \t\n\r\u000c]+/,YS=/^[, \t\n\r\u000c]+/;function absoluteToDoc(l,c){if(!c||""===c.trim())return c;const d=l.createElement("a");return d.href=c,d.href}function isSVGElement(l){return Boolean("svg"===l.tagName||l.ownerSVGElement)}function getHref(){const l=document.createElement("a");return l.href="",l.href}function transformAttribute(l,c,d,h,p,f){return h?"src"===d||"href"===d&&("use"!==c||"#"!==h[0])||"xlink:href"===d&&"#"!==h[0]?absoluteToDoc(l,h):"background"!==d||"table"!==c&&"td"!==c&&"th"!==c?"srcset"===d?function(l,c){if(""===c.trim())return c;let d=0;function collectCharacters(l){let h;const p=l.exec(c.substring(d));return p?(h=p[0],d+=h.length,h):""}const h=[];for(;collectCharacters(YS),!(d>=c.length);){let p=collectCharacters(JS);if(","===p.slice(-1))p=absoluteToDoc(l,p.substring(0,p.length-1)),h.push(p);else{let f="";p=absoluteToDoc(l,p);let m=!1;for(;;){const l=c.charAt(d);if(""===l){h.push((p+f).trim());break}if(m)")"===l&&(m=!1);else{if(","===l){d+=1,h.push((p+f).trim());break}"("===l&&(m=!0)}f+=l,d+=1}}}return h.join(", ")}(l,h):"style"===d?absoluteToStylesheet(h,getHref()):"object"===c&&"data"===d?absoluteToDoc(l,h):"function"==typeof f?f(d,h,p):h:absoluteToDoc(l,h):h}function ignoreAttribute(l,c,d){return("video"===l||"audio"===l)&&"autoplay"===c}function distanceToMatch(l,c,d=1/0,h=0){return l?l.nodeType!==l.ELEMENT_NODE||h>d?-1:c(l)?h:distanceToMatch(l.parentNode,c,d,h+1):-1}function createMatchPredicate(l,c){return d=>{const h=d;if(null===h)return!1;try{if(l)if("string"==typeof l){if(h.matches(`.${l}`))return!0}else if(function(l,c){for(let d=l.classList.length;d--;){const h=l.classList[d];if(c.test(h))return!0}return!1}(h,l))return!0;return!(!c||!h.matches(c))}catch(p){return!1}}}function needMaskingText(l,c,d,h,p,f){try{const m=l.nodeType===l.ELEMENT_NODE?l:l.parentElement;if(null===m)return!1;if("INPUT"===m.tagName){const l=m.getAttribute("autocomplete");if(["current-password","new-password","cc-number","cc-exp","cc-exp-month","cc-exp-year","cc-csc"].includes(l))return!0}let y=-1,_=-1;if(f){if(_=distanceToMatch(m,createMatchPredicate(h,p)),_<0)return!0;y=distanceToMatch(m,createMatchPredicate(c,d),_>=0?_:1/0)}else{if(y=distanceToMatch(m,createMatchPredicate(c,d)),y<0)return!1;_=distanceToMatch(m,createMatchPredicate(h,p),y>=0?y:1/0)}return y>=0?!(_>=0)||y<=_:!(_>=0)&&!!f}catch(hh){}return!!f}function serializeNode(l,c){const{doc:d,mirror:h,blockClass:p,blockSelector:f,unblockSelector:m,maskAllText:y,maskAttributeFn:_,maskTextClass:b,unmaskTextClass:w,maskTextSelector:E,unmaskTextSelector:M,inlineStylesheet:N,maskInputOptions:P={},maskTextFn:L,maskInputFn:j,dataURLOptions:D={},inlineImages:F,recordCanvas:U,keepIframeSrcFn:B,newlyAddedElement:H=!1}=c,z=function(l,c){if(!c.hasNode(l))return;const d=c.getId(l);return 1===d?void 0:d}(d,h);switch(l.nodeType){case l.DOCUMENT_NODE:return"CSS1Compat"!==l.compatMode?{type:$S.Document,childNodes:[],compatMode:l.compatMode}:{type:$S.Document,childNodes:[]};case l.DOCUMENT_TYPE_NODE:return{type:$S.DocumentType,name:l.name,publicId:l.publicId,systemId:l.systemId,rootId:z};case l.ELEMENT_NODE:return function(l,c){const{doc:d,blockClass:h,blockSelector:p,unblockSelector:f,inlineStylesheet:m,maskInputOptions:y={},maskAttributeFn:_,maskInputFn:b,dataURLOptions:w={},inlineImages:E,recordCanvas:M,keepIframeSrcFn:N,newlyAddedElement:P=!1,rootId:L,maskTextClass:j,unmaskTextClass:D,maskTextSelector:F,unmaskTextSelector:U}=c,B=function(l,c,d,h){try{if(h&&l.matches(h))return!1;if("string"==typeof c){if(l.classList.contains(c))return!0}else for(let d=l.classList.length;d--;){const h=l.classList[d];if(c.test(h))return!0}if(d)return l.matches(d)}catch(hh){}return!1}(l,h,p,f),H=function(l){if(l instanceof HTMLFormElement)return"form";const c=toLowerCase(l.tagName);return zS.test(c)?"div":c}(l);let z={};const q=l.attributes.length;for(let Z=0;Z<q;Z++){const c=l.attributes[Z];c.name&&!ignoreAttribute(H,c.name,c.value)&&(z[c.name]=transformAttribute(d,H,toLowerCase(c.name),c.value,l,_))}if("link"===H&&m){const c=Array.from(d.styleSheets).find((c=>c.href===l.href));let h=null;c&&(h=stringifyStylesheet(c)),h&&(delete z.rel,delete z.href,z._cssText=absoluteToStylesheet(h,c.href))}if("style"===H&&l.sheet&&!(l.innerText||l.textContent||"").trim().length){const c=stringifyStylesheet(l.sheet);c&&(z._cssText=absoluteToStylesheet(c,getHref()))}if("input"===H||"textarea"===H||"select"===H||"option"===H){const c=l,d=getInputType(c),h=getInputValue(c,toUpperCase(H),d),p=c.checked;if("submit"!==d&&"button"!==d&&h){const l=needMaskingText(c,j,F,D,U,shouldMaskInput({type:d,tagName:toUpperCase(H),maskInputOptions:y}));z.value=maskInputValue({isMasked:l,element:c,value:h,maskInputFn:b})}p&&(z.checked=p)}"option"===H&&(l.selected&&!y.select?z.selected=!0:delete z.selected);if("canvas"===H&&M)if("2d"===l.__context)(function(l){const c=l.getContext("2d");if(!c)return!0;for(let d=0;d<l.width;d+=50)for(let h=0;h<l.height;h+=50){const p=c.getImageData,f=BS in p?p[BS]:p;if(new Uint32Array(f.call(c,d,h,Math.min(50,l.width-d),Math.min(50,l.height-h)).data.buffer).some((l=>0!==l)))return!1}return!0})(l)||(z.rr_dataURL=l.toDataURL(w.type,w.quality));else if(!("__context"in l)){const c=l.toDataURL(w.type,w.quality),d=document.createElement("canvas");d.width=l.width,d.height=l.height;c!==d.toDataURL(w.type,w.quality)&&(z.rr_dataURL=c)}if("img"===H&&E){qS||(qS=d.createElement("canvas"),WS=qS.getContext("2d"));const c=l,h=c.crossOrigin;c.crossOrigin="anonymous";const recordInlineImage=()=>{c.removeEventListener("load",recordInlineImage);try{qS.width=c.naturalWidth,qS.height=c.naturalHeight,WS.drawImage(c,0,0),z.rr_dataURL=qS.toDataURL(w.type,w.quality)}catch(l){console.warn(`Cannot inline img src=${c.currentSrc}! Error: ${l}`)}h?z.crossOrigin=h:c.removeAttribute("crossorigin")};c.complete&&0!==c.naturalWidth?recordInlineImage():c.addEventListener("load",recordInlineImage)}"audio"!==H&&"video"!==H||(z.rr_mediaState=l.paused?"paused":"played",z.rr_mediaCurrentTime=l.currentTime);P||(l.scrollLeft&&(z.rr_scrollLeft=l.scrollLeft),l.scrollTop&&(z.rr_scrollTop=l.scrollTop));if(B){const{width:c,height:d}=l.getBoundingClientRect();z={class:z.class,rr_width:`${c}px`,rr_height:`${d}px`}}"iframe"!==H||N(z.src)||(l.contentDocument||(z.rr_src=z.src),delete z.src);let V;try{customElements.get(H)&&(V=!0)}catch(hh){}return{type:$S.Element,tagName:H,attributes:z,childNodes:[],isSVG:isSVGElement(l)||void 0,needBlock:B,rootId:L,isCustom:V}}(l,{doc:d,blockClass:p,blockSelector:f,unblockSelector:m,inlineStylesheet:N,maskAttributeFn:_,maskInputOptions:P,maskInputFn:j,dataURLOptions:D,inlineImages:F,recordCanvas:U,keepIframeSrcFn:B,newlyAddedElement:H,rootId:z,maskTextClass:b,unmaskTextClass:w,maskTextSelector:E,unmaskTextSelector:M});case l.TEXT_NODE:return function(l,c){const{maskAllText:d,maskTextClass:h,unmaskTextClass:p,maskTextSelector:f,unmaskTextSelector:m,maskTextFn:y,maskInputOptions:_,maskInputFn:b,rootId:w}=c,E=l.parentNode&&l.parentNode.tagName;let M=l.textContent;const N="STYLE"===E||void 0,P="SCRIPT"===E||void 0,L="TEXTAREA"===E||void 0;if(N&&M){try{l.nextSibling||l.previousSibling||_optionalChain$5([l,"access",l=>l.parentNode,"access",l=>l.sheet,"optionalAccess",l=>l.cssRules])&&(M=stringifyStylesheet(l.parentNode.sheet))}catch(D){console.warn(`Cannot get CSS styles from text's parentNode. Error: ${D}`,l)}M=absoluteToStylesheet(M,getHref())}P&&(M="SCRIPT_PLACEHOLDER");const j=needMaskingText(l,h,f,p,m,d);N||P||L||!M||!j||(M=y?y(M,l.parentElement):M.replace(/[\S]/g,"*"));L&&M&&(_.textarea||j)&&(M=b?b(M,l.parentNode):M.replace(/[\S]/g,"*"));if("OPTION"===E&&M){M=maskInputValue({isMasked:needMaskingText(l,h,f,p,m,shouldMaskInput({type:null,tagName:E,maskInputOptions:_})),element:l,value:M,maskInputFn:b})}return{type:$S.Text,textContent:M||"",isStyle:N,rootId:w}}(l,{maskAllText:y,maskTextClass:b,unmaskTextClass:w,maskTextSelector:E,unmaskTextSelector:M,maskTextFn:L,maskInputOptions:P,maskInputFn:j,rootId:z});case l.CDATA_SECTION_NODE:return{type:$S.CDATA,textContent:"",rootId:z};case l.COMMENT_NODE:return{type:$S.Comment,textContent:l.textContent||"",rootId:z};default:return!1}}function lowerIfExists(l){return null==l?"":l.toLowerCase()}function serializeNodeWithId(l,c){const{doc:d,mirror:h,blockClass:p,blockSelector:f,unblockSelector:m,maskAllText:y,maskTextClass:_,unmaskTextClass:b,maskTextSelector:w,unmaskTextSelector:E,skipChild:M=!1,inlineStylesheet:N=!0,maskInputOptions:P={},maskAttributeFn:L,maskTextFn:j,maskInputFn:D,slimDOMOptions:F,dataURLOptions:U={},inlineImages:B=!1,recordCanvas:H=!1,onSerialize:z,onIframeLoad:q,iframeLoadTimeout:V=5e3,onStylesheetLoad:Z,stylesheetLoadTimeout:K=5e3,keepIframeSrcFn:Y=()=>!1,newlyAddedElement:ee=!1}=c;let{preserveWhiteSpace:ne=!0}=c;const se=serializeNode(l,{doc:d,mirror:h,blockClass:p,blockSelector:f,maskAllText:y,unblockSelector:m,maskTextClass:_,unmaskTextClass:b,maskTextSelector:w,unmaskTextSelector:E,inlineStylesheet:N,maskInputOptions:P,maskAttributeFn:L,maskTextFn:j,maskInputFn:D,dataURLOptions:U,inlineImages:B,recordCanvas:H,keepIframeSrcFn:Y,newlyAddedElement:ee});if(!se)return console.warn(l,"not serialized"),null;let ie;ie=h.hasNode(l)?h.getId(l):!function(l,c){if(c.comment&&l.type===$S.Comment)return!0;if(l.type===$S.Element){if(c.script&&("script"===l.tagName||"link"===l.tagName&&("preload"===l.attributes.rel||"modulepreload"===l.attributes.rel)&&"script"===l.attributes.as||"link"===l.tagName&&"prefetch"===l.attributes.rel&&"string"==typeof l.attributes.href&&l.attributes.href.endsWith(".js")))return!0;if(c.headFavicon&&("link"===l.tagName&&"shortcut icon"===l.attributes.rel||"meta"===l.tagName&&(lowerIfExists(l.attributes.name).match(/^msapplication-tile(image|color)$/)||"application-name"===lowerIfExists(l.attributes.name)||"icon"===lowerIfExists(l.attributes.rel)||"apple-touch-icon"===lowerIfExists(l.attributes.rel)||"shortcut icon"===lowerIfExists(l.attributes.rel))))return!0;if("meta"===l.tagName){if(c.headMetaDescKeywords&&lowerIfExists(l.attributes.name).match(/^description|keywords$/))return!0;if(c.headMetaSocial&&(lowerIfExists(l.attributes.property).match(/^(og|twitter|fb):/)||lowerIfExists(l.attributes.name).match(/^(og|twitter):/)||"pinterest"===lowerIfExists(l.attributes.name)))return!0;if(c.headMetaRobots&&("robots"===lowerIfExists(l.attributes.name)||"googlebot"===lowerIfExists(l.attributes.name)||"bingbot"===lowerIfExists(l.attributes.name)))return!0;if(c.headMetaHttpEquiv&&void 0!==l.attributes["http-equiv"])return!0;if(c.headMetaAuthorship&&("author"===lowerIfExists(l.attributes.name)||"generator"===lowerIfExists(l.attributes.name)||"framework"===lowerIfExists(l.attributes.name)||"publisher"===lowerIfExists(l.attributes.name)||"progid"===lowerIfExists(l.attributes.name)||lowerIfExists(l.attributes.property).match(/^article:/)||lowerIfExists(l.attributes.property).match(/^product:/)))return!0;if(c.headMetaVerification&&("google-site-verification"===lowerIfExists(l.attributes.name)||"yandex-verification"===lowerIfExists(l.attributes.name)||"csrf-token"===lowerIfExists(l.attributes.name)||"p:domain_verify"===lowerIfExists(l.attributes.name)||"verify-v1"===lowerIfExists(l.attributes.name)||"verification"===lowerIfExists(l.attributes.name)||"shopify-checkout-api-token"===lowerIfExists(l.attributes.name)))return!0}}return!1}(se,F)&&(ne||se.type!==$S.Text||se.isStyle||se.textContent.replace(/^\s+|\s+$/gm,"").length)?genId():-2;const oe=Object.assign(se,{id:ie});if(h.add(l,oe),-2===ie)return null;z&&z(l);let le=!M;if(oe.type===$S.Element){le=le&&!oe.needBlock,delete oe.needBlock;const c=l.shadowRoot;c&&isNativeShadowDom(c)&&(oe.isShadowHost=!0)}if((oe.type===$S.Document||oe.type===$S.Element)&&le){F.headWhitespace&&oe.type===$S.Element&&"head"===oe.tagName&&(ne=!1);const c={doc:d,mirror:h,blockClass:p,blockSelector:f,maskAllText:y,unblockSelector:m,maskTextClass:_,unmaskTextClass:b,maskTextSelector:w,unmaskTextSelector:E,skipChild:M,inlineStylesheet:N,maskInputOptions:P,maskAttributeFn:L,maskTextFn:j,maskInputFn:D,slimDOMOptions:F,dataURLOptions:U,inlineImages:B,recordCanvas:H,preserveWhiteSpace:ne,onSerialize:z,onIframeLoad:q,iframeLoadTimeout:V,onStylesheetLoad:Z,stylesheetLoadTimeout:K,keepIframeSrcFn:Y};for(const d of Array.from(l.childNodes)){const l=serializeNodeWithId(d,c);l&&oe.childNodes.push(l)}if(function(l){return l.nodeType===l.ELEMENT_NODE}(l)&&l.shadowRoot)for(const d of Array.from(l.shadowRoot.childNodes)){const h=serializeNodeWithId(d,c);h&&(isNativeShadowDom(l.shadowRoot)&&(h.isShadow=!0),oe.childNodes.push(h))}}return l.parentNode&&isShadowRoot$1(l.parentNode)&&isNativeShadowDom(l.parentNode)&&(oe.isShadow=!0),oe.type===$S.Element&&"iframe"===oe.tagName&&function(l,c,d){const h=l.contentWindow;if(!h)return;let p,f=!1;try{p=h.document.readyState}catch(y){return}if("complete"!==p){const h=setTimeout((()=>{f||(c(),f=!0)}),d);return void l.addEventListener("load",(()=>{clearTimeout(h),f=!0,c()}))}const m="about:blank";if(h.location.href!==m||l.src===m||""===l.src)return setTimeout(c,0),l.addEventListener("load",c);l.addEventListener("load",c)}(l,(()=>{const c=l.contentDocument;if(c&&q){const d=serializeNodeWithId(c,{doc:c,mirror:h,blockClass:p,blockSelector:f,unblockSelector:m,maskAllText:y,maskTextClass:_,unmaskTextClass:b,maskTextSelector:w,unmaskTextSelector:E,skipChild:!1,inlineStylesheet:N,maskInputOptions:P,maskAttributeFn:L,maskTextFn:j,maskInputFn:D,slimDOMOptions:F,dataURLOptions:U,inlineImages:B,recordCanvas:H,preserveWhiteSpace:ne,onSerialize:z,onIframeLoad:q,iframeLoadTimeout:V,onStylesheetLoad:Z,stylesheetLoadTimeout:K,keepIframeSrcFn:Y});d&&q(l,d)}}),V),oe.type===$S.Element&&"link"===oe.tagName&&"stylesheet"===oe.attributes.rel&&function(l,c,d){let h,p=!1;try{h=l.sheet}catch(m){return}if(h)return;const f=setTimeout((()=>{p||(c(),p=!0)}),d);l.addEventListener("load",(()=>{clearTimeout(f),p=!0,c()}))}(l,(()=>{if(Z){const c=serializeNodeWithId(l,{doc:d,mirror:h,blockClass:p,blockSelector:f,unblockSelector:m,maskAllText:y,maskTextClass:_,unmaskTextClass:b,maskTextSelector:w,unmaskTextSelector:E,skipChild:!1,inlineStylesheet:N,maskInputOptions:P,maskAttributeFn:L,maskTextFn:j,maskInputFn:D,slimDOMOptions:F,dataURLOptions:U,inlineImages:B,recordCanvas:H,preserveWhiteSpace:ne,onSerialize:z,onIframeLoad:q,iframeLoadTimeout:V,onStylesheetLoad:Z,stylesheetLoadTimeout:K,keepIframeSrcFn:Y});c&&Z(l,c)}}),K),oe}function _optionalChain$4(l){let c,d=l[0],h=1;for(;h<l.length;){const p=l[h],f=l[h+1];if(h+=2,("optionalAccess"===p||"optionalCall"===p)&&null==d)return;"access"===p||"optionalAccess"===p?(c=d,d=f(d)):"call"!==p&&"optionalCall"!==p||(d=f(((...l)=>d.call(c,...l))),c=void 0)}return d}function on(l,c,d=document){const h={capture:!0,passive:!0};return d.addEventListener(l,c,h),()=>d.removeEventListener(l,c,h)}const QS="Please stop import mirror directly. Instead of that,\r\nnow you can use replayer.getMirror() to access the mirror instance of a replayer,\r\nor you can use record.mirror to access the mirror instance during recording.";let XS={map:{},getId:()=>(console.error(QS),-1),getNode:()=>(console.error(QS),null),removeNodeFromMap(){console.error(QS)},has:()=>(console.error(QS),!1),reset(){console.error(QS)}};function throttle$1(l,c,d={}){let h=null,p=0;return function(...f){const m=Date.now();p||!1!==d.leading||(p=m);const y=c-(m-p),_=this;y<=0||y>c?(h&&(!function(...l){getImplementation("clearTimeout")(...l)}(h),h=null),p=m,l.apply(_,f)):h||!1===d.trailing||(h=setTimeout$1((()=>{p=!1===d.leading?0:Date.now(),h=null,l.apply(_,f)}),y))}}function hookSetter(l,c,d,h,p=window){const f=p.Object.getOwnPropertyDescriptor(l,c);return p.Object.defineProperty(l,c,h?d:{set(l){setTimeout$1((()=>{d.set.call(this,l)}),0),f&&f.set&&f.set.call(this,l)}}),()=>hookSetter(l,c,f||{},!0)}function patch(l,c,d){try{if(!(c in l))return()=>{};const h=l[c],p=d(h);return"function"==typeof p&&(p.prototype=p.prototype||{},Object.defineProperties(p,{__rrweb_original__:{enumerable:!1,value:h}})),l[c]=p,()=>{l[c]=h}}catch(h){return()=>{}}}"undefined"!=typeof window&&window.Proxy&&window.Reflect&&(XS=new Proxy(XS,{get:(l,c,d)=>("map"===c&&console.error(QS),Reflect.get(l,c,d))}));let ex=Date.now;function getWindowScroll(l){const c=l.document;return{left:c.scrollingElement?c.scrollingElement.scrollLeft:void 0!==l.pageXOffset?l.pageXOffset:_optionalChain$4([c,"optionalAccess",l=>l.documentElement,"access",l=>l.scrollLeft])||_optionalChain$4([c,"optionalAccess",l=>l.body,"optionalAccess",l=>l.parentElement,"optionalAccess",l=>l.scrollLeft])||_optionalChain$4([c,"optionalAccess",l=>l.body,"optionalAccess",l=>l.scrollLeft])||0,top:c.scrollingElement?c.scrollingElement.scrollTop:void 0!==l.pageYOffset?l.pageYOffset:_optionalChain$4([c,"optionalAccess",l=>l.documentElement,"access",l=>l.scrollTop])||_optionalChain$4([c,"optionalAccess",l=>l.body,"optionalAccess",l=>l.parentElement,"optionalAccess",l=>l.scrollTop])||_optionalChain$4([c,"optionalAccess",l=>l.body,"optionalAccess",l=>l.scrollTop])||0}}function getWindowHeight(){return window.innerHeight||document.documentElement&&document.documentElement.clientHeight||document.body&&document.body.clientHeight}function getWindowWidth(){return window.innerWidth||document.documentElement&&document.documentElement.clientWidth||document.body&&document.body.clientWidth}function closestElementOfNode(l){if(!l)return null;return l.nodeType===l.ELEMENT_NODE?l:l.parentElement}function isBlocked(l,c,d,h,p){if(!l)return!1;const f=closestElementOfNode(l);if(!f)return!1;const m=createMatchPredicate(c,d);if(!p){const l=h&&f.matches(h);return m(f)&&!l}const y=distanceToMatch(f,m);let _=-1;return!(y<0)&&(h&&(_=distanceToMatch(f,createMatchPredicate(null,h))),y>-1&&_<0||y<_)}function isIgnored(l,c){return-2===c.getId(l)}function isAncestorRemoved(l,c){if(isShadowRoot$1(l))return!1;const d=c.getId(l);return!c.has(d)||(!l.parentNode||l.parentNode.nodeType!==l.DOCUMENT_NODE)&&(!l.parentNode||isAncestorRemoved(l.parentNode,c))}function legacy_isTouchEvent(l){return Boolean(l.changedTouches)}function isSerializedIframe(l,c){return Boolean("IFRAME"===l.nodeName&&c.getMeta(l))}function isSerializedStylesheet(l,c){return Boolean("LINK"===l.nodeName&&l.nodeType===l.ELEMENT_NODE&&l.getAttribute&&"stylesheet"===l.getAttribute("rel")&&c.getMeta(l))}function hasShadowRoot(l){return Boolean(_optionalChain$4([l,"optionalAccess",l=>l.shadowRoot]))}/[1-9][0-9]{12}/.test(Date.now().toString())||(ex=()=>(new Date).getTime());class StyleSheetMirror{constructor(){this.id=1,this.styleIDMap=new WeakMap,this.idStyleMap=new Map}getId(l){return c=this.styleIDMap.get(l),d=()=>-1,null!=c?c:d();var c,d}has(l){return this.styleIDMap.has(l)}add(l,c){if(this.has(l))return this.getId(l);let d;return d=void 0===c?this.id++:c,this.styleIDMap.set(l,d),this.idStyleMap.set(d,l),d}getStyle(l){return this.idStyleMap.get(l)||null}reset(){this.styleIDMap=new WeakMap,this.idStyleMap=new Map,this.id=1}generateId(){return this.id++}}function getShadowHost(l){let c=null;return _optionalChain$4([l,"access",l=>l.getRootNode,"optionalCall",l=>l(),"optionalAccess",l=>l.nodeType])===Node.DOCUMENT_FRAGMENT_NODE&&l.getRootNode().host&&(c=l.getRootNode().host),c}function shadowHostInDom(l){const c=l.ownerDocument;if(!c)return!1;const d=function(l){let c,d=l;for(;c=getShadowHost(d);)d=c;return d}(l);return c.contains(d)}function inDom(l){const c=l.ownerDocument;return!!c&&(c.contains(l)||shadowHostInDom(l))}const tx={};function getImplementation(l){const c=tx[l];if(c)return c;const d=window.document;let h=window[l];if(d&&"function"==typeof d.createElement)try{const c=d.createElement("iframe");c.hidden=!0,d.head.appendChild(c);const p=c.contentWindow;p&&p[l]&&(h=p[l]),d.head.removeChild(c)}catch(hh){}return tx[l]=h.bind(window)}function setTimeout$1(...l){return getImplementation("setTimeout")(...l)}var rx=(l=>(l[l.DomContentLoaded=0]="DomContentLoaded",l[l.Load=1]="Load",l[l.FullSnapshot=2]="FullSnapshot",l[l.IncrementalSnapshot=3]="IncrementalSnapshot",l[l.Meta=4]="Meta",l[l.Custom=5]="Custom",l[l.Plugin=6]="Plugin",l))(rx||{}),nx=(l=>(l[l.Mutation=0]="Mutation",l[l.MouseMove=1]="MouseMove",l[l.MouseInteraction=2]="MouseInteraction",l[l.Scroll=3]="Scroll",l[l.ViewportResize=4]="ViewportResize",l[l.Input=5]="Input",l[l.TouchMove=6]="TouchMove",l[l.MediaInteraction=7]="MediaInteraction",l[l.StyleSheetRule=8]="StyleSheetRule",l[l.CanvasMutation=9]="CanvasMutation",l[l.Font=10]="Font",l[l.Log=11]="Log",l[l.Drag=12]="Drag",l[l.StyleDeclaration=13]="StyleDeclaration",l[l.Selection=14]="Selection",l[l.AdoptedStyleSheet=15]="AdoptedStyleSheet",l[l.CustomElement=16]="CustomElement",l))(nx||{}),sx=(l=>(l[l.MouseUp=0]="MouseUp",l[l.MouseDown=1]="MouseDown",l[l.Click=2]="Click",l[l.ContextMenu=3]="ContextMenu",l[l.DblClick=4]="DblClick",l[l.Focus=5]="Focus",l[l.Blur=6]="Blur",l[l.TouchStart=7]="TouchStart",l[l.TouchMove_Departed=8]="TouchMove_Departed",l[l.TouchEnd=9]="TouchEnd",l[l.TouchCancel=10]="TouchCancel",l))(sx||{}),ix=(l=>(l[l.Mouse=0]="Mouse",l[l.Pen=1]="Pen",l[l.Touch=2]="Touch",l))(ix||{});function _optionalChain$3(l){let c,d=l[0],h=1;for(;h<l.length;){const p=l[h],f=l[h+1];if(h+=2,("optionalAccess"===p||"optionalCall"===p)&&null==d)return;"access"===p||"optionalAccess"===p?(c=d,d=f(d)):"call"!==p&&"optionalCall"!==p||(d=f(((...l)=>d.call(c,...l))),c=void 0)}return d}function isNodeInLinkedList(l){return"__ln"in l}class DoubleLinkedList{constructor(){this.length=0,this.head=null,this.tail=null}get(l){if(l>=this.length)throw new Error("Position outside of list range");let c=this.head;for(let d=0;d<l;d++)c=_optionalChain$3([c,"optionalAccess",l=>l.next])||null;return c}addNode(l){const c={value:l,previous:null,next:null};if(l.__ln=c,l.previousSibling&&isNodeInLinkedList(l.previousSibling)){const d=l.previousSibling.__ln.next;c.next=d,c.previous=l.previousSibling.__ln,l.previousSibling.__ln.next=c,d&&(d.previous=c)}else if(l.nextSibling&&isNodeInLinkedList(l.nextSibling)&&l.nextSibling.__ln.previous){const d=l.nextSibling.__ln.previous;c.previous=d,c.next=l.nextSibling.__ln,l.nextSibling.__ln.previous=c,d&&(d.next=c)}else this.head&&(this.head.previous=c),c.next=this.head,this.head=c;null===c.next&&(this.tail=c),this.length++}removeNode(l){const c=l.__ln;this.head&&(c.previous?(c.previous.next=c.next,c.next?c.next.previous=c.previous:this.tail=c.previous):(this.head=c.next,this.head?this.head.previous=null:this.tail=null),l.__ln&&delete l.__ln,this.length--)}}const moveKey=(l,c)=>`${l}@${c}`;class MutationBuffer{constructor(){this.frozen=!1,this.locked=!1,this.texts=[],this.attributes=[],this.attributeMap=new WeakMap,this.removes=[],this.mapRemoves=[],this.movedMap={},this.addedSet=new Set,this.movedSet=new Set,this.droppedSet=new Set,this.processMutations=l=>{l.forEach(this.processMutation),this.emit()},this.emit=()=>{if(this.frozen||this.locked)return;const l=[],c=new Set,d=new DoubleLinkedList,getNextId=l=>{let c=l,d=-2;for(;-2===d;)c=c&&c.nextSibling,d=c&&this.mirror.getId(c);return d},pushAdd=h=>{if(!h.parentNode||!inDom(h))return;const p=isShadowRoot$1(h.parentNode)?this.mirror.getId(getShadowHost(h)):this.mirror.getId(h.parentNode),f=getNextId(h);if(-1===p||-1===f)return d.addNode(h);const m=serializeNodeWithId(h,{doc:this.doc,mirror:this.mirror,blockClass:this.blockClass,blockSelector:this.blockSelector,maskAllText:this.maskAllText,unblockSelector:this.unblockSelector,maskTextClass:this.maskTextClass,unmaskTextClass:this.unmaskTextClass,maskTextSelector:this.maskTextSelector,unmaskTextSelector:this.unmaskTextSelector,skipChild:!0,newlyAddedElement:!0,inlineStylesheet:this.inlineStylesheet,maskInputOptions:this.maskInputOptions,maskAttributeFn:this.maskAttributeFn,maskTextFn:this.maskTextFn,maskInputFn:this.maskInputFn,slimDOMOptions:this.slimDOMOptions,dataURLOptions:this.dataURLOptions,recordCanvas:this.recordCanvas,inlineImages:this.inlineImages,onSerialize:l=>{isSerializedIframe(l,this.mirror)&&this.iframeManager.addIframe(l),isSerializedStylesheet(l,this.mirror)&&this.stylesheetManager.trackLinkElement(l),hasShadowRoot(h)&&this.shadowDomManager.addShadowRoot(h.shadowRoot,this.doc)},onIframeLoad:(l,c)=>{this.iframeManager.attachIframe(l,c),this.shadowDomManager.observeAttachShadow(l)},onStylesheetLoad:(l,c)=>{this.stylesheetManager.attachLinkElement(l,c)}});m&&(l.push({parentId:p,nextId:f,node:m}),c.add(m.id))};for(;this.mapRemoves.length;)this.mirror.removeNodeFromMap(this.mapRemoves.shift());for(const f of this.movedSet)isParentRemoved(this.removes,f,this.mirror)&&!this.movedSet.has(f.parentNode)||pushAdd(f);for(const f of this.addedSet)isAncestorInSet(this.droppedSet,f)||isParentRemoved(this.removes,f,this.mirror)?isAncestorInSet(this.movedSet,f)?pushAdd(f):this.droppedSet.add(f):pushAdd(f);let h=null;for(;d.length;){let l=null;if(h){const c=this.mirror.getId(h.value.parentNode),d=getNextId(h.value);-1!==c&&-1!==d&&(l=h)}if(!l){let c=d.tail;for(;c;){const d=c;if(c=c.previous,d){const c=this.mirror.getId(d.value.parentNode);if(-1===getNextId(d.value))continue;if(-1!==c){l=d;break}{const c=d.value;if(c.parentNode&&c.parentNode.nodeType===Node.DOCUMENT_FRAGMENT_NODE){const h=c.parentNode.host;if(-1!==this.mirror.getId(h)){l=d;break}}}}}}if(!l){for(;d.head;)d.removeNode(d.head.value);break}h=l.previous,d.removeNode(l.value),pushAdd(l.value)}const p={texts:this.texts.map((l=>({id:this.mirror.getId(l.node),value:l.value}))).filter((l=>!c.has(l.id))).filter((l=>this.mirror.has(l.id))),attributes:this.attributes.map((l=>{const{attributes:c}=l;if("string"==typeof c.style){const d=JSON.stringify(l.styleDiff),h=JSON.stringify(l._unchangedStyles);d.length<c.style.length&&(d+h).split("var(").length===c.style.split("var(").length&&(c.style=l.styleDiff)}return{id:this.mirror.getId(l.node),attributes:c}})).filter((l=>!c.has(l.id))).filter((l=>this.mirror.has(l.id))),removes:this.removes,adds:l};(p.texts.length||p.attributes.length||p.removes.length||p.adds.length)&&(this.texts=[],this.attributes=[],this.attributeMap=new WeakMap,this.removes=[],this.addedSet=new Set,this.movedSet=new Set,this.droppedSet=new Set,this.movedMap={},this.mutationCb(p))},this.processMutation=l=>{if(!isIgnored(l.target,this.mirror))switch(l.type){case"characterData":{const c=l.target.textContent;isBlocked(l.target,this.blockClass,this.blockSelector,this.unblockSelector,!1)||c===l.oldValue||this.texts.push({value:needMaskingText(l.target,this.maskTextClass,this.maskTextSelector,this.unmaskTextClass,this.unmaskTextSelector,this.maskAllText)&&c?this.maskTextFn?this.maskTextFn(c,closestElementOfNode(l.target)):c.replace(/[\S]/g,"*"):c,node:l.target});break}case"attributes":{const c=l.target;let d=l.attributeName,h=l.target.getAttribute(d);if("value"===d){const d=getInputType(c),p=c.tagName;h=getInputValue(c,p,d);const f=shouldMaskInput({maskInputOptions:this.maskInputOptions,tagName:p,type:d});h=maskInputValue({isMasked:needMaskingText(l.target,this.maskTextClass,this.maskTextSelector,this.unmaskTextClass,this.unmaskTextSelector,f),element:c,value:h,maskInputFn:this.maskInputFn})}if(isBlocked(l.target,this.blockClass,this.blockSelector,this.unblockSelector,!1)||h===l.oldValue)return;let p=this.attributeMap.get(l.target);if("IFRAME"===c.tagName&&"src"===d&&!this.keepIframeSrcFn(h)){if(c.contentDocument)return;d="rr_src"}if(p||(p={node:l.target,attributes:{},styleDiff:{},_unchangedStyles:{}},this.attributes.push(p),this.attributeMap.set(l.target,p)),"type"===d&&"INPUT"===c.tagName&&"password"===(l.oldValue||"").toLowerCase()&&c.setAttribute("data-rr-is-password","true"),!ignoreAttribute(c.tagName,d)&&(p.attributes[d]=transformAttribute(this.doc,toLowerCase(c.tagName),toLowerCase(d),h,c,this.maskAttributeFn),"style"===d)){if(!this.unattachedDoc)try{this.unattachedDoc=document.implementation.createHTMLDocument()}catch(hh){this.unattachedDoc=this.doc}const d=this.unattachedDoc.createElement("span");l.oldValue&&d.setAttribute("style",l.oldValue);for(const l of Array.from(c.style)){const h=c.style.getPropertyValue(l),f=c.style.getPropertyPriority(l);h!==d.style.getPropertyValue(l)||f!==d.style.getPropertyPriority(l)?p.styleDiff[l]=""===f?h:[h,f]:p._unchangedStyles[l]=[h,f]}for(const l of Array.from(d.style))""===c.style.getPropertyValue(l)&&(p.styleDiff[l]=!1)}break}case"childList":if(isBlocked(l.target,this.blockClass,this.blockSelector,this.unblockSelector,!0))return;l.addedNodes.forEach((c=>this.genAdds(c,l.target))),l.removedNodes.forEach((c=>{const d=this.mirror.getId(c),h=isShadowRoot$1(l.target)?this.mirror.getId(l.target.host):this.mirror.getId(l.target);isBlocked(l.target,this.blockClass,this.blockSelector,this.unblockSelector,!1)||isIgnored(c,this.mirror)||!function(l,c){return-1!==c.getId(l)}(c,this.mirror)||(this.addedSet.has(c)?(deepDelete(this.addedSet,c),this.droppedSet.add(c)):this.addedSet.has(l.target)&&-1===d||isAncestorRemoved(l.target,this.mirror)||(this.movedSet.has(c)&&this.movedMap[moveKey(d,h)]?deepDelete(this.movedSet,c):this.removes.push({parentId:h,id:d,isShadow:!(!isShadowRoot$1(l.target)||!isNativeShadowDom(l.target))||void 0})),this.mapRemoves.push(c))}))}},this.genAdds=(l,c)=>{if(!this.processedNodeManager.inOtherBuffer(l,this)&&!this.addedSet.has(l)&&!this.movedSet.has(l)){if(this.mirror.hasNode(l)){if(isIgnored(l,this.mirror))return;this.movedSet.add(l);let d=null;c&&this.mirror.hasNode(c)&&(d=this.mirror.getId(c)),d&&-1!==d&&(this.movedMap[moveKey(this.mirror.getId(l),d)]=!0)}else this.addedSet.add(l),this.droppedSet.delete(l);isBlocked(l,this.blockClass,this.blockSelector,this.unblockSelector,!1)||(l.childNodes.forEach((l=>this.genAdds(l))),hasShadowRoot(l)&&l.shadowRoot.childNodes.forEach((c=>{this.processedNodeManager.add(c,this),this.genAdds(c,l)})))}}}init(l){["mutationCb","blockClass","blockSelector","unblockSelector","maskAllText","maskTextClass","unmaskTextClass","maskTextSelector","unmaskTextSelector","inlineStylesheet","maskInputOptions","maskAttributeFn","maskTextFn","maskInputFn","keepIframeSrcFn","recordCanvas","inlineImages","slimDOMOptions","dataURLOptions","doc","mirror","iframeManager","stylesheetManager","shadowDomManager","canvasManager","processedNodeManager"].forEach((c=>{this[c]=l[c]}))}freeze(){this.frozen=!0,this.canvasManager.freeze()}unfreeze(){this.frozen=!1,this.canvasManager.unfreeze(),this.emit()}isFrozen(){return this.frozen}lock(){this.locked=!0,this.canvasManager.lock()}unlock(){this.locked=!1,this.canvasManager.unlock(),this.emit()}reset(){this.shadowDomManager.reset(),this.canvasManager.reset()}}function deepDelete(l,c){l.delete(c),c.childNodes.forEach((c=>deepDelete(l,c)))}function isParentRemoved(l,c,d){return 0!==l.length&&_isParentRemoved(l,c,d)}function _isParentRemoved(l,c,d){const{parentNode:h}=c;if(!h)return!1;const p=d.getId(h);return!!l.some((l=>l.id===p))||_isParentRemoved(l,h,d)}function isAncestorInSet(l,c){return 0!==l.size&&_isAncestorInSet(l,c)}function _isAncestorInSet(l,c){const{parentNode:d}=c;return!!d&&(!!l.has(d)||_isAncestorInSet(l,d))}let ox;const callbackWrapper=l=>{if(!ox)return l;return(...c)=>{try{return l(...c)}catch(d){if(ox&&!0===ox(d))return()=>{};throw d}}};function _optionalChain$2(l){let c,d=l[0],h=1;for(;h<l.length;){const p=l[h],f=l[h+1];if(h+=2,("optionalAccess"===p||"optionalCall"===p)&&null==d)return;"access"===p||"optionalAccess"===p?(c=d,d=f(d)):"call"!==p&&"optionalCall"!==p||(d=f(((...l)=>d.call(c,...l))),c=void 0)}return d}const ax=[];function getEventTarget(l){try{if("composedPath"in l){const c=l.composedPath();if(c.length)return c[0]}else if("path"in l&&l.path.length)return l.path[0]}catch(c){}return l&&l.target}function initMutationObserver(l,c){const d=new MutationBuffer;ax.push(d),d.init(l);let h=window.MutationObserver||window.__rrMutationObserver;const p=_optionalChain$2([window,"optionalAccess",l=>l.Zone,"optionalAccess",l=>l.__symbol__,"optionalCall",l=>l("MutationObserver")]);p&&window[p]&&(h=window[p]);const f=new h(callbackWrapper((c=>{l.onMutation&&!1===l.onMutation(c)||d.processMutations.bind(d)(c)})));return f.observe(c,{attributes:!0,attributeOldValue:!0,characterData:!0,characterDataOldValue:!0,childList:!0,subtree:!0}),f}function initMouseInteractionObserver({mouseInteractionCb:l,doc:c,mirror:d,blockClass:h,blockSelector:p,unblockSelector:f,sampling:m}){if(!1===m.mouseInteraction)return()=>{};const y=!0===m.mouseInteraction||void 0===m.mouseInteraction?{}:m.mouseInteraction,_=[];let b=null;return Object.keys(sx).filter((l=>Number.isNaN(Number(l))&&!l.endsWith("_Departed")&&!1!==y[l])).forEach((m=>{let y=toLowerCase(m);const w=(c=>m=>{const y=getEventTarget(m);if(isBlocked(y,h,p,f,!0))return;let _=null,w=c;if("pointerType"in m){switch(m.pointerType){case"mouse":_=ix.Mouse;break;case"touch":_=ix.Touch;break;case"pen":_=ix.Pen}_===ix.Touch?sx[c]===sx.MouseDown?w="TouchStart":sx[c]===sx.MouseUp&&(w="TouchEnd"):ix.Pen}else legacy_isTouchEvent(m)&&(_=ix.Touch);null!==_?(b=_,(w.startsWith("Touch")&&_===ix.Touch||w.startsWith("Mouse")&&_===ix.Mouse)&&(_=null)):sx[c]===sx.Click&&(_=b,b=null);const E=legacy_isTouchEvent(m)?m.changedTouches[0]:m;if(!E)return;const M=d.getId(y),{clientX:N,clientY:P}=E;callbackWrapper(l)({type:sx[w],id:M,x:N,y:P,...null!==_&&{pointerType:_}})})(m);if(window.PointerEvent)switch(sx[m]){case sx.MouseDown:case sx.MouseUp:y=y.replace("mouse","pointer");break;case sx.TouchStart:case sx.TouchEnd:return}_.push(on(y,w,c))})),callbackWrapper((()=>{_.forEach((l=>l()))}))}function initScrollObserver({scrollCb:l,doc:c,mirror:d,blockClass:h,blockSelector:p,unblockSelector:f,sampling:m}){return on("scroll",callbackWrapper(throttle$1(callbackWrapper((m=>{const y=getEventTarget(m);if(!y||isBlocked(y,h,p,f,!0))return;const _=d.getId(y);if(y===c&&c.defaultView){const d=getWindowScroll(c.defaultView);l({id:_,x:d.left,y:d.top})}else l({id:_,x:y.scrollLeft,y:y.scrollTop})})),m.scroll||100)),c)}const lx=["INPUT","TEXTAREA","SELECT"],cx=new WeakMap;function initInputObserver({inputCb:l,doc:c,mirror:d,blockClass:h,blockSelector:p,unblockSelector:f,ignoreClass:m,ignoreSelector:y,maskInputOptions:_,maskInputFn:b,sampling:w,userTriggeredOnInput:E,maskTextClass:M,unmaskTextClass:N,maskTextSelector:P,unmaskTextSelector:L}){function eventHandler(l){let d=getEventTarget(l);const w=l.isTrusted,j=d&&toUpperCase(d.tagName);if("OPTION"===j&&(d=d.parentElement),!d||!j||lx.indexOf(j)<0||isBlocked(d,h,p,f,!0))return;const D=d;if(D.classList.contains(m)||y&&D.matches(y))return;const F=getInputType(d);let U=getInputValue(D,j,F),B=!1;const H=shouldMaskInput({maskInputOptions:_,tagName:j,type:F}),z=needMaskingText(d,M,P,N,L,H);"radio"!==F&&"checkbox"!==F||(B=d.checked),U=maskInputValue({isMasked:z,element:d,value:U,maskInputFn:b}),cbWithDedup(d,E?{text:U,isChecked:B,userTriggered:w}:{text:U,isChecked:B});const q=d.name;"radio"===F&&q&&B&&c.querySelectorAll(`input[type="radio"][name="${q}"]`).forEach((l=>{if(l!==d){const c=maskInputValue({isMasked:z,element:l,value:getInputValue(l,j,F),maskInputFn:b});cbWithDedup(l,E?{text:c,isChecked:!B,userTriggered:!1}:{text:c,isChecked:!B})}}))}function cbWithDedup(c,h){const p=cx.get(c);if(!p||p.text!==h.text||p.isChecked!==h.isChecked){cx.set(c,h);const p=d.getId(c);callbackWrapper(l)({...h,id:p})}}const j=("last"===w.input?["change"]:["input","change"]).map((l=>on(l,callbackWrapper(eventHandler),c))),D=c.defaultView;if(!D)return()=>{j.forEach((l=>l()))};const F=D.Object.getOwnPropertyDescriptor(D.HTMLInputElement.prototype,"value"),U=[[D.HTMLInputElement.prototype,"value"],[D.HTMLInputElement.prototype,"checked"],[D.HTMLSelectElement.prototype,"value"],[D.HTMLTextAreaElement.prototype,"value"],[D.HTMLSelectElement.prototype,"selectedIndex"],[D.HTMLOptionElement.prototype,"selected"]];return F&&F.set&&j.push(...U.map((l=>hookSetter(l[0],l[1],{set(){callbackWrapper(eventHandler)({target:this,isTrusted:!1})}},!1,D)))),callbackWrapper((()=>{j.forEach((l=>l()))}))}function getNestedCSSRulePositions(l){return function(l,c){if(hasNestedCSSRule("CSSGroupingRule")&&l.parentRule instanceof CSSGroupingRule||hasNestedCSSRule("CSSMediaRule")&&l.parentRule instanceof CSSMediaRule||hasNestedCSSRule("CSSSupportsRule")&&l.parentRule instanceof CSSSupportsRule||hasNestedCSSRule("CSSConditionRule")&&l.parentRule instanceof CSSConditionRule){const d=Array.from(l.parentRule.cssRules).indexOf(l);c.unshift(d)}else if(l.parentStyleSheet){const d=Array.from(l.parentStyleSheet.cssRules).indexOf(l);c.unshift(d)}return c}(l,[])}function getIdAndStyleId(l,c,d){let h,p;return l?(l.ownerNode?h=c.getId(l.ownerNode):p=d.getId(l),{styleId:p,id:h}):{}}function initAdoptedStyleSheetObserver({mirror:l,stylesheetManager:c},d){let h=null;h="#document"===d.nodeName?l.getId(d):l.getId(d.host);const p="#document"===d.nodeName?_optionalChain$2([d,"access",l=>l.defaultView,"optionalAccess",l=>l.Document]):_optionalChain$2([d,"access",l=>l.ownerDocument,"optionalAccess",l=>l.defaultView,"optionalAccess",l=>l.ShadowRoot]),f=_optionalChain$2([p,"optionalAccess",l=>l.prototype])?Object.getOwnPropertyDescriptor(_optionalChain$2([p,"optionalAccess",l=>l.prototype]),"adoptedStyleSheets"):void 0;return null!==h&&-1!==h&&p&&f?(Object.defineProperty(d,"adoptedStyleSheets",{configurable:f.configurable,enumerable:f.enumerable,get(){return _optionalChain$2([f,"access",l=>l.get,"optionalAccess",l=>l.call,"call",l=>l(this)])},set(l){const d=_optionalChain$2([f,"access",l=>l.set,"optionalAccess",l=>l.call,"call",c=>c(this,l)]);if(null!==h&&-1!==h)try{c.adoptStyleSheets(l,h)}catch(hh){}return d}}),callbackWrapper((()=>{Object.defineProperty(d,"adoptedStyleSheets",{configurable:f.configurable,enumerable:f.enumerable,get:f.get,set:f.set})}))):()=>{}}function initObservers(l,c={}){const d=l.doc.defaultView;if(!d)return()=>{};const h=initMutationObserver(l,l.doc),p=function({mousemoveCb:l,sampling:c,doc:d,mirror:h}){if(!1===c.mousemove)return()=>{};const p="number"==typeof c.mousemove?c.mousemove:50,f="number"==typeof c.mousemoveCallback?c.mousemoveCallback:500;let m,y=[];const _=throttle$1(callbackWrapper((c=>{const d=Date.now()-m;l(y.map((l=>(l.timeOffset-=d,l))),c),y=[],m=null})),f),b=callbackWrapper(throttle$1(callbackWrapper((l=>{const c=getEventTarget(l),{clientX:d,clientY:p}=legacy_isTouchEvent(l)?l.changedTouches[0]:l;m||(m=ex()),y.push({x:d,y:p,id:h.getId(c),timeOffset:ex()-m}),_("undefined"!=typeof DragEvent&&l instanceof DragEvent?nx.Drag:l instanceof MouseEvent?nx.MouseMove:nx.TouchMove)})),p,{trailing:!1})),w=[on("mousemove",b,d),on("touchmove",b,d),on("drag",b,d)];return callbackWrapper((()=>{w.forEach((l=>l()))}))}(l),f=initMouseInteractionObserver(l),m=initScrollObserver(l),y=function({viewportResizeCb:l},{win:c}){let d=-1,h=-1;return on("resize",callbackWrapper(throttle$1(callbackWrapper((()=>{const c=getWindowHeight(),p=getWindowWidth();d===c&&h===p||(l({width:Number(p),height:Number(c)}),d=c,h=p)})),200)),c)}(l,{win:d}),_=initInputObserver(l),b=function({mediaInteractionCb:l,blockClass:c,blockSelector:d,unblockSelector:h,mirror:p,sampling:f,doc:m}){const y=callbackWrapper((m=>throttle$1(callbackWrapper((f=>{const y=getEventTarget(f);if(!y||isBlocked(y,c,d,h,!0))return;const{currentTime:_,volume:b,muted:w,playbackRate:E}=y;l({type:m,id:p.getId(y),currentTime:_,volume:b,muted:w,playbackRate:E})})),f.media||500))),_=[on("play",y(0),m),on("pause",y(1),m),on("seeked",y(2),m),on("volumechange",y(3),m),on("ratechange",y(4),m)];return callbackWrapper((()=>{_.forEach((l=>l()))}))}(l),w=function({styleSheetRuleCb:l,mirror:c,stylesheetManager:d},{win:h}){if(!h.CSSStyleSheet||!h.CSSStyleSheet.prototype)return()=>{};const p=h.CSSStyleSheet.prototype.insertRule;h.CSSStyleSheet.prototype.insertRule=new Proxy(p,{apply:callbackWrapper(((h,p,f)=>{const[m,y]=f,{id:_,styleId:b}=getIdAndStyleId(p,c,d.styleMirror);return(_&&-1!==_||b&&-1!==b)&&l({id:_,styleId:b,adds:[{rule:m,index:y}]}),h.apply(p,f)}))});const f=h.CSSStyleSheet.prototype.deleteRule;let m,y;h.CSSStyleSheet.prototype.deleteRule=new Proxy(f,{apply:callbackWrapper(((h,p,f)=>{const[m]=f,{id:y,styleId:_}=getIdAndStyleId(p,c,d.styleMirror);return(y&&-1!==y||_&&-1!==_)&&l({id:y,styleId:_,removes:[{index:m}]}),h.apply(p,f)}))}),h.CSSStyleSheet.prototype.replace&&(m=h.CSSStyleSheet.prototype.replace,h.CSSStyleSheet.prototype.replace=new Proxy(m,{apply:callbackWrapper(((h,p,f)=>{const[m]=f,{id:y,styleId:_}=getIdAndStyleId(p,c,d.styleMirror);return(y&&-1!==y||_&&-1!==_)&&l({id:y,styleId:_,replace:m}),h.apply(p,f)}))})),h.CSSStyleSheet.prototype.replaceSync&&(y=h.CSSStyleSheet.prototype.replaceSync,h.CSSStyleSheet.prototype.replaceSync=new Proxy(y,{apply:callbackWrapper(((h,p,f)=>{const[m]=f,{id:y,styleId:_}=getIdAndStyleId(p,c,d.styleMirror);return(y&&-1!==y||_&&-1!==_)&&l({id:y,styleId:_,replaceSync:m}),h.apply(p,f)}))}));const _={};canMonkeyPatchNestedCSSRule("CSSGroupingRule")?_.CSSGroupingRule=h.CSSGroupingRule:(canMonkeyPatchNestedCSSRule("CSSMediaRule")&&(_.CSSMediaRule=h.CSSMediaRule),canMonkeyPatchNestedCSSRule("CSSConditionRule")&&(_.CSSConditionRule=h.CSSConditionRule),canMonkeyPatchNestedCSSRule("CSSSupportsRule")&&(_.CSSSupportsRule=h.CSSSupportsRule));const b={};return Object.entries(_).forEach((([h,p])=>{b[h]={insertRule:p.prototype.insertRule,deleteRule:p.prototype.deleteRule},p.prototype.insertRule=new Proxy(b[h].insertRule,{apply:callbackWrapper(((h,p,f)=>{const[m,y]=f,{id:_,styleId:b}=getIdAndStyleId(p.parentStyleSheet,c,d.styleMirror);return(_&&-1!==_||b&&-1!==b)&&l({id:_,styleId:b,adds:[{rule:m,index:[...getNestedCSSRulePositions(p),y||0]}]}),h.apply(p,f)}))}),p.prototype.deleteRule=new Proxy(b[h].deleteRule,{apply:callbackWrapper(((h,p,f)=>{const[m]=f,{id:y,styleId:_}=getIdAndStyleId(p.parentStyleSheet,c,d.styleMirror);return(y&&-1!==y||_&&-1!==_)&&l({id:y,styleId:_,removes:[{index:[...getNestedCSSRulePositions(p),m]}]}),h.apply(p,f)}))})})),callbackWrapper((()=>{h.CSSStyleSheet.prototype.insertRule=p,h.CSSStyleSheet.prototype.deleteRule=f,m&&(h.CSSStyleSheet.prototype.replace=m),y&&(h.CSSStyleSheet.prototype.replaceSync=y),Object.entries(_).forEach((([l,c])=>{c.prototype.insertRule=b[l].insertRule,c.prototype.deleteRule=b[l].deleteRule}))}))}(l,{win:d}),E=initAdoptedStyleSheetObserver(l,l.doc),M=function({styleDeclarationCb:l,mirror:c,ignoreCSSAttributes:d,stylesheetManager:h},{win:p}){const f=p.CSSStyleDeclaration.prototype.setProperty;p.CSSStyleDeclaration.prototype.setProperty=new Proxy(f,{apply:callbackWrapper(((p,m,y)=>{const[_,b,w]=y;if(d.has(_))return f.apply(m,[_,b,w]);const{id:E,styleId:M}=getIdAndStyleId(_optionalChain$2([m,"access",l=>l.parentRule,"optionalAccess",l=>l.parentStyleSheet]),c,h.styleMirror);return(E&&-1!==E||M&&-1!==M)&&l({id:E,styleId:M,set:{property:_,value:b,priority:w},index:getNestedCSSRulePositions(m.parentRule)}),p.apply(m,y)}))});const m=p.CSSStyleDeclaration.prototype.removeProperty;return p.CSSStyleDeclaration.prototype.removeProperty=new Proxy(m,{apply:callbackWrapper(((p,f,y)=>{const[_]=y;if(d.has(_))return m.apply(f,[_]);const{id:b,styleId:w}=getIdAndStyleId(_optionalChain$2([f,"access",l=>l.parentRule,"optionalAccess",l=>l.parentStyleSheet]),c,h.styleMirror);return(b&&-1!==b||w&&-1!==w)&&l({id:b,styleId:w,remove:{property:_},index:getNestedCSSRulePositions(f.parentRule)}),p.apply(f,y)}))}),callbackWrapper((()=>{p.CSSStyleDeclaration.prototype.setProperty=f,p.CSSStyleDeclaration.prototype.removeProperty=m}))}(l,{win:d}),N=l.collectFonts?function({fontCb:l,doc:c}){const d=c.defaultView;if(!d)return()=>{};const h=[],p=new WeakMap,f=d.FontFace;d.FontFace=function(l,c,d){const h=new f(l,c,d);return p.set(h,{family:l,buffer:"string"!=typeof c,descriptors:d,fontSource:"string"==typeof c?c:JSON.stringify(Array.from(new Uint8Array(c)))}),h};const m=patch(c.fonts,"add",(function(c){return function(d){return setTimeout$1(callbackWrapper((()=>{const c=p.get(d);c&&(l(c),p.delete(d))})),0),c.apply(this,[d])}}));return h.push((()=>{d.FontFace=f})),h.push(m),callbackWrapper((()=>{h.forEach((l=>l()))}))}(l):()=>{},P=function(l){const{doc:c,mirror:d,blockClass:h,blockSelector:p,unblockSelector:f,selectionCb:m}=l;let y=!0;const _=callbackWrapper((()=>{const l=c.getSelection();if(!l||y&&_optionalChain$2([l,"optionalAccess",l=>l.isCollapsed]))return;y=l.isCollapsed||!1;const _=[],b=l.rangeCount||0;for(let c=0;c<b;c++){const m=l.getRangeAt(c),{startContainer:y,startOffset:b,endContainer:w,endOffset:E}=m;isBlocked(y,h,p,f,!0)||isBlocked(w,h,p,f,!0)||_.push({start:d.getId(y),startOffset:b,end:d.getId(w),endOffset:E})}m({ranges:_})}));return _(),on("selectionchange",_)}(l),L=function({doc:l,customElementCb:c}){const d=l.defaultView;return d&&d.customElements?patch(d.customElements,"define",(function(l){return function(d,h,p){try{c({define:{name:d}})}catch(hh){}return l.apply(this,[d,h,p])}})):()=>{}}(l),j=[];for(const D of l.plugins)j.push(D.observer(D.callback,d,D.options));return callbackWrapper((()=>{ax.forEach((l=>l.reset())),h.disconnect(),p(),f(),m(),y(),_(),b(),w(),E(),M(),N(),P(),L(),j.forEach((l=>l()))}))}function hasNestedCSSRule(l){return void 0!==window[l]}function canMonkeyPatchNestedCSSRule(l){return Boolean(void 0!==window[l]&&window[l].prototype&&"insertRule"in window[l].prototype&&"deleteRule"in window[l].prototype)}class CrossOriginIframeMirror{constructor(l){this.generateIdFn=l,this.iframeIdToRemoteIdMap=new WeakMap,this.iframeRemoteIdToIdMap=new WeakMap}getId(l,c,d,h){const p=d||this.getIdToRemoteIdMap(l),f=h||this.getRemoteIdToIdMap(l);let m=p.get(c);return m||(m=this.generateIdFn(),p.set(c,m),f.set(m,c)),m}getIds(l,c){const d=this.getIdToRemoteIdMap(l),h=this.getRemoteIdToIdMap(l);return c.map((c=>this.getId(l,c,d,h)))}getRemoteId(l,c,d){const h=d||this.getRemoteIdToIdMap(l);if("number"!=typeof c)return c;const p=h.get(c);return p||-1}getRemoteIds(l,c){const d=this.getRemoteIdToIdMap(l);return c.map((c=>this.getRemoteId(l,c,d)))}reset(l){if(!l)return this.iframeIdToRemoteIdMap=new WeakMap,void(this.iframeRemoteIdToIdMap=new WeakMap);this.iframeIdToRemoteIdMap.delete(l),this.iframeRemoteIdToIdMap.delete(l)}getIdToRemoteIdMap(l){let c=this.iframeIdToRemoteIdMap.get(l);return c||(c=new Map,this.iframeIdToRemoteIdMap.set(l,c)),c}getRemoteIdToIdMap(l){let c=this.iframeRemoteIdToIdMap.get(l);return c||(c=new Map,this.iframeRemoteIdToIdMap.set(l,c)),c}}function _optionalChain$1(l){let c,d=l[0],h=1;for(;h<l.length;){const p=l[h],f=l[h+1];if(h+=2,("optionalAccess"===p||"optionalCall"===p)&&null==d)return;"access"===p||"optionalAccess"===p?(c=d,d=f(d)):"call"!==p&&"optionalCall"!==p||(d=f(((...l)=>d.call(c,...l))),c=void 0)}return d}class IframeManagerNoop{constructor(){this.crossOriginIframeMirror=new CrossOriginIframeMirror(genId),this.crossOriginIframeRootIdMap=new WeakMap}addIframe(){}addLoadListener(){}attachIframe(){}}class IframeManager{constructor(l){this.iframes=new WeakMap,this.crossOriginIframeMap=new WeakMap,this.crossOriginIframeMirror=new CrossOriginIframeMirror(genId),this.crossOriginIframeRootIdMap=new WeakMap,this.mutationCb=l.mutationCb,this.wrappedEmit=l.wrappedEmit,this.stylesheetManager=l.stylesheetManager,this.recordCrossOriginIframes=l.recordCrossOriginIframes,this.crossOriginIframeStyleMirror=new CrossOriginIframeMirror(this.stylesheetManager.styleMirror.generateId.bind(this.stylesheetManager.styleMirror)),this.mirror=l.mirror,this.recordCrossOriginIframes&&window.addEventListener("message",this.handleMessage.bind(this))}addIframe(l){this.iframes.set(l,!0),l.contentWindow&&this.crossOriginIframeMap.set(l.contentWindow,l)}addLoadListener(l){this.loadListener=l}attachIframe(l,c){this.mutationCb({adds:[{parentId:this.mirror.getId(l),nextId:null,node:c}],removes:[],texts:[],attributes:[],isAttachIframe:!0}),_optionalChain$1([this,"access",l=>l.loadListener,"optionalCall",c=>c(l)]),l.contentDocument&&l.contentDocument.adoptedStyleSheets&&l.contentDocument.adoptedStyleSheets.length>0&&this.stylesheetManager.adoptStyleSheets(l.contentDocument.adoptedStyleSheets,this.mirror.getId(l.contentDocument))}handleMessage(l){const c=l;if("rrweb"!==c.data.type||c.origin!==c.data.origin)return;if(!l.source)return;const d=this.crossOriginIframeMap.get(l.source);if(!d)return;const h=this.transformCrossOriginEvent(d,c.data.event);h&&this.wrappedEmit(h,c.data.isCheckout)}transformCrossOriginEvent(l,c){switch(c.type){case rx.FullSnapshot:{this.crossOriginIframeMirror.reset(l),this.crossOriginIframeStyleMirror.reset(l),this.replaceIdOnNode(c.data.node,l);const d=c.data.node.id;return this.crossOriginIframeRootIdMap.set(l,d),this.patchRootIdOnNode(c.data.node,d),{timestamp:c.timestamp,type:rx.IncrementalSnapshot,data:{source:nx.Mutation,adds:[{parentId:this.mirror.getId(l),nextId:null,node:c.data.node}],removes:[],texts:[],attributes:[],isAttachIframe:!0}}}case rx.Meta:case rx.Load:case rx.DomContentLoaded:return!1;case rx.Plugin:return c;case rx.Custom:return this.replaceIds(c.data.payload,l,["id","parentId","previousId","nextId"]),c;case rx.IncrementalSnapshot:switch(c.data.source){case nx.Mutation:return c.data.adds.forEach((c=>{this.replaceIds(c,l,["parentId","nextId","previousId"]),this.replaceIdOnNode(c.node,l);const d=this.crossOriginIframeRootIdMap.get(l);d&&this.patchRootIdOnNode(c.node,d)})),c.data.removes.forEach((c=>{this.replaceIds(c,l,["parentId","id"])})),c.data.attributes.forEach((c=>{this.replaceIds(c,l,["id"])})),c.data.texts.forEach((c=>{this.replaceIds(c,l,["id"])})),c;case nx.Drag:case nx.TouchMove:case nx.MouseMove:return c.data.positions.forEach((c=>{this.replaceIds(c,l,["id"])})),c;case nx.ViewportResize:return!1;case nx.MediaInteraction:case nx.MouseInteraction:case nx.Scroll:case nx.CanvasMutation:case nx.Input:return this.replaceIds(c.data,l,["id"]),c;case nx.StyleSheetRule:case nx.StyleDeclaration:return this.replaceIds(c.data,l,["id"]),this.replaceStyleIds(c.data,l,["styleId"]),c;case nx.Font:return c;case nx.Selection:return c.data.ranges.forEach((c=>{this.replaceIds(c,l,["start","end"])})),c;case nx.AdoptedStyleSheet:return this.replaceIds(c.data,l,["id"]),this.replaceStyleIds(c.data,l,["styleIds"]),_optionalChain$1([c,"access",l=>l.data,"access",l=>l.styles,"optionalAccess",l=>l.forEach,"call",c=>c((c=>{this.replaceStyleIds(c,l,["styleId"])}))]),c}}return!1}replace(l,c,d,h){for(const p of h)(Array.isArray(c[p])||"number"==typeof c[p])&&(Array.isArray(c[p])?c[p]=l.getIds(d,c[p]):c[p]=l.getId(d,c[p]));return c}replaceIds(l,c,d){return this.replace(this.crossOriginIframeMirror,l,c,d)}replaceStyleIds(l,c,d){return this.replace(this.crossOriginIframeStyleMirror,l,c,d)}replaceIdOnNode(l,c){this.replaceIds(l,c,["id","rootId"]),"childNodes"in l&&l.childNodes.forEach((l=>{this.replaceIdOnNode(l,c)}))}patchRootIdOnNode(l,c){l.type===$S.Document||l.rootId||(l.rootId=c),"childNodes"in l&&l.childNodes.forEach((l=>{this.patchRootIdOnNode(l,c)}))}}class ShadowDomManagerNoop{init(){}addShadowRoot(){}observeAttachShadow(){}reset(){}}class ShadowDomManager{constructor(l){this.shadowDoms=new WeakSet,this.restoreHandlers=[],this.mutationCb=l.mutationCb,this.scrollCb=l.scrollCb,this.bypassOptions=l.bypassOptions,this.mirror=l.mirror,this.init()}init(){this.reset(),this.patchAttachShadow(Element,document)}addShadowRoot(l,c){if(!isNativeShadowDom(l))return;if(this.shadowDoms.has(l))return;this.shadowDoms.add(l);const d=initMutationObserver({...this.bypassOptions,doc:c,mutationCb:this.mutationCb,mirror:this.mirror,shadowDomManager:this},l);this.restoreHandlers.push((()=>d.disconnect())),this.restoreHandlers.push(initScrollObserver({...this.bypassOptions,scrollCb:this.scrollCb,doc:l,mirror:this.mirror})),setTimeout$1((()=>{l.adoptedStyleSheets&&l.adoptedStyleSheets.length>0&&this.bypassOptions.stylesheetManager.adoptStyleSheets(l.adoptedStyleSheets,this.mirror.getId(l.host)),this.restoreHandlers.push(initAdoptedStyleSheetObserver({mirror:this.mirror,stylesheetManager:this.bypassOptions.stylesheetManager},l))}),0)}observeAttachShadow(l){l.contentWindow&&l.contentDocument&&this.patchAttachShadow(l.contentWindow.Element,l.contentDocument)}patchAttachShadow(l,c){const d=this;this.restoreHandlers.push(patch(l.prototype,"attachShadow",(function(l){return function(h){const p=l.call(this,h);return this.shadowRoot&&inDom(this)&&d.addShadowRoot(this.shadowRoot,c),p}})))}reset(){this.restoreHandlers.forEach((l=>{try{l()}catch(hh){}})),this.restoreHandlers=[],this.shadowDoms=new WeakSet}}class CanvasManagerNoop{reset(){}freeze(){}unfreeze(){}lock(){}unlock(){}snapshot(){}}class StylesheetManager{constructor(l){this.trackedLinkElements=new WeakSet,this.styleMirror=new StyleSheetMirror,this.mutationCb=l.mutationCb,this.adoptedStyleSheetCb=l.adoptedStyleSheetCb}attachLinkElement(l,c){"_cssText"in c.attributes&&this.mutationCb({adds:[],removes:[],texts:[],attributes:[{id:c.id,attributes:c.attributes}]}),this.trackLinkElement(l)}trackLinkElement(l){this.trackedLinkElements.has(l)||(this.trackedLinkElements.add(l),this.trackStylesheetInLinkElement(l))}adoptStyleSheets(l,c){if(0===l.length)return;const d={id:c,styleIds:[]},h=[];for(const p of l){let l;this.styleMirror.has(p)?l=this.styleMirror.getId(p):(l=this.styleMirror.add(p),h.push({styleId:l,rules:Array.from(p.rules||CSSRule,((l,c)=>({rule:stringifyRule(l),index:c})))})),d.styleIds.push(l)}h.length>0&&(d.styles=h),this.adoptedStyleSheetCb(d)}reset(){this.styleMirror.reset(),this.trackedLinkElements=new WeakSet}trackStylesheetInLinkElement(l){}}class ProcessedNodeManager{constructor(){this.nodeMap=new WeakMap,this.loop=!0,this.periodicallyClear()}periodicallyClear(){!function(...l){getImplementation("requestAnimationFrame")(...l)}((()=>{this.clear(),this.loop&&this.periodicallyClear()}))}inOtherBuffer(l,c){const d=this.nodeMap.get(l);return d&&Array.from(d).some((l=>l!==c))}add(l,c){this.nodeMap.set(l,(this.nodeMap.get(l)||new Set).add(c))}clear(){this.nodeMap=new WeakMap}destroy(){this.loop=!1}}let ux,dx;const hx=new Mirror;function record(l={}){const{emit:c,checkoutEveryNms:d,checkoutEveryNth:h,blockClass:p="rr-block",blockSelector:f=null,unblockSelector:m=null,ignoreClass:y="rr-ignore",ignoreSelector:_=null,maskAllText:b=!1,maskTextClass:w="rr-mask",unmaskTextClass:E=null,maskTextSelector:M=null,unmaskTextSelector:N=null,inlineStylesheet:P=!0,maskAllInputs:L,maskInputOptions:j,slimDOMOptions:D,maskAttributeFn:F,maskInputFn:U,maskTextFn:B,maxCanvasSize:H=null,packFn:z,sampling:q={},dataURLOptions:V={},mousemoveWait:Z,recordCanvas:K=!1,recordCrossOriginIframes:Y=!1,recordAfter:ee=("DOMContentLoaded"===l.recordAfter?l.recordAfter:"load"),userTriggeredOnInput:ne=!1,collectFonts:se=!1,inlineImages:ie=!1,plugins:oe,keepIframeSrcFn:le=()=>!1,ignoreCSSAttributes:ce=new Set([]),errorHandler:pe,onMutation:fe,getCanvasManager:ge}=l;ox=pe;const be=!Y||window.parent===window;let Oe=!1;if(!be)try{window.parent.document&&(Oe=!1)}catch(hh){Oe=!0}if(be&&!c)throw new Error("emit function is required");void 0!==Z&&void 0===q.mousemove&&(q.mousemove=Z),hx.reset();const Ne=!0===L?{color:!0,date:!0,"datetime-local":!0,email:!0,month:!0,number:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0,textarea:!0,select:!0,radio:!0,checkbox:!0}:void 0!==j?j:{},De=!0===D||"all"===D?{script:!0,comment:!0,headFavicon:!0,headWhitespace:!0,headMetaSocial:!0,headMetaRobots:!0,headMetaHttpEquiv:!0,headMetaVerification:!0,headMetaAuthorship:"all"===D,headMetaDescKeywords:"all"===D}:D||{};let Fe;!function(l=window){"NodeList"in l&&!l.NodeList.prototype.forEach&&(l.NodeList.prototype.forEach=Array.prototype.forEach),"DOMTokenList"in l&&!l.DOMTokenList.prototype.forEach&&(l.DOMTokenList.prototype.forEach=Array.prototype.forEach),Node.prototype.contains||(Node.prototype.contains=(...l)=>{let c=l[0];if(!(0 in l))throw new TypeError("1 argument is required");do{if(this===c)return!0}while(c=c&&c.parentNode);return!1})}();let Ue=0;const eventProcessor=l=>{for(const c of oe||[])c.eventProcessor&&(l=c.eventProcessor(l));return z&&!Oe&&(l=z(l)),l};ux=(l,p)=>{const f=l;if(f.timestamp=ex(),!_optionalChain([ax,"access",l=>l[0],"optionalAccess",l=>l.isFrozen,"call",l=>l()])||f.type===rx.FullSnapshot||f.type===rx.IncrementalSnapshot&&f.data.source===nx.Mutation||ax.forEach((l=>l.unfreeze())),be)_optionalChain([c,"optionalCall",l=>l(eventProcessor(f),p)]);else if(Oe){const l={type:"rrweb",event:eventProcessor(f),origin:window.location.origin,isCheckout:p};window.parent.postMessage(l,"*")}if(f.type===rx.FullSnapshot)Fe=f,Ue=0;else if(f.type===rx.IncrementalSnapshot){if(f.data.source===nx.Mutation&&f.data.isAttachIframe)return;Ue++;const l=h&&Ue>=h,c=d&&Fe&&f.timestamp-Fe.timestamp>d;(l||c)&&takeFullSnapshot2(!0)}};const wrappedMutationEmit=l=>{ux({type:rx.IncrementalSnapshot,data:{source:nx.Mutation,...l}})},wrappedScrollEmit=l=>ux({type:rx.IncrementalSnapshot,data:{source:nx.Scroll,...l}}),wrappedCanvasMutationEmit=l=>ux({type:rx.IncrementalSnapshot,data:{source:nx.CanvasMutation,...l}}),Be=new StylesheetManager({mutationCb:wrappedMutationEmit,adoptedStyleSheetCb:l=>ux({type:rx.IncrementalSnapshot,data:{source:nx.AdoptedStyleSheet,...l}})}),He="boolean"==typeof __RRWEB_EXCLUDE_IFRAME__&&__RRWEB_EXCLUDE_IFRAME__?new IframeManagerNoop:new IframeManager({mirror:hx,mutationCb:wrappedMutationEmit,stylesheetManager:Be,recordCrossOriginIframes:Y,wrappedEmit:ux});for(const nt of oe||[])nt.getMirror&&nt.getMirror({nodeMirror:hx,crossOriginIframeMirror:He.crossOriginIframeMirror,crossOriginIframeStyleMirror:He.crossOriginIframeStyleMirror});const qe=new ProcessedNodeManager,Ve=function(l,c){try{return l?l(c):new CanvasManagerNoop}catch(d){return console.warn("Unable to initialize CanvasManager"),new CanvasManagerNoop}}(ge,{mirror:hx,win:window,mutationCb:l=>ux({type:rx.IncrementalSnapshot,data:{source:nx.CanvasMutation,...l}}),recordCanvas:K,blockClass:p,blockSelector:f,unblockSelector:m,maxCanvasSize:H,sampling:q.canvas,dataURLOptions:V,errorHandler:pe}),Je="boolean"==typeof __RRWEB_EXCLUDE_SHADOW_DOM__&&__RRWEB_EXCLUDE_SHADOW_DOM__?new ShadowDomManagerNoop:new ShadowDomManager({mutationCb:wrappedMutationEmit,scrollCb:wrappedScrollEmit,bypassOptions:{onMutation:fe,blockClass:p,blockSelector:f,unblockSelector:m,maskAllText:b,maskTextClass:w,unmaskTextClass:E,maskTextSelector:M,unmaskTextSelector:N,inlineStylesheet:P,maskInputOptions:Ne,dataURLOptions:V,maskAttributeFn:F,maskTextFn:B,maskInputFn:U,recordCanvas:K,inlineImages:ie,sampling:q,slimDOMOptions:De,iframeManager:He,stylesheetManager:Be,canvasManager:Ve,keepIframeSrcFn:le,processedNodeManager:qe},mirror:hx}),takeFullSnapshot2=(l=!1)=>{ux({type:rx.Meta,data:{href:window.location.href,width:getWindowWidth(),height:getWindowHeight()}},l),Be.reset(),Je.init(),ax.forEach((l=>l.lock()));const c=function(l,c){const{mirror:d=new Mirror,blockClass:h="rr-block",blockSelector:p=null,unblockSelector:f=null,maskAllText:m=!1,maskTextClass:y="rr-mask",unmaskTextClass:_=null,maskTextSelector:b=null,unmaskTextSelector:w=null,inlineStylesheet:E=!0,inlineImages:M=!1,recordCanvas:N=!1,maskAllInputs:P=!1,maskAttributeFn:L,maskTextFn:j,maskInputFn:D,slimDOM:F=!1,dataURLOptions:U,preserveWhiteSpace:B,onSerialize:H,onIframeLoad:z,iframeLoadTimeout:q,onStylesheetLoad:V,stylesheetLoadTimeout:Z,keepIframeSrcFn:K=()=>!1}=c||{};return serializeNodeWithId(l,{doc:l,mirror:d,blockClass:h,blockSelector:p,unblockSelector:f,maskAllText:m,maskTextClass:y,unmaskTextClass:_,maskTextSelector:b,unmaskTextSelector:w,skipChild:!1,inlineStylesheet:E,maskInputOptions:!0===P?{color:!0,date:!0,"datetime-local":!0,email:!0,month:!0,number:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0,textarea:!0,select:!0}:!1===P?{}:P,maskAttributeFn:L,maskTextFn:j,maskInputFn:D,slimDOMOptions:!0===F||"all"===F?{script:!0,comment:!0,headFavicon:!0,headWhitespace:!0,headMetaDescKeywords:"all"===F,headMetaSocial:!0,headMetaRobots:!0,headMetaHttpEquiv:!0,headMetaAuthorship:!0,headMetaVerification:!0}:!1===F?{}:F,dataURLOptions:U,inlineImages:M,recordCanvas:N,preserveWhiteSpace:B,onSerialize:H,onIframeLoad:z,iframeLoadTimeout:q,onStylesheetLoad:V,stylesheetLoadTimeout:Z,keepIframeSrcFn:K,newlyAddedElement:!1})}(document,{mirror:hx,blockClass:p,blockSelector:f,unblockSelector:m,maskAllText:b,maskTextClass:w,unmaskTextClass:E,maskTextSelector:M,unmaskTextSelector:N,inlineStylesheet:P,maskAllInputs:Ne,maskAttributeFn:F,maskInputFn:U,maskTextFn:B,slimDOM:De,dataURLOptions:V,recordCanvas:K,inlineImages:ie,onSerialize:l=>{isSerializedIframe(l,hx)&&He.addIframe(l),isSerializedStylesheet(l,hx)&&Be.trackLinkElement(l),hasShadowRoot(l)&&Je.addShadowRoot(l.shadowRoot,document)},onIframeLoad:(l,c)=>{He.attachIframe(l,c),Je.observeAttachShadow(l)},onStylesheetLoad:(l,c)=>{Be.attachLinkElement(l,c)},keepIframeSrcFn:le});if(!c)return console.warn("Failed to snapshot the document");ux({type:rx.FullSnapshot,data:{node:c,initialOffset:getWindowScroll(window)}}),ax.forEach((l=>l.unlock())),document.adoptedStyleSheets&&document.adoptedStyleSheets.length>0&&Be.adoptStyleSheets(document.adoptedStyleSheets,hx.getId(document))};dx=takeFullSnapshot2;try{const l=[],observe2=l=>callbackWrapper(initObservers)({onMutation:fe,mutationCb:wrappedMutationEmit,mousemoveCb:(l,c)=>ux({type:rx.IncrementalSnapshot,data:{source:c,positions:l}}),mouseInteractionCb:l=>ux({type:rx.IncrementalSnapshot,data:{source:nx.MouseInteraction,...l}}),scrollCb:wrappedScrollEmit,viewportResizeCb:l=>ux({type:rx.IncrementalSnapshot,data:{source:nx.ViewportResize,...l}}),inputCb:l=>ux({type:rx.IncrementalSnapshot,data:{source:nx.Input,...l}}),mediaInteractionCb:l=>ux({type:rx.IncrementalSnapshot,data:{source:nx.MediaInteraction,...l}}),styleSheetRuleCb:l=>ux({type:rx.IncrementalSnapshot,data:{source:nx.StyleSheetRule,...l}}),styleDeclarationCb:l=>ux({type:rx.IncrementalSnapshot,data:{source:nx.StyleDeclaration,...l}}),canvasMutationCb:wrappedCanvasMutationEmit,fontCb:l=>ux({type:rx.IncrementalSnapshot,data:{source:nx.Font,...l}}),selectionCb:l=>{ux({type:rx.IncrementalSnapshot,data:{source:nx.Selection,...l}})},customElementCb:l=>{ux({type:rx.IncrementalSnapshot,data:{source:nx.CustomElement,...l}})},blockClass:p,ignoreClass:y,ignoreSelector:_,maskAllText:b,maskTextClass:w,unmaskTextClass:E,maskTextSelector:M,unmaskTextSelector:N,maskInputOptions:Ne,inlineStylesheet:P,sampling:q,recordCanvas:K,inlineImages:ie,userTriggeredOnInput:ne,collectFonts:se,doc:l,maskAttributeFn:F,maskInputFn:U,maskTextFn:B,keepIframeSrcFn:le,blockSelector:f,unblockSelector:m,slimDOMOptions:De,dataURLOptions:V,mirror:hx,iframeManager:He,stylesheetManager:Be,shadowDomManager:Je,processedNodeManager:qe,canvasManager:Ve,ignoreCSSAttributes:ce,plugins:_optionalChain([oe,"optionalAccess",l=>l.filter,"call",l=>l((l=>l.observer)),"optionalAccess",l=>l.map,"call",l=>l((l=>({observer:l.observer,options:l.options,callback:c=>ux({type:rx.Plugin,data:{plugin:l.name,payload:c}})})))])||[]},{});He.addLoadListener((c=>{try{l.push(observe2(c.contentDocument))}catch(d){console.warn(d)}}));const init2=()=>{takeFullSnapshot2(),l.push(observe2(document))};return"interactive"===document.readyState||"complete"===document.readyState?init2():(l.push(on("DOMContentLoaded",(()=>{ux({type:rx.DomContentLoaded,data:{}}),"DOMContentLoaded"===ee&&init2()}))),l.push(on("load",(()=>{ux({type:rx.Load,data:{}}),"load"===ee&&init2()}),window))),()=>{l.forEach((l=>l())),qe.destroy(),dx=void 0,ox=void 0}}catch(tt){console.warn(tt)}}record.mirror=hx,record.takeFullSnapshot=function(l){if(!dx)throw new Error("please take full snapshot after start recording");dx(l)};function timestampToMs(l){return l>9999999999?l:1e3*l}function timestampToS(l){return l>9999999999?l/1e3:l}function addBreadcrumbEvent(l,c){"sentry.transaction"!==c.category&&(["ui.click","ui.input"].includes(c.category)?l.triggerUserActivity():l.checkAndHandleExpiredSession(),l.addUpdate((()=>(l.throttledAddEvent({type:rx.Custom,timestamp:1e3*(c.timestamp||0),data:{tag:"breadcrumb",payload:normalize(c,10,1e3)}}),"console"===c.category))))}function getClosestInteractive(l){return l.closest("button,a")||l}function getClickTargetNode(l){const c=getTargetNode(l);return c&&c instanceof Element?getClosestInteractive(c):c}function getTargetNode(l){return function(l){return"object"==typeof l&&!!l&&"target"in l}(l)?l.target:l}let px;function onWindowOpen(l){return px||(px=[],fill(MS,"open",(function(l){return function(...c){if(px)try{px.forEach((l=>l()))}catch(hh){}return l.apply(MS,c)}}))),px.push(l),()=>{const c=px?px.indexOf(l):-1;c>-1&&px.splice(c,1)}}class ClickDetector{constructor(l,c,d=addBreadcrumbEvent){this._lastMutation=0,this._lastScroll=0,this._clicks=[],this._timeout=c.timeout/1e3,this._threshold=c.threshold/1e3,this._scollTimeout=c.scrollTimeout/1e3,this._replay=l,this._ignoreSelector=c.ignoreSelector,this._addBreadcrumbEvent=d}addListeners(){const l=onWindowOpen((()=>{this._lastMutation=nowInSeconds()}));this._teardown=()=>{l(),this._clicks=[],this._lastMutation=0,this._lastScroll=0}}removeListeners(){this._teardown&&this._teardown(),this._checkClickTimeout&&clearTimeout(this._checkClickTimeout)}handleClick(l,c){if(function(l,c){if(!fx.includes(l.tagName))return!0;if("INPUT"===l.tagName&&!["submit","button"].includes(l.getAttribute("type")||""))return!0;if("A"===l.tagName&&(l.hasAttribute("download")||l.hasAttribute("target")&&"_self"!==l.getAttribute("target")))return!0;if(c&&l.matches(c))return!0;return!1}(c,this._ignoreSelector)||!function(l){return!(!l.data||"number"!=typeof l.data.nodeId||!l.timestamp)}(l))return;const d={timestamp:timestampToS(l.timestamp),clickBreadcrumb:l,clickCount:0,node:c};this._clicks.some((l=>l.node===d.node&&Math.abs(l.timestamp-d.timestamp)<1))||(this._clicks.push(d),1===this._clicks.length&&this._scheduleCheckClicks())}registerMutation(l=Date.now()){this._lastMutation=timestampToS(l)}registerScroll(l=Date.now()){this._lastScroll=timestampToS(l)}registerClick(l){const c=getClosestInteractive(l);this._handleMultiClick(c)}_handleMultiClick(l){this._getClicks(l).forEach((l=>{l.clickCount++}))}_getClicks(l){return this._clicks.filter((c=>c.node===l))}_checkClicks(){const l=[],c=nowInSeconds();this._clicks.forEach((d=>{!d.mutationAfter&&this._lastMutation&&(d.mutationAfter=d.timestamp<=this._lastMutation?this._lastMutation-d.timestamp:void 0),!d.scrollAfter&&this._lastScroll&&(d.scrollAfter=d.timestamp<=this._lastScroll?this._lastScroll-d.timestamp:void 0),d.timestamp+this._timeout<=c&&l.push(d)}));for(const d of l){const l=this._clicks.indexOf(d);l>-1&&(this._generateBreadcrumbs(d),this._clicks.splice(l,1))}this._clicks.length&&this._scheduleCheckClicks()}_generateBreadcrumbs(l){const c=this._replay,d=l.scrollAfter&&l.scrollAfter<=this._scollTimeout,h=l.mutationAfter&&l.mutationAfter<=this._threshold,p=!d&&!h,{clickCount:f,clickBreadcrumb:m}=l;if(p){const d=1e3*Math.min(l.mutationAfter||this._timeout,this._timeout),h=d<1e3*this._timeout?"mutation":"timeout",p={type:"default",message:m.message,timestamp:m.timestamp,category:"ui.slowClickDetected",data:{...m.data,url:MS.location.href,route:c.getCurrentRoute(),timeAfterClickMs:d,endReason:h,clickCount:f||1}};this._addBreadcrumbEvent(c,p)}else if(f>1){const l={type:"default",message:m.message,timestamp:m.timestamp,category:"ui.multiClick",data:{...m.data,url:MS.location.href,route:c.getCurrentRoute(),clickCount:f,metric:!0}};this._addBreadcrumbEvent(c,l)}}_scheduleCheckClicks(){this._checkClickTimeout&&clearTimeout(this._checkClickTimeout),this._checkClickTimeout=setTimeout((()=>this._checkClicks()),1e3)}}const fx=["A","BUTTON","INPUT"];function nowInSeconds(){return Date.now()/1e3}function updateClickDetectorForRecordingEvent(l,c){try{if(!function(l){return 3===l.type}(c))return;const{source:d}=c.data;if(d===nx.Mutation&&l.registerMutation(c.timestamp),d===nx.Scroll&&l.registerScroll(c.timestamp),function(l){return l.data.source===nx.MouseInteraction}(c)){const{type:d,id:h}=c.data,p=record.mirror.getNode(h);p instanceof HTMLElement&&d===sx.Click&&l.registerClick(p)}}catch(hh){}}function createBreadcrumb(l){return{timestamp:Date.now()/1e3,type:"default",...l}}var mx;!function(l){l[l.Document=0]="Document",l[l.DocumentType=1]="DocumentType",l[l.Element=2]="Element",l[l.Text=3]="Text",l[l.CDATA=4]="CDATA",l[l.Comment=5]="Comment"}(mx||(mx={}));const gx=new Set(["id","class","aria-label","role","name","alt","title","data-test-id","data-testid","disabled","aria-disabled","data-sentry-component"]);function getAttributesToRecord(l){const c={};for(const d in l)if(gx.has(d)){let h=d;"data-testid"!==d&&"data-test-id"!==d||(h="testId"),c[h]=l[d]}return c}const handleDomListener=l=>c=>{if(!l.isEnabled())return;const d=function(l){const{target:c,message:d}=function(l){const c="click"===l.name;let d,h=null;try{h=c?getClickTargetNode(l.event):getTargetNode(l.event),d=htmlTreeAsString(h,{maxStringLength:200})||"<unknown>"}catch(hh){d="<unknown>"}return{target:h,message:d}}(l);return createBreadcrumb({category:`ui.${l.name}`,...getBaseDomBreadcrumb(c,d)})}(c);if(!d)return;const h="click"===c.name,p=h?c.event:void 0;var f,m,y;!(h&&l.clickDetector&&p&&p.target)||p.altKey||p.metaKey||p.ctrlKey||p.shiftKey||(f=l.clickDetector,m=d,y=getClickTargetNode(c.event),f.handleClick(m,y)),addBreadcrumbEvent(l,d)};function getBaseDomBreadcrumb(l,c){const d=record.mirror.getId(l),h=d&&record.mirror.getNode(d),p=h&&record.mirror.getMeta(h),f=p&&function(l){return l.type===mx.Element}(p)?p:null;return{message:c,data:f?{nodeId:d,node:{id:d,tagName:f.tagName,textContent:Array.from(f.childNodes).map((l=>l.type===mx.Text&&l.textContent)).filter(Boolean).map((l=>l.trim())).join(""),attributes:getAttributesToRecord(f.attributes)}}:{}}}function handleKeyboardEvent(l,c){if(!l.isEnabled())return;l.updateUserActivity();const d=function(l){const{metaKey:c,shiftKey:d,ctrlKey:h,altKey:p,key:f,target:m}=l;if(!m||function(l){return"INPUT"===l.tagName||"TEXTAREA"===l.tagName||l.isContentEditable}(m)||!f)return null;const y=c||h||p,_=1===f.length;if(!y&&_)return null;const b=htmlTreeAsString(m,{maxStringLength:200})||"<unknown>",w=getBaseDomBreadcrumb(m,b);return createBreadcrumb({category:"ui.keyDown",message:b,data:{...w.data,metaKey:c,shiftKey:d,ctrlKey:h,altKey:p,key:f}})}(c);d&&addBreadcrumbEvent(l,d)}const vx={resource:function(l){const{entryType:c,initiatorType:d,name:h,responseEnd:p,startTime:f,decodedBodySize:m,encodedBodySize:y,responseStatus:_,transferSize:b}=l;if(["fetch","xmlhttprequest"].includes(d))return null;return{type:`${c}.${d}`,start:getAbsoluteTime(f),end:getAbsoluteTime(p),name:h,data:{size:b,statusCode:_,decodedBodySize:m,encodedBodySize:y}}},paint:function(l){const{duration:c,entryType:d,name:h,startTime:p}=l,f=getAbsoluteTime(p);return{type:d,name:h,start:f,end:f+c,data:void 0}},navigation:function(l){const{entryType:c,name:d,decodedBodySize:h,duration:p,domComplete:f,encodedBodySize:m,domContentLoadedEventStart:y,domContentLoadedEventEnd:_,domInteractive:b,loadEventStart:w,loadEventEnd:E,redirectCount:M,startTime:N,transferSize:P,type:L}=l;if(0===p)return null;return{type:`${c}.${L}`,start:getAbsoluteTime(N),end:getAbsoluteTime(f),name:d,data:{size:P,decodedBodySize:h,encodedBodySize:m,duration:p,domInteractive:b,domContentLoadedEventStart:y,domContentLoadedEventEnd:_,loadEventStart:w,loadEventEnd:E,domComplete:f,redirectCount:M}}}};function createPerformanceEntry(l){return vx[l.entryType]?vx[l.entryType](l):null}function getAbsoluteTime(l){return((cw||MS.performance.timeOrigin)+l)/1e3}function setupPerformanceObserver(l){function addPerformanceEntry(c){l.performanceEntries.includes(c)||l.performanceEntries.push(c)}function onEntries({entries:l}){l.forEach(addPerformanceEntry)}const c=[];return["navigation","paint","resource"].forEach((l=>{c.push(addPerformanceInstrumentationHandler(l,onEntries))})),c.push(addLcpInstrumentationHandler((({metric:c})=>{l.replayPerformanceEntries.push(function(l){const c=l.entries,d=c[c.length-1],h=d?d.element:void 0,p=l.value,f=getAbsoluteTime(p);return{type:"largest-contentful-paint",name:"largest-contentful-paint",start:f,end:f,data:{value:p,size:p,nodeId:h?record.mirror.getId(h):void 0}}}(c))}))),()=>{c.forEach((l=>l()))}}const yx="undefined"==typeof __SENTRY_DEBUG__||__SENTRY_DEBUG__;function logInfo(l,c){yx&&(Bb.info(l),c&&addLogBreadcrumb(l))}function logInfoNextTick(l,c){yx&&(Bb.info(l),c&&setTimeout((()=>{addLogBreadcrumb(l)}),0))}function addLogBreadcrumb(l){addBreadcrumb({category:"console",data:{logger:"replay"},level:"info",message:l},{level:"info"})}class EventBufferSizeExceededError extends Error{constructor(){super("Event buffer exceeded maximum size of 20000000.")}}class EventBufferArray{constructor(){this.events=[],this._totalSize=0,this.hasCheckout=!1}get hasEvents(){return this.events.length>0}get type(){return"sync"}destroy(){this.events=[]}async addEvent(l){const c=JSON.stringify(l).length;if(this._totalSize+=c,this._totalSize>DS)throw new EventBufferSizeExceededError;this.events.push(l)}finish(){return new Promise((l=>{const c=this.events;this.clear(),l(JSON.stringify(c))}))}clear(){this.events=[],this._totalSize=0,this.hasCheckout=!1}getEarliestTimestamp(){const l=this.events.map((l=>l.timestamp)).sort()[0];return l?timestampToMs(l):null}}class WorkerHandler{constructor(l){this._worker=l,this._id=0}ensureReady(){return this._ensureReadyPromise||(this._ensureReadyPromise=new Promise(((l,c)=>{this._worker.addEventListener("message",(({data:d})=>{d.success?l():c()}),{once:!0}),this._worker.addEventListener("error",(l=>{c(l)}),{once:!0})}))),this._ensureReadyPromise}destroy(){logInfo("[Replay] Destroying compression worker"),this._worker.terminate()}postMessage(l,c){const d=this._getAndIncrementId();return new Promise(((h,p)=>{const listener2=({data:c})=>{const f=c;if(f.method===l&&f.id===d){if(this._worker.removeEventListener("message",listener2),!f.success)return yx&&Bb.error("[Replay]",f.response),void p(new Error("Error in compression worker"));h(f.response)}};this._worker.addEventListener("message",listener2),this._worker.postMessage({id:d,method:l,arg:c})}))}_getAndIncrementId(){return this._id++}}class EventBufferCompressionWorker{constructor(l){this._worker=new WorkerHandler(l),this._earliestTimestamp=null,this._totalSize=0,this.hasCheckout=!1}get hasEvents(){return!!this._earliestTimestamp}get type(){return"worker"}ensureReady(){return this._worker.ensureReady()}destroy(){this._worker.destroy()}addEvent(l){const c=timestampToMs(l.timestamp);(!this._earliestTimestamp||c<this._earliestTimestamp)&&(this._earliestTimestamp=c);const d=JSON.stringify(l);return this._totalSize+=d.length,this._totalSize>DS?Promise.reject(new EventBufferSizeExceededError):this._sendEventToWorker(d)}finish(){return this._finishRequest()}clear(){this._earliestTimestamp=null,this._totalSize=0,this.hasCheckout=!1,this._worker.postMessage("clear").then(null,(l=>{yx&&Bb.warn('[Replay] Sending "clear" message to worker failed',l)}))}getEarliestTimestamp(){return this._earliestTimestamp}_sendEventToWorker(l){return this._worker.postMessage("addEvent",l)}async _finishRequest(){const l=await this._worker.postMessage("finish");return this._earliestTimestamp=null,this._totalSize=0,l}}class EventBufferProxy{constructor(l){this._fallback=new EventBufferArray,this._compression=new EventBufferCompressionWorker(l),this._used=this._fallback,this._ensureWorkerIsLoadedPromise=this._ensureWorkerIsLoaded()}get type(){return this._used.type}get hasEvents(){return this._used.hasEvents}get hasCheckout(){return this._used.hasCheckout}set hasCheckout(l){this._used.hasCheckout=l}destroy(){this._fallback.destroy(),this._compression.destroy()}clear(){return this._used.clear()}getEarliestTimestamp(){return this._used.getEarliestTimestamp()}addEvent(l){return this._used.addEvent(l)}async finish(){return await this.ensureWorkerIsLoaded(),this._used.finish()}ensureWorkerIsLoaded(){return this._ensureWorkerIsLoadedPromise}async _ensureWorkerIsLoaded(){try{await this._compression.ensureReady()}catch(l){return void logInfo("[Replay] Failed to load the compression worker, falling back to simple buffer")}await this._switchToCompressionWorker()}async _switchToCompressionWorker(){const{events:l,hasCheckout:c}=this._fallback,d=[];for(const p of l)d.push(this._compression.addEvent(p));this._compression.hasCheckout=c,this._used=this._compression;try{await Promise.all(d)}catch(h){yx&&Bb.warn("[Replay] Failed to add events when switching buffers.",h)}}}function createEventBuffer({useCompression:l,workerUrl:c}){if(l&&window.Worker){const l=function(l){try{const c=l||function(){if("undefined"==typeof __SENTRY_EXCLUDE_REPLAY_WORKER__||!__SENTRY_EXCLUDE_REPLAY_WORKER__)return function(){const l=new Blob(['var t=Uint8Array,n=Uint16Array,r=Int32Array,e=new t([0,0,0,0,0,0,0,0,1,1,1,1,2,2,2,2,3,3,3,3,4,4,4,4,5,5,5,5,0,0,0,0]),i=new t([0,0,0,0,1,1,2,2,3,3,4,4,5,5,6,6,7,7,8,8,9,9,10,10,11,11,12,12,13,13,0,0]),a=new t([16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15]),s=function(t,e){for(var i=new n(31),a=0;a<31;++a)i[a]=e+=1<<t[a-1];var s=new r(i[30]);for(a=1;a<30;++a)for(var o=i[a];o<i[a+1];++o)s[o]=o-i[a]<<5|a;return{b:i,r:s}},o=s(e,2),f=o.b,h=o.r;f[28]=258,h[258]=28;for(var l=s(i,0).r,u=new n(32768),c=0;c<32768;++c){var v=(43690&c)>>1|(21845&c)<<1;v=(61680&(v=(52428&v)>>2|(13107&v)<<2))>>4|(3855&v)<<4,u[c]=((65280&v)>>8|(255&v)<<8)>>1}var d=function(t,r,e){for(var i=t.length,a=0,s=new n(r);a<i;++a)t[a]&&++s[t[a]-1];var o,f=new n(r);for(a=1;a<r;++a)f[a]=f[a-1]+s[a-1]<<1;if(e){o=new n(1<<r);var h=15-r;for(a=0;a<i;++a)if(t[a])for(var l=a<<4|t[a],c=r-t[a],v=f[t[a]-1]++<<c,d=v|(1<<c)-1;v<=d;++v)o[u[v]>>h]=l}else for(o=new n(i),a=0;a<i;++a)t[a]&&(o[a]=u[f[t[a]-1]++]>>15-t[a]);return o},g=new t(288);for(c=0;c<144;++c)g[c]=8;for(c=144;c<256;++c)g[c]=9;for(c=256;c<280;++c)g[c]=7;for(c=280;c<288;++c)g[c]=8;var w=new t(32);for(c=0;c<32;++c)w[c]=5;var p=d(g,9,0),y=d(w,5,0),m=function(t){return(t+7)/8|0},b=function(n,r,e){return(null==r||r<0)&&(r=0),(null==e||e>n.length)&&(e=n.length),new t(n.subarray(r,e))},M=["unexpected EOF","invalid block type","invalid length/literal","invalid distance","stream finished","no stream handler",,"no callback","invalid UTF-8 data","extra field too long","date not in range 1980-2099","filename too long","stream finishing","invalid zip data"],E=function(t,n,r){var e=new Error(n||M[t]);if(e.code=t,Error.captureStackTrace&&Error.captureStackTrace(e,E),!r)throw e;return e},z=function(t,n,r){r<<=7&n;var e=n/8|0;t[e]|=r,t[e+1]|=r>>8},A=function(t,n,r){r<<=7&n;var e=n/8|0;t[e]|=r,t[e+1]|=r>>8,t[e+2]|=r>>16},_=function(r,e){for(var i=[],a=0;a<r.length;++a)r[a]&&i.push({s:a,f:r[a]});var s=i.length,o=i.slice();if(!s)return{t:F,l:0};if(1==s){var f=new t(i[0].s+1);return f[i[0].s]=1,{t:f,l:1}}i.sort((function(t,n){return t.f-n.f})),i.push({s:-1,f:25001});var h=i[0],l=i[1],u=0,c=1,v=2;for(i[0]={s:-1,f:h.f+l.f,l:h,r:l};c!=s-1;)h=i[i[u].f<i[v].f?u++:v++],l=i[u!=c&&i[u].f<i[v].f?u++:v++],i[c++]={s:-1,f:h.f+l.f,l:h,r:l};var d=o[0].s;for(a=1;a<s;++a)o[a].s>d&&(d=o[a].s);var g=new n(d+1),w=x(i[c-1],g,0);if(w>e){a=0;var p=0,y=w-e,m=1<<y;for(o.sort((function(t,n){return g[n.s]-g[t.s]||t.f-n.f}));a<s;++a){var b=o[a].s;if(!(g[b]>e))break;p+=m-(1<<w-g[b]),g[b]=e}for(p>>=y;p>0;){var M=o[a].s;g[M]<e?p-=1<<e-g[M]++-1:++a}for(;a>=0&&p;--a){var E=o[a].s;g[E]==e&&(--g[E],++p)}w=e}return{t:new t(g),l:w}},x=function(t,n,r){return-1==t.s?Math.max(x(t.l,n,r+1),x(t.r,n,r+1)):n[t.s]=r},D=function(t){for(var r=t.length;r&&!t[--r];);for(var e=new n(++r),i=0,a=t[0],s=1,o=function(t){e[i++]=t},f=1;f<=r;++f)if(t[f]==a&&f!=r)++s;else{if(!a&&s>2){for(;s>138;s-=138)o(32754);s>2&&(o(s>10?s-11<<5|28690:s-3<<5|12305),s=0)}else if(s>3){for(o(a),--s;s>6;s-=6)o(8304);s>2&&(o(s-3<<5|8208),s=0)}for(;s--;)o(a);s=1,a=t[f]}return{c:e.subarray(0,i),n:r}},T=function(t,n){for(var r=0,e=0;e<n.length;++e)r+=t[e]*n[e];return r},k=function(t,n,r){var e=r.length,i=m(n+2);t[i]=255&e,t[i+1]=e>>8,t[i+2]=255^t[i],t[i+3]=255^t[i+1];for(var a=0;a<e;++a)t[i+a+4]=r[a];return 8*(i+4+e)},C=function(t,r,s,o,f,h,l,u,c,v,m){z(r,m++,s),++f[256];for(var b=_(f,15),M=b.t,E=b.l,x=_(h,15),C=x.t,U=x.l,F=D(M),I=F.c,S=F.n,L=D(C),O=L.c,j=L.n,q=new n(19),B=0;B<I.length;++B)++q[31&I[B]];for(B=0;B<O.length;++B)++q[31&O[B]];for(var G=_(q,7),H=G.t,J=G.l,K=19;K>4&&!H[a[K-1]];--K);var N,P,Q,R,V=v+5<<3,W=T(f,g)+T(h,w)+l,X=T(f,M)+T(h,C)+l+14+3*K+T(q,H)+2*q[16]+3*q[17]+7*q[18];if(c>=0&&V<=W&&V<=X)return k(r,m,t.subarray(c,c+v));if(z(r,m,1+(X<W)),m+=2,X<W){N=d(M,E,0),P=M,Q=d(C,U,0),R=C;var Y=d(H,J,0);z(r,m,S-257),z(r,m+5,j-1),z(r,m+10,K-4),m+=14;for(B=0;B<K;++B)z(r,m+3*B,H[a[B]]);m+=3*K;for(var Z=[I,O],$=0;$<2;++$){var tt=Z[$];for(B=0;B<tt.length;++B){var nt=31&tt[B];z(r,m,Y[nt]),m+=H[nt],nt>15&&(z(r,m,tt[B]>>5&127),m+=tt[B]>>12)}}}else N=p,P=g,Q=y,R=w;for(B=0;B<u;++B){var rt=o[B];if(rt>255){A(r,m,N[(nt=rt>>18&31)+257]),m+=P[nt+257],nt>7&&(z(r,m,rt>>23&31),m+=e[nt]);var et=31&rt;A(r,m,Q[et]),m+=R[et],et>3&&(A(r,m,rt>>5&8191),m+=i[et])}else A(r,m,N[rt]),m+=P[rt]}return A(r,m,N[256]),m+P[256]},U=new r([65540,131080,131088,131104,262176,1048704,1048832,2114560,2117632]),F=new t(0),I=function(){for(var t=new Int32Array(256),n=0;n<256;++n){for(var r=n,e=9;--e;)r=(1&r&&-306674912)^r>>>1;t[n]=r}return t}(),S=function(){var t=1,n=0;return{p:function(r){for(var e=t,i=n,a=0|r.length,s=0;s!=a;){for(var o=Math.min(s+2655,a);s<o;++s)i+=e+=r[s];e=(65535&e)+15*(e>>16),i=(65535&i)+15*(i>>16)}t=e,n=i},d:function(){return(255&(t%=65521))<<24|(65280&t)<<8|(255&(n%=65521))<<8|n>>8}}},L=function(a,s,o,f,u){if(!u&&(u={l:1},s.dictionary)){var c=s.dictionary.subarray(-32768),v=new t(c.length+a.length);v.set(c),v.set(a,c.length),a=v,u.w=c.length}return function(a,s,o,f,u,c){var v=c.z||a.length,d=new t(f+v+5*(1+Math.ceil(v/7e3))+u),g=d.subarray(f,d.length-u),w=c.l,p=7&(c.r||0);if(s){p&&(g[0]=c.r>>3);for(var y=U[s-1],M=y>>13,E=8191&y,z=(1<<o)-1,A=c.p||new n(32768),_=c.h||new n(z+1),x=Math.ceil(o/3),D=2*x,T=function(t){return(a[t]^a[t+1]<<x^a[t+2]<<D)&z},F=new r(25e3),I=new n(288),S=new n(32),L=0,O=0,j=c.i||0,q=0,B=c.w||0,G=0;j+2<v;++j){var H=T(j),J=32767&j,K=_[H];if(A[J]=K,_[H]=J,B<=j){var N=v-j;if((L>7e3||q>24576)&&(N>423||!w)){p=C(a,g,0,F,I,S,O,q,G,j-G,p),q=L=O=0,G=j;for(var P=0;P<286;++P)I[P]=0;for(P=0;P<30;++P)S[P]=0}var Q=2,R=0,V=E,W=J-K&32767;if(N>2&&H==T(j-W))for(var X=Math.min(M,N)-1,Y=Math.min(32767,j),Z=Math.min(258,N);W<=Y&&--V&&J!=K;){if(a[j+Q]==a[j+Q-W]){for(var $=0;$<Z&&a[j+$]==a[j+$-W];++$);if($>Q){if(Q=$,R=W,$>X)break;var tt=Math.min(W,$-2),nt=0;for(P=0;P<tt;++P){var rt=j-W+P&32767,et=rt-A[rt]&32767;et>nt&&(nt=et,K=rt)}}}W+=(J=K)-(K=A[J])&32767}if(R){F[q++]=268435456|h[Q]<<18|l[R];var it=31&h[Q],at=31&l[R];O+=e[it]+i[at],++I[257+it],++S[at],B=j+Q,++L}else F[q++]=a[j],++I[a[j]]}}for(j=Math.max(j,B);j<v;++j)F[q++]=a[j],++I[a[j]];p=C(a,g,w,F,I,S,O,q,G,j-G,p),w||(c.r=7&p|g[p/8|0]<<3,p-=7,c.h=_,c.p=A,c.i=j,c.w=B)}else{for(j=c.w||0;j<v+w;j+=65535){var st=j+65535;st>=v&&(g[p/8|0]=w,st=v),p=k(g,p+1,a.subarray(j,st))}c.i=v}return b(d,0,f+m(p)+u)}(a,null==s.level?6:s.level,null==s.mem?Math.ceil(1.5*Math.max(8,Math.min(13,Math.log(a.length)))):12+s.mem,o,f,u)},O=function(t,n,r){for(;r;++n)t[n]=r,r>>>=8},j=function(){function n(n,r){if("function"==typeof n&&(r=n,n={}),this.ondata=r,this.o=n||{},this.s={l:0,i:32768,w:32768,z:32768},this.b=new t(98304),this.o.dictionary){var e=this.o.dictionary.subarray(-32768);this.b.set(e,32768-e.length),this.s.i=32768-e.length}}return n.prototype.p=function(t,n){this.ondata(L(t,this.o,0,0,this.s),n)},n.prototype.push=function(n,r){this.ondata||E(5),this.s.l&&E(4);var e=n.length+this.s.z;if(e>this.b.length){if(e>2*this.b.length-32768){var i=new t(-32768&e);i.set(this.b.subarray(0,this.s.z)),this.b=i}var a=this.b.length-this.s.z;a&&(this.b.set(n.subarray(0,a),this.s.z),this.s.z=this.b.length,this.p(this.b,!1)),this.b.set(this.b.subarray(-32768)),this.b.set(n.subarray(a),32768),this.s.z=n.length-a+32768,this.s.i=32766,this.s.w=32768}else this.b.set(n,this.s.z),this.s.z+=n.length;this.s.l=1&r,(this.s.z>this.s.w+8191||r)&&(this.p(this.b,r||!1),this.s.w=this.s.i,this.s.i-=2)},n}();function q(t,n){n||(n={});var r=function(){var t=-1;return{p:function(n){for(var r=t,e=0;e<n.length;++e)r=I[255&r^n[e]]^r>>>8;t=r},d:function(){return~t}}}(),e=t.length;r.p(t);var i,a=L(t,n,10+((i=n).filename?i.filename.length+1:0),8),s=a.length;return function(t,n){var r=n.filename;if(t[0]=31,t[1]=139,t[2]=8,t[8]=n.level<2?4:9==n.level?2:0,t[9]=3,0!=n.mtime&&O(t,4,Math.floor(new Date(n.mtime||Date.now())/1e3)),r){t[3]=8;for(var e=0;e<=r.length;++e)t[e+10]=r.charCodeAt(e)}}(a,n),O(a,s-8,r.d()),O(a,s-4,e),a}var B=function(){function t(t,n){this.c=S(),this.v=1,j.call(this,t,n)}return t.prototype.push=function(t,n){this.c.p(t),j.prototype.push.call(this,t,n)},t.prototype.p=function(t,n){var r=L(t,this.o,this.v&&(this.o.dictionary?6:2),n&&4,this.s);this.v&&(function(t,n){var r=n.level,e=0==r?0:r<6?1:9==r?3:2;if(t[0]=120,t[1]=e<<6|(n.dictionary&&32),t[1]|=31-(t[0]<<8|t[1])%31,n.dictionary){var i=S();i.p(n.dictionary),O(t,2,i.d())}}(r,this.o),this.v=0),n&&O(r,r.length-4,this.c.d()),this.ondata(r,n)},t}(),G="undefined"!=typeof TextEncoder&&new TextEncoder,H="undefined"!=typeof TextDecoder&&new TextDecoder;try{H.decode(F,{stream:!0})}catch(t){}var J=function(){function t(t){this.ondata=t}return t.prototype.push=function(t,n){this.ondata||E(5),this.d&&E(4),this.ondata(K(t),this.d=n||!1)},t}();function K(n,r){if(r){for(var e=new t(n.length),i=0;i<n.length;++i)e[i]=n.charCodeAt(i);return e}if(G)return G.encode(n);var a=n.length,s=new t(n.length+(n.length>>1)),o=0,f=function(t){s[o++]=t};for(i=0;i<a;++i){if(o+5>s.length){var h=new t(o+8+(a-i<<1));h.set(s),s=h}var l=n.charCodeAt(i);l<128||r?f(l):l<2048?(f(192|l>>6),f(128|63&l)):l>55295&&l<57344?(f(240|(l=65536+(1047552&l)|1023&n.charCodeAt(++i))>>18),f(128|l>>12&63),f(128|l>>6&63),f(128|63&l)):(f(224|l>>12),f(128|l>>6&63),f(128|63&l))}return b(s,0,o)}const N=new class{constructor(){this._init()}clear(){this._init()}addEvent(t){if(!t)throw new Error("Adding invalid event");const n=this._hasEvents?",":"";this.stream.push(n+t),this._hasEvents=!0}finish(){this.stream.push("]",!0);const t=function(t){let n=0;for(let r=0,e=t.length;r<e;r++)n+=t[r].length;const r=new Uint8Array(n);for(let n=0,e=0,i=t.length;n<i;n++){const i=t[n];r.set(i,e),e+=i.length}return r}(this._deflatedData);return this._init(),t}_init(){this._hasEvents=!1,this._deflatedData=[],this.deflate=new B,this.deflate.ondata=(t,n)=>{this._deflatedData.push(t)},this.stream=new J(((t,n)=>{this.deflate.push(t,n)})),this.stream.push("[")}},P={clear:()=>{N.clear()},addEvent:t=>N.addEvent(t),finish:()=>N.finish(),compress:t=>function(t){return q(K(t))}(t)};addEventListener("message",(function(t){const n=t.data.method,r=t.data.id,e=t.data.arg;if(n in P&&"function"==typeof P[n])try{const t=P[n](e);postMessage({id:r,method:n,success:!0,response:t})}catch(t){postMessage({id:r,method:n,success:!1,response:t.message}),console.error(t)}})),postMessage({id:void 0,method:"init",success:!0,response:void 0});']);return URL.createObjectURL(l)}();return""}();if(!c)return;logInfo("[Replay] Using compression worker"+(l?` from ${l}`:""));const d=new Worker(c);return new EventBufferProxy(d)}catch(c){logInfo("[Replay] Failed to create compression worker")}}(c);if(l)return l}return logInfo("[Replay] Using simple buffer"),new EventBufferArray}function hasSessionStorage(){try{return"sessionStorage"in MS&&!!MS.sessionStorage}catch(hh){return!1}}function clearSession(l){!function(){if(!hasSessionStorage())return;try{MS.sessionStorage.removeItem(NS)}catch(hh){}}(),l.session=void 0}function isSampled(l){return void 0!==l&&Math.random()<l}function makeSession(l){const c=Date.now();return{id:l.id||uuid4(),started:l.started||c,lastActivity:l.lastActivity||c,segmentId:l.segmentId||0,sampled:l.sampled,previousSessionId:l.previousSessionId}}function saveSession(l){if(hasSessionStorage())try{MS.sessionStorage.setItem(NS,JSON.stringify(l))}catch(hh){}}function createSession({sessionSampleRate:l,allowBuffering:c,stickySession:d=!1},{previousSessionId:h}={}){const p=function(l,c){return isSampled(l)?"session":!!c&&"buffer"}(l,c),f=makeSession({sampled:p,previousSessionId:h});return d&&saveSession(f),f}function isExpired(l,c,d=+new Date){return null===l||void 0===c||c<0||0!==c&&l+c<=d}function isSessionExpired(l,{maxReplayDuration:c,sessionIdleExpire:d,targetTime:h=Date.now()}){return isExpired(l.started,c,h)||isExpired(l.lastActivity,d,h)}function shouldRefreshSession(l,{sessionIdleExpire:c,maxReplayDuration:d}){return!!isSessionExpired(l,{sessionIdleExpire:c,maxReplayDuration:d})&&("buffer"!==l.sampled||0!==l.segmentId)}function loadOrCreateSession({traceInternals:l,sessionIdleExpire:c,maxReplayDuration:d,previousSessionId:h},p){const f=p.stickySession&&function(l){if(!hasSessionStorage())return null;try{const c=MS.sessionStorage.getItem(NS);if(!c)return null;const d=JSON.parse(c);return logInfoNextTick("[Replay] Loading existing session",l),makeSession(d)}catch(hh){return null}}(l);return f?shouldRefreshSession(f,{sessionIdleExpire:c,maxReplayDuration:d})?(logInfoNextTick("[Replay] Session in sessionStorage is expired, creating new one..."),createSession(p,{previousSessionId:f.id})):f:(logInfoNextTick("[Replay] Creating new session",l),createSession(p,{previousSessionId:h}))}function addEventSync(l,c,d){return!!shouldAddEvent(l,c)&&(_addEvent(l,c,d),!0)}async function _addEvent(l,c,d){if(!l.eventBuffer)return null;try{d&&"buffer"===l.recordingMode&&l.eventBuffer.clear(),d&&(l.eventBuffer.hasCheckout=!0);const h=function(l,c){try{if("function"==typeof c&&function(l){return l.type===rx.Custom}(l))return c(l)}catch(d){return yx&&Bb.error("[Replay] An error occured in the `beforeAddRecordingEvent` callback, skipping the event...",d),null}return l}(c,l.getOptions().beforeAddRecordingEvent);if(!h)return;return await l.eventBuffer.addEvent(h)}catch(h){const c=h&&h instanceof EventBufferSizeExceededError?"addEventSizeExceeded":"addEvent";yx&&Bb.error(h),await l.stop({reason:c});const d=getClient();d&&d.recordDroppedEvent("internal_sdk_error","replay")}}function shouldAddEvent(l,c){if(!l.eventBuffer||l.isPaused()||!l.isEnabled())return!1;const d=timestampToMs(c.timestamp);return!(d+l.timeouts.sessionIdlePause<Date.now())&&(!(d>l.getContext().initialTimestamp+l.getOptions().maxReplayDuration)||(logInfo(`[Replay] Skipping event with timestamp ${d} because it is after maxReplayDuration`,l.getOptions()._experiments.traceInternals),!1))}function isErrorEvent(l){return!l.type}function isTransactionEvent(l){return"transaction"===l.type}function isFeedbackEvent(l){return"feedback"===l.type}function handleAfterSendEvent(l){const c=function(){const l=getClient();if(!l)return!1;const c=l.getTransport();if(!c)return!1;return c.send.__sentry__baseTransport__||!1}();return(d,h)=>{if(!l.isEnabled()||!isErrorEvent(d)&&!isTransactionEvent(d))return;const p=h&&h.statusCode;c&&(!p||p<200||p>=300)||(isTransactionEvent(d)?function(l,c){const d=l.getContext();c.contexts&&c.contexts.trace&&c.contexts.trace.trace_id&&d.traceIds.size<100&&d.traceIds.add(c.contexts.trace.trace_id)}(l,d):function(l,c){const d=l.getContext();c.event_id&&d.errorIds.size<100&&d.errorIds.add(c.event_id);if("buffer"!==l.recordingMode||!c.tags||!c.tags.replayId)return;const{beforeErrorSampling:h}=l.getOptions();if("function"==typeof h&&!h(c))return;setTimeout((()=>{l.sendBufferedReplayOrFlush()}))}(l,d))}}function handleBeforeSendEvent(l){return c=>{l.isEnabled()&&isErrorEvent(c)&&function(l,c){const d=c.exception&&c.exception.values&&c.exception.values[0].value;if("string"!=typeof d)return;if(d.match(/reactjs\.org\/docs\/error-decoder\.html\?invariant=(418|419|422|423|425)/)||d.match(/(does not match server-rendered HTML|Hydration failed because)/i)){addBreadcrumbEvent(l,createBreadcrumb({category:"replay.hydrate-error"}))}}(l,c)}}function handleGlobalEventListener(l,c=!1){const d=c?handleAfterSendEvent(l):void 0;return Object.assign(((c,h)=>{if(!l.isEnabled())return c;if(function(l){return"replay_event"===l.type}(c))return delete c.breadcrumbs,c;if(!isErrorEvent(c)&&!isTransactionEvent(c)&&!isFeedbackEvent(c))return c;if(!l.checkAndHandleExpiredSession())return c;if(isFeedbackEvent(c))return l.flush(),c.contexts.feedback.replay_id=l.getSessionId(),function(l,c){l.triggerUserActivity(),l.addUpdate((()=>!c.timestamp||(l.throttledAddEvent({type:rx.Custom,timestamp:1e3*c.timestamp,data:{tag:"breadcrumb",payload:{timestamp:c.timestamp,type:"default",category:"sentry.feedback",data:{feedbackId:c.event_id}}}}),!1)))}(l,c),c;if(function(l,c){return!(l.type||!l.exception||!l.exception.values||!l.exception.values.length||!c.originalException||!c.originalException.__rrweb__)}(c,h)&&!l.getOptions()._experiments.captureExceptions)return yx&&Bb.log("[Replay] Ignoring error from rrweb internals",c),null;const p=function(l,c){return"buffer"===l.recordingMode&&c.message!==PS&&!(!c.exception||c.type)&&isSampled(l.getOptions().errorSampleRate)}(l,c);return(p||"session"===l.recordingMode)&&(c.tags={...c.tags,replayId:l.getSessionId()}),d&&d(c,{statusCode:200}),c}),{id:"Replay"})}function createPerformanceSpans(l,c){return c.map((({type:c,start:d,end:h,name:p,data:f})=>{const m=l.throttledAddEvent({type:rx.Custom,timestamp:d,data:{tag:"performanceSpan",payload:{op:c,description:p,startTimestamp:d,endTimestamp:h,data:f}}});return"string"==typeof m?Promise.resolve(null):m}))}function handleHistorySpanListener(l){return c=>{if(!l.isEnabled())return;const d=function(l){const{from:c,to:d}=l,h=Date.now()/1e3;return{type:"navigation.push",start:h,end:h,name:d,data:{previous:c}}}(c);null!==d&&(l.getContext().urls.push(d.name),l.triggerUserActivity(),l.addUpdate((()=>(createPerformanceSpans(l,[d]),!1))))}}function addNetworkBreadcrumb(l,c){l.isEnabled()&&null!==c&&(function(l,c){return(!yx||!l.getOptions()._experiments.traceInternals)&&isSentryRequestUrl(c,getClient())}(l,c.name)||l.addUpdate((()=>(createPerformanceSpans(l,[c]),!0))))}function handleXhrSpanListener(l){return c=>{if(!l.isEnabled())return;const d=function(l){const{startTimestamp:c,endTimestamp:d,xhr:h}=l,p=h[iw];if(!c||!d||!p)return null;const{method:f,url:m,status_code:y}=p;return void 0===m?null:{type:"resource.xhr",name:m,start:c/1e3,end:d/1e3,data:{method:f,statusCode:y}}}(c);addNetworkBreadcrumb(l,d)}}function getBodySize(l,c){if(l)try{if("string"==typeof l)return c.encode(l).length;if(l instanceof URLSearchParams)return c.encode(l.toString()).length;if(l instanceof FormData){const d=_serializeFormData(l);return c.encode(d).length}if(l instanceof Blob)return l.size;if(l instanceof ArrayBuffer)return l.byteLength}catch(hh){}}function parseContentLengthHeader(l){if(!l)return;const c=parseInt(l,10);return isNaN(c)?void 0:c}function getBodyString(l){try{if("string"==typeof l)return[l];if(l instanceof URLSearchParams)return[l.toString()];if(l instanceof FormData)return[_serializeFormData(l)];if(!l)return[void 0]}catch(c){return yx&&Bb.warn("[Replay] Failed to serialize body",l),[void 0,"BODY_PARSE_ERROR"]}return yx&&Bb.info("[Replay] Skipping network body because of body type",l),[void 0,"UNPARSEABLE_BODY_TYPE"]}function mergeWarning(l,c){if(!l)return{headers:{},size:void 0,_meta:{warnings:[c]}};const d={...l._meta},h=d.warnings||[];return d.warnings=[...h,c],l._meta=d,l}function makeNetworkReplayBreadcrumb(l,c){if(!c)return null;const{startTimestamp:d,endTimestamp:h,url:p,method:f,statusCode:m,request:y,response:_}=c;return{type:l,start:d/1e3,end:h/1e3,name:p,data:dropUndefinedKeys({method:f,statusCode:m,request:y,response:_})}}function buildSkippedNetworkRequestOrResponse(l){return{headers:{},size:l,_meta:{warnings:["URL_SKIPPED"]}}}function buildNetworkRequestOrResponse(l,c,d){if(!c&&0===Object.keys(l).length)return;if(!c)return{headers:l};if(!d)return{headers:l,size:c};const h={headers:l,size:c},{body:p,warnings:f}=function(l){if(!l||"string"!=typeof l)return{body:l};const c=l.length>LS,d=function(l){const c=l[0],d=l[l.length-1];return"["===c&&"]"===d||"{"===c&&"}"===d}(l);if(c){const c=l.slice(0,LS);return d?{body:c,warnings:["MAYBE_JSON_TRUNCATED"]}:{body:`${c}\u2026`,warnings:["TEXT_TRUNCATED"]}}if(d)try{return{body:JSON.parse(l)}}catch(hh){}return{body:l}}(d);return h.body=p,f&&f.length>0&&(h._meta={warnings:f}),h}function getAllowedHeaders(l,c){return Object.keys(l).reduce(((d,h)=>{const p=h.toLowerCase();return c.includes(p)&&l[h]&&(d[p]=l[h]),d}),{})}function _serializeFormData(l){return new URLSearchParams(l).toString()}function urlMatches(l,c){const d=function(l,c=MS.document.baseURI){if(l.startsWith("http://")||l.startsWith("https://")||l.startsWith(MS.location.origin))return l;const d=new URL(l,c);if(d.origin!==new URL(c).origin)return l;const h=d.href;if(!l.endsWith("/")&&h.endsWith("/"))return h.slice(0,-1);return h}(l);return stringMatchesSomePattern(d,c)}async function captureFetchBreadcrumbToReplay(l,c,d){try{const h=await async function(l,c,d){const h=Date.now(),{startTimestamp:p=h,endTimestamp:f=h}=c,{url:m,method:y,status_code:_=0,request_body_size:b,response_body_size:w}=l.data,E=urlMatches(m,d.networkDetailAllowUrls)&&!urlMatches(m,d.networkDetailDenyUrls),M=E?function({networkCaptureBodies:l,networkRequestHeaders:c},d,h){const p=d?function(l,c){if(1===l.length&&"string"!=typeof l[0])return getHeadersFromOptions(l[0],c);if(2===l.length)return getHeadersFromOptions(l[1],c);return{}}(d,c):{};if(!l)return buildNetworkRequestOrResponse(p,h,void 0);const f=_getFetchRequestArgBody(d),[m,y]=getBodyString(f),_=buildNetworkRequestOrResponse(p,h,m);if(y)return mergeWarning(_,y);return _}(d,c.input,b):buildSkippedNetworkRequestOrResponse(b),N=await async function(l,{networkCaptureBodies:c,textEncoder:d,networkResponseHeaders:h},p,f){if(!l&&void 0!==f)return buildSkippedNetworkRequestOrResponse(f);const m=p?getAllHeaders(p.headers,h):{};if(!p||!c&&void 0!==f)return buildNetworkRequestOrResponse(m,f,void 0);const[y,_]=await async function(l){const c=function(l){try{return l.clone()}catch(c){yx&&Bb.warn("[Replay] Failed to clone response body",c)}}(l);if(!c)return[void 0,"BODY_PARSE_ERROR"];try{const l=await function(l){return new Promise(((c,d)=>{const h=setTimeout((()=>d(new Error("Timeout while trying to read response body"))),500);(async function(l){return await l.text()})(l).then((l=>c(l)),(l=>d(l))).finally((()=>clearTimeout(h)))}))}(c);return[l]}catch(d){return yx&&Bb.warn("[Replay] Failed to get text body from response",d),[void 0,"BODY_PARSE_ERROR"]}}(p),b=function(l,{networkCaptureBodies:c,textEncoder:d,responseBodySize:h,captureDetails:p,headers:f}){try{const m=l&&l.length&&void 0===h?getBodySize(l,d):h;return p?buildNetworkRequestOrResponse(f,m,c?l:void 0):buildSkippedNetworkRequestOrResponse(m)}catch(m){return yx&&Bb.warn("[Replay] Failed to serialize response body",m),buildNetworkRequestOrResponse(f,h,void 0)}}(y,{networkCaptureBodies:c,textEncoder:d,responseBodySize:f,captureDetails:l,headers:m});if(_)return mergeWarning(b,_);return b}(E,d,c.response,w);return{startTimestamp:p,endTimestamp:f,url:m,method:y,statusCode:_,request:M,response:N}}(l,c,d),p=makeNetworkReplayBreadcrumb("resource.fetch",h);addNetworkBreadcrumb(d.replay,p)}catch(h){yx&&Bb.error("[Replay] Failed to capture fetch breadcrumb",h)}}function _getFetchRequestArgBody(l=[]){if(2===l.length&&"object"==typeof l[1])return l[1].body}function getAllHeaders(l,c){const d={};return c.forEach((c=>{l.get(c)&&(d[c]=l.get(c))})),d}function getHeadersFromOptions(l,c){if(!l)return{};const d=l.headers;return d?d instanceof Headers?getAllHeaders(d,c):Array.isArray(d)?{}:getAllowedHeaders(d,c):{}}async function captureXhrBreadcrumbToReplay(l,c,d){try{const h=function(l,c,d){const h=Date.now(),{startTimestamp:p=h,endTimestamp:f=h,input:m,xhr:y}=c,{url:_,method:b,status_code:w=0,request_body_size:E,response_body_size:M}=l.data;if(!_)return null;if(!y||!urlMatches(_,d.networkDetailAllowUrls)||urlMatches(_,d.networkDetailDenyUrls)){return{startTimestamp:p,endTimestamp:f,url:_,method:b,statusCode:w,request:buildSkippedNetworkRequestOrResponse(E),response:buildSkippedNetworkRequestOrResponse(M)}}const N=y[iw],P=N?getAllowedHeaders(N.request_headers,d.networkRequestHeaders):{},L=getAllowedHeaders(function(l){const c=l.getAllResponseHeaders();if(!c)return{};return c.split("\r\n").reduce(((l,c)=>{const[d,h]=c.split(": ");return l[d.toLowerCase()]=h,l}),{})}(y),d.networkResponseHeaders),[j,D]=d.networkCaptureBodies?getBodyString(m):[void 0],[F,U]=d.networkCaptureBodies?function(l){const c=[];try{return[l.responseText]}catch(hh){c.push(hh)}try{return function(l,c){try{if("string"==typeof l)return[l];if(l instanceof Document)return[l.body.outerHTML];if("json"===c&&l&&"object"==typeof l)return[JSON.stringify(l)];if(!l)return[void 0]}catch(d){return yx&&Bb.warn("[Replay] Failed to serialize body",l),[void 0,"BODY_PARSE_ERROR"]}return yx&&Bb.info("[Replay] Skipping network body because of body type",l),[void 0,"UNPARSEABLE_BODY_TYPE"]}(l.response,l.responseType)}catch(hh){c.push(hh)}return yx&&Bb.warn("[Replay] Failed to get xhr response body",...c),[void 0]}(y):[void 0],B=buildNetworkRequestOrResponse(P,E,j),H=buildNetworkRequestOrResponse(L,M,F);return{startTimestamp:p,endTimestamp:f,url:_,method:b,statusCode:w,request:D?mergeWarning(B,D):B,response:U?mergeWarning(H,U):H}}(l,c,d),p=makeNetworkReplayBreadcrumb("resource.xhr",h);addNetworkBreadcrumb(d.replay,p)}catch(h){yx&&Bb.error("[Replay] Failed to capture xhr breadcrumb",h)}}function enrichXhrBreadcrumb(l,c,d){const{xhr:h,input:p}=c;if(!h)return;const f=getBodySize(p,d.textEncoder),m=h.getResponseHeader("content-length")?parseContentLengthHeader(h.getResponseHeader("content-length")):function(l,c,d){try{return getBodySize("json"===c&&l&&"object"==typeof l?JSON.stringify(l):l,d)}catch(hh){return}}(h.response,h.responseType,d.textEncoder);void 0!==f&&(l.data.request_body_size=f),void 0!==m&&(l.data.response_body_size=m)}function handleNetworkBreadcrumbs(l){const c=getClient();try{const d=new TextEncoder,{networkDetailAllowUrls:h,networkDetailDenyUrls:p,networkCaptureBodies:f,networkRequestHeaders:m,networkResponseHeaders:y}=l.getOptions(),_={replay:l,textEncoder:d,networkDetailAllowUrls:h,networkDetailDenyUrls:p,networkCaptureBodies:f,networkRequestHeaders:m,networkResponseHeaders:y};c&&c.on?c.on("beforeAddBreadcrumb",((l,c)=>function(l,c,d){if(!c.data)return;try{(function(l){return"xhr"===l.category})(c)&&function(l){return l&&l.xhr}(d)&&(enrichXhrBreadcrumb(c,d,l),captureXhrBreadcrumbToReplay(c,d,l)),function(l){return"fetch"===l.category}(c)&&function(l){return l&&l.response}(d)&&(!function(l,c,d){const{input:h,response:p}=c,f=getBodySize(h?_getFetchRequestArgBody(h):void 0,d.textEncoder),m=p?parseContentLengthHeader(p.headers.get("content-length")):void 0;void 0!==f&&(l.data.request_body_size=f),void 0!==m&&(l.data.response_body_size=m)}(c,d,l),captureFetchBreadcrumbToReplay(c,d,l))}catch(hh){yx&&Bb.warn("Error when enriching network breadcrumb")}}(_,l,c))):(addFetchInstrumentationHandler(function(l){return c=>{if(!l.isEnabled())return;const d=function(l){const{startTimestamp:c,endTimestamp:d,fetchData:h,response:p}=l;if(!d)return null;const{method:f,url:m}=h;return{type:"resource.fetch",start:c/1e3,end:d/1e3,name:m,data:{method:f,statusCode:p?p.status:void 0}}}(c);addNetworkBreadcrumb(l,d)}}(l)),addXhrInstrumentationHandler(handleXhrSpanListener(l)))}catch(d){}}let _x=null;const handleScopeListener=l=>c=>{if(!l.isEnabled())return;const d=function(l){const c=l.getLastBreadcrumb&&l.getLastBreadcrumb();if(_x===c||!c)return null;if(_x=c,!function(l){return!!l.category}(c)||["fetch","xhr","sentry.event","sentry.transaction"].includes(c.category)||c.category.startsWith("ui."))return null;if("console"===c.category)return function(l){const c=l.data&&l.data.arguments;if(!Array.isArray(c)||0===c.length)return createBreadcrumb(l);let d=!1;const h=c.map((l=>{if(!l)return l;if("string"==typeof l)return l.length>jS?(d=!0,`${l.slice(0,jS)}\u2026`):l;if("object"==typeof l)try{const c=normalize(l,7);return JSON.stringify(c).length>jS?(d=!0,`${JSON.stringify(c,null,2).slice(0,jS)}\u2026`):c}catch(hh){}return l}));return createBreadcrumb({...l,data:{...l.data,arguments:h,...d?{_meta:{warnings:["CONSOLE_ARG_TRUNCATED"]}}:{}}})}(c);return createBreadcrumb(c)}(c);d&&addBreadcrumbEvent(l,d)};function addGlobalListeners(l){const c=getCurrentScope$1(),d=getClient();c.addScopeListener(handleScopeListener(l)),addClickKeypressInstrumentationHandler(handleDomListener(l)),addHistoryInstrumentationHandler(handleHistorySpanListener(l)),handleNetworkBreadcrumbs(l);const h=handleGlobalEventListener(l,!hasHooks(d));d&&d.addEventProcessor?d.addEventProcessor(h):function(l){const c=getClient();c&&c.addEventProcessor&&c.addEventProcessor(l)}(h),hasHooks(d)&&(d.on("beforeSendEvent",handleBeforeSendEvent(l)),d.on("afterSendEvent",handleAfterSendEvent(l)),d.on("createDsc",(c=>{const d=l.getSessionId();if(d&&l.isEnabled()&&"session"===l.recordingMode){l.checkAndHandleExpiredSession()&&(c.replay_id=d)}})),d.on("startTransaction",(c=>{l.lastTransaction=c})),d.on("finishTransaction",(c=>{l.lastTransaction=c})),d.on("beforeSendFeedback",((c,d)=>{const h=l.getSessionId();d&&d.includeReplay&&l.isEnabled()&&h&&c.contexts&&c.contexts.feedback&&(c.contexts.feedback.replay_id=h)})))}function hasHooks(l){return!(!l||!l.on)}function createMemoryEntry(l){const{jsHeapSizeLimit:c,totalJSHeapSize:d,usedJSHeapSize:h}=l,p=Date.now()/1e3;return{type:"memory",name:"memory",start:p,end:p,data:{memory:{jsHeapSizeLimit:c,totalJSHeapSize:d,usedJSHeapSize:h}}}}function getHandleRecordingEmit(l){let c=!1;return(d,h)=>{if(!l.checkAndHandleExpiredSession())return void(yx&&Bb.warn("[Replay] Received replay event after session expired."));const p=h||!c;c=!0,l.clickDetector&&updateClickDetectorForRecordingEvent(l.clickDetector,d),l.addUpdate((()=>{if("buffer"===l.recordingMode&&p&&l.setInitialState(),!addEventSync(l,d,p))return!0;if(!p)return!1;if(function(l,c){if(!c||!l.session||0!==l.session.segmentId)return;addEventSync(l,function(l){const c=l.getOptions();return{type:rx.Custom,timestamp:Date.now(),data:{tag:"options",payload:{shouldRecordCanvas:l.isRecordingCanvas(),sessionSampleRate:c.sessionSampleRate,errorSampleRate:c.errorSampleRate,useCompressionOption:c.useCompression,blockAllMedia:c.blockAllMedia,maskAllText:c.maskAllText,maskAllInputs:c.maskAllInputs,useCompression:!!l.eventBuffer&&"worker"===l.eventBuffer.type,networkDetailHasUrls:c.networkDetailAllowUrls.length>0,networkCaptureBodies:c.networkCaptureBodies,networkRequestHasHeaders:c.networkRequestHeaders.length>0,networkResponseHasHeaders:c.networkResponseHeaders.length>0}}}}(l),!1)}(l,p),l.session&&l.session.previousSessionId)return!0;if("buffer"===l.recordingMode&&l.session&&l.eventBuffer){const c=l.eventBuffer.getEarliestTimestamp();c&&(logInfo(`[Replay] Updating session start time to earliest event in buffer to ${new Date(c)}`,l.getOptions()._experiments.traceInternals),l.session.started=c,l.getOptions().stickySession&&saveSession(l.session))}return"session"===l.recordingMode&&l.flush(),!0}))}}async function sendReplayRequest({recordingData:l,replayId:c,segmentId:d,eventContext:h,timestamp:p,session:f}){const m=function({recordingData:l,headers:c}){let d;const h=`${JSON.stringify(c)}\n`;if("string"==typeof l)d=`${h}${l}`;else{const c=(new TextEncoder).encode(h);d=new Uint8Array(c.length+l.length),d.set(c),d.set(l,c.length)}return d}({recordingData:l,headers:{segment_id:d}}),{urls:y,errorIds:_,traceIds:b,initialTimestamp:w}=h,E=getClient(),M=getCurrentScope$1(),N=E&&E.getTransport(),P=E&&E.getDsn();if(!(E&&N&&P&&f.sampled))return;const L={type:"replay_event",replay_start_timestamp:w/1e3,timestamp:p/1e3,error_ids:_,trace_ids:b,urls:y,replay_id:c,segment_id:d,replay_type:f.sampled},j=await async function({client:l,scope:c,replayId:d,event:h}){const p={event_id:d,integrations:"object"!=typeof l._integrations||null===l._integrations||Array.isArray(l._integrations)?void 0:Object.keys(l._integrations)};l.emit&&l.emit("preprocessEvent",h,p);const f=await prepareEvent(l.getOptions(),h,p,c,l,getIsolationScope());if(!f)return null;f.platform=f.platform||"javascript";const m=l.getSdkMetadata&&l.getSdkMetadata(),{name:y,version:_}=m&&m.sdk||{};return f.sdk={...f.sdk,name:y||"sentry.javascript.unknown",version:_||"0.0.0"},f}({scope:M,client:E,replayId:c,event:L});if(!j)return E.recordDroppedEvent("event_processor","replay",L),void logInfo("An event processor returned `null`, will not send event.");delete j.sdkProcessingMetadata;const D=function(l,c,d,h){return createEnvelope(createEventEnvelopeHeaders(l,getSdkMetadataForEnvelopeHeader(l),h,d),[[{type:"replay_event"},l],[{type:"replay_recording",length:"string"==typeof c?(new TextEncoder).encode(c).length:c.length},c]])}(j,m,P,E.getOptions().tunnel);let F;try{F=await N.send(D)}catch(B){const l=new Error(PS);try{l.cause=B}catch(hh){}throw l}if(!F)return F;if("number"==typeof F.statusCode&&(F.statusCode<200||F.statusCode>=300))throw new TransportStatusCodeError(F.statusCode);const U=updateRateLimits({},F);if(isRateLimited(U,"replay"))throw new RateLimitError(U);return F}class TransportStatusCodeError extends Error{constructor(l){super(`Transport returned status code ${l}`)}}class RateLimitError extends Error{constructor(l){super("Rate limit hit"),this.rateLimits=l}}async function sendReplay(l,c={count:0,interval:5e3}){const{recordingData:d,options:h}=l;if(d.length)try{return await sendReplayRequest(l),!0}catch(p){if(p instanceof TransportStatusCodeError||p instanceof RateLimitError)throw p;if(setContext("Replays",{_retryCount:c.count}),yx&&h._experiments&&h._experiments.captureExceptions&&captureException(p),c.count>=3){const l=new Error(`${PS} - max retries exceeded`);try{l.cause=p}catch(hh){}throw l}return c.interval*=++c.count,new Promise(((d,h)=>{setTimeout((async()=>{try{await sendReplay(l,c),d(!0)}catch(p){h(p)}}),c.interval)}))}}const bx="__THROTTLED";function throttle(l,c,d){const h=new Map;let p=!1;return(...f)=>{const m=Math.floor(Date.now()/1e3);if((l=>{const c=l-d;h.forEach(((l,d)=>{d<c&&h.delete(d)}))})(m),[...h.values()].reduce(((l,c)=>l+c),0)>=c){const l=p;return p=!0,l?"__SKIPPED":bx}p=!1;const y=h.get(m)||0;return h.set(m,y+1),l(...f)}}class ReplayContainer{constructor({options:l,recordingOptions:c}){ReplayContainer.prototype.__init.call(this),ReplayContainer.prototype.__init2.call(this),ReplayContainer.prototype.__init3.call(this),ReplayContainer.prototype.__init4.call(this),ReplayContainer.prototype.__init5.call(this),ReplayContainer.prototype.__init6.call(this),this.eventBuffer=null,this.performanceEntries=[],this.replayPerformanceEntries=[],this.recordingMode="session",this.timeouts={sessionIdlePause:3e5,sessionIdleExpire:9e5},this._lastActivity=Date.now(),this._isEnabled=!1,this._isPaused=!1,this._hasInitializedCoreListeners=!1,this._context={errorIds:new Set,traceIds:new Set,urls:[],initialTimestamp:Date.now(),initialUrl:""},this._recordingOptions=c,this._options=l,this._debouncedFlush=function(l,c,d){let h,p,f;const m=d&&d.maxWait?Math.max(d.maxWait,c):0;function invokeFunc(){return cancelTimers(),h=l(),h}function cancelTimers(){void 0!==p&&clearTimeout(p),void 0!==f&&clearTimeout(f),p=f=void 0}function debounced(){return p&&clearTimeout(p),p=setTimeout(invokeFunc,c),m&&void 0===f&&(f=setTimeout(invokeFunc,m)),h}return debounced.cancel=cancelTimers,debounced.flush=function(){return void 0!==p||void 0!==f?invokeFunc():h},debounced}((()=>this._flush()),this._options.flushMinDelay,{maxWait:this._options.flushMaxDelay}),this._throttledAddEvent=throttle(((l,c)=>function(l,c,d){return shouldAddEvent(l,c)?_addEvent(l,c,d):Promise.resolve(null)}(this,l,c)),300,5);const{slowClickTimeout:d,slowClickIgnoreSelectors:h}=this.getOptions(),p=d?{threshold:Math.min(3e3,d),timeout:d,scrollTimeout:300,ignoreSelector:h?h.join(","):""}:void 0;p&&(this.clickDetector=new ClickDetector(this,p))}getContext(){return this._context}isEnabled(){return this._isEnabled}isPaused(){return this._isPaused}isRecordingCanvas(){return Boolean(this._canvas)}getOptions(){return this._options}initializeSampling(l){const{errorSampleRate:c,sessionSampleRate:d}=this._options;c<=0&&d<=0||(this._initializeSessionForSampling(l),this.session?!1!==this.session.sampled&&(this.recordingMode="buffer"===this.session.sampled&&0===this.session.segmentId?"buffer":"session",logInfoNextTick(`[Replay] Starting replay in ${this.recordingMode} mode`,this._options._experiments.traceInternals),this._initializeRecording()):this._handleException(new Error("Unable to initialize and create session")))}start(){if(this._isEnabled&&"session"===this.recordingMode)throw new Error("Replay recording is already in progress");if(this._isEnabled&&"buffer"===this.recordingMode)throw new Error("Replay buffering is in progress, call `flush()` to save the replay");logInfoNextTick("[Replay] Starting replay in session mode",this._options._experiments.traceInternals),this._updateUserActivity();const l=loadOrCreateSession({maxReplayDuration:this._options.maxReplayDuration,sessionIdleExpire:this.timeouts.sessionIdleExpire,traceInternals:this._options._experiments.traceInternals},{stickySession:this._options.stickySession,sessionSampleRate:1,allowBuffering:!1});this.session=l,this._initializeRecording()}startBuffering(){if(this._isEnabled)throw new Error("Replay recording is already in progress");logInfoNextTick("[Replay] Starting replay in buffer mode",this._options._experiments.traceInternals);const l=loadOrCreateSession({sessionIdleExpire:this.timeouts.sessionIdleExpire,maxReplayDuration:this._options.maxReplayDuration,traceInternals:this._options._experiments.traceInternals},{stickySession:this._options.stickySession,sessionSampleRate:0,allowBuffering:!0});this.session=l,this.recordingMode="buffer",this._initializeRecording()}startRecording(){try{const l=this._canvas;this._stopRecording=record({...this._recordingOptions,..."buffer"===this.recordingMode&&{checkoutEveryNms:6e4},emit:getHandleRecordingEmit(this),onMutation:this._onMutationHandler,...l?{recordCanvas:l.recordCanvas,getCanvasManager:l.getCanvasManager,sampling:l.sampling,dataURLOptions:l.dataURLOptions}:{}})}catch(l){this._handleException(l)}}stopRecording(){try{return this._stopRecording&&(this._stopRecording(),this._stopRecording=void 0),!0}catch(l){return this._handleException(l),!1}}async stop({forceFlush:l=!1,reason:c}={}){if(this._isEnabled){this._isEnabled=!1;try{logInfo("[Replay] Stopping Replay"+(c?` triggered by ${c}`:""),this._options._experiments.traceInternals),this._removeListeners(),this.stopRecording(),this._debouncedFlush.cancel(),l&&await this._flush({force:!0}),this.eventBuffer&&this.eventBuffer.destroy(),this.eventBuffer=null,clearSession(this)}catch(d){this._handleException(d)}}}pause(){this._isPaused||(this._isPaused=!0,this.stopRecording(),logInfo("[Replay] Pausing replay",this._options._experiments.traceInternals))}resume(){this._isPaused&&this._checkSession()&&(this._isPaused=!1,this.startRecording(),logInfo("[Replay] Resuming replay",this._options._experiments.traceInternals))}async sendBufferedReplayOrFlush({continueRecording:l=!0}={}){if("session"===this.recordingMode)return this.flushImmediate();const c=Date.now();logInfo("[Replay] Converting buffer to session",this._options._experiments.traceInternals),await this.flushImmediate();const d=this.stopRecording();l&&d&&"session"!==this.recordingMode&&(this.recordingMode="session",this.session&&(this._updateUserActivity(c),this._updateSessionActivity(c),this._maybeSaveSession()),this.startRecording())}addUpdate(l){const c=l();"buffer"!==this.recordingMode&&!0!==c&&this._debouncedFlush()}triggerUserActivity(){if(this._updateUserActivity(),this._stopRecording)this.checkAndHandleExpiredSession(),this._updateSessionActivity();else{if(!this._checkSession())return;this.resume()}}updateUserActivity(){this._updateUserActivity(),this._updateSessionActivity()}conditionalFlush(){return"buffer"===this.recordingMode?Promise.resolve():this.flushImmediate()}flush(){return this._debouncedFlush()}flushImmediate(){return this._debouncedFlush(),this._debouncedFlush.flush()}cancelFlush(){this._debouncedFlush.cancel()}getSessionId(){return this.session&&this.session.id}checkAndHandleExpiredSession(){if(!(this._lastActivity&&isExpired(this._lastActivity,this.timeouts.sessionIdlePause)&&this.session&&"session"===this.session.sampled))return!!this._checkSession();this.pause()}setInitialState(){const l=`${MS.location.pathname}${MS.location.hash}${MS.location.search}`,c=`${MS.location.origin}${l}`;this.performanceEntries=[],this.replayPerformanceEntries=[],this._clearContext(),this._context.initialUrl=c,this._context.initialTimestamp=Date.now(),this._context.urls.push(c)}throttledAddEvent(l,c){const d=this._throttledAddEvent(l,c);if(d===bx){const l=createBreadcrumb({category:"replay.throttled"});this.addUpdate((()=>!addEventSync(this,{type:5,timestamp:l.timestamp||0,data:{tag:"breadcrumb",payload:l,metric:!0}})))}return d}getCurrentRoute(){const l=this.lastTransaction||getCurrentScope$1().getTransaction(),c=(l&&spanToJSON(l).data||{})[Ew];if(l&&c&&["route","custom"].includes(c))return spanToJSON(l).description}_initializeRecording(){this.setInitialState(),this._updateSessionActivity(),this.eventBuffer=createEventBuffer({useCompression:this._options.useCompression,workerUrl:this._options.workerUrl}),this._removeListeners(),this._addListeners(),this._isEnabled=!0,this._isPaused=!1,this.startRecording()}_handleException(l){yx&&Bb.error("[Replay]",l),yx&&this._options._experiments&&this._options._experiments.captureExceptions&&captureException(l)}_initializeSessionForSampling(l){const c=this._options.errorSampleRate>0,d=loadOrCreateSession({sessionIdleExpire:this.timeouts.sessionIdleExpire,maxReplayDuration:this._options.maxReplayDuration,traceInternals:this._options._experiments.traceInternals,previousSessionId:l},{stickySession:this._options.stickySession,sessionSampleRate:this._options.sessionSampleRate,allowBuffering:c});this.session=d}_checkSession(){if(!this.session)return!1;const l=this.session;return!shouldRefreshSession(l,{sessionIdleExpire:this.timeouts.sessionIdleExpire,maxReplayDuration:this._options.maxReplayDuration})||(this._refreshSession(l),!1)}async _refreshSession(l){this._isEnabled&&(await this.stop({reason:"refresh session"}),this.initializeSampling(l.id))}_addListeners(){try{MS.document.addEventListener("visibilitychange",this._handleVisibilityChange),MS.addEventListener("blur",this._handleWindowBlur),MS.addEventListener("focus",this._handleWindowFocus),MS.addEventListener("keydown",this._handleKeyboardEvent),this.clickDetector&&this.clickDetector.addListeners(),this._hasInitializedCoreListeners||(addGlobalListeners(this),this._hasInitializedCoreListeners=!0)}catch(l){this._handleException(l)}this._performanceCleanupCallback=setupPerformanceObserver(this)}_removeListeners(){try{MS.document.removeEventListener("visibilitychange",this._handleVisibilityChange),MS.removeEventListener("blur",this._handleWindowBlur),MS.removeEventListener("focus",this._handleWindowFocus),MS.removeEventListener("keydown",this._handleKeyboardEvent),this.clickDetector&&this.clickDetector.removeListeners(),this._performanceCleanupCallback&&this._performanceCleanupCallback()}catch(l){this._handleException(l)}}__init(){this._handleVisibilityChange=()=>{"visible"===MS.document.visibilityState?this._doChangeToForegroundTasks():this._doChangeToBackgroundTasks()}}__init2(){this._handleWindowBlur=()=>{const l=createBreadcrumb({category:"ui.blur"});this._doChangeToBackgroundTasks(l)}}__init3(){this._handleWindowFocus=()=>{const l=createBreadcrumb({category:"ui.focus"});this._doChangeToForegroundTasks(l)}}__init4(){this._handleKeyboardEvent=l=>{handleKeyboardEvent(this,l)}}_doChangeToBackgroundTasks(l){if(!this.session)return;isSessionExpired(this.session,{maxReplayDuration:this._options.maxReplayDuration,sessionIdleExpire:this.timeouts.sessionIdleExpire})||(l&&this._createCustomBreadcrumb(l),this.conditionalFlush())}_doChangeToForegroundTasks(l){if(!this.session)return;this.checkAndHandleExpiredSession()?l&&this._createCustomBreadcrumb(l):logInfo("[Replay] Document has become active, but session has expired")}_updateUserActivity(l=Date.now()){this._lastActivity=l}_updateSessionActivity(l=Date.now()){this.session&&(this.session.lastActivity=l,this._maybeSaveSession())}_createCustomBreadcrumb(l){this.addUpdate((()=>{this.throttledAddEvent({type:rx.Custom,timestamp:l.timestamp||0,data:{tag:"breadcrumb",payload:l}})}))}_addPerformanceEntries(){const l=(c=this.performanceEntries,c.map(createPerformanceEntry).filter(Boolean)).concat(this.replayPerformanceEntries);var c;return this.performanceEntries=[],this.replayPerformanceEntries=[],Promise.all(createPerformanceSpans(this,l))}_clearContext(){this._context.errorIds.clear(),this._context.traceIds.clear(),this._context.urls=[]}_updateInitialTimestampFromEventBuffer(){const{session:l,eventBuffer:c}=this;if(!l||!c)return;if(l.segmentId)return;const d=c.getEarliestTimestamp();d&&d<this._context.initialTimestamp&&(this._context.initialTimestamp=d)}_popEventContext(){const l={initialTimestamp:this._context.initialTimestamp,initialUrl:this._context.initialUrl,errorIds:Array.from(this._context.errorIds),traceIds:Array.from(this._context.traceIds),urls:this._context.urls};return this._clearContext(),l}async _runFlush(){const l=this.getSessionId();if(this.session&&this.eventBuffer&&l){if(await this._addPerformanceEntries(),this.eventBuffer&&this.eventBuffer.hasEvents&&(await async function(l){try{return Promise.all(createPerformanceSpans(l,[createMemoryEntry(MS.performance.memory)]))}catch(c){return[]}}(this),this.eventBuffer&&l===this.getSessionId()))try{this._updateInitialTimestampFromEventBuffer();const c=Date.now();if(c-this._context.initialTimestamp>this._options.maxReplayDuration+3e4)throw new Error("Session is too long, not sending replay");const d=this._popEventContext(),h=this.session.segmentId++;this._maybeSaveSession();const p=await this.eventBuffer.finish();await sendReplay({replayId:l,recordingData:p,segmentId:h,eventContext:d,session:this.session,options:this.getOptions(),timestamp:c})}catch(c){this._handleException(c),this.stop({reason:"sendReplay"});const l=getClient();l&&l.recordDroppedEvent("send_error","replay")}}else yx&&Bb.error("[Replay] No session or eventBuffer found to flush.")}__init5(){this._flush=async({force:l=!1}={})=>{if(!this._isEnabled&&!l)return;if(!this.checkAndHandleExpiredSession())return void(yx&&Bb.error("[Replay] Attempting to finish replay event after session expired."));if(!this.session)return;const c=this.session.started,d=Date.now()-c;this._debouncedFlush.cancel();const h=d<this._options.minReplayDuration,p=d>this._options.maxReplayDuration+5e3;if(h||p)return logInfo(`[Replay] Session duration (${Math.floor(d/1e3)}s) is too ${h?"short":"long"}, not sending replay.`,this._options._experiments.traceInternals),void(h&&this._debouncedFlush());const f=this.eventBuffer;if(f&&0===this.session.segmentId&&!f.hasCheckout&&logInfo("[Replay] Flushing initial segment without checkout.",this._options._experiments.traceInternals),!this._flushLock)return this._flushLock=this._runFlush(),await this._flushLock,void(this._flushLock=void 0);try{await this._flushLock}catch(m){yx&&Bb.error(m)}finally{this._debouncedFlush()}}}_maybeSaveSession(){this.session&&this._options.stickySession&&saveSession(this.session)}__init6(){this._onMutationHandler=l=>{const c=l.length,d=this._options.mutationLimit,h=d&&c>d;if(c>this._options.mutationBreadcrumbLimit||h){const l=createBreadcrumb({category:"replay.mutations",data:{count:c,limit:h}});this._createCustomBreadcrumb(l)}return!h||(this.stop({reason:"mutationLimit",forceFlush:"session"===this.recordingMode}),!1)}}}function getOption(l,c,d,h){const p=[...l,..."string"==typeof h?h.split(","):[],...c];return void 0!==d&&("string"==typeof d&&p.push(`.${d}`),consoleSandbox((()=>{console.warn("[Replay] You are using a deprecated configuration item for privacy. Read the documentation on how to use the new privacy configuration.")}))),p.join(",")}const wx='img,image,svg,video,object,picture,embed,map,audio,link[rel="icon"],link[rel="apple-touch-icon"]',Sx=["content-length","content-type","accept"];let xx=!1;class Replay$1{static __initStatic(){this.id="Replay"}constructor({flushMinDelay:l=5e3,flushMaxDelay:c=5500,minReplayDuration:d=4999,maxReplayDuration:h=36e5,stickySession:p=!0,useCompression:f=!0,workerUrl:m,_experiments:y={},sessionSampleRate:_,errorSampleRate:b,maskAllText:w=!0,maskAllInputs:E=!0,blockAllMedia:M=!0,mutationBreadcrumbLimit:N=750,mutationLimit:P=1e4,slowClickTimeout:L=7e3,slowClickIgnoreSelectors:j=[],networkDetailAllowUrls:D=[],networkDetailDenyUrls:F=[],networkCaptureBodies:U=!0,networkRequestHeaders:B=[],networkResponseHeaders:H=[],mask:z=[],maskAttributes:q=["title","placeholder"],unmask:V=[],block:Z=[],unblock:K=[],ignore:Y=[],maskFn:ee,beforeAddRecordingEvent:ne,beforeErrorSampling:se,blockClass:ie,blockSelector:oe,maskInputOptions:le,maskTextClass:ce,maskTextSelector:pe,ignoreClass:fe}={}){this.name=Replay$1.id;const ge=function({mask:l,unmask:c,block:d,unblock:h,ignore:p,blockClass:f,blockSelector:m,maskTextClass:y,maskTextSelector:_,ignoreClass:b}){const w={maskTextSelector:getOption(l,[".sentry-mask","[data-sentry-mask]"],y,_),unmaskTextSelector:getOption(c,[".sentry-unmask","[data-sentry-unmask]"]),blockSelector:getOption(d,[".sentry-block","[data-sentry-block]",'base[href="/"]'],f,m),unblockSelector:getOption(h,[".sentry-unblock","[data-sentry-unblock]"]),ignoreSelector:getOption(p,[".sentry-ignore","[data-sentry-ignore]",'input[type="file"]'],b)};return f instanceof RegExp&&(w.blockClass=f),y instanceof RegExp&&(w.maskTextClass=y),w}({mask:z,unmask:V,block:Z,unblock:K,ignore:Y,blockClass:ie,blockSelector:oe,maskTextClass:ce,maskTextSelector:pe,ignoreClass:fe});if(this._recordingOptions={maskAllInputs:E,maskAllText:w,maskInputOptions:{...le||{},password:!0},maskTextFn:ee,maskInputFn:ee,maskAttributeFn:(l,c,d)=>function({el:l,key:c,maskAttributes:d,maskAllText:h,privacyOptions:p,value:f}){return h?p.unmaskTextSelector&&l.matches(p.unmaskTextSelector)?f:d.includes(c)||"value"===c&&"INPUT"===l.tagName&&["submit","button"].includes(l.getAttribute("type")||"")?f.replace(/[\S]/g,"*"):f:f}({maskAttributes:q,maskAllText:w,privacyOptions:ge,key:l,value:c,el:d}),...ge,slimDOMOptions:"all",inlineStylesheet:!0,inlineImages:!1,collectFonts:!0,errorHandler:l=>{try{l.__rrweb__=!0}catch(c){}}},this._initialOptions={flushMinDelay:l,flushMaxDelay:c,minReplayDuration:Math.min(d,15e3),maxReplayDuration:Math.min(h,FS),stickySession:p,sessionSampleRate:_,errorSampleRate:b,useCompression:f,workerUrl:m,blockAllMedia:M,maskAllInputs:E,maskAllText:w,mutationBreadcrumbLimit:N,mutationLimit:P,slowClickTimeout:L,slowClickIgnoreSelectors:j,networkDetailAllowUrls:D,networkDetailDenyUrls:F,networkCaptureBodies:U,networkRequestHeaders:_getMergedNetworkHeaders(B),networkResponseHeaders:_getMergedNetworkHeaders(H),beforeAddRecordingEvent:ne,beforeErrorSampling:se,_experiments:y},"number"==typeof _&&(console.warn(`[Replay] You are passing \`sessionSampleRate\` to the Replay integration.\nThis option is deprecated and will be removed soon.\nInstead, configure \`replaysSessionSampleRate\` directly in the SDK init options, e.g.:\nSentry.init({ replaysSessionSampleRate: ${_} })`),this._initialOptions.sessionSampleRate=_),"number"==typeof b&&(console.warn(`[Replay] You are passing \`errorSampleRate\` to the Replay integration.\nThis option is deprecated and will be removed soon.\nInstead, configure \`replaysOnErrorSampleRate\` directly in the SDK init options, e.g.:\nSentry.init({ replaysOnErrorSampleRate: ${b} })`),this._initialOptions.errorSampleRate=b),this._initialOptions.blockAllMedia&&(this._recordingOptions.blockSelector=this._recordingOptions.blockSelector?`${this._recordingOptions.blockSelector},${wx}`:wx),this._isInitialized&&isBrowser$1())throw new Error("Multiple Sentry Session Replay instances are not supported");this._isInitialized=!0}get _isInitialized(){return xx}set _isInitialized(l){xx=l}setupOnce(){isBrowser$1()&&(this._setup(),setTimeout((()=>this._initialize())))}start(){this._replay&&this._replay.start()}startBuffering(){this._replay&&this._replay.startBuffering()}stop(){return this._replay?this._replay.stop({forceFlush:"session"===this._replay.recordingMode}):Promise.resolve()}flush(l){return this._replay&&this._replay.isEnabled()?this._replay.sendBufferedReplayOrFlush(l):Promise.resolve()}getReplayId(){if(this._replay&&this._replay.isEnabled())return this._replay.getSessionId()}_initialize(){this._replay&&(this._maybeLoadFromReplayCanvasIntegration(),this._replay.initializeSampling())}_setup(){const l=function(l){const c=getClient(),d=c&&c.getOptions(),h={sessionSampleRate:0,errorSampleRate:0,...dropUndefinedKeys(l)};if(!d)return consoleSandbox((()=>{console.warn("SDK client is not available.")})),h;null==l.sessionSampleRate&&null==l.errorSampleRate&&null==d.replaysSessionSampleRate&&null==d.replaysOnErrorSampleRate&&consoleSandbox((()=>{console.warn("Replay is disabled because neither `replaysSessionSampleRate` nor `replaysOnErrorSampleRate` are set.")}));"number"==typeof d.replaysSessionSampleRate&&(h.sessionSampleRate=d.replaysSessionSampleRate);"number"==typeof d.replaysOnErrorSampleRate&&(h.errorSampleRate=d.replaysOnErrorSampleRate);return h}(this._initialOptions);this._replay=new ReplayContainer({options:l,recordingOptions:this._recordingOptions})}_maybeLoadFromReplayCanvasIntegration(){try{const l=getClient().getIntegrationByName("ReplayCanvas");if(!l)return;this._replay._canvas=l.getOptions()}catch(hh){}}}function _getMergedNetworkHeaders(l){return[...Sx,...l.map((l=>l.toLowerCase()))]}Replay$1.__initStatic();let kx=!1;function captureToolCallMetrics(l,c,d,h,p=0,f){withScope((m=>{m.setTag("toolCallId",l),m.setTag("toolCallType",c),m.setTag("toolCallSuccess",d.toString()),m.setTag("extensionId",er?.runtime?.id||"unknown"),m.setContext("toolCallMetrics",{toolCallId:l,toolCallType:c,success:d,executionTime:h,retryCount:p,errorMessage:f,timestamp:Date.now()});const y=d?"info":"error";m.setLevel(y),captureMessage(`Tool Call: ${c} ${d?"succeeded":"failed"}`,y)}))}const Cx=class _TelemetryManager{constructor(l={}){__publicField(this,"events",[]),__publicField(this,"metrics"),__publicField(this,"config"),__publicField(this,"flushTimer"),__publicField(this,"eventListeners",new Map),__publicField(this,"startTime",Date.now()),this.config={enabled:!0,level:"info",maxEvents:1e4,flushInterval:3e4,enablePerformanceMonitoring:!0,enableErrorTracking:!0,enableApiMonitoring:!0,enableResourceMonitoring:!0,bufferSize:100,...l},this.metrics={apiResponseTimes:new Map,componentRenderTimes:new Map,errorRates:new Map,throughput:new Map,memoryUsage:[],activeConnections:0,toolCallMetrics:{totalExecuted:0,totalFailed:0,averageExecutionTime:0,retryRate:0}},this.initializeMonitoring()}static getInstance(l){return _TelemetryManager.instance||(_TelemetryManager.instance=new _TelemetryManager(l)),_TelemetryManager.instance}initializeMonitoring(){this.config.enabled&&(this.flushTimer=setInterval((()=>{this.collectResourceMetrics(),this.flushEvents()}),this.config.flushInterval),this.config.enableErrorTracking&&(window.addEventListener("error",(l=>{this.trackError("window_error",new Error(l.message),{filename:l.filename,lineno:l.lineno,colno:l.colno})})),window.addEventListener("unhandledrejection",(l=>{this.trackError("unhandled_rejection",new Error(l.reason),{promise:l.promise})}))),this.config.enablePerformanceMonitoring&&this.startPerformanceMonitoring())}startPerformanceMonitoring(){"memory"in performance&&setInterval((()=>{const l=performance.memory;this.metrics.memoryUsage.push(l.usedJSHeapSize),this.metrics.memoryUsage.length>100&&this.metrics.memoryUsage.shift()}),5e3)}generateEventId(){return`${Date.now()}-${Math.random().toString(36).substr(2,9)}`}shouldLog(l){const c=["debug","info","warn","error"],d=c.indexOf(this.config.level);return c.indexOf(l)>=d}track(l,c,d={},h="info"){if(!this.config.enabled||!this.shouldLog(h))return;const p={id:this.generateEventId(),timestamp:Date.now(),type:l,category:this.categorizeEvent(l),level:h,message:c,context:{...d,sessionId:getSessionIdSync(),extensionId:er?.runtime?.id,userAgent:navigator.userAgent,url:window.location.href}};this.addEvent(p),this.notifyListeners(l,p)}trackApiCall(l,c,d,h,p,f={}){const m=h-d;this.track("api_call",`API ${c} ${l}`,{...f,api:{endpoint:l,method:c,status:p,responseTime:m,size:f.responseSize,retryCount:f.retryCount||0}},p>=400?"error":"info"),this.metrics.apiResponseTimes.has(l)||this.metrics.apiResponseTimes.set(l,[]);const y=this.metrics.apiResponseTimes.get(l);y.push(m),y.length>100&&y.shift();const _=`${c}_${l}`;if(p>=400){const l=this.metrics.errorRates.get(_)||0;this.metrics.errorRates.set(_,l+1)}}trackToolCallExecution(l,c,d,h,p,f={}){const m=h-d;this.track("tool_call_execution",`Tool call ${c} ${p?"succeeded":"failed"}`,{...f,toolCallId:l,toolCallType:c,duration:m,success:p},p?"info":"error"),this.metrics.toolCallMetrics.totalExecuted++,p||this.metrics.toolCallMetrics.totalFailed++;const y=this.metrics.toolCallMetrics.totalExecuted,_=this.metrics.toolCallMetrics.averageExecutionTime;this.metrics.toolCallMetrics.averageExecutionTime=(_*(y-1)+m)/y}trackComponentLifecycle(l,c,d,h={}){if(this.track(`component_${c}`,`Component ${l} ${c}`,{...h,componentName:l,duration:d}),"render"===c&&d){this.metrics.componentRenderTimes.has(l)||this.metrics.componentRenderTimes.set(l,[]);const c=this.metrics.componentRenderTimes.get(l);c.push(d),c.length>50&&c.shift()}}trackError(l,c,d={}){const h={id:this.generateEventId(),timestamp:Date.now(),type:"error",category:"error",level:"error",message:`Error in ${l}: ${c.message}`,context:{...d,source:l,sessionId:getSessionIdSync()},error:{name:c.name,message:c.message,stack:c.stack,code:c.code}};this.addEvent(h),this.notifyListeners("error",h),function(l,c){withScope((d=>{if(c&&d.setExtras(c),d.setTag("extensionId",er?.runtime?.id||"unknown"),d.setTag("errorSource",c?.source||"unknown"),d.setTag("sessionId",getSessionIdSync()),"memory"in performance){const l=performance.memory;d.setContext("performance",{usedJSHeapSize:l.usedJSHeapSize,totalJSHeapSize:l.totalJSHeapSize,timestamp:Date.now()})}d.setContext("navigation",{url:window.location.href,userAgent:navigator.userAgent,timestamp:Date.now()}),captureException(l)}))}(c,{source:l,...d,telemetryEventId:h.id})}trackUserAction(l,c={}){this.track("user_action",`User ${l}`,{...c,action:l,timestamp:Date.now()})}trackPerformance(l,c,d,h={}){const p=d-c;this.track("performance",`Performance: ${l}`,{...h,operation:l,performance:{startTime:c,endTime:d,duration:p,memory:this.getCurrentMemoryUsage()}})}categorizeEvent(l){return l.startsWith("api_")?"api":l.startsWith("component_")?"ui":l.startsWith("websocket_")?"websocket":l.startsWith("auth_")?"auth":l.startsWith("tool_call_")?"tool_calls":"performance"===l?"performance":"error"===l?"error":"user_action"===l?"user":"system"}addEvent(l){this.events.push(l),this.events.length>this.config.maxEvents&&(this.events=this.events.slice(-this.config.maxEvents))}notifyListeners(l,c){(this.eventListeners.get(l)||[]).forEach((l=>{try{l(c)}catch(d){console.error("Telemetry listener error:",d)}}))}getCurrentMemoryUsage(){return"memory"in performance?performance.memory.usedJSHeapSize:0}collectResourceMetrics(){if(!this.config.enableResourceMonitoring)return;const l={heap:this.getCurrentMemoryUsage(),domNodes:document.querySelectorAll("*").length,listeners:this.countEventListeners(),scriptDuration:Date.now()-this.startTime};this.track("performance","Resource metrics collected",{resources:l},"debug")}countEventListeners(){return Array.from(document.querySelectorAll("*")).reduce(((l,c)=>l+Object.getOwnPropertyNames(c).filter((l=>l.startsWith("on"))).filter((l=>null!==c[l])).length),0)}flushEvents(){0!==this.events.length&&this.config.exportEndpoint&&this.exportEvents()}async exportEvents(){if(this.config.exportEndpoint)try{const l=[...this.events];this.events=[],await fetch(this.config.exportEndpoint,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({events:l,metrics:this.getMetricsSummary(),metadata:{sessionId:getSessionIdSync(),extensionId:er?.runtime?.id,timestamp:Date.now()}})})}catch(l){console.error("Failed to export telemetry events:",l)}}addEventListener(l,c){this.eventListeners.has(l)||this.eventListeners.set(l,[]),this.eventListeners.get(l).push(c)}removeEventListener(l,c){const d=this.eventListeners.get(l);if(d){const l=d.indexOf(c);l>-1&&d.splice(l,1)}}getEvents(l){return l?this.events.filter((c=>(!l.type||c.type===l.type)&&((!l.category||c.category===l.category)&&((!l.level||c.level===l.level)&&(!(l.startTime&&c.timestamp<l.startTime)&&!(l.endTime&&c.timestamp>l.endTime)))))):[...this.events]}getMetrics(){return{...this.metrics}}getMetricsSummary(){const l=Date.now(),c=l-6e4,d=this.events.filter((l=>l.timestamp>c));return{totalEvents:this.events.length,recentEvents:d.length,errorRate:d.filter((l=>"error"===l.level)).length/Math.max(d.length,1),averageApiResponseTime:this.calculateAverageResponseTime(),toolCallMetrics:this.metrics.toolCallMetrics,memoryUsage:{current:this.getCurrentMemoryUsage(),average:this.metrics.memoryUsage.length>0?this.metrics.memoryUsage.reduce(((l,c)=>l+c),0)/this.metrics.memoryUsage.length:0},activeConnections:this.metrics.activeConnections,uptime:l-this.startTime}}calculateAverageResponseTime(){const l=[];return this.metrics.apiResponseTimes.forEach((c=>l.push(...c))),l.length>0?l.reduce(((l,c)=>l+c),0)/l.length:0}getHealthStatus(){const l=[],c=this.getMetricsSummary();c.errorRate>.1&&l.push(`High error rate: ${(100*c.errorRate).toFixed(1)}%`),c.averageApiResponseTime>5e3&&l.push(`Slow API responses: ${c.averageApiResponseTime.toFixed(0)}ms`);const d=c.memoryUsage.current/1048576;d>100&&l.push(`High memory usage: ${d.toFixed(1)}MB`);const h=c.toolCallMetrics.totalFailed/Math.max(c.toolCallMetrics.totalExecuted,1);h>.2&&l.push(`High tool call failure rate: ${(100*h).toFixed(1)}%`);return{status:0===l.length?"healthy":l.length<3?"degraded":"unhealthy",issues:l,metrics:c}}exportEventsAsJSON(){return JSON.stringify({events:this.events,metrics:this.getMetricsSummary(),healthStatus:this.getHealthStatus(),exportedAt:(new Date).toISOString()},null,2)}clearEvents(){this.events=[],this.metrics={apiResponseTimes:new Map,componentRenderTimes:new Map,errorRates:new Map,throughput:new Map,memoryUsage:[],activeConnections:0,toolCallMetrics:{totalExecuted:0,totalFailed:0,averageExecutionTime:0,retryRate:0}}}destroy(){this.flushTimer&&clearInterval(this.flushTimer),this.eventListeners.clear(),this.clearEvents()}};__publicField(Cx,"instance");const Ex=Cx.getInstance({enabled:!0,level:"info",enablePerformanceMonitoring:!0,enableErrorTracking:!0,enableApiMonitoring:!0,enableResourceMonitoring:!0}),Ix=Ex.trackApiCall.bind(Ex);Ex.trackError.bind(Ex),Ex.trackUserAction.bind(Ex),Ex.trackPerformance.bind(Ex),Ex.trackComponentLifecycle.bind(Ex);const Tx=Ex.trackToolCallExecution.bind(Ex),Rx=class _ApiInterceptor{constructor(){__publicField(this,"activeRequests",new Map),__publicField(this,"requestQueue",[]),__publicField(this,"isEnabled",!0),this.interceptFetch(),this.interceptXHR()}static getInstance(){return _ApiInterceptor.instance||(_ApiInterceptor.instance=new _ApiInterceptor),_ApiInterceptor.instance}interceptFetch(){const l=window.fetch;window.fetch=async(c,d)=>{if(!this.isEnabled)return l(c,d);const h="string"==typeof c?c:c.toString(),p=d?.method||"GET",f=this.generateOperationId(),m=performance.now(),y={operationId:f,sessionId:getSessionIdSync(),correlationId:this.generateCorrelationId()},_=this.calculateRequestSize(d),b={endpoint:this.sanitizeUrl(h),method:p,startTime:m,retryCount:0,requestSize:_,context:{...y,userAgent:navigator.userAgent,timestamp:(new Date).toISOString()}};this.activeRequests.set(f,b),addBreadcrumb({type:"http",category:"fetch",data:{url:this.sanitizeUrl(h),method:p,operationId:f},level:"info"});try{const h=await l(c,d),p=performance.now(),m=this.calculateResponseSize(h);return b.endTime=p,b.status=h.status,b.responseSize=m,Ix(b.endpoint,b.method,b.startTime,p,h.status,{...b.context,responseSize:m,requestSize:_,duration:p-b.startTime}),this.sendToSentry(b,h.ok),this.activeRequests.delete(f),h}catch(w){const l=performance.now();throw b.endTime=l,b.error=w,Ex.trackError("api_fetch_error",w,{...b.context,endpoint:b.endpoint,method:b.method,duration:l-b.startTime,operationId:f}),this.sendErrorToSentry(b,w),this.activeRequests.delete(f),w}}}interceptXHR(){const l=XMLHttpRequest.prototype.open,c=XMLHttpRequest.prototype.send;XMLHttpRequest.prototype.open=function(c,d,h,p,f){if(!_ApiInterceptor.instance.isEnabled)return l.call(this,c,d,h??!0,p,f);const m=_ApiInterceptor.instance.generateOperationId(),y="string"==typeof d?d:d.toString();return this.__apiInterceptor={operationId:m,method:c,url:y,startTime:performance.now()},l.call(this,c,d,h??!0,p,f)},XMLHttpRequest.prototype.send=function(l){if(!_ApiInterceptor.instance.isEnabled||!this.__apiInterceptor)return c.call(this,l);const d=this.__apiInterceptor,h=_ApiInterceptor.instance.calculateXHRRequestSize(l),p={operationId:d.operationId,sessionId:getSessionIdSync(),correlationId:_ApiInterceptor.instance.generateCorrelationId()},f={endpoint:_ApiInterceptor.instance.sanitizeUrl(d.url),method:d.method,startTime:d.startTime,retryCount:0,requestSize:h,context:{...p,userAgent:navigator.userAgent,timestamp:(new Date).toISOString()}};return _ApiInterceptor.instance.activeRequests.set(d.operationId,f),addBreadcrumb({type:"http",category:"xhr",data:{url:f.endpoint,method:d.method,operationId:d.operationId},level:"info"}),this.addEventListener("loadend",(()=>{const l=performance.now();f.endTime=l,f.status=this.status,f.responseSize=this.responseText?.length||0,Ix(f.endpoint,f.method,f.startTime,l,this.status,{...f.context,responseSize:f.responseSize,requestSize:h,duration:l-f.startTime}),_ApiInterceptor.instance.sendToSentry(f,this.status<400),_ApiInterceptor.instance.activeRequests.delete(d.operationId)})),this.addEventListener("error",(()=>{const l=performance.now(),c=new Error(`XHR request failed: ${d.method} ${d.url}`);f.endTime=l,f.error=c,Ex.trackError("api_xhr_error",c,{...f.context,endpoint:f.endpoint,method:f.method,duration:l-f.startTime}),_ApiInterceptor.instance.sendErrorToSentry(f,c),_ApiInterceptor.instance.activeRequests.delete(d.operationId)})),c.call(this,l)}}sendToSentry(l,c){const d=(l.endTime||0)-l.startTime,h=(p={name:`${l.method} ${l.endpoint}`,op:"http.client",data:{...l.context,endpoint:l.endpoint,method:l.method,status:l.status,duration:d,requestSize:l.requestSize,responseSize:l.responseSize,success:c}},getCurrentHub().startTransaction({...p},f));var p,f;h.setStatus(c?"ok":"internal_error"),h.finish(),addBreadcrumb({type:"http",category:"api_call",data:{endpoint:l.endpoint,method:l.method,status:l.status,duration:d,operationId:l.context.operationId,success:c},level:c?"info":"error"}),captureMessage(`API Call: ${l.method} ${l.endpoint}`,{level:c?"info":"warning",tags:{api_endpoint:l.endpoint,api_method:l.method,api_status:l.status?.toString(),success:c.toString()},extra:{metrics:{duration:d,requestSize:l.requestSize,responseSize:l.responseSize,retryCount:l.retryCount},context:l.context}})}sendErrorToSentry(l,c){const d=(l.endTime||0)-l.startTime;withScope((h=>{h.setTag("error_type","api_error"),h.setTag("api_endpoint",l.endpoint),h.setTag("api_method",l.method),h.setTag("operation_id",l.context.operationId),h.setContext("api_call",{endpoint:l.endpoint,method:l.method,duration:d,requestSize:l.requestSize,retryCount:l.retryCount,startTime:l.startTime,endTime:l.endTime}),h.setContext("request_context",l.context),h.setLevel("error"),captureException(c)}))}generateOperationId(){return`op_${Date.now()}_${Math.random().toString(36).substr(2,9)}`}generateCorrelationId(){return`corr_${Date.now()}_${Math.random().toString(36).substr(2,9)}`}sanitizeUrl(l){try{const c=new URL(l);return["token","key","password","auth","secret"].forEach((l=>{c.searchParams.has(l)&&c.searchParams.set(l,"[REDACTED]")})),c.toString()}catch{return l}}calculateRequestSize(l){if(!l?.body)return 0;if("string"==typeof l.body)return new Blob([l.body]).size;if(l.body instanceof FormData){let c=0;for(const[d,h]of l.body.entries())c+=d.length,"string"==typeof h?c+=h.length:h instanceof File&&(c+=h.size);return c}return l.body instanceof Blob?l.body.size:0}calculateXHRRequestSize(l){if(!l)return 0;if("string"==typeof l)return new Blob([l]).size;if(l instanceof Document)return(new XMLSerializer).serializeToString(l).length;if(l instanceof FormData){let c=0;for(const[d,h]of l.entries())c+=d.length,"string"==typeof h?c+=h.length:h instanceof File&&(c+=h.size);return c}return l instanceof Blob?l.size:l instanceof ArrayBuffer?l.byteLength:0}calculateResponseSize(l){const c=l.headers.get("content-length");return c?parseInt(c,10):0}getActiveRequests(){return new Map(this.activeRequests)}getMetricsSummary(){const l=this.requestQueue.length,c=this.requestQueue.filter((l=>l.error||l.status&&l.status>=400)).length,d=this.requestQueue.filter((l=>l.endTime)).length,h=d>0?this.requestQueue.filter((l=>l.endTime)).reduce(((l,c)=>l+((c.endTime||0)-c.startTime)),0)/d:0;return{activeRequests:this.activeRequests.size,totalRequests:l,averageResponseTime:h,errorRate:l>0?c/l:0}}setEnabled(l){this.isEnabled=l}clearMetrics(){this.requestQueue=[],this.activeRequests.clear()}exportMetrics(){return JSON.stringify({activeRequests:Array.from(this.activeRequests.entries()),requestQueue:this.requestQueue,summary:this.getMetricsSummary(),exportedAt:(new Date).toISOString()},null,2)}};function initializeTelemetry(l){try{c={serviceName:"confirmit-extension",environment:"production",console:!1},ah.initialize(c);const d=window.location.protocol,h="chrome-extension:"===d,p=!l?.skipPostHog;p&&(console.log("[Telemetry] Initializing PostHog"),(l=>{Pb.initialize(l)})({apiKey:"phc_9EXhTA8aIYO7hvqRzboyf5IqPUhi26NrFy93lzPbfFV",apiHost:"https://us.i.posthog.com",persistence:h?"localStorage":"memory",capture_pageview:!0,autocapture:!0,disable_session_recording:!1,debug:!1}),Ex.addEventListener("user_action",(l=>{var c,d;c=l.message,d=l.context,Pb.track(c,d)}))),Ex.track("info","Telemetry systems initialized",{logfire:!0,posthog:p,telemetryManager:!0,apiInterceptor:!0,timestamp:(new Date).toISOString()}),console.log("[Telemetry] All systems initialized successfully")}catch(d){console.error("[Telemetry] Failed to initialize telemetry systems:",d);try{Ex.trackError("telemetry_init_error",d,{source:"telemetry_initialization"})}catch(h){console.error("[Telemetry] Failed to track initialization error:",h)}}var c}__publicField(Rx,"instance"),Rx.getInstance();const Ax=Gt.forwardRef((({className:l,...c},d)=>Kt.jsx("div",{ref:d,className:tr("rounded-lg border bg-card text-card-foreground shadow-sm",l),...c})));Ax.displayName="Card";const Ox=Gt.forwardRef((({className:l,...c},d)=>Kt.jsx("div",{ref:d,className:tr("flex flex-col space-y-1.5 p-6",l),...c})));Ox.displayName="CardHeader";const Mx=Gt.forwardRef((({className:l,...c},d)=>Kt.jsx("h3",{ref:d,className:tr("text-2xl font-semibold leading-none tracking-tight",l),...c})));Mx.displayName="CardTitle";const Nx=Gt.forwardRef((({className:l,...c},d)=>Kt.jsx("p",{ref:d,className:tr("text-sm text-muted-foreground",l),...c})));Nx.displayName="CardDescription";const Px=Gt.forwardRef((({className:l,...c},d)=>Kt.jsx("div",{ref:d,className:tr("p-6 pt-0",l),...c})));Px.displayName="CardContent";Gt.forwardRef((({className:l,...c},d)=>Kt.jsx("div",{ref:d,className:tr("flex items-center p-6 pt-0",l),...c}))).displayName="CardFooter";const Lx={},__vitePreload=function(l,c,d){let h=Promise.resolve();if(c&&c.length>0){document.getElementsByTagName("link");const l=document.querySelector("meta[property=csp-nonce]"),d=l?.nonce||l?.getAttribute("nonce");h=Promise.allSettled(c.map((l=>{if((l=function(l){return"/"+l}(l))in Lx)return;Lx[l]=!0;const c=l.endsWith(".css"),h=c?'[rel="stylesheet"]':"";if(document.querySelector(`link[href="${l}"]${h}`))return;const p=document.createElement("link");return p.rel=c?"stylesheet":"modulepreload",c||(p.as="script"),p.crossOrigin="",p.href=l,d&&p.setAttribute("nonce",d),document.head.appendChild(p),c?new Promise(((c,d)=>{p.addEventListener("load",c),p.addEventListener("error",(()=>d(new Error(`Unable to preload CSS for ${l}`))))})):void 0})))}function handlePreloadError(l){const c=new Event("vite:preloadError",{cancelable:!0});if(c.payload=l,window.dispatchEvent(c),!c.defaultPrevented)throw l}return h.then((c=>{for(const l of c||[])"rejected"===l.status&&handlePreloadError(l.reason);return l().catch(handlePreloadError)}))};class FunctionsError extends Error{constructor(l,c="FunctionsError",d){super(l),this.name=c,this.context=d}}class FunctionsFetchError extends FunctionsError{constructor(l){super("Failed to send a request to the Edge Function","FunctionsFetchError",l)}}class FunctionsRelayError extends FunctionsError{constructor(l){super("Relay Error invoking the Edge Function","FunctionsRelayError",l)}}class FunctionsHttpError extends FunctionsError{constructor(l){super("Edge Function returned a non-2xx status code","FunctionsHttpError",l)}}var jx,Dx;(Dx=jx||(jx={})).Any="any",Dx.ApNortheast1="ap-northeast-1",Dx.ApNortheast2="ap-northeast-2",Dx.ApSouth1="ap-south-1",Dx.ApSoutheast1="ap-southeast-1",Dx.ApSoutheast2="ap-southeast-2",Dx.CaCentral1="ca-central-1",Dx.EuCentral1="eu-central-1",Dx.EuWest1="eu-west-1",Dx.EuWest2="eu-west-2",Dx.EuWest3="eu-west-3",Dx.SaEast1="sa-east-1",Dx.UsEast1="us-east-1",Dx.UsWest1="us-west-1",Dx.UsWest2="us-west-2";var __awaiter$8=function(l,c,d,h){return new(d||(d=Promise))((function(p,f){function fulfilled(l){try{step(h.next(l))}catch(hh){f(hh)}}function rejected(l){try{step(h.throw(l))}catch(hh){f(hh)}}function step(l){var c;l.done?p(l.value):(c=l.value,c instanceof d?c:new d((function(l){l(c)}))).then(fulfilled,rejected)}step((h=h.apply(l,c||[])).next())}))};class FunctionsClient{constructor(l,{headers:c={},customFetch:d,region:h=jx.Any}={}){this.url=l,this.headers=c,this.region=h,this.fetch=(l=>{let c;return c=l||("undefined"==typeof fetch?(...l)=>__vitePreload((async()=>{const{default:l}=await Promise.resolve().then((()=>Jx));return{default:l}}),[]).then((({default:c})=>c(...l))):fetch),(...l)=>c(...l)})(d)}setAuth(l){this.headers.Authorization=`Bearer ${l}`}invoke(l,c={}){var d;return __awaiter$8(this,void 0,void 0,(function*(){try{const{headers:h,method:p,body:f}=c;let m,y={},{region:_}=c;_||(_=this.region),_&&"any"!==_&&(y["x-region"]=_),f&&(h&&!Object.prototype.hasOwnProperty.call(h,"Content-Type")||!h)&&("undefined"!=typeof Blob&&f instanceof Blob||f instanceof ArrayBuffer?(y["Content-Type"]="application/octet-stream",m=f):"string"==typeof f?(y["Content-Type"]="text/plain",m=f):"undefined"!=typeof FormData&&f instanceof FormData?m=f:(y["Content-Type"]="application/json",m=JSON.stringify(f)));const b=yield this.fetch(`${this.url}/${l}`,{method:p||"POST",headers:Object.assign(Object.assign(Object.assign({},y),this.headers),h),body:m}).catch((l=>{throw new FunctionsFetchError(l)})),w=b.headers.get("x-relay-error");if(w&&"true"===w)throw new FunctionsRelayError(b);if(!b.ok)throw new FunctionsHttpError(b);let E,M=(null!==(d=b.headers.get("Content-Type"))&&void 0!==d?d:"text/plain").split(";")[0].trim();return E="application/json"===M?yield b.json():"application/octet-stream"===M?yield b.blob():"text/event-stream"===M?b:"multipart/form-data"===M?yield b.formData():yield b.text(),{data:E,error:null}}catch(h){return{data:null,error:h}}}))}}var Fx={},$x={},Ux={},Bx={},Hx={},zx={},qx=function(){if("undefined"!=typeof self)return self;if("undefined"!=typeof window)return window;if("undefined"!=typeof global)return global;throw new Error("unable to locate global object")}();const Wx=qx.fetch,Vx=qx.fetch.bind(qx),Zx=qx.Headers,Gx=qx.Request,Kx=qx.Response,Jx=Object.freeze(Object.defineProperty({__proto__:null,Headers:Zx,Request:Gx,Response:Kx,default:Vx,fetch:Wx},Symbol.toStringTag,{value:"Module"})),Yx=rr(Jx);var Qx={};Object.defineProperty(Qx,"__esModule",{value:!0});let Xx=class extends Error{constructor(l){super(l.message),this.name="PostgrestError",this.details=l.details,this.hint=l.hint,this.code=l.code}};Qx.default=Xx;var ek=sr&&sr.__importDefault||function(l){return l&&l.__esModule?l:{default:l}};Object.defineProperty(zx,"__esModule",{value:!0});const tk=ek(Yx),rk=ek(Qx);zx.default=class{constructor(l){this.shouldThrowOnError=!1,this.method=l.method,this.url=l.url,this.headers=l.headers,this.schema=l.schema,this.body=l.body,this.shouldThrowOnError=l.shouldThrowOnError,this.signal=l.signal,this.isMaybeSingle=l.isMaybeSingle,l.fetch?this.fetch=l.fetch:"undefined"==typeof fetch?this.fetch=tk.default:this.fetch=fetch}throwOnError(){return this.shouldThrowOnError=!0,this}setHeader(l,c){return this.headers=Object.assign({},this.headers),this.headers[l]=c,this}then(l,c){void 0===this.schema||(["GET","HEAD"].includes(this.method)?this.headers["Accept-Profile"]=this.schema:this.headers["Content-Profile"]=this.schema),"GET"!==this.method&&"HEAD"!==this.method&&(this.headers["Content-Type"]="application/json");let d=(0,this.fetch)(this.url.toString(),{method:this.method,headers:this.headers,body:JSON.stringify(this.body),signal:this.signal}).then((async l=>{var c,d,h;let p=null,f=null,m=null,y=l.status,_=l.statusText;if(l.ok){if("HEAD"!==this.method){const c=await l.text();""===c||(f="text/csv"===this.headers.Accept||this.headers.Accept&&this.headers.Accept.includes("application/vnd.pgrst.plan+text")?c:JSON.parse(c))}const h=null===(c=this.headers.Prefer)||void 0===c?void 0:c.match(/count=(exact|planned|estimated)/),b=null===(d=l.headers.get("content-range"))||void 0===d?void 0:d.split("/");h&&b&&b.length>1&&(m=parseInt(b[1])),this.isMaybeSingle&&"GET"===this.method&&Array.isArray(f)&&(f.length>1?(p={code:"PGRST116",details:`Results contain ${f.length} rows, application/vnd.pgrst.object+json requires 1 row`,hint:null,message:"JSON object requested, multiple (or no) rows returned"},f=null,m=null,y=406,_="Not Acceptable"):f=1===f.length?f[0]:null)}else{const c=await l.text();try{p=JSON.parse(c),Array.isArray(p)&&404===l.status&&(f=[],p=null,y=200,_="OK")}catch(b){404===l.status&&""===c?(y=204,_="No Content"):p={message:c}}if(p&&this.isMaybeSingle&&(null===(h=null==p?void 0:p.details)||void 0===h?void 0:h.includes("0 rows"))&&(p=null,y=200,_="OK"),p&&this.shouldThrowOnError)throw new rk.default(p)}return{error:p,data:f,count:m,status:y,statusText:_}}));return this.shouldThrowOnError||(d=d.catch((l=>{var c,d,h;return{error:{message:`${null!==(c=null==l?void 0:l.name)&&void 0!==c?c:"FetchError"}: ${null==l?void 0:l.message}`,details:`${null!==(d=null==l?void 0:l.stack)&&void 0!==d?d:""}`,hint:"",code:`${null!==(h=null==l?void 0:l.code)&&void 0!==h?h:""}`},data:null,count:null,status:0,statusText:""}}))),d.then(l,c)}returns(){return this}overrideTypes(){return this}};var nk=sr&&sr.__importDefault||function(l){return l&&l.__esModule?l:{default:l}};Object.defineProperty(Hx,"__esModule",{value:!0});const sk=nk(zx);let ik=class extends sk.default{select(l){let c=!1;const d=(null!=l?l:"*").split("").map((l=>/\s/.test(l)&&!c?"":('"'===l&&(c=!c),l))).join("");return this.url.searchParams.set("select",d),this.headers.Prefer&&(this.headers.Prefer+=","),this.headers.Prefer+="return=representation",this}order(l,{ascending:c=!0,nullsFirst:d,foreignTable:h,referencedTable:p=h}={}){const f=p?`${p}.order`:"order",m=this.url.searchParams.get(f);return this.url.searchParams.set(f,`${m?`${m},`:""}${l}.${c?"asc":"desc"}${void 0===d?"":d?".nullsfirst":".nullslast"}`),this}limit(l,{foreignTable:c,referencedTable:d=c}={}){const h=void 0===d?"limit":`${d}.limit`;return this.url.searchParams.set(h,`${l}`),this}range(l,c,{foreignTable:d,referencedTable:h=d}={}){const p=void 0===h?"offset":`${h}.offset`,f=void 0===h?"limit":`${h}.limit`;return this.url.searchParams.set(p,`${l}`),this.url.searchParams.set(f,""+(c-l+1)),this}abortSignal(l){return this.signal=l,this}single(){return this.headers.Accept="application/vnd.pgrst.object+json",this}maybeSingle(){return"GET"===this.method?this.headers.Accept="application/json":this.headers.Accept="application/vnd.pgrst.object+json",this.isMaybeSingle=!0,this}csv(){return this.headers.Accept="text/csv",this}geojson(){return this.headers.Accept="application/geo+json",this}explain({analyze:l=!1,verbose:c=!1,settings:d=!1,buffers:h=!1,wal:p=!1,format:f="text"}={}){var m;const y=[l?"analyze":null,c?"verbose":null,d?"settings":null,h?"buffers":null,p?"wal":null].filter(Boolean).join("|"),_=null!==(m=this.headers.Accept)&&void 0!==m?m:"application/json";return this.headers.Accept=`application/vnd.pgrst.plan+${f}; for="${_}"; options=${y};`,this}rollback(){var l;return(null!==(l=this.headers.Prefer)&&void 0!==l?l:"").trim().length>0?this.headers.Prefer+=",tx=rollback":this.headers.Prefer="tx=rollback",this}returns(){return this}};Hx.default=ik;var ok=sr&&sr.__importDefault||function(l){return l&&l.__esModule?l:{default:l}};Object.defineProperty(Bx,"__esModule",{value:!0});const ak=ok(Hx);let lk=class extends ak.default{eq(l,c){return this.url.searchParams.append(l,`eq.${c}`),this}neq(l,c){return this.url.searchParams.append(l,`neq.${c}`),this}gt(l,c){return this.url.searchParams.append(l,`gt.${c}`),this}gte(l,c){return this.url.searchParams.append(l,`gte.${c}`),this}lt(l,c){return this.url.searchParams.append(l,`lt.${c}`),this}lte(l,c){return this.url.searchParams.append(l,`lte.${c}`),this}like(l,c){return this.url.searchParams.append(l,`like.${c}`),this}likeAllOf(l,c){return this.url.searchParams.append(l,`like(all).{${c.join(",")}}`),this}likeAnyOf(l,c){return this.url.searchParams.append(l,`like(any).{${c.join(",")}}`),this}ilike(l,c){return this.url.searchParams.append(l,`ilike.${c}`),this}ilikeAllOf(l,c){return this.url.searchParams.append(l,`ilike(all).{${c.join(",")}}`),this}ilikeAnyOf(l,c){return this.url.searchParams.append(l,`ilike(any).{${c.join(",")}}`),this}is(l,c){return this.url.searchParams.append(l,`is.${c}`),this}in(l,c){const d=Array.from(new Set(c)).map((l=>"string"==typeof l&&new RegExp("[,()]").test(l)?`"${l}"`:`${l}`)).join(",");return this.url.searchParams.append(l,`in.(${d})`),this}contains(l,c){return"string"==typeof c?this.url.searchParams.append(l,`cs.${c}`):Array.isArray(c)?this.url.searchParams.append(l,`cs.{${c.join(",")}}`):this.url.searchParams.append(l,`cs.${JSON.stringify(c)}`),this}containedBy(l,c){return"string"==typeof c?this.url.searchParams.append(l,`cd.${c}`):Array.isArray(c)?this.url.searchParams.append(l,`cd.{${c.join(",")}}`):this.url.searchParams.append(l,`cd.${JSON.stringify(c)}`),this}rangeGt(l,c){return this.url.searchParams.append(l,`sr.${c}`),this}rangeGte(l,c){return this.url.searchParams.append(l,`nxl.${c}`),this}rangeLt(l,c){return this.url.searchParams.append(l,`sl.${c}`),this}rangeLte(l,c){return this.url.searchParams.append(l,`nxr.${c}`),this}rangeAdjacent(l,c){return this.url.searchParams.append(l,`adj.${c}`),this}overlaps(l,c){return"string"==typeof c?this.url.searchParams.append(l,`ov.${c}`):this.url.searchParams.append(l,`ov.{${c.join(",")}}`),this}textSearch(l,c,{config:d,type:h}={}){let p="";"plain"===h?p="pl":"phrase"===h?p="ph":"websearch"===h&&(p="w");const f=void 0===d?"":`(${d})`;return this.url.searchParams.append(l,`${p}fts${f}.${c}`),this}match(l){return Object.entries(l).forEach((([l,c])=>{this.url.searchParams.append(l,`eq.${c}`)})),this}not(l,c,d){return this.url.searchParams.append(l,`not.${c}.${d}`),this}or(l,{foreignTable:c,referencedTable:d=c}={}){const h=d?`${d}.or`:"or";return this.url.searchParams.append(h,`(${l})`),this}filter(l,c,d){return this.url.searchParams.append(l,`${c}.${d}`),this}};Bx.default=lk;var ck=sr&&sr.__importDefault||function(l){return l&&l.__esModule?l:{default:l}};Object.defineProperty(Ux,"__esModule",{value:!0});const uk=ck(Bx);Ux.default=class{constructor(l,{headers:c={},schema:d,fetch:h}){this.url=l,this.headers=c,this.schema=d,this.fetch=h}select(l,{head:c=!1,count:d}={}){const h=c?"HEAD":"GET";let p=!1;const f=(null!=l?l:"*").split("").map((l=>/\s/.test(l)&&!p?"":('"'===l&&(p=!p),l))).join("");return this.url.searchParams.set("select",f),d&&(this.headers.Prefer=`count=${d}`),new uk.default({method:h,url:this.url,headers:this.headers,schema:this.schema,fetch:this.fetch,allowEmpty:!1})}insert(l,{count:c,defaultToNull:d=!0}={}){const h=[];if(this.headers.Prefer&&h.push(this.headers.Prefer),c&&h.push(`count=${c}`),d||h.push("missing=default"),this.headers.Prefer=h.join(","),Array.isArray(l)){const c=l.reduce(((l,c)=>l.concat(Object.keys(c))),[]);if(c.length>0){const l=[...new Set(c)].map((l=>`"${l}"`));this.url.searchParams.set("columns",l.join(","))}}return new uk.default({method:"POST",url:this.url,headers:this.headers,schema:this.schema,body:l,fetch:this.fetch,allowEmpty:!1})}upsert(l,{onConflict:c,ignoreDuplicates:d=!1,count:h,defaultToNull:p=!0}={}){const f=[`resolution=${d?"ignore":"merge"}-duplicates`];if(void 0!==c&&this.url.searchParams.set("on_conflict",c),this.headers.Prefer&&f.push(this.headers.Prefer),h&&f.push(`count=${h}`),p||f.push("missing=default"),this.headers.Prefer=f.join(","),Array.isArray(l)){const c=l.reduce(((l,c)=>l.concat(Object.keys(c))),[]);if(c.length>0){const l=[...new Set(c)].map((l=>`"${l}"`));this.url.searchParams.set("columns",l.join(","))}}return new uk.default({method:"POST",url:this.url,headers:this.headers,schema:this.schema,body:l,fetch:this.fetch,allowEmpty:!1})}update(l,{count:c}={}){const d=[];return this.headers.Prefer&&d.push(this.headers.Prefer),c&&d.push(`count=${c}`),this.headers.Prefer=d.join(","),new uk.default({method:"PATCH",url:this.url,headers:this.headers,schema:this.schema,body:l,fetch:this.fetch,allowEmpty:!1})}delete({count:l}={}){const c=[];return l&&c.push(`count=${l}`),this.headers.Prefer&&c.unshift(this.headers.Prefer),this.headers.Prefer=c.join(","),new uk.default({method:"DELETE",url:this.url,headers:this.headers,schema:this.schema,fetch:this.fetch,allowEmpty:!1})}};var dk={},hk={};Object.defineProperty(hk,"__esModule",{value:!0}),hk.version=void 0,hk.version="0.0.0-automated",Object.defineProperty(dk,"__esModule",{value:!0}),dk.DEFAULT_HEADERS=void 0;const pk=hk;dk.DEFAULT_HEADERS={"X-Client-Info":`postgrest-js/${pk.version}`};var fk=sr&&sr.__importDefault||function(l){return l&&l.__esModule?l:{default:l}};Object.defineProperty($x,"__esModule",{value:!0});const mk=fk(Ux),gk=fk(Bx),vk=dk;$x.default=class PostgrestClient{constructor(l,{headers:c={},schema:d,fetch:h}={}){this.url=l,this.headers=Object.assign(Object.assign({},vk.DEFAULT_HEADERS),c),this.schemaName=d,this.fetch=h}from(l){const c=new URL(`${this.url}/${l}`);return new mk.default(c,{headers:Object.assign({},this.headers),schema:this.schemaName,fetch:this.fetch})}schema(l){return new PostgrestClient(this.url,{headers:this.headers,schema:l,fetch:this.fetch})}rpc(l,c={},{head:d=!1,get:h=!1,count:p}={}){let f;const m=new URL(`${this.url}/rpc/${l}`);let y;d||h?(f=d?"HEAD":"GET",Object.entries(c).filter((([l,c])=>void 0!==c)).map((([l,c])=>[l,Array.isArray(c)?`{${c.join(",")}}`:`${c}`])).forEach((([l,c])=>{m.searchParams.append(l,c)}))):(f="POST",y=c);const _=Object.assign({},this.headers);return p&&(_.Prefer=`count=${p}`),new gk.default({method:f,url:m,headers:_,schema:this.schemaName,body:y,fetch:this.fetch,allowEmpty:!1})}};var yk=sr&&sr.__importDefault||function(l){return l&&l.__esModule?l:{default:l}};Object.defineProperty(Fx,"__esModule",{value:!0}),Fx.PostgrestError=Fx.PostgrestBuilder=Fx.PostgrestTransformBuilder=Fx.PostgrestFilterBuilder=Fx.PostgrestQueryBuilder=Fx.PostgrestClient=void 0;const _k=yk($x);Fx.PostgrestClient=_k.default;const bk=yk(Ux);Fx.PostgrestQueryBuilder=bk.default;const wk=yk(Bx);Fx.PostgrestFilterBuilder=wk.default;const Sk=yk(Hx);Fx.PostgrestTransformBuilder=Sk.default;const xk=yk(zx);Fx.PostgrestBuilder=xk.default;const kk=yk(Qx);Fx.PostgrestError=kk.default;var Ck=Fx.default={PostgrestClient:_k.default,PostgrestQueryBuilder:bk.default,PostgrestFilterBuilder:wk.default,PostgrestTransformBuilder:Sk.default,PostgrestBuilder:xk.default,PostgrestError:kk.default};const{PostgrestClient:Ek,PostgrestQueryBuilder:Ik,PostgrestFilterBuilder:Tk,PostgrestTransformBuilder:Rk,PostgrestBuilder:Ak,PostgrestError:Ok}=Ck;let Mk;Mk="undefined"==typeof window?require("ws"):window.WebSocket;const Nk={"X-Client-Info":"realtime-js/2.11.10"};var Pk,Lk,jk,Dk,Fk,$k,Uk,Bk,Hk,zk,qk;(Lk=Pk||(Pk={}))[Lk.connecting=0]="connecting",Lk[Lk.open=1]="open",Lk[Lk.closing=2]="closing",Lk[Lk.closed=3]="closed",(Dk=jk||(jk={})).closed="closed",Dk.errored="errored",Dk.joined="joined",Dk.joining="joining",Dk.leaving="leaving",($k=Fk||(Fk={})).close="phx_close",$k.error="phx_error",$k.join="phx_join",$k.reply="phx_reply",$k.leave="phx_leave",$k.access_token="access_token",(Uk||(Uk={})).websocket="websocket",(Hk=Bk||(Bk={})).Connecting="connecting",Hk.Open="open",Hk.Closing="closing",Hk.Closed="closed";class Serializer{constructor(){this.HEADER_LENGTH=1}decode(l,c){return l.constructor===ArrayBuffer?c(this._binaryDecode(l)):c("string"==typeof l?JSON.parse(l):{})}_binaryDecode(l){const c=new DataView(l),d=new TextDecoder;return this._decodeBroadcast(l,c,d)}_decodeBroadcast(l,c,d){const h=c.getUint8(1),p=c.getUint8(2);let f=this.HEADER_LENGTH+2;const m=d.decode(l.slice(f,f+h));f+=h;const y=d.decode(l.slice(f,f+p));f+=p;return{ref:null,topic:m,event:y,payload:JSON.parse(d.decode(l.slice(f,l.byteLength)))}}}class Timer{constructor(l,c){this.callback=l,this.timerCalc=c,this.timer=void 0,this.tries=0,this.callback=l,this.timerCalc=c}reset(){this.tries=0,clearTimeout(this.timer)}scheduleTimeout(){clearTimeout(this.timer),this.timer=setTimeout((()=>{this.tries=this.tries+1,this.callback()}),this.timerCalc(this.tries+1))}}(qk=zk||(zk={})).abstime="abstime",qk.bool="bool",qk.date="date",qk.daterange="daterange",qk.float4="float4",qk.float8="float8",qk.int2="int2",qk.int4="int4",qk.int4range="int4range",qk.int8="int8",qk.int8range="int8range",qk.json="json",qk.jsonb="jsonb",qk.money="money",qk.numeric="numeric",qk.oid="oid",qk.reltime="reltime",qk.text="text",qk.time="time",qk.timestamp="timestamp",qk.timestamptz="timestamptz",qk.timetz="timetz",qk.tsrange="tsrange",qk.tstzrange="tstzrange";const convertChangeData=(l,c,d={})=>{var h;const p=null!==(h=d.skipTypes)&&void 0!==h?h:[];return Object.keys(c).reduce(((d,h)=>(d[h]=convertColumn(h,l,c,p),d)),{})},convertColumn=(l,c,d,h)=>{const p=c.find((c=>c.name===l)),f=null==p?void 0:p.type,m=d[l];return f&&!h.includes(f)?convertCell(f,m):noop$3(m)},convertCell=(l,c)=>{if("_"===l.charAt(0)){const d=l.slice(1,l.length);return toArray(c,d)}switch(l){case zk.bool:return toBoolean(c);case zk.float4:case zk.float8:case zk.int2:case zk.int4:case zk.int8:case zk.numeric:case zk.oid:return toNumber(c);case zk.json:case zk.jsonb:return toJson(c);case zk.timestamp:return toTimestampString(c);case zk.abstime:case zk.date:case zk.daterange:case zk.int4range:case zk.int8range:case zk.money:case zk.reltime:case zk.text:case zk.time:case zk.timestamptz:case zk.timetz:case zk.tsrange:case zk.tstzrange:default:return noop$3(c)}},noop$3=l=>l,toBoolean=l=>{switch(l){case"t":return!0;case"f":return!1;default:return l}},toNumber=l=>{if("string"==typeof l){const c=parseFloat(l);if(!Number.isNaN(c))return c}return l},toJson=l=>{if("string"==typeof l)try{return JSON.parse(l)}catch(c){return console.log(`JSON parse error: ${c}`),l}return l},toArray=(l,c)=>{if("string"!=typeof l)return l;const d=l.length-1,h=l[d];if("{"===l[0]&&"}"===h){let h;const f=l.slice(1,d);try{h=JSON.parse("["+f+"]")}catch(p){h=f?f.split(","):[]}return h.map((l=>convertCell(c,l)))}return l},toTimestampString=l=>"string"==typeof l?l.replace(" ","T"):l,httpEndpointURL=l=>{let c=l;return c=c.replace(/^ws/i,"http"),c=c.replace(/(\/socket\/websocket|\/socket|\/websocket)\/?$/i,""),c.replace(/\/+$/,"")};class Push{constructor(l,c,d={},h=1e4){this.channel=l,this.event=c,this.payload=d,this.timeout=h,this.sent=!1,this.timeoutTimer=void 0,this.ref="",this.receivedResp=null,this.recHooks=[],this.refEvent=null}resend(l){this.timeout=l,this._cancelRefEvent(),this.ref="",this.refEvent=null,this.receivedResp=null,this.sent=!1,this.send()}send(){this._hasReceived("timeout")||(this.startTimeout(),this.sent=!0,this.channel.socket.push({topic:this.channel.topic,event:this.event,payload:this.payload,ref:this.ref,join_ref:this.channel._joinRef()}))}updatePayload(l){this.payload=Object.assign(Object.assign({},this.payload),l)}receive(l,c){var d;return this._hasReceived(l)&&c(null===(d=this.receivedResp)||void 0===d?void 0:d.response),this.recHooks.push({status:l,callback:c}),this}startTimeout(){if(this.timeoutTimer)return;this.ref=this.channel.socket._makeRef(),this.refEvent=this.channel._replyEventName(this.ref);this.channel._on(this.refEvent,{},(l=>{this._cancelRefEvent(),this._cancelTimeout(),this.receivedResp=l,this._matchReceive(l)})),this.timeoutTimer=setTimeout((()=>{this.trigger("timeout",{})}),this.timeout)}trigger(l,c){this.refEvent&&this.channel._trigger(this.refEvent,{status:l,response:c})}destroy(){this._cancelRefEvent(),this._cancelTimeout()}_cancelRefEvent(){this.refEvent&&this.channel._off(this.refEvent,{})}_cancelTimeout(){clearTimeout(this.timeoutTimer),this.timeoutTimer=void 0}_matchReceive({status:l,response:c}){this.recHooks.filter((c=>c.status===l)).forEach((l=>l.callback(c)))}_hasReceived(l){return this.receivedResp&&this.receivedResp.status===l}}var Wk,Vk,Zk,Gk,Kk,Jk,Yk,Qk;(Vk=Wk||(Wk={})).SYNC="sync",Vk.JOIN="join",Vk.LEAVE="leave";class RealtimePresence{constructor(l,c){this.channel=l,this.state={},this.pendingDiffs=[],this.joinRef=null,this.caller={onJoin:()=>{},onLeave:()=>{},onSync:()=>{}};const d=(null==c?void 0:c.events)||{state:"presence_state",diff:"presence_diff"};this.channel._on(d.state,{},(l=>{const{onJoin:c,onLeave:d,onSync:h}=this.caller;this.joinRef=this.channel._joinRef(),this.state=RealtimePresence.syncState(this.state,l,c,d),this.pendingDiffs.forEach((l=>{this.state=RealtimePresence.syncDiff(this.state,l,c,d)})),this.pendingDiffs=[],h()})),this.channel._on(d.diff,{},(l=>{const{onJoin:c,onLeave:d,onSync:h}=this.caller;this.inPendingSyncState()?this.pendingDiffs.push(l):(this.state=RealtimePresence.syncDiff(this.state,l,c,d),h())})),this.onJoin(((l,c,d)=>{this.channel._trigger("presence",{event:"join",key:l,currentPresences:c,newPresences:d})})),this.onLeave(((l,c,d)=>{this.channel._trigger("presence",{event:"leave",key:l,currentPresences:c,leftPresences:d})})),this.onSync((()=>{this.channel._trigger("presence",{event:"sync"})}))}static syncState(l,c,d,h){const p=this.cloneDeep(l),f=this.transformState(c),m={},y={};return this.map(p,((l,c)=>{f[l]||(y[l]=c)})),this.map(f,((l,c)=>{const d=p[l];if(d){const h=c.map((l=>l.presence_ref)),p=d.map((l=>l.presence_ref)),f=c.filter((l=>p.indexOf(l.presence_ref)<0)),_=d.filter((l=>h.indexOf(l.presence_ref)<0));f.length>0&&(m[l]=f),_.length>0&&(y[l]=_)}else m[l]=c})),this.syncDiff(p,{joins:m,leaves:y},d,h)}static syncDiff(l,c,d,h){const{joins:p,leaves:f}={joins:this.transformState(c.joins),leaves:this.transformState(c.leaves)};return d||(d=()=>{}),h||(h=()=>{}),this.map(p,((c,h)=>{var p;const f=null!==(p=l[c])&&void 0!==p?p:[];if(l[c]=this.cloneDeep(h),f.length>0){const d=l[c].map((l=>l.presence_ref)),h=f.filter((l=>d.indexOf(l.presence_ref)<0));l[c].unshift(...h)}d(c,f,h)})),this.map(f,((c,d)=>{let p=l[c];if(!p)return;const f=d.map((l=>l.presence_ref));p=p.filter((l=>f.indexOf(l.presence_ref)<0)),l[c]=p,h(c,p,d),0===p.length&&delete l[c]})),l}static map(l,c){return Object.getOwnPropertyNames(l).map((d=>c(d,l[d])))}static transformState(l){return l=this.cloneDeep(l),Object.getOwnPropertyNames(l).reduce(((c,d)=>{const h=l[d];return c[d]="metas"in h?h.metas.map((l=>(l.presence_ref=l.phx_ref,delete l.phx_ref,delete l.phx_ref_prev,l))):h,c}),{})}static cloneDeep(l){return JSON.parse(JSON.stringify(l))}onJoin(l){this.caller.onJoin=l}onLeave(l){this.caller.onLeave=l}onSync(l){this.caller.onSync=l}inPendingSyncState(){return!this.joinRef||this.joinRef!==this.channel._joinRef()}}(Gk=Zk||(Zk={})).ALL="*",Gk.INSERT="INSERT",Gk.UPDATE="UPDATE",Gk.DELETE="DELETE",(Jk=Kk||(Kk={})).BROADCAST="broadcast",Jk.PRESENCE="presence",Jk.POSTGRES_CHANGES="postgres_changes",Jk.SYSTEM="system",(Qk=Yk||(Yk={})).SUBSCRIBED="SUBSCRIBED",Qk.TIMED_OUT="TIMED_OUT",Qk.CLOSED="CLOSED",Qk.CHANNEL_ERROR="CHANNEL_ERROR";class RealtimeChannel{constructor(l,c={config:{}},d){this.topic=l,this.params=c,this.socket=d,this.bindings={},this.state=jk.closed,this.joinedOnce=!1,this.pushBuffer=[],this.subTopic=l.replace(/^realtime:/i,""),this.params.config=Object.assign({broadcast:{ack:!1,self:!1},presence:{key:""},private:!1},c.config),this.timeout=this.socket.timeout,this.joinPush=new Push(this,Fk.join,this.params,this.timeout),this.rejoinTimer=new Timer((()=>this._rejoinUntilConnected()),this.socket.reconnectAfterMs),this.joinPush.receive("ok",(()=>{this.state=jk.joined,this.rejoinTimer.reset(),this.pushBuffer.forEach((l=>l.send())),this.pushBuffer=[]})),this._onClose((()=>{this.rejoinTimer.reset(),this.socket.log("channel",`close ${this.topic} ${this._joinRef()}`),this.state=jk.closed,this.socket._remove(this)})),this._onError((l=>{this._isLeaving()||this._isClosed()||(this.socket.log("channel",`error ${this.topic}`,l),this.state=jk.errored,this.rejoinTimer.scheduleTimeout())})),this.joinPush.receive("timeout",(()=>{this._isJoining()&&(this.socket.log("channel",`timeout ${this.topic}`,this.joinPush.timeout),this.state=jk.errored,this.rejoinTimer.scheduleTimeout())})),this._on(Fk.reply,{},((l,c)=>{this._trigger(this._replyEventName(c),l)})),this.presence=new RealtimePresence(this),this.broadcastEndpointURL=httpEndpointURL(this.socket.endPoint)+"/api/broadcast",this.private=this.params.config.private||!1}subscribe(l,c=this.timeout){var d,h;if(this.socket.isConnected()||this.socket.connect(),this.joinedOnce)throw"tried to subscribe multiple times. 'subscribe' can only be called a single time per channel instance";{const{config:{broadcast:p,presence:f,private:m}}=this.params;this._onError((c=>null==l?void 0:l(Yk.CHANNEL_ERROR,c))),this._onClose((()=>null==l?void 0:l(Yk.CLOSED)));const y={},_={broadcast:p,presence:f,postgres_changes:null!==(h=null===(d=this.bindings.postgres_changes)||void 0===d?void 0:d.map((l=>l.filter)))&&void 0!==h?h:[],private:m};this.socket.accessTokenValue&&(y.access_token=this.socket.accessTokenValue),this.updateJoinPayload(Object.assign({config:_},y)),this.joinedOnce=!0,this._rejoin(c),this.joinPush.receive("ok",(async({postgres_changes:c})=>{var d;if(this.socket.setAuth(),void 0!==c){const h=this.bindings.postgres_changes,p=null!==(d=null==h?void 0:h.length)&&void 0!==d?d:0,f=[];for(let d=0;d<p;d++){const p=h[d],{filter:{event:m,schema:y,table:_,filter:b}}=p,w=c&&c[d];if(!w||w.event!==m||w.schema!==y||w.table!==_||w.filter!==b)return this.unsubscribe(),this.state=jk.errored,void(null==l||l(Yk.CHANNEL_ERROR,new Error("mismatch between server and client bindings for postgres changes")));f.push(Object.assign(Object.assign({},p),{id:w.id}))}return this.bindings.postgres_changes=f,void(l&&l(Yk.SUBSCRIBED))}null==l||l(Yk.SUBSCRIBED)})).receive("error",(c=>{this.state=jk.errored,null==l||l(Yk.CHANNEL_ERROR,new Error(JSON.stringify(Object.values(c).join(", ")||"error")))})).receive("timeout",(()=>{null==l||l(Yk.TIMED_OUT)}))}return this}presenceState(){return this.presence.state}async track(l,c={}){return await this.send({type:"presence",event:"track",payload:l},c.timeout||this.timeout)}async untrack(l={}){return await this.send({type:"presence",event:"untrack"},l)}on(l,c,d){return this._on(l,c,d)}async send(l,c={}){var d,h;if(this._canPush()||"broadcast"!==l.type)return new Promise((d=>{var h,p,f;const m=this._push(l.type,l,c.timeout||this.timeout);"broadcast"!==l.type||(null===(f=null===(p=null===(h=this.params)||void 0===h?void 0:h.config)||void 0===p?void 0:p.broadcast)||void 0===f?void 0:f.ack)||d("ok"),m.receive("ok",(()=>d("ok"))),m.receive("error",(()=>d("error"))),m.receive("timeout",(()=>d("timed out")))}));{const{event:f,payload:m}=l,y={method:"POST",headers:{Authorization:this.socket.accessTokenValue?`Bearer ${this.socket.accessTokenValue}`:"",apikey:this.socket.apiKey?this.socket.apiKey:"","Content-Type":"application/json"},body:JSON.stringify({messages:[{topic:this.subTopic,event:f,payload:m,private:this.private}]})};try{const l=await this._fetchWithTimeout(this.broadcastEndpointURL,y,null!==(d=c.timeout)&&void 0!==d?d:this.timeout);return await(null===(h=l.body)||void 0===h?void 0:h.cancel()),l.ok?"ok":"error"}catch(p){return"AbortError"===p.name?"timed out":"error"}}}updateJoinPayload(l){this.joinPush.updatePayload(l)}unsubscribe(l=this.timeout){this.state=jk.leaving;const onClose=()=>{this.socket.log("channel",`leave ${this.topic}`),this._trigger(Fk.close,"leave",this._joinRef())};return this.joinPush.destroy(),new Promise((c=>{const d=new Push(this,Fk.leave,{},l);d.receive("ok",(()=>{onClose(),c("ok")})).receive("timeout",(()=>{onClose(),c("timed out")})).receive("error",(()=>{c("error")})),d.send(),this._canPush()||d.trigger("ok",{})}))}teardown(){this.pushBuffer.forEach((l=>l.destroy())),this.rejoinTimer&&clearTimeout(this.rejoinTimer.timer),this.joinPush.destroy()}async _fetchWithTimeout(l,c,d){const h=new AbortController,p=setTimeout((()=>h.abort()),d),f=await this.socket.fetch(l,Object.assign(Object.assign({},c),{signal:h.signal}));return clearTimeout(p),f}_push(l,c,d=this.timeout){if(!this.joinedOnce)throw`tried to push '${l}' to '${this.topic}' before joining. Use channel.subscribe() before pushing events`;let h=new Push(this,l,c,d);return this._canPush()?h.send():(h.startTimeout(),this.pushBuffer.push(h)),h}_onMessage(l,c,d){return c}_isMember(l){return this.topic===l}_joinRef(){return this.joinPush.ref}_trigger(l,c,d){var h,p;const f=l.toLocaleLowerCase(),{close:m,error:y,leave:_,join:b}=Fk;if(d&&[m,y,_,b].indexOf(f)>=0&&d!==this._joinRef())return;let w=this._onMessage(f,c,d);if(c&&!w)throw"channel onMessage callbacks must return the payload, modified or unmodified";["insert","update","delete"].includes(f)?null===(h=this.bindings.postgres_changes)||void 0===h||h.filter((l=>{var c,d,h;return"*"===(null===(c=l.filter)||void 0===c?void 0:c.event)||(null===(h=null===(d=l.filter)||void 0===d?void 0:d.event)||void 0===h?void 0:h.toLocaleLowerCase())===f})).map((l=>l.callback(w,d))):null===(p=this.bindings[f])||void 0===p||p.filter((l=>{var d,h,p,m,y,_;if(["broadcast","presence","postgres_changes"].includes(f)){if("id"in l){const f=l.id,m=null===(d=l.filter)||void 0===d?void 0:d.event;return f&&(null===(h=c.ids)||void 0===h?void 0:h.includes(f))&&("*"===m||(null==m?void 0:m.toLocaleLowerCase())===(null===(p=c.data)||void 0===p?void 0:p.type.toLocaleLowerCase()))}{const d=null===(y=null===(m=null==l?void 0:l.filter)||void 0===m?void 0:m.event)||void 0===y?void 0:y.toLocaleLowerCase();return"*"===d||d===(null===(_=null==c?void 0:c.event)||void 0===_?void 0:_.toLocaleLowerCase())}}return l.type.toLocaleLowerCase()===f})).map((l=>{if("object"==typeof w&&"ids"in w){const l=w.data,{schema:c,table:d,commit_timestamp:h,type:p,errors:f}=l,m={schema:c,table:d,commit_timestamp:h,eventType:p,new:{},old:{},errors:f};w=Object.assign(Object.assign({},m),this._getPayloadRecords(l))}l.callback(w,d)}))}_isClosed(){return this.state===jk.closed}_isJoined(){return this.state===jk.joined}_isJoining(){return this.state===jk.joining}_isLeaving(){return this.state===jk.leaving}_replyEventName(l){return`chan_reply_${l}`}_on(l,c,d){const h=l.toLocaleLowerCase(),p={type:h,filter:c,callback:d};return this.bindings[h]?this.bindings[h].push(p):this.bindings[h]=[p],this}_off(l,c){const d=l.toLocaleLowerCase();return this.bindings[d]=this.bindings[d].filter((l=>{var h;return!((null===(h=l.type)||void 0===h?void 0:h.toLocaleLowerCase())===d&&RealtimeChannel.isEqual(l.filter,c))})),this}static isEqual(l,c){if(Object.keys(l).length!==Object.keys(c).length)return!1;for(const d in l)if(l[d]!==c[d])return!1;return!0}_rejoinUntilConnected(){this.rejoinTimer.scheduleTimeout(),this.socket.isConnected()&&this._rejoin()}_onClose(l){this._on(Fk.close,{},l)}_onError(l){this._on(Fk.error,{},(c=>l(c)))}_canPush(){return this.socket.isConnected()&&this._isJoined()}_rejoin(l=this.timeout){this._isLeaving()||(this.socket._leaveOpenTopic(this.topic),this.state=jk.joining,this.joinPush.resend(l))}_getPayloadRecords(l){const c={new:{},old:{}};return"INSERT"!==l.type&&"UPDATE"!==l.type||(c.new=convertChangeData(l.columns,l.record)),"UPDATE"!==l.type&&"DELETE"!==l.type||(c.old=convertChangeData(l.columns,l.old_record)),c}}const noop$2=()=>{};class RealtimeClient{constructor(l,c){var d;this.accessTokenValue=null,this.apiKey=null,this.channels=new Array,this.endPoint="",this.httpEndpoint="",this.headers=Nk,this.params={},this.timeout=1e4,this.heartbeatIntervalMs=25e3,this.heartbeatTimer=void 0,this.pendingHeartbeatRef=null,this.heartbeatCallback=noop$2,this.ref=0,this.logger=noop$2,this.conn=null,this.sendBuffer=[],this.serializer=new Serializer,this.stateChangeCallbacks={open:[],close:[],error:[],message:[]},this.accessToken=null,this._resolveFetch=l=>{let c;return c=l||("undefined"==typeof fetch?(...l)=>__vitePreload((async()=>{const{default:l}=await Promise.resolve().then((()=>Jx));return{default:l}}),void 0).then((({default:c})=>c(...l))):fetch),(...l)=>c(...l)},this.endPoint=`${l}/${Uk.websocket}`,this.httpEndpoint=httpEndpointURL(l),(null==c?void 0:c.transport)?this.transport=c.transport:this.transport=null,(null==c?void 0:c.params)&&(this.params=c.params),(null==c?void 0:c.headers)&&(this.headers=Object.assign(Object.assign({},this.headers),c.headers)),(null==c?void 0:c.timeout)&&(this.timeout=c.timeout),(null==c?void 0:c.logger)&&(this.logger=c.logger),((null==c?void 0:c.logLevel)||(null==c?void 0:c.log_level))&&(this.logLevel=c.logLevel||c.log_level,this.params=Object.assign(Object.assign({},this.params),{log_level:this.logLevel})),(null==c?void 0:c.heartbeatIntervalMs)&&(this.heartbeatIntervalMs=c.heartbeatIntervalMs);const h=null===(d=null==c?void 0:c.params)||void 0===d?void 0:d.apikey;if(h&&(this.accessTokenValue=h,this.apiKey=h),this.reconnectAfterMs=(null==c?void 0:c.reconnectAfterMs)?c.reconnectAfterMs:l=>[1e3,2e3,5e3,1e4][l-1]||1e4,this.encode=(null==c?void 0:c.encode)?c.encode:(l,c)=>c(JSON.stringify(l)),this.decode=(null==c?void 0:c.decode)?c.decode:this.serializer.decode.bind(this.serializer),this.reconnectTimer=new Timer((async()=>{this.disconnect(),this.connect()}),this.reconnectAfterMs),this.fetch=this._resolveFetch(null==c?void 0:c.fetch),null==c?void 0:c.worker){if("undefined"!=typeof window&&!window.Worker)throw new Error("Web Worker is not supported");this.worker=(null==c?void 0:c.worker)||!1,this.workerUrl=null==c?void 0:c.workerUrl}this.accessToken=(null==c?void 0:c.accessToken)||null}connect(){if(!this.conn){if(this.transport||(this.transport=Mk),this.transport){const l="undefined"!=typeof window&&this.transport===window.WebSocket;return this.conn=l?new this.transport(this.endpointURL()):new this.transport(this.endpointURL(),void 0,{headers:this.headers}),void this.setupConnection()}this.conn=new WSWebSocketDummy(this.endpointURL(),void 0,{close:()=>{this.conn=null}})}}endpointURL(){return this._appendParams(this.endPoint,Object.assign({},this.params,{vsn:"1.0.0"}))}disconnect(l,c){this.conn&&(this.conn.onclose=function(){},l?this.conn.close(l,null!=c?c:""):this.conn.close(),this.conn=null,this.heartbeatTimer&&clearInterval(this.heartbeatTimer),this.reconnectTimer.reset(),this.channels.forEach((l=>l.teardown())))}getChannels(){return this.channels}async removeChannel(l){const c=await l.unsubscribe();return this.channels=this.channels.filter((c=>c._joinRef!==l._joinRef)),0===this.channels.length&&this.disconnect(),c}async removeAllChannels(){const l=await Promise.all(this.channels.map((l=>l.unsubscribe())));return this.channels=[],this.disconnect(),l}log(l,c,d){this.logger(l,c,d)}connectionState(){switch(this.conn&&this.conn.readyState){case Pk.connecting:return Bk.Connecting;case Pk.open:return Bk.Open;case Pk.closing:return Bk.Closing;default:return Bk.Closed}}isConnected(){return this.connectionState()===Bk.Open}channel(l,c={config:{}}){const d=`realtime:${l}`,h=this.getChannels().find((l=>l.topic===d));if(h)return h;{const d=new RealtimeChannel(`realtime:${l}`,c,this);return this.channels.push(d),d}}push(l){const{topic:c,event:d,payload:h,ref:p}=l,callback=()=>{this.encode(l,(l=>{var c;null===(c=this.conn)||void 0===c||c.send(l)}))};this.log("push",`${c} ${d} (${p})`,h),this.isConnected()?callback():this.sendBuffer.push(callback)}async setAuth(l=null){let c=l||this.accessToken&&await this.accessToken()||this.accessTokenValue;this.accessTokenValue!=c&&(this.accessTokenValue=c,this.channels.forEach((l=>{c&&l.updateJoinPayload({access_token:c,version:this.headers&&this.headers["X-Client-Info"]}),l.joinedOnce&&l._isJoined()&&l._push(Fk.access_token,{access_token:c})})))}async sendHeartbeat(){var l;if(this.isConnected()){if(this.pendingHeartbeatRef)return this.pendingHeartbeatRef=null,this.log("transport","heartbeat timeout. Attempting to re-establish connection"),this.heartbeatCallback("timeout"),void(null===(l=this.conn)||void 0===l||l.close(1e3,"hearbeat timeout"));this.pendingHeartbeatRef=this._makeRef(),this.push({topic:"phoenix",event:"heartbeat",payload:{},ref:this.pendingHeartbeatRef}),this.heartbeatCallback("sent"),await this.setAuth()}else this.heartbeatCallback("disconnected")}onHeartbeat(l){this.heartbeatCallback=l}flushSendBuffer(){this.isConnected()&&this.sendBuffer.length>0&&(this.sendBuffer.forEach((l=>l())),this.sendBuffer=[])}_makeRef(){let l=this.ref+1;return l===this.ref?this.ref=0:this.ref=l,this.ref.toString()}_leaveOpenTopic(l){let c=this.channels.find((c=>c.topic===l&&(c._isJoined()||c._isJoining())));c&&(this.log("transport",`leaving duplicate topic "${l}"`),c.unsubscribe())}_remove(l){this.channels=this.channels.filter((c=>c.topic!==l.topic))}setupConnection(){this.conn&&(this.conn.binaryType="arraybuffer",this.conn.onopen=()=>this._onConnOpen(),this.conn.onerror=l=>this._onConnError(l),this.conn.onmessage=l=>this._onConnMessage(l),this.conn.onclose=l=>this._onConnClose(l))}_onConnMessage(l){this.decode(l.data,(l=>{let{topic:c,event:d,payload:h,ref:p}=l;"phoenix"===c&&"phx_reply"===d&&this.heartbeatCallback("ok"==l.payload.status?"ok":"error"),p&&p===this.pendingHeartbeatRef&&(this.pendingHeartbeatRef=null),this.log("receive",`${h.status||""} ${c} ${d} ${p&&"("+p+")"||""}`,h),Array.from(this.channels).filter((l=>l._isMember(c))).forEach((l=>l._trigger(d,h,p))),this.stateChangeCallbacks.message.forEach((c=>c(l)))}))}_onConnOpen(){if(this.log("transport",`connected to ${this.endpointURL()}`),this.flushSendBuffer(),this.reconnectTimer.reset(),this.worker){this.workerUrl?this.log("worker",`starting worker for from ${this.workerUrl}`):this.log("worker","starting default worker");const l=this._workerObjectUrl(this.workerUrl);this.workerRef=new Worker(l),this.workerRef.onerror=l=>{this.log("worker","worker error",l.message),this.workerRef.terminate()},this.workerRef.onmessage=l=>{"keepAlive"===l.data.event&&this.sendHeartbeat()},this.workerRef.postMessage({event:"start",interval:this.heartbeatIntervalMs})}else this.heartbeatTimer&&clearInterval(this.heartbeatTimer),this.heartbeatTimer=setInterval((()=>this.sendHeartbeat()),this.heartbeatIntervalMs);this.stateChangeCallbacks.open.forEach((l=>l()))}_onConnClose(l){this.log("transport","close",l),this._triggerChanError(),this.heartbeatTimer&&clearInterval(this.heartbeatTimer),this.reconnectTimer.scheduleTimeout(),this.stateChangeCallbacks.close.forEach((c=>c(l)))}_onConnError(l){this.log("transport",l.message),this._triggerChanError(),this.stateChangeCallbacks.error.forEach((c=>c(l)))}_triggerChanError(){this.channels.forEach((l=>l._trigger(Fk.error)))}_appendParams(l,c){if(0===Object.keys(c).length)return l;const d=l.match(/\?/)?"&":"?";return`${l}${d}${new URLSearchParams(c)}`}_workerObjectUrl(l){let c;if(l)c=l;else{const l=new Blob(['\n  addEventListener("message", (e) => {\n    if (e.data.event === "start") {\n      setInterval(() => postMessage({ event: "keepAlive" }), e.data.interval);\n    }\n  });'],{type:"application/javascript"});c=URL.createObjectURL(l)}return c}}class WSWebSocketDummy{constructor(l,c,d){this.binaryType="arraybuffer",this.onclose=()=>{},this.onerror=()=>{},this.onmessage=()=>{},this.onopen=()=>{},this.readyState=Pk.connecting,this.send=()=>{},this.url=null,this.url=l,this.close=d.close}}class StorageError extends Error{constructor(l){super(l),this.__isStorageError=!0,this.name="StorageError"}}function isStorageError(l){return"object"==typeof l&&null!==l&&"__isStorageError"in l}class StorageApiError extends StorageError{constructor(l,c){super(l),this.name="StorageApiError",this.status=c}toJSON(){return{name:this.name,message:this.message,status:this.status}}}class StorageUnknownError extends StorageError{constructor(l,c){super(l),this.name="StorageUnknownError",this.originalError=c}}var __awaiter$7=function(l,c,d,h){return new(d||(d=Promise))((function(p,f){function fulfilled(l){try{step(h.next(l))}catch(hh){f(hh)}}function rejected(l){try{step(h.throw(l))}catch(hh){f(hh)}}function step(l){var c;l.done?p(l.value):(c=l.value,c instanceof d?c:new d((function(l){l(c)}))).then(fulfilled,rejected)}step((h=h.apply(l,c||[])).next())}))};const resolveFetch$2=l=>{let c;return c=l||("undefined"==typeof fetch?(...l)=>__vitePreload((async()=>{const{default:l}=await Promise.resolve().then((()=>Jx));return{default:l}}),void 0).then((({default:c})=>c(...l))):fetch),(...l)=>c(...l)},recursiveToCamel=l=>{if(Array.isArray(l))return l.map((l=>recursiveToCamel(l)));if("function"==typeof l||l!==Object(l))return l;const c={};return Object.entries(l).forEach((([l,d])=>{const h=l.replace(/([-_][a-z])/gi,(l=>l.toUpperCase().replace(/[-_]/g,"")));c[h]=recursiveToCamel(d)})),c};var __awaiter$6=function(l,c,d,h){return new(d||(d=Promise))((function(p,f){function fulfilled(l){try{step(h.next(l))}catch(hh){f(hh)}}function rejected(l){try{step(h.throw(l))}catch(hh){f(hh)}}function step(l){var c;l.done?p(l.value):(c=l.value,c instanceof d?c:new d((function(l){l(c)}))).then(fulfilled,rejected)}step((h=h.apply(l,c||[])).next())}))};const _getErrorMessage$1=l=>l.msg||l.message||l.error_description||l.error||JSON.stringify(l),handleError$1=(l,c,d)=>__awaiter$6(void 0,void 0,void 0,(function*(){const h=yield __awaiter$7(void 0,void 0,void 0,(function*(){return"undefined"==typeof Response?(yield __vitePreload((()=>Promise.resolve().then((()=>Jx))),void 0)).Response:Response}));l instanceof h&&!(null==d?void 0:d.noResolveJson)?l.json().then((d=>{c(new StorageApiError(_getErrorMessage$1(d),l.status||500))})).catch((l=>{c(new StorageUnknownError(_getErrorMessage$1(l),l))})):c(new StorageUnknownError(_getErrorMessage$1(l),l))}));function _handleRequest$1(l,c,d,h,p,f){return __awaiter$6(this,void 0,void 0,(function*(){return new Promise(((m,y)=>{l(d,((l,c,d,h)=>{const p={method:l,headers:(null==c?void 0:c.headers)||{}};return"GET"===l?p:(p.headers=Object.assign({"Content-Type":"application/json"},null==c?void 0:c.headers),h&&(p.body=JSON.stringify(h)),Object.assign(Object.assign({},p),d))})(c,h,p,f)).then((l=>{if(!l.ok)throw l;return(null==h?void 0:h.noResolveJson)?l:l.json()})).then((l=>m(l))).catch((l=>handleError$1(l,y,h)))}))}))}function get$1(l,c,d,h){return __awaiter$6(this,void 0,void 0,(function*(){return _handleRequest$1(l,"GET",c,d,h)}))}function post(l,c,d,h,p){return __awaiter$6(this,void 0,void 0,(function*(){return _handleRequest$1(l,"POST",c,h,p,d)}))}function remove(l,c,d,h,p){return __awaiter$6(this,void 0,void 0,(function*(){return _handleRequest$1(l,"DELETE",c,h,p,d)}))}var __awaiter$5=function(l,c,d,h){return new(d||(d=Promise))((function(p,f){function fulfilled(l){try{step(h.next(l))}catch(hh){f(hh)}}function rejected(l){try{step(h.throw(l))}catch(hh){f(hh)}}function step(l){var c;l.done?p(l.value):(c=l.value,c instanceof d?c:new d((function(l){l(c)}))).then(fulfilled,rejected)}step((h=h.apply(l,c||[])).next())}))};const Xk={limit:100,offset:0,sortBy:{column:"name",order:"asc"}},eC={cacheControl:"3600",contentType:"text/plain;charset=UTF-8",upsert:!1};class StorageFileApi{constructor(l,c={},d,h){this.url=l,this.headers=c,this.bucketId=d,this.fetch=resolveFetch$2(h)}uploadOrUpdate(l,c,d,h){return __awaiter$5(this,void 0,void 0,(function*(){try{let p;const f=Object.assign(Object.assign({},eC),h);let m=Object.assign(Object.assign({},this.headers),"POST"===l&&{"x-upsert":String(f.upsert)});const y=f.metadata;"undefined"!=typeof Blob&&d instanceof Blob?(p=new FormData,p.append("cacheControl",f.cacheControl),y&&p.append("metadata",this.encodeMetadata(y)),p.append("",d)):"undefined"!=typeof FormData&&d instanceof FormData?(p=d,p.append("cacheControl",f.cacheControl),y&&p.append("metadata",this.encodeMetadata(y))):(p=d,m["cache-control"]=`max-age=${f.cacheControl}`,m["content-type"]=f.contentType,y&&(m["x-metadata"]=this.toBase64(this.encodeMetadata(y)))),(null==h?void 0:h.headers)&&(m=Object.assign(Object.assign({},m),h.headers));const _=this._removeEmptyFolders(c),b=this._getFinalPath(_),w=yield this.fetch(`${this.url}/object/${b}`,Object.assign({method:l,body:p,headers:m},(null==f?void 0:f.duplex)?{duplex:f.duplex}:{})),E=yield w.json();if(w.ok)return{data:{path:_,id:E.Id,fullPath:E.Key},error:null};return{data:null,error:E}}catch(p){if(isStorageError(p))return{data:null,error:p};throw p}}))}upload(l,c,d){return __awaiter$5(this,void 0,void 0,(function*(){return this.uploadOrUpdate("POST",l,c,d)}))}uploadToSignedUrl(l,c,d,h){return __awaiter$5(this,void 0,void 0,(function*(){const p=this._removeEmptyFolders(l),f=this._getFinalPath(p),m=new URL(this.url+`/object/upload/sign/${f}`);m.searchParams.set("token",c);try{let l;const c=Object.assign({upsert:eC.upsert},h),f=Object.assign(Object.assign({},this.headers),{"x-upsert":String(c.upsert)});"undefined"!=typeof Blob&&d instanceof Blob?(l=new FormData,l.append("cacheControl",c.cacheControl),l.append("",d)):"undefined"!=typeof FormData&&d instanceof FormData?(l=d,l.append("cacheControl",c.cacheControl)):(l=d,f["cache-control"]=`max-age=${c.cacheControl}`,f["content-type"]=c.contentType);const y=yield this.fetch(m.toString(),{method:"PUT",body:l,headers:f}),_=yield y.json();if(y.ok)return{data:{path:p,fullPath:_.Key},error:null};return{data:null,error:_}}catch(y){if(isStorageError(y))return{data:null,error:y};throw y}}))}createSignedUploadUrl(l,c){return __awaiter$5(this,void 0,void 0,(function*(){try{let d=this._getFinalPath(l);const h=Object.assign({},this.headers);(null==c?void 0:c.upsert)&&(h["x-upsert"]="true");const p=yield post(this.fetch,`${this.url}/object/upload/sign/${d}`,{},{headers:h}),f=new URL(this.url+p.url),m=f.searchParams.get("token");if(!m)throw new StorageError("No token returned by API");return{data:{signedUrl:f.toString(),path:l,token:m},error:null}}catch(d){if(isStorageError(d))return{data:null,error:d};throw d}}))}update(l,c,d){return __awaiter$5(this,void 0,void 0,(function*(){return this.uploadOrUpdate("PUT",l,c,d)}))}move(l,c,d){return __awaiter$5(this,void 0,void 0,(function*(){try{return{data:yield post(this.fetch,`${this.url}/object/move`,{bucketId:this.bucketId,sourceKey:l,destinationKey:c,destinationBucket:null==d?void 0:d.destinationBucket},{headers:this.headers}),error:null}}catch(h){if(isStorageError(h))return{data:null,error:h};throw h}}))}copy(l,c,d){return __awaiter$5(this,void 0,void 0,(function*(){try{return{data:{path:(yield post(this.fetch,`${this.url}/object/copy`,{bucketId:this.bucketId,sourceKey:l,destinationKey:c,destinationBucket:null==d?void 0:d.destinationBucket},{headers:this.headers})).Key},error:null}}catch(h){if(isStorageError(h))return{data:null,error:h};throw h}}))}createSignedUrl(l,c,d){return __awaiter$5(this,void 0,void 0,(function*(){try{let h=this._getFinalPath(l),p=yield post(this.fetch,`${this.url}/object/sign/${h}`,Object.assign({expiresIn:c},(null==d?void 0:d.transform)?{transform:d.transform}:{}),{headers:this.headers});const f=(null==d?void 0:d.download)?`&download=${!0===d.download?"":d.download}`:"";return p={signedUrl:encodeURI(`${this.url}${p.signedURL}${f}`)},{data:p,error:null}}catch(h){if(isStorageError(h))return{data:null,error:h};throw h}}))}createSignedUrls(l,c,d){return __awaiter$5(this,void 0,void 0,(function*(){try{const h=yield post(this.fetch,`${this.url}/object/sign/${this.bucketId}`,{expiresIn:c,paths:l},{headers:this.headers}),p=(null==d?void 0:d.download)?`&download=${!0===d.download?"":d.download}`:"";return{data:h.map((l=>Object.assign(Object.assign({},l),{signedUrl:l.signedURL?encodeURI(`${this.url}${l.signedURL}${p}`):null}))),error:null}}catch(h){if(isStorageError(h))return{data:null,error:h};throw h}}))}download(l,c){return __awaiter$5(this,void 0,void 0,(function*(){const d=void 0!==(null==c?void 0:c.transform)?"render/image/authenticated":"object",h=this.transformOptsToQueryString((null==c?void 0:c.transform)||{}),p=h?`?${h}`:"";try{const c=this._getFinalPath(l),h=yield get$1(this.fetch,`${this.url}/${d}/${c}${p}`,{headers:this.headers,noResolveJson:!0});return{data:yield h.blob(),error:null}}catch(f){if(isStorageError(f))return{data:null,error:f};throw f}}))}info(l){return __awaiter$5(this,void 0,void 0,(function*(){const c=this._getFinalPath(l);try{const l=yield get$1(this.fetch,`${this.url}/object/info/${c}`,{headers:this.headers});return{data:recursiveToCamel(l),error:null}}catch(d){if(isStorageError(d))return{data:null,error:d};throw d}}))}exists(l){return __awaiter$5(this,void 0,void 0,(function*(){const c=this._getFinalPath(l);try{return yield function(l,c,d,h){return __awaiter$6(this,void 0,void 0,(function*(){return _handleRequest$1(l,"HEAD",c,Object.assign(Object.assign({},d),{noResolveJson:!0}),h)}))}(this.fetch,`${this.url}/object/${c}`,{headers:this.headers}),{data:!0,error:null}}catch(d){if(isStorageError(d)&&d instanceof StorageUnknownError){const l=d.originalError;if([400,404].includes(null==l?void 0:l.status))return{data:!1,error:d}}throw d}}))}getPublicUrl(l,c){const d=this._getFinalPath(l),h=[],p=(null==c?void 0:c.download)?`download=${!0===c.download?"":c.download}`:"";""!==p&&h.push(p);const f=void 0!==(null==c?void 0:c.transform)?"render/image":"object",m=this.transformOptsToQueryString((null==c?void 0:c.transform)||{});""!==m&&h.push(m);let y=h.join("&");return""!==y&&(y=`?${y}`),{data:{publicUrl:encodeURI(`${this.url}/${f}/public/${d}${y}`)}}}remove(l){return __awaiter$5(this,void 0,void 0,(function*(){try{return{data:yield remove(this.fetch,`${this.url}/object/${this.bucketId}`,{prefixes:l},{headers:this.headers}),error:null}}catch(c){if(isStorageError(c))return{data:null,error:c};throw c}}))}list(l,c,d){return __awaiter$5(this,void 0,void 0,(function*(){try{const h=Object.assign(Object.assign(Object.assign({},Xk),c),{prefix:l||""});return{data:yield post(this.fetch,`${this.url}/object/list/${this.bucketId}`,h,{headers:this.headers},d),error:null}}catch(h){if(isStorageError(h))return{data:null,error:h};throw h}}))}encodeMetadata(l){return JSON.stringify(l)}toBase64(l){return"undefined"!=typeof Buffer?Buffer.from(l).toString("base64"):btoa(l)}_getFinalPath(l){return`${this.bucketId}/${l}`}_removeEmptyFolders(l){return l.replace(/^\/|\/$/g,"").replace(/\/+/g,"/")}transformOptsToQueryString(l){const c=[];return l.width&&c.push(`width=${l.width}`),l.height&&c.push(`height=${l.height}`),l.resize&&c.push(`resize=${l.resize}`),l.format&&c.push(`format=${l.format}`),l.quality&&c.push(`quality=${l.quality}`),c.join("&")}}const tC={"X-Client-Info":"storage-js/2.7.1"};var __awaiter$4=function(l,c,d,h){return new(d||(d=Promise))((function(p,f){function fulfilled(l){try{step(h.next(l))}catch(hh){f(hh)}}function rejected(l){try{step(h.throw(l))}catch(hh){f(hh)}}function step(l){var c;l.done?p(l.value):(c=l.value,c instanceof d?c:new d((function(l){l(c)}))).then(fulfilled,rejected)}step((h=h.apply(l,c||[])).next())}))};class StorageBucketApi{constructor(l,c={},d){this.url=l,this.headers=Object.assign(Object.assign({},tC),c),this.fetch=resolveFetch$2(d)}listBuckets(){return __awaiter$4(this,void 0,void 0,(function*(){try{return{data:yield get$1(this.fetch,`${this.url}/bucket`,{headers:this.headers}),error:null}}catch(l){if(isStorageError(l))return{data:null,error:l};throw l}}))}getBucket(l){return __awaiter$4(this,void 0,void 0,(function*(){try{return{data:yield get$1(this.fetch,`${this.url}/bucket/${l}`,{headers:this.headers}),error:null}}catch(c){if(isStorageError(c))return{data:null,error:c};throw c}}))}createBucket(l,c={public:!1}){return __awaiter$4(this,void 0,void 0,(function*(){try{return{data:yield post(this.fetch,`${this.url}/bucket`,{id:l,name:l,public:c.public,file_size_limit:c.fileSizeLimit,allowed_mime_types:c.allowedMimeTypes},{headers:this.headers}),error:null}}catch(d){if(isStorageError(d))return{data:null,error:d};throw d}}))}updateBucket(l,c){return __awaiter$4(this,void 0,void 0,(function*(){try{const d=yield function(l,c,d,h,p){return __awaiter$6(this,void 0,void 0,(function*(){return _handleRequest$1(l,"PUT",c,h,p,d)}))}(this.fetch,`${this.url}/bucket/${l}`,{id:l,name:l,public:c.public,file_size_limit:c.fileSizeLimit,allowed_mime_types:c.allowedMimeTypes},{headers:this.headers});return{data:d,error:null}}catch(d){if(isStorageError(d))return{data:null,error:d};throw d}}))}emptyBucket(l){return __awaiter$4(this,void 0,void 0,(function*(){try{return{data:yield post(this.fetch,`${this.url}/bucket/${l}/empty`,{},{headers:this.headers}),error:null}}catch(c){if(isStorageError(c))return{data:null,error:c};throw c}}))}deleteBucket(l){return __awaiter$4(this,void 0,void 0,(function*(){try{return{data:yield remove(this.fetch,`${this.url}/bucket/${l}`,{},{headers:this.headers}),error:null}}catch(c){if(isStorageError(c))return{data:null,error:c};throw c}}))}}class StorageClient extends StorageBucketApi{constructor(l,c={},d){super(l,c,d)}from(l){return new StorageFileApi(this.url,this.headers,l,this.fetch)}}let rC="";rC="undefined"!=typeof Deno?"deno":"undefined"!=typeof document?"web":"undefined"!=typeof navigator&&"ReactNative"===navigator.product?"react-native":"node";const nC={headers:{"X-Client-Info":`supabase-js-${rC}/2.50.0`}},sC={schema:"public"},iC={autoRefreshToken:!0,persistSession:!0,detectSessionInUrl:!0,flowType:"implicit"},oC={};var __awaiter$3=function(l,c,d,h){return new(d||(d=Promise))((function(p,f){function fulfilled(l){try{step(h.next(l))}catch(hh){f(hh)}}function rejected(l){try{step(h.throw(l))}catch(hh){f(hh)}}function step(l){var c;l.done?p(l.value):(c=l.value,c instanceof d?c:new d((function(l){l(c)}))).then(fulfilled,rejected)}step((h=h.apply(l,c||[])).next())}))};const fetchWithAuth$1=(l,c,d)=>{const h=(l=>{let c;return c=l||("undefined"==typeof fetch?Vx:fetch),(...l)=>c(...l)})(d),p="undefined"==typeof Headers?Zx:Headers;return(d,f)=>__awaiter$3(void 0,void 0,void 0,(function*(){var m;const y=null!==(m=yield c())&&void 0!==m?m:l;let _=new p(null==f?void 0:f.headers);return _.has("apikey")||_.set("apikey",l),_.has("Authorization")||_.set("Authorization",`Bearer ${y}`),h(d,Object.assign(Object.assign({},f),{headers:_}))}))};var __awaiter$2=function(l,c,d,h){return new(d||(d=Promise))((function(p,f){function fulfilled(l){try{step(h.next(l))}catch(hh){f(hh)}}function rejected(l){try{step(h.throw(l))}catch(hh){f(hh)}}function step(l){var c;l.done?p(l.value):(c=l.value,c instanceof d?c:new d((function(l){l(c)}))).then(fulfilled,rejected)}step((h=h.apply(l,c||[])).next())}))};const aC="2.70.0",lC=3e4,cC=9e4,uC={"X-Client-Info":`gotrue-js/${aC}`},dC="X-Supabase-Api-Version",hC={timestamp:Date.parse("2024-01-01T00:00:00.0Z"),name:"2024-01-01"},pC=/^([a-z0-9_-]{4})*($|[a-z0-9_-]{3}$|[a-z0-9_-]{2}$)$/i;class AuthError extends Error{constructor(l,c,d){super(l),this.__isAuthError=!0,this.name="AuthError",this.status=c,this.code=d}}function isAuthError(l){return"object"==typeof l&&null!==l&&"__isAuthError"in l}class AuthApiError extends AuthError{constructor(l,c,d){super(l,c,d),this.name="AuthApiError",this.status=c,this.code=d}}class AuthUnknownError extends AuthError{constructor(l,c){super(l),this.name="AuthUnknownError",this.originalError=c}}class CustomAuthError extends AuthError{constructor(l,c,d,h){super(l,d,h),this.name=c,this.status=d}}class AuthSessionMissingError extends CustomAuthError{constructor(){super("Auth session missing!","AuthSessionMissingError",400,void 0)}}class AuthInvalidTokenResponseError extends CustomAuthError{constructor(){super("Auth session or user missing","AuthInvalidTokenResponseError",500,void 0)}}class AuthInvalidCredentialsError extends CustomAuthError{constructor(l){super(l,"AuthInvalidCredentialsError",400,void 0)}}class AuthImplicitGrantRedirectError extends CustomAuthError{constructor(l,c=null){super(l,"AuthImplicitGrantRedirectError",500,void 0),this.details=null,this.details=c}toJSON(){return{name:this.name,message:this.message,status:this.status,details:this.details}}}class AuthPKCEGrantCodeExchangeError extends CustomAuthError{constructor(l,c=null){super(l,"AuthPKCEGrantCodeExchangeError",500,void 0),this.details=null,this.details=c}toJSON(){return{name:this.name,message:this.message,status:this.status,details:this.details}}}class AuthRetryableFetchError extends CustomAuthError{constructor(l,c){super(l,"AuthRetryableFetchError",c,void 0)}}function isAuthRetryableFetchError(l){return isAuthError(l)&&"AuthRetryableFetchError"===l.name}class AuthWeakPasswordError extends CustomAuthError{constructor(l,c,d){super(l,"AuthWeakPasswordError",c,"weak_password"),this.reasons=d}}class AuthInvalidJwtError extends CustomAuthError{constructor(l){super(l,"AuthInvalidJwtError",400,"invalid_jwt")}}const fC="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_".split(""),mC=" \t\n\r=".split(""),gC=(()=>{const l=new Array(128);for(let c=0;c<l.length;c+=1)l[c]=-1;for(let c=0;c<mC.length;c+=1)l[mC[c].charCodeAt(0)]=-2;for(let c=0;c<fC.length;c+=1)l[fC[c].charCodeAt(0)]=c;return l})();function byteToBase64URL(l,c,d){if(null!==l)for(c.queue=c.queue<<8|l,c.queuedBits+=8;c.queuedBits>=6;){const l=c.queue>>c.queuedBits-6&63;d(fC[l]),c.queuedBits-=6}else if(c.queuedBits>0)for(c.queue=c.queue<<6-c.queuedBits,c.queuedBits=6;c.queuedBits>=6;){const l=c.queue>>c.queuedBits-6&63;d(fC[l]),c.queuedBits-=6}}function byteFromBase64URL(l,c,d){const h=gC[l];if(!(h>-1)){if(-2===h)return;throw new Error(`Invalid Base64-URL character "${String.fromCharCode(l)}"`)}for(c.queue=c.queue<<6|h,c.queuedBits+=6;c.queuedBits>=8;)d(c.queue>>c.queuedBits-8&255),c.queuedBits-=8}function stringFromBase64URL(l){const c=[],utf8Emit=l=>{c.push(String.fromCodePoint(l))},d={utf8seq:0,codepoint:0},h={queue:0,queuedBits:0},byteEmit=l=>{!function(l,c,d){if(0===c.utf8seq){if(l<=127)return void d(l);for(let d=1;d<6;d+=1)if(!(l>>7-d&1)){c.utf8seq=d;break}if(2===c.utf8seq)c.codepoint=31&l;else if(3===c.utf8seq)c.codepoint=15&l;else{if(4!==c.utf8seq)throw new Error("Invalid UTF-8 sequence");c.codepoint=7&l}c.utf8seq-=1}else if(c.utf8seq>0){if(l<=127)throw new Error("Invalid UTF-8 sequence");c.codepoint=c.codepoint<<6|63&l,c.utf8seq-=1,0===c.utf8seq&&d(c.codepoint)}}(l,d,utf8Emit)};for(let p=0;p<l.length;p+=1)byteFromBase64URL(l.charCodeAt(p),h,byteEmit);return c.join("")}function codepointToUTF8(l,c){if(!(l<=127)){if(l<=2047)return c(192|l>>6),void c(128|63&l);if(l<=65535)return c(224|l>>12),c(128|l>>6&63),void c(128|63&l);if(l<=1114111)return c(240|l>>18),c(128|l>>12&63),c(128|l>>6&63),void c(128|63&l);throw new Error(`Unrecognized Unicode codepoint: ${l.toString(16)}`)}c(l)}function base64UrlToUint8Array(l){const c=[],d={queue:0,queuedBits:0},onByte=l=>{c.push(l)};for(let h=0;h<l.length;h+=1)byteFromBase64URL(l.charCodeAt(h),d,onByte);return new Uint8Array(c)}function stringToUint8Array(l){const c=[];return function(l,c){for(let d=0;d<l.length;d+=1){let h=l.charCodeAt(d);if(h>55295&&h<=56319){const c=1024*(h-55296)&65535;h=65536+(l.charCodeAt(d+1)-56320&65535|c),d+=1}codepointToUTF8(h,c)}}(l,(l=>c.push(l))),new Uint8Array(c)}function bytesToBase64URL(l){const c=[],d={queue:0,queuedBits:0},onChar=l=>{c.push(l)};return l.forEach((l=>byteToBase64URL(l,d,onChar))),byteToBase64URL(null,d,onChar),c.join("")}const isBrowser=()=>"undefined"!=typeof window&&"undefined"!=typeof document,vC={tested:!1,writable:!1},supportsLocalStorage=()=>{if(!isBrowser())return!1;try{if("object"!=typeof globalThis.localStorage)return!1}catch(hh){return!1}if(vC.tested)return vC.writable;const l=`lswt-${Math.random()}${Math.random()}`;try{globalThis.localStorage.setItem(l,l),globalThis.localStorage.removeItem(l),vC.tested=!0,vC.writable=!0}catch(hh){vC.tested=!0,vC.writable=!1}return vC.writable};const resolveFetch=l=>{let c;return c=l||("undefined"==typeof fetch?(...l)=>__vitePreload((async()=>{const{default:l}=await Promise.resolve().then((()=>Jx));return{default:l}}),void 0).then((({default:c})=>c(...l))):fetch),(...l)=>c(...l)},setItemAsync=async(l,c,d)=>{await l.setItem(c,JSON.stringify(d))},getItemAsync=async(l,c)=>{const d=await l.getItem(c);if(!d)return null;try{return JSON.parse(d)}catch(h){return d}},removeItemAsync=async(l,c)=>{await l.removeItem(c)};class Deferred2{constructor(){this.promise=new Deferred2.promiseConstructor(((l,c)=>{this.resolve=l,this.reject=c}))}}function decodeJWT(l){const c=l.split(".");if(3!==c.length)throw new AuthInvalidJwtError("Invalid JWT structure");for(let d=0;d<c.length;d++)if(!pC.test(c[d]))throw new AuthInvalidJwtError("JWT not in base64url format");return{header:JSON.parse(stringFromBase64URL(c[0])),payload:JSON.parse(stringFromBase64URL(c[1])),signature:base64UrlToUint8Array(c[2]),raw:{header:c[0],payload:c[1]}}}function dec2hex(l){return("0"+l.toString(16)).substr(-2)}async function generatePKCEChallenge(l){if(!("undefined"!=typeof crypto&&void 0!==crypto.subtle&&"undefined"!=typeof TextEncoder))return console.warn("WebCrypto API is not supported. Code challenge method will default to use plain instead of sha256."),l;const c=await async function(l){const c=(new TextEncoder).encode(l),d=await crypto.subtle.digest("SHA-256",c),h=new Uint8Array(d);return Array.from(h).map((l=>String.fromCharCode(l))).join("")}(l);return btoa(c).replace(/\+/g,"-").replace(/\//g,"_").replace(/=+$/,"")}async function getCodeChallengeAndMethod(l,c,d=!1){const h=function(){const l=new Uint32Array(56);if("undefined"==typeof crypto){const l="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-._~",c=l.length;let d="";for(let h=0;h<56;h++)d+=l.charAt(Math.floor(Math.random()*c));return d}return crypto.getRandomValues(l),Array.from(l,dec2hex).join("")}();let p=h;d&&(p+="/PASSWORD_RECOVERY"),await setItemAsync(l,`${c}-code-verifier`,p);const f=await generatePKCEChallenge(h);return[f,h===f?"plain":"s256"]}Deferred2.promiseConstructor=Promise;const yC=/^2[0-9]{3}-(0[1-9]|1[0-2])-(0[1-9]|1[0-9]|2[0-9]|3[0-1])$/i;const _C=/^[0-9a-f]{8}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{12}$/;function validateUUID(l){if(!_C.test(l))throw new Error("@supabase/auth-js: Expected parameter to be UUID but is not")}const _getErrorMessage=l=>l.msg||l.message||l.error_description||l.error||JSON.stringify(l),bC=[502,503,504];async function handleError(l){var c,d;if(!("object"==typeof(d=l)&&null!==d&&"status"in d&&"ok"in d&&"json"in d&&"function"==typeof d.json))throw new AuthRetryableFetchError(_getErrorMessage(l),0);if(bC.includes(l.status))throw new AuthRetryableFetchError(_getErrorMessage(l),l.status);let h,p;try{h=await l.json()}catch(hh){throw new AuthUnknownError(_getErrorMessage(hh),hh)}const f=function(l){const c=l.headers.get(dC);if(!c)return null;if(!c.match(yC))return null;try{return new Date(`${c}T00:00:00.0Z`)}catch(hh){return null}}(l);if(f&&f.getTime()>=hC.timestamp&&"object"==typeof h&&h&&"string"==typeof h.code?p=h.code:"object"==typeof h&&h&&"string"==typeof h.error_code&&(p=h.error_code),p){if("weak_password"===p)throw new AuthWeakPasswordError(_getErrorMessage(h),l.status,(null===(c=h.weak_password)||void 0===c?void 0:c.reasons)||[]);if("session_not_found"===p)throw new AuthSessionMissingError}else if("object"==typeof h&&h&&"object"==typeof h.weak_password&&h.weak_password&&Array.isArray(h.weak_password.reasons)&&h.weak_password.reasons.length&&h.weak_password.reasons.reduce(((l,c)=>l&&"string"==typeof c),!0))throw new AuthWeakPasswordError(_getErrorMessage(h),l.status,h.weak_password.reasons);throw new AuthApiError(_getErrorMessage(h),l.status||500,p)}async function _request(l,c,d,h){var p;const f=Object.assign({},null==h?void 0:h.headers);f[dC]||(f[dC]=hC.name),(null==h?void 0:h.jwt)&&(f.Authorization=`Bearer ${h.jwt}`);const m=null!==(p=null==h?void 0:h.query)&&void 0!==p?p:{};(null==h?void 0:h.redirectTo)&&(m.redirect_to=h.redirectTo);const y=Object.keys(m).length?"?"+new URLSearchParams(m).toString():"",_=await async function(l,c,d,h,p,f){const m=((l,c,d,h)=>{const p={method:l,headers:(null==c?void 0:c.headers)||{}};return"GET"===l?p:(p.headers=Object.assign({"Content-Type":"application/json;charset=UTF-8"},null==c?void 0:c.headers),p.body=JSON.stringify(h),Object.assign(Object.assign({},p),d))})(c,h,p,f);let y;try{y=await l(d,Object.assign({},m))}catch(hh){throw console.error(hh),new AuthRetryableFetchError(_getErrorMessage(hh),0)}y.ok||await handleError(y);if(null==h?void 0:h.noResolveJson)return y;try{return await y.json()}catch(hh){await handleError(hh)}}(l,c,d+y,{headers:f,noResolveJson:null==h?void 0:h.noResolveJson},{},null==h?void 0:h.body);return(null==h?void 0:h.xform)?null==h?void 0:h.xform(_):{data:Object.assign({},_),error:null}}function _sessionResponse(l){var c;let d=null;var h;(function(l){return l.access_token&&l.refresh_token&&l.expires_in})(l)&&(d=Object.assign({},l),l.expires_at||(d.expires_at=(h=l.expires_in,Math.round(Date.now()/1e3)+h)));return{data:{session:d,user:null!==(c=l.user)&&void 0!==c?c:l},error:null}}function _sessionResponsePassword(l){const c=_sessionResponse(l);return!c.error&&l.weak_password&&"object"==typeof l.weak_password&&Array.isArray(l.weak_password.reasons)&&l.weak_password.reasons.length&&l.weak_password.message&&"string"==typeof l.weak_password.message&&l.weak_password.reasons.reduce(((l,c)=>l&&"string"==typeof c),!0)&&(c.data.weak_password=l.weak_password),c}function _userResponse(l){var c;return{data:{user:null!==(c=l.user)&&void 0!==c?c:l},error:null}}function _ssoResponse(l){return{data:l,error:null}}function _generateLinkResponse(l){const{action_link:c,email_otp:d,hashed_token:h,redirect_to:p,verification_type:f}=l,m=function(l,c){var d={};for(var h in l)Object.prototype.hasOwnProperty.call(l,h)&&c.indexOf(h)<0&&(d[h]=l[h]);if(null!=l&&"function"==typeof Object.getOwnPropertySymbols){var p=0;for(h=Object.getOwnPropertySymbols(l);p<h.length;p++)c.indexOf(h[p])<0&&Object.prototype.propertyIsEnumerable.call(l,h[p])&&(d[h[p]]=l[h[p]])}return d}(l,["action_link","email_otp","hashed_token","redirect_to","verification_type"]);return{data:{properties:{action_link:c,email_otp:d,hashed_token:h,redirect_to:p,verification_type:f},user:Object.assign({},m)},error:null}}function _noResolveJsonResponse(l){return l}const wC=["global","local","others"];class GoTrueAdminApi{constructor({url:l="",headers:c={},fetch:d}){this.url=l,this.headers=c,this.fetch=resolveFetch(d),this.mfa={listFactors:this._listFactors.bind(this),deleteFactor:this._deleteFactor.bind(this)}}async signOut(l,c=wC[0]){if(wC.indexOf(c)<0)throw new Error(`@supabase/auth-js: Parameter scope must be one of ${wC.join(", ")}`);try{return await _request(this.fetch,"POST",`${this.url}/logout?scope=${c}`,{headers:this.headers,jwt:l,noResolveJson:!0}),{data:null,error:null}}catch(d){if(isAuthError(d))return{data:null,error:d};throw d}}async inviteUserByEmail(l,c={}){try{return await _request(this.fetch,"POST",`${this.url}/invite`,{body:{email:l,data:c.data},headers:this.headers,redirectTo:c.redirectTo,xform:_userResponse})}catch(d){if(isAuthError(d))return{data:{user:null},error:d};throw d}}async generateLink(l){try{const{options:c}=l,d=function(l,c){var d={};for(var h in l)Object.prototype.hasOwnProperty.call(l,h)&&c.indexOf(h)<0&&(d[h]=l[h]);if(null!=l&&"function"==typeof Object.getOwnPropertySymbols){var p=0;for(h=Object.getOwnPropertySymbols(l);p<h.length;p++)c.indexOf(h[p])<0&&Object.prototype.propertyIsEnumerable.call(l,h[p])&&(d[h[p]]=l[h[p]])}return d}(l,["options"]),h=Object.assign(Object.assign({},d),c);return"newEmail"in d&&(h.new_email=null==d?void 0:d.newEmail,delete h.newEmail),await _request(this.fetch,"POST",`${this.url}/admin/generate_link`,{body:h,headers:this.headers,xform:_generateLinkResponse,redirectTo:null==c?void 0:c.redirectTo})}catch(c){if(isAuthError(c))return{data:{properties:null,user:null},error:c};throw c}}async createUser(l){try{return await _request(this.fetch,"POST",`${this.url}/admin/users`,{body:l,headers:this.headers,xform:_userResponse})}catch(c){if(isAuthError(c))return{data:{user:null},error:c};throw c}}async listUsers(l){var c,d,h,p,f,m,y;try{const _={nextPage:null,lastPage:0,total:0},b=await _request(this.fetch,"GET",`${this.url}/admin/users`,{headers:this.headers,noResolveJson:!0,query:{page:null!==(d=null===(c=null==l?void 0:l.page)||void 0===c?void 0:c.toString())&&void 0!==d?d:"",per_page:null!==(p=null===(h=null==l?void 0:l.perPage)||void 0===h?void 0:h.toString())&&void 0!==p?p:""},xform:_noResolveJsonResponse});if(b.error)throw b.error;const w=await b.json(),E=null!==(f=b.headers.get("x-total-count"))&&void 0!==f?f:0,M=null!==(y=null===(m=b.headers.get("link"))||void 0===m?void 0:m.split(","))&&void 0!==y?y:[];return M.length>0&&(M.forEach((l=>{const c=parseInt(l.split(";")[0].split("=")[1].substring(0,1)),d=JSON.parse(l.split(";")[1].split("=")[1]);_[`${d}Page`]=c})),_.total=parseInt(E)),{data:Object.assign(Object.assign({},w),_),error:null}}catch(_){if(isAuthError(_))return{data:{users:[]},error:_};throw _}}async getUserById(l){validateUUID(l);try{return await _request(this.fetch,"GET",`${this.url}/admin/users/${l}`,{headers:this.headers,xform:_userResponse})}catch(c){if(isAuthError(c))return{data:{user:null},error:c};throw c}}async updateUserById(l,c){validateUUID(l);try{return await _request(this.fetch,"PUT",`${this.url}/admin/users/${l}`,{body:c,headers:this.headers,xform:_userResponse})}catch(d){if(isAuthError(d))return{data:{user:null},error:d};throw d}}async deleteUser(l,c=!1){validateUUID(l);try{return await _request(this.fetch,"DELETE",`${this.url}/admin/users/${l}`,{headers:this.headers,body:{should_soft_delete:c},xform:_userResponse})}catch(d){if(isAuthError(d))return{data:{user:null},error:d};throw d}}async _listFactors(l){validateUUID(l.userId);try{const{data:c,error:d}=await _request(this.fetch,"GET",`${this.url}/admin/users/${l.userId}/factors`,{headers:this.headers,xform:l=>({data:{factors:l},error:null})});return{data:c,error:d}}catch(c){if(isAuthError(c))return{data:null,error:c};throw c}}async _deleteFactor(l){validateUUID(l.userId),validateUUID(l.id);try{return{data:await _request(this.fetch,"DELETE",`${this.url}/admin/users/${l.userId}/factors/${l.id}`,{headers:this.headers}),error:null}}catch(c){if(isAuthError(c))return{data:null,error:c};throw c}}}const SC={getItem:l=>supportsLocalStorage()?globalThis.localStorage.getItem(l):null,setItem:(l,c)=>{supportsLocalStorage()&&globalThis.localStorage.setItem(l,c)},removeItem:l=>{supportsLocalStorage()&&globalThis.localStorage.removeItem(l)}};function memoryLocalStorageAdapter(l={}){return{getItem:c=>l[c]||null,setItem:(c,d)=>{l[c]=d},removeItem:c=>{delete l[c]}}}const xC=!!(globalThis&&supportsLocalStorage()&&globalThis.localStorage&&"true"===globalThis.localStorage.getItem("supabase.gotrue-js.locks.debug"));class LockAcquireTimeoutError extends Error{constructor(l){super(l),this.isAcquireTimeout=!0}}class NavigatorLockAcquireTimeoutError extends LockAcquireTimeoutError{}async function navigatorLock(l,c,d){xC&&console.log("@supabase/gotrue-js: navigatorLock: acquire lock",l,c);const h=new globalThis.AbortController;return c>0&&setTimeout((()=>{h.abort(),xC&&console.log("@supabase/gotrue-js: navigatorLock acquire timed out",l)}),c),await Promise.resolve().then((()=>globalThis.navigator.locks.request(l,0===c?{mode:"exclusive",ifAvailable:!0}:{mode:"exclusive",signal:h.signal},(async h=>{if(!h){if(0===c)throw xC&&console.log("@supabase/gotrue-js: navigatorLock: not immediately available",l),new NavigatorLockAcquireTimeoutError(`Acquiring an exclusive Navigator LockManager lock "${l}" immediately failed`);if(xC)try{const l=await globalThis.navigator.locks.query();console.log("@supabase/gotrue-js: Navigator LockManager state",JSON.stringify(l,null,"  "))}catch(hh){console.warn("@supabase/gotrue-js: Error when querying Navigator LockManager state",hh)}return console.warn("@supabase/gotrue-js: Navigator LockManager returned a null lock when using #request without ifAvailable set to true, it appears this browser is not following the LockManager spec https://developer.mozilla.org/en-US/docs/Web/API/LockManager/request"),await d()}xC&&console.log("@supabase/gotrue-js: navigatorLock: acquired",l,h.name);try{return await d()}finally{xC&&console.log("@supabase/gotrue-js: navigatorLock: released",l,h.name)}}))))}!function(){if("object"!=typeof globalThis)try{Object.defineProperty(Object.prototype,"__magic__",{get:function(){return this},configurable:!0}),__magic__.globalThis=__magic__,delete Object.prototype.__magic__}catch(hh){"undefined"!=typeof self&&(self.globalThis=self)}}();const kC={url:"http://localhost:9999",storageKey:"supabase.auth.token",autoRefreshToken:!0,persistSession:!0,detectSessionInUrl:!0,headers:uC,flowType:"implicit",debug:!1,hasCustomAuthorizationHeader:!1};async function lockNoOp(l,c,d){return await d()}class GoTrueClient{constructor(l){var c,d;this.memoryStorage=null,this.stateChangeEmitters=new Map,this.autoRefreshTicker=null,this.visibilityChangedCallback=null,this.refreshingDeferred=null,this.initializePromise=null,this.detectSessionInUrl=!0,this.hasCustomAuthorizationHeader=!1,this.suppressGetSessionWarning=!1,this.lockAcquired=!1,this.pendingInLock=[],this.broadcastChannel=null,this.logger=console.log,this.instanceID=GoTrueClient.nextInstanceID,GoTrueClient.nextInstanceID+=1,this.instanceID>0&&isBrowser()&&console.warn("Multiple GoTrueClient instances detected in the same browser context. It is not an error, but this should be avoided as it may produce undefined behavior when used concurrently under the same storage key.");const h=Object.assign(Object.assign({},kC),l);if(this.logDebugMessages=!!h.debug,"function"==typeof h.debug&&(this.logger=h.debug),this.persistSession=h.persistSession,this.storageKey=h.storageKey,this.autoRefreshToken=h.autoRefreshToken,this.admin=new GoTrueAdminApi({url:h.url,headers:h.headers,fetch:h.fetch}),this.url=h.url,this.headers=h.headers,this.fetch=resolveFetch(h.fetch),this.lock=h.lock||lockNoOp,this.detectSessionInUrl=h.detectSessionInUrl,this.flowType=h.flowType,this.hasCustomAuthorizationHeader=h.hasCustomAuthorizationHeader,h.lock?this.lock=h.lock:isBrowser()&&(null===(c=null===globalThis||void 0===globalThis?void 0:globalThis.navigator)||void 0===c?void 0:c.locks)?this.lock=navigatorLock:this.lock=lockNoOp,this.jwks={keys:[]},this.jwks_cached_at=Number.MIN_SAFE_INTEGER,this.mfa={verify:this._verify.bind(this),enroll:this._enroll.bind(this),unenroll:this._unenroll.bind(this),challenge:this._challenge.bind(this),listFactors:this._listFactors.bind(this),challengeAndVerify:this._challengeAndVerify.bind(this),getAuthenticatorAssuranceLevel:this._getAuthenticatorAssuranceLevel.bind(this)},this.persistSession?h.storage?this.storage=h.storage:supportsLocalStorage()?this.storage=SC:(this.memoryStorage={},this.storage=memoryLocalStorageAdapter(this.memoryStorage)):(this.memoryStorage={},this.storage=memoryLocalStorageAdapter(this.memoryStorage)),isBrowser()&&globalThis.BroadcastChannel&&this.persistSession&&this.storageKey){try{this.broadcastChannel=new globalThis.BroadcastChannel(this.storageKey)}catch(hh){console.error("Failed to create a new BroadcastChannel, multi-tab state changes will not be available",hh)}null===(d=this.broadcastChannel)||void 0===d||d.addEventListener("message",(async l=>{this._debug("received broadcast notification from other tab or client",l),await this._notifyAllSubscribers(l.data.event,l.data.session,!1)}))}this.initialize()}_debug(...l){return this.logDebugMessages&&this.logger(`GoTrueClient@${this.instanceID} (${aC}) ${(new Date).toISOString()}`,...l),this}async initialize(){return this.initializePromise||(this.initializePromise=(async()=>await this._acquireLock(-1,(async()=>await this._initialize())))()),await this.initializePromise}async _initialize(){var l;try{const c=function(l){const c={},d=new URL(l);if(d.hash&&"#"===d.hash[0])try{new URLSearchParams(d.hash.substring(1)).forEach(((l,d)=>{c[d]=l}))}catch(hh){}return d.searchParams.forEach(((l,d)=>{c[d]=l})),c}(window.location.href);let d="none";if(this._isImplicitGrantCallback(c)?d="implicit":await this._isPKCECallback(c)&&(d="pkce"),isBrowser()&&this.detectSessionInUrl&&"none"!==d){const{data:h,error:p}=await this._getSessionFromURL(c,d);if(p){if(this._debug("#_initialize()","error detecting session from URL",p),function(l){return isAuthError(l)&&"AuthImplicitGrantRedirectError"===l.name}(p)){const c=null===(l=p.details)||void 0===l?void 0:l.code;if("identity_already_exists"===c||"identity_not_found"===c||"single_identity_not_deletable"===c)return{error:p}}return await this._removeSession(),{error:p}}const{session:f,redirectType:m}=h;return this._debug("#_initialize()","detected session in URL",f,"redirect type",m),await this._saveSession(f),setTimeout((async()=>{"recovery"===m?await this._notifyAllSubscribers("PASSWORD_RECOVERY",f):await this._notifyAllSubscribers("SIGNED_IN",f)}),0),{error:null}}return await this._recoverAndRefresh(),{error:null}}catch(c){return isAuthError(c)?{error:c}:{error:new AuthUnknownError("Unexpected error during initialization",c)}}finally{await this._handleVisibilityChange(),this._debug("#_initialize()","end")}}async signInAnonymously(l){var c,d,h;try{const p=await _request(this.fetch,"POST",`${this.url}/signup`,{headers:this.headers,body:{data:null!==(d=null===(c=null==l?void 0:l.options)||void 0===c?void 0:c.data)&&void 0!==d?d:{},gotrue_meta_security:{captcha_token:null===(h=null==l?void 0:l.options)||void 0===h?void 0:h.captchaToken}},xform:_sessionResponse}),{data:f,error:m}=p;if(m||!f)return{data:{user:null,session:null},error:m};const y=f.session,_=f.user;return f.session&&(await this._saveSession(f.session),await this._notifyAllSubscribers("SIGNED_IN",y)),{data:{user:_,session:y},error:null}}catch(p){if(isAuthError(p))return{data:{user:null,session:null},error:p};throw p}}async signUp(l){var c,d,h;try{let p;if("email"in l){const{email:d,password:h,options:f}=l;let m=null,y=null;"pkce"===this.flowType&&([m,y]=await getCodeChallengeAndMethod(this.storage,this.storageKey)),p=await _request(this.fetch,"POST",`${this.url}/signup`,{headers:this.headers,redirectTo:null==f?void 0:f.emailRedirectTo,body:{email:d,password:h,data:null!==(c=null==f?void 0:f.data)&&void 0!==c?c:{},gotrue_meta_security:{captcha_token:null==f?void 0:f.captchaToken},code_challenge:m,code_challenge_method:y},xform:_sessionResponse})}else{if(!("phone"in l))throw new AuthInvalidCredentialsError("You must provide either an email or phone number and a password");{const{phone:c,password:f,options:m}=l;p=await _request(this.fetch,"POST",`${this.url}/signup`,{headers:this.headers,body:{phone:c,password:f,data:null!==(d=null==m?void 0:m.data)&&void 0!==d?d:{},channel:null!==(h=null==m?void 0:m.channel)&&void 0!==h?h:"sms",gotrue_meta_security:{captcha_token:null==m?void 0:m.captchaToken}},xform:_sessionResponse})}}const{data:f,error:m}=p;if(m||!f)return{data:{user:null,session:null},error:m};const y=f.session,_=f.user;return f.session&&(await this._saveSession(f.session),await this._notifyAllSubscribers("SIGNED_IN",y)),{data:{user:_,session:y},error:null}}catch(p){if(isAuthError(p))return{data:{user:null,session:null},error:p};throw p}}async signInWithPassword(l){try{let c;if("email"in l){const{email:d,password:h,options:p}=l;c=await _request(this.fetch,"POST",`${this.url}/token?grant_type=password`,{headers:this.headers,body:{email:d,password:h,gotrue_meta_security:{captcha_token:null==p?void 0:p.captchaToken}},xform:_sessionResponsePassword})}else{if(!("phone"in l))throw new AuthInvalidCredentialsError("You must provide either an email or phone number and a password");{const{phone:d,password:h,options:p}=l;c=await _request(this.fetch,"POST",`${this.url}/token?grant_type=password`,{headers:this.headers,body:{phone:d,password:h,gotrue_meta_security:{captcha_token:null==p?void 0:p.captchaToken}},xform:_sessionResponsePassword})}}const{data:d,error:h}=c;return h?{data:{user:null,session:null},error:h}:d&&d.session&&d.user?(d.session&&(await this._saveSession(d.session),await this._notifyAllSubscribers("SIGNED_IN",d.session)),{data:Object.assign({user:d.user,session:d.session},d.weak_password?{weakPassword:d.weak_password}:null),error:h}):{data:{user:null,session:null},error:new AuthInvalidTokenResponseError}}catch(c){if(isAuthError(c))return{data:{user:null,session:null},error:c};throw c}}async signInWithOAuth(l){var c,d,h,p;return await this._handleProviderSignIn(l.provider,{redirectTo:null===(c=l.options)||void 0===c?void 0:c.redirectTo,scopes:null===(d=l.options)||void 0===d?void 0:d.scopes,queryParams:null===(h=l.options)||void 0===h?void 0:h.queryParams,skipBrowserRedirect:null===(p=l.options)||void 0===p?void 0:p.skipBrowserRedirect})}async exchangeCodeForSession(l){return await this.initializePromise,this._acquireLock(-1,(async()=>this._exchangeCodeForSession(l)))}async signInWithWeb3(l){const{chain:c}=l;if("solana"===c)return await this.signInWithSolana(l);throw new Error(`@supabase/auth-js: Unsupported chain "${c}"`)}async signInWithSolana(l){var c,d,h,p,f,m,y,_,b,w,E,M;let N,P;if("message"in l)N=l.message,P=l.signature;else{const{chain:E,wallet:M,statement:L,options:j}=l;let D;if(isBrowser())if("object"==typeof M)D=M;else{const l=window;if(!("solana"in l)||"object"!=typeof l.solana||!("signIn"in l.solana&&"function"==typeof l.solana.signIn||"signMessage"in l.solana&&"function"==typeof l.solana.signMessage))throw new Error("@supabase/auth-js: No compatible Solana wallet interface on the window object (window.solana) detected. Make sure the user already has a wallet installed and connected for this app. Prefer passing the wallet interface object directly to signInWithWeb3({ chain: 'solana', wallet: resolvedUserWallet }) instead.");D=l.solana}else{if("object"!=typeof M||!(null==j?void 0:j.url))throw new Error("@supabase/auth-js: Both wallet and url must be specified in non-browser environments.");D=M}const F=new URL(null!==(c=null==j?void 0:j.url)&&void 0!==c?c:window.location.href);if("signIn"in D&&D.signIn){const l=await D.signIn(Object.assign(Object.assign(Object.assign({issuedAt:(new Date).toISOString()},null==j?void 0:j.signInWithSolana),{version:"1",domain:F.host,uri:F.href}),L?{statement:L}:null));let c;if(Array.isArray(l)&&l[0]&&"object"==typeof l[0])c=l[0];else{if(!(l&&"object"==typeof l&&"signedMessage"in l&&"signature"in l))throw new Error("@supabase/auth-js: Wallet method signIn() returned unrecognized value");c=l}if(!("signedMessage"in c&&"signature"in c&&("string"==typeof c.signedMessage||c.signedMessage instanceof Uint8Array)&&c.signature instanceof Uint8Array))throw new Error("@supabase/auth-js: Wallet method signIn() API returned object without signedMessage and signature fields");N="string"==typeof c.signedMessage?c.signedMessage:(new TextDecoder).decode(c.signedMessage),P=c.signature}else{if(!("signMessage"in D&&"function"==typeof D.signMessage&&"publicKey"in D&&"object"==typeof D&&D.publicKey&&"toBase58"in D.publicKey&&"function"==typeof D.publicKey.toBase58))throw new Error("@supabase/auth-js: Wallet does not have a compatible signMessage() and publicKey.toBase58() API");N=[`${F.host} wants you to sign in with your Solana account:`,D.publicKey.toBase58(),...L?["",L,""]:[""],"Version: 1",`URI: ${F.href}`,`Issued At: ${null!==(h=null===(d=null==j?void 0:j.signInWithSolana)||void 0===d?void 0:d.issuedAt)&&void 0!==h?h:(new Date).toISOString()}`,...(null===(p=null==j?void 0:j.signInWithSolana)||void 0===p?void 0:p.notBefore)?[`Not Before: ${j.signInWithSolana.notBefore}`]:[],...(null===(f=null==j?void 0:j.signInWithSolana)||void 0===f?void 0:f.expirationTime)?[`Expiration Time: ${j.signInWithSolana.expirationTime}`]:[],...(null===(m=null==j?void 0:j.signInWithSolana)||void 0===m?void 0:m.chainId)?[`Chain ID: ${j.signInWithSolana.chainId}`]:[],...(null===(y=null==j?void 0:j.signInWithSolana)||void 0===y?void 0:y.nonce)?[`Nonce: ${j.signInWithSolana.nonce}`]:[],...(null===(_=null==j?void 0:j.signInWithSolana)||void 0===_?void 0:_.requestId)?[`Request ID: ${j.signInWithSolana.requestId}`]:[],...(null===(w=null===(b=null==j?void 0:j.signInWithSolana)||void 0===b?void 0:b.resources)||void 0===w?void 0:w.length)?["Resources",...j.signInWithSolana.resources.map((l=>`- ${l}`))]:[]].join("\n");const l=await D.signMessage((new TextEncoder).encode(N),"utf8");if(!(l&&l instanceof Uint8Array))throw new Error("@supabase/auth-js: Wallet signMessage() API returned an recognized value");P=l}}try{const{data:c,error:d}=await _request(this.fetch,"POST",`${this.url}/token?grant_type=web3`,{headers:this.headers,body:Object.assign({chain:"solana",message:N,signature:bytesToBase64URL(P)},(null===(E=l.options)||void 0===E?void 0:E.captchaToken)?{gotrue_meta_security:{captcha_token:null===(M=l.options)||void 0===M?void 0:M.captchaToken}}:null),xform:_sessionResponse});if(d)throw d;return c&&c.session&&c.user?(c.session&&(await this._saveSession(c.session),await this._notifyAllSubscribers("SIGNED_IN",c.session)),{data:Object.assign({},c),error:d}):{data:{user:null,session:null},error:new AuthInvalidTokenResponseError}}catch(L){if(isAuthError(L))return{data:{user:null,session:null},error:L};throw L}}async _exchangeCodeForSession(l){const c=await getItemAsync(this.storage,`${this.storageKey}-code-verifier`),[d,h]=(null!=c?c:"").split("/");try{const{data:c,error:p}=await _request(this.fetch,"POST",`${this.url}/token?grant_type=pkce`,{headers:this.headers,body:{auth_code:l,code_verifier:d},xform:_sessionResponse});if(await removeItemAsync(this.storage,`${this.storageKey}-code-verifier`),p)throw p;return c&&c.session&&c.user?(c.session&&(await this._saveSession(c.session),await this._notifyAllSubscribers("SIGNED_IN",c.session)),{data:Object.assign(Object.assign({},c),{redirectType:null!=h?h:null}),error:p}):{data:{user:null,session:null,redirectType:null},error:new AuthInvalidTokenResponseError}}catch(p){if(isAuthError(p))return{data:{user:null,session:null,redirectType:null},error:p};throw p}}async signInWithIdToken(l){try{const{options:c,provider:d,token:h,access_token:p,nonce:f}=l,m=await _request(this.fetch,"POST",`${this.url}/token?grant_type=id_token`,{headers:this.headers,body:{provider:d,id_token:h,access_token:p,nonce:f,gotrue_meta_security:{captcha_token:null==c?void 0:c.captchaToken}},xform:_sessionResponse}),{data:y,error:_}=m;return _?{data:{user:null,session:null},error:_}:y&&y.session&&y.user?(y.session&&(await this._saveSession(y.session),await this._notifyAllSubscribers("SIGNED_IN",y.session)),{data:y,error:_}):{data:{user:null,session:null},error:new AuthInvalidTokenResponseError}}catch(c){if(isAuthError(c))return{data:{user:null,session:null},error:c};throw c}}async signInWithOtp(l){var c,d,h,p,f;try{if("email"in l){const{email:h,options:p}=l;let f=null,m=null;"pkce"===this.flowType&&([f,m]=await getCodeChallengeAndMethod(this.storage,this.storageKey));const{error:y}=await _request(this.fetch,"POST",`${this.url}/otp`,{headers:this.headers,body:{email:h,data:null!==(c=null==p?void 0:p.data)&&void 0!==c?c:{},create_user:null===(d=null==p?void 0:p.shouldCreateUser)||void 0===d||d,gotrue_meta_security:{captcha_token:null==p?void 0:p.captchaToken},code_challenge:f,code_challenge_method:m},redirectTo:null==p?void 0:p.emailRedirectTo});return{data:{user:null,session:null},error:y}}if("phone"in l){const{phone:c,options:d}=l,{data:m,error:y}=await _request(this.fetch,"POST",`${this.url}/otp`,{headers:this.headers,body:{phone:c,data:null!==(h=null==d?void 0:d.data)&&void 0!==h?h:{},create_user:null===(p=null==d?void 0:d.shouldCreateUser)||void 0===p||p,gotrue_meta_security:{captcha_token:null==d?void 0:d.captchaToken},channel:null!==(f=null==d?void 0:d.channel)&&void 0!==f?f:"sms"}});return{data:{user:null,session:null,messageId:null==m?void 0:m.message_id},error:y}}throw new AuthInvalidCredentialsError("You must provide either an email or phone number.")}catch(m){if(isAuthError(m))return{data:{user:null,session:null},error:m};throw m}}async verifyOtp(l){var c,d;try{let h,p;"options"in l&&(h=null===(c=l.options)||void 0===c?void 0:c.redirectTo,p=null===(d=l.options)||void 0===d?void 0:d.captchaToken);const{data:f,error:m}=await _request(this.fetch,"POST",`${this.url}/verify`,{headers:this.headers,body:Object.assign(Object.assign({},l),{gotrue_meta_security:{captcha_token:p}}),redirectTo:h,xform:_sessionResponse});if(m)throw m;if(!f)throw new Error("An error occurred on token verification.");const y=f.session,_=f.user;return(null==y?void 0:y.access_token)&&(await this._saveSession(y),await this._notifyAllSubscribers("recovery"==l.type?"PASSWORD_RECOVERY":"SIGNED_IN",y)),{data:{user:_,session:y},error:null}}catch(h){if(isAuthError(h))return{data:{user:null,session:null},error:h};throw h}}async signInWithSSO(l){var c,d,h;try{let p=null,f=null;return"pkce"===this.flowType&&([p,f]=await getCodeChallengeAndMethod(this.storage,this.storageKey)),await _request(this.fetch,"POST",`${this.url}/sso`,{body:Object.assign(Object.assign(Object.assign(Object.assign(Object.assign({},"providerId"in l?{provider_id:l.providerId}:null),"domain"in l?{domain:l.domain}:null),{redirect_to:null!==(d=null===(c=l.options)||void 0===c?void 0:c.redirectTo)&&void 0!==d?d:void 0}),(null===(h=null==l?void 0:l.options)||void 0===h?void 0:h.captchaToken)?{gotrue_meta_security:{captcha_token:l.options.captchaToken}}:null),{skip_http_redirect:!0,code_challenge:p,code_challenge_method:f}),headers:this.headers,xform:_ssoResponse})}catch(p){if(isAuthError(p))return{data:null,error:p};throw p}}async reauthenticate(){return await this.initializePromise,await this._acquireLock(-1,(async()=>await this._reauthenticate()))}async _reauthenticate(){try{return await this._useSession((async l=>{const{data:{session:c},error:d}=l;if(d)throw d;if(!c)throw new AuthSessionMissingError;const{error:h}=await _request(this.fetch,"GET",`${this.url}/reauthenticate`,{headers:this.headers,jwt:c.access_token});return{data:{user:null,session:null},error:h}}))}catch(l){if(isAuthError(l))return{data:{user:null,session:null},error:l};throw l}}async resend(l){try{const c=`${this.url}/resend`;if("email"in l){const{email:d,type:h,options:p}=l,{error:f}=await _request(this.fetch,"POST",c,{headers:this.headers,body:{email:d,type:h,gotrue_meta_security:{captcha_token:null==p?void 0:p.captchaToken}},redirectTo:null==p?void 0:p.emailRedirectTo});return{data:{user:null,session:null},error:f}}if("phone"in l){const{phone:d,type:h,options:p}=l,{data:f,error:m}=await _request(this.fetch,"POST",c,{headers:this.headers,body:{phone:d,type:h,gotrue_meta_security:{captcha_token:null==p?void 0:p.captchaToken}}});return{data:{user:null,session:null,messageId:null==f?void 0:f.message_id},error:m}}throw new AuthInvalidCredentialsError("You must provide either an email or phone number and a type")}catch(c){if(isAuthError(c))return{data:{user:null,session:null},error:c};throw c}}async getSession(){await this.initializePromise;return await this._acquireLock(-1,(async()=>this._useSession((async l=>l))))}async _acquireLock(l,c){this._debug("#_acquireLock","begin",l);try{if(this.lockAcquired){const l=this.pendingInLock.length?this.pendingInLock[this.pendingInLock.length-1]:Promise.resolve(),d=(async()=>(await l,await c()))();return this.pendingInLock.push((async()=>{try{await d}catch(hh){}})()),d}return await this.lock(`lock:${this.storageKey}`,l,(async()=>{this._debug("#_acquireLock","lock acquired for storage key",this.storageKey);try{this.lockAcquired=!0;const l=c();for(this.pendingInLock.push((async()=>{try{await l}catch(hh){}})()),await l;this.pendingInLock.length;){const l=[...this.pendingInLock];await Promise.all(l),this.pendingInLock.splice(0,l.length)}return await l}finally{this._debug("#_acquireLock","lock released for storage key",this.storageKey),this.lockAcquired=!1}}))}finally{this._debug("#_acquireLock","end")}}async _useSession(l){this._debug("#_useSession","begin");try{const c=await this.__loadSession();return await l(c)}finally{this._debug("#_useSession","end")}}async __loadSession(){this._debug("#__loadSession()","begin"),this.lockAcquired||this._debug("#__loadSession()","used outside of an acquired lock!",(new Error).stack);try{let l=null;const c=await getItemAsync(this.storage,this.storageKey);if(this._debug("#getSession()","session from storage",c),null!==c&&(this._isValidSession(c)?l=c:(this._debug("#getSession()","session from storage is not valid"),await this._removeSession())),!l)return{data:{session:null},error:null};const d=!!l.expires_at&&1e3*l.expires_at-Date.now()<cC;if(this._debug("#__loadSession()",`session has${d?"":" not"} expired`,"expires_at",l.expires_at),!d){if(this.storage.isServer){let c=this.suppressGetSessionWarning;l=new Proxy(l,{get:(l,d,h)=>(c||"user"!==d||(console.warn("Using the user object as returned from supabase.auth.getSession() or from some supabase.auth.onAuthStateChange() events could be insecure! This value comes directly from the storage medium (usually cookies on the server) and may not be authentic. Use supabase.auth.getUser() instead which authenticates the data by contacting the Supabase Auth server."),c=!0,this.suppressGetSessionWarning=!0),Reflect.get(l,d,h))})}return{data:{session:l},error:null}}const{session:h,error:p}=await this._callRefreshToken(l.refresh_token);return p?{data:{session:null},error:p}:{data:{session:h},error:null}}finally{this._debug("#__loadSession()","end")}}async getUser(l){if(l)return await this._getUser(l);await this.initializePromise;return await this._acquireLock(-1,(async()=>await this._getUser()))}async _getUser(l){try{return l?await _request(this.fetch,"GET",`${this.url}/user`,{headers:this.headers,jwt:l,xform:_userResponse}):await this._useSession((async l=>{var c,d,h;const{data:p,error:f}=l;if(f)throw f;return(null===(c=p.session)||void 0===c?void 0:c.access_token)||this.hasCustomAuthorizationHeader?await _request(this.fetch,"GET",`${this.url}/user`,{headers:this.headers,jwt:null!==(h=null===(d=p.session)||void 0===d?void 0:d.access_token)&&void 0!==h?h:void 0,xform:_userResponse}):{data:{user:null},error:new AuthSessionMissingError}}))}catch(c){if(isAuthError(c))return function(l){return isAuthError(l)&&"AuthSessionMissingError"===l.name}(c)&&(await this._removeSession(),await removeItemAsync(this.storage,`${this.storageKey}-code-verifier`)),{data:{user:null},error:c};throw c}}async updateUser(l,c={}){return await this.initializePromise,await this._acquireLock(-1,(async()=>await this._updateUser(l,c)))}async _updateUser(l,c={}){try{return await this._useSession((async d=>{const{data:h,error:p}=d;if(p)throw p;if(!h.session)throw new AuthSessionMissingError;const f=h.session;let m=null,y=null;"pkce"===this.flowType&&null!=l.email&&([m,y]=await getCodeChallengeAndMethod(this.storage,this.storageKey));const{data:_,error:b}=await _request(this.fetch,"PUT",`${this.url}/user`,{headers:this.headers,redirectTo:null==c?void 0:c.emailRedirectTo,body:Object.assign(Object.assign({},l),{code_challenge:m,code_challenge_method:y}),jwt:f.access_token,xform:_userResponse});if(b)throw b;return f.user=_.user,await this._saveSession(f),await this._notifyAllSubscribers("USER_UPDATED",f),{data:{user:f.user},error:null}}))}catch(d){if(isAuthError(d))return{data:{user:null},error:d};throw d}}async setSession(l){return await this.initializePromise,await this._acquireLock(-1,(async()=>await this._setSession(l)))}async _setSession(l){try{if(!l.access_token||!l.refresh_token)throw new AuthSessionMissingError;const c=Date.now()/1e3;let d=c,h=!0,p=null;const{payload:f}=decodeJWT(l.access_token);if(f.exp&&(d=f.exp,h=d<=c),h){const{session:c,error:d}=await this._callRefreshToken(l.refresh_token);if(d)return{data:{user:null,session:null},error:d};if(!c)return{data:{user:null,session:null},error:null};p=c}else{const{data:h,error:f}=await this._getUser(l.access_token);if(f)throw f;p={access_token:l.access_token,refresh_token:l.refresh_token,user:h.user,token_type:"bearer",expires_in:d-c,expires_at:d},await this._saveSession(p),await this._notifyAllSubscribers("SIGNED_IN",p)}return{data:{user:p.user,session:p},error:null}}catch(c){if(isAuthError(c))return{data:{session:null,user:null},error:c};throw c}}async refreshSession(l){return await this.initializePromise,await this._acquireLock(-1,(async()=>await this._refreshSession(l)))}async _refreshSession(l){try{return await this._useSession((async c=>{var d;if(!l){const{data:h,error:p}=c;if(p)throw p;l=null!==(d=h.session)&&void 0!==d?d:void 0}if(!(null==l?void 0:l.refresh_token))throw new AuthSessionMissingError;const{session:h,error:p}=await this._callRefreshToken(l.refresh_token);return p?{data:{user:null,session:null},error:p}:h?{data:{user:h.user,session:h},error:null}:{data:{user:null,session:null},error:null}}))}catch(c){if(isAuthError(c))return{data:{user:null,session:null},error:c};throw c}}async _getSessionFromURL(l,c){try{if(!isBrowser())throw new AuthImplicitGrantRedirectError("No browser detected.");if(l.error||l.error_description||l.error_code)throw new AuthImplicitGrantRedirectError(l.error_description||"Error in URL with unspecified error_description",{error:l.error||"unspecified_error",code:l.error_code||"unspecified_code"});switch(c){case"implicit":if("pkce"===this.flowType)throw new AuthPKCEGrantCodeExchangeError("Not a valid PKCE flow url.");break;case"pkce":if("implicit"===this.flowType)throw new AuthImplicitGrantRedirectError("Not a valid implicit grant flow url.")}if("pkce"===c){if(this._debug("#_initialize()","begin","is PKCE flow",!0),!l.code)throw new AuthPKCEGrantCodeExchangeError("No code detected.");const{data:c,error:d}=await this._exchangeCodeForSession(l.code);if(d)throw d;const h=new URL(window.location.href);return h.searchParams.delete("code"),window.history.replaceState(window.history.state,"",h.toString()),{data:{session:c.session,redirectType:null},error:null}}const{provider_token:d,provider_refresh_token:h,access_token:p,refresh_token:f,expires_in:m,expires_at:y,token_type:_}=l;if(!(p&&m&&f&&_))throw new AuthImplicitGrantRedirectError("No session defined in URL");const b=Math.round(Date.now()/1e3),w=parseInt(m);let E=b+w;y&&(E=parseInt(y));const M=E-b;1e3*M<=lC&&console.warn(`@supabase/gotrue-js: Session as retrieved from URL expires in ${M}s, should have been closer to ${w}s`);const N=E-w;b-N>=120?console.warn("@supabase/gotrue-js: Session as retrieved from URL was issued over 120s ago, URL could be stale",N,E,b):b-N<0&&console.warn("@supabase/gotrue-js: Session as retrieved from URL was issued in the future? Check the device clock for skew",N,E,b);const{data:P,error:L}=await this._getUser(p);if(L)throw L;const j={provider_token:d,provider_refresh_token:h,access_token:p,expires_in:w,expires_at:E,refresh_token:f,token_type:_,user:P.user};return window.location.hash="",this._debug("#_getSessionFromURL()","clearing window.location.hash"),{data:{session:j,redirectType:l.type},error:null}}catch(d){if(isAuthError(d))return{data:{session:null,redirectType:null},error:d};throw d}}_isImplicitGrantCallback(l){return Boolean(l.access_token||l.error_description)}async _isPKCECallback(l){const c=await getItemAsync(this.storage,`${this.storageKey}-code-verifier`);return!(!l.code||!c)}async signOut(l={scope:"global"}){return await this.initializePromise,await this._acquireLock(-1,(async()=>await this._signOut(l)))}async _signOut({scope:l}={scope:"global"}){return await this._useSession((async c=>{var d;const{data:h,error:p}=c;if(p)return{error:p};const f=null===(d=h.session)||void 0===d?void 0:d.access_token;if(f){const{error:c}=await this.admin.signOut(f,l);if(c&&(!function(l){return isAuthError(l)&&"AuthApiError"===l.name}(c)||404!==c.status&&401!==c.status&&403!==c.status))return{error:c}}return"others"!==l&&(await this._removeSession(),await removeItemAsync(this.storage,`${this.storageKey}-code-verifier`)),{error:null}}))}onAuthStateChange(l){const c="xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,(function(l){const c=16*Math.random()|0;return("x"==l?c:3&c|8).toString(16)})),d={id:c,callback:l,unsubscribe:()=>{this._debug("#unsubscribe()","state change callback with id removed",c),this.stateChangeEmitters.delete(c)}};return this._debug("#onAuthStateChange()","registered callback with id",c),this.stateChangeEmitters.set(c,d),(async()=>{await this.initializePromise,await this._acquireLock(-1,(async()=>{this._emitInitialSession(c)}))})(),{data:{subscription:d}}}async _emitInitialSession(l){return await this._useSession((async c=>{var d,h;try{const{data:{session:h},error:p}=c;if(p)throw p;await(null===(d=this.stateChangeEmitters.get(l))||void 0===d?void 0:d.callback("INITIAL_SESSION",h)),this._debug("INITIAL_SESSION","callback id",l,"session",h)}catch(p){await(null===(h=this.stateChangeEmitters.get(l))||void 0===h?void 0:h.callback("INITIAL_SESSION",null)),this._debug("INITIAL_SESSION","callback id",l,"error",p),console.error(p)}}))}async resetPasswordForEmail(l,c={}){let d=null,h=null;"pkce"===this.flowType&&([d,h]=await getCodeChallengeAndMethod(this.storage,this.storageKey,!0));try{return await _request(this.fetch,"POST",`${this.url}/recover`,{body:{email:l,code_challenge:d,code_challenge_method:h,gotrue_meta_security:{captcha_token:c.captchaToken}},headers:this.headers,redirectTo:c.redirectTo})}catch(p){if(isAuthError(p))return{data:null,error:p};throw p}}async getUserIdentities(){var l;try{const{data:c,error:d}=await this.getUser();if(d)throw d;return{data:{identities:null!==(l=c.user.identities)&&void 0!==l?l:[]},error:null}}catch(c){if(isAuthError(c))return{data:null,error:c};throw c}}async linkIdentity(l){var c;try{const{data:d,error:h}=await this._useSession((async c=>{var d,h,p,f,m;const{data:y,error:_}=c;if(_)throw _;const b=await this._getUrlForProvider(`${this.url}/user/identities/authorize`,l.provider,{redirectTo:null===(d=l.options)||void 0===d?void 0:d.redirectTo,scopes:null===(h=l.options)||void 0===h?void 0:h.scopes,queryParams:null===(p=l.options)||void 0===p?void 0:p.queryParams,skipBrowserRedirect:!0});return await _request(this.fetch,"GET",b,{headers:this.headers,jwt:null!==(m=null===(f=y.session)||void 0===f?void 0:f.access_token)&&void 0!==m?m:void 0})}));if(h)throw h;return isBrowser()&&!(null===(c=l.options)||void 0===c?void 0:c.skipBrowserRedirect)&&window.location.assign(null==d?void 0:d.url),{data:{provider:l.provider,url:null==d?void 0:d.url},error:null}}catch(d){if(isAuthError(d))return{data:{provider:l.provider,url:null},error:d};throw d}}async unlinkIdentity(l){try{return await this._useSession((async c=>{var d,h;const{data:p,error:f}=c;if(f)throw f;return await _request(this.fetch,"DELETE",`${this.url}/user/identities/${l.identity_id}`,{headers:this.headers,jwt:null!==(h=null===(d=p.session)||void 0===d?void 0:d.access_token)&&void 0!==h?h:void 0})}))}catch(c){if(isAuthError(c))return{data:null,error:c};throw c}}async _refreshAccessToken(l){const c=`#_refreshAccessToken(${l.substring(0,5)}...)`;this._debug(c,"begin");try{const d=Date.now();return await function(l,c){const d=new Promise(((d,h)=>{(async()=>{for(let p=0;p<1/0;p++)try{const h=await l(p);if(!c(p,null,h))return void d(h)}catch(hh){if(!c(p,hh))return void h(hh)}})()}));return d}((async d=>(d>0&&await async function(l){return await new Promise((c=>{setTimeout((()=>c(null)),l)}))}(200*Math.pow(2,d-1)),this._debug(c,"refreshing attempt",d),await _request(this.fetch,"POST",`${this.url}/token?grant_type=refresh_token`,{body:{refresh_token:l},headers:this.headers,xform:_sessionResponse}))),((l,c)=>{const h=200*Math.pow(2,l);return c&&isAuthRetryableFetchError(c)&&Date.now()+h-d<lC}))}catch(d){if(this._debug(c,"error",d),isAuthError(d))return{data:{session:null,user:null},error:d};throw d}finally{this._debug(c,"end")}}_isValidSession(l){return"object"==typeof l&&null!==l&&"access_token"in l&&"refresh_token"in l&&"expires_at"in l}async _handleProviderSignIn(l,c){const d=await this._getUrlForProvider(`${this.url}/authorize`,l,{redirectTo:c.redirectTo,scopes:c.scopes,queryParams:c.queryParams});return this._debug("#_handleProviderSignIn()","provider",l,"options",c,"url",d),isBrowser()&&!c.skipBrowserRedirect&&window.location.assign(d),{data:{provider:l,url:d},error:null}}async _recoverAndRefresh(){var l;const c="#_recoverAndRefresh()";this._debug(c,"begin");try{const d=await getItemAsync(this.storage,this.storageKey);if(this._debug(c,"session from storage",d),!this._isValidSession(d))return this._debug(c,"session is not valid"),void(null!==d&&await this._removeSession());const h=1e3*(null!==(l=d.expires_at)&&void 0!==l?l:1/0)-Date.now()<cC;if(this._debug(c,`session has${h?"":" not"} expired with margin of 90000s`),h){if(this.autoRefreshToken&&d.refresh_token){const{error:l}=await this._callRefreshToken(d.refresh_token);l&&(console.error(l),isAuthRetryableFetchError(l)||(this._debug(c,"refresh failed with a non-retryable error, removing the session",l),await this._removeSession()))}}else await this._notifyAllSubscribers("SIGNED_IN",d)}catch(d){return this._debug(c,"error",d),void console.error(d)}finally{this._debug(c,"end")}}async _callRefreshToken(l){var c,d;if(!l)throw new AuthSessionMissingError;if(this.refreshingDeferred)return this.refreshingDeferred.promise;const h=`#_callRefreshToken(${l.substring(0,5)}...)`;this._debug(h,"begin");try{this.refreshingDeferred=new Deferred2;const{data:c,error:d}=await this._refreshAccessToken(l);if(d)throw d;if(!c.session)throw new AuthSessionMissingError;await this._saveSession(c.session),await this._notifyAllSubscribers("TOKEN_REFRESHED",c.session);const h={session:c.session,error:null};return this.refreshingDeferred.resolve(h),h}catch(p){if(this._debug(h,"error",p),isAuthError(p)){const l={session:null,error:p};return isAuthRetryableFetchError(p)||await this._removeSession(),null===(c=this.refreshingDeferred)||void 0===c||c.resolve(l),l}throw null===(d=this.refreshingDeferred)||void 0===d||d.reject(p),p}finally{this.refreshingDeferred=null,this._debug(h,"end")}}async _notifyAllSubscribers(l,c,d=!0){const h=`#_notifyAllSubscribers(${l})`;this._debug(h,"begin",c,`broadcast = ${d}`);try{this.broadcastChannel&&d&&this.broadcastChannel.postMessage({event:l,session:c});const h=[],p=Array.from(this.stateChangeEmitters.values()).map((async d=>{try{await d.callback(l,c)}catch(hh){h.push(hh)}}));if(await Promise.all(p),h.length>0){for(let l=0;l<h.length;l+=1)console.error(h[l]);throw h[0]}}finally{this._debug(h,"end")}}async _saveSession(l){this._debug("#_saveSession()",l),this.suppressGetSessionWarning=!0,await setItemAsync(this.storage,this.storageKey,l)}async _removeSession(){this._debug("#_removeSession()"),await removeItemAsync(this.storage,this.storageKey),await this._notifyAllSubscribers("SIGNED_OUT",null)}_removeVisibilityChangedCallback(){this._debug("#_removeVisibilityChangedCallback()");const l=this.visibilityChangedCallback;this.visibilityChangedCallback=null;try{l&&isBrowser()&&(null===window||void 0===window?void 0:window.removeEventListener)&&window.removeEventListener("visibilitychange",l)}catch(hh){console.error("removing visibilitychange callback failed",hh)}}async _startAutoRefresh(){await this._stopAutoRefresh(),this._debug("#_startAutoRefresh()");const l=setInterval((()=>this._autoRefreshTokenTick()),lC);this.autoRefreshTicker=l,l&&"object"==typeof l&&"function"==typeof l.unref?l.unref():"undefined"!=typeof Deno&&"function"==typeof Deno.unrefTimer&&Deno.unrefTimer(l),setTimeout((async()=>{await this.initializePromise,await this._autoRefreshTokenTick()}),0)}async _stopAutoRefresh(){this._debug("#_stopAutoRefresh()");const l=this.autoRefreshTicker;this.autoRefreshTicker=null,l&&clearInterval(l)}async startAutoRefresh(){this._removeVisibilityChangedCallback(),await this._startAutoRefresh()}async stopAutoRefresh(){this._removeVisibilityChangedCallback(),await this._stopAutoRefresh()}async _autoRefreshTokenTick(){this._debug("#_autoRefreshTokenTick()","begin");try{await this._acquireLock(0,(async()=>{try{const l=Date.now();try{return await this._useSession((async c=>{const{data:{session:d}}=c;if(!d||!d.refresh_token||!d.expires_at)return void this._debug("#_autoRefreshTokenTick()","no session");const h=Math.floor((1e3*d.expires_at-l)/lC);this._debug("#_autoRefreshTokenTick()",`access token expires in ${h} ticks, a tick lasts 30000ms, refresh threshold is 3 ticks`),h<=3&&await this._callRefreshToken(d.refresh_token)}))}catch(hh){console.error("Auto refresh tick failed with error. This is likely a transient error.",hh)}}finally{this._debug("#_autoRefreshTokenTick()","end")}}))}catch(hh){if(!(hh.isAcquireTimeout||hh instanceof LockAcquireTimeoutError))throw hh;this._debug("auto refresh token tick lock not available")}}async _handleVisibilityChange(){if(this._debug("#_handleVisibilityChange()"),!isBrowser()||!(null===window||void 0===window?void 0:window.addEventListener))return this.autoRefreshToken&&this.startAutoRefresh(),!1;try{this.visibilityChangedCallback=async()=>await this._onVisibilityChanged(!1),null===window||void 0===window||window.addEventListener("visibilitychange",this.visibilityChangedCallback),await this._onVisibilityChanged(!0)}catch(l){console.error("_handleVisibilityChange",l)}}async _onVisibilityChanged(l){const c=`#_onVisibilityChanged(${l})`;this._debug(c,"visibilityState",document.visibilityState),"visible"===document.visibilityState?(this.autoRefreshToken&&this._startAutoRefresh(),l||(await this.initializePromise,await this._acquireLock(-1,(async()=>{"visible"===document.visibilityState?await this._recoverAndRefresh():this._debug(c,"acquired the lock to recover the session, but the browser visibilityState is no longer visible, aborting")})))):"hidden"===document.visibilityState&&this.autoRefreshToken&&this._stopAutoRefresh()}async _getUrlForProvider(l,c,d){const h=[`provider=${encodeURIComponent(c)}`];if((null==d?void 0:d.redirectTo)&&h.push(`redirect_to=${encodeURIComponent(d.redirectTo)}`),(null==d?void 0:d.scopes)&&h.push(`scopes=${encodeURIComponent(d.scopes)}`),"pkce"===this.flowType){const[l,c]=await getCodeChallengeAndMethod(this.storage,this.storageKey),d=new URLSearchParams({code_challenge:`${encodeURIComponent(l)}`,code_challenge_method:`${encodeURIComponent(c)}`});h.push(d.toString())}if(null==d?void 0:d.queryParams){const l=new URLSearchParams(d.queryParams);h.push(l.toString())}return(null==d?void 0:d.skipBrowserRedirect)&&h.push(`skip_http_redirect=${d.skipBrowserRedirect}`),`${l}?${h.join("&")}`}async _unenroll(l){try{return await this._useSession((async c=>{var d;const{data:h,error:p}=c;return p?{data:null,error:p}:await _request(this.fetch,"DELETE",`${this.url}/factors/${l.factorId}`,{headers:this.headers,jwt:null===(d=null==h?void 0:h.session)||void 0===d?void 0:d.access_token})}))}catch(c){if(isAuthError(c))return{data:null,error:c};throw c}}async _enroll(l){try{return await this._useSession((async c=>{var d,h;const{data:p,error:f}=c;if(f)return{data:null,error:f};const m=Object.assign({friendly_name:l.friendlyName,factor_type:l.factorType},"phone"===l.factorType?{phone:l.phone}:{issuer:l.issuer}),{data:y,error:_}=await _request(this.fetch,"POST",`${this.url}/factors`,{body:m,headers:this.headers,jwt:null===(d=null==p?void 0:p.session)||void 0===d?void 0:d.access_token});return _?{data:null,error:_}:("totp"===l.factorType&&(null===(h=null==y?void 0:y.totp)||void 0===h?void 0:h.qr_code)&&(y.totp.qr_code=`data:image/svg+xml;utf-8,${y.totp.qr_code}`),{data:y,error:null})}))}catch(c){if(isAuthError(c))return{data:null,error:c};throw c}}async _verify(l){return this._acquireLock(-1,(async()=>{try{return await this._useSession((async c=>{var d;const{data:h,error:p}=c;if(p)return{data:null,error:p};const{data:f,error:m}=await _request(this.fetch,"POST",`${this.url}/factors/${l.factorId}/verify`,{body:{code:l.code,challenge_id:l.challengeId},headers:this.headers,jwt:null===(d=null==h?void 0:h.session)||void 0===d?void 0:d.access_token});return m?{data:null,error:m}:(await this._saveSession(Object.assign({expires_at:Math.round(Date.now()/1e3)+f.expires_in},f)),await this._notifyAllSubscribers("MFA_CHALLENGE_VERIFIED",f),{data:f,error:m})}))}catch(c){if(isAuthError(c))return{data:null,error:c};throw c}}))}async _challenge(l){return this._acquireLock(-1,(async()=>{try{return await this._useSession((async c=>{var d;const{data:h,error:p}=c;return p?{data:null,error:p}:await _request(this.fetch,"POST",`${this.url}/factors/${l.factorId}/challenge`,{body:{channel:l.channel},headers:this.headers,jwt:null===(d=null==h?void 0:h.session)||void 0===d?void 0:d.access_token})}))}catch(c){if(isAuthError(c))return{data:null,error:c};throw c}}))}async _challengeAndVerify(l){const{data:c,error:d}=await this._challenge({factorId:l.factorId});return d?{data:null,error:d}:await this._verify({factorId:l.factorId,challengeId:c.id,code:l.code})}async _listFactors(){const{data:{user:l},error:c}=await this.getUser();if(c)return{data:null,error:c};const d=(null==l?void 0:l.factors)||[],h=d.filter((l=>"totp"===l.factor_type&&"verified"===l.status)),p=d.filter((l=>"phone"===l.factor_type&&"verified"===l.status));return{data:{all:d,totp:h,phone:p},error:null}}async _getAuthenticatorAssuranceLevel(){return this._acquireLock(-1,(async()=>await this._useSession((async l=>{var c,d;const{data:{session:h},error:p}=l;if(p)return{data:null,error:p};if(!h)return{data:{currentLevel:null,nextLevel:null,currentAuthenticationMethods:[]},error:null};const{payload:f}=decodeJWT(h.access_token);let m=null;f.aal&&(m=f.aal);let y=m;(null!==(d=null===(c=h.user.factors)||void 0===c?void 0:c.filter((l=>"verified"===l.status)))&&void 0!==d?d:[]).length>0&&(y="aal2");return{data:{currentLevel:m,nextLevel:y,currentAuthenticationMethods:f.amr||[]},error:null}}))))}async fetchJwk(l,c={keys:[]}){let d=c.keys.find((c=>c.kid===l));if(d)return d;if(d=this.jwks.keys.find((c=>c.kid===l)),d&&this.jwks_cached_at+6e5>Date.now())return d;const{data:h,error:p}=await _request(this.fetch,"GET",`${this.url}/.well-known/jwks.json`,{headers:this.headers});if(p)throw p;if(!h.keys||0===h.keys.length)throw new AuthInvalidJwtError("JWKS is empty");if(this.jwks=h,this.jwks_cached_at=Date.now(),d=h.keys.find((c=>c.kid===l)),!d)throw new AuthInvalidJwtError("No matching signing key found in JWKS");return d}async getClaims(l,c={keys:[]}){try{let d=l;if(!d){const{data:l,error:c}=await this.getSession();if(c||!l.session)return{data:null,error:c};d=l.session.access_token}const{header:h,payload:p,signature:f,raw:{header:m,payload:y}}=decodeJWT(d);if(function(l){if(!l)throw new Error("Missing exp claim");if(l<=Math.floor(Date.now()/1e3))throw new Error("JWT has expired")}(p.exp),!h.kid||"HS256"===h.alg||!("crypto"in globalThis)||!("subtle"in globalThis.crypto)){const{error:l}=await this.getUser(d);if(l)throw l;return{data:{claims:p,header:h,signature:f},error:null}}const _=function(l){switch(l){case"RS256":return{name:"RSASSA-PKCS1-v1_5",hash:{name:"SHA-256"}};case"ES256":return{name:"ECDSA",namedCurve:"P-256",hash:{name:"SHA-256"}};default:throw new Error("Invalid alg claim")}}(h.alg),b=await this.fetchJwk(h.kid,c),w=await crypto.subtle.importKey("jwk",b,_,!0,["verify"]);if(!(await crypto.subtle.verify(_,w,f,stringToUint8Array(`${m}.${y}`))))throw new AuthInvalidJwtError("Invalid JWT signature");return{data:{claims:p,header:h,signature:f},error:null}}catch(d){if(isAuthError(d))return{data:null,error:d};throw d}}}GoTrueClient.nextInstanceID=0;const CC=GoTrueClient;class SupabaseAuthClient extends CC{constructor(l){super(l)}}var __awaiter$1=function(l,c,d,h){return new(d||(d=Promise))((function(p,f){function fulfilled(l){try{step(h.next(l))}catch(hh){f(hh)}}function rejected(l){try{step(h.throw(l))}catch(hh){f(hh)}}function step(l){var c;l.done?p(l.value):(c=l.value,c instanceof d?c:new d((function(l){l(c)}))).then(fulfilled,rejected)}step((h=h.apply(l,c||[])).next())}))};class SupabaseClient{constructor(l,c,d){var h,p,f;if(this.supabaseUrl=l,this.supabaseKey=c,!l)throw new Error("supabaseUrl is required.");if(!c)throw new Error("supabaseKey is required.");const m=(y=l).endsWith("/")?y:y+"/";var y;const _=new URL(m);this.realtimeUrl=new URL("realtime/v1",_),this.realtimeUrl.protocol=this.realtimeUrl.protocol.replace("http","ws"),this.authUrl=new URL("auth/v1",_),this.storageUrl=new URL("storage/v1",_),this.functionsUrl=new URL("functions/v1",_);const b=`sb-${_.hostname.split(".")[0]}-auth-token`,w=function(l,c){var d,h;const{db:p,auth:f,realtime:m,global:y}=l,{db:_,auth:b,realtime:w,global:E}=c,M={db:Object.assign(Object.assign({},_),p),auth:Object.assign(Object.assign({},b),f),realtime:Object.assign(Object.assign({},w),m),global:Object.assign(Object.assign(Object.assign({},E),y),{headers:Object.assign(Object.assign({},null!==(d=null==E?void 0:E.headers)&&void 0!==d?d:{}),null!==(h=null==y?void 0:y.headers)&&void 0!==h?h:{})}),accessToken:()=>__awaiter$2(this,void 0,void 0,(function*(){return""}))};return l.accessToken?M.accessToken=l.accessToken:delete M.accessToken,M}(null!=d?d:{},{db:sC,realtime:oC,auth:Object.assign(Object.assign({},iC),{storageKey:b}),global:nC});this.storageKey=null!==(h=w.auth.storageKey)&&void 0!==h?h:"",this.headers=null!==(p=w.global.headers)&&void 0!==p?p:{},w.accessToken?(this.accessToken=w.accessToken,this.auth=new Proxy({},{get:(l,c)=>{throw new Error(`@supabase/supabase-js: Supabase Client is configured with the accessToken option, accessing supabase.auth.${String(c)} is not possible`)}})):this.auth=this._initSupabaseAuthClient(null!==(f=w.auth)&&void 0!==f?f:{},this.headers,w.global.fetch),this.fetch=fetchWithAuth$1(c,this._getAccessToken.bind(this),w.global.fetch),this.realtime=this._initRealtimeClient(Object.assign({headers:this.headers,accessToken:this._getAccessToken.bind(this)},w.realtime)),this.rest=new Ek(new URL("rest/v1",_).href,{headers:this.headers,schema:w.db.schema,fetch:this.fetch}),w.accessToken||this._listenForAuthEvents()}get functions(){return new FunctionsClient(this.functionsUrl.href,{headers:this.headers,customFetch:this.fetch})}get storage(){return new StorageClient(this.storageUrl.href,this.headers,this.fetch)}from(l){return this.rest.from(l)}schema(l){return this.rest.schema(l)}rpc(l,c={},d={}){return this.rest.rpc(l,c,d)}channel(l,c={config:{}}){return this.realtime.channel(l,c)}getChannels(){return this.realtime.getChannels()}removeChannel(l){return this.realtime.removeChannel(l)}removeAllChannels(){return this.realtime.removeAllChannels()}_getAccessToken(){var l,c;return __awaiter$1(this,void 0,void 0,(function*(){if(this.accessToken)return yield this.accessToken();const{data:d}=yield this.auth.getSession();return null!==(c=null===(l=d.session)||void 0===l?void 0:l.access_token)&&void 0!==c?c:null}))}_initSupabaseAuthClient({autoRefreshToken:l,persistSession:c,detectSessionInUrl:d,storage:h,storageKey:p,flowType:f,lock:m,debug:y},_,b){const w={Authorization:`Bearer ${this.supabaseKey}`,apikey:`${this.supabaseKey}`};return new SupabaseAuthClient({url:this.authUrl.href,headers:Object.assign(Object.assign({},w),_),storageKey:p,autoRefreshToken:l,persistSession:c,detectSessionInUrl:d,storage:h,flowType:f,lock:m,debug:y,fetch:b,hasCustomAuthorizationHeader:"Authorization"in this.headers})}_initRealtimeClient(l){return new RealtimeClient(this.realtimeUrl.href,Object.assign(Object.assign({},l),{params:Object.assign({apikey:this.supabaseKey},null==l?void 0:l.params)}))}_listenForAuthEvents(){return this.auth.onAuthStateChange(((l,c)=>{this._handleTokenChanged(l,"CLIENT",null==c?void 0:c.access_token)}))}_handleTokenChanged(l,c,d){"TOKEN_REFRESHED"!==l&&"SIGNED_IN"!==l||this.changedAccessToken===d?"SIGNED_OUT"===l&&(this.realtime.setAuth(),"STORAGE"==c&&this.auth.signOut(),this.changedAccessToken=void 0):this.changedAccessToken=d}}const EC=new SupabaseClient("https://hjixgelewamnsxkczpxm.supabase.co","eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6ImhqaXhnZWxld2FtbnN4a2N6cHhtIiwicm9sZSI6ImFub24iLCJpYXQiOjE2OTk5NTUwMzQsImV4cCI6MjAxNTUzMTAzNH0.5nt5lV5HJ3xoRC-ijWnzsKTL-ufM7fpcOyZ8MEL1ljg",{auth:{flowType:"implicit"}});const fetchWithAuth=async(l,c)=>{const{data:{session:d}}=await EC.auth.getSession();if(d){const h=d.access_token,p=d.user?.email;if(!h)throw await EC.auth.signOut(),new Error("Invalid access token");return c||(c={}),c.headers||(c.headers={}),c.headers={...c.headers??{},Authorization:`Bearer ${h}`,"ngrok-skip-browser-warning":"true","App-Id":p??"","User-Email":p??"","Client-Id":"dashboard"},await fetch(l,c)}return c||(c={}),c.headers||(c.headers={}),c.headers={...c.headers??{},"Client-Id":"dashboard"},await fetch(l,c)},fetchConfirmitConfig=async()=>{const l=Array.isArray(IC.api_url)?(l=>{if(Array.isArray(l)&&0!==l.length)try{const c=window.location.href,d=l.find((l=>{try{const d=new URL(l).hostname,h=new URL(c).hostname;return h.includes(d)||d.includes(h)}catch{return!1}}));return d||l[0]}catch(c){return console.error("\u274c [validateAndGetApiUrl] Error validating API URL:",c),l[0]}})(IC.api_url):IC.api_url;if(!l)throw new Error("No valid API URL found in configuration");const c=`${l}/document_to_survey_convertor/extension/confirmit-config`;try{const l=await fetchWithAuth(c,{method:"GET",headers:{"Content-Type":"application/json"}});if(!l.ok)throw console.error("\u274c [fetchConfirmitConfig] API request failed with status:",l.status),new Error(`Failed to fetch confirmit config: ${l.status}`);return await l.json()}catch(d){throw console.error("\u274c [fetchConfirmitConfig] API request error:",d),d}},useConfirmitConfig=()=>{const l=useQuery({queryKey:["confirmit-config"],queryFn:fetchConfirmitConfig,staleTime:18e5,refetchInterval:18e5,refetchOnWindowFocus:!0,retry:3,retryDelay:l=>{const c=Math.min(1e3*2**l,3e4);return console.log(`\ud83d\udd04 [useConfirmitConfig] Retry attempt ${l+1}, delay: ${c}ms`),c},refetchOnMount:!0,enabled:!0});return l.data,l.error&&console.log("\u274c [useConfirmitConfig] Current error:",l.error),Yt.useEffect((()=>{if(l.isSuccess&&l.data){l.data.confirmit_base_url&&(async l=>{if("string"==typeof l)return l;if(!Array.isArray(l)||0===l.length)return"";if(1===l.length)return l[0];try{const{browser:c}=await __vitePreload((async()=>{const{browser:l}=await import("./types-E3Sm3O4A.js").then((l=>l.n));return{browser:l}}),__vite__mapDeps([0,1])),[d]=await c.tabs.query({active:!0,currentWindow:!0});if(!d?.url)return l[0];const h=d.url,p=new URL(h).hostname;return l.find((l=>{try{const c=new URL(l).hostname;return p===c}catch{return!1}}))||l[0]}catch(c){return console.error("\u274c [selectConfirmitBaseUrl] Error selecting URL:",c),l[0]}})(l.data.confirmit_base_url).then((l=>{IC.confirmit_base_url=l}));const d={confirmit_base_url:l.data.confirmit_base_url,timestamp:Date.now()};try{__vitePreload((async()=>{const{browser:l}=await import("./types-E3Sm3O4A.js").then((l=>l.n));return{browser:l}}),__vite__mapDeps([0,1])).then((({browser:l})=>{l.storage.local.set({confirmit_config:d}).then((()=>{})).catch((l=>{console.error("\u274c [useConfirmitConfig] Failed to update extension local storage:",l)}))}))}catch(c){console.error("\u274c [useConfirmitConfig] Failed to import browser API:",c)}}}),[l.isSuccess,l.data]),Yt.useEffect((()=>{l.isError&&l.error&&(console.error("\u274c [useConfirmitConfig] Query failed with error:",l.error),vo.error("Failed to load confirmit configuration"))}),[l.isError,l.error]),l},IC={websocket_url:"wss://api.qa.metaforms.ai/www",api_url:"https://api.qa.metaforms.ai/www",confirmit_base_url:"",features:{chat:!0,assistant:!0}};function updateConfigFromCache(){if("undefined"==typeof window)return!1;try{const l=sessionStorage.getItem("confirmit_config");if(l){const{confirmit_base_url:c,timestamp:d}=JSON.parse(l),h=Date.now()-d;Math.floor(h/6e4);if(c){const l=function(l){if("string"==typeof l)return l;if(!Array.isArray(l)||0===l.length)return"";if(1===l.length)return l[0];try{const c=window.location.hostname,d=l.find((l=>{try{return new URL(l).hostname===c}catch{return!1}}));if(d)return d}catch(c){}return l[0]}(c);return IC.confirmit_base_url=l,!0}}}catch(l){console.error("\u274c [updateConfigFromCache] Failed to update config from cache:",l)}return console.log("\u274c [updateConfigFromCache] Update failed"),!1}"undefined"!=typeof window&&("loading"===document.readyState?document.addEventListener("DOMContentLoaded",(()=>{updateConfigFromCache()})):updateConfigFromCache()),"undefined"!=typeof window&&(window.debugConfirmitConfig=function(){const l=sessionStorage?.getItem?.("confirmit_config");if(l)try{const c=JSON.parse(l),d=Date.now()-c.timestamp;Math.floor(d/6e4)}catch(hh){console.error("\u274c [debugConfirmitConfig] Parse error:",hh)}});const normalizeUrl=l=>{try{const c=l.startsWith("https")?l:`https://${l}`,d=new URL(c);let h=d.hostname.toLowerCase();return h.startsWith("www.")&&(h=h.slice(4)),`${d.protocol}//${h}`}catch{return null}},isConfirmitDomain=l=>{try{const c=IC.confirmit_base_url;if(!c)return console.warn("[isConfirmitDomain]",{error:"No Confirmit base URL configured"}),!1;const d=normalizeUrl(c),h=normalizeUrl(l);if(!d||!h)return console.warn("[isConfirmitDomain]",{error:"Failed to normalize URLs",config_base_url:c,url:l,normalized_config_url:d,normalized_input_url:h}),!1;return h.startsWith(d)}catch(c){return console.error("[isConfirmitDomain]",{error:"Error in function execution",details:c}),!1}},getConfirmitBaseUrl=async()=>IC.confirmit_base_url,NoActiveSurvey=({onRefresh:l,className:c=""})=>Kt.jsxs("div",{className:`fixed inset-0 flex justify-center items-center bg-gradient-to-b from-white to-gray-50/50 p-6 ${c}`,children:[Kt.jsx("div",{className:"w-full max-w-md transform transition-all duration-500 ease-out animate-in fade-in slide-in-from-bottom-4",children:Kt.jsxs(Ax,{className:"overflow-hidden border border-gray-100 shadow-xl bg-white/95 backdrop-blur-sm",children:[Kt.jsxs(Ox,{className:"space-y-1 pb-7 pt-8 px-6 text-center bg-gradient-to-b from-violet-50/80 to-transparent",children:[Kt.jsxs("div",{className:"mx-auto mb-4 relative",children:[Kt.jsx("div",{className:"absolute inset-0 bg-violet-200/50 blur-xl rounded-full animate-pulse"}),Kt.jsx("div",{className:"relative flex items-center justify-center w-16 h-16 mx-auto bg-violet-100 rounded-full",children:Kt.jsx(as,{className:"w-8 h-8 text-violet-600 animate-bounce-subtle"})})]}),Kt.jsx(Mx,{className:"text-2xl font-semibold text-violet-700",children:"No Active Survey"}),Kt.jsx(Nx,{className:"text-violet-600/90 font-medium",children:"Let's get you to the right place"})]}),Kt.jsx(Px,{className:"px-6 pb-8",children:Kt.jsxs("div",{className:"space-y-6",children:[Kt.jsx("div",{className:"p-4 rounded-lg bg-gradient-to-br from-amber-50 to-orange-50 border border-amber-100/50",children:Kt.jsxs("p",{className:"text-sm text-amber-800 leading-relaxed",children:["To use this extension, you'll need to:",Kt.jsxs("span",{className:"block mt-2 ml-1 space-y-1",children:[Kt.jsxs("span",{className:"flex items-center text-amber-700",children:[Kt.jsx("span",{className:"mr-2 text-amber-600",children:"1."}),"Open Confirmit Survey Designer"]}),Kt.jsxs("span",{className:"flex items-center text-amber-700",children:[Kt.jsx("span",{className:"mr-2 text-amber-600",children:"2."}),"Navigate to a specific survey"]})]})]})}),Kt.jsxs("div",{className:"space-y-3",children:[Kt.jsx(or,{onClick:async()=>{const l=await getConfirmitBaseUrl();l&&er.tabs.create({url:`${l}/surveydesigner`})},variant:"default",className:"w-full bg-violet-600 hover:bg-violet-700 text-white shadow-lg shadow-violet-200 transition-all duration-300 hover:shadow-xl hover:shadow-violet-200/50 hover:scale-[1.01]",children:"Open Survey Designer"}),Kt.jsxs(or,{variant:"outline",onClick:async()=>{try{const[l]=await er.tabs.query({active:!0,currentWindow:!0});l?.id&&await er.tabs.reload(l.id)}catch(l){console.error("Failed to reload tab:",l)}},className:"w-full border-2 border-violet-200 hover:border-violet-300 hover:bg-violet-50 text-violet-700 transition-colors duration-300",children:[Kt.jsx(Ni,{className:"w-4 h-4 mr-2 text-violet-600"}),Kt.jsx("span",{className:"font-medium",children:"Reload Page"})]}),l&&Kt.jsxs(or,{variant:"outline",onClick:l,className:"w-full border-2 border-violet-200 hover:border-violet-300 hover:bg-violet-50 text-violet-700 transition-colors duration-300",children:[Kt.jsx(Ni,{className:"w-4 h-4 mr-2 text-violet-600"}),Kt.jsx("span",{className:"font-medium",children:"Check Again"})]})]})]})})]})}),Kt.jsx("style",{children:"\n          @keyframes bounce-subtle {\n            0%, 100% { transform: translateY(0); }\n            50% { transform: translateY(-4px); }\n          }\n          .animate-bounce-subtle {\n            animation: bounce-subtle 2s infinite ease-in-out;\n          }\n        "})]}),TC=Gt.createContext({theme:"dark",toggleTheme:l=>{}}),useTheme=()=>Gt.useContext(TC),ThemeProvider=({children:l})=>{const[c,d]=Gt.useState("light");return Gt.useEffect((()=>{!async function(){const l=await er.storage.local.get("theme");l.theme&&d(l.theme)}()}),[]),Kt.jsx(TC.Provider,{value:{theme:c,toggleTheme:l=>{d(l)}},children:l})},RC=[{locale:"en",name:"English"},{locale:"zh_CN",name:"chingchong"}];var AC=["a","button","div","form","h2","h3","img","input","label","li","nav","ol","p","select","span","svg","ul"].reduce(((l,c)=>{const d=ar(`Primitive.${c}`),h=Gt.forwardRef(((l,h)=>{const{asChild:p,...f}=l,m=p?d:c;return"undefined"!=typeof window&&(window[Symbol.for("radix-ui")]=!0),Kt.jsx(m,{...f,ref:h})}));return h.displayName=`Primitive.${c}`,{...l,[c]:h}}),{});var OC=Gt.forwardRef(((l,c)=>Kt.jsx(AC.label,{...l,ref:c,onMouseDown:c=>{c.target.closest("button, input, select, textarea")||(l.onMouseDown?.(c),!c.defaultPrevented&&c.detail>1&&c.preventDefault())}})));OC.displayName="Label";var MC=OC;const NC=dr("text-sm font-medium leading-none peer-disabled:cursor-not-allowed peer-disabled:opacity-70"),PC=Gt.forwardRef((({className:l,...c},d)=>Kt.jsx(MC,{ref:d,className:tr(NC(),l),...c})));function composeEventHandlers(l,c,{checkForDefaultPrevented:d=!0}={}){return function(h){if(l?.(h),!1===d||!h.defaultPrevented)return c?.(h)}}function createContextScope(l,c=[]){let d=[];const createScope2=()=>{const c=d.map((l=>Gt.createContext(l)));return function(d){const h=d?.[l]||c;return Gt.useMemo((()=>({[`__scope${l}`]:{...d,[l]:h}})),[d,h])}};return createScope2.scopeName=l,[function(c,h){const p=Gt.createContext(h),f=d.length;d=[...d,h];const Provider2=c=>{const{scope:d,children:h,...m}=c,y=d?.[l]?.[f]||p,_=Gt.useMemo((()=>m),Object.values(m));return Kt.jsx(y.Provider,{value:_,children:h})};return Provider2.displayName=c+"Provider",[Provider2,function(d,m){const y=m?.[l]?.[f]||p,_=Gt.useContext(y);if(_)return _;if(void 0!==h)return h;throw new Error(`\`${d}\` must be used within \`${c}\``)}]},composeContextScopes(createScope2,...c)]}function composeContextScopes(...l){const c=l[0];if(1===l.length)return c;const createScope2=()=>{const d=l.map((l=>({useScope:l(),scopeName:l.scopeName})));return function(l){const h=d.reduce(((c,{useScope:d,scopeName:h})=>({...c,...d(l)[`__scope${h}`]})),{});return Gt.useMemo((()=>({[`__scope${c.scopeName}`]:h})),[h])}};return createScope2.scopeName=c.scopeName,createScope2}PC.displayName=MC.displayName;var LC=globalThis?.document?Gt.useLayoutEffect:()=>{},jC=fr[" useId ".trim().toString()]||(()=>{}),DC=0;function useId(l){const[c,d]=Gt.useState(jC());return LC((()=>{d((l=>l??String(DC++)))}),[l]),c?`radix-${c}`:""}function useCallbackRef(l){const c=Gt.useRef(l);return Gt.useEffect((()=>{c.current=l})),Gt.useMemo((()=>(...l)=>c.current?.(...l)),[])}var FC=fr[" useInsertionEffect ".trim().toString()]||LC;function useControllableState({prop:l,defaultProp:c,onChange:d=()=>{},caller:h}){const[p,f,m]=function({defaultProp:l,onChange:c}){const[d,h]=Gt.useState(l),p=Gt.useRef(d),f=Gt.useRef(c);return FC((()=>{f.current=c}),[c]),Gt.useEffect((()=>{p.current!==d&&(f.current?.(d),p.current=d)}),[d,p]),[d,h,f]}({defaultProp:c,onChange:d}),y=void 0!==l,_=y?l:p;{const c=Gt.useRef(void 0!==l);Gt.useEffect((()=>{const l=c.current;if(l!==y){const c=l?"controlled":"uncontrolled",d=y?"controlled":"uncontrolled";console.warn(`${h} is changing from ${c} to ${d}. Components should not switch from controlled to uncontrolled (or vice versa). Decide between using a controlled or uncontrolled value for the lifetime of the component.`)}c.current=y}),[y,h])}const b=Gt.useCallback((c=>{if(y){const d=function(l){return"function"==typeof l}(c)?c(l):c;d!==l&&m.current?.(d)}else f(c)}),[y,l,f,m]);return[_,b]}var $C=Gt.createContext(void 0);function useDirection(l){const c=Gt.useContext($C);return l||c||"ltr"}var UC="rovingFocusGroup.onEntryFocus",BC={bubbles:!1,cancelable:!0},HC="RovingFocusGroup",[zC,qC,WC]=function(l){const c=l+"CollectionProvider",[d,h]=createContextScope(c),[p,f]=d(c,{collectionRef:{current:null},itemMap:new Map}),CollectionProvider=l=>{const{scope:c,children:d}=l,h=Yt.useRef(null),f=Yt.useRef(new Map).current;return Kt.jsx(p,{scope:c,itemMap:f,collectionRef:h,children:d})};CollectionProvider.displayName=c;const m=l+"CollectionSlot",y=ar(m),_=Yt.forwardRef(((l,c)=>{const{scope:d,children:h}=l,p=f(m,d),_=pr(c,p.collectionRef);return Kt.jsx(y,{ref:_,children:h})}));_.displayName=m;const b=l+"CollectionItemSlot",w="data-radix-collection-item",E=ar(b),M=Yt.forwardRef(((l,c)=>{const{scope:d,children:h,...p}=l,m=Yt.useRef(null),y=pr(c,m),_=f(b,d);return Yt.useEffect((()=>(_.itemMap.set(m,{ref:m,...p}),()=>{_.itemMap.delete(m)}))),Kt.jsx(E,{[w]:"",ref:y,children:h})}));return M.displayName=b,[{Provider:CollectionProvider,Slot:_,ItemSlot:M},function(c){const d=f(l+"CollectionConsumer",c);return Yt.useCallback((()=>{const l=d.collectionRef.current;if(!l)return[];const c=Array.from(l.querySelectorAll(`[${w}]`));return Array.from(d.itemMap.values()).sort(((l,d)=>c.indexOf(l.ref.current)-c.indexOf(d.ref.current)))}),[d.collectionRef,d.itemMap])},h]}(HC),[VC,ZC]=createContextScope(HC,[WC]),[GC,KC]=VC(HC),JC=Gt.forwardRef(((l,c)=>Kt.jsx(zC.Provider,{scope:l.__scopeRovingFocusGroup,children:Kt.jsx(zC.Slot,{scope:l.__scopeRovingFocusGroup,children:Kt.jsx(YC,{...l,ref:c})})})));JC.displayName=HC;var YC=Gt.forwardRef(((l,c)=>{const{__scopeRovingFocusGroup:d,orientation:h,loop:p=!1,dir:f,currentTabStopId:m,defaultCurrentTabStopId:y,onCurrentTabStopIdChange:_,onEntryFocus:b,preventScrollOnEntryFocus:w=!1,...E}=l,M=Gt.useRef(null),N=pr(c,M),P=useDirection(f),[L,j]=useControllableState({prop:m,defaultProp:y??null,onChange:_,caller:HC}),[D,F]=Gt.useState(!1),U=useCallbackRef(b),B=qC(d),H=Gt.useRef(!1),[z,q]=Gt.useState(0);return Gt.useEffect((()=>{const l=M.current;if(l)return l.addEventListener(UC,U),()=>l.removeEventListener(UC,U)}),[U]),Kt.jsx(GC,{scope:d,orientation:h,dir:P,loop:p,currentTabStopId:L,onItemFocus:Gt.useCallback((l=>j(l)),[j]),onItemShiftTab:Gt.useCallback((()=>F(!0)),[]),onFocusableItemAdd:Gt.useCallback((()=>q((l=>l+1))),[]),onFocusableItemRemove:Gt.useCallback((()=>q((l=>l-1))),[]),children:Kt.jsx(AC.div,{tabIndex:D||0===z?-1:0,"data-orientation":h,...E,ref:N,style:{outline:"none",...l.style},onMouseDown:composeEventHandlers(l.onMouseDown,(()=>{H.current=!0})),onFocus:composeEventHandlers(l.onFocus,(l=>{const c=!H.current;if(l.target===l.currentTarget&&c&&!D){const c=new CustomEvent(UC,BC);if(l.currentTarget.dispatchEvent(c),!c.defaultPrevented){const l=B().filter((l=>l.focusable));focusFirst([l.find((l=>l.active)),l.find((l=>l.id===L)),...l].filter(Boolean).map((l=>l.ref.current)),w)}}H.current=!1})),onBlur:composeEventHandlers(l.onBlur,(()=>F(!1)))})})})),QC="RovingFocusGroupItem",XC=Gt.forwardRef(((l,c)=>{const{__scopeRovingFocusGroup:d,focusable:h=!0,active:p=!1,tabStopId:f,children:m,...y}=l,_=useId(),b=f||_,w=KC(QC,d),E=w.currentTabStopId===b,M=qC(d),{onFocusableItemAdd:N,onFocusableItemRemove:P,currentTabStopId:L}=w;return Gt.useEffect((()=>{if(h)return N(),()=>P()}),[h,N,P]),Kt.jsx(zC.ItemSlot,{scope:d,id:b,focusable:h,active:p,children:Kt.jsx(AC.span,{tabIndex:E?0:-1,"data-orientation":w.orientation,...y,ref:c,onMouseDown:composeEventHandlers(l.onMouseDown,(l=>{h?w.onItemFocus(b):l.preventDefault()})),onFocus:composeEventHandlers(l.onFocus,(()=>w.onItemFocus(b))),onKeyDown:composeEventHandlers(l.onKeyDown,(l=>{if("Tab"===l.key&&l.shiftKey)return void w.onItemShiftTab();if(l.target!==l.currentTarget)return;const c=function(l,c,d){const h=function(l,c){return"rtl"!==c?l:"ArrowLeft"===l?"ArrowRight":"ArrowRight"===l?"ArrowLeft":l}(l.key,d);return"vertical"===c&&["ArrowLeft","ArrowRight"].includes(h)||"horizontal"===c&&["ArrowUp","ArrowDown"].includes(h)?void 0:eE[h]}(l,w.orientation,w.dir);if(void 0!==c){if(l.metaKey||l.ctrlKey||l.altKey||l.shiftKey)return;l.preventDefault();let p=M().filter((l=>l.focusable)).map((l=>l.ref.current));if("last"===c)p.reverse();else if("prev"===c||"next"===c){"prev"===c&&p.reverse();const f=p.indexOf(l.currentTarget);p=w.loop?(h=f+1,(d=p).map(((l,c)=>d[(h+c)%d.length]))):p.slice(f+1)}setTimeout((()=>focusFirst(p)))}var d,h})),children:"function"==typeof m?m({isCurrentTabStop:E,hasTabStop:null!=L}):m})})}));XC.displayName=QC;var eE={ArrowLeft:"prev",ArrowUp:"prev",ArrowRight:"next",ArrowDown:"next",PageUp:"first",Home:"first",PageDown:"last",End:"last"};function focusFirst(l,c=!1){const d=document.activeElement;for(const h of l){if(h===d)return;if(h.focus({preventScroll:c}),document.activeElement!==d)return}}var tE=JC,rE=XC;function useSize(l){const[c,d]=Gt.useState(void 0);return LC((()=>{if(l){d({width:l.offsetWidth,height:l.offsetHeight});const c=new ResizeObserver((c=>{if(!Array.isArray(c))return;if(!c.length)return;const h=c[0];let p,f;if("borderBoxSize"in h){const l=h.borderBoxSize,c=Array.isArray(l)?l[0]:l;p=c.inlineSize,f=c.blockSize}else p=l.offsetWidth,f=l.offsetHeight;d({width:p,height:f})}));return c.observe(l,{box:"border-box"}),()=>c.unobserve(l)}d(void 0)}),[l]),c}var Presence=l=>{const{present:c,children:d}=l,h=function(l){const[c,d]=Gt.useState(),h=Gt.useRef(null),p=Gt.useRef(l),f=Gt.useRef("none"),m=l?"mounted":"unmounted",[y,_]=function(l,c){return Gt.useReducer(((l,d)=>c[l][d]??l),l)}(m,{mounted:{UNMOUNT:"unmounted",ANIMATION_OUT:"unmountSuspended"},unmountSuspended:{MOUNT:"mounted",ANIMATION_END:"unmounted"},unmounted:{MOUNT:"mounted"}});return Gt.useEffect((()=>{const l=getAnimationName(h.current);f.current="mounted"===y?l:"none"}),[y]),LC((()=>{const c=h.current,d=p.current;if(d!==l){const h=f.current,m=getAnimationName(c);if(l)_("MOUNT");else if("none"===m||"none"===c?.display)_("UNMOUNT");else{_(d&&h!==m?"ANIMATION_OUT":"UNMOUNT")}p.current=l}}),[l,_]),LC((()=>{if(c){let l;const d=c.ownerDocument.defaultView??window,handleAnimationEnd=f=>{const m=getAnimationName(h.current).includes(f.animationName);if(f.target===c&&m&&(_("ANIMATION_END"),!p.current)){const h=c.style.animationFillMode;c.style.animationFillMode="forwards",l=d.setTimeout((()=>{"forwards"===c.style.animationFillMode&&(c.style.animationFillMode=h)}))}},handleAnimationStart=l=>{l.target===c&&(f.current=getAnimationName(h.current))};return c.addEventListener("animationstart",handleAnimationStart),c.addEventListener("animationcancel",handleAnimationEnd),c.addEventListener("animationend",handleAnimationEnd),()=>{d.clearTimeout(l),c.removeEventListener("animationstart",handleAnimationStart),c.removeEventListener("animationcancel",handleAnimationEnd),c.removeEventListener("animationend",handleAnimationEnd)}}_("ANIMATION_END")}),[c,_]),{isPresent:["mounted","unmountSuspended"].includes(y),ref:Gt.useCallback((l=>{h.current=l?getComputedStyle(l):null,d(l)}),[])}}(c),p="function"==typeof d?d({present:h.isPresent}):Gt.Children.only(d),f=pr(h.ref,function(l){let c=Object.getOwnPropertyDescriptor(l.props,"ref")?.get,d=c&&"isReactWarning"in c&&c.isReactWarning;if(d)return l.ref;if(c=Object.getOwnPropertyDescriptor(l,"ref")?.get,d=c&&"isReactWarning"in c&&c.isReactWarning,d)return l.props.ref;return l.props.ref||l.ref}(p));return"function"==typeof d||h.isPresent?Gt.cloneElement(p,{ref:f}):null};function getAnimationName(l){return l?.animationName||"none"}Presence.displayName="Presence";var nE="Radio",[sE,iE]=createContextScope(nE),[oE,aE]=sE(nE),lE=Gt.forwardRef(((l,c)=>{const{__scopeRadio:d,name:h,checked:p=!1,required:f,disabled:m,value:y="on",onCheck:_,form:b,...w}=l,[E,M]=Gt.useState(null),N=pr(c,(l=>M(l))),P=Gt.useRef(!1),L=!E||(b||!!E.closest("form"));return Kt.jsxs(oE,{scope:d,checked:p,disabled:m,children:[Kt.jsx(AC.button,{type:"button",role:"radio","aria-checked":p,"data-state":getState(p),"data-disabled":m?"":void 0,disabled:m,value:y,...w,ref:N,onClick:composeEventHandlers(l.onClick,(l=>{p||_?.(),L&&(P.current=l.isPropagationStopped(),P.current||l.stopPropagation())}))}),L&&Kt.jsx(dE,{control:E,bubbles:!P.current,name:h,value:y,checked:p,required:f,disabled:m,form:b,style:{transform:"translateX(-100%)"}})]})}));lE.displayName=nE;var cE="RadioIndicator",uE=Gt.forwardRef(((l,c)=>{const{__scopeRadio:d,forceMount:h,...p}=l,f=aE(cE,d);return Kt.jsx(Presence,{present:h||f.checked,children:Kt.jsx(AC.span,{"data-state":getState(f.checked),"data-disabled":f.disabled?"":void 0,...p,ref:c})})}));uE.displayName=cE;var dE=Gt.forwardRef((({__scopeRadio:l,control:c,checked:d,bubbles:h=!0,...p},f)=>{const m=Gt.useRef(null),y=pr(m,f),_=function(l){const c=Gt.useRef({value:l,previous:l});return Gt.useMemo((()=>(c.current.value!==l&&(c.current.previous=c.current.value,c.current.value=l),c.current.previous)),[l])}(d),b=useSize(c);return Gt.useEffect((()=>{const l=m.current;if(!l)return;const c=window.HTMLInputElement.prototype,p=Object.getOwnPropertyDescriptor(c,"checked").set;if(_!==d&&p){const c=new Event("click",{bubbles:h});p.call(l,d),l.dispatchEvent(c)}}),[_,d,h]),Kt.jsx(AC.input,{type:"radio","aria-hidden":!0,defaultChecked:d,...p,tabIndex:-1,ref:y,style:{...p.style,...b,position:"absolute",pointerEvents:"none",opacity:0,margin:0}})}));function getState(l){return l?"checked":"unchecked"}dE.displayName="RadioBubbleInput";var hE=["ArrowUp","ArrowDown","ArrowLeft","ArrowRight"],pE="RadioGroup",[fE,mE]=createContextScope(pE,[ZC,iE]),gE=ZC(),vE=iE(),[yE,_E]=fE(pE),bE=Gt.forwardRef(((l,c)=>{const{__scopeRadioGroup:d,name:h,defaultValue:p,value:f,required:m=!1,disabled:y=!1,orientation:_,dir:b,loop:w=!0,onValueChange:E,...M}=l,N=gE(d),P=useDirection(b),[L,j]=useControllableState({prop:f,defaultProp:p??null,onChange:E,caller:pE});return Kt.jsx(yE,{scope:d,name:h,required:m,disabled:y,value:L,onValueChange:j,children:Kt.jsx(tE,{asChild:!0,...N,orientation:_,dir:P,loop:w,children:Kt.jsx(AC.div,{role:"radiogroup","aria-required":m,"aria-orientation":_,"data-disabled":y?"":void 0,dir:P,...M,ref:c})})})}));bE.displayName=pE;var wE="RadioGroupItem",SE=Gt.forwardRef(((l,c)=>{const{__scopeRadioGroup:d,disabled:h,...p}=l,f=_E(wE,d),m=f.disabled||h,y=gE(d),_=vE(d),b=Gt.useRef(null),w=pr(c,b),E=f.value===p.value,M=Gt.useRef(!1);return Gt.useEffect((()=>{const handleKeyDown=l=>{hE.includes(l.key)&&(M.current=!0)},handleKeyUp=()=>M.current=!1;return document.addEventListener("keydown",handleKeyDown),document.addEventListener("keyup",handleKeyUp),()=>{document.removeEventListener("keydown",handleKeyDown),document.removeEventListener("keyup",handleKeyUp)}}),[]),Kt.jsx(rE,{asChild:!0,...y,focusable:!m,active:E,children:Kt.jsx(lE,{disabled:m,required:f.required,checked:E,..._,...p,name:f.name,ref:w,onCheck:()=>f.onValueChange(p.value),onKeyDown:composeEventHandlers((l=>{"Enter"===l.key&&l.preventDefault()})),onFocus:composeEventHandlers(p.onFocus,(()=>{M.current&&b.current?.click()}))})})}));SE.displayName=wE;var xE=Gt.forwardRef(((l,c)=>{const{__scopeRadioGroup:d,...h}=l,p=vE(d);return Kt.jsx(uE,{...p,...h,ref:c})}));xE.displayName="RadioGroupIndicator";var kE=bE,CE=SE,EE=xE;const IE=Gt.forwardRef((({className:l,...c},d)=>Kt.jsx(kE,{className:tr("grid gap-2",l),...c,ref:d})));IE.displayName=kE.displayName;const TE=Gt.forwardRef((({className:l,...c},d)=>Kt.jsx(CE,{ref:d,className:tr("aspect-square h-4 w-4 rounded-full border border-primary text-primary ring-offset-background focus:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50",l),...c,children:Kt.jsx(EE,{className:"flex items-center justify-center",children:Kt.jsx(us,{className:"h-2.5 w-2.5 fill-current text-current"})})})));function I18nSettings(){const{i18n:l}=useTranslation(),{t:c}=useTranslation();return Kt.jsxs(Ax,{children:[Kt.jsx("div",{className:"space-y-1.5 p-6 pb-3",children:Kt.jsx("h3",{className:"font-semibold text-left text-base",children:c("i18nSettings")})}),Kt.jsx(IE,{defaultValue:l.language,value:l.language,className:"p-6 pt-2",children:RC.map(((c,d,h)=>Kt.jsxs("div",{className:"flex items-center space-y-1.5 justify-between",onClick:async()=>{await l.changeLanguage(c.locale),await er.runtime.sendMessage({messageType:gr.changeLocale,content:c.locale}),await er.storage.local.set({i18n:c.locale})},children:[Kt.jsx(PC,{htmlFor:`r${d}`,children:c.name}),Kt.jsx(TE,{value:`${c.locale}`,id:`r${d}`})]},d)))})]})}function ThemeSettings(){const{theme:l,toggleTheme:c}=useTheme(),d=["light","dark"],{t:h}=useTranslation();return Kt.jsxs(Ax,{children:[Kt.jsx("div",{className:"space-y-1.5 p-6 pb-3",children:Kt.jsx("h3",{className:"font-semibold text-left text-base",children:h("themeSettings")})}),Kt.jsx(IE,{defaultValue:l,value:l,className:"p-6 pt-2",children:d&&d.map(((l,d,h)=>Kt.jsxs("div",{className:"flex items-center space-y-1.5 justify-between",onClick:async()=>{c(l),await er.runtime.sendMessage({messageType:gr.changeTheme,content:l}),await er.storage.local.set({theme:l})},children:[Kt.jsx(PC,{htmlFor:`r${d}`,children:l}),Kt.jsx(TE,{value:l,id:`r${d}`})]},d)))})]})}function SettingsPage(){return Kt.jsxs("div",{className:"grid gap-4 md:grid-cols-2 lg:grid-cols-3",children:[Kt.jsx(I18nSettings,{}),Kt.jsx(ThemeSettings,{})]})}TE.displayName=CE.displayName;const RE=`${IC.api_url}/document_to_survey_convertor/files`,useNewSurvey=()=>{const uploadFile=async(l,c,d)=>{const{upload_url:h,key:p}=await(async(l,c)=>{const d=await fetchWithAuth(`${RE}/generate_upload_url?temp_session_id=${c}&file_name=${l}`,{headers:{"ngrok-skip-browser-warning":"true"}}).then((l=>l.json()));if("ok"!==d.status)throw new Error("Failed to get upload URL");return{temp_session_id:d.temp_session_id,upload_url:d.upload_url,key:d.key}})(l.name,c);if((await fetch(h,{method:"PUT",body:l})).ok){const c={type:"questionnaire",file_name:l.name,file_mime_type:l.type,file_s3_key:p,location:d??null};return l?.duplicateAction&&(c.duplicate_action=l.duplicateAction),c}throw new Error(`Failed to upload file ${l.name}`)};return useMutation({mutationFn:async({files:l,projectId:c,surveyName:d,is_template:h,template_project_id:p,reference_media_files:f})=>{console.log("files",l);const m=await Promise.all(l.map((l=>uploadFile(l,c,l?.location??null)))),y=`${IC.api_url}/document_to_survey_convertor/start_session_confirmit`,_={files:m,confirmit_session_id:c,survey_name:d,is_template:h,template_project_id:p,extension_version:"0.1.8",reference_media_files:f??[]},b=await fetchWithAuth(y,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(_)});if(!b.ok){const l=await b.text();throw new Error(`Failed to create survey session: ${b.status} ${b.statusText} - ${l}`)}return await b.json()},onError:l=>{vo.error(l.message??"Error creating new survey")}})};function useActiveSurveyMonitor(){const[l,c]=Gt.useState({isValidSurveyPage:!1,projectId:null,currentUrl:null,isConfirmitPage:!1,isLoading:!0}),d=Gt.useCallback((l=>{const c=new URL(l).pathname;if(!c.includes("/surveydesigner/"))return null;const d=c.match(/p\d+/);return d?d[0]:null}),[]),h=Gt.useCallback((async()=>{try{const[l]=await er.tabs.query({active:!0,currentWindow:!0});if(!l?.url)return void c({isValidSurveyPage:!1,projectId:null,currentUrl:null,isConfirmitPage:!1,isLoading:!1});const h=l.url,p=d(h),f=new URL(h),m=isConfirmitDomain(h),y=f.pathname.includes("/surveydesigner/");c({isValidSurveyPage:m&&y&&!!p,projectId:p,currentUrl:h,isConfirmitPage:m,isLoading:!1})}catch(l){console.error("Failed to check active tab:",l),c((l=>({...l,isLoading:!1})))}}),[d]);Gt.useEffect((()=>{h();const handleTabUpdate=(l,c,d)=>{(c.url||"complete"===c.status)&&h()},handleTabActivated=l=>{h()},handleWindowFocusChanged=l=>{l!==er.windows.WINDOW_ID_NONE&&h()};er.tabs.onUpdated.addListener(handleTabUpdate),er.tabs.onActivated.addListener(handleTabActivated),er.windows.onFocusChanged.addListener(handleWindowFocusChanged);const l=setInterval(h,1e3);return()=>{er.tabs.onUpdated.removeListener(handleTabUpdate),er.tabs.onActivated.removeListener(handleTabActivated),er.windows.onFocusChanged.removeListener(handleWindowFocusChanged),clearInterval(l)}}),[h]);const p=Gt.useMemo((()=>{if(!l.currentUrl||!l.isConfirmitPage)return!1;try{const c=new URL(l.currentUrl);return c.pathname.includes("/surveydesigner/")&&/\/surveydesigner\/p\d+/.test(c.pathname)}catch{return!1}}),[l.currentUrl,l.isConfirmitPage]);return{...l,refresh:h,isOnValidSurveyPage:p}}function useAuthToken(){const[l,c]=Gt.useState(null),[d,h]=Gt.useState(!0),[p,f]=Gt.useState(null),loadAuthToken=async()=>{try{h(!0),f(null);const l=(await er.storage.local.get(["authToken","lastCaptured"])).authToken;l&&"null"!==l&&"undefined"!==l&&"string"==typeof l&&""!==l.trim()?c(l):(c(null),f("No auth token found. Please ensure you are logged in to Confirmit."))}catch(l){f(`Failed to retrieve auth token: ${l}`)}finally{h(!1)}};return Gt.useEffect((()=>{(async()=>{try{await er.runtime.sendMessage({messageType:"ping"}),await er.storage.local.get(null)}catch(l){}})(),loadAuthToken();const handleStorageChange=l=>{if(l.authToken){const d=l.authToken.newValue;l.authToken.oldValue,d&&"null"!==d&&"undefined"!==d&&"string"==typeof d&&""!==d.trim()?(c(d),f(null)):(c(null),f("No auth token found. Please ensure you are logged in to Confirmit."))}};return er.storage.onChanged.addListener(handleStorageChange),()=>{er.storage.onChanged.removeListener(handleStorageChange)}}),[]),{authToken:l,isLoading:d,error:p,refreshToken:async()=>{await loadAuthToken()}}}const AE=new class{async getBaseUrl(){return await getConfirmitBaseUrl()}async getAuthToken(){try{return(await er.storage.local.get(["authToken"])).authToken||null}catch(l){return console.error("Failed to get auth token:",l),null}}async getCookies(){try{return(await er.storage.local.get(["cookies"])).cookies||null}catch(l){return console.error("Failed to get cookies:",l),null}}async makeRequest(l,c={}){const d=await this.getBaseUrl();if(!d)return{error:"No Confirmit base URL available. Please navigate to a Confirmit page first.",status:0};const h=await this.getAuthToken(),p=await this.getCookies();if(!h)return{error:"No authentication token available",status:401};const f=new Headers(c.headers||{});f.set("Authorization",`Bearer ${h}`),f.set("Cookie",p||""),f.set("Content-Type","application/json");try{const h=await fetch(`${d}${l}`,{...c,headers:f,credentials:"include"}),p=await h.json();return{data:p,status:h.status,error:h.ok?void 0:p.message||"Request failed"}}catch(m){return console.error("API request failed:",m),{error:m instanceof Error?m.message:"Unknown error",status:0}}}async getProjectInfo(l){return this.makeRequest(`/surveydesigner/api/surveys/${l}`)}async getQuestionnaireQuestions(l,c){return this.makeRequest(`/surveydesigner/api/surveys/${l}/questionnaires/${c}/questions`)}async getQuestionnaireMetadata(l,c){return this.makeRequest(`/surveydesigner/api/surveys/${l}/questionnaires/${c}`)}async updateQuestionText(l,c,d,h){return this.makeRequest(`/surveydesigner/api/surveys/${l}/questionnaires/${c}/questions/${d}`,{method:"PATCH",body:JSON.stringify({text:h})})}async request(l,c={}){return this.makeRequest(l,c)}};function useConfirmitProject(){const[l,c]=Gt.useState({projectId:null,currentUrl:null,isConfirmitPage:!1}),[d,h]=Gt.useState(!0),[p,f]=Gt.useState(null),{authToken:m,isLoading:y,error:_}=useAuthToken(),getCurrentTabInfo=async()=>{try{h(!0),f(null);const l=await er.tabs.query({active:!0,currentWindow:!0});if(console.log(l,"tabs"),0===l.length)throw new Error("No active tab found");const d=l[0].url||"",p=(l=>{const c=l.match(/\/surveydesigner\/(p\d+)(?:\/|$|\?|#)/);if(!c){const c=/(p\d+)$/,d=l.match(c);return console.log(d,"endMatch",l),d?d[1]:null}return console.log(c,"match",l),c?c[1]:null})(d);console.log(p,"projectId",d);const m=isConfirmitDomain(d);c({projectId:p,currentUrl:d,isConfirmitPage:m}),m&&!p&&f("Could not extract project ID from Confirmit URL")}catch(l){f(`Failed to get tab information: ${l}`),console.error("Error getting current tab:",l)}finally{h(!1)}};return Gt.useEffect((()=>{getCurrentTabInfo();const handleTabUpdate=(l,c)=>{c.url&&getCurrentTabInfo()},handleTabActivation=()=>{getCurrentTabInfo()};return er.tabs.onUpdated.addListener(handleTabUpdate),er.tabs.onActivated.addListener(handleTabActivation),()=>{er.tabs.onUpdated.removeListener(handleTabUpdate),er.tabs.onActivated.removeListener(handleTabActivation)}}),[]),Gt.useEffect((()=>{getCurrentTabInfo()}),[]),{...l,authToken:m,isLoading:d||y,error:p||_,makeProjectRequest:async(c,d={})=>{if(!l.projectId)return{error:"No project ID available. Please navigate to a Confirmit project page.",status:400};const h=c.replace("{projectId}",l.projectId);return AE.request(h,d)},refreshProject:async()=>{await getCurrentTabInfo()}}}var isCheckBoxInput=l=>"checkbox"===l.type,isDateObject=l=>l instanceof Date,isNullOrUndefined=l=>null==l;const isObjectType=l=>"object"==typeof l;var isObject=l=>!isNullOrUndefined(l)&&!Array.isArray(l)&&isObjectType(l)&&!isDateObject(l),OE="undefined"!=typeof window&&void 0!==window.HTMLElement&&"undefined"!=typeof document;function cloneObject(l){let c;const d=Array.isArray(l),h="undefined"!=typeof FileList&&l instanceof FileList;if(l instanceof Date)c=new Date(l);else if(l instanceof Set)c=new Set(l);else{if(OE&&(l instanceof Blob||h)||!d&&!isObject(l))return l;if(c=d?[]:{},d||(l=>{const c=l.constructor&&l.constructor.prototype;return isObject(c)&&c.hasOwnProperty("isPrototypeOf")})(l))for(const d in l)l.hasOwnProperty(d)&&(c[d]=cloneObject(l[d]));else c=l}return c}var compact=l=>Array.isArray(l)?l.filter(Boolean):[],isUndefined=l=>void 0===l,get=(l,c,d)=>{if(!c||!isObject(l))return d;const h=compact(c.split(/[,[\].]+?/)).reduce(((l,c)=>isNullOrUndefined(l)?l:l[c]),l);return isUndefined(h)||h===l?isUndefined(l[c])?d:l[c]:h},isBoolean$1=l=>"boolean"==typeof l,isKey=l=>/^\w*$/.test(l),stringToPath=l=>compact(l.replace(/["|']|\]/g,"").split(/\.|\[/)),set$1=(l,c,d)=>{let h=-1;const p=isKey(c)?[c]:stringToPath(c),f=p.length,m=f-1;for(;++h<f;){const c=p[h];let f=d;if(h!==m){const d=l[c];f=isObject(d)||Array.isArray(d)?d:isNaN(+p[h+1])?{}:[]}if("__proto__"===c||"constructor"===c||"prototype"===c)return;l[c]=f,l=l[c]}};const ME="blur",NE="focusout",PE="onBlur",LE="onChange",jE="onSubmit",DE="onTouched",FE="all",$E="max",UE="min",BE="maxLength",HE="minLength",zE="pattern",qE="required",WE="validate";Yt.createContext(null);const VE="undefined"!=typeof window?Gt.useLayoutEffect:Gt.useEffect;var isString=l=>"string"==typeof l,appendErrors=(l,c,d,h,p)=>c?{...d[l],types:{...d[l]&&d[l].types?d[l].types:{},[h]:p||!0}}:{},convertToArrayPayload=l=>Array.isArray(l)?l:[l],createSubject=()=>{let l=[];return{get observers(){return l},next:c=>{for(const d of l)d.next&&d.next(c)},subscribe:c=>(l.push(c),{unsubscribe:()=>{l=l.filter((l=>l!==c))}}),unsubscribe:()=>{l=[]}}},isPrimitive=l=>isNullOrUndefined(l)||!isObjectType(l);function deepEqual$1(l,c){if(isPrimitive(l)||isPrimitive(c))return l===c;if(isDateObject(l)&&isDateObject(c))return l.getTime()===c.getTime();const d=Object.keys(l),h=Object.keys(c);if(d.length!==h.length)return!1;for(const p of d){const d=l[p];if(!h.includes(p))return!1;if("ref"!==p){const l=c[p];if(isDateObject(d)&&isDateObject(l)||isObject(d)&&isObject(l)||Array.isArray(d)&&Array.isArray(l)?!deepEqual$1(d,l):d!==l)return!1}}return!0}var isEmptyObject=l=>isObject(l)&&!Object.keys(l).length,isFileInput=l=>"file"===l.type,isFunction=l=>"function"==typeof l,isHTMLElement$1=l=>{if(!OE)return!1;const c=l?l.ownerDocument:0;return l instanceof(c&&c.defaultView?c.defaultView.HTMLElement:HTMLElement)},isMultipleSelect=l=>"select-multiple"===l.type,isRadioInput=l=>"radio"===l.type,live=l=>isHTMLElement$1(l)&&l.isConnected;function unset(l,c){const d=Array.isArray(c)?c:isKey(c)?[c]:stringToPath(c),h=1===d.length?l:function(l,c){const d=c.slice(0,-1).length;let h=0;for(;h<d;)l=isUndefined(l)?h++:l[c[h++]];return l}(l,d),p=d.length-1,f=d[p];return h&&delete h[f],0!==p&&(isObject(h)&&isEmptyObject(h)||Array.isArray(h)&&function(l){for(const c in l)if(l.hasOwnProperty(c)&&!isUndefined(l[c]))return!1;return!0}(h))&&unset(l,d.slice(0,-1)),l}var objectHasFunction=l=>{for(const c in l)if(isFunction(l[c]))return!0;return!1};function markFieldsDirty(l,c={}){const d=Array.isArray(l);if(isObject(l)||d)for(const h in l)Array.isArray(l[h])||isObject(l[h])&&!objectHasFunction(l[h])?(c[h]=Array.isArray(l[h])?[]:{},markFieldsDirty(l[h],c[h])):isNullOrUndefined(l[h])||(c[h]=!0);return c}function getDirtyFieldsFromDefaultValues(l,c,d){const h=Array.isArray(l);if(isObject(l)||h)for(const p in l)Array.isArray(l[p])||isObject(l[p])&&!objectHasFunction(l[p])?isUndefined(c)||isPrimitive(d[p])?d[p]=Array.isArray(l[p])?markFieldsDirty(l[p],[]):{...markFieldsDirty(l[p])}:getDirtyFieldsFromDefaultValues(l[p],isNullOrUndefined(c)?{}:c[p],d[p]):d[p]=!deepEqual$1(l[p],c[p]);return d}var getDirtyFields=(l,c)=>getDirtyFieldsFromDefaultValues(l,c,markFieldsDirty(c));const ZE={value:!1,isValid:!1},GE={value:!0,isValid:!0};var getCheckboxValue=l=>{if(Array.isArray(l)){if(l.length>1){const c=l.filter((l=>l&&l.checked&&!l.disabled)).map((l=>l.value));return{value:c,isValid:!!c.length}}return l[0].checked&&!l[0].disabled?l[0].attributes&&!isUndefined(l[0].attributes.value)?isUndefined(l[0].value)||""===l[0].value?GE:{value:l[0].value,isValid:!0}:GE:ZE}return ZE},getFieldValueAs=(l,{valueAsNumber:c,valueAsDate:d,setValueAs:h})=>isUndefined(l)?l:c?""===l?NaN:l?+l:l:d&&isString(l)?new Date(l):h?h(l):l;const KE={isValid:!1,value:null};var getRadioValue=l=>Array.isArray(l)?l.reduce(((l,c)=>c&&c.checked&&!c.disabled?{isValid:!0,value:c.value}:l),KE):KE;function getFieldValue(l){const c=l.ref;return isFileInput(c)?c.files:isRadioInput(c)?getRadioValue(l.refs).value:isMultipleSelect(c)?[...c.selectedOptions].map((({value:l})=>l)):isCheckBoxInput(c)?getCheckboxValue(l.refs).value:getFieldValueAs(isUndefined(c.value)?l.ref.value:c.value,l)}var isRegex=l=>l instanceof RegExp,getRuleValue=l=>isUndefined(l)?l:isRegex(l)?l.source:isObject(l)?isRegex(l.value)?l.value.source:l.value:l,getValidationModes=l=>({isOnSubmit:!l||l===jE,isOnBlur:l===PE,isOnChange:l===LE,isOnAll:l===FE,isOnTouch:l===DE});const JE="AsyncFunction";var isWatched=(l,c,d)=>!d&&(c.watchAll||c.watch.has(l)||[...c.watch].some((c=>l.startsWith(c)&&/^\.\w+/.test(l.slice(c.length)))));const iterateFieldsByAction=(l,c,d,h)=>{for(const p of d||Object.keys(l)){const d=get(l,p);if(d){const{_f:l,...f}=d;if(l){if(l.refs&&l.refs[0]&&c(l.refs[0],p)&&!h)return!0;if(l.ref&&c(l.ref,l.name)&&!h)return!0;if(iterateFieldsByAction(f,c))break}else if(isObject(f)&&iterateFieldsByAction(f,c))break}}};function schemaErrorLookup(l,c,d){const h=get(l,d);if(h||isKey(d))return{error:h,name:d};const p=d.split(".");for(;p.length;){const h=p.join("."),f=get(c,h),m=get(l,h);if(f&&!Array.isArray(f)&&d!==h)return{name:d};if(m&&m.type)return{name:h,error:m};if(m&&m.root&&m.root.type)return{name:`${h}.root`,error:m.root};p.pop()}return{name:d}}var updateFieldArrayRootError=(l,c,d)=>{const h=convertToArrayPayload(get(l,d));return set$1(h,"root",c[d]),set$1(l,d,h),l},isMessage=l=>isString(l);function getValidateError(l,c,d="validate"){if(isMessage(l)||Array.isArray(l)&&l.every(isMessage)||isBoolean$1(l)&&!l)return{type:d,message:isMessage(l)?l:"",ref:c}}var getValueAndMessage=l=>isObject(l)&&!isRegex(l)?l:{value:l,message:""},validateField=async(l,c,d,h,p,f)=>{const{ref:m,refs:y,required:_,maxLength:b,minLength:w,min:E,max:M,pattern:N,validate:P,name:L,valueAsNumber:j,mount:D}=l._f,F=get(d,L);if(!D||c.has(L))return{};const U=y?y[0]:m,setCustomValidity=l=>{p&&U.reportValidity&&(U.setCustomValidity(isBoolean$1(l)?"":l||""),U.reportValidity())},B={},H=isRadioInput(m),z=isCheckBoxInput(m),q=H||z,V=(j||isFileInput(m))&&isUndefined(m.value)&&isUndefined(F)||isHTMLElement$1(m)&&""===m.value||""===F||Array.isArray(F)&&!F.length,Z=appendErrors.bind(null,L,h,B),getMinMaxMessage=(l,c,d,h=BE,p=HE)=>{const f=l?c:d;B[L]={type:l?h:p,message:f,ref:m,...Z(l?h:p,f)}};if(f?!Array.isArray(F)||!F.length:_&&(!q&&(V||isNullOrUndefined(F))||isBoolean$1(F)&&!F||z&&!getCheckboxValue(y).isValid||H&&!getRadioValue(y).isValid)){const{value:l,message:c}=isMessage(_)?{value:!!_,message:_}:getValueAndMessage(_);if(l&&(B[L]={type:qE,message:c,ref:U,...Z(qE,c)},!h))return setCustomValidity(c),B}if(!(V||isNullOrUndefined(E)&&isNullOrUndefined(M))){let l,c;const d=getValueAndMessage(M),p=getValueAndMessage(E);if(isNullOrUndefined(F)||isNaN(F)){const h=m.valueAsDate||new Date(F),convertTimeToDate=l=>new Date((new Date).toDateString()+" "+l),f="time"==m.type,y="week"==m.type;isString(d.value)&&F&&(l=f?convertTimeToDate(F)>convertTimeToDate(d.value):y?F>d.value:h>new Date(d.value)),isString(p.value)&&F&&(c=f?convertTimeToDate(F)<convertTimeToDate(p.value):y?F<p.value:h<new Date(p.value))}else{const h=m.valueAsNumber||(F?+F:F);isNullOrUndefined(d.value)||(l=h>d.value),isNullOrUndefined(p.value)||(c=h<p.value)}if((l||c)&&(getMinMaxMessage(!!l,d.message,p.message,$E,UE),!h))return setCustomValidity(B[L].message),B}if((b||w)&&!V&&(isString(F)||f&&Array.isArray(F))){const l=getValueAndMessage(b),c=getValueAndMessage(w),d=!isNullOrUndefined(l.value)&&F.length>+l.value,p=!isNullOrUndefined(c.value)&&F.length<+c.value;if((d||p)&&(getMinMaxMessage(d,l.message,c.message),!h))return setCustomValidity(B[L].message),B}if(N&&!V&&isString(F)){const{value:l,message:c}=getValueAndMessage(N);if(isRegex(l)&&!F.match(l)&&(B[L]={type:zE,message:c,ref:m,...Z(zE,c)},!h))return setCustomValidity(c),B}if(P)if(isFunction(P)){const l=getValidateError(await P(F,d),U);if(l&&(B[L]={...l,...Z(WE,l.message)},!h))return setCustomValidity(l.message),B}else if(isObject(P)){let l={};for(const c in P){if(!isEmptyObject(l)&&!h)break;const p=getValidateError(await P[c](F,d),U,c);p&&(l={...p,...Z(c,p.message)},setCustomValidity(p.message),h&&(B[L]=l))}if(!isEmptyObject(l)&&(B[L]={ref:U,...l},!h))return B}return setCustomValidity(!0),B};const YE={mode:jE,reValidateMode:LE,shouldFocusError:!0};function createFormControl(l={}){let c={...YE,...l},d={submitCount:0,isDirty:!1,isReady:!1,isLoading:isFunction(c.defaultValues),isValidating:!1,isSubmitted:!1,isSubmitting:!1,isSubmitSuccessful:!1,isValid:!1,touchedFields:{},dirtyFields:{},validatingFields:{},errors:c.errors||{},disabled:c.disabled||!1};const h={};let p,f=(isObject(c.defaultValues)||isObject(c.values))&&cloneObject(c.defaultValues||c.values)||{},m=c.shouldUnregister?{}:cloneObject(f),y={action:!1,mount:!1,watch:!1},_={mount:new Set,disabled:new Set,unMount:new Set,array:new Set,watch:new Set},b=0;const w={isDirty:!1,dirtyFields:!1,validatingFields:!1,touchedFields:!1,isValidating:!1,isValid:!1,errors:!1};let E={...w};const M={array:createSubject(),state:createSubject()},N=c.criteriaMode===FE,_setValid=async l=>{if(!c.disabled&&(w.isValid||E.isValid||l)){const l=c.resolver?isEmptyObject((await _runSchema()).errors):await executeBuiltInValidation(h,!0);l!==d.isValid&&M.state.next({isValid:l})}},_updateIsValidating=(l,h)=>{!c.disabled&&(w.isValidating||w.validatingFields||E.isValidating||E.validatingFields)&&((l||Array.from(_.mount)).forEach((l=>{l&&(h?set$1(d.validatingFields,l,h):unset(d.validatingFields,l))})),M.state.next({validatingFields:d.validatingFields,isValidating:!isEmptyObject(d.validatingFields)}))},updateValidAndValue=(l,c,d,p)=>{const _=get(h,l);if(_){const h=get(m,l,isUndefined(d)?get(f,l):d);isUndefined(h)||p&&p.defaultChecked||c?set$1(m,l,c?h:getFieldValue(_._f)):setFieldValue(l,h),y.mount&&_setValid()}},updateTouchAndDirty=(l,h,p,m,y)=>{let _=!1,b=!1;const N={name:l};if(!c.disabled){if(!p||m){(w.isDirty||E.isDirty)&&(b=d.isDirty,d.isDirty=N.isDirty=_getDirty(),_=b!==N.isDirty);const c=deepEqual$1(get(f,l),h);b=!!get(d.dirtyFields,l),c?unset(d.dirtyFields,l):set$1(d.dirtyFields,l,!0),N.dirtyFields=d.dirtyFields,_=_||(w.dirtyFields||E.dirtyFields)&&b!==!c}if(p){const c=get(d.touchedFields,l);c||(set$1(d.touchedFields,l,p),N.touchedFields=d.touchedFields,_=_||(w.touchedFields||E.touchedFields)&&c!==p)}_&&y&&M.state.next(N)}return _?N:{}},shouldRenderByError=(l,h,f,m)=>{const y=get(d.errors,l),_=(w.isValid||E.isValid)&&isBoolean$1(h)&&d.isValid!==h;var N;if(c.delayError&&f?(N=()=>((l,c)=>{set$1(d.errors,l,c),M.state.next({errors:d.errors})})(l,f),p=l=>{clearTimeout(b),b=setTimeout(N,l)},p(c.delayError)):(clearTimeout(b),p=null,f?set$1(d.errors,l,f):unset(d.errors,l)),(f?!deepEqual$1(y,f):y)||!isEmptyObject(m)||_){const c={...m,..._&&isBoolean$1(h)?{isValid:h}:{},errors:d.errors,name:l};d={...d,...c},M.state.next(c)}},_runSchema=async l=>{_updateIsValidating(l,!0);const d=await c.resolver(m,c.context,((l,c,d,h)=>{const p={};for(const f of l){const l=get(c,f);l&&set$1(p,f,l._f)}return{criteriaMode:d,names:[...l],fields:p,shouldUseNativeValidation:h}})(l||_.mount,h,c.criteriaMode,c.shouldUseNativeValidation));return _updateIsValidating(l),d},executeBuiltInValidation=async(l,h,p={valid:!0})=>{for(const y in l){const b=l[y];if(b){const{_f:l,...E}=b;if(l){const E=_.array.has(l.name),M=b._f&&(!!(f=b._f)&&!!f.validate&&!!(isFunction(f.validate)&&f.validate.constructor.name===JE||isObject(f.validate)&&Object.values(f.validate).find((l=>l.constructor.name===JE))));M&&w.validatingFields&&_updateIsValidating([y],!0);const P=await validateField(b,_.disabled,m,N,c.shouldUseNativeValidation&&!h,E);if(M&&w.validatingFields&&_updateIsValidating([y]),P[l.name]&&(p.valid=!1,h))break;!h&&(get(P,l.name)?E?updateFieldArrayRootError(d.errors,P,l.name):set$1(d.errors,l.name,P[l.name]):unset(d.errors,l.name))}!isEmptyObject(E)&&await executeBuiltInValidation(E,h,p)}}var f;return p.valid},_getDirty=(l,d)=>!c.disabled&&(l&&d&&set$1(m,l,d),!deepEqual$1(getValues(),f)),_getWatch=(l,c,d)=>((l,c,d,h,p)=>isString(l)?(h&&c.watch.add(l),get(d,l,p)):Array.isArray(l)?l.map((l=>(h&&c.watch.add(l),get(d,l)))):(h&&(c.watchAll=!0),d))(l,_,{...y.mount?m:isUndefined(c)?f:isString(l)?{[l]:c}:c},d,c),setFieldValue=(l,c,d={})=>{const p=get(h,l);let f=c;if(p){const d=p._f;d&&(!d.disabled&&set$1(m,l,getFieldValueAs(c,d)),f=isHTMLElement$1(d.ref)&&isNullOrUndefined(c)?"":c,isMultipleSelect(d.ref)?[...d.ref.options].forEach((l=>l.selected=f.includes(l.value))):d.refs?isCheckBoxInput(d.ref)?d.refs.forEach((l=>{l.defaultChecked&&l.disabled||(Array.isArray(f)?l.checked=!!f.find((c=>c===l.value)):l.checked=f===l.value||!!f)})):d.refs.forEach((l=>l.checked=l.value===f)):isFileInput(d.ref)?d.ref.value="":(d.ref.value=f,d.ref.type||M.state.next({name:l,values:cloneObject(m)})))}(d.shouldDirty||d.shouldTouch)&&updateTouchAndDirty(l,f,d.shouldTouch,d.shouldDirty,!0),d.shouldValidate&&trigger(l)},setValues=(l,c,d)=>{for(const p in c){if(!c.hasOwnProperty(p))return;const f=c[p],m=l+"."+p,y=get(h,m);(_.array.has(l)||isObject(f)||y&&!y._f)&&!isDateObject(f)?setValues(m,f,d):setFieldValue(m,f,d)}},setValue=(l,c,p={})=>{const b=get(h,l),N=_.array.has(l),P=cloneObject(c);set$1(m,l,P),N?(M.array.next({name:l,values:cloneObject(m)}),(w.isDirty||w.dirtyFields||E.isDirty||E.dirtyFields)&&p.shouldDirty&&M.state.next({name:l,dirtyFields:getDirtyFields(f,m),isDirty:_getDirty(l,P)})):!b||b._f||isNullOrUndefined(P)?setFieldValue(l,P,p):setValues(l,P,p),isWatched(l,_)&&M.state.next({...d}),M.state.next({name:y.mount?l:void 0,values:cloneObject(m)})},onChange=async l=>{y.mount=!0;const f=l.target;let b=f.name,P=!0;const L=get(h,b),_updateIsFieldValueUpdated=l=>{P=Number.isNaN(l)||isDateObject(l)&&isNaN(l.getTime())||deepEqual$1(l,get(m,b,l))},j=getValidationModes(c.mode),D=getValidationModes(c.reValidateMode);if(L){let y,F;const U=f.type?getFieldValue(L._f):(l=>isObject(l)&&l.target?isCheckBoxInput(l.target)?l.target.checked:l.target.value:l)(l),B=l.type===ME||l.type===NE,H=!(l=>l.mount&&(l.required||l.min||l.max||l.maxLength||l.minLength||l.pattern||l.validate))(L._f)&&!c.resolver&&!get(d.errors,b)&&!L._f.deps||((l,c,d,h,p)=>!p.isOnAll&&(!d&&p.isOnTouch?!(c||l):(d?h.isOnBlur:p.isOnBlur)?!l:!(d?h.isOnChange:p.isOnChange)||l))(B,get(d.touchedFields,b),d.isSubmitted,D,j),z=isWatched(b,_,B);set$1(m,b,U),B?(L._f.onBlur&&L._f.onBlur(l),p&&p(0)):L._f.onChange&&L._f.onChange(l);const q=updateTouchAndDirty(b,U,B),V=!isEmptyObject(q)||z;if(!B&&M.state.next({name:b,type:l.type,values:cloneObject(m)}),H)return(w.isValid||E.isValid)&&("onBlur"===c.mode?B&&_setValid():B||_setValid()),V&&M.state.next({name:b,...z?{}:q});if(!B&&z&&M.state.next({...d}),c.resolver){const{errors:l}=await _runSchema([b]);if(_updateIsFieldValueUpdated(U),P){const c=schemaErrorLookup(d.errors,h,b),p=schemaErrorLookup(l,h,c.name||b);y=p.error,b=p.name,F=isEmptyObject(l)}}else _updateIsValidating([b],!0),y=(await validateField(L,_.disabled,m,N,c.shouldUseNativeValidation))[b],_updateIsValidating([b]),_updateIsFieldValueUpdated(U),P&&(y?F=!1:(w.isValid||E.isValid)&&(F=await executeBuiltInValidation(h,!0)));P&&(L._f.deps&&trigger(L._f.deps),shouldRenderByError(b,F,y,q))}},_focusInput=(l,c)=>{if(get(d.errors,c)&&l.focus)return l.focus(),1},trigger=async(l,p={})=>{let f,m;const y=convertToArrayPayload(l);if(c.resolver){const c=await(async l=>{const{errors:c}=await _runSchema(l);if(l)for(const h of l){const l=get(c,h);l?set$1(d.errors,h,l):unset(d.errors,h)}else d.errors=c;return c})(isUndefined(l)?l:y);f=isEmptyObject(c),m=l?!y.some((l=>get(c,l))):f}else l?(m=(await Promise.all(y.map((async l=>{const c=get(h,l);return await executeBuiltInValidation(c&&c._f?{[l]:c}:c)})))).every(Boolean),(m||d.isValid)&&_setValid()):m=f=await executeBuiltInValidation(h);return M.state.next({...!isString(l)||(w.isValid||E.isValid)&&f!==d.isValid?{}:{name:l},...c.resolver||!l?{isValid:f}:{},errors:d.errors}),p.shouldFocus&&!m&&iterateFieldsByAction(h,_focusInput,l?y:_.mount),m},getValues=l=>{const c={...y.mount?m:f};return isUndefined(l)?c:isString(l)?get(c,l):l.map((l=>get(c,l)))},getFieldState=(l,c)=>({invalid:!!get((c||d).errors,l),isDirty:!!get((c||d).dirtyFields,l),error:get((c||d).errors,l),isValidating:!!get(d.validatingFields,l),isTouched:!!get((c||d).touchedFields,l)}),setError=(l,c,p)=>{const f=(get(h,l,{_f:{}})._f||{}).ref,m=get(d.errors,l)||{},{ref:y,message:_,type:b,...w}=m;set$1(d.errors,l,{...w,...c,ref:f}),M.state.next({name:l,errors:d.errors,isValid:!1}),p&&p.shouldFocus&&f&&f.focus&&f.focus()},_subscribe=l=>M.state.subscribe({next:c=>{var h,p,f;h=l.name,p=c.name,f=l.exact,h&&p&&h!==p&&!convertToArrayPayload(h).some((l=>l&&(f?l===p:l.startsWith(p)||p.startsWith(l))))||!((l,c,d,h)=>{d(l);const{name:p,...f}=l;return isEmptyObject(f)||Object.keys(f).length>=Object.keys(c).length||Object.keys(f).find((l=>c[l]===(!h||FE)))})(c,l.formState||w,_setFormState,l.reRenderRoot)||l.callback({values:{...m},...d,...c})}}).unsubscribe,unregister=(l,p={})=>{for(const y of l?convertToArrayPayload(l):_.mount)_.mount.delete(y),_.array.delete(y),p.keepValue||(unset(h,y),unset(m,y)),!p.keepError&&unset(d.errors,y),!p.keepDirty&&unset(d.dirtyFields,y),!p.keepTouched&&unset(d.touchedFields,y),!p.keepIsValidating&&unset(d.validatingFields,y),!c.shouldUnregister&&!p.keepDefaultValue&&unset(f,y);M.state.next({values:cloneObject(m)}),M.state.next({...d,...p.keepDirty?{isDirty:_getDirty()}:{}}),!p.keepIsValid&&_setValid()},_setDisabledField=({disabled:l,name:c})=>{(isBoolean$1(l)&&y.mount||l||_.disabled.has(c))&&(l?_.disabled.add(c):_.disabled.delete(c))},register=(l,d={})=>{let p=get(h,l);const m=isBoolean$1(d.disabled)||isBoolean$1(c.disabled);return set$1(h,l,{...p||{},_f:{...p&&p._f?p._f:{ref:{name:l}},name:l,mount:!0,...d}}),_.mount.add(l),p?_setDisabledField({disabled:isBoolean$1(d.disabled)?d.disabled:c.disabled,name:l}):updateValidAndValue(l,!0,d.value),{...m?{disabled:d.disabled||c.disabled}:{},...c.progressive?{required:!!d.required,min:getRuleValue(d.min),max:getRuleValue(d.max),minLength:getRuleValue(d.minLength),maxLength:getRuleValue(d.maxLength),pattern:getRuleValue(d.pattern)}:{},name:l,onChange:onChange,onBlur:onChange,ref:m=>{if(m){register(l,d),p=get(h,l);const c=isUndefined(m.value)&&m.querySelectorAll&&m.querySelectorAll("input,select,textarea")[0]||m,y=(l=>isRadioInput(l)||isCheckBoxInput(l))(c),_=p._f.refs||[];if(y?_.find((l=>l===c)):c===p._f.ref)return;set$1(h,l,{_f:{...p._f,...y?{refs:[..._.filter(live),c,...Array.isArray(get(f,l))?[{}]:[]],ref:{type:c.type,name:l}}:{ref:c}}}),updateValidAndValue(l,!1,void 0,c)}else p=get(h,l,{}),p._f&&(p._f.mount=!1),(c.shouldUnregister||d.shouldUnregister)&&(!((l,c)=>l.has((l=>l.substring(0,l.search(/\.\d+(\.|$)/))||l)(c)))(_.array,l)||!y.action)&&_.unMount.add(l)}}},_focusError=()=>c.shouldFocusError&&iterateFieldsByAction(h,_focusInput,_.mount),handleSubmit=(l,p)=>async f=>{let y;f&&(f.preventDefault&&f.preventDefault(),f.persist&&f.persist());let b=cloneObject(m);if(M.state.next({isSubmitting:!0}),c.resolver){const{errors:l,values:c}=await _runSchema();d.errors=l,b=c}else await executeBuiltInValidation(h);if(_.disabled.size)for(const l of _.disabled)set$1(b,l,void 0);if(unset(d.errors,"root"),isEmptyObject(d.errors)){M.state.next({errors:{}});try{await l(b,f)}catch(w){y=w}}else p&&await p({...d.errors},f),_focusError(),setTimeout(_focusError);if(M.state.next({isSubmitted:!0,isSubmitting:!1,isSubmitSuccessful:isEmptyObject(d.errors)&&!y,submitCount:d.submitCount+1,errors:d.errors}),y)throw y},_reset=(l,p={})=>{const b=l?cloneObject(l):f,E=cloneObject(b),N=isEmptyObject(l),P=N?f:E;if(p.keepDefaultValues||(f=b),!p.keepValues){if(p.keepDirtyValues){const l=new Set([..._.mount,...Object.keys(getDirtyFields(f,m))]);for(const c of Array.from(l))get(d.dirtyFields,c)?set$1(P,c,get(m,c)):setValue(c,get(P,c))}else{if(OE&&isUndefined(l))for(const l of _.mount){const c=get(h,l);if(c&&c._f){const l=Array.isArray(c._f.refs)?c._f.refs[0]:c._f.ref;if(isHTMLElement$1(l)){const c=l.closest("form");if(c){c.reset();break}}}}for(const l of _.mount)setValue(l,get(P,l))}m=cloneObject(P),M.array.next({values:{...P}}),M.state.next({values:{...P}})}_={mount:p.keepDirtyValues?_.mount:new Set,unMount:new Set,array:new Set,disabled:new Set,watch:new Set,watchAll:!1,focus:""},y.mount=!w.isValid||!!p.keepIsValid||!!p.keepDirtyValues,y.watch=!!c.shouldUnregister,M.state.next({submitCount:p.keepSubmitCount?d.submitCount:0,isDirty:!N&&(p.keepDirty?d.isDirty:!(!p.keepDefaultValues||deepEqual$1(l,f))),isSubmitted:!!p.keepIsSubmitted&&d.isSubmitted,dirtyFields:N?{}:p.keepDirtyValues?p.keepDefaultValues&&m?getDirtyFields(f,m):d.dirtyFields:p.keepDefaultValues&&l?getDirtyFields(f,l):p.keepDirty?d.dirtyFields:{},touchedFields:p.keepTouched?d.touchedFields:{},errors:p.keepErrors?d.errors:{},isSubmitSuccessful:!!p.keepIsSubmitSuccessful&&d.isSubmitSuccessful,isSubmitting:!1})},reset=(l,c)=>_reset(isFunction(l)?l(m):l,c),_setFormState=l=>{d={...d,...l}},P={control:{register:register,unregister:unregister,getFieldState:getFieldState,handleSubmit:handleSubmit,setError:setError,_subscribe:_subscribe,_runSchema:_runSchema,_focusError:_focusError,_getWatch:_getWatch,_getDirty:_getDirty,_setValid:_setValid,_setFieldArray:(l,p=[],_,b,N=!0,P=!0)=>{if(b&&_&&!c.disabled){if(y.action=!0,P&&Array.isArray(get(h,l))){const c=_(get(h,l),b.argA,b.argB);N&&set$1(h,l,c)}if(P&&Array.isArray(get(d.errors,l))){const c=_(get(d.errors,l),b.argA,b.argB);N&&set$1(d.errors,l,c),((l,c)=>{!compact(get(l,c)).length&&unset(l,c)})(d.errors,l)}if((w.touchedFields||E.touchedFields)&&P&&Array.isArray(get(d.touchedFields,l))){const c=_(get(d.touchedFields,l),b.argA,b.argB);N&&set$1(d.touchedFields,l,c)}(w.dirtyFields||E.dirtyFields)&&(d.dirtyFields=getDirtyFields(f,m)),M.state.next({name:l,isDirty:_getDirty(l,p),dirtyFields:d.dirtyFields,errors:d.errors,isValid:d.isValid})}else set$1(m,l,p)},_setDisabledField:_setDisabledField,_setErrors:l=>{d.errors=l,M.state.next({errors:d.errors,isValid:!1})},_getFieldArray:l=>compact(get(y.mount?m:f,l,c.shouldUnregister?get(f,l,[]):[])),_reset:_reset,_resetDefaultValues:()=>isFunction(c.defaultValues)&&c.defaultValues().then((l=>{reset(l,c.resetOptions),M.state.next({isLoading:!1})})),_removeUnmounted:()=>{for(const l of _.unMount){const c=get(h,l);c&&(c._f.refs?c._f.refs.every((l=>!live(l))):!live(c._f.ref))&&unregister(l)}_.unMount=new Set},_disableForm:l=>{isBoolean$1(l)&&(M.state.next({disabled:l}),iterateFieldsByAction(h,((c,d)=>{const p=get(h,d);p&&(c.disabled=p._f.disabled||l,Array.isArray(p._f.refs)&&p._f.refs.forEach((c=>{c.disabled=p._f.disabled||l})))}),0,!1))},_subjects:M,_proxyFormState:w,get _fields(){return h},get _formValues(){return m},get _state(){return y},set _state(l){y=l},get _defaultValues(){return f},get _names(){return _},set _names(l){_=l},get _formState(){return d},get _options(){return c},set _options(l){c={...c,...l}}},subscribe:l=>(y.mount=!0,E={...E,...l.formState},_subscribe({...l,formState:E})),trigger:trigger,register:register,handleSubmit:handleSubmit,watch:(l,c)=>isFunction(l)?M.state.subscribe({next:d=>l(_getWatch(void 0,c),d)}):_getWatch(l,c,!0),setValue:setValue,getValues:getValues,reset:reset,resetField:(l,c={})=>{get(h,l)&&(isUndefined(c.defaultValue)?setValue(l,cloneObject(get(f,l))):(setValue(l,c.defaultValue),set$1(f,l,cloneObject(c.defaultValue))),c.keepTouched||unset(d.touchedFields,l),c.keepDirty||(unset(d.dirtyFields,l),d.isDirty=c.defaultValue?_getDirty(l,cloneObject(get(f,l))):_getDirty()),c.keepError||(unset(d.errors,l),w.isValid&&_setValid()),M.state.next({...d}))},clearErrors:l=>{l&&convertToArrayPayload(l).forEach((l=>unset(d.errors,l))),M.state.next({errors:l?d.errors:{}})},unregister:unregister,setError:setError,setFocus:(l,c={})=>{const d=get(h,l),p=d&&d._f;if(p){const l=p.refs?p.refs[0]:p.ref;l.focus&&(l.focus(),c.shouldSelect&&isFunction(l.select)&&l.select())}},getFieldState:getFieldState};return{...P,formControl:P}}function useForm(l={}){const c=Yt.useRef(void 0),d=Yt.useRef(void 0),[h,p]=Yt.useState({isDirty:!1,isValidating:!1,isLoading:isFunction(l.defaultValues),isSubmitted:!1,isSubmitting:!1,isSubmitSuccessful:!1,isValid:!1,submitCount:0,dirtyFields:{},touchedFields:{},validatingFields:{},errors:l.errors||{},disabled:l.disabled||!1,isReady:!1,defaultValues:isFunction(l.defaultValues)?void 0:l.defaultValues});c.current||(c.current={...l.formControl?l.formControl:createFormControl(l),formState:h},l.formControl&&l.defaultValues&&!isFunction(l.defaultValues)&&l.formControl.reset(l.defaultValues,l.resetOptions));const f=c.current.control;return f._options=l,VE((()=>{const l=f._subscribe({formState:f._proxyFormState,callback:()=>p({...f._formState}),reRenderRoot:!0});return p((l=>({...l,isReady:!0}))),f._formState.isReady=!0,l}),[f]),Yt.useEffect((()=>f._disableForm(l.disabled)),[f,l.disabled]),Yt.useEffect((()=>{l.mode&&(f._options.mode=l.mode),l.reValidateMode&&(f._options.reValidateMode=l.reValidateMode)}),[f,l.mode,l.reValidateMode]),Yt.useEffect((()=>{l.errors&&(f._setErrors(l.errors),f._focusError())}),[f,l.errors]),Yt.useEffect((()=>{l.shouldUnregister&&f._subjects.state.next({values:f._getWatch()})}),[f,l.shouldUnregister]),Yt.useEffect((()=>{if(f._proxyFormState.isDirty){const l=f._getDirty();l!==h.isDirty&&f._subjects.state.next({isDirty:l})}}),[f,h.isDirty]),Yt.useEffect((()=>{l.values&&!deepEqual$1(l.values,d.current)?(f._reset(l.values,f._options.resetOptions),d.current=l.values,p((l=>({...l})))):f._resetDefaultValues()}),[f,l.values]),Yt.useEffect((()=>{f._state.mount||(f._setValid(),f._state.mount=!0),f._state.watch&&(f._state.watch=!1,f._subjects.state.next({...f._formState})),f._removeUnmounted()})),c.current.formState=((l,c,d,h=!0)=>{const p={defaultValues:c._defaultValues};for(const f in l)Object.defineProperty(p,f,{get:()=>{const d=f;return c._proxyFormState[d]!==FE&&(c._proxyFormState[d]=!h||FE),l[d]}});return p})(h,f),c.current}const r=(l,c,d)=>{if(l&&"reportValidity"in l){const h=get(d,c);l.setCustomValidity(h&&h.message||""),l.reportValidity()}},o=(l,c)=>{for(const d in c.fields){const h=c.fields[d];h&&h.ref&&"reportValidity"in h.ref?r(h.ref,d,l):h&&h.refs&&h.refs.forEach((c=>r(c,d,l)))}},s$1=(l,c)=>{c.shouldUseNativeValidation&&o(l,c);const d={};for(const h in l){const p=get(c.fields,h),f=Object.assign(l[h]||{},{ref:p&&p.ref});if(i$1(c.names||Object.keys(l),h)){const l=Object.assign({},get(d,h));set$1(l,"root",f),set$1(d,h,l)}else set$1(d,h,f)}return d},i$1=(l,c)=>{const d=n(c);return l.some((l=>n(l).match(`^${d}\\.\\d+`)))};function n(l){return l.replace(/\]|\[/g,"")}function $constructor(l,c,d){function init2(d,h){var p;Object.defineProperty(d,"_zod",{value:d._zod??{},enumerable:!1}),(p=d._zod).traits??(p.traits=new Set),d._zod.traits.add(l),c(d,h);for(const l in _2.prototype)l in d||Object.defineProperty(d,l,{value:_2.prototype[l].bind(d)});d._zod.constr=_2,d._zod.def=h}const h=d?.Parent??Object;class Definition extends h{}function _2(l){var c;const h=d?.Parent?new Definition:this;init2(h,l),(c=h._zod).deferred??(c.deferred=[]);for(const d of h._zod.deferred)d();return h}return Object.defineProperty(Definition,"name",{value:l}),Object.defineProperty(_2,"init",{value:init2}),Object.defineProperty(_2,Symbol.hasInstance,{value:c=>!!(d?.Parent&&c instanceof d.Parent)||c?._zod?.traits?.has(l)}),Object.defineProperty(_2,"name",{value:l}),_2}class $ZodAsyncError extends Error{constructor(){super("Encountered Promise during synchronous parse. Use .parseAsync() instead.")}}const QE={};function config(l){return QE}function jsonStringifyReplacer(l,c){return"bigint"==typeof c?c.toString():c}function unwrapMessage(l){return"string"==typeof l?l:l?.message}function finalizeIssue(l,c,d){const h={...l,path:l.path??[]};if(!l.message){const p=unwrapMessage(l.inst?._zod.def?.error?.(l))??unwrapMessage(c?.error?.(l))??unwrapMessage(d.customError?.(l))??unwrapMessage(d.localeError?.(l))??"Invalid input";h.message=p}return delete h.inst,delete h.continue,c?.reportInput||delete h.input,h}const initializer=(l,c)=>{l.name="$ZodError",Object.defineProperty(l,"_zod",{value:l._zod,enumerable:!1}),Object.defineProperty(l,"issues",{value:c,enumerable:!1}),Object.defineProperty(l,"message",{get:()=>JSON.stringify(c,jsonStringifyReplacer,2),enumerable:!0})},XE=$constructor("$ZodError",initializer),eI=$constructor("$ZodError",initializer,{Parent:Error}),_parse=l=>(c,d,h,p)=>{const f=h?Object.assign(h,{async:!1}):{async:!1},m=c._zod.run({value:d,issues:[]},f);if(m instanceof Promise)throw new $ZodAsyncError;if(m.issues.length){const c=new(p?.Err??l)(m.issues.map((l=>finalizeIssue(l,f,config()))));throw Error.captureStackTrace(c,p?.callee),c}return m.value},tI=_parse(eI),_parseAsync=l=>async(c,d,h,p)=>{const f=h?Object.assign(h,{async:!0}):{async:!0};let m=c._zod.run({value:d,issues:[]},f);if(m instanceof Promise&&(m=await m),m.issues.length){const c=new(p?.Err??l)(m.issues.map((l=>finalizeIssue(l,f,config()))));throw Error.captureStackTrace(c,p?.callee),c}return m.value},rI=_parseAsync(eI);function t(l,c){try{var d=l()}catch(h){return c(h)}return d&&d.then?d.then(void 0,c):d}function s(l,c){for(var d={};l.length;){var h=l[0],p=h.code,f=h.message,m=h.path.join(".");if(!d[m])if("unionErrors"in h){var y=h.unionErrors[0].errors[0];d[m]={message:y.message,type:y.code}}else d[m]={message:f,type:p};if("unionErrors"in h&&h.unionErrors.forEach((function(c){return c.errors.forEach((function(c){return l.push(c)}))})),c){var _=d[m].types,b=_&&_[h.code];d[m]=appendErrors(m,c,d,p,b?[].concat(b,h.message):h.message)}l.shift()}return d}function i(l,c){for(var d={};l.length;){var h=l[0],p=h.code,f=h.message,m=h.path.join(".");if(!d[m])if("invalid_union"===h.code){var y=h.errors[0][0];d[m]={message:y.message,type:y.code}}else d[m]={message:f,type:p};if("invalid_union"===h.code&&h.errors.forEach((function(c){return c.forEach((function(c){return l.push(c)}))})),c){var _=d[m].types,b=_&&_[h.code];d[m]=appendErrors(m,c,d,p,b?[].concat(b,h.message):h.message)}l.shift()}return d}function a(l,c,d){if(void 0===d&&(d={}),function(l){return"_def"in l&&"object"==typeof l._def&&"typeName"in l._def}(l))return function(h,p,f){try{return Promise.resolve(t((function(){return Promise.resolve(l["sync"===d.mode?"parse":"parseAsync"](h,c)).then((function(l){return f.shouldUseNativeValidation&&o({},f),{errors:{},values:d.raw?Object.assign({},h):l}}))}),(function(l){if(c=l,Array.isArray(null==c?void 0:c.issues))return{values:{},errors:s$1(s(l.errors,!f.shouldUseNativeValidation&&"all"===f.criteriaMode),f)};var c;throw l})))}catch(Oy){return Promise.reject(Oy)}};if(function(l){return"_zod"in l&&"object"==typeof l._zod}(l))return function(h,p,f){try{return Promise.resolve(t((function(){return Promise.resolve(("sync"===d.mode?tI:rI)(l,h,c)).then((function(l){return f.shouldUseNativeValidation&&o({},f),{errors:{},values:d.raw?Object.assign({},h):l}}))}),(function(l){if(l instanceof XE)return{values:{},errors:s$1(i(l.issues,!f.shouldUseNativeValidation&&"all"===f.criteriaMode),f)};throw l})))}catch(Oy){return Promise.reject(Oy)}};throw new Error("Invalid input: not a Zod schema")}var nI,sI,iI;(sI=nI||(nI={})).assertEqual=l=>{},sI.assertIs=function(l){},sI.assertNever=function(l){throw new Error},sI.arrayToEnum=l=>{const c={};for(const d of l)c[d]=d;return c},sI.getValidEnumValues=l=>{const c=sI.objectKeys(l).filter((c=>"number"!=typeof l[l[c]])),d={};for(const h of c)d[h]=l[h];return sI.objectValues(d)},sI.objectValues=l=>sI.objectKeys(l).map((function(c){return l[c]})),sI.objectKeys="function"==typeof Object.keys?l=>Object.keys(l):l=>{const c=[];for(const d in l)Object.prototype.hasOwnProperty.call(l,d)&&c.push(d);return c},sI.find=(l,c)=>{for(const d of l)if(c(d))return d},sI.isInteger="function"==typeof Number.isInteger?l=>Number.isInteger(l):l=>"number"==typeof l&&Number.isFinite(l)&&Math.floor(l)===l,sI.joinValues=function(l,c=" | "){return l.map((l=>"string"==typeof l?`'${l}'`:l)).join(c)},sI.jsonStringifyReplacer=(l,c)=>"bigint"==typeof c?c.toString():c,(iI||(iI={})).mergeShapes=(l,c)=>({...l,...c});const oI=nI.arrayToEnum(["string","nan","number","integer","float","boolean","date","bigint","symbol","function","undefined","null","array","object","unknown","promise","void","never","map","set"]),getParsedType=l=>{switch(typeof l){case"undefined":return oI.undefined;case"string":return oI.string;case"number":return Number.isNaN(l)?oI.nan:oI.number;case"boolean":return oI.boolean;case"function":return oI.function;case"bigint":return oI.bigint;case"symbol":return oI.symbol;case"object":return Array.isArray(l)?oI.array:null===l?oI.null:l.then&&"function"==typeof l.then&&l.catch&&"function"==typeof l.catch?oI.promise:"undefined"!=typeof Map&&l instanceof Map?oI.map:"undefined"!=typeof Set&&l instanceof Set?oI.set:"undefined"!=typeof Date&&l instanceof Date?oI.date:oI.object;default:return oI.unknown}},aI=nI.arrayToEnum(["invalid_type","invalid_literal","custom","invalid_union","invalid_union_discriminator","invalid_enum_value","unrecognized_keys","invalid_arguments","invalid_return_type","invalid_date","invalid_string","too_small","too_big","invalid_intersection_types","not_multiple_of","not_finite"]);class ZodError extends Error{get errors(){return this.issues}constructor(l){super(),this.issues=[],this.addIssue=l=>{this.issues=[...this.issues,l]},this.addIssues=(l=[])=>{this.issues=[...this.issues,...l]};const c=new.target.prototype;Object.setPrototypeOf?Object.setPrototypeOf(this,c):this.__proto__=c,this.name="ZodError",this.issues=l}format(l){const c=l||function(l){return l.message},d={_errors:[]},processError=l=>{for(const h of l.issues)if("invalid_union"===h.code)h.unionErrors.map(processError);else if("invalid_return_type"===h.code)processError(h.returnTypeError);else if("invalid_arguments"===h.code)processError(h.argumentsError);else if(0===h.path.length)d._errors.push(c(h));else{let l=d,p=0;for(;p<h.path.length;){const d=h.path[p];p===h.path.length-1?(l[d]=l[d]||{_errors:[]},l[d]._errors.push(c(h))):l[d]=l[d]||{_errors:[]},l=l[d],p++}}};return processError(this),d}static assert(l){if(!(l instanceof ZodError))throw new Error(`Not a ZodError: ${l}`)}toString(){return this.message}get message(){return JSON.stringify(this.issues,nI.jsonStringifyReplacer,2)}get isEmpty(){return 0===this.issues.length}flatten(l=l=>l.message){const c={},d=[];for(const h of this.issues)h.path.length>0?(c[h.path[0]]=c[h.path[0]]||[],c[h.path[0]].push(l(h))):d.push(l(h));return{formErrors:d,fieldErrors:c}}get formErrors(){return this.flatten()}}ZodError.create=l=>new ZodError(l);const errorMap=(l,c)=>{let d;switch(l.code){case aI.invalid_type:d=l.received===oI.undefined?"Required":`Expected ${l.expected}, received ${l.received}`;break;case aI.invalid_literal:d=`Invalid literal value, expected ${JSON.stringify(l.expected,nI.jsonStringifyReplacer)}`;break;case aI.unrecognized_keys:d=`Unrecognized key(s) in object: ${nI.joinValues(l.keys,", ")}`;break;case aI.invalid_union:d="Invalid input";break;case aI.invalid_union_discriminator:d=`Invalid discriminator value. Expected ${nI.joinValues(l.options)}`;break;case aI.invalid_enum_value:d=`Invalid enum value. Expected ${nI.joinValues(l.options)}, received '${l.received}'`;break;case aI.invalid_arguments:d="Invalid function arguments";break;case aI.invalid_return_type:d="Invalid function return type";break;case aI.invalid_date:d="Invalid date";break;case aI.invalid_string:"object"==typeof l.validation?"includes"in l.validation?(d=`Invalid input: must include "${l.validation.includes}"`,"number"==typeof l.validation.position&&(d=`${d} at one or more positions greater than or equal to ${l.validation.position}`)):"startsWith"in l.validation?d=`Invalid input: must start with "${l.validation.startsWith}"`:"endsWith"in l.validation?d=`Invalid input: must end with "${l.validation.endsWith}"`:nI.assertNever(l.validation):d="regex"!==l.validation?`Invalid ${l.validation}`:"Invalid";break;case aI.too_small:d="array"===l.type?`Array must contain ${l.exact?"exactly":l.inclusive?"at least":"more than"} ${l.minimum} element(s)`:"string"===l.type?`String must contain ${l.exact?"exactly":l.inclusive?"at least":"over"} ${l.minimum} character(s)`:"number"===l.type?`Number must be ${l.exact?"exactly equal to ":l.inclusive?"greater than or equal to ":"greater than "}${l.minimum}`:"date"===l.type?`Date must be ${l.exact?"exactly equal to ":l.inclusive?"greater than or equal to ":"greater than "}${new Date(Number(l.minimum))}`:"Invalid input";break;case aI.too_big:d="array"===l.type?`Array must contain ${l.exact?"exactly":l.inclusive?"at most":"less than"} ${l.maximum} element(s)`:"string"===l.type?`String must contain ${l.exact?"exactly":l.inclusive?"at most":"under"} ${l.maximum} character(s)`:"number"===l.type?`Number must be ${l.exact?"exactly":l.inclusive?"less than or equal to":"less than"} ${l.maximum}`:"bigint"===l.type?`BigInt must be ${l.exact?"exactly":l.inclusive?"less than or equal to":"less than"} ${l.maximum}`:"date"===l.type?`Date must be ${l.exact?"exactly":l.inclusive?"smaller than or equal to":"smaller than"} ${new Date(Number(l.maximum))}`:"Invalid input";break;case aI.custom:d="Invalid input";break;case aI.invalid_intersection_types:d="Intersection results could not be merged";break;case aI.not_multiple_of:d=`Number must be a multiple of ${l.multipleOf}`;break;case aI.not_finite:d="Number must be finite";break;default:d=c.defaultError,nI.assertNever(l)}return{message:d}};let lI=errorMap;function addIssueToContext(l,c){const d=lI,h=(l=>{const{data:c,path:d,errorMaps:h,issueData:p}=l,f=[...d,...p.path||[]],m={...p,path:f};if(void 0!==p.message)return{...p,path:f,message:p.message};let y="";const _=h.filter((l=>!!l)).slice().reverse();for(const b of _)y=b(m,{data:c,defaultError:y}).message;return{...p,path:f,message:y}})({issueData:c,data:l.data,path:l.path,errorMaps:[l.common.contextualErrorMap,l.schemaErrorMap,d,d===errorMap?void 0:errorMap].filter((l=>!!l))});l.common.issues.push(h)}class ParseStatus{constructor(){this.value="valid"}dirty(){"valid"===this.value&&(this.value="dirty")}abort(){"aborted"!==this.value&&(this.value="aborted")}static mergeArray(l,c){const d=[];for(const h of c){if("aborted"===h.status)return cI;"dirty"===h.status&&l.dirty(),d.push(h.value)}return{status:l.value,value:d}}static async mergeObjectAsync(l,c){const d=[];for(const h of c){const l=await h.key,c=await h.value;d.push({key:l,value:c})}return ParseStatus.mergeObjectSync(l,d)}static mergeObjectSync(l,c){const d={};for(const h of c){const{key:c,value:p}=h;if("aborted"===c.status)return cI;if("aborted"===p.status)return cI;"dirty"===c.status&&l.dirty(),"dirty"===p.status&&l.dirty(),"__proto__"===c.value||void 0===p.value&&!h.alwaysSet||(d[c.value]=p.value)}return{status:l.value,value:d}}}const cI=Object.freeze({status:"aborted"}),DIRTY=l=>({status:"dirty",value:l}),OK=l=>({status:"valid",value:l}),isAborted=l=>"aborted"===l.status,isDirty=l=>"dirty"===l.status,isValid=l=>"valid"===l.status,isAsync=l=>"undefined"!=typeof Promise&&l instanceof Promise;var uI,dI;(dI=uI||(uI={})).errToObj=l=>"string"==typeof l?{message:l}:l||{},dI.toString=l=>"string"==typeof l?l:l?.message;class ParseInputLazyPath{constructor(l,c,d,h){this._cachedPath=[],this.parent=l,this.data=c,this._path=d,this._key=h}get path(){return this._cachedPath.length||(Array.isArray(this._key)?this._cachedPath.push(...this._path,...this._key):this._cachedPath.push(...this._path,this._key)),this._cachedPath}}const handleResult=(l,c)=>{if(isValid(c))return{success:!0,data:c.value};if(!l.common.issues.length)throw new Error("Validation failed but no issues detected.");return{success:!1,get error(){if(this._error)return this._error;const c=new ZodError(l.common.issues);return this._error=c,this._error}}};function processCreateParams(l){if(!l)return{};const{errorMap:c,invalid_type_error:d,required_error:h,description:p}=l;if(c&&(d||h))throw new Error('Can\'t use "invalid_type_error" or "required_error" in conjunction with custom error map.');if(c)return{errorMap:c,description:p};return{errorMap:(c,p)=>{const{message:f}=l;return"invalid_enum_value"===c.code?{message:f??p.defaultError}:void 0===p.data?{message:f??h??p.defaultError}:"invalid_type"!==c.code?{message:p.defaultError}:{message:f??d??p.defaultError}},description:p}}class ZodType{get description(){return this._def.description}_getType(l){return getParsedType(l.data)}_getOrReturnCtx(l,c){return c||{common:l.parent.common,data:l.data,parsedType:getParsedType(l.data),schemaErrorMap:this._def.errorMap,path:l.path,parent:l.parent}}_processInputParams(l){return{status:new ParseStatus,ctx:{common:l.parent.common,data:l.data,parsedType:getParsedType(l.data),schemaErrorMap:this._def.errorMap,path:l.path,parent:l.parent}}}_parseSync(l){const c=this._parse(l);if(isAsync(c))throw new Error("Synchronous parse encountered promise.");return c}_parseAsync(l){const c=this._parse(l);return Promise.resolve(c)}parse(l,c){const d=this.safeParse(l,c);if(d.success)return d.data;throw d.error}safeParse(l,c){const d={common:{issues:[],async:c?.async??!1,contextualErrorMap:c?.errorMap},path:c?.path||[],schemaErrorMap:this._def.errorMap,parent:null,data:l,parsedType:getParsedType(l)},h=this._parseSync({data:l,path:d.path,parent:d});return handleResult(d,h)}"~validate"(l){const c={common:{issues:[],async:!!this["~standard"].async},path:[],schemaErrorMap:this._def.errorMap,parent:null,data:l,parsedType:getParsedType(l)};if(!this["~standard"].async)try{const d=this._parseSync({data:l,path:[],parent:c});return isValid(d)?{value:d.value}:{issues:c.common.issues}}catch(d){d?.message?.toLowerCase()?.includes("encountered")&&(this["~standard"].async=!0),c.common={issues:[],async:!0}}return this._parseAsync({data:l,path:[],parent:c}).then((l=>isValid(l)?{value:l.value}:{issues:c.common.issues}))}async parseAsync(l,c){const d=await this.safeParseAsync(l,c);if(d.success)return d.data;throw d.error}async safeParseAsync(l,c){const d={common:{issues:[],contextualErrorMap:c?.errorMap,async:!0},path:c?.path||[],schemaErrorMap:this._def.errorMap,parent:null,data:l,parsedType:getParsedType(l)},h=this._parse({data:l,path:d.path,parent:d}),p=await(isAsync(h)?h:Promise.resolve(h));return handleResult(d,p)}refine(l,c){const getIssueProperties=l=>"string"==typeof c||void 0===c?{message:c}:"function"==typeof c?c(l):c;return this._refinement(((c,d)=>{const h=l(c),setError=()=>d.addIssue({code:aI.custom,...getIssueProperties(c)});return"undefined"!=typeof Promise&&h instanceof Promise?h.then((l=>!!l||(setError(),!1))):!!h||(setError(),!1)}))}refinement(l,c){return this._refinement(((d,h)=>!!l(d)||(h.addIssue("function"==typeof c?c(d,h):c),!1)))}_refinement(l){return new ZodEffects({schema:this,typeName:RI.ZodEffects,effect:{type:"refinement",refinement:l}})}superRefine(l){return this._refinement(l)}constructor(l){this.spa=this.safeParseAsync,this._def=l,this.parse=this.parse.bind(this),this.safeParse=this.safeParse.bind(this),this.parseAsync=this.parseAsync.bind(this),this.safeParseAsync=this.safeParseAsync.bind(this),this.spa=this.spa.bind(this),this.refine=this.refine.bind(this),this.refinement=this.refinement.bind(this),this.superRefine=this.superRefine.bind(this),this.optional=this.optional.bind(this),this.nullable=this.nullable.bind(this),this.nullish=this.nullish.bind(this),this.array=this.array.bind(this),this.promise=this.promise.bind(this),this.or=this.or.bind(this),this.and=this.and.bind(this),this.transform=this.transform.bind(this),this.brand=this.brand.bind(this),this.default=this.default.bind(this),this.catch=this.catch.bind(this),this.describe=this.describe.bind(this),this.pipe=this.pipe.bind(this),this.readonly=this.readonly.bind(this),this.isNullable=this.isNullable.bind(this),this.isOptional=this.isOptional.bind(this),this["~standard"]={version:1,vendor:"zod",validate:l=>this["~validate"](l)}}optional(){return ZodOptional.create(this,this._def)}nullable(){return ZodNullable.create(this,this._def)}nullish(){return this.nullable().optional()}array(){return ZodArray.create(this)}promise(){return ZodPromise.create(this,this._def)}or(l){return ZodUnion.create([this,l],this._def)}and(l){return ZodIntersection.create(this,l,this._def)}transform(l){return new ZodEffects({...processCreateParams(this._def),schema:this,typeName:RI.ZodEffects,effect:{type:"transform",transform:l}})}default(l){const c="function"==typeof l?l:()=>l;return new ZodDefault({...processCreateParams(this._def),innerType:this,defaultValue:c,typeName:RI.ZodDefault})}brand(){return new ZodBranded({typeName:RI.ZodBranded,type:this,...processCreateParams(this._def)})}catch(l){const c="function"==typeof l?l:()=>l;return new ZodCatch({...processCreateParams(this._def),innerType:this,catchValue:c,typeName:RI.ZodCatch})}describe(l){return new(0,this.constructor)({...this._def,description:l})}pipe(l){return ZodPipeline.create(this,l)}readonly(){return ZodReadonly.create(this)}isOptional(){return this.safeParse(void 0).success}isNullable(){return this.safeParse(null).success}}const hI=/^c[^\s-]{8,}$/i,pI=/^[0-9a-z]+$/,fI=/^[0-9A-HJKMNP-TV-Z]{26}$/i,mI=/^[0-9a-fA-F]{8}\b-[0-9a-fA-F]{4}\b-[0-9a-fA-F]{4}\b-[0-9a-fA-F]{4}\b-[0-9a-fA-F]{12}$/i,gI=/^[a-z0-9_-]{21}$/i,vI=/^[A-Za-z0-9-_]+\.[A-Za-z0-9-_]+\.[A-Za-z0-9-_]*$/,yI=/^[-+]?P(?!$)(?:(?:[-+]?\d+Y)|(?:[-+]?\d+[.,]\d+Y$))?(?:(?:[-+]?\d+M)|(?:[-+]?\d+[.,]\d+M$))?(?:(?:[-+]?\d+W)|(?:[-+]?\d+[.,]\d+W$))?(?:(?:[-+]?\d+D)|(?:[-+]?\d+[.,]\d+D$))?(?:T(?=[\d+-])(?:(?:[-+]?\d+H)|(?:[-+]?\d+[.,]\d+H$))?(?:(?:[-+]?\d+M)|(?:[-+]?\d+[.,]\d+M$))?(?:[-+]?\d+(?:[.,]\d+)?S)?)??$/,_I=/^(?!\.)(?!.*\.\.)([A-Z0-9_'+\-\.]*)[A-Z0-9_+-]@([A-Z0-9][A-Z0-9\-]*\.)+[A-Z]{2,}$/i;let bI;const wI=/^(?:(?:25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9][0-9]|[0-9])\.){3}(?:25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9][0-9]|[0-9])$/,SI=/^(?:(?:25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9][0-9]|[0-9])\.){3}(?:25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9][0-9]|[0-9])\/(3[0-2]|[12]?[0-9])$/,xI=/^(([0-9a-fA-F]{1,4}:){7,7}[0-9a-fA-F]{1,4}|([0-9a-fA-F]{1,4}:){1,7}:|([0-9a-fA-F]{1,4}:){1,6}:[0-9a-fA-F]{1,4}|([0-9a-fA-F]{1,4}:){1,5}(:[0-9a-fA-F]{1,4}){1,2}|([0-9a-fA-F]{1,4}:){1,4}(:[0-9a-fA-F]{1,4}){1,3}|([0-9a-fA-F]{1,4}:){1,3}(:[0-9a-fA-F]{1,4}){1,4}|([0-9a-fA-F]{1,4}:){1,2}(:[0-9a-fA-F]{1,4}){1,5}|[0-9a-fA-F]{1,4}:((:[0-9a-fA-F]{1,4}){1,6})|:((:[0-9a-fA-F]{1,4}){1,7}|:)|fe80:(:[0-9a-fA-F]{0,4}){0,4}%[0-9a-zA-Z]{1,}|::(ffff(:0{1,4}){0,1}:){0,1}((25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])\.){3,3}(25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])|([0-9a-fA-F]{1,4}:){1,4}:((25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])\.){3,3}(25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9]))$/,kI=/^(([0-9a-fA-F]{1,4}:){7,7}[0-9a-fA-F]{1,4}|([0-9a-fA-F]{1,4}:){1,7}:|([0-9a-fA-F]{1,4}:){1,6}:[0-9a-fA-F]{1,4}|([0-9a-fA-F]{1,4}:){1,5}(:[0-9a-fA-F]{1,4}){1,2}|([0-9a-fA-F]{1,4}:){1,4}(:[0-9a-fA-F]{1,4}){1,3}|([0-9a-fA-F]{1,4}:){1,3}(:[0-9a-fA-F]{1,4}){1,4}|([0-9a-fA-F]{1,4}:){1,2}(:[0-9a-fA-F]{1,4}){1,5}|[0-9a-fA-F]{1,4}:((:[0-9a-fA-F]{1,4}){1,6})|:((:[0-9a-fA-F]{1,4}){1,7}|:)|fe80:(:[0-9a-fA-F]{0,4}){0,4}%[0-9a-zA-Z]{1,}|::(ffff(:0{1,4}){0,1}:){0,1}((25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])\.){3,3}(25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])|([0-9a-fA-F]{1,4}:){1,4}:((25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])\.){3,3}(25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9]))\/(12[0-8]|1[01][0-9]|[1-9]?[0-9])$/,CI=/^([0-9a-zA-Z+/]{4})*(([0-9a-zA-Z+/]{2}==)|([0-9a-zA-Z+/]{3}=))?$/,EI=/^([0-9a-zA-Z-_]{4})*(([0-9a-zA-Z-_]{2}(==)?)|([0-9a-zA-Z-_]{3}(=)?))?$/,II="((\\d\\d[2468][048]|\\d\\d[13579][26]|\\d\\d0[48]|[02468][048]00|[13579][26]00)-02-29|\\d{4}-((0[13578]|1[02])-(0[1-9]|[12]\\d|3[01])|(0[469]|11)-(0[1-9]|[12]\\d|30)|(02)-(0[1-9]|1\\d|2[0-8])))",TI=new RegExp(`^${II}$`);function timeRegexSource(l){let c="[0-5]\\d";l.precision?c=`${c}\\.\\d{${l.precision}}`:null==l.precision&&(c=`${c}(\\.\\d+)?`);return`([01]\\d|2[0-3]):[0-5]\\d(:${c})${l.precision?"+":"?"}`}function datetimeRegex(l){let c=`${II}T${timeRegexSource(l)}`;const d=[];return d.push(l.local?"Z?":"Z"),l.offset&&d.push("([+-]\\d{2}:?\\d{2})"),c=`${c}(${d.join("|")})`,new RegExp(`^${c}$`)}function isValidJWT(l,c){if(!vI.test(l))return!1;try{const[d]=l.split("."),h=d.replace(/-/g,"+").replace(/_/g,"/").padEnd(d.length+(4-d.length%4)%4,"="),p=JSON.parse(atob(h));return"object"==typeof p&&null!==p&&((!("typ"in p)||"JWT"===p?.typ)&&(!!p.alg&&(!c||p.alg===c)))}catch{return!1}}function isValidCidr(l,c){return!("v4"!==c&&c||!SI.test(l))||!("v6"!==c&&c||!kI.test(l))}class ZodString extends ZodType{_parse(l){this._def.coerce&&(l.data=String(l.data));if(this._getType(l)!==oI.string){const c=this._getOrReturnCtx(l);return addIssueToContext(c,{code:aI.invalid_type,expected:oI.string,received:c.parsedType}),cI}const c=new ParseStatus;let d;for(const f of this._def.checks)if("min"===f.kind)l.data.length<f.value&&(d=this._getOrReturnCtx(l,d),addIssueToContext(d,{code:aI.too_small,minimum:f.value,type:"string",inclusive:!0,exact:!1,message:f.message}),c.dirty());else if("max"===f.kind)l.data.length>f.value&&(d=this._getOrReturnCtx(l,d),addIssueToContext(d,{code:aI.too_big,maximum:f.value,type:"string",inclusive:!0,exact:!1,message:f.message}),c.dirty());else if("length"===f.kind){const h=l.data.length>f.value,p=l.data.length<f.value;(h||p)&&(d=this._getOrReturnCtx(l,d),h?addIssueToContext(d,{code:aI.too_big,maximum:f.value,type:"string",inclusive:!0,exact:!0,message:f.message}):p&&addIssueToContext(d,{code:aI.too_small,minimum:f.value,type:"string",inclusive:!0,exact:!0,message:f.message}),c.dirty())}else if("email"===f.kind)_I.test(l.data)||(d=this._getOrReturnCtx(l,d),addIssueToContext(d,{validation:"email",code:aI.invalid_string,message:f.message}),c.dirty());else if("emoji"===f.kind)bI||(bI=new RegExp("^(\\p{Extended_Pictographic}|\\p{Emoji_Component})+$","u")),bI.test(l.data)||(d=this._getOrReturnCtx(l,d),addIssueToContext(d,{validation:"emoji",code:aI.invalid_string,message:f.message}),c.dirty());else if("uuid"===f.kind)mI.test(l.data)||(d=this._getOrReturnCtx(l,d),addIssueToContext(d,{validation:"uuid",code:aI.invalid_string,message:f.message}),c.dirty());else if("nanoid"===f.kind)gI.test(l.data)||(d=this._getOrReturnCtx(l,d),addIssueToContext(d,{validation:"nanoid",code:aI.invalid_string,message:f.message}),c.dirty());else if("cuid"===f.kind)hI.test(l.data)||(d=this._getOrReturnCtx(l,d),addIssueToContext(d,{validation:"cuid",code:aI.invalid_string,message:f.message}),c.dirty());else if("cuid2"===f.kind)pI.test(l.data)||(d=this._getOrReturnCtx(l,d),addIssueToContext(d,{validation:"cuid2",code:aI.invalid_string,message:f.message}),c.dirty());else if("ulid"===f.kind)fI.test(l.data)||(d=this._getOrReturnCtx(l,d),addIssueToContext(d,{validation:"ulid",code:aI.invalid_string,message:f.message}),c.dirty());else if("url"===f.kind)try{new URL(l.data)}catch{d=this._getOrReturnCtx(l,d),addIssueToContext(d,{validation:"url",code:aI.invalid_string,message:f.message}),c.dirty()}else if("regex"===f.kind){f.regex.lastIndex=0;f.regex.test(l.data)||(d=this._getOrReturnCtx(l,d),addIssueToContext(d,{validation:"regex",code:aI.invalid_string,message:f.message}),c.dirty())}else if("trim"===f.kind)l.data=l.data.trim();else if("includes"===f.kind)l.data.includes(f.value,f.position)||(d=this._getOrReturnCtx(l,d),addIssueToContext(d,{code:aI.invalid_string,validation:{includes:f.value,position:f.position},message:f.message}),c.dirty());else if("toLowerCase"===f.kind)l.data=l.data.toLowerCase();else if("toUpperCase"===f.kind)l.data=l.data.toUpperCase();else if("startsWith"===f.kind)l.data.startsWith(f.value)||(d=this._getOrReturnCtx(l,d),addIssueToContext(d,{code:aI.invalid_string,validation:{startsWith:f.value},message:f.message}),c.dirty());else if("endsWith"===f.kind)l.data.endsWith(f.value)||(d=this._getOrReturnCtx(l,d),addIssueToContext(d,{code:aI.invalid_string,validation:{endsWith:f.value},message:f.message}),c.dirty());else if("datetime"===f.kind){datetimeRegex(f).test(l.data)||(d=this._getOrReturnCtx(l,d),addIssueToContext(d,{code:aI.invalid_string,validation:"datetime",message:f.message}),c.dirty())}else if("date"===f.kind){TI.test(l.data)||(d=this._getOrReturnCtx(l,d),addIssueToContext(d,{code:aI.invalid_string,validation:"date",message:f.message}),c.dirty())}else if("time"===f.kind){new RegExp(`^${timeRegexSource(f)}$`).test(l.data)||(d=this._getOrReturnCtx(l,d),addIssueToContext(d,{code:aI.invalid_string,validation:"time",message:f.message}),c.dirty())}else"duration"===f.kind?yI.test(l.data)||(d=this._getOrReturnCtx(l,d),addIssueToContext(d,{validation:"duration",code:aI.invalid_string,message:f.message}),c.dirty()):"ip"===f.kind?(h=l.data,("v4"!==(p=f.version)&&p||!wI.test(h))&&("v6"!==p&&p||!xI.test(h))&&(d=this._getOrReturnCtx(l,d),addIssueToContext(d,{validation:"ip",code:aI.invalid_string,message:f.message}),c.dirty())):"jwt"===f.kind?isValidJWT(l.data,f.alg)||(d=this._getOrReturnCtx(l,d),addIssueToContext(d,{validation:"jwt",code:aI.invalid_string,message:f.message}),c.dirty()):"cidr"===f.kind?isValidCidr(l.data,f.version)||(d=this._getOrReturnCtx(l,d),addIssueToContext(d,{validation:"cidr",code:aI.invalid_string,message:f.message}),c.dirty()):"base64"===f.kind?CI.test(l.data)||(d=this._getOrReturnCtx(l,d),addIssueToContext(d,{validation:"base64",code:aI.invalid_string,message:f.message}),c.dirty()):"base64url"===f.kind?EI.test(l.data)||(d=this._getOrReturnCtx(l,d),addIssueToContext(d,{validation:"base64url",code:aI.invalid_string,message:f.message}),c.dirty()):nI.assertNever(f);var h,p;return{status:c.value,value:l.data}}_regex(l,c,d){return this.refinement((c=>l.test(c)),{validation:c,code:aI.invalid_string,...uI.errToObj(d)})}_addCheck(l){return new ZodString({...this._def,checks:[...this._def.checks,l]})}email(l){return this._addCheck({kind:"email",...uI.errToObj(l)})}url(l){return this._addCheck({kind:"url",...uI.errToObj(l)})}emoji(l){return this._addCheck({kind:"emoji",...uI.errToObj(l)})}uuid(l){return this._addCheck({kind:"uuid",...uI.errToObj(l)})}nanoid(l){return this._addCheck({kind:"nanoid",...uI.errToObj(l)})}cuid(l){return this._addCheck({kind:"cuid",...uI.errToObj(l)})}cuid2(l){return this._addCheck({kind:"cuid2",...uI.errToObj(l)})}ulid(l){return this._addCheck({kind:"ulid",...uI.errToObj(l)})}base64(l){return this._addCheck({kind:"base64",...uI.errToObj(l)})}base64url(l){return this._addCheck({kind:"base64url",...uI.errToObj(l)})}jwt(l){return this._addCheck({kind:"jwt",...uI.errToObj(l)})}ip(l){return this._addCheck({kind:"ip",...uI.errToObj(l)})}cidr(l){return this._addCheck({kind:"cidr",...uI.errToObj(l)})}datetime(l){return"string"==typeof l?this._addCheck({kind:"datetime",precision:null,offset:!1,local:!1,message:l}):this._addCheck({kind:"datetime",precision:void 0===l?.precision?null:l?.precision,offset:l?.offset??!1,local:l?.local??!1,...uI.errToObj(l?.message)})}date(l){return this._addCheck({kind:"date",message:l})}time(l){return"string"==typeof l?this._addCheck({kind:"time",precision:null,message:l}):this._addCheck({kind:"time",precision:void 0===l?.precision?null:l?.precision,...uI.errToObj(l?.message)})}duration(l){return this._addCheck({kind:"duration",...uI.errToObj(l)})}regex(l,c){return this._addCheck({kind:"regex",regex:l,...uI.errToObj(c)})}includes(l,c){return this._addCheck({kind:"includes",value:l,position:c?.position,...uI.errToObj(c?.message)})}startsWith(l,c){return this._addCheck({kind:"startsWith",value:l,...uI.errToObj(c)})}endsWith(l,c){return this._addCheck({kind:"endsWith",value:l,...uI.errToObj(c)})}min(l,c){return this._addCheck({kind:"min",value:l,...uI.errToObj(c)})}max(l,c){return this._addCheck({kind:"max",value:l,...uI.errToObj(c)})}length(l,c){return this._addCheck({kind:"length",value:l,...uI.errToObj(c)})}nonempty(l){return this.min(1,uI.errToObj(l))}trim(){return new ZodString({...this._def,checks:[...this._def.checks,{kind:"trim"}]})}toLowerCase(){return new ZodString({...this._def,checks:[...this._def.checks,{kind:"toLowerCase"}]})}toUpperCase(){return new ZodString({...this._def,checks:[...this._def.checks,{kind:"toUpperCase"}]})}get isDatetime(){return!!this._def.checks.find((l=>"datetime"===l.kind))}get isDate(){return!!this._def.checks.find((l=>"date"===l.kind))}get isTime(){return!!this._def.checks.find((l=>"time"===l.kind))}get isDuration(){return!!this._def.checks.find((l=>"duration"===l.kind))}get isEmail(){return!!this._def.checks.find((l=>"email"===l.kind))}get isURL(){return!!this._def.checks.find((l=>"url"===l.kind))}get isEmoji(){return!!this._def.checks.find((l=>"emoji"===l.kind))}get isUUID(){return!!this._def.checks.find((l=>"uuid"===l.kind))}get isNANOID(){return!!this._def.checks.find((l=>"nanoid"===l.kind))}get isCUID(){return!!this._def.checks.find((l=>"cuid"===l.kind))}get isCUID2(){return!!this._def.checks.find((l=>"cuid2"===l.kind))}get isULID(){return!!this._def.checks.find((l=>"ulid"===l.kind))}get isIP(){return!!this._def.checks.find((l=>"ip"===l.kind))}get isCIDR(){return!!this._def.checks.find((l=>"cidr"===l.kind))}get isBase64(){return!!this._def.checks.find((l=>"base64"===l.kind))}get isBase64url(){return!!this._def.checks.find((l=>"base64url"===l.kind))}get minLength(){let l=null;for(const c of this._def.checks)"min"===c.kind&&(null===l||c.value>l)&&(l=c.value);return l}get maxLength(){let l=null;for(const c of this._def.checks)"max"===c.kind&&(null===l||c.value<l)&&(l=c.value);return l}}function floatSafeRemainder(l,c){const d=(l.toString().split(".")[1]||"").length,h=(c.toString().split(".")[1]||"").length,p=d>h?d:h;return Number.parseInt(l.toFixed(p).replace(".",""))%Number.parseInt(c.toFixed(p).replace(".",""))/10**p}ZodString.create=l=>new ZodString({checks:[],typeName:RI.ZodString,coerce:l?.coerce??!1,...processCreateParams(l)});class ZodNumber extends ZodType{constructor(){super(...arguments),this.min=this.gte,this.max=this.lte,this.step=this.multipleOf}_parse(l){this._def.coerce&&(l.data=Number(l.data));if(this._getType(l)!==oI.number){const c=this._getOrReturnCtx(l);return addIssueToContext(c,{code:aI.invalid_type,expected:oI.number,received:c.parsedType}),cI}let c;const d=new ParseStatus;for(const h of this._def.checks)if("int"===h.kind)nI.isInteger(l.data)||(c=this._getOrReturnCtx(l,c),addIssueToContext(c,{code:aI.invalid_type,expected:"integer",received:"float",message:h.message}),d.dirty());else if("min"===h.kind){(h.inclusive?l.data<h.value:l.data<=h.value)&&(c=this._getOrReturnCtx(l,c),addIssueToContext(c,{code:aI.too_small,minimum:h.value,type:"number",inclusive:h.inclusive,exact:!1,message:h.message}),d.dirty())}else if("max"===h.kind){(h.inclusive?l.data>h.value:l.data>=h.value)&&(c=this._getOrReturnCtx(l,c),addIssueToContext(c,{code:aI.too_big,maximum:h.value,type:"number",inclusive:h.inclusive,exact:!1,message:h.message}),d.dirty())}else"multipleOf"===h.kind?0!==floatSafeRemainder(l.data,h.value)&&(c=this._getOrReturnCtx(l,c),addIssueToContext(c,{code:aI.not_multiple_of,multipleOf:h.value,message:h.message}),d.dirty()):"finite"===h.kind?Number.isFinite(l.data)||(c=this._getOrReturnCtx(l,c),addIssueToContext(c,{code:aI.not_finite,message:h.message}),d.dirty()):nI.assertNever(h);return{status:d.value,value:l.data}}gte(l,c){return this.setLimit("min",l,!0,uI.toString(c))}gt(l,c){return this.setLimit("min",l,!1,uI.toString(c))}lte(l,c){return this.setLimit("max",l,!0,uI.toString(c))}lt(l,c){return this.setLimit("max",l,!1,uI.toString(c))}setLimit(l,c,d,h){return new ZodNumber({...this._def,checks:[...this._def.checks,{kind:l,value:c,inclusive:d,message:uI.toString(h)}]})}_addCheck(l){return new ZodNumber({...this._def,checks:[...this._def.checks,l]})}int(l){return this._addCheck({kind:"int",message:uI.toString(l)})}positive(l){return this._addCheck({kind:"min",value:0,inclusive:!1,message:uI.toString(l)})}negative(l){return this._addCheck({kind:"max",value:0,inclusive:!1,message:uI.toString(l)})}nonpositive(l){return this._addCheck({kind:"max",value:0,inclusive:!0,message:uI.toString(l)})}nonnegative(l){return this._addCheck({kind:"min",value:0,inclusive:!0,message:uI.toString(l)})}multipleOf(l,c){return this._addCheck({kind:"multipleOf",value:l,message:uI.toString(c)})}finite(l){return this._addCheck({kind:"finite",message:uI.toString(l)})}safe(l){return this._addCheck({kind:"min",inclusive:!0,value:Number.MIN_SAFE_INTEGER,message:uI.toString(l)})._addCheck({kind:"max",inclusive:!0,value:Number.MAX_SAFE_INTEGER,message:uI.toString(l)})}get minValue(){let l=null;for(const c of this._def.checks)"min"===c.kind&&(null===l||c.value>l)&&(l=c.value);return l}get maxValue(){let l=null;for(const c of this._def.checks)"max"===c.kind&&(null===l||c.value<l)&&(l=c.value);return l}get isInt(){return!!this._def.checks.find((l=>"int"===l.kind||"multipleOf"===l.kind&&nI.isInteger(l.value)))}get isFinite(){let l=null,c=null;for(const d of this._def.checks){if("finite"===d.kind||"int"===d.kind||"multipleOf"===d.kind)return!0;"min"===d.kind?(null===c||d.value>c)&&(c=d.value):"max"===d.kind&&(null===l||d.value<l)&&(l=d.value)}return Number.isFinite(c)&&Number.isFinite(l)}}ZodNumber.create=l=>new ZodNumber({checks:[],typeName:RI.ZodNumber,coerce:l?.coerce||!1,...processCreateParams(l)});class ZodBigInt extends ZodType{constructor(){super(...arguments),this.min=this.gte,this.max=this.lte}_parse(l){if(this._def.coerce)try{l.data=BigInt(l.data)}catch{return this._getInvalidInput(l)}if(this._getType(l)!==oI.bigint)return this._getInvalidInput(l);let c;const d=new ParseStatus;for(const h of this._def.checks)if("min"===h.kind){(h.inclusive?l.data<h.value:l.data<=h.value)&&(c=this._getOrReturnCtx(l,c),addIssueToContext(c,{code:aI.too_small,type:"bigint",minimum:h.value,inclusive:h.inclusive,message:h.message}),d.dirty())}else if("max"===h.kind){(h.inclusive?l.data>h.value:l.data>=h.value)&&(c=this._getOrReturnCtx(l,c),addIssueToContext(c,{code:aI.too_big,type:"bigint",maximum:h.value,inclusive:h.inclusive,message:h.message}),d.dirty())}else"multipleOf"===h.kind?l.data%h.value!==BigInt(0)&&(c=this._getOrReturnCtx(l,c),addIssueToContext(c,{code:aI.not_multiple_of,multipleOf:h.value,message:h.message}),d.dirty()):nI.assertNever(h);return{status:d.value,value:l.data}}_getInvalidInput(l){const c=this._getOrReturnCtx(l);return addIssueToContext(c,{code:aI.invalid_type,expected:oI.bigint,received:c.parsedType}),cI}gte(l,c){return this.setLimit("min",l,!0,uI.toString(c))}gt(l,c){return this.setLimit("min",l,!1,uI.toString(c))}lte(l,c){return this.setLimit("max",l,!0,uI.toString(c))}lt(l,c){return this.setLimit("max",l,!1,uI.toString(c))}setLimit(l,c,d,h){return new ZodBigInt({...this._def,checks:[...this._def.checks,{kind:l,value:c,inclusive:d,message:uI.toString(h)}]})}_addCheck(l){return new ZodBigInt({...this._def,checks:[...this._def.checks,l]})}positive(l){return this._addCheck({kind:"min",value:BigInt(0),inclusive:!1,message:uI.toString(l)})}negative(l){return this._addCheck({kind:"max",value:BigInt(0),inclusive:!1,message:uI.toString(l)})}nonpositive(l){return this._addCheck({kind:"max",value:BigInt(0),inclusive:!0,message:uI.toString(l)})}nonnegative(l){return this._addCheck({kind:"min",value:BigInt(0),inclusive:!0,message:uI.toString(l)})}multipleOf(l,c){return this._addCheck({kind:"multipleOf",value:l,message:uI.toString(c)})}get minValue(){let l=null;for(const c of this._def.checks)"min"===c.kind&&(null===l||c.value>l)&&(l=c.value);return l}get maxValue(){let l=null;for(const c of this._def.checks)"max"===c.kind&&(null===l||c.value<l)&&(l=c.value);return l}}ZodBigInt.create=l=>new ZodBigInt({checks:[],typeName:RI.ZodBigInt,coerce:l?.coerce??!1,...processCreateParams(l)});class ZodBoolean extends ZodType{_parse(l){this._def.coerce&&(l.data=Boolean(l.data));if(this._getType(l)!==oI.boolean){const c=this._getOrReturnCtx(l);return addIssueToContext(c,{code:aI.invalid_type,expected:oI.boolean,received:c.parsedType}),cI}return OK(l.data)}}ZodBoolean.create=l=>new ZodBoolean({typeName:RI.ZodBoolean,coerce:l?.coerce||!1,...processCreateParams(l)});class ZodDate extends ZodType{_parse(l){this._def.coerce&&(l.data=new Date(l.data));if(this._getType(l)!==oI.date){const c=this._getOrReturnCtx(l);return addIssueToContext(c,{code:aI.invalid_type,expected:oI.date,received:c.parsedType}),cI}if(Number.isNaN(l.data.getTime())){return addIssueToContext(this._getOrReturnCtx(l),{code:aI.invalid_date}),cI}const c=new ParseStatus;let d;for(const h of this._def.checks)"min"===h.kind?l.data.getTime()<h.value&&(d=this._getOrReturnCtx(l,d),addIssueToContext(d,{code:aI.too_small,message:h.message,inclusive:!0,exact:!1,minimum:h.value,type:"date"}),c.dirty()):"max"===h.kind?l.data.getTime()>h.value&&(d=this._getOrReturnCtx(l,d),addIssueToContext(d,{code:aI.too_big,message:h.message,inclusive:!0,exact:!1,maximum:h.value,type:"date"}),c.dirty()):nI.assertNever(h);return{status:c.value,value:new Date(l.data.getTime())}}_addCheck(l){return new ZodDate({...this._def,checks:[...this._def.checks,l]})}min(l,c){return this._addCheck({kind:"min",value:l.getTime(),message:uI.toString(c)})}max(l,c){return this._addCheck({kind:"max",value:l.getTime(),message:uI.toString(c)})}get minDate(){let l=null;for(const c of this._def.checks)"min"===c.kind&&(null===l||c.value>l)&&(l=c.value);return null!=l?new Date(l):null}get maxDate(){let l=null;for(const c of this._def.checks)"max"===c.kind&&(null===l||c.value<l)&&(l=c.value);return null!=l?new Date(l):null}}ZodDate.create=l=>new ZodDate({checks:[],coerce:l?.coerce||!1,typeName:RI.ZodDate,...processCreateParams(l)});class ZodSymbol extends ZodType{_parse(l){if(this._getType(l)!==oI.symbol){const c=this._getOrReturnCtx(l);return addIssueToContext(c,{code:aI.invalid_type,expected:oI.symbol,received:c.parsedType}),cI}return OK(l.data)}}ZodSymbol.create=l=>new ZodSymbol({typeName:RI.ZodSymbol,...processCreateParams(l)});class ZodUndefined extends ZodType{_parse(l){if(this._getType(l)!==oI.undefined){const c=this._getOrReturnCtx(l);return addIssueToContext(c,{code:aI.invalid_type,expected:oI.undefined,received:c.parsedType}),cI}return OK(l.data)}}ZodUndefined.create=l=>new ZodUndefined({typeName:RI.ZodUndefined,...processCreateParams(l)});class ZodNull extends ZodType{_parse(l){if(this._getType(l)!==oI.null){const c=this._getOrReturnCtx(l);return addIssueToContext(c,{code:aI.invalid_type,expected:oI.null,received:c.parsedType}),cI}return OK(l.data)}}ZodNull.create=l=>new ZodNull({typeName:RI.ZodNull,...processCreateParams(l)});class ZodAny extends ZodType{constructor(){super(...arguments),this._any=!0}_parse(l){return OK(l.data)}}ZodAny.create=l=>new ZodAny({typeName:RI.ZodAny,...processCreateParams(l)});class ZodUnknown extends ZodType{constructor(){super(...arguments),this._unknown=!0}_parse(l){return OK(l.data)}}ZodUnknown.create=l=>new ZodUnknown({typeName:RI.ZodUnknown,...processCreateParams(l)});class ZodNever extends ZodType{_parse(l){const c=this._getOrReturnCtx(l);return addIssueToContext(c,{code:aI.invalid_type,expected:oI.never,received:c.parsedType}),cI}}ZodNever.create=l=>new ZodNever({typeName:RI.ZodNever,...processCreateParams(l)});class ZodVoid extends ZodType{_parse(l){if(this._getType(l)!==oI.undefined){const c=this._getOrReturnCtx(l);return addIssueToContext(c,{code:aI.invalid_type,expected:oI.void,received:c.parsedType}),cI}return OK(l.data)}}ZodVoid.create=l=>new ZodVoid({typeName:RI.ZodVoid,...processCreateParams(l)});class ZodArray extends ZodType{_parse(l){const{ctx:c,status:d}=this._processInputParams(l),h=this._def;if(c.parsedType!==oI.array)return addIssueToContext(c,{code:aI.invalid_type,expected:oI.array,received:c.parsedType}),cI;if(null!==h.exactLength){const l=c.data.length>h.exactLength.value,p=c.data.length<h.exactLength.value;(l||p)&&(addIssueToContext(c,{code:l?aI.too_big:aI.too_small,minimum:p?h.exactLength.value:void 0,maximum:l?h.exactLength.value:void 0,type:"array",inclusive:!0,exact:!0,message:h.exactLength.message}),d.dirty())}if(null!==h.minLength&&c.data.length<h.minLength.value&&(addIssueToContext(c,{code:aI.too_small,minimum:h.minLength.value,type:"array",inclusive:!0,exact:!1,message:h.minLength.message}),d.dirty()),null!==h.maxLength&&c.data.length>h.maxLength.value&&(addIssueToContext(c,{code:aI.too_big,maximum:h.maxLength.value,type:"array",inclusive:!0,exact:!1,message:h.maxLength.message}),d.dirty()),c.common.async)return Promise.all([...c.data].map(((l,d)=>h.type._parseAsync(new ParseInputLazyPath(c,l,c.path,d))))).then((l=>ParseStatus.mergeArray(d,l)));const p=[...c.data].map(((l,d)=>h.type._parseSync(new ParseInputLazyPath(c,l,c.path,d))));return ParseStatus.mergeArray(d,p)}get element(){return this._def.type}min(l,c){return new ZodArray({...this._def,minLength:{value:l,message:uI.toString(c)}})}max(l,c){return new ZodArray({...this._def,maxLength:{value:l,message:uI.toString(c)}})}length(l,c){return new ZodArray({...this._def,exactLength:{value:l,message:uI.toString(c)}})}nonempty(l){return this.min(1,l)}}function deepPartialify(l){if(l instanceof ZodObject){const c={};for(const d in l.shape){const h=l.shape[d];c[d]=ZodOptional.create(deepPartialify(h))}return new ZodObject({...l._def,shape:()=>c})}return l instanceof ZodArray?new ZodArray({...l._def,type:deepPartialify(l.element)}):l instanceof ZodOptional?ZodOptional.create(deepPartialify(l.unwrap())):l instanceof ZodNullable?ZodNullable.create(deepPartialify(l.unwrap())):l instanceof ZodTuple?ZodTuple.create(l.items.map((l=>deepPartialify(l)))):l}ZodArray.create=(l,c)=>new ZodArray({type:l,minLength:null,maxLength:null,exactLength:null,typeName:RI.ZodArray,...processCreateParams(c)});class ZodObject extends ZodType{constructor(){super(...arguments),this._cached=null,this.nonstrict=this.passthrough,this.augment=this.extend}_getCached(){if(null!==this._cached)return this._cached;const l=this._def.shape(),c=nI.objectKeys(l);return this._cached={shape:l,keys:c},this._cached}_parse(l){if(this._getType(l)!==oI.object){const c=this._getOrReturnCtx(l);return addIssueToContext(c,{code:aI.invalid_type,expected:oI.object,received:c.parsedType}),cI}const{status:c,ctx:d}=this._processInputParams(l),{shape:h,keys:p}=this._getCached(),f=[];if(!(this._def.catchall instanceof ZodNever&&"strip"===this._def.unknownKeys))for(const y in d.data)p.includes(y)||f.push(y);const m=[];for(const y of p){const l=h[y],c=d.data[y];m.push({key:{status:"valid",value:y},value:l._parse(new ParseInputLazyPath(d,c,d.path,y)),alwaysSet:y in d.data})}if(this._def.catchall instanceof ZodNever){const l=this._def.unknownKeys;if("passthrough"===l)for(const c of f)m.push({key:{status:"valid",value:c},value:{status:"valid",value:d.data[c]}});else if("strict"===l)f.length>0&&(addIssueToContext(d,{code:aI.unrecognized_keys,keys:f}),c.dirty());else if("strip"!==l)throw new Error("Internal ZodObject error: invalid unknownKeys value.")}else{const l=this._def.catchall;for(const c of f){const h=d.data[c];m.push({key:{status:"valid",value:c},value:l._parse(new ParseInputLazyPath(d,h,d.path,c)),alwaysSet:c in d.data})}}return d.common.async?Promise.resolve().then((async()=>{const l=[];for(const c of m){const d=await c.key,h=await c.value;l.push({key:d,value:h,alwaysSet:c.alwaysSet})}return l})).then((l=>ParseStatus.mergeObjectSync(c,l))):ParseStatus.mergeObjectSync(c,m)}get shape(){return this._def.shape()}strict(l){return uI.errToObj,new ZodObject({...this._def,unknownKeys:"strict",...void 0!==l?{errorMap:(c,d)=>{const h=this._def.errorMap?.(c,d).message??d.defaultError;return"unrecognized_keys"===c.code?{message:uI.errToObj(l).message??h}:{message:h}}}:{}})}strip(){return new ZodObject({...this._def,unknownKeys:"strip"})}passthrough(){return new ZodObject({...this._def,unknownKeys:"passthrough"})}extend(l){return new ZodObject({...this._def,shape:()=>({...this._def.shape(),...l})})}merge(l){return new ZodObject({unknownKeys:l._def.unknownKeys,catchall:l._def.catchall,shape:()=>({...this._def.shape(),...l._def.shape()}),typeName:RI.ZodObject})}setKey(l,c){return this.augment({[l]:c})}catchall(l){return new ZodObject({...this._def,catchall:l})}pick(l){const c={};for(const d of nI.objectKeys(l))l[d]&&this.shape[d]&&(c[d]=this.shape[d]);return new ZodObject({...this._def,shape:()=>c})}omit(l){const c={};for(const d of nI.objectKeys(this.shape))l[d]||(c[d]=this.shape[d]);return new ZodObject({...this._def,shape:()=>c})}deepPartial(){return deepPartialify(this)}partial(l){const c={};for(const d of nI.objectKeys(this.shape)){const h=this.shape[d];l&&!l[d]?c[d]=h:c[d]=h.optional()}return new ZodObject({...this._def,shape:()=>c})}required(l){const c={};for(const d of nI.objectKeys(this.shape))if(l&&!l[d])c[d]=this.shape[d];else{let l=this.shape[d];for(;l instanceof ZodOptional;)l=l._def.innerType;c[d]=l}return new ZodObject({...this._def,shape:()=>c})}keyof(){return createZodEnum(nI.objectKeys(this.shape))}}ZodObject.create=(l,c)=>new ZodObject({shape:()=>l,unknownKeys:"strip",catchall:ZodNever.create(),typeName:RI.ZodObject,...processCreateParams(c)}),ZodObject.strictCreate=(l,c)=>new ZodObject({shape:()=>l,unknownKeys:"strict",catchall:ZodNever.create(),typeName:RI.ZodObject,...processCreateParams(c)}),ZodObject.lazycreate=(l,c)=>new ZodObject({shape:l,unknownKeys:"strip",catchall:ZodNever.create(),typeName:RI.ZodObject,...processCreateParams(c)});class ZodUnion extends ZodType{_parse(l){const{ctx:c}=this._processInputParams(l),d=this._def.options;if(c.common.async)return Promise.all(d.map((async l=>{const d={...c,common:{...c.common,issues:[]},parent:null};return{result:await l._parseAsync({data:c.data,path:c.path,parent:d}),ctx:d}}))).then((function(l){for(const c of l)if("valid"===c.result.status)return c.result;for(const h of l)if("dirty"===h.result.status)return c.common.issues.push(...h.ctx.common.issues),h.result;const d=l.map((l=>new ZodError(l.ctx.common.issues)));return addIssueToContext(c,{code:aI.invalid_union,unionErrors:d}),cI}));{let l;const h=[];for(const f of d){const d={...c,common:{...c.common,issues:[]},parent:null},p=f._parseSync({data:c.data,path:c.path,parent:d});if("valid"===p.status)return p;"dirty"!==p.status||l||(l={result:p,ctx:d}),d.common.issues.length&&h.push(d.common.issues)}if(l)return c.common.issues.push(...l.ctx.common.issues),l.result;const p=h.map((l=>new ZodError(l)));return addIssueToContext(c,{code:aI.invalid_union,unionErrors:p}),cI}}get options(){return this._def.options}}function mergeValues(l,c){const d=getParsedType(l),h=getParsedType(c);if(l===c)return{valid:!0,data:l};if(d===oI.object&&h===oI.object){const d=nI.objectKeys(c),h=nI.objectKeys(l).filter((l=>-1!==d.indexOf(l))),p={...l,...c};for(const f of h){const d=mergeValues(l[f],c[f]);if(!d.valid)return{valid:!1};p[f]=d.data}return{valid:!0,data:p}}if(d===oI.array&&h===oI.array){if(l.length!==c.length)return{valid:!1};const d=[];for(let h=0;h<l.length;h++){const p=mergeValues(l[h],c[h]);if(!p.valid)return{valid:!1};d.push(p.data)}return{valid:!0,data:d}}return d===oI.date&&h===oI.date&&+l==+c?{valid:!0,data:l}:{valid:!1}}ZodUnion.create=(l,c)=>new ZodUnion({options:l,typeName:RI.ZodUnion,...processCreateParams(c)});class ZodIntersection extends ZodType{_parse(l){const{status:c,ctx:d}=this._processInputParams(l),handleParsed=(l,h)=>{if(isAborted(l)||isAborted(h))return cI;const p=mergeValues(l.value,h.value);return p.valid?((isDirty(l)||isDirty(h))&&c.dirty(),{status:c.value,value:p.data}):(addIssueToContext(d,{code:aI.invalid_intersection_types}),cI)};return d.common.async?Promise.all([this._def.left._parseAsync({data:d.data,path:d.path,parent:d}),this._def.right._parseAsync({data:d.data,path:d.path,parent:d})]).then((([l,c])=>handleParsed(l,c))):handleParsed(this._def.left._parseSync({data:d.data,path:d.path,parent:d}),this._def.right._parseSync({data:d.data,path:d.path,parent:d}))}}ZodIntersection.create=(l,c,d)=>new ZodIntersection({left:l,right:c,typeName:RI.ZodIntersection,...processCreateParams(d)});class ZodTuple extends ZodType{_parse(l){const{status:c,ctx:d}=this._processInputParams(l);if(d.parsedType!==oI.array)return addIssueToContext(d,{code:aI.invalid_type,expected:oI.array,received:d.parsedType}),cI;if(d.data.length<this._def.items.length)return addIssueToContext(d,{code:aI.too_small,minimum:this._def.items.length,inclusive:!0,exact:!1,type:"array"}),cI;!this._def.rest&&d.data.length>this._def.items.length&&(addIssueToContext(d,{code:aI.too_big,maximum:this._def.items.length,inclusive:!0,exact:!1,type:"array"}),c.dirty());const h=[...d.data].map(((l,c)=>{const h=this._def.items[c]||this._def.rest;return h?h._parse(new ParseInputLazyPath(d,l,d.path,c)):null})).filter((l=>!!l));return d.common.async?Promise.all(h).then((l=>ParseStatus.mergeArray(c,l))):ParseStatus.mergeArray(c,h)}get items(){return this._def.items}rest(l){return new ZodTuple({...this._def,rest:l})}}ZodTuple.create=(l,c)=>{if(!Array.isArray(l))throw new Error("You must pass an array of schemas to z.tuple([ ... ])");return new ZodTuple({items:l,typeName:RI.ZodTuple,rest:null,...processCreateParams(c)})};class ZodMap extends ZodType{get keySchema(){return this._def.keyType}get valueSchema(){return this._def.valueType}_parse(l){const{status:c,ctx:d}=this._processInputParams(l);if(d.parsedType!==oI.map)return addIssueToContext(d,{code:aI.invalid_type,expected:oI.map,received:d.parsedType}),cI;const h=this._def.keyType,p=this._def.valueType,f=[...d.data.entries()].map((([l,c],f)=>({key:h._parse(new ParseInputLazyPath(d,l,d.path,[f,"key"])),value:p._parse(new ParseInputLazyPath(d,c,d.path,[f,"value"]))})));if(d.common.async){const l=new Map;return Promise.resolve().then((async()=>{for(const d of f){const h=await d.key,p=await d.value;if("aborted"===h.status||"aborted"===p.status)return cI;"dirty"!==h.status&&"dirty"!==p.status||c.dirty(),l.set(h.value,p.value)}return{status:c.value,value:l}}))}{const l=new Map;for(const d of f){const h=d.key,p=d.value;if("aborted"===h.status||"aborted"===p.status)return cI;"dirty"!==h.status&&"dirty"!==p.status||c.dirty(),l.set(h.value,p.value)}return{status:c.value,value:l}}}}ZodMap.create=(l,c,d)=>new ZodMap({valueType:c,keyType:l,typeName:RI.ZodMap,...processCreateParams(d)});class ZodSet extends ZodType{_parse(l){const{status:c,ctx:d}=this._processInputParams(l);if(d.parsedType!==oI.set)return addIssueToContext(d,{code:aI.invalid_type,expected:oI.set,received:d.parsedType}),cI;const h=this._def;null!==h.minSize&&d.data.size<h.minSize.value&&(addIssueToContext(d,{code:aI.too_small,minimum:h.minSize.value,type:"set",inclusive:!0,exact:!1,message:h.minSize.message}),c.dirty()),null!==h.maxSize&&d.data.size>h.maxSize.value&&(addIssueToContext(d,{code:aI.too_big,maximum:h.maxSize.value,type:"set",inclusive:!0,exact:!1,message:h.maxSize.message}),c.dirty());const p=this._def.valueType;function finalizeSet(l){const d=new Set;for(const h of l){if("aborted"===h.status)return cI;"dirty"===h.status&&c.dirty(),d.add(h.value)}return{status:c.value,value:d}}const f=[...d.data.values()].map(((l,c)=>p._parse(new ParseInputLazyPath(d,l,d.path,c))));return d.common.async?Promise.all(f).then((l=>finalizeSet(l))):finalizeSet(f)}min(l,c){return new ZodSet({...this._def,minSize:{value:l,message:uI.toString(c)}})}max(l,c){return new ZodSet({...this._def,maxSize:{value:l,message:uI.toString(c)}})}size(l,c){return this.min(l,c).max(l,c)}nonempty(l){return this.min(1,l)}}ZodSet.create=(l,c)=>new ZodSet({valueType:l,minSize:null,maxSize:null,typeName:RI.ZodSet,...processCreateParams(c)});class ZodLazy extends ZodType{get schema(){return this._def.getter()}_parse(l){const{ctx:c}=this._processInputParams(l);return this._def.getter()._parse({data:c.data,path:c.path,parent:c})}}ZodLazy.create=(l,c)=>new ZodLazy({getter:l,typeName:RI.ZodLazy,...processCreateParams(c)});class ZodLiteral extends ZodType{_parse(l){if(l.data!==this._def.value){const c=this._getOrReturnCtx(l);return addIssueToContext(c,{received:c.data,code:aI.invalid_literal,expected:this._def.value}),cI}return{status:"valid",value:l.data}}get value(){return this._def.value}}function createZodEnum(l,c){return new ZodEnum({values:l,typeName:RI.ZodEnum,...processCreateParams(c)})}ZodLiteral.create=(l,c)=>new ZodLiteral({value:l,typeName:RI.ZodLiteral,...processCreateParams(c)});class ZodEnum extends ZodType{_parse(l){if("string"!=typeof l.data){const c=this._getOrReturnCtx(l),d=this._def.values;return addIssueToContext(c,{expected:nI.joinValues(d),received:c.parsedType,code:aI.invalid_type}),cI}if(this._cache||(this._cache=new Set(this._def.values)),!this._cache.has(l.data)){const c=this._getOrReturnCtx(l),d=this._def.values;return addIssueToContext(c,{received:c.data,code:aI.invalid_enum_value,options:d}),cI}return OK(l.data)}get options(){return this._def.values}get enum(){const l={};for(const c of this._def.values)l[c]=c;return l}get Values(){const l={};for(const c of this._def.values)l[c]=c;return l}get Enum(){const l={};for(const c of this._def.values)l[c]=c;return l}extract(l,c=this._def){return ZodEnum.create(l,{...this._def,...c})}exclude(l,c=this._def){return ZodEnum.create(this.options.filter((c=>!l.includes(c))),{...this._def,...c})}}ZodEnum.create=createZodEnum;class ZodNativeEnum extends ZodType{_parse(l){const c=nI.getValidEnumValues(this._def.values),d=this._getOrReturnCtx(l);if(d.parsedType!==oI.string&&d.parsedType!==oI.number){const l=nI.objectValues(c);return addIssueToContext(d,{expected:nI.joinValues(l),received:d.parsedType,code:aI.invalid_type}),cI}if(this._cache||(this._cache=new Set(nI.getValidEnumValues(this._def.values))),!this._cache.has(l.data)){const l=nI.objectValues(c);return addIssueToContext(d,{received:d.data,code:aI.invalid_enum_value,options:l}),cI}return OK(l.data)}get enum(){return this._def.values}}ZodNativeEnum.create=(l,c)=>new ZodNativeEnum({values:l,typeName:RI.ZodNativeEnum,...processCreateParams(c)});class ZodPromise extends ZodType{unwrap(){return this._def.type}_parse(l){const{ctx:c}=this._processInputParams(l);if(c.parsedType!==oI.promise&&!1===c.common.async)return addIssueToContext(c,{code:aI.invalid_type,expected:oI.promise,received:c.parsedType}),cI;const d=c.parsedType===oI.promise?c.data:Promise.resolve(c.data);return OK(d.then((l=>this._def.type.parseAsync(l,{path:c.path,errorMap:c.common.contextualErrorMap}))))}}ZodPromise.create=(l,c)=>new ZodPromise({type:l,typeName:RI.ZodPromise,...processCreateParams(c)});class ZodEffects extends ZodType{innerType(){return this._def.schema}sourceType(){return this._def.schema._def.typeName===RI.ZodEffects?this._def.schema.sourceType():this._def.schema}_parse(l){const{status:c,ctx:d}=this._processInputParams(l),h=this._def.effect||null,p={addIssue:l=>{addIssueToContext(d,l),l.fatal?c.abort():c.dirty()},get path(){return d.path}};if(p.addIssue=p.addIssue.bind(p),"preprocess"===h.type){const l=h.transform(d.data,p);if(d.common.async)return Promise.resolve(l).then((async l=>{if("aborted"===c.value)return cI;const h=await this._def.schema._parseAsync({data:l,path:d.path,parent:d});return"aborted"===h.status?cI:"dirty"===h.status||"dirty"===c.value?DIRTY(h.value):h}));{if("aborted"===c.value)return cI;const h=this._def.schema._parseSync({data:l,path:d.path,parent:d});return"aborted"===h.status?cI:"dirty"===h.status||"dirty"===c.value?DIRTY(h.value):h}}if("refinement"===h.type){const executeRefinement=l=>{const c=h.refinement(l,p);if(d.common.async)return Promise.resolve(c);if(c instanceof Promise)throw new Error("Async refinement encountered during synchronous parse operation. Use .parseAsync instead.");return l};if(!1===d.common.async){const l=this._def.schema._parseSync({data:d.data,path:d.path,parent:d});return"aborted"===l.status?cI:("dirty"===l.status&&c.dirty(),executeRefinement(l.value),{status:c.value,value:l.value})}return this._def.schema._parseAsync({data:d.data,path:d.path,parent:d}).then((l=>"aborted"===l.status?cI:("dirty"===l.status&&c.dirty(),executeRefinement(l.value).then((()=>({status:c.value,value:l.value}))))))}if("transform"===h.type){if(!1===d.common.async){const l=this._def.schema._parseSync({data:d.data,path:d.path,parent:d});if(!isValid(l))return cI;const f=h.transform(l.value,p);if(f instanceof Promise)throw new Error("Asynchronous transform encountered during synchronous parse operation. Use .parseAsync instead.");return{status:c.value,value:f}}return this._def.schema._parseAsync({data:d.data,path:d.path,parent:d}).then((l=>isValid(l)?Promise.resolve(h.transform(l.value,p)).then((l=>({status:c.value,value:l}))):cI))}nI.assertNever(h)}}ZodEffects.create=(l,c,d)=>new ZodEffects({schema:l,typeName:RI.ZodEffects,effect:c,...processCreateParams(d)}),ZodEffects.createWithPreprocess=(l,c,d)=>new ZodEffects({schema:c,effect:{type:"preprocess",transform:l},typeName:RI.ZodEffects,...processCreateParams(d)});class ZodOptional extends ZodType{_parse(l){return this._getType(l)===oI.undefined?OK(void 0):this._def.innerType._parse(l)}unwrap(){return this._def.innerType}}ZodOptional.create=(l,c)=>new ZodOptional({innerType:l,typeName:RI.ZodOptional,...processCreateParams(c)});class ZodNullable extends ZodType{_parse(l){return this._getType(l)===oI.null?OK(null):this._def.innerType._parse(l)}unwrap(){return this._def.innerType}}ZodNullable.create=(l,c)=>new ZodNullable({innerType:l,typeName:RI.ZodNullable,...processCreateParams(c)});class ZodDefault extends ZodType{_parse(l){const{ctx:c}=this._processInputParams(l);let d=c.data;return c.parsedType===oI.undefined&&(d=this._def.defaultValue()),this._def.innerType._parse({data:d,path:c.path,parent:c})}removeDefault(){return this._def.innerType}}ZodDefault.create=(l,c)=>new ZodDefault({innerType:l,typeName:RI.ZodDefault,defaultValue:"function"==typeof c.default?c.default:()=>c.default,...processCreateParams(c)});class ZodCatch extends ZodType{_parse(l){const{ctx:c}=this._processInputParams(l),d={...c,common:{...c.common,issues:[]}},h=this._def.innerType._parse({data:d.data,path:d.path,parent:{...d}});return isAsync(h)?h.then((l=>({status:"valid",value:"valid"===l.status?l.value:this._def.catchValue({get error(){return new ZodError(d.common.issues)},input:d.data})}))):{status:"valid",value:"valid"===h.status?h.value:this._def.catchValue({get error(){return new ZodError(d.common.issues)},input:d.data})}}removeCatch(){return this._def.innerType}}ZodCatch.create=(l,c)=>new ZodCatch({innerType:l,typeName:RI.ZodCatch,catchValue:"function"==typeof c.catch?c.catch:()=>c.catch,...processCreateParams(c)});class ZodNaN extends ZodType{_parse(l){if(this._getType(l)!==oI.nan){const c=this._getOrReturnCtx(l);return addIssueToContext(c,{code:aI.invalid_type,expected:oI.nan,received:c.parsedType}),cI}return{status:"valid",value:l.data}}}ZodNaN.create=l=>new ZodNaN({typeName:RI.ZodNaN,...processCreateParams(l)});class ZodBranded extends ZodType{_parse(l){const{ctx:c}=this._processInputParams(l),d=c.data;return this._def.type._parse({data:d,path:c.path,parent:c})}unwrap(){return this._def.type}}class ZodPipeline extends ZodType{_parse(l){const{status:c,ctx:d}=this._processInputParams(l);if(d.common.async){return(async()=>{const l=await this._def.in._parseAsync({data:d.data,path:d.path,parent:d});return"aborted"===l.status?cI:"dirty"===l.status?(c.dirty(),DIRTY(l.value)):this._def.out._parseAsync({data:l.value,path:d.path,parent:d})})()}{const l=this._def.in._parseSync({data:d.data,path:d.path,parent:d});return"aborted"===l.status?cI:"dirty"===l.status?(c.dirty(),{status:"dirty",value:l.value}):this._def.out._parseSync({data:l.value,path:d.path,parent:d})}}static create(l,c){return new ZodPipeline({in:l,out:c,typeName:RI.ZodPipeline})}}class ZodReadonly extends ZodType{_parse(l){const c=this._def.innerType._parse(l),freeze2=l=>(isValid(l)&&(l.value=Object.freeze(l.value)),l);return isAsync(c)?c.then((l=>freeze2(l))):freeze2(c)}unwrap(){return this._def.innerType}}var RI,AI;ZodReadonly.create=(l,c)=>new ZodReadonly({innerType:l,typeName:RI.ZodReadonly,...processCreateParams(c)}),(AI=RI||(RI={})).ZodString="ZodString",AI.ZodNumber="ZodNumber",AI.ZodNaN="ZodNaN",AI.ZodBigInt="ZodBigInt",AI.ZodBoolean="ZodBoolean",AI.ZodDate="ZodDate",AI.ZodSymbol="ZodSymbol",AI.ZodUndefined="ZodUndefined",AI.ZodNull="ZodNull",AI.ZodAny="ZodAny",AI.ZodUnknown="ZodUnknown",AI.ZodNever="ZodNever",AI.ZodVoid="ZodVoid",AI.ZodArray="ZodArray",AI.ZodObject="ZodObject",AI.ZodUnion="ZodUnion",AI.ZodDiscriminatedUnion="ZodDiscriminatedUnion",AI.ZodIntersection="ZodIntersection",AI.ZodTuple="ZodTuple",AI.ZodRecord="ZodRecord",AI.ZodMap="ZodMap",AI.ZodSet="ZodSet",AI.ZodFunction="ZodFunction",AI.ZodLazy="ZodLazy",AI.ZodLiteral="ZodLiteral",AI.ZodEnum="ZodEnum",AI.ZodEffects="ZodEffects",AI.ZodNativeEnum="ZodNativeEnum",AI.ZodOptional="ZodOptional",AI.ZodNullable="ZodNullable",AI.ZodDefault="ZodDefault",AI.ZodCatch="ZodCatch",AI.ZodPromise="ZodPromise",AI.ZodBranded="ZodBranded",AI.ZodPipeline="ZodPipeline",AI.ZodReadonly="ZodReadonly";const OI=ZodString.create;ZodNever.create,ZodArray.create;const MI=ZodObject.create;ZodUnion.create,ZodIntersection.create,ZodTuple.create,ZodEnum.create,ZodPromise.create,ZodOptional.create,ZodNullable.create;const NI=Gt.forwardRef((({className:l,type:c,...d},h)=>Kt.jsx("input",{type:c,className:tr("flex h-10 w-full rounded-md border border-input bg-background px-3 py-2 text-base ring-offset-background file:border-0 file:bg-transparent file:text-sm file:font-medium file:text-foreground placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50 md:text-sm",l),ref:h,...d})));NI.displayName="Input";const PI=MI({email:OI().email("Invalid email address"),password:OI().min(8,"Password must be at least 8 characters long")});function LoginForm({onSuccess:l,onSignupClick:c,onForgotPasswordClick:d}){const[h,p]=Gt.useState(0),f=useNavigate(),{register:m,handleSubmit:y,formState:{errors:_,isSubmitting:b},setError:w}=useForm({resolver:a(PI)}),handleLoginError=l=>{p((l=>l+1)),l.message?.includes("Invalid login credentials")?w("root",{message:"Invalid email or password. Please check your credentials."}):l.message?.includes("Email not confirmed")?w("root",{message:"Please check your email and confirm your account."}):w("root",{message:"Login failed. Please try again."}),vo.error("Login failed. Please check your credentials.")};return Kt.jsxs(Ax,{className:"w-full md:w-[350px]",children:[Kt.jsxs(Ox,{children:[Kt.jsx(Mx,{children:"Welcome Back"}),Kt.jsx(Nx,{children:"Enter your credentials to access your account"})]}),Kt.jsxs(Px,{className:"space-y-4",children:[Kt.jsxs("form",{onSubmit:y((async c=>{try{const{error:d,data:h}=await EC.auth.signInWithPassword({email:c.email,password:c.password});if(d)return void handleLoginError(d);p(0),vo.success("Login successful!"),l?l():f("/",{replace:!0})}catch(d){console.error("Login failed:",d),handleLoginError(d)}})),className:"space-y-4",children:[Kt.jsxs("div",{className:"space-y-2",children:[Kt.jsx(PC,{htmlFor:"email",children:"Email"}),Kt.jsx(NI,{id:"email",type:"email",placeholder:"Enter your email",autoComplete:"email",disabled:b,...m("email"),"aria-invalid":_.email?"true":"false"}),_.email&&Kt.jsx("p",{className:"mt-1 text-sm text-destructive",children:_.email.message})]}),Kt.jsxs("div",{className:"space-y-2",children:[Kt.jsx(PC,{htmlFor:"password",children:"Password"}),Kt.jsx(NI,{id:"password",type:"password",placeholder:"Enter your password",autoComplete:"current-password",disabled:b,...m("password"),"aria-invalid":_.password?"true":"false"}),_.password&&Kt.jsx("p",{className:"mt-1 text-sm text-destructive",children:_.password.message})]}),_.root&&Kt.jsx("p",{className:"text-sm text-destructive text-center",children:_.root.message}),Kt.jsx(or,{type:"submit",className:"w-full",disabled:b,children:b?"Signing in...":"Sign In"})]}),Kt.jsx("div",{className:"text-center",children:Kt.jsx("button",{type:"button",className:"text-sm text-muted-foreground hover:text-primary hover:underline",onClick:()=>{d?d():f("/forget-password")},children:"Forgot your password?"})})]})]})}function Login({onSuccess:l,onSignupClick:c,onForgotPasswordClick:d}){return Kt.jsxs("div",{className:"fixed inset-0 z-50 flex items-center justify-center",children:[Kt.jsx("div",{className:"absolute inset-0 bg-black/50 backdrop-blur-sm"}),Kt.jsx("div",{className:"relative z-10 w-full max-w-md mx-4",children:Kt.jsx("div",{className:"bg-background border border-border rounded-lg shadow-2xl p-6",children:Kt.jsx(LoginForm,{onSuccess:l,onSignupClick:c,onForgotPasswordClick:d})})})]})}var LI=Object.defineProperty,jI=Object.defineProperties,DI=Object.getOwnPropertyDescriptors,FI=Object.getOwnPropertySymbols,$I=Object.prototype.hasOwnProperty,UI=Object.prototype.propertyIsEnumerable,vt=(l,c,d)=>c in l?LI(l,c,{enumerable:!0,configurable:!0,writable:!0,value:d}):l[c]=d;var BI=["[data-lastpass-icon-root]","com-1password-button","[data-dashlanecreated]",'[style$="2147483647 !important;"]'].join(",");var HI=Gt.createContext({}),zI=Gt.forwardRef(((l,c)=>{var d,h,p,f,m,y=l,{value:_,onChange:b,maxLength:w,textAlign:E="left",pattern:M,placeholder:N,inputMode:P="numeric",onComplete:L,pushPasswordManagerStrategy:j="increase-width",pasteTransformer:D,containerClassName:F,noScriptCSSFallback:U=qI,render:B,children:H}=y,z=((l,c)=>{var d={};for(var h in l)$I.call(l,h)&&c.indexOf(h)<0&&(d[h]=l[h]);if(null!=l&&FI)for(var h of FI(l))c.indexOf(h)<0&&UI.call(l,h)&&(d[h]=l[h]);return d})(y,["value","onChange","maxLength","textAlign","pattern","placeholder","inputMode","onComplete","pushPasswordManagerStrategy","pasteTransformer","containerClassName","noScriptCSSFallback","render","children"]);let[q,V]=Gt.useState("string"==typeof z.defaultValue?z.defaultValue:""),Z=null!=_?_:q,K=function(l){let c=Gt.useRef();return Gt.useEffect((()=>{c.current=l})),c.current}(Z),Y=Gt.useCallback((l=>{null==b||b(l),V(l)}),[b]),ee=Gt.useMemo((()=>M?"string"==typeof M?new RegExp(M):M:null),[M]),ne=Gt.useRef(null),se=Gt.useRef(null),ie=Gt.useRef({value:Z,onChange:Y,isIOS:"undefined"!=typeof window&&(null==(h=null==(d=null==window?void 0:window.CSS)?void 0:d.supports)?void 0:h.call(d,"-webkit-touch-callout","none"))}),oe=Gt.useRef({prev:[null==(p=ne.current)?void 0:p.selectionStart,null==(f=ne.current)?void 0:f.selectionEnd,null==(m=ne.current)?void 0:m.selectionDirection]});Gt.useImperativeHandle(c,(()=>ne.current),[]),Gt.useEffect((()=>{let l=ne.current,c=se.current;if(!l||!c)return;function d2(){if(document.activeElement!==l)return be(null),void Ne(null);let c,d=l.selectionStart,h=l.selectionEnd,p=l.selectionDirection,f=l.maxLength,m=l.value,y=oe.current.prev,_=-1,b=-1;if(0!==m.length&&null!==d&&null!==h){let l=d===h,p=d===m.length&&m.length<f;if(l&&!p){let l=d;if(0===l)_=0,b=1,c="forward";else if(l===f)_=l-1,b=l,c="backward";else if(f>1&&m.length>1){let d=0;if(null!==y[0]&&null!==y[1]){c=l<y[1]?"backward":"forward";let h=y[0]===y[1]&&y[0]<f;"backward"===c&&!h&&(d=-1)}_=d+l,b=d+l+1}}-1!==_&&-1!==b&&_!==b&&ne.current.setSelectionRange(_,b,c)}let w=-1!==_?_:d,E=-1!==b?b:h,M=null!=c?c:p;be(w),Ne(E),oe.current.prev=[w,E,M]}if(ie.current.value!==l.value&&ie.current.onChange(l.value),oe.current.prev=[l.selectionStart,l.selectionEnd,l.selectionDirection],document.addEventListener("selectionchange",d2,{capture:!0}),d2(),document.activeElement===l&&fe(!0),!document.getElementById("input-otp-style")){let l=document.createElement("style");if(l.id="input-otp-style",document.head.appendChild(l),l.sheet){let c="background: transparent !important; color: transparent !important; border-color: transparent !important; opacity: 0 !important; box-shadow: none !important; -webkit-box-shadow: none !important; -webkit-text-fill-color: transparent !important;";$(l.sheet,"[data-input-otp]::selection { background: transparent !important; color: transparent !important; }"),$(l.sheet,`[data-input-otp]:autofill { ${c} }`),$(l.sheet,`[data-input-otp]:-webkit-autofill { ${c} }`),$(l.sheet,"@supports (-webkit-touch-callout: none) { [data-input-otp] { letter-spacing: -.6em !important; font-weight: 100 !important; font-stretch: ultra-condensed; font-optical-sizing: none !important; left: -1px !important; right: 1px !important; } }"),$(l.sheet,"[data-input-otp] + * { pointer-events: all !important; }")}}let R2=()=>{c&&c.style.setProperty("--root-height",`${l.clientHeight}px`)};R2();let d=new ResizeObserver(R2);return d.observe(l),()=>{document.removeEventListener("selectionchange",d2,{capture:!0}),d.disconnect()}}),[]);let[le,ce]=Gt.useState(!1),[pe,fe]=Gt.useState(!1),[ge,be]=Gt.useState(null),[Oe,Ne]=Gt.useState(null);Gt.useEffect((()=>{!function(l){setTimeout(l,0),setTimeout(l,10),setTimeout(l,50)}((()=>{var l,c,d,h;null==(l=ne.current)||l.dispatchEvent(new Event("input"));let p=null==(c=ne.current)?void 0:c.selectionStart,f=null==(d=ne.current)?void 0:d.selectionEnd,m=null==(h=ne.current)?void 0:h.selectionDirection;null!==p&&null!==f&&(be(p),Ne(f),oe.current.prev=[p,f,m])}))}),[Z,pe]),Gt.useEffect((()=>{void 0!==K&&Z!==K&&K.length<w&&Z.length===w&&(null==L||L(Z))}),[w,L,K,Z]);let De=function({containerRef:l,inputRef:c,pushPasswordManagerStrategy:d,isFocused:h}){let[p,f]=Gt.useState(!1),[m,y]=Gt.useState(!1),[_,b]=Gt.useState(!1),w=Gt.useMemo((()=>"none"!==d&&("increase-width"===d||"experimental-no-flickering"===d)&&p&&m),[p,m,d]),E=Gt.useCallback((()=>{let h=l.current,p=c.current;if(!h||!p||_||"none"===d)return;let m=h,y=m.getBoundingClientRect().left+m.offsetWidth-18,w=m.getBoundingClientRect().top+m.offsetHeight/2;0===document.querySelectorAll(BI).length&&document.elementFromPoint(y,w)===h||(f(!0),b(!0))}),[l,c,_,d]);return Gt.useEffect((()=>{let c=l.current;if(!c||"none"===d)return;function h2(){let l=window.innerWidth-c.getBoundingClientRect().right;y(l>=40)}h2();let h=setInterval(h2,1e3);return()=>{clearInterval(h)}}),[l,d]),Gt.useEffect((()=>{let l=h||document.activeElement===c.current;if("none"===d||!l)return;let p=setTimeout(E,0),f=setTimeout(E,2e3),m=setTimeout(E,5e3),y=setTimeout((()=>{b(!0)}),6e3);return()=>{clearTimeout(p),clearTimeout(f),clearTimeout(m),clearTimeout(y)}}),[c,h,d,E]),{hasPWMBadge:p,willPushPWMBadge:w,PWM_BADGE_SPACE_WIDTH:"40px"}}({containerRef:se,inputRef:ne,pushPasswordManagerStrategy:j,isFocused:pe}),Fe=Gt.useCallback((l=>{let c=l.currentTarget.value.slice(0,w);c.length>0&&ee&&!ee.test(c)?l.preventDefault():("string"==typeof K&&c.length<K.length&&document.dispatchEvent(new Event("selectionchange")),Y(c))}),[w,Y,K,ee]),Ue=Gt.useCallback((()=>{var l;if(ne.current){let c=Math.min(ne.current.value.length,w-1),d=ne.current.value.length;null==(l=ne.current)||l.setSelectionRange(c,d),be(c),Ne(d)}fe(!0)}),[w]),Be=Gt.useCallback((l=>{var c,d;let h=ne.current;if(!(D||ie.current.isIOS&&l.clipboardData&&h))return;let p=l.clipboardData.getData("text/plain"),f=D?D(p):p;l.preventDefault();let m=null==(c=ne.current)?void 0:c.selectionStart,y=null==(d=ne.current)?void 0:d.selectionEnd,_=(m!==y?Z.slice(0,m)+f+Z.slice(y):Z.slice(0,m)+f+Z.slice(m)).slice(0,w);if(_.length>0&&ee&&!ee.test(_))return;h.value=_,Y(_);let b=Math.min(_.length,w-1),E=_.length;h.setSelectionRange(b,E),be(b),Ne(E)}),[w,Y,ee,Z]),He=Gt.useMemo((()=>({position:"relative",cursor:z.disabled?"default":"text",userSelect:"none",WebkitUserSelect:"none",pointerEvents:"none"})),[z.disabled]),qe=Gt.useMemo((()=>({position:"absolute",inset:0,width:De.willPushPWMBadge?`calc(100% + ${De.PWM_BADGE_SPACE_WIDTH})`:"100%",clipPath:De.willPushPWMBadge?`inset(0 ${De.PWM_BADGE_SPACE_WIDTH} 0 0)`:void 0,height:"100%",display:"flex",textAlign:E,opacity:"1",color:"transparent",pointerEvents:"all",background:"transparent",caretColor:"transparent",border:"0 solid transparent",outline:"0 solid transparent",boxShadow:"none",lineHeight:"1",letterSpacing:"-.5em",fontSize:"var(--root-height)",fontFamily:"monospace",fontVariantNumeric:"tabular-nums"})),[De.PWM_BADGE_SPACE_WIDTH,De.willPushPWMBadge,E]),Ve=Gt.useMemo((()=>Gt.createElement("input",((l,c)=>jI(l,DI(c)))(((l,c)=>{for(var d in c||(c={}))$I.call(c,d)&&vt(l,d,c[d]);if(FI)for(var d of FI(c))UI.call(c,d)&&vt(l,d,c[d]);return l})({autoComplete:z.autoComplete||"one-time-code"},z),{"data-input-otp":!0,"data-input-otp-placeholder-shown":0===Z.length||void 0,"data-input-otp-mss":ge,"data-input-otp-mse":Oe,inputMode:P,pattern:null==ee?void 0:ee.source,"aria-placeholder":N,style:qe,maxLength:w,value:Z,ref:ne,onPaste:l=>{var c;Be(l),null==(c=z.onPaste)||c.call(z,l)},onChange:Fe,onMouseOver:l=>{var c;ce(!0),null==(c=z.onMouseOver)||c.call(z,l)},onMouseLeave:l=>{var c;ce(!1),null==(c=z.onMouseLeave)||c.call(z,l)},onFocus:l=>{var c;Ue(),null==(c=z.onFocus)||c.call(z,l)},onBlur:l=>{var c;fe(!1),null==(c=z.onBlur)||c.call(z,l)}}))),[Fe,Ue,Be,P,qe,w,Oe,ge,z,null==ee?void 0:ee.source,Z]),Je=Gt.useMemo((()=>({slots:Array.from({length:w}).map(((l,c)=>{var d;let h=pe&&null!==ge&&null!==Oe&&(ge===Oe&&c===ge||c>=ge&&c<Oe),p=void 0!==Z[c]?Z[c]:null;return{char:p,placeholderChar:void 0!==Z[0]?null:null!=(d=null==N?void 0:N[c])?d:null,isActive:h,hasFakeCaret:h&&null===p}})),isFocused:pe,isHovering:!z.disabled&&le})),[pe,le,w,Oe,ge,z.disabled,Z]),tt=Gt.useMemo((()=>B?B(Je):Gt.createElement(HI.Provider,{value:Je},H)),[H,Je,B]);return Gt.createElement(Gt.Fragment,null,null!==U&&Gt.createElement("noscript",null,Gt.createElement("style",null,U)),Gt.createElement("div",{ref:se,"data-input-otp-container":!0,style:He,className:F},tt,Gt.createElement("div",{style:{position:"absolute",inset:0,pointerEvents:"none"}},Ve)))}));function $(l,c){try{l.insertRule(c)}catch(hh){console.error("input-otp could not insert CSS rule:",c)}}zI.displayName="Input";var qI="\n[data-input-otp] {\n  --nojs-bg: white !important;\n  --nojs-fg: black !important;\n\n  background-color: var(--nojs-bg) !important;\n  color: var(--nojs-fg) !important;\n  caret-color: var(--nojs-fg) !important;\n  letter-spacing: .25em !important;\n  text-align: center !important;\n  border: 1px solid var(--nojs-fg) !important;\n  border-radius: 4px !important;\n  width: 100% !important;\n}\n@media (prefers-color-scheme: dark) {\n  [data-input-otp] {\n    --nojs-bg: black !important;\n    --nojs-fg: white !important;\n  }\n}";function formatProdErrorMessage$1(l){return`Minified Redux error #${l}; visit https://redux.js.org/Errors?code=${l} for the full message or use the non-minified dev environment for full errors. `}MI({email:OI().email("Invalid email address")}),MI({password:OI().min(8,"Password must be at least 8 characters long")});var WI=(()=>"function"==typeof Symbol&&Symbol.observable||"@@observable")(),randomString=()=>Math.random().toString(36).substring(7).split("").join("."),VI={INIT:`@@redux/INIT${randomString()}`,REPLACE:`@@redux/REPLACE${randomString()}`,PROBE_UNKNOWN_ACTION:()=>`@@redux/PROBE_UNKNOWN_ACTION${randomString()}`};function isPlainObject$1(l){if("object"!=typeof l||null===l)return!1;let c=l;for(;null!==Object.getPrototypeOf(c);)c=Object.getPrototypeOf(c);return Object.getPrototypeOf(l)===c||null===Object.getPrototypeOf(l)}function createStore(l,c,d){if("function"!=typeof l)throw new Error(formatProdErrorMessage$1(2));if("function"==typeof c&&"function"==typeof d||"function"==typeof d&&"function"==typeof arguments[3])throw new Error(formatProdErrorMessage$1(0));if("function"==typeof c&&void 0===d&&(d=c,c=void 0),void 0!==d){if("function"!=typeof d)throw new Error(formatProdErrorMessage$1(1));return d(createStore)(l,c)}let h=l,p=c,f=new Map,m=f,y=0,_=!1;function ensureCanMutateNextListeners(){m===f&&(m=new Map,f.forEach(((l,c)=>{m.set(c,l)})))}function getState2(){if(_)throw new Error(formatProdErrorMessage$1(3));return p}function subscribe2(l){if("function"!=typeof l)throw new Error(formatProdErrorMessage$1(4));if(_)throw new Error(formatProdErrorMessage$1(5));let c=!0;ensureCanMutateNextListeners();const d=y++;return m.set(d,l),function(){if(c){if(_)throw new Error(formatProdErrorMessage$1(6));c=!1,ensureCanMutateNextListeners(),m.delete(d),f=null}}}function dispatch(l){if(!isPlainObject$1(l))throw new Error(formatProdErrorMessage$1(7));if(void 0===l.type)throw new Error(formatProdErrorMessage$1(8));if("string"!=typeof l.type)throw new Error(formatProdErrorMessage$1(17));if(_)throw new Error(formatProdErrorMessage$1(9));try{_=!0,p=h(p,l)}finally{_=!1}return(f=m).forEach((l=>{l()})),l}dispatch({type:VI.INIT});return{dispatch:dispatch,subscribe:subscribe2,getState:getState2,replaceReducer:function(l){if("function"!=typeof l)throw new Error(formatProdErrorMessage$1(10));h=l,dispatch({type:VI.REPLACE})},[WI]:function(){const l=subscribe2;return{subscribe(c){if("object"!=typeof c||null===c)throw new Error(formatProdErrorMessage$1(11));function observeState(){const l=c;l.next&&l.next(getState2())}observeState();return{unsubscribe:l(observeState)}},[WI](){return this}}}}}function combineReducers(l){const c=Object.keys(l),d={};for(let f=0;f<c.length;f++){const h=c[f];"function"==typeof l[h]&&(d[h]=l[h])}const h=Object.keys(d);let p;try{!function(l){Object.keys(l).forEach((c=>{const d=l[c];if(void 0===d(void 0,{type:VI.INIT}))throw new Error(formatProdErrorMessage$1(12));if(void 0===d(void 0,{type:VI.PROBE_UNKNOWN_ACTION()}))throw new Error(formatProdErrorMessage$1(13))}))}(d)}catch(hh){p=hh}return function(l={},c){if(p)throw p;let f=!1;const m={};for(let p=0;p<h.length;p++){const y=h[p],_=d[y],b=l[y],w=_(b,c);if(void 0===w)throw c&&c.type,new Error(formatProdErrorMessage$1(14));m[y]=w,f=f||w!==b}return f=f||h.length!==Object.keys(l).length,f?m:l}}function compose(...l){return 0===l.length?l=>l:1===l.length?l[0]:l.reduce(((l,c)=>(...d)=>l(c(...d))))}function isAction(l){return isPlainObject$1(l)&&"type"in l&&"string"==typeof l.type}var ZI=Symbol.for("immer-nothing"),GI=Symbol.for("immer-draftable"),KI=Symbol.for("immer-state");function die(l,...c){throw new Error(`[Immer] minified error nr: ${l}. Full error at: https://bit.ly/3cXEKWf`)}var JI=Object.getPrototypeOf;function isDraft(l){return!!l&&!!l[KI]}function isDraftable(l){return!!l&&(isPlainObject(l)||Array.isArray(l)||!!l[GI]||!!l.constructor?.[GI]||isMap(l)||isSet(l))}var YI=Object.prototype.constructor.toString();function isPlainObject(l){if(!l||"object"!=typeof l)return!1;const c=JI(l);if(null===c)return!0;const d=Object.hasOwnProperty.call(c,"constructor")&&c.constructor;return d===Object||"function"==typeof d&&Function.toString.call(d)===YI}function each(l,c){0===getArchtype(l)?Reflect.ownKeys(l).forEach((d=>{c(d,l[d],l)})):l.forEach(((d,h)=>c(h,d,l)))}function getArchtype(l){const c=l[KI];return c?c.type_:Array.isArray(l)?1:isMap(l)?2:isSet(l)?3:0}function has(l,c){return 2===getArchtype(l)?l.has(c):Object.prototype.hasOwnProperty.call(l,c)}function set(l,c,d){const h=getArchtype(l);2===h?l.set(c,d):3===h?l.add(d):l[c]=d}function isMap(l){return l instanceof Map}function isSet(l){return l instanceof Set}function latest(l){return l.copy_||l.base_}function shallowCopy(l,c){if(isMap(l))return new Map(l);if(isSet(l))return new Set(l);if(Array.isArray(l))return Array.prototype.slice.call(l);const d=isPlainObject(l);if(!0===c||"class_only"===c&&!d){const c=Object.getOwnPropertyDescriptors(l);delete c[KI];let d=Reflect.ownKeys(c);for(let h=0;h<d.length;h++){const p=d[h],f=c[p];!1===f.writable&&(f.writable=!0,f.configurable=!0),(f.get||f.set)&&(c[p]={configurable:!0,writable:!0,enumerable:f.enumerable,value:l[p]})}return Object.create(JI(l),c)}{const c=JI(l);if(null!==c&&d)return{...l};const h=Object.create(c);return Object.assign(h,l)}}function freeze(l,c=!1){return isFrozen(l)||isDraft(l)||!isDraftable(l)||(getArchtype(l)>1&&(l.set=l.add=l.clear=l.delete=dontMutateFrozenCollections),Object.freeze(l),c&&Object.entries(l).forEach((([l,c])=>freeze(c,!0)))),l}function dontMutateFrozenCollections(){die(2)}function isFrozen(l){return Object.isFrozen(l)}var QI,XI={};function getPlugin(l){const c=XI[l];return c||die(0),c}function getCurrentScope(){return QI}function usePatchesInScope(l,c){c&&(getPlugin("Patches"),l.patches_=[],l.inversePatches_=[],l.patchListener_=c)}function revokeScope(l){leaveScope(l),l.drafts_.forEach(revokeDraft),l.drafts_=null}function leaveScope(l){l===QI&&(QI=l.parent_)}function enterScope(l){return QI={drafts_:[],parent_:QI,immer_:l,canAutoFreeze_:!0,unfinalizedDrafts_:0}}function revokeDraft(l){const c=l[KI];0===c.type_||1===c.type_?c.revoke_():c.revoked_=!0}function processResult(l,c){c.unfinalizedDrafts_=c.drafts_.length;const d=c.drafts_[0];return void 0!==l&&l!==d?(d[KI].modified_&&(revokeScope(c),die(4)),isDraftable(l)&&(l=finalize(c,l),c.parent_||maybeFreeze(c,l)),c.patches_&&getPlugin("Patches").generateReplacementPatches_(d[KI].base_,l,c.patches_,c.inversePatches_)):l=finalize(c,d,[]),revokeScope(c),c.patches_&&c.patchListener_(c.patches_,c.inversePatches_),l!==ZI?l:void 0}function finalize(l,c,d){if(isFrozen(c))return c;const h=c[KI];if(!h)return each(c,((p,f)=>finalizeProperty(l,h,c,p,f,d))),c;if(h.scope_!==l)return c;if(!h.modified_)return maybeFreeze(l,h.base_,!0),h.base_;if(!h.finalized_){h.finalized_=!0,h.scope_.unfinalizedDrafts_--;const c=h.copy_;let p=c,f=!1;3===h.type_&&(p=new Set(c),c.clear(),f=!0),each(p,((p,m)=>finalizeProperty(l,h,c,p,m,d,f))),maybeFreeze(l,c,!1),d&&l.patches_&&getPlugin("Patches").generatePatches_(h,d,l.patches_,l.inversePatches_)}return h.copy_}function finalizeProperty(l,c,d,h,p,f,m){if(isDraft(p)){const m=finalize(l,p,f&&c&&3!==c.type_&&!has(c.assigned_,h)?f.concat(h):void 0);if(set(d,h,m),!isDraft(m))return;l.canAutoFreeze_=!1}else m&&d.add(p);if(isDraftable(p)&&!isFrozen(p)){if(!l.immer_.autoFreeze_&&l.unfinalizedDrafts_<1)return;finalize(l,p),c&&c.scope_.parent_||"symbol"==typeof h||!Object.prototype.propertyIsEnumerable.call(d,h)||maybeFreeze(l,p)}}function maybeFreeze(l,c,d=!1){!l.parent_&&l.immer_.autoFreeze_&&l.canAutoFreeze_&&freeze(c,d)}var eT={get(l,c){if(c===KI)return l;const d=latest(l);if(!has(d,c))return function(l,c,d){const h=getDescriptorFromProto(c,d);return h?"value"in h?h.value:h.get?.call(l.draft_):void 0}(l,d,c);const h=d[c];return l.finalized_||!isDraftable(h)?h:h===peek(l.base_,c)?(prepareCopy(l),l.copy_[c]=createProxy(h,l)):h},has:(l,c)=>c in latest(l),ownKeys:l=>Reflect.ownKeys(latest(l)),set(l,c,d){const h=getDescriptorFromProto(latest(l),c);if(h?.set)return h.set.call(l.draft_,d),!0;if(!l.modified_){const h=peek(latest(l),c),m=h?.[KI];if(m&&m.base_===d)return l.copy_[c]=d,l.assigned_[c]=!1,!0;if(((p=d)===(f=h)?0!==p||1/p==1/f:p!=p&&f!=f)&&(void 0!==d||has(l.base_,c)))return!0;prepareCopy(l),markChanged(l)}var p,f;return l.copy_[c]===d&&(void 0!==d||c in l.copy_)||Number.isNaN(d)&&Number.isNaN(l.copy_[c])||(l.copy_[c]=d,l.assigned_[c]=!0),!0},deleteProperty:(l,c)=>(void 0!==peek(l.base_,c)||c in l.base_?(l.assigned_[c]=!1,prepareCopy(l),markChanged(l)):delete l.assigned_[c],l.copy_&&delete l.copy_[c],!0),getOwnPropertyDescriptor(l,c){const d=latest(l),h=Reflect.getOwnPropertyDescriptor(d,c);return h?{writable:!0,configurable:1!==l.type_||"length"!==c,enumerable:h.enumerable,value:d[c]}:h},defineProperty(){die(11)},getPrototypeOf:l=>JI(l.base_),setPrototypeOf(){die(12)}},tT={};function peek(l,c){const d=l[KI];return(d?latest(d):l)[c]}function getDescriptorFromProto(l,c){if(!(c in l))return;let d=JI(l);for(;d;){const l=Object.getOwnPropertyDescriptor(d,c);if(l)return l;d=JI(d)}}function markChanged(l){l.modified_||(l.modified_=!0,l.parent_&&markChanged(l.parent_))}function prepareCopy(l){l.copy_||(l.copy_=shallowCopy(l.base_,l.scope_.immer_.useStrictShallowCopy_))}each(eT,((l,c)=>{tT[l]=function(){return arguments[0]=arguments[0][0],c.apply(this,arguments)}})),tT.deleteProperty=function(l,c){return tT.set.call(this,l,c,void 0)},tT.set=function(l,c,d){return eT.set.call(this,l[0],c,d,l[0])};function createProxy(l,c){const d=isMap(l)?getPlugin("MapSet").proxyMap_(l,c):isSet(l)?getPlugin("MapSet").proxySet_(l,c):function(l,c){const d=Array.isArray(l),h={type_:d?1:0,scope_:c?c.scope_:getCurrentScope(),modified_:!1,finalized_:!1,assigned_:{},parent_:c,base_:l,draft_:null,copy_:null,revoke_:null,isManual_:!1};let p=h,f=eT;d&&(p=[h],f=tT);const{revoke:m,proxy:y}=Proxy.revocable(p,f);return h.draft_=y,h.revoke_=m,y}(l,c);return(c?c.scope_:getCurrentScope()).drafts_.push(d),d}function currentImpl(l){if(!isDraftable(l)||isFrozen(l))return l;const c=l[KI];let d;if(c){if(!c.modified_)return c.base_;c.finalized_=!0,d=shallowCopy(l,c.scope_.immer_.useStrictShallowCopy_)}else d=shallowCopy(l,!0);return each(d,((l,c)=>{set(d,l,currentImpl(c))})),c&&(c.finalized_=!1),d}var rT=new class{constructor(l){this.autoFreeze_=!0,this.useStrictShallowCopy_=!1,this.produce=(l,c,d)=>{if("function"==typeof l&&"function"!=typeof c){const d=c;c=l;const h=this;return function(l=d,...p){return h.produce(l,(l=>c.call(this,l,...p)))}}let h;if("function"!=typeof c&&die(6),void 0!==d&&"function"!=typeof d&&die(7),isDraftable(l)){const p=enterScope(this),f=createProxy(l,void 0);let m=!0;try{h=c(f),m=!1}finally{m?revokeScope(p):leaveScope(p)}return usePatchesInScope(p,d),processResult(h,p)}if(!l||"object"!=typeof l){if(h=c(l),void 0===h&&(h=l),h===ZI&&(h=void 0),this.autoFreeze_&&freeze(h,!0),d){const c=[],p=[];getPlugin("Patches").generateReplacementPatches_(l,h,c,p),d(c,p)}return h}die(1)},this.produceWithPatches=(l,c)=>{if("function"==typeof l)return(c,...d)=>this.produceWithPatches(c,(c=>l(c,...d)));let d,h;return[this.produce(l,c,((l,c)=>{d=l,h=c})),d,h]},"boolean"==typeof l?.autoFreeze&&this.setAutoFreeze(l.autoFreeze),"boolean"==typeof l?.useStrictShallowCopy&&this.setUseStrictShallowCopy(l.useStrictShallowCopy)}createDraft(l){isDraftable(l)||die(8),isDraft(l)&&(l=function(l){isDraft(l)||die(10);return currentImpl(l)}(l));const c=enterScope(this),d=createProxy(l,void 0);return d[KI].isManual_=!0,leaveScope(c),d}finishDraft(l,c){const d=l&&l[KI];d&&d.isManual_||die(9);const{scope_:h}=d;return usePatchesInScope(h,c),processResult(void 0,h)}setAutoFreeze(l){this.autoFreeze_=l}setUseStrictShallowCopy(l){this.useStrictShallowCopy_=l}applyPatches(l,c){let d;for(d=c.length-1;d>=0;d--){const h=c[d];if(0===h.path.length&&"replace"===h.op){l=h.value;break}}d>-1&&(c=c.slice(d+1));const h=getPlugin("Patches").applyPatches_;return isDraft(l)?h(l,c):this.produce(l,(l=>h(l,c)))}},nT=rT.produce;function createThunkMiddleware(l){return({dispatch:c,getState:d})=>h=>p=>"function"==typeof p?p(c,d,l):h(p)}rT.produceWithPatches.bind(rT),rT.setAutoFreeze.bind(rT),rT.setUseStrictShallowCopy.bind(rT),rT.applyPatches.bind(rT),rT.createDraft.bind(rT),rT.finishDraft.bind(rT);var sT=createThunkMiddleware(),iT=createThunkMiddleware,oT="undefined"!=typeof window&&window.__REDUX_DEVTOOLS_EXTENSION_COMPOSE__?window.__REDUX_DEVTOOLS_EXTENSION_COMPOSE__:function(){if(0!==arguments.length)return"object"==typeof arguments[0]?compose:compose.apply(null,arguments)};function createAction(l,c){function actionCreator(...d){if(c){let h=c(...d);if(!h)throw new Error(formatProdErrorMessage(0));return{type:l,payload:h.payload,..."meta"in h&&{meta:h.meta},..."error"in h&&{error:h.error}}}return{type:l,payload:d[0]}}return actionCreator.toString=()=>`${l}`,actionCreator.type=l,actionCreator.match=c=>isAction(c)&&c.type===l,actionCreator}var aT=class _Tuple extends Array{constructor(...l){super(...l),Object.setPrototypeOf(this,_Tuple.prototype)}static get[Symbol.species](){return _Tuple}concat(...l){return super.concat.apply(this,l)}prepend(...l){return 1===l.length&&Array.isArray(l[0])?new _Tuple(...l[0].concat(this)):new _Tuple(...l.concat(this))}};function freezeDraftable(l){return isDraftable(l)?nT(l,(()=>{})):l}function getOrInsertComputed(l,c,d){return l.has(c)?l.get(c):l.set(c,d(c)).get(c)}var createQueueWithTimer=l=>c=>{setTimeout(c,l)},buildGetDefaultEnhancers=l=>function(c){const{autoBatch:d=!0}=c??{};let h=new aT(l);return d&&h.push(((l={type:"raf"})=>c=>(...d)=>{const h=c(...d);let p=!0,f=!1,m=!1;const y=new Set,_="tick"===l.type?queueMicrotask:"raf"===l.type?"undefined"!=typeof window&&window.requestAnimationFrame?window.requestAnimationFrame:createQueueWithTimer(10):"callback"===l.type?l.queueNotification:createQueueWithTimer(l.timeout),notifyListeners=()=>{m=!1,f&&(f=!1,y.forEach((l=>l())))};return Object.assign({},h,{subscribe(l){const c=h.subscribe((()=>p&&l()));return y.add(l),()=>{c(),y.delete(l)}},dispatch(l){try{return p=!l?.meta?.RTK_autoBatch,f=!p,f&&(m||(m=!0,_(notifyListeners))),h.dispatch(l)}finally{p=!0}}})})("object"==typeof d?d:void 0)),h};function executeReducerBuilderCallback(l){const c={},d=[];let h;const p={addCase(l,d){const h="string"==typeof l?l:l.type;if(!h)throw new Error(formatProdErrorMessage(28));if(h in c)throw new Error(formatProdErrorMessage(29));return c[h]=d,p},addMatcher:(l,c)=>(d.push({matcher:l,reducer:c}),p),addDefaultCase:l=>(h=l,p)};return l(p),[c,d,h]}function isAnyOf(...l){return c=>l.some((l=>((l,c)=>{return(d=l)&&"function"==typeof d.match?l.match(c):l(c);var d})(l,c)))}var nanoid=(l=21)=>{let c="",d=l;for(;d--;)c+="ModuleSymbhasOwnPr-0123456789ABCDEFGHNRVfgctiUvz_KqYTJkLxpZXIjQW"[64*Math.random()|0];return c},lT=Symbol.for("rtk-slice-createasyncthunk");function getType(l,c){return`${l}/${c}`}function buildCreateSlice({creators:l}={}){const c=l?.asyncThunk?.[lT];return function(l){const{name:d,reducerPath:h=d}=l;if(!d)throw new Error(formatProdErrorMessage(11));const p=("function"==typeof l.reducers?l.reducers(function(){function asyncThunk(l,c){return{_reducerDefinitionType:"asyncThunk",payloadCreator:l,...c}}return asyncThunk.withTypes=()=>asyncThunk,{reducer:l=>Object.assign({[l.name]:(...c)=>l(...c)}[l.name],{_reducerDefinitionType:"reducer"}),preparedReducer:(l,c)=>({_reducerDefinitionType:"reducerWithPrepare",prepare:l,reducer:c}),asyncThunk:asyncThunk}}()):l.reducers)||{},f=Object.keys(p),m={sliceCaseReducersByName:{},sliceCaseReducersByType:{},actionCreators:{},sliceMatchers:[]},y={addCase(l,c){const d="string"==typeof l?l:l.type;if(!d)throw new Error(formatProdErrorMessage(12));if(d in m.sliceCaseReducersByType)throw new Error(formatProdErrorMessage(13));return m.sliceCaseReducersByType[d]=c,y},addMatcher:(l,c)=>(m.sliceMatchers.push({matcher:l,reducer:c}),y),exposeAction:(l,c)=>(m.actionCreators[l]=c,y),exposeCaseReducer:(l,c)=>(m.sliceCaseReducersByName[l]=c,y)};function buildReducer(){const[c={},d=[],h]="function"==typeof l.extraReducers?executeReducerBuilderCallback(l.extraReducers):[l.extraReducers],p={...c,...m.sliceCaseReducersByType};return function(l,c){let d,[h,p,f]=executeReducerBuilderCallback(c);if("function"==typeof l)d=()=>freezeDraftable(l());else{const c=freezeDraftable(l);d=()=>c}function reducer(l=d(),c){let m=[h[c.type],...p.filter((({matcher:l})=>l(c))).map((({reducer:l})=>l))];return 0===m.filter((l=>!!l)).length&&(m=[f]),m.reduce(((l,d)=>{if(d){if(isDraft(l)){const h=d(l,c);return void 0===h?l:h}if(isDraftable(l))return nT(l,(l=>d(l,c)));{const h=d(l,c);if(void 0===h){if(null===l)return l;throw Error("A case reducer on a non-draftable value must not return undefined")}return h}}return l}),l)}return reducer.getInitialState=d,reducer}(l.initialState,(l=>{for(let c in p)l.addCase(c,p[c]);for(let c of m.sliceMatchers)l.addMatcher(c.matcher,c.reducer);for(let c of d)l.addMatcher(c.matcher,c.reducer);h&&l.addDefaultCase(h)}))}f.forEach((h=>{const f=p[h],m={reducerName:h,type:getType(d,h),createNotation:"function"==typeof l.reducers};!function(l){return"asyncThunk"===l._reducerDefinitionType}(f)?function({type:l,reducerName:c,createNotation:d},h,p){let f,m;if("reducer"in h){if(d&&!function(l){return"reducerWithPrepare"===l._reducerDefinitionType}(h))throw new Error(formatProdErrorMessage(17));f=h.reducer,m=h.prepare}else f=h;p.addCase(l,f).exposeCaseReducer(c,f).exposeAction(c,m?createAction(l,m):createAction(l))}(m,f,y):function({type:l,reducerName:c},d,h,p){if(!p)throw new Error(formatProdErrorMessage(18));const{payloadCreator:f,fulfilled:m,pending:y,rejected:_,settled:b,options:w}=d,E=p(l,f,w);h.exposeAction(c,E),m&&h.addCase(E.fulfilled,m);y&&h.addCase(E.pending,y);_&&h.addCase(E.rejected,_);b&&h.addMatcher(E.settled,b);h.exposeCaseReducer(c,{fulfilled:m||noop$1,pending:y||noop$1,rejected:_||noop$1,settled:b||noop$1})}(m,f,y,c)}));const selectSelf=l=>l,_=new Map,b=new WeakMap;let w;function reducer(l,c){return w||(w=buildReducer()),w(l,c)}function getInitialState(){return w||(w=buildReducer()),w.getInitialState()}function makeSelectorProps(c,d=!1){function selectSlice(l){let h=l[c];return void 0===h&&d&&(h=getOrInsertComputed(b,selectSlice,getInitialState)),h}function getSelectors(c=selectSelf){const h=getOrInsertComputed(_,d,(()=>new WeakMap));return getOrInsertComputed(h,c,(()=>{const h={};for(const[p,f]of Object.entries(l.selectors??{}))h[p]=wrapSelector(f,c,(()=>getOrInsertComputed(b,c,getInitialState)),d);return h}))}return{reducerPath:c,getSelectors:getSelectors,get selectors(){return getSelectors(selectSlice)},selectSlice:selectSlice}}const E={name:d,reducer:reducer,actions:m.actionCreators,caseReducers:m.sliceCaseReducersByName,getInitialState:getInitialState,...makeSelectorProps(h),injectInto(l,{reducerPath:c,...d}={}){const p=c??h;return l.inject({reducerPath:p,reducer:reducer},d),{...E,...makeSelectorProps(p,!0)}}};return E}}function wrapSelector(l,c,d,h){function wrapper(p,...f){let m=c(p);return void 0===m&&h&&(m=d()),l(m,...f)}return wrapper.unwrapped=l,wrapper}var cT=buildCreateSlice();function noop$1(){}var uT="listener",dT="completed",hT="cancelled",pT=`task-${hT}`,fT=`task-${dT}`,mT=`${uT}-${hT}`,gT=`${uT}-${dT}`,vT=class{constructor(l){__publicField(this,"name","TaskAbortError"),__publicField(this,"message"),this.code=l,this.message=`task ${hT} (reason: ${l})`}},assertFunction=(l,c)=>{if("function"!=typeof l)throw new TypeError(formatProdErrorMessage(32))},noop2=()=>{},catchRejection=(l,c=noop2)=>(l.catch(c),l),addAbortSignalListener=(l,c)=>(l.addEventListener("abort",c,{once:!0}),()=>l.removeEventListener("abort",c)),abortControllerWithReason=(l,c)=>{const d=l.signal;d.aborted||("reason"in d||Object.defineProperty(d,"reason",{enumerable:!0,value:c,configurable:!0,writable:!0}),l.abort(c))},validateActive=l=>{if(l.aborted){const{reason:c}=l;throw new vT(c)}};function raceWithSignal(l,c){let d=noop2;return new Promise(((h,p)=>{const notifyRejection=()=>p(new vT(l.reason));l.aborted?notifyRejection():(d=addAbortSignalListener(l,notifyRejection),c.finally((()=>d())).then(h,p))})).finally((()=>{d=noop2}))}var createPause=l=>c=>catchRejection(raceWithSignal(l,c).then((c=>(validateActive(l),c)))),createDelay=l=>{const c=createPause(l);return l=>c(new Promise((c=>setTimeout(c,l))))},{assign:yT}=Object,_T={},bT="listenerMiddleware",createFork=(l,c)=>(d,h)=>{assertFunction(d);const p=new AbortController;var f;f=p,addAbortSignalListener(l,(()=>abortControllerWithReason(f,l.reason)));const m=(async(l,c)=>{try{return await Promise.resolve(),{status:"ok",value:await l()}}catch(d){return{status:d instanceof vT?"cancelled":"rejected",error:d}}finally{c?.()}})((async()=>{validateActive(l),validateActive(p.signal);const c=await d({pause:createPause(p.signal),delay:createDelay(p.signal),signal:p.signal});return validateActive(p.signal),c}),(()=>abortControllerWithReason(p,fT)));return h?.autoJoin&&c.push(m.catch(noop2)),{result:createPause(l)(m),cancel(){abortControllerWithReason(p,pT)}}},createTakePattern=(l,c)=>(d,h)=>catchRejection((async(d,h)=>{validateActive(c);let unsubscribe=()=>{};const p=[new Promise(((c,h)=>{let p=l({predicate:d,effect:(l,d)=>{d.unsubscribe(),c([l,d.getState(),d.getOriginalState()])}});unsubscribe=()=>{p(),h()}}))];null!=h&&p.push(new Promise((l=>setTimeout(l,h,null))));try{const l=await raceWithSignal(c,Promise.race(p));return validateActive(c),l}finally{unsubscribe()}})(d,h)),getListenerEntryPropsFrom=l=>{let{type:c,actionCreator:d,matcher:h,predicate:p,effect:f}=l;if(c)p=createAction(c).match;else if(d)c=d.type,p=d.match;else if(h)p=h;else if(!p)throw new Error(formatProdErrorMessage(21));return assertFunction(f),{predicate:p,type:c,effect:f}},wT=yT((l=>{const{type:c,predicate:d,effect:h}=getListenerEntryPropsFrom(l);return{id:nanoid(),effect:h,type:c,predicate:d,pending:new Set,unsubscribe:()=>{throw new Error(formatProdErrorMessage(22))}}}),{withTypes:()=>wT}),findListenerEntry=(l,c)=>{const{type:d,effect:h,predicate:p}=getListenerEntryPropsFrom(c);return Array.from(l.values()).find((l=>("string"==typeof d?l.type===d:l.predicate===p)&&l.effect===h))},cancelActiveListeners=l=>{l.pending.forEach((l=>{abortControllerWithReason(l,mT)}))},safelyNotifyError=(l,c,d)=>{try{l(c,d)}catch(h){setTimeout((()=>{throw h}),0)}},ST=yT(createAction(`${bT}/add`),{withTypes:()=>ST}),xT=createAction(`${bT}/removeAll`),kT=yT(createAction(`${bT}/remove`),{withTypes:()=>kT}),defaultErrorHandler=(...l)=>{console.error(`${bT}/error`,...l)},createListenerMiddleware=(l={})=>{const c=new Map,{extra:d,onError:h=defaultErrorHandler}=l;assertFunction(h);const startListening=l=>(l=>(l.unsubscribe=()=>c.delete(l.id),c.set(l.id,l),c=>{l.unsubscribe(),c?.cancelActive&&cancelActiveListeners(l)}))(findListenerEntry(c,l)??wT(l));yT(startListening,{withTypes:()=>startListening});const stopListening=l=>{const d=findListenerEntry(c,l);return d&&(d.unsubscribe(),l.cancelActive&&cancelActiveListeners(d)),!!d};yT(stopListening,{withTypes:()=>stopListening});const notifyListener=async(l,p,f,m)=>{const y=new AbortController,_=createTakePattern(startListening,y.signal),b=[];try{l.pending.add(y),await Promise.resolve(l.effect(p,yT({},f,{getOriginalState:m,condition:(l,c)=>_(l,c).then(Boolean),take:_,delay:createDelay(y.signal),pause:createPause(y.signal),extra:d,signal:y.signal,fork:createFork(y.signal,b),unsubscribe:l.unsubscribe,subscribe:()=>{c.set(l.id,l)},cancelActiveListeners:()=>{l.pending.forEach(((l,c,d)=>{l!==y&&(abortControllerWithReason(l,mT),d.delete(l))}))},cancel:()=>{abortControllerWithReason(y,mT),l.pending.delete(y)},throwIfCancelled:()=>{validateActive(y.signal)}})))}catch(w){w instanceof vT||safelyNotifyError(h,w,{raisedBy:"effect"})}finally{await Promise.all(b),abortControllerWithReason(y,gT),l.pending.delete(y)}},p=(l=>()=>{l.forEach(cancelActiveListeners),l.clear()})(c);return{middleware:l=>d=>f=>{if(!isAction(f))return d(f);if(ST.match(f))return startListening(f.payload);if(xT.match(f))return void p();if(kT.match(f))return stopListening(f.payload);let m=l.getState();const getOriginalState=()=>{if(m===_T)throw new Error(formatProdErrorMessage(23));return m};let y;try{if(y=d(f),c.size>0){const d=l.getState(),p=Array.from(c.values());for(const c of p){let p=!1;try{p=c.predicate(f,d,m)}catch(_){p=!1,safelyNotifyError(h,_,{raisedBy:"predicate"})}p&&notifyListener(c,f,l,getOriginalState)}}}finally{m=_T}return y},startListening:startListening,stopListening:stopListening,clearListeners:p}};function formatProdErrorMessage(l){return`Minified Redux Toolkit error #${l}; visit https://redux-toolkit.js.org/Errors?code=${l} for the full message or use the non-minified dev environment for full errors. `}const ChatHeader=({isConnected:l,isConnecting:c,error:d,authToken:h,isDevMode:p,retryCount:f=0,hasReachedMaxRetries:m=!1,onToggleDevMode:y,onOpenDocuments:_,onRetryConnection:b,onOpenSettings:w,onOpenAIRules:E,onOpenMediaUpload:M})=>Kt.jsxs("div",{className:"sticky top-0 z-40 bg-background",children:[Kt.jsx("div",{className:"border-b bg-background/95 backdrop-blur-sm p-4",children:Kt.jsxs("div",{className:"flex items-center justify-between",children:[Kt.jsxs("div",{className:"flex items-center gap-2",children:[Kt.jsx("h1",{className:"text-lg font-semibold",children:"Chat Assistant"}),m&&Kt.jsxs(or,{variant:"ghost",size:"sm",onClick:b,className:"text-red-600 hover:text-red-700 hover:bg-red-50",children:[Kt.jsx(Ni,{className:"h-4 w-4 mr-1"}),"Try Again"]}),p&&Kt.jsx("span",{className:"px-2 py-1 text-xs bg-orange-100 text-orange-800 rounded-full bounce-in",children:"DEV MODE"})]}),Kt.jsxs("div",{className:"flex items-center gap-2",children:[Kt.jsx(or,{variant:"ghost",size:"sm",disabled:!h,onClick:_,title:h?"Open documents":"Authentication required",children:Kt.jsx(Zs,{className:"h-4 w-4"})}),p&&Kt.jsx(or,{variant:"ghost",size:"sm",onClick:E,title:"View AI Rules",className:"animate-in fade-in slide-in-from-right-2 duration-200",children:Kt.jsx(Us,{className:"h-4 w-4"})}),Kt.jsx(or,{variant:"ghost",size:"sm",disabled:!h,onClick:M,title:h?"Manage image files":"Authentication required",children:Kt.jsx(mi,{className:"h-4 w-4"})}),Kt.jsx(or,{variant:"ghost",size:"sm",onClick:y,className:tr("transition-colors duration-200",p&&"bg-orange-100 text-orange-800 hover:bg-orange-200"),children:Kt.jsx(Cs,{className:"h-4 w-4"})}),Kt.jsx(or,{variant:"ghost",size:"sm",onClick:w,title:"Settings",children:Kt.jsx(ji,{className:"h-4 w-4"})})]})]})}),!l&&Kt.jsx("div",{className:tr("w-full transition-all duration-300",c?"bg-yellow-500/10 border-b border-yellow-500/20":"bg-red-500/10 border-b border-red-500/20 cursor-pointer hover:bg-red-500/15",!c&&"group",d&&!c&&"animate-[subtle-pulse_2s_ease-in-out_infinite]"),onClick:c||m?void 0:b,children:Kt.jsxs("div",{className:"flex items-center justify-center gap-2 px-4 py-2",children:[Kt.jsx("div",{className:tr("w-2.5 h-2.5 rounded-full transition-all duration-300",c?"bg-yellow-500 animate-pulse":"bg-red-500")}),Kt.jsx("span",{className:tr("text-sm font-medium",c?"text-yellow-700 dark:text-yellow-400":"text-red-700 dark:text-red-400"),children:c?"Establishing connection"+(f>0?` (Attempt ${f})`:"..."):m?"Connection failed - Maximum retries reached":"Not connected - Click to reconnect"}),!c&&!m&&Kt.jsx(Ni,{className:"h-4 w-4 text-red-700 dark:text-red-400 group-hover:rotate-180 transition-transform duration-300"}),m&&Kt.jsx(Yi,{className:"h-4 w-4 text-red-700 dark:text-red-400"})]})})]}),getDocumentIcon=l=>{const c={pdf:Fs,doc:Fs,docx:Fs,xlsx:Fs,xls:Fs,ppt:Fs,pptx:Fs,jpg:vi,jpeg:vi,png:vi,gif:vi,svg:vi,webp:vi,default:Fs};return c[l.toLowerCase()]||c.default};var CT={exports:{}},ET={},IT=Gt;var TT="function"==typeof Object.is?Object.is:function(l,c){return l===c&&(0!==l||1/l==1/c)||l!=l&&c!=c},RT=IT.useSyncExternalStore,AT=IT.useRef,OT=IT.useEffect,MT=IT.useMemo,NT=IT.useDebugValue;ET.useSyncExternalStoreWithSelector=function(l,c,d,h,p){var f=AT(null);if(null===f.current){var m={hasValue:!1,value:null};f.current=m}else m=f.current;f=MT((function(){function memoizedSelector(c){if(!y){if(y=!0,l=c,c=h(c),void 0!==p&&m.hasValue){var d=m.value;if(p(d,c))return f=d}return f=c}if(d=f,TT(l,c))return d;var _=h(c);return void 0!==p&&p(d,_)?(l=c,d):(l=c,f=_)}var l,f,y=!1,_=void 0===d?null:d;return[function(){return memoizedSelector(c())},null===_?void 0:function(){return memoizedSelector(_())}]}),[c,d,h,p]);var y=RT(l,f[0],f[1]);return OT((function(){m.hasValue=!0,m.value=y}),[y]),NT(y),y},CT.exports=ET;var PT=CT.exports;var LT={notify(){},get:()=>[]};var jT=(()=>!("undefined"==typeof window||void 0===window.document||void 0===window.document.createElement))(),DT=(()=>"undefined"!=typeof navigator&&"ReactNative"===navigator.product)(),FT=(()=>jT||DT?Gt.useLayoutEffect:Gt.useEffect)(),$T=Symbol.for("react-redux-context"),UT="undefined"!=typeof globalThis?globalThis:{};function getContext(){if(!Gt.createContext)return{};const l=UT[$T]??(UT[$T]=new Map);let c=l.get(Gt.createContext);return c||(c=Gt.createContext(null),l.set(Gt.createContext,c)),c}var BT=getContext();var Provider_default=function(l){const{children:c,context:d,serverState:h,store:p}=l,f=Gt.useMemo((()=>{const l=function(l){let c,d=LT,h=0,p=!1;function handleChangeWrapper(){f.onStateChange&&f.onStateChange()}function trySubscribe(){h++,c||(c=l.subscribe(handleChangeWrapper),d=function(){let l=null,c=null;return{clear(){l=null,c=null},notify(){(()=>{let c=l;for(;c;)c.callback(),c=c.next})()},get(){const c=[];let d=l;for(;d;)c.push(d),d=d.next;return c},subscribe(d){let h=!0;const p=c={callback:d,next:null,prev:c};return p.prev?p.prev.next=p:l=p,function(){h&&null!==l&&(h=!1,p.next?p.next.prev=p.prev:c=p.prev,p.prev?p.prev.next=p.next:l=p.next)}}}}())}function tryUnsubscribe(){h--,c&&0===h&&(c(),c=void 0,d.clear(),d=LT)}const f={addNestedSub:function(l){trySubscribe();const c=d.subscribe(l);let h=!1;return()=>{h||(h=!0,c(),tryUnsubscribe())}},notifyNestedSubs:function(){d.notify()},handleChangeWrapper:handleChangeWrapper,isSubscribed:function(){return p},trySubscribe:function(){p||(p=!0,trySubscribe())},tryUnsubscribe:function(){p&&(p=!1,tryUnsubscribe())},getListeners:()=>d};return f}(p);return{store:p,subscription:l,getServerState:h?()=>h:void 0}}),[p,h]),m=Gt.useMemo((()=>p.getState()),[p]);FT((()=>{const{subscription:l}=f;return l.onStateChange=l.notifyNestedSubs,l.trySubscribe(),m!==p.getState()&&l.notifyNestedSubs(),()=>{l.tryUnsubscribe(),l.onStateChange=void 0}}),[f,m]);const y=d||BT;return Gt.createElement(y.Provider,{value:f},c)};function createReduxContextHook(l=BT){return function(){return Gt.useContext(l)}}var HT=createReduxContextHook();function createStoreHook(l=BT){const c=l===BT?HT:createReduxContextHook(l),useStore2=()=>{const{store:l}=c();return l};return Object.assign(useStore2,{withTypes:()=>useStore2}),useStore2}var zT=createStoreHook();function createDispatchHook(l=BT){const c=l===BT?zT:createStoreHook(l),useDispatch2=()=>c().dispatch;return Object.assign(useDispatch2,{withTypes:()=>useDispatch2}),useDispatch2}var qT=createDispatchHook(),refEquality=(l,c)=>l===c;function createSelectorHook(l=BT){const c=l===BT?HT:createReduxContextHook(l),useSelector2=(l,d={})=>{const{equalityFn:h=refEquality}="function"==typeof d?{equalityFn:d}:d,p=c(),{store:f,subscription:m,getServerState:y}=p;Gt.useRef(!0);const _=Gt.useCallback({[l.name]:c=>l(c)}[l.name],[l]),b=PT.useSyncExternalStoreWithSelector(m.addNestedSub,f.getState,y||f.getState,_,h);return Gt.useDebugValue(b),b};return Object.assign(useSelector2,{withTypes:()=>useSelector2}),useSelector2}var WT=createSelectorHook();const VT=class _OverlayManager{constructor(){__publicField(this,"activeTabId",null),__publicField(this,"overlayActive",!1),__publicField(this,"overlayPromise",null)}static getInstance(){return _OverlayManager.instance||(_OverlayManager.instance=new _OverlayManager),_OverlayManager.instance}async show(l,c,d){try{const f=await this.getTargetTabId(d);if(!f)return void console.warn("No valid Confirmit tab found for overlay");this.activeTabId=f;try{await er.tabs.sendMessage(f,{type:"SHOW_OVERLAY",message:l||"Please wait - actions are being executed",submessage:c||"Please do not interact with the page"});this.overlayActive=!0}catch(h){if(!h?.message?.includes("Could not establish connection")&&!h?.message?.includes("Receiving end does not exist"))throw h;try{const l=await er.tabs.get(f);l.url&&this.isConfirmitUrl(l.url)}catch(p){console.warn("Could not check tab status:",p)}this.overlayActive=!0}}catch(f){console.error("Error showing overlay:",f),this.overlayActive=!1}}async hide(l){try{const d=l||this.activeTabId;if(!d)return;try{await er.tabs.sendMessage(d,{type:"HIDE_OVERLAY"})}catch(c){c?.message?.includes("Could not establish connection")||c?.message?.includes("Receiving end does not exist")||console.warn("Error hiding overlay:",c)}this.overlayActive=!1,this.activeTabId=null}catch(d){console.warn("Error hiding overlay:",d),this.overlayActive=!1,this.activeTabId=null}}async updateMessage(l,c,d){try{const p=d||this.activeTabId;if(!p||!this.overlayActive)return;try{await er.tabs.sendMessage(p,{type:"UPDATE_OVERLAY_MESSAGE",message:l,submessage:c})}catch(h){h?.message?.includes("Could not establish connection")||h?.message?.includes("Receiving end does not exist")||console.warn("Error updating overlay message:",h)}}catch(p){console.warn("Error updating overlay message:",p)}}isActive(){return this.overlayActive}async getStatus(l){try{const c=l||this.activeTabId;if(!c)return null;return await er.tabs.sendMessage(c,{type:"GET_OVERLAY_STATUS"})}catch(c){return console.warn("Error getting overlay status:",c),null}}async executeWithOverlay(l,c,d,h){try{await this.show(c,d,h);return await l()}finally{await this.hide(h)}}async getTargetTabId(l){try{if(l){const c=await er.tabs.get(l);if(c&&c.url&&this.isConfirmitUrl(c.url))return l}const c=await er.tabs.query({active:!0,currentWindow:!0});if(c.length>0&&c[0].id){const l=c[0];if(l.url&&this.isConfirmitUrl(l.url))return l?.id??0}const d=await er.tabs.query({url:"*://*.confirmit.com/*"});return d.length>0&&d[0].id?d[0].id:null}catch(c){return console.error("Error getting target tab:",c),null}}isConfirmitUrl(l){return l.includes("confirmit.com")}async cleanupAll(){try{const l=await er.tabs.query({url:"*://*.confirmit.com/*"});await Promise.all(l.map((l=>l.id?this.hide(l.id):Promise.resolve()))),this.overlayActive=!1,this.activeTabId=null}catch(l){console.error("Error during overlay cleanup:",l)}}};__publicField(VT,"instance",null);const ZT=VT.getInstance(),GT=cT({name:"chat",initialState:{sessionData:null,isLoading:!1,error:null},reducers:{addTurn:(l,c)=>{if(!l.sessionData?.plan){if(!l.sessionData)return;l.sessionData.plan={turns:[],is_streaming:!1}}l.sessionData.plan.turns.push(c.payload)},updateTurn:(l,c)=>{if(!l.sessionData?.plan?.turns)return;const d=l.sessionData.plan.turns.findIndex((l=>l.id===c.payload.id));-1!==d&&(l.sessionData.plan.turns[d]={...l.sessionData.plan.turns[d],...c.payload.updates})},removeTurn:(l,c)=>{l.sessionData?.plan?.turns&&(l.sessionData.plan.turns=l.sessionData.plan.turns.filter((l=>l.id!==c.payload)))},clearTurns:l=>{l.sessionData?.plan&&(l.sessionData.plan.turns=[])},setStreaming:(l,c)=>{if(!l.sessionData?.plan){if(!l.sessionData)return;l.sessionData.plan={turns:[],is_streaming:!1}}l.sessionData.plan.is_streaming=c.payload},updateSessionData:(l,c)=>{l.sessionData?Object.assign(l.sessionData,c.payload):l.sessionData={survey_name:"",survey_language:"en-us",confirmit_session_id:"",created_at_ts:Date.now(),document:{type:"questionnaire",status:"not_started",files:[]},artefacts:{files:[],links:[]},...c.payload}},setSessionData:(l,c)=>{l.sessionData=c.payload},setLoading:(l,c)=>{l.isLoading=c.payload},setChatError:(l,c)=>{l.error=c.payload},addMessage:(l,c)=>{const d={id:c.payload.id,content:c.payload.content,role:c.payload.role,timestamp:c.payload.timestamp,generated_content:"",tool_calls:[]};if(!l.sessionData?.plan){if(!l.sessionData)return;l.sessionData.plan={turns:[],is_streaming:!1}}l.sessionData.plan.turns.push(d)},updateMessage:(l,c)=>{if(!l.sessionData?.plan?.turns)return;const d=l.sessionData.plan.turns.findIndex((l=>l.id===c.payload.id));-1!==d&&Object.assign(l.sessionData.plan.turns[d],c.payload.updates)},removeMessage:(l,c)=>{l.sessionData?.plan?.turns&&(l.sessionData.plan.turns=l.sessionData.plan.turns.filter((l=>l.id!==c.payload)))},clearMessages:l=>{l.sessionData?.plan&&(l.sessionData.plan.turns=[])},updateData:(l,c)=>{l.sessionData=c.payload},clearChatState:l=>{l.sessionData=null,l.isLoading=!1,l.error=null}}}),{addTurn:KT,updateTurn:JT,removeTurn:YT,clearTurns:QT,setStreaming:XT,updateSessionData:eR,setSessionData:tR,setLoading:rR,setChatError:nR,addMessage:sR,updateMessage:iR,removeMessage:oR,clearMessages:aR,updateData:lR,clearChatState:cR}=GT.actions,uR=GT.reducer,dR=createListenerMiddleware(),hR=dR.startListening;let pR,fR=!1;async function getCurrentConfirmitTabId(){try{const l=(await er.tabs.query({active:!0,currentWindow:!0}))[0];if(l?.id&&l.url?.includes("confirmit.com"))return l.id;const c=await er.tabs.query({url:"*://*.confirmit.com/*"});if(c.length>0&&c[0].id)return c[0].id}catch(l){console.error("Error getting Confirmit tab:",l)}}async function showStreamingOverlay(l){try{if(fR)return;if(pR=await getCurrentConfirmitTabId(),!pR)return;let c="Processing your request...",d="Please wait while actions are being executed";const h=l.chat.sessionData?.plan?.turns||[],p=h[h.length-1];if(p&&"assistant"===p.role){const l=p.tool_calls?.filter((l=>"pending"===l.status))||[];if(l.length>0){const h=new Set(l.map((l=>l.type)));h.has("createQuestion")?(c="Creating questions...",d="Adding new questions to your survey"):h.has("updateQuestion")?(c="Updating questions...",d="Modifying question properties"):h.has("updateAnswers")?(c="Updating answer options...",d="Modifying answer choices"):h.has("deleteNode")?(c="Deleting nodes...",d="Removing selected items"):h.has("getRouting")?(c="Analyzing survey routing...",d="Processing survey structure"):(c="Executing operations...",d=`Processing ${l.length} action${l.length>1?"s":""}`)}else c="AI is thinking...",d="Generating response"}await ZT.show(c,d,pR),fR=!0}catch(c){console.error("Error showing streaming overlay:",c)}}async function hideStreamingOverlay(){try{if(!fR)return;await ZT.hide(pR),fR=!1,pR=void 0}catch(l){console.error("Error hiding streaming overlay:",l)}}async function updateOverlayForToolCall(l){try{if(!pR&&(pR=await getCurrentConfirmitTabId(),!pR))return;const c=l.chat.sessionData?.plan?.turns||[],d=c[c.length-1];if(d&&"assistant"===d.role){const l=(d.tool_calls||[]).filter((l=>"pending"===l.status));l.length>0?(await er.tabs.sendMessage(pR,{type:"SHOW_BLOCKING_OVERLAY"}),fR=!0):(await er.tabs.sendMessage(pR,{type:"SHOW_OVERLAY"}),fR=!0)}else await er.tabs.sendMessage(pR,{type:"SHOW_OVERLAY"}),fR=!0}catch(c){console.error("Error updating overlay for tool call:",c)}}hR({actionCreator:XT,effect:async(l,c)=>{const d=l.payload,h=c.getState();d?await showStreamingOverlay(h):await hideStreamingOverlay()}}),hR({actionCreator:lR,effect:async(l,c)=>{const d=c.getOriginalState(),h=c.getState(),p=d.chat.sessionData?.plan?.is_streaming||!1,f=h.chat.sessionData?.plan?.is_streaming||!1;p!==f?f?await showStreamingOverlay(h):await hideStreamingOverlay():f&&fR&&await updateOverlayForToolCall(h)}}),hR({matcher:isAnyOf(JT,KT),effect:async(l,c)=>{const d=c.getState(),h=d.chat.sessionData?.plan?.is_streaming;h&&fR&&await updateOverlayForToolCall(d)}}),hR({predicate:l=>"websocket/disconnected"===l.type||"websocket/connectionError"===l.type||"chat/setChatError"===l.type,effect:async()=>{await hideStreamingOverlay()}});const mR=dR.middleware,gR=cT({name:"websocket",initialState:{isConnected:!1,isConnecting:!1,error:null,sessionId:null,token:null,invalidAccess:!1,product:"chat"},reducers:{connecting:(l,c)=>{l.isConnecting=!0,l.isConnected=!1,l.error=null,l.sessionId=c.payload.sessionId,l.token=c.payload.token},connected:l=>{l.isConnected=!0,l.isConnecting=!1,l.error=null},disconnected:l=>{l.isConnected=!1,l.isConnecting=!1,l.sessionId=null,l.token=null},connectionError:(l,c)=>{l.isConnected=!1,l.isConnecting=!1,l.error=c.payload},setInvalidAccess:(l,c)=>{l.invalidAccess=c.payload},setProduct:(l,c)=>{l.product=c.payload}}}),{connecting:vR,connected:yR,disconnected:_R,connectionError:bR,setInvalidAccess:wR,setProduct:SR}=gR.actions,xR=gR.reducer;var kR,CR,ER={exports:{}};kR=ER,CR=ER.exports,function(){var l,c="Expected a function",d="__lodash_hash_undefined__",h="__lodash_placeholder__",p=32,f=128,m=256,y=1/0,_=9007199254740991,b=NaN,w=4294967295,E=[["ary",f],["bind",1],["bindKey",2],["curry",8],["curryRight",16],["flip",512],["partial",p],["partialRight",64],["rearg",m]],M="[object Arguments]",N="[object Array]",P="[object Boolean]",L="[object Date]",j="[object Error]",D="[object Function]",F="[object GeneratorFunction]",U="[object Map]",B="[object Number]",H="[object Object]",z="[object Promise]",q="[object RegExp]",V="[object Set]",Z="[object String]",K="[object Symbol]",Y="[object WeakMap]",ee="[object ArrayBuffer]",ne="[object DataView]",se="[object Float32Array]",ie="[object Float64Array]",oe="[object Int8Array]",le="[object Int16Array]",ce="[object Int32Array]",pe="[object Uint8Array]",fe="[object Uint8ClampedArray]",ge="[object Uint16Array]",be="[object Uint32Array]",Oe=/\b__p \+= '';/g,Ne=/\b(__p \+=) '' \+/g,De=/(__e\(.*?\)|\b__t\)) \+\n'';/g,Fe=/&(?:amp|lt|gt|quot|#39);/g,Ue=/[&<>"']/g,Be=RegExp(Fe.source),He=RegExp(Ue.source),qe=/<%-([\s\S]+?)%>/g,Ve=/<%([\s\S]+?)%>/g,Je=/<%=([\s\S]+?)%>/g,tt=/\.|\[(?:[^[\]]*|(["'])(?:(?!\1)[^\\]|\\.)*?\1)\]/,nt=/^\w*$/,it=/[^.[\]]+|\[(?:(-?\d+(?:\.\d+)?)|(["'])((?:(?!\2)[^\\]|\\.)*?)\2)\]|(?=(?:\.|\[\])(?:\.|\[\]|$))/g,ht=/[\\^$.*+?()[\]{}|]/g,ft=RegExp(ht.source),gt=/^\s+/,yt=/\s/,_t=/\{(?:\n\/\* \[wrapped with .+\] \*\/)?\n?/,bt=/\{\n\/\* \[wrapped with (.+)\] \*/,wt=/,? & /,St=/[^\x00-\x2f\x3a-\x40\x5b-\x60\x7b-\x7f]+/g,xt=/[()=,{}\[\]\/\s]/,kt=/\\(\\)?/g,Et=/\$\{([^\\}]*(?:\\.[^\\}]*)*)\}/g,It=/\w*$/,Tt=/^[-+]0x[0-9a-f]+$/i,At=/^0b[01]+$/i,Ot=/^\[object .+?Constructor\]$/,Mt=/^0o[0-7]+$/i,Nt=/^(?:0|[1-9]\d*)$/,Pt=/[\xc0-\xd6\xd8-\xf6\xf8-\xff\u0100-\u017f]/g,Lt=/($^)/,jt=/['\n\r\u2028\u2029\\]/g,Dt="\\ud800-\\udfff",Ft="\\u0300-\\u036f\\ufe20-\\ufe2f\\u20d0-\\u20ff",Bt="\\u2700-\\u27bf",Ht="a-z\\xdf-\\xf6\\xf8-\\xff",Wt="A-Z\\xc0-\\xd6\\xd8-\\xde",Vt="\\ufe0e\\ufe0f",Zt="\\xac\\xb1\\xd7\\xf7\\x00-\\x2f\\x3a-\\x40\\x5b-\\x60\\x7b-\\xbf\\u2000-\\u206f \\t\\x0b\\f\\xa0\\ufeff\\n\\r\\u2028\\u2029\\u1680\\u180e\\u2000\\u2001\\u2002\\u2003\\u2004\\u2005\\u2006\\u2007\\u2008\\u2009\\u200a\\u202f\\u205f\\u3000",Gt="['\u2019]",Kt="["+Dt+"]",Yt="["+Zt+"]",Qt="["+Ft+"]",er="\\d+",tr="["+Bt+"]",rr="["+Ht+"]",or="[^"+Dt+Zt+er+Bt+Ht+Wt+"]",ar="\\ud83c[\\udffb-\\udfff]",ur="[^"+Dt+"]",dr="(?:\\ud83c[\\udde6-\\uddff]){2}",pr="[\\ud800-\\udbff][\\udc00-\\udfff]",fr="["+Wt+"]",gr="\\u200d",vr="(?:"+rr+"|"+or+")",wr="(?:"+fr+"|"+or+")",Sr="(?:['\u2019](?:d|ll|m|re|s|t|ve))?",kr="(?:['\u2019](?:D|LL|M|RE|S|T|VE))?",Cr="(?:"+Qt+"|"+ar+")?",Er="["+Vt+"]?",Ir=Er+Cr+"(?:"+gr+"(?:"+[ur,dr,pr].join("|")+")"+Er+Cr+")*",Tr="(?:"+[tr,dr,pr].join("|")+")"+Ir,Rr="(?:"+[ur+Qt+"?",Qt,dr,pr,Kt].join("|")+")",Ar=RegExp(Gt,"g"),Or=RegExp(Qt,"g"),Mr=RegExp(ar+"(?="+ar+")|"+Rr+Ir,"g"),jr=RegExp([fr+"?"+rr+"+"+Sr+"(?="+[Yt,fr,"$"].join("|")+")",wr+"+"+kr+"(?="+[Yt,fr+vr,"$"].join("|")+")",fr+"?"+vr+"+"+Sr,fr+"+"+kr,"\\d*(?:1ST|2ND|3RD|(?![123])\\dTH)(?=\\b|[a-z_])","\\d*(?:1st|2nd|3rd|(?![123])\\dth)(?=\\b|[A-Z_])",er,Tr].join("|"),"g"),zr=RegExp("["+gr+Dt+Ft+Vt+"]"),qr=/[a-z][A-Z]|[A-Z]{2}[a-z]|[0-9][a-zA-Z]|[a-zA-Z][0-9]|[^a-zA-Z0-9 ]/,Vr=["Array","Buffer","DataView","Date","Error","Float32Array","Float64Array","Function","Int8Array","Int16Array","Int32Array","Map","Math","Object","Promise","RegExp","Set","String","Symbol","TypeError","Uint8Array","Uint8ClampedArray","Uint16Array","Uint32Array","WeakMap","_","clearTimeout","isFinite","parseInt","setTimeout"],Zr=-1,Gr={};Gr[se]=Gr[ie]=Gr[oe]=Gr[le]=Gr[ce]=Gr[pe]=Gr[fe]=Gr[ge]=Gr[be]=!0,Gr[M]=Gr[N]=Gr[ee]=Gr[P]=Gr[ne]=Gr[L]=Gr[j]=Gr[D]=Gr[U]=Gr[B]=Gr[H]=Gr[q]=Gr[V]=Gr[Z]=Gr[Y]=!1;var Kr={};Kr[M]=Kr[N]=Kr[ee]=Kr[ne]=Kr[P]=Kr[L]=Kr[se]=Kr[ie]=Kr[oe]=Kr[le]=Kr[ce]=Kr[U]=Kr[B]=Kr[H]=Kr[q]=Kr[V]=Kr[Z]=Kr[K]=Kr[pe]=Kr[fe]=Kr[ge]=Kr[be]=!0,Kr[j]=Kr[D]=Kr[Y]=!1;var Yr={"\\":"\\","'":"'","\n":"n","\r":"r","\u2028":"u2028","\u2029":"u2029"},en=parseFloat,tn=parseInt,rn="object"==typeof sr&&sr&&sr.Object===Object&&sr,nn="object"==typeof self&&self&&self.Object===Object&&self,sn=rn||nn||Function("return this")(),an=CR&&!CR.nodeType&&CR,ln=an&&kR&&!kR.nodeType&&kR,un=ln&&ln.exports===an,dn=un&&rn.process,hn=function(){try{var l=ln&&ln.require&&ln.require("util").types;return l||dn&&dn.binding&&dn.binding("util")}catch(hh){}}(),pn=hn&&hn.isArrayBuffer,wn=hn&&hn.isDate,Cn=hn&&hn.isMap,On=hn&&hn.isRegExp,Ln=hn&&hn.isSet,jn=hn&&hn.isTypedArray;function apply(l,c,d){switch(d.length){case 0:return l.call(c);case 1:return l.call(c,d[0]);case 2:return l.call(c,d[0],d[1]);case 3:return l.call(c,d[0],d[1],d[2])}return l.apply(c,d)}function arrayAggregator(l,c,d,h){for(var p=-1,f=null==l?0:l.length;++p<f;){var m=l[p];c(h,m,d(m),l)}return h}function arrayEach(l,c){for(var d=-1,h=null==l?0:l.length;++d<h&&!1!==c(l[d],d,l););return l}function arrayEachRight(l,c){for(var d=null==l?0:l.length;d--&&!1!==c(l[d],d,l););return l}function arrayEvery(l,c){for(var d=-1,h=null==l?0:l.length;++d<h;)if(!c(l[d],d,l))return!1;return!0}function arrayFilter(l,c){for(var d=-1,h=null==l?0:l.length,p=0,f=[];++d<h;){var m=l[d];c(m,d,l)&&(f[p++]=m)}return f}function arrayIncludes(l,c){return!(null==l||!l.length)&&baseIndexOf(l,c,0)>-1}function arrayIncludesWith(l,c,d){for(var h=-1,p=null==l?0:l.length;++h<p;)if(d(c,l[h]))return!0;return!1}function arrayMap(l,c){for(var d=-1,h=null==l?0:l.length,p=Array(h);++d<h;)p[d]=c(l[d],d,l);return p}function arrayPush(l,c){for(var d=-1,h=c.length,p=l.length;++d<h;)l[p+d]=c[d];return l}function arrayReduce(l,c,d,h){var p=-1,f=null==l?0:l.length;for(h&&f&&(d=l[++p]);++p<f;)d=c(d,l[p],p,l);return d}function arrayReduceRight(l,c,d,h){var p=null==l?0:l.length;for(h&&p&&(d=l[--p]);p--;)d=c(d,l[p],p,l);return d}function arraySome(l,c){for(var d=-1,h=null==l?0:l.length;++d<h;)if(c(l[d],d,l))return!0;return!1}var Dn=baseProperty("length");function baseFindKey(l,c,d){var h;return d(l,(function(l,d,p){if(c(l,d,p))return h=d,!1})),h}function baseFindIndex(l,c,d,h){for(var p=l.length,f=d+(h?1:-1);h?f--:++f<p;)if(c(l[f],f,l))return f;return-1}function baseIndexOf(l,c,d){return c==c?function(l,c,d){for(var h=d-1,p=l.length;++h<p;)if(l[h]===c)return h;return-1}(l,c,d):baseFindIndex(l,baseIsNaN,d)}function baseIndexOfWith(l,c,d,h){for(var p=d-1,f=l.length;++p<f;)if(h(l[p],c))return p;return-1}function baseIsNaN(l){return l!=l}function baseMean(l,c){var d=null==l?0:l.length;return d?baseSum(l,c)/d:b}function baseProperty(c){return function(d){return null==d?l:d[c]}}function basePropertyOf(c){return function(d){return null==c?l:c[d]}}function baseReduce(l,c,d,h,p){return p(l,(function(l,p,f){d=h?(h=!1,l):c(d,l,p,f)})),d}function baseSum(c,d){for(var h,p=-1,f=c.length;++p<f;){var m=d(c[p]);m!==l&&(h=h===l?m:h+m)}return h}function baseTimes(l,c){for(var d=-1,h=Array(l);++d<l;)h[d]=c(d);return h}function baseTrim(l){return l?l.slice(0,trimmedEndIndex(l)+1).replace(gt,""):l}function baseUnary(l){return function(c){return l(c)}}function baseValues(l,c){return arrayMap(c,(function(c){return l[c]}))}function cacheHas(l,c){return l.has(c)}function charsStartIndex(l,c){for(var d=-1,h=l.length;++d<h&&baseIndexOf(c,l[d],0)>-1;);return d}function charsEndIndex(l,c){for(var d=l.length;d--&&baseIndexOf(c,l[d],0)>-1;);return d}var Fn=basePropertyOf({"\xc0":"A","\xc1":"A","\xc2":"A","\xc3":"A","\xc4":"A","\xc5":"A","\xe0":"a","\xe1":"a","\xe2":"a","\xe3":"a","\xe4":"a","\xe5":"a","\xc7":"C","\xe7":"c","\xd0":"D","\xf0":"d","\xc8":"E","\xc9":"E","\xca":"E","\xcb":"E","\xe8":"e","\xe9":"e","\xea":"e","\xeb":"e","\xcc":"I","\xcd":"I","\xce":"I","\xcf":"I","\xec":"i","\xed":"i","\xee":"i","\xef":"i","\xd1":"N","\xf1":"n","\xd2":"O","\xd3":"O","\xd4":"O","\xd5":"O","\xd6":"O","\xd8":"O","\xf2":"o","\xf3":"o","\xf4":"o","\xf5":"o","\xf6":"o","\xf8":"o","\xd9":"U","\xda":"U","\xdb":"U","\xdc":"U","\xf9":"u","\xfa":"u","\xfb":"u","\xfc":"u","\xdd":"Y","\xfd":"y","\xff":"y","\xc6":"Ae","\xe6":"ae","\xde":"Th","\xfe":"th","\xdf":"ss","\u0100":"A","\u0102":"A","\u0104":"A","\u0101":"a","\u0103":"a","\u0105":"a","\u0106":"C","\u0108":"C","\u010a":"C","\u010c":"C","\u0107":"c","\u0109":"c","\u010b":"c","\u010d":"c","\u010e":"D","\u0110":"D","\u010f":"d","\u0111":"d","\u0112":"E","\u0114":"E","\u0116":"E","\u0118":"E","\u011a":"E","\u0113":"e","\u0115":"e","\u0117":"e","\u0119":"e","\u011b":"e","\u011c":"G","\u011e":"G","\u0120":"G","\u0122":"G","\u011d":"g","\u011f":"g","\u0121":"g","\u0123":"g","\u0124":"H","\u0126":"H","\u0125":"h","\u0127":"h","\u0128":"I","\u012a":"I","\u012c":"I","\u012e":"I","\u0130":"I","\u0129":"i","\u012b":"i","\u012d":"i","\u012f":"i","\u0131":"i","\u0134":"J","\u0135":"j","\u0136":"K","\u0137":"k","\u0138":"k","\u0139":"L","\u013b":"L","\u013d":"L","\u013f":"L","\u0141":"L","\u013a":"l","\u013c":"l","\u013e":"l","\u0140":"l","\u0142":"l","\u0143":"N","\u0145":"N","\u0147":"N","\u014a":"N","\u0144":"n","\u0146":"n","\u0148":"n","\u014b":"n","\u014c":"O","\u014e":"O","\u0150":"O","\u014d":"o","\u014f":"o","\u0151":"o","\u0154":"R","\u0156":"R","\u0158":"R","\u0155":"r","\u0157":"r","\u0159":"r","\u015a":"S","\u015c":"S","\u015e":"S","\u0160":"S","\u015b":"s","\u015d":"s","\u015f":"s","\u0161":"s","\u0162":"T","\u0164":"T","\u0166":"T","\u0163":"t","\u0165":"t","\u0167":"t","\u0168":"U","\u016a":"U","\u016c":"U","\u016e":"U","\u0170":"U","\u0172":"U","\u0169":"u","\u016b":"u","\u016d":"u","\u016f":"u","\u0171":"u","\u0173":"u","\u0174":"W","\u0175":"w","\u0176":"Y","\u0177":"y","\u0178":"Y","\u0179":"Z","\u017b":"Z","\u017d":"Z","\u017a":"z","\u017c":"z","\u017e":"z","\u0132":"IJ","\u0133":"ij","\u0152":"Oe","\u0153":"oe","\u0149":"'n","\u017f":"s"}),$n=basePropertyOf({"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#39;"});function escapeStringChar(l){return"\\"+Yr[l]}function hasUnicode(l){return zr.test(l)}function mapToArray(l){var c=-1,d=Array(l.size);return l.forEach((function(l,h){d[++c]=[h,l]})),d}function overArg(l,c){return function(d){return l(c(d))}}function replaceHolders(l,c){for(var d=-1,p=l.length,f=0,m=[];++d<p;){var y=l[d];y!==c&&y!==h||(l[d]=h,m[f++]=d)}return m}function setToArray(l){var c=-1,d=Array(l.size);return l.forEach((function(l){d[++c]=l})),d}function stringSize(l){return hasUnicode(l)?function(l){for(var c=Mr.lastIndex=0;Mr.test(l);)++c;return c}(l):Dn(l)}function stringToArray(l){return hasUnicode(l)?function(l){return l.match(Mr)||[]}(l):function(l){return l.split("")}(l)}function trimmedEndIndex(l){for(var c=l.length;c--&&yt.test(l.charAt(c)););return c}var Un=basePropertyOf({"&amp;":"&","&lt;":"<","&gt;":">","&quot;":'"',"&#39;":"'"}),Bn=function runInContext2(yt){var Dt,Ft=(yt=null==yt?sn:Bn.defaults(sn.Object(),yt,Bn.pick(sn,Vr))).Array,Bt=yt.Date,Ht=yt.Error,Wt=yt.Function,Vt=yt.Math,Zt=yt.Object,Gt=yt.RegExp,Kt=yt.String,Yt=yt.TypeError,Qt=Ft.prototype,er=Wt.prototype,tr=Zt.prototype,rr=yt["__core-js_shared__"],sr=er.toString,or=tr.hasOwnProperty,ar=0,ur=(Dt=/[^.]+$/.exec(rr&&rr.keys&&rr.keys.IE_PROTO||""))?"Symbol(src)_1."+Dt:"",dr=tr.toString,pr=sr.call(Zt),fr=sn._,gr=Gt("^"+sr.call(or).replace(ht,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$"),vr=un?yt.Buffer:l,wr=yt.Symbol,Sr=yt.Uint8Array,kr=vr?vr.allocUnsafe:l,Cr=overArg(Zt.getPrototypeOf,Zt),Er=Zt.create,Ir=tr.propertyIsEnumerable,Tr=Qt.splice,Rr=wr?wr.isConcatSpreadable:l,Mr=wr?wr.iterator:l,zr=wr?wr.toStringTag:l,Yr=function(){try{var l=getNative(Zt,"defineProperty");return l({},"",{}),l}catch(hh){}}(),rn=yt.clearTimeout!==sn.clearTimeout&&yt.clearTimeout,nn=Bt&&Bt.now!==sn.Date.now&&Bt.now,an=yt.setTimeout!==sn.setTimeout&&yt.setTimeout,ln=Vt.ceil,dn=Vt.floor,hn=Zt.getOwnPropertySymbols,Dn=vr?vr.isBuffer:l,Hn=yt.isFinite,zn=Qt.join,qn=overArg(Zt.keys,Zt),Wn=Vt.max,Vn=Vt.min,Zn=Bt.now,Gn=yt.parseInt,Kn=Vt.random,Jn=Qt.reverse,Yn=getNative(yt,"DataView"),Qn=getNative(yt,"Map"),Xn=getNative(yt,"Promise"),es=getNative(yt,"Set"),ts=getNative(yt,"WeakMap"),rs=getNative(Zt,"create"),ns=ts&&new ts,ss={},is=toSource(Yn),os=toSource(Qn),as=toSource(Xn),ls=toSource(es),cs=toSource(ts),us=wr?wr.prototype:l,ds=us?us.valueOf:l,Cs=us?us.toString:l;function lodash2(l){if(isObjectLike2(l)&&!na(l)&&!(l instanceof LazyWrapper)){if(l instanceof LodashWrapper)return l;if(or.call(l,"__wrapped__"))return wrapperClone(l)}return new LodashWrapper(l)}var Es=function(){function object(){}return function(c){if(!isObject2(c))return{};if(Er)return Er(c);object.prototype=c;var d=new object;return object.prototype=l,d}}();function baseLodash(){}function LodashWrapper(c,d){this.__wrapped__=c,this.__actions__=[],this.__chain__=!!d,this.__index__=0,this.__values__=l}function LazyWrapper(l){this.__wrapped__=l,this.__actions__=[],this.__dir__=1,this.__filtered__=!1,this.__iteratees__=[],this.__takeCount__=w,this.__views__=[]}function Hash2(l){var c=-1,d=null==l?0:l.length;for(this.clear();++c<d;){var h=l[c];this.set(h[0],h[1])}}function ListCache(l){var c=-1,d=null==l?0:l.length;for(this.clear();++c<d;){var h=l[c];this.set(h[0],h[1])}}function MapCache(l){var c=-1,d=null==l?0:l.length;for(this.clear();++c<d;){var h=l[c];this.set(h[0],h[1])}}function SetCache(l){var c=-1,d=null==l?0:l.length;for(this.__data__=new MapCache;++c<d;)this.add(l[c])}function Stack(l){var c=this.__data__=new ListCache(l);this.size=c.size}function arrayLikeKeys(l,c){var d=na(l),h=!d&&ra(l),p=!d&&!h&&ha(l),f=!d&&!h&&!p&&Sa(l),m=d||h||p||f,y=m?baseTimes(l.length,Kt):[],_=y.length;for(var b in l)!c&&!or.call(l,b)||m&&("length"==b||p&&("offset"==b||"parent"==b)||f&&("buffer"==b||"byteLength"==b||"byteOffset"==b)||isIndex(b,_))||y.push(b);return y}function arraySample(c){var d=c.length;return d?c[baseRandom(0,d-1)]:l}function arraySampleSize(l,c){return shuffleSelf(copyArray(l),baseClamp(c,0,l.length))}function arrayShuffle(l){return shuffleSelf(copyArray(l))}function assignMergeValue(c,d,h){(h!==l&&!eq(c[d],h)||h===l&&!(d in c))&&baseAssignValue(c,d,h)}function assignValue(c,d,h){var p=c[d];or.call(c,d)&&eq(p,h)&&(h!==l||d in c)||baseAssignValue(c,d,h)}function assocIndexOf(l,c){for(var d=l.length;d--;)if(eq(l[d][0],c))return d;return-1}function baseAggregator(l,c,d,h){return Os(l,(function(l,p,f){c(h,l,d(l),f)})),h}function baseAssign(l,c){return l&&copyObject(c,keys(c),l)}function baseAssignValue(l,c,d){"__proto__"==c&&Yr?Yr(l,c,{configurable:!0,enumerable:!0,value:d,writable:!0}):l[c]=d}function baseAt(c,d){for(var h=-1,p=d.length,f=Ft(p),m=null==c;++h<p;)f[h]=m?l:get2(c,d[h]);return f}function baseClamp(c,d,h){return c==c&&(h!==l&&(c=c<=h?c:h),d!==l&&(c=c>=d?c:d)),c}function baseClone(c,d,h,p,f,m){var y,_=1&d,b=2&d,w=4&d;if(h&&(y=f?h(c,p,f,m):h(c)),y!==l)return y;if(!isObject2(c))return c;var E=na(c);if(E){if(y=function(l){var c=l.length,d=new l.constructor(c);return c&&"string"==typeof l[0]&&or.call(l,"index")&&(d.index=l.index,d.input=l.input),d}(c),!_)return copyArray(c,y)}else{var N=vi(c),j=N==D||N==F;if(ha(c))return cloneBuffer(c,_);if(N==H||N==M||j&&!f){if(y=b||j?{}:initCloneObject(c),!_)return b?function(l,c){return copyObject(l,mi(l),c)}(c,function(l,c){return l&&copyObject(c,keysIn(c),l)}(y,c)):function(l,c){return copyObject(l,hi(l),c)}(c,baseAssign(y,c))}else{if(!Kr[N])return f?c:{};y=function(l,c,d){var h,p=l.constructor;switch(c){case ee:return cloneArrayBuffer(l);case P:case L:return new p(+l);case ne:return function(l,c){var d=c?cloneArrayBuffer(l.buffer):l.buffer;return new l.constructor(d,l.byteOffset,l.byteLength)}(l,d);case se:case ie:case oe:case le:case ce:case pe:case fe:case ge:case be:return cloneTypedArray(l,d);case U:return new p;case B:case Z:return new p(l);case q:return function(l){var c=new l.constructor(l.source,It.exec(l));return c.lastIndex=l.lastIndex,c}(l);case V:return new p;case K:return h=l,ds?Zt(ds.call(h)):{}}}(c,N,_)}}m||(m=new Stack);var z=m.get(c);if(z)return z;m.set(c,y),wa(c)?c.forEach((function(l){y.add(baseClone(l,d,h,l,c,m))})):ya(c)&&c.forEach((function(l,p){y.set(p,baseClone(l,d,h,p,c,m))}));var Y=E?l:(w?b?getAllKeysIn:getAllKeys:b?keysIn:keys)(c);return arrayEach(Y||c,(function(l,p){Y&&(l=c[p=l]),assignValue(y,p,baseClone(l,d,h,p,c,m))})),y}function baseConformsTo(c,d,h){var p=h.length;if(null==c)return!p;for(c=Zt(c);p--;){var f=h[p],m=d[f],y=c[f];if(y===l&&!(f in c)||!m(y))return!1}return!0}function baseDelay(d,h,p){if("function"!=typeof d)throw new Yt(c);return wi((function(){d.apply(l,p)}),h)}function baseDifference(l,c,d,h){var p=-1,f=arrayIncludes,m=!0,y=l.length,_=[],b=c.length;if(!y)return _;d&&(c=arrayMap(c,baseUnary(d))),h?(f=arrayIncludesWith,m=!1):c.length>=200&&(f=cacheHas,m=!1,c=new SetCache(c));e:for(;++p<y;){var w=l[p],E=null==d?w:d(w);if(w=h||0!==w?w:0,m&&E==E){for(var M=b;M--;)if(c[M]===E)continue e;_.push(w)}else f(c,E,h)||_.push(w)}return _}lodash2.templateSettings={escape:qe,evaluate:Ve,interpolate:Je,variable:"",imports:{_:lodash2}},lodash2.prototype=baseLodash.prototype,lodash2.prototype.constructor=lodash2,LodashWrapper.prototype=Es(baseLodash.prototype),LodashWrapper.prototype.constructor=LodashWrapper,LazyWrapper.prototype=Es(baseLodash.prototype),LazyWrapper.prototype.constructor=LazyWrapper,Hash2.prototype.clear=function(){this.__data__=rs?rs(null):{},this.size=0},Hash2.prototype.delete=function(l){var c=this.has(l)&&delete this.__data__[l];return this.size-=c?1:0,c},Hash2.prototype.get=function(c){var h=this.__data__;if(rs){var p=h[c];return p===d?l:p}return or.call(h,c)?h[c]:l},Hash2.prototype.has=function(c){var d=this.__data__;return rs?d[c]!==l:or.call(d,c)},Hash2.prototype.set=function(c,h){var p=this.__data__;return this.size+=this.has(c)?0:1,p[c]=rs&&h===l?d:h,this},ListCache.prototype.clear=function(){this.__data__=[],this.size=0},ListCache.prototype.delete=function(l){var c=this.__data__,d=assocIndexOf(c,l);return!(d<0||(d==c.length-1?c.pop():Tr.call(c,d,1),--this.size,0))},ListCache.prototype.get=function(c){var d=this.__data__,h=assocIndexOf(d,c);return h<0?l:d[h][1]},ListCache.prototype.has=function(l){return assocIndexOf(this.__data__,l)>-1},ListCache.prototype.set=function(l,c){var d=this.__data__,h=assocIndexOf(d,l);return h<0?(++this.size,d.push([l,c])):d[h][1]=c,this},MapCache.prototype.clear=function(){this.size=0,this.__data__={hash:new Hash2,map:new(Qn||ListCache),string:new Hash2}},MapCache.prototype.delete=function(l){var c=getMapData(this,l).delete(l);return this.size-=c?1:0,c},MapCache.prototype.get=function(l){return getMapData(this,l).get(l)},MapCache.prototype.has=function(l){return getMapData(this,l).has(l)},MapCache.prototype.set=function(l,c){var d=getMapData(this,l),h=d.size;return d.set(l,c),this.size+=d.size==h?0:1,this},SetCache.prototype.add=SetCache.prototype.push=function(l){return this.__data__.set(l,d),this},SetCache.prototype.has=function(l){return this.__data__.has(l)},Stack.prototype.clear=function(){this.__data__=new ListCache,this.size=0},Stack.prototype.delete=function(l){var c=this.__data__,d=c.delete(l);return this.size=c.size,d},Stack.prototype.get=function(l){return this.__data__.get(l)},Stack.prototype.has=function(l){return this.__data__.has(l)},Stack.prototype.set=function(l,c){var d=this.__data__;if(d instanceof ListCache){var h=d.__data__;if(!Qn||h.length<199)return h.push([l,c]),this.size=++d.size,this;d=this.__data__=new MapCache(h)}return d.set(l,c),this.size=d.size,this};var Os=createBaseEach(baseForOwn),Ms=createBaseEach(baseForOwnRight,!0);function baseEvery(l,c){var d=!0;return Os(l,(function(l,h,p){return d=!!c(l,h,p)})),d}function baseExtremum(c,d,h){for(var p=-1,f=c.length;++p<f;){var m=c[p],y=d(m);if(null!=y&&(_===l?y==y&&!isSymbol(y):h(y,_)))var _=y,b=m}return b}function baseFilter(l,c){var d=[];return Os(l,(function(l,h,p){c(l,h,p)&&d.push(l)})),d}function baseFlatten(l,c,d,h,p){var f=-1,m=l.length;for(d||(d=isFlattenable),p||(p=[]);++f<m;){var y=l[f];c>0&&d(y)?c>1?baseFlatten(y,c-1,d,h,p):arrayPush(p,y):h||(p[p.length]=y)}return p}var Ns=createBaseFor(),Ps=createBaseFor(!0);function baseForOwn(l,c){return l&&Ns(l,c,keys)}function baseForOwnRight(l,c){return l&&Ps(l,c,keys)}function baseFunctions(l,c){return arrayFilter(c,(function(c){return isFunction2(l[c])}))}function baseGet2(c,d){for(var h=0,p=(d=castPath(d,c)).length;null!=c&&h<p;)c=c[toKey(d[h++])];return h&&h==p?c:l}function baseGetAllKeys(l,c,d){var h=c(l);return na(l)?h:arrayPush(h,d(l))}function baseGetTag2(c){return null==c?c===l?"[object Undefined]":"[object Null]":zr&&zr in Zt(c)?function(c){var d=or.call(c,zr),h=c[zr];try{c[zr]=l;var p=!0}catch(hh){}var f=dr.call(c);return p&&(d?c[zr]=h:delete c[zr]),f}(c):function(l){return dr.call(l)}(c)}function baseGt(l,c){return l>c}function baseHas(l,c){return null!=l&&or.call(l,c)}function baseHasIn(l,c){return null!=l&&c in Zt(l)}function baseIntersection(c,d,h){for(var p=h?arrayIncludesWith:arrayIncludes,f=c[0].length,m=c.length,y=m,_=Ft(m),b=1/0,w=[];y--;){var E=c[y];y&&d&&(E=arrayMap(E,baseUnary(d))),b=Vn(E.length,b),_[y]=!h&&(d||f>=120&&E.length>=120)?new SetCache(y&&E):l}E=c[0];var M=-1,N=_[0];e:for(;++M<f&&w.length<b;){var P=E[M],L=d?d(P):P;if(P=h||0!==P?P:0,!(N?cacheHas(N,L):p(w,L,h))){for(y=m;--y;){var j=_[y];if(!(j?cacheHas(j,L):p(c[y],L,h)))continue e}N&&N.push(L),w.push(P)}}return w}function baseInvoke(c,d,h){var p=null==(c=parent(c,d=castPath(d,c)))?c:c[toKey(last(d))];return null==p?l:apply(p,c,h)}function baseIsArguments(l){return isObjectLike2(l)&&baseGetTag2(l)==M}function baseIsEqual(c,d,h,p,f){return c===d||(null==c||null==d||!isObjectLike2(c)&&!isObjectLike2(d)?c!=c&&d!=d:function(c,d,h,p,f,m){var y=na(c),_=na(d),b=y?N:vi(c),w=_?N:vi(d),E=(b=b==M?H:b)==H,D=(w=w==M?H:w)==H,F=b==w;if(F&&ha(c)){if(!ha(d))return!1;y=!0,E=!1}if(F&&!E)return m||(m=new Stack),y||Sa(c)?equalArrays(c,d,h,p,f,m):function(l,c,d,h,p,f,m){switch(d){case ne:if(l.byteLength!=c.byteLength||l.byteOffset!=c.byteOffset)return!1;l=l.buffer,c=c.buffer;case ee:return!(l.byteLength!=c.byteLength||!f(new Sr(l),new Sr(c)));case P:case L:case B:return eq(+l,+c);case j:return l.name==c.name&&l.message==c.message;case q:case Z:return l==c+"";case U:var y=mapToArray;case V:var _=1&h;if(y||(y=setToArray),l.size!=c.size&&!_)return!1;var b=m.get(l);if(b)return b==c;h|=2,m.set(l,c);var w=equalArrays(y(l),y(c),h,p,f,m);return m.delete(l),w;case K:if(ds)return ds.call(l)==ds.call(c)}return!1}(c,d,b,h,p,f,m);if(!(1&h)){var z=E&&or.call(c,"__wrapped__"),Y=D&&or.call(d,"__wrapped__");if(z||Y){var se=z?c.value():c,ie=Y?d.value():d;return m||(m=new Stack),f(se,ie,h,p,m)}}return!!F&&(m||(m=new Stack),function(c,d,h,p,f,m){var y=1&h,_=getAllKeys(c),b=_.length,w=getAllKeys(d),E=w.length;if(b!=E&&!y)return!1;for(var M=b;M--;){var N=_[M];if(!(y?N in d:or.call(d,N)))return!1}var P=m.get(c),L=m.get(d);if(P&&L)return P==d&&L==c;var j=!0;m.set(c,d),m.set(d,c);for(var D=y;++M<b;){var F=c[N=_[M]],U=d[N];if(p)var B=y?p(U,F,N,d,c,m):p(F,U,N,c,d,m);if(!(B===l?F===U||f(F,U,h,p,m):B)){j=!1;break}D||(D="constructor"==N)}if(j&&!D){var H=c.constructor,z=d.constructor;H==z||!("constructor"in c)||!("constructor"in d)||"function"==typeof H&&H instanceof H&&"function"==typeof z&&z instanceof z||(j=!1)}return m.delete(c),m.delete(d),j}(c,d,h,p,f,m))}(c,d,h,p,baseIsEqual,f))}function baseIsMatch(c,d,h,p){var f=h.length,m=f,y=!p;if(null==c)return!m;for(c=Zt(c);f--;){var _=h[f];if(y&&_[2]?_[1]!==c[_[0]]:!(_[0]in c))return!1}for(;++f<m;){var b=(_=h[f])[0],w=c[b],E=_[1];if(y&&_[2]){if(w===l&&!(b in c))return!1}else{var M=new Stack;if(p)var N=p(w,E,b,c,d,M);if(!(N===l?baseIsEqual(E,w,3,p,M):N))return!1}}return!0}function baseIsNative(l){return!(!isObject2(l)||(c=l,ur&&ur in c))&&(isFunction2(l)?gr:Ot).test(toSource(l));var c}function baseIteratee(l){return"function"==typeof l?l:null==l?identity2:"object"==typeof l?na(l)?baseMatchesProperty(l[0],l[1]):baseMatches(l):property(l)}function baseKeys(l){if(!isPrototype(l))return qn(l);var c=[];for(var d in Zt(l))or.call(l,d)&&"constructor"!=d&&c.push(d);return c}function baseKeysIn(l){if(!isObject2(l))return function(l){var c=[];if(null!=l)for(var d in Zt(l))c.push(d);return c}(l);var c=isPrototype(l),d=[];for(var h in l)("constructor"!=h||!c&&or.call(l,h))&&d.push(h);return d}function baseLt(l,c){return l<c}function baseMap(l,c){var d=-1,h=isArrayLike(l)?Ft(l.length):[];return Os(l,(function(l,p,f){h[++d]=c(l,p,f)})),h}function baseMatches(l){var c=getMatchData(l);return 1==c.length&&c[0][2]?matchesStrictComparable(c[0][0],c[0][1]):function(d){return d===l||baseIsMatch(d,l,c)}}function baseMatchesProperty(c,d){return isKey2(c)&&isStrictComparable(d)?matchesStrictComparable(toKey(c),d):function(h){var p=get2(h,c);return p===l&&p===d?hasIn(h,c):baseIsEqual(d,p,3)}}function baseMerge(c,d,h,p,f){c!==d&&Ns(d,(function(m,y){if(f||(f=new Stack),isObject2(m))!function(c,d,h,p,f,m,y){var _=safeGet(c,h),b=safeGet(d,h),w=y.get(b);if(w)assignMergeValue(c,h,w);else{var E=m?m(_,b,h+"",c,d,y):l,M=E===l;if(M){var N=na(b),P=!N&&ha(b),L=!N&&!P&&Sa(b);E=b,N||P||L?na(_)?E=_:isArrayLikeObject(_)?E=copyArray(_):P?(M=!1,E=cloneBuffer(b,!0)):L?(M=!1,E=cloneTypedArray(b,!0)):E=[]:isPlainObject2(b)||ra(b)?(E=_,ra(_)?E=toPlainObject(_):isObject2(_)&&!isFunction2(_)||(E=initCloneObject(b))):M=!1}M&&(y.set(b,E),f(E,b,p,m,y),y.delete(b)),assignMergeValue(c,h,E)}}(c,d,y,h,baseMerge,p,f);else{var _=p?p(safeGet(c,y),m,y+"",c,d,f):l;_===l&&(_=m),assignMergeValue(c,y,_)}}),keysIn)}function baseNth(c,d){var h=c.length;if(h)return isIndex(d+=d<0?h:0,h)?c[d]:l}function baseOrderBy(l,c,d){c=c.length?arrayMap(c,(function(l){return na(l)?function(c){return baseGet2(c,1===l.length?l[0]:l)}:l})):[identity2];var h=-1;return c=arrayMap(c,baseUnary(getIteratee())),function(l,c){var d=l.length;for(l.sort(c);d--;)l[d]=l[d].value;return l}(baseMap(l,(function(l,d,p){return{criteria:arrayMap(c,(function(c){return c(l)})),index:++h,value:l}})),(function(l,c){return function(l,c,d){for(var h=-1,p=l.criteria,f=c.criteria,m=p.length,y=d.length;++h<m;){var _=compareAscending(p[h],f[h]);if(_)return h>=y?_:_*("desc"==d[h]?-1:1)}return l.index-c.index}(l,c,d)}))}function basePickBy(l,c,d){for(var h=-1,p=c.length,f={};++h<p;){var m=c[h],y=baseGet2(l,m);d(y,m)&&baseSet(f,castPath(m,l),y)}return f}function basePullAll(l,c,d,h){var p=h?baseIndexOfWith:baseIndexOf,f=-1,m=c.length,y=l;for(l===c&&(c=copyArray(c)),d&&(y=arrayMap(l,baseUnary(d)));++f<m;)for(var _=0,b=c[f],w=d?d(b):b;(_=p(y,w,_,h))>-1;)y!==l&&Tr.call(y,_,1),Tr.call(l,_,1);return l}function basePullAt(l,c){for(var d=l?c.length:0,h=d-1;d--;){var p=c[d];if(d==h||p!==f){var f=p;isIndex(p)?Tr.call(l,p,1):baseUnset(l,p)}}return l}function baseRandom(l,c){return l+dn(Kn()*(c-l+1))}function baseRepeat(l,c){var d="";if(!l||c<1||c>_)return d;do{c%2&&(d+=l),(c=dn(c/2))&&(l+=l)}while(c);return d}function baseRest(l,c){return xi(overRest(l,c,identity2),l+"")}function baseSample(l){return arraySample(values(l))}function baseSampleSize(l,c){var d=values(l);return shuffleSelf(d,baseClamp(c,0,d.length))}function baseSet(c,d,h,p){if(!isObject2(c))return c;for(var f=-1,m=(d=castPath(d,c)).length,y=m-1,_=c;null!=_&&++f<m;){var b=toKey(d[f]),w=h;if("__proto__"===b||"constructor"===b||"prototype"===b)return c;if(f!=y){var E=_[b];(w=p?p(E,b,_):l)===l&&(w=isObject2(E)?E:isIndex(d[f+1])?[]:{})}assignValue(_,b,w),_=_[b]}return c}var Ls=ns?function(l,c){return ns.set(l,c),l}:identity2,Ds=Yr?function(l,c){return Yr(l,"toString",{configurable:!0,enumerable:!1,value:constant(c),writable:!0})}:identity2;function baseShuffle(l){return shuffleSelf(values(l))}function baseSlice(l,c,d){var h=-1,p=l.length;c<0&&(c=-c>p?0:p+c),(d=d>p?p:d)<0&&(d+=p),p=c>d?0:d-c>>>0,c>>>=0;for(var f=Ft(p);++h<p;)f[h]=l[h+c];return f}function baseSome(l,c){var d;return Os(l,(function(l,h,p){return!(d=c(l,h,p))})),!!d}function baseSortedIndex(l,c,d){var h=0,p=null==l?h:l.length;if("number"==typeof c&&c==c&&p<=2147483647){for(;h<p;){var f=h+p>>>1,m=l[f];null!==m&&!isSymbol(m)&&(d?m<=c:m<c)?h=f+1:p=f}return p}return baseSortedIndexBy(l,c,identity2,d)}function baseSortedIndexBy(c,d,h,p){var f=0,m=null==c?0:c.length;if(0===m)return 0;for(var y=(d=h(d))!=d,_=null===d,b=isSymbol(d),w=d===l;f<m;){var E=dn((f+m)/2),M=h(c[E]),N=M!==l,P=null===M,L=M==M,j=isSymbol(M);if(y)var D=p||L;else D=w?L&&(p||N):_?L&&N&&(p||!P):b?L&&N&&!P&&(p||!j):!P&&!j&&(p?M<=d:M<d);D?f=E+1:m=E}return Vn(m,4294967294)}function baseSortedUniq(l,c){for(var d=-1,h=l.length,p=0,f=[];++d<h;){var m=l[d],y=c?c(m):m;if(!d||!eq(y,_)){var _=y;f[p++]=0===m?0:m}}return f}function baseToNumber(l){return"number"==typeof l?l:isSymbol(l)?b:+l}function baseToString(l){if("string"==typeof l)return l;if(na(l))return arrayMap(l,baseToString)+"";if(isSymbol(l))return Cs?Cs.call(l):"";var c=l+"";return"0"==c&&1/l==-1/0?"-0":c}function baseUniq(l,c,d){var h=-1,p=arrayIncludes,f=l.length,m=!0,y=[],_=y;if(d)m=!1,p=arrayIncludesWith;else if(f>=200){var b=c?null:Zs(l);if(b)return setToArray(b);m=!1,p=cacheHas,_=new SetCache}else _=c?[]:y;e:for(;++h<f;){var w=l[h],E=c?c(w):w;if(w=d||0!==w?w:0,m&&E==E){for(var M=_.length;M--;)if(_[M]===E)continue e;c&&_.push(E),y.push(w)}else p(_,E,d)||(_!==y&&_.push(E),y.push(w))}return y}function baseUnset(l,c){return null==(l=parent(l,c=castPath(c,l)))||delete l[toKey(last(c))]}function baseUpdate(l,c,d,h){return baseSet(l,c,d(baseGet2(l,c)),h)}function baseWhile(l,c,d,h){for(var p=l.length,f=h?p:-1;(h?f--:++f<p)&&c(l[f],f,l););return d?baseSlice(l,h?0:f,h?f+1:p):baseSlice(l,h?f+1:0,h?p:f)}function baseWrapperValue(l,c){var d=l;return d instanceof LazyWrapper&&(d=d.value()),arrayReduce(c,(function(l,c){return c.func.apply(c.thisArg,arrayPush([l],c.args))}),d)}function baseXor(l,c,d){var h=l.length;if(h<2)return h?baseUniq(l[0]):[];for(var p=-1,f=Ft(h);++p<h;)for(var m=l[p],y=-1;++y<h;)y!=p&&(f[p]=baseDifference(f[p]||m,l[y],c,d));return baseUniq(baseFlatten(f,1),c,d)}function baseZipObject(c,d,h){for(var p=-1,f=c.length,m=d.length,y={};++p<f;){var _=p<m?d[p]:l;h(y,c[p],_)}return y}function castArrayLikeObject(l){return isArrayLikeObject(l)?l:[]}function castFunction(l){return"function"==typeof l?l:identity2}function castPath(l,c){return na(l)?l:isKey2(l,c)?[l]:Mi(toString2(l))}var Fs=baseRest;function castSlice(c,d,h){var p=c.length;return h=h===l?p:h,!d&&h>=p?c:baseSlice(c,d,h)}var Us=rn||function(l){return sn.clearTimeout(l)};function cloneBuffer(l,c){if(c)return l.slice();var d=l.length,h=kr?kr(d):new l.constructor(d);return l.copy(h),h}function cloneArrayBuffer(l){var c=new l.constructor(l.byteLength);return new Sr(c).set(new Sr(l)),c}function cloneTypedArray(l,c){var d=c?cloneArrayBuffer(l.buffer):l.buffer;return new l.constructor(d,l.byteOffset,l.length)}function compareAscending(c,d){if(c!==d){var h=c!==l,p=null===c,f=c==c,m=isSymbol(c),y=d!==l,_=null===d,b=d==d,w=isSymbol(d);if(!_&&!w&&!m&&c>d||m&&y&&b&&!_&&!w||p&&y&&b||!h&&b||!f)return 1;if(!p&&!m&&!w&&c<d||w&&h&&f&&!p&&!m||_&&h&&f||!y&&f||!b)return-1}return 0}function composeArgs(l,c,d,h){for(var p=-1,f=l.length,m=d.length,y=-1,_=c.length,b=Wn(f-m,0),w=Ft(_+b),E=!h;++y<_;)w[y]=c[y];for(;++p<m;)(E||p<f)&&(w[d[p]]=l[p]);for(;b--;)w[y++]=l[p++];return w}function composeArgsRight(l,c,d,h){for(var p=-1,f=l.length,m=-1,y=d.length,_=-1,b=c.length,w=Wn(f-y,0),E=Ft(w+b),M=!h;++p<w;)E[p]=l[p];for(var N=p;++_<b;)E[N+_]=c[_];for(;++m<y;)(M||p<f)&&(E[N+d[m]]=l[p++]);return E}function copyArray(l,c){var d=-1,h=l.length;for(c||(c=Ft(h));++d<h;)c[d]=l[d];return c}function copyObject(c,d,h,p){var f=!h;h||(h={});for(var m=-1,y=d.length;++m<y;){var _=d[m],b=p?p(h[_],c[_],_,h,c):l;b===l&&(b=c[_]),f?baseAssignValue(h,_,b):assignValue(h,_,b)}return h}function createAggregator(l,c){return function(d,h){var p=na(d)?arrayAggregator:baseAggregator,f=c?c():{};return p(d,l,getIteratee(h,2),f)}}function createAssigner(c){return baseRest((function(d,h){var p=-1,f=h.length,m=f>1?h[f-1]:l,y=f>2?h[2]:l;for(m=c.length>3&&"function"==typeof m?(f--,m):l,y&&isIterateeCall(h[0],h[1],y)&&(m=f<3?l:m,f=1),d=Zt(d);++p<f;){var _=h[p];_&&c(d,_,p,m)}return d}))}function createBaseEach(l,c){return function(d,h){if(null==d)return d;if(!isArrayLike(d))return l(d,h);for(var p=d.length,f=c?p:-1,m=Zt(d);(c?f--:++f<p)&&!1!==h(m[f],f,m););return d}}function createBaseFor(l){return function(c,d,h){for(var p=-1,f=Zt(c),m=h(c),y=m.length;y--;){var _=m[l?y:++p];if(!1===d(f[_],_,f))break}return c}}function createCaseFirst(c){return function(d){var h=hasUnicode(d=toString2(d))?stringToArray(d):l,p=h?h[0]:d.charAt(0),f=h?castSlice(h,1).join(""):d.slice(1);return p[c]()+f}}function createCompounder(l){return function(c){return arrayReduce(words(deburr(c).replace(Ar,"")),l,"")}}function createCtor(l){return function(){var c=arguments;switch(c.length){case 0:return new l;case 1:return new l(c[0]);case 2:return new l(c[0],c[1]);case 3:return new l(c[0],c[1],c[2]);case 4:return new l(c[0],c[1],c[2],c[3]);case 5:return new l(c[0],c[1],c[2],c[3],c[4]);case 6:return new l(c[0],c[1],c[2],c[3],c[4],c[5]);case 7:return new l(c[0],c[1],c[2],c[3],c[4],c[5],c[6])}var d=Es(l.prototype),h=l.apply(d,c);return isObject2(h)?h:d}}function createFind(c){return function(d,h,p){var f=Zt(d);if(!isArrayLike(d)){var m=getIteratee(h,3);d=keys(d),h=function(l){return m(f[l],l,f)}}var y=c(d,h,p);return y>-1?f[m?d[y]:y]:l}}function createFlow(d){return flatRest((function(h){var p=h.length,f=p,m=LodashWrapper.prototype.thru;for(d&&h.reverse();f--;){var y=h[f];if("function"!=typeof y)throw new Yt(c);if(m&&!_&&"wrapper"==getFuncName(y))var _=new LodashWrapper([],!0)}for(f=_?f:p;++f<p;){var b=getFuncName(y=h[f]),w="wrapper"==b?Gs(y):l;_=w&&isLaziable(w[0])&&424==w[1]&&!w[4].length&&1==w[9]?_[getFuncName(w[0])].apply(_,w[3]):1==y.length&&isLaziable(y)?_[b]():_.thru(y)}return function(){var l=arguments,c=l[0];if(_&&1==l.length&&na(c))return _.plant(c).value();for(var d=0,f=p?h[d].apply(this,l):c;++d<p;)f=h[d].call(this,f);return f}}))}function createHybrid(c,d,h,p,m,y,_,b,w,E){var M=d&f,N=1&d,P=2&d,L=24&d,j=512&d,D=P?l:createCtor(c);return function wrapper(){for(var f=arguments.length,F=Ft(f),U=f;U--;)F[U]=arguments[U];if(L)var B=getHolder(wrapper),H=function(l,c){for(var d=l.length,h=0;d--;)l[d]===c&&++h;return h}(F,B);if(p&&(F=composeArgs(F,p,m,L)),y&&(F=composeArgsRight(F,y,_,L)),f-=H,L&&f<E){var z=replaceHolders(F,B);return createRecurry(c,d,createHybrid,wrapper.placeholder,h,F,z,b,w,E-f)}var q=N?h:this,V=P?q[c]:c;return f=F.length,b?F=function(c,d){for(var h=c.length,p=Vn(d.length,h),f=copyArray(c);p--;){var m=d[p];c[p]=isIndex(m,h)?f[m]:l}return c}(F,b):j&&f>1&&F.reverse(),M&&w<f&&(F.length=w),this&&this!==sn&&this instanceof wrapper&&(V=D||createCtor(V)),V.apply(q,F)}}function createInverter(l,c){return function(d,h){return function(l,c,d,h){return baseForOwn(l,(function(l,p,f){c(h,d(l),p,f)})),h}(d,l,c(h),{})}}function createMathOperation(c,d){return function(h,p){var f;if(h===l&&p===l)return d;if(h!==l&&(f=h),p!==l){if(f===l)return p;"string"==typeof h||"string"==typeof p?(h=baseToString(h),p=baseToString(p)):(h=baseToNumber(h),p=baseToNumber(p)),f=c(h,p)}return f}}function createOver(l){return flatRest((function(c){return c=arrayMap(c,baseUnary(getIteratee())),baseRest((function(d){var h=this;return l(c,(function(l){return apply(l,h,d)}))}))}))}function createPadding(c,d){var h=(d=d===l?" ":baseToString(d)).length;if(h<2)return h?baseRepeat(d,c):d;var p=baseRepeat(d,ln(c/stringSize(d)));return hasUnicode(d)?castSlice(stringToArray(p),0,c).join(""):p.slice(0,c)}function createRange(c){return function(d,h,p){return p&&"number"!=typeof p&&isIterateeCall(d,h,p)&&(h=p=l),d=toFinite(d),h===l?(h=d,d=0):h=toFinite(h),function(l,c,d,h){for(var p=-1,f=Wn(ln((c-l)/(d||1)),0),m=Ft(f);f--;)m[h?f:++p]=l,l+=d;return m}(d,h,p=p===l?d<h?1:-1:toFinite(p),c)}}function createRelationalOperation(l){return function(c,d){return"string"==typeof c&&"string"==typeof d||(c=toNumber2(c),d=toNumber2(d)),l(c,d)}}function createRecurry(c,d,h,f,m,y,_,b,w,E){var M=8&d;d|=M?p:64,4&(d&=~(M?64:p))||(d&=-4);var N=[c,d,m,M?y:l,M?_:l,M?l:y,M?l:_,b,w,E],P=h.apply(l,N);return isLaziable(c)&&_i(P,N),P.placeholder=f,setWrapToString(P,c,d)}function createRound(l){var c=Vt[l];return function(l,d){if(l=toNumber2(l),(d=null==d?0:Vn(toInteger(d),292))&&Hn(l)){var h=(toString2(l)+"e").split("e");return+((h=(toString2(c(h[0]+"e"+(+h[1]+d)))+"e").split("e"))[0]+"e"+(+h[1]-d))}return c(l)}}var Zs=es&&1/setToArray(new es([,-0]))[1]==y?function(l){return new es(l)}:noop4;function createToPairs(l){return function(c){var d=vi(c);return d==U?mapToArray(c):d==V?function(l){var c=-1,d=Array(l.size);return l.forEach((function(l){d[++c]=[l,l]})),d}(c):function(l,c){return arrayMap(c,(function(c){return[c,l[c]]}))}(c,l(c))}}function createWrap(d,y,_,b,w,E,M,N){var P=2&y;if(!P&&"function"!=typeof d)throw new Yt(c);var L=b?b.length:0;if(L||(y&=-97,b=w=l),M=M===l?M:Wn(toInteger(M),0),N=N===l?N:toInteger(N),L-=w?w.length:0,64&y){var j=b,D=w;b=w=l}var F=P?l:Gs(d),U=[d,y,_,b,w,j,D,E,M,N];if(F&&function(l,c){var d=l[1],p=c[1],y=d|p,_=y<131,b=p==f&&8==d||p==f&&d==m&&l[7].length<=c[8]||384==p&&c[7].length<=c[8]&&8==d;if(!_&&!b)return l;1&p&&(l[2]=c[2],y|=1&d?0:4);var w=c[3];if(w){var E=l[3];l[3]=E?composeArgs(E,w,c[4]):w,l[4]=E?replaceHolders(l[3],h):c[4]}(w=c[5])&&(E=l[5],l[5]=E?composeArgsRight(E,w,c[6]):w,l[6]=E?replaceHolders(l[5],h):c[6]),(w=c[7])&&(l[7]=w),p&f&&(l[8]=null==l[8]?c[8]:Vn(l[8],c[8])),null==l[9]&&(l[9]=c[9]),l[0]=c[0],l[1]=y}(U,F),d=U[0],y=U[1],_=U[2],b=U[3],w=U[4],!(N=U[9]=U[9]===l?P?0:d.length:Wn(U[9]-L,0))&&24&y&&(y&=-25),y&&1!=y)B=8==y||16==y?function(c,d,h){var p=createCtor(c);return function wrapper(){for(var f=arguments.length,m=Ft(f),y=f,_=getHolder(wrapper);y--;)m[y]=arguments[y];var b=f<3&&m[0]!==_&&m[f-1]!==_?[]:replaceHolders(m,_);return(f-=b.length)<h?createRecurry(c,d,createHybrid,wrapper.placeholder,l,m,b,l,l,h-f):apply(this&&this!==sn&&this instanceof wrapper?p:c,this,m)}}(d,y,N):y!=p&&33!=y||w.length?createHybrid.apply(l,U):function(l,c,d,h){var p=1&c,f=createCtor(l);return function wrapper(){for(var c=-1,m=arguments.length,y=-1,_=h.length,b=Ft(_+m),w=this&&this!==sn&&this instanceof wrapper?f:l;++y<_;)b[y]=h[y];for(;m--;)b[y++]=arguments[++c];return apply(w,p?d:this,b)}}(d,y,_,b);else var B=function(l,c,d){var h=1&c,p=createCtor(l);return function wrapper(){return(this&&this!==sn&&this instanceof wrapper?p:l).apply(h?d:this,arguments)}}(d,y,_);return setWrapToString((F?Ls:_i)(B,U),d,y)}function customDefaultsAssignIn(c,d,h,p){return c===l||eq(c,tr[h])&&!or.call(p,h)?d:c}function customDefaultsMerge(c,d,h,p,f,m){return isObject2(c)&&isObject2(d)&&(m.set(d,c),baseMerge(c,d,l,customDefaultsMerge,m),m.delete(d)),c}function customOmitClone(c){return isPlainObject2(c)?l:c}function equalArrays(c,d,h,p,f,m){var y=1&h,_=c.length,b=d.length;if(_!=b&&!(y&&b>_))return!1;var w=m.get(c),E=m.get(d);if(w&&E)return w==d&&E==c;var M=-1,N=!0,P=2&h?new SetCache:l;for(m.set(c,d),m.set(d,c);++M<_;){var L=c[M],j=d[M];if(p)var D=y?p(j,L,M,d,c,m):p(L,j,M,c,d,m);if(D!==l){if(D)continue;N=!1;break}if(P){if(!arraySome(d,(function(l,c){if(!cacheHas(P,c)&&(L===l||f(L,l,h,p,m)))return P.push(c)}))){N=!1;break}}else if(L!==j&&!f(L,j,h,p,m)){N=!1;break}}return m.delete(c),m.delete(d),N}function flatRest(c){return xi(overRest(c,l,flatten),c+"")}function getAllKeys(l){return baseGetAllKeys(l,keys,hi)}function getAllKeysIn(l){return baseGetAllKeys(l,keysIn,mi)}var Gs=ns?function(l){return ns.get(l)}:noop4;function getFuncName(l){for(var c=l.name+"",d=ss[c],h=or.call(ss,c)?d.length:0;h--;){var p=d[h],f=p.func;if(null==f||f==l)return p.name}return c}function getHolder(l){return(or.call(lodash2,"placeholder")?lodash2:l).placeholder}function getIteratee(){var l=lodash2.iteratee||iteratee;return l=l===iteratee?baseIteratee:l,arguments.length?l(arguments[0],arguments[1]):l}function getMapData(l,c){var d,h,p=l.__data__;return("string"==(h=typeof(d=c))||"number"==h||"symbol"==h||"boolean"==h?"__proto__"!==d:null===d)?p["string"==typeof c?"string":"hash"]:p.map}function getMatchData(l){for(var c=keys(l),d=c.length;d--;){var h=c[d],p=l[h];c[d]=[h,p,isStrictComparable(p)]}return c}function getNative(c,d){var h=function(c,d){return null==c?l:c[d]}(c,d);return baseIsNative(h)?h:l}var hi=hn?function(l){return null==l?[]:(l=Zt(l),arrayFilter(hn(l),(function(c){return Ir.call(l,c)})))}:stubArray,mi=hn?function(l){for(var c=[];l;)arrayPush(c,hi(l)),l=Cr(l);return c}:stubArray,vi=baseGetTag2;function hasPath(l,c,d){for(var h=-1,p=(c=castPath(c,l)).length,f=!1;++h<p;){var m=toKey(c[h]);if(!(f=null!=l&&d(l,m)))break;l=l[m]}return f||++h!=p?f:!!(p=null==l?0:l.length)&&isLength(p)&&isIndex(m,p)&&(na(l)||ra(l))}function initCloneObject(l){return"function"!=typeof l.constructor||isPrototype(l)?{}:Es(Cr(l))}function isFlattenable(l){return na(l)||ra(l)||!!(Rr&&l&&l[Rr])}function isIndex(l,c){var d=typeof l;return!!(c=null==c?_:c)&&("number"==d||"symbol"!=d&&Nt.test(l))&&l>-1&&l%1==0&&l<c}function isIterateeCall(l,c,d){if(!isObject2(d))return!1;var h=typeof c;return!!("number"==h?isArrayLike(d)&&isIndex(c,d.length):"string"==h&&c in d)&&eq(d[c],l)}function isKey2(l,c){if(na(l))return!1;var d=typeof l;return!("number"!=d&&"symbol"!=d&&"boolean"!=d&&null!=l&&!isSymbol(l))||nt.test(l)||!tt.test(l)||null!=c&&l in Zt(c)}function isLaziable(l){var c=getFuncName(l),d=lodash2[c];if("function"!=typeof d||!(c in LazyWrapper.prototype))return!1;if(l===d)return!0;var h=Gs(d);return!!h&&l===h[0]}(Yn&&vi(new Yn(new ArrayBuffer(1)))!=ne||Qn&&vi(new Qn)!=U||Xn&&vi(Xn.resolve())!=z||es&&vi(new es)!=V||ts&&vi(new ts)!=Y)&&(vi=function(c){var d=baseGetTag2(c),h=d==H?c.constructor:l,p=h?toSource(h):"";if(p)switch(p){case is:return ne;case os:return U;case as:return z;case ls:return V;case cs:return Y}return d});var yi=rr?isFunction2:stubFalse;function isPrototype(l){var c=l&&l.constructor;return l===("function"==typeof c&&c.prototype||tr)}function isStrictComparable(l){return l==l&&!isObject2(l)}function matchesStrictComparable(c,d){return function(h){return null!=h&&h[c]===d&&(d!==l||c in Zt(h))}}function overRest(c,d,h){return d=Wn(d===l?c.length-1:d,0),function(){for(var l=arguments,p=-1,f=Wn(l.length-d,0),m=Ft(f);++p<f;)m[p]=l[d+p];p=-1;for(var y=Ft(d+1);++p<d;)y[p]=l[p];return y[d]=h(m),apply(c,this,y)}}function parent(l,c){return c.length<2?l:baseGet2(l,baseSlice(c,0,-1))}function safeGet(l,c){if(("constructor"!==c||"function"!=typeof l[c])&&"__proto__"!=c)return l[c]}var _i=shortOut(Ls),wi=an||function(l,c){return sn.setTimeout(l,c)},xi=shortOut(Ds);function setWrapToString(l,c,d){var h=c+"";return xi(l,function(l,c){var d=c.length;if(!d)return l;var h=d-1;return c[h]=(d>1?"& ":"")+c[h],c=c.join(d>2?", ":" "),l.replace(_t,"{\n/* [wrapped with "+c+"] */\n")}(h,function(l,c){return arrayEach(E,(function(d){var h="_."+d[0];c&d[1]&&!arrayIncludes(l,h)&&l.push(h)})),l.sort()}(function(l){var c=l.match(bt);return c?c[1].split(wt):[]}(h),d)))}function shortOut(c){var d=0,h=0;return function(){var p=Zn(),f=16-(p-h);if(h=p,f>0){if(++d>=800)return arguments[0]}else d=0;return c.apply(l,arguments)}}function shuffleSelf(c,d){var h=-1,p=c.length,f=p-1;for(d=d===l?p:d;++h<d;){var m=baseRandom(h,f),y=c[m];c[m]=c[h],c[h]=y}return c.length=d,c}var ki,Ei,Ri,Mi=(ki=function(l){var c=[];return 46===l.charCodeAt(0)&&c.push(""),l.replace(it,(function(l,d,h,p){c.push(h?p.replace(kt,"$1"):d||l)})),c},Ei=memoize(ki,(function(l){return 500===Ri.size&&Ri.clear(),l})),Ri=Ei.cache,Ei);function toKey(l){if("string"==typeof l||isSymbol(l))return l;var c=l+"";return"0"==c&&1/l==-1/0?"-0":c}function toSource(l){if(null!=l){try{return sr.call(l)}catch(hh){}try{return l+""}catch(hh){}}return""}function wrapperClone(l){if(l instanceof LazyWrapper)return l.clone();var c=new LodashWrapper(l.__wrapped__,l.__chain__);return c.__actions__=copyArray(l.__actions__),c.__index__=l.__index__,c.__values__=l.__values__,c}var Ni=baseRest((function(l,c){return isArrayLikeObject(l)?baseDifference(l,baseFlatten(c,1,isArrayLikeObject,!0)):[]})),Pi=baseRest((function(c,d){var h=last(d);return isArrayLikeObject(h)&&(h=l),isArrayLikeObject(c)?baseDifference(c,baseFlatten(d,1,isArrayLikeObject,!0),getIteratee(h,2)):[]})),ji=baseRest((function(c,d){var h=last(d);return isArrayLikeObject(h)&&(h=l),isArrayLikeObject(c)?baseDifference(c,baseFlatten(d,1,isArrayLikeObject,!0),l,h):[]}));function findIndex2(l,c,d){var h=null==l?0:l.length;if(!h)return-1;var p=null==d?0:toInteger(d);return p<0&&(p=Wn(h+p,0)),baseFindIndex(l,getIteratee(c,3),p)}function findLastIndex(c,d,h){var p=null==c?0:c.length;if(!p)return-1;var f=p-1;return h!==l&&(f=toInteger(h),f=h<0?Wn(p+f,0):Vn(f,p-1)),baseFindIndex(c,getIteratee(d,3),f,!0)}function flatten(l){return null!=l&&l.length?baseFlatten(l,1):[]}function head2(c){return c&&c.length?c[0]:l}var Fi=baseRest((function(l){var c=arrayMap(l,castArrayLikeObject);return c.length&&c[0]===l[0]?baseIntersection(c):[]})),qi=baseRest((function(c){var d=last(c),h=arrayMap(c,castArrayLikeObject);return d===last(h)?d=l:h.pop(),h.length&&h[0]===c[0]?baseIntersection(h,getIteratee(d,2)):[]})),Vi=baseRest((function(c){var d=last(c),h=arrayMap(c,castArrayLikeObject);return(d="function"==typeof d?d:l)&&h.pop(),h.length&&h[0]===c[0]?baseIntersection(h,l,d):[]}));function last(c){var d=null==c?0:c.length;return d?c[d-1]:l}var Gi=baseRest(pullAll);function pullAll(l,c){return l&&l.length&&c&&c.length?basePullAll(l,c):l}var Ki=flatRest((function(l,c){var d=null==l?0:l.length,h=baseAt(l,c);return basePullAt(l,arrayMap(c,(function(l){return isIndex(l,d)?+l:l})).sort(compareAscending)),h}));function reverse(l){return null==l?l:Jn.call(l)}var Ji=baseRest((function(l){return baseUniq(baseFlatten(l,1,isArrayLikeObject,!0))})),Yi=baseRest((function(c){var d=last(c);return isArrayLikeObject(d)&&(d=l),baseUniq(baseFlatten(c,1,isArrayLikeObject,!0),getIteratee(d,2))})),Qi=baseRest((function(c){var d=last(c);return d="function"==typeof d?d:l,baseUniq(baseFlatten(c,1,isArrayLikeObject,!0),l,d)}));function unzip(l){if(!l||!l.length)return[];var c=0;return l=arrayFilter(l,(function(l){if(isArrayLikeObject(l))return c=Wn(l.length,c),!0})),baseTimes(c,(function(c){return arrayMap(l,baseProperty(c))}))}function unzipWith(c,d){if(!c||!c.length)return[];var h=unzip(c);return null==d?h:arrayMap(h,(function(c){return apply(d,l,c)}))}var Xi=baseRest((function(l,c){return isArrayLikeObject(l)?baseDifference(l,c):[]})),ro=baseRest((function(l){return baseXor(arrayFilter(l,isArrayLikeObject))})),oo=baseRest((function(c){var d=last(c);return isArrayLikeObject(d)&&(d=l),baseXor(arrayFilter(c,isArrayLikeObject),getIteratee(d,2))})),ao=baseRest((function(c){var d=last(c);return d="function"==typeof d?d:l,baseXor(arrayFilter(c,isArrayLikeObject),l,d)})),co=baseRest(unzip),ho=baseRest((function(c){var d=c.length,h=d>1?c[d-1]:l;return h="function"==typeof h?(c.pop(),h):l,unzipWith(c,h)}));function chain(l){var c=lodash2(l);return c.__chain__=!0,c}function thru(l,c){return c(l)}var po=flatRest((function(c){var d=c.length,h=d?c[0]:0,p=this.__wrapped__,interceptor=function(l){return baseAt(l,c)};return!(d>1||this.__actions__.length)&&p instanceof LazyWrapper&&isIndex(h)?((p=p.slice(h,+h+(d?1:0))).__actions__.push({func:thru,args:[interceptor],thisArg:l}),new LodashWrapper(p,this.__chain__).thru((function(c){return d&&!c.length&&c.push(l),c}))):this.thru(interceptor)})),fo=createAggregator((function(l,c,d){or.call(l,d)?++l[d]:baseAssignValue(l,d,1)})),mo=createFind(findIndex2),go=createFind(findLastIndex);function forEach(l,c){return(na(l)?arrayEach:Os)(l,getIteratee(c,3))}function forEachRight(l,c){return(na(l)?arrayEachRight:Ms)(l,getIteratee(c,3))}var vo=createAggregator((function(l,c,d){or.call(l,d)?l[d].push(c):baseAssignValue(l,d,[c])})),yo=baseRest((function(l,c,d){var h=-1,p="function"==typeof c,f=isArrayLike(l)?Ft(l.length):[];return Os(l,(function(l){f[++h]=p?apply(c,l,d):baseInvoke(l,c,d)})),f})),_o=createAggregator((function(l,c,d){baseAssignValue(l,d,c)}));function map(l,c){return(na(l)?arrayMap:baseMap)(l,getIteratee(c,3))}var bo=createAggregator((function(l,c,d){l[d?0:1].push(c)}),(function(){return[[],[]]})),wo=baseRest((function(l,c){if(null==l)return[];var d=c.length;return d>1&&isIterateeCall(l,c[0],c[1])?c=[]:d>2&&isIterateeCall(c[0],c[1],c[2])&&(c=[c[0]]),baseOrderBy(l,baseFlatten(c,1),[])})),So=nn||function(){return sn.Date.now()};function ary(c,d,h){return d=h?l:d,d=c&&null==d?c.length:d,createWrap(c,f,l,l,l,l,d)}function before(d,h){var p;if("function"!=typeof h)throw new Yt(c);return d=toInteger(d),function(){return--d>0&&(p=h.apply(this,arguments)),d<=1&&(h=l),p}}var jo=baseRest((function(l,c,d){var h=1;if(d.length){var f=replaceHolders(d,getHolder(jo));h|=p}return createWrap(l,h,c,d,f)})),zo=baseRest((function(l,c,d){var h=3;if(d.length){var f=replaceHolders(d,getHolder(zo));h|=p}return createWrap(c,h,l,d,f)}));function debounce2(d,h,p){var f,m,y,_,b,w,E=0,M=!1,N=!1,P=!0;if("function"!=typeof d)throw new Yt(c);function invokeFunc(c){var h=f,p=m;return f=m=l,E=c,_=d.apply(p,h)}function shouldInvoke(c){var d=c-w;return w===l||d>=h||d<0||N&&c-E>=y}function timerExpired(){var l=So();if(shouldInvoke(l))return trailingEdge(l);b=wi(timerExpired,function(l){var c=h-(l-w);return N?Vn(c,y-(l-E)):c}(l))}function trailingEdge(c){return b=l,P&&f?invokeFunc(c):(f=m=l,_)}function debounced(){var c=So(),d=shouldInvoke(c);if(f=arguments,m=this,w=c,d){if(b===l)return function(l){return E=l,b=wi(timerExpired,h),M?invokeFunc(l):_}(w);if(N)return Us(b),b=wi(timerExpired,h),invokeFunc(w)}return b===l&&(b=wi(timerExpired,h)),_}return h=toNumber2(h)||0,isObject2(p)&&(M=!!p.leading,y=(N="maxWait"in p)?Wn(toNumber2(p.maxWait)||0,h):y,P="trailing"in p?!!p.trailing:P),debounced.cancel=function(){b!==l&&Us(b),E=0,f=w=m=b=l},debounced.flush=function(){return b===l?_:trailingEdge(So())},debounced}var Go=baseRest((function(l,c){return baseDelay(l,1,c)})),Ko=baseRest((function(l,c,d){return baseDelay(l,toNumber2(c)||0,d)}));function memoize(l,d){if("function"!=typeof l||null!=d&&"function"!=typeof d)throw new Yt(c);var memoized=function(){var c=arguments,h=d?d.apply(this,c):c[0],p=memoized.cache;if(p.has(h))return p.get(h);var f=l.apply(this,c);return memoized.cache=p.set(h,f)||p,f};return memoized.cache=new(memoize.Cache||MapCache),memoized}function negate(l){if("function"!=typeof l)throw new Yt(c);return function(){var c=arguments;switch(c.length){case 0:return!l.call(this);case 1:return!l.call(this,c[0]);case 2:return!l.call(this,c[0],c[1]);case 3:return!l.call(this,c[0],c[1],c[2])}return!l.apply(this,c)}}memoize.Cache=MapCache;var Jo=Fs((function(l,c){var d=(c=1==c.length&&na(c[0])?arrayMap(c[0],baseUnary(getIteratee())):arrayMap(baseFlatten(c,1),baseUnary(getIteratee()))).length;return baseRest((function(h){for(var p=-1,f=Vn(h.length,d);++p<f;)h[p]=c[p].call(this,h[p]);return apply(l,this,h)}))})),Yo=baseRest((function(c,d){var h=replaceHolders(d,getHolder(Yo));return createWrap(c,p,l,d,h)})),Qo=baseRest((function(c,d){var h=replaceHolders(d,getHolder(Qo));return createWrap(c,64,l,d,h)})),Xo=flatRest((function(c,d){return createWrap(c,m,l,l,l,d)}));function eq(l,c){return l===c||l!=l&&c!=c}var ea=createRelationalOperation(baseGt),ta=createRelationalOperation((function(l,c){return l>=c})),ra=baseIsArguments(function(){return arguments}())?baseIsArguments:function(l){return isObjectLike2(l)&&or.call(l,"callee")&&!Ir.call(l,"callee")},na=Ft.isArray,ia=pn?baseUnary(pn):function(l){return isObjectLike2(l)&&baseGetTag2(l)==ee};function isArrayLike(l){return null!=l&&isLength(l.length)&&!isFunction2(l)}function isArrayLikeObject(l){return isObjectLike2(l)&&isArrayLike(l)}var ha=Dn||stubFalse,ma=wn?baseUnary(wn):function(l){return isObjectLike2(l)&&baseGetTag2(l)==L};function isError2(l){if(!isObjectLike2(l))return!1;var c=baseGetTag2(l);return c==j||"[object DOMException]"==c||"string"==typeof l.message&&"string"==typeof l.name&&!isPlainObject2(l)}function isFunction2(l){if(!isObject2(l))return!1;var c=baseGetTag2(l);return c==D||c==F||"[object AsyncFunction]"==c||"[object Proxy]"==c}function isInteger(l){return"number"==typeof l&&l==toInteger(l)}function isLength(l){return"number"==typeof l&&l>-1&&l%1==0&&l<=_}function isObject2(l){var c=typeof l;return null!=l&&("object"==c||"function"==c)}function isObjectLike2(l){return null!=l&&"object"==typeof l}var ya=Cn?baseUnary(Cn):function(l){return isObjectLike2(l)&&vi(l)==U};function isNumber(l){return"number"==typeof l||isObjectLike2(l)&&baseGetTag2(l)==B}function isPlainObject2(l){if(!isObjectLike2(l)||baseGetTag2(l)!=H)return!1;var c=Cr(l);if(null===c)return!0;var d=or.call(c,"constructor")&&c.constructor;return"function"==typeof d&&d instanceof d&&sr.call(d)==pr}var ba=On?baseUnary(On):function(l){return isObjectLike2(l)&&baseGetTag2(l)==q},wa=Ln?baseUnary(Ln):function(l){return isObjectLike2(l)&&vi(l)==V};function isString2(l){return"string"==typeof l||!na(l)&&isObjectLike2(l)&&baseGetTag2(l)==Z}function isSymbol(l){return"symbol"==typeof l||isObjectLike2(l)&&baseGetTag2(l)==K}var Sa=jn?baseUnary(jn):function(l){return isObjectLike2(l)&&isLength(l.length)&&!!Gr[baseGetTag2(l)]},xa=createRelationalOperation(baseLt),ka=createRelationalOperation((function(l,c){return l<=c}));function toArray2(l){if(!l)return[];if(isArrayLike(l))return isString2(l)?stringToArray(l):copyArray(l);if(Mr&&l[Mr])return function(l){for(var c,d=[];!(c=l.next()).done;)d.push(c.value);return d}(l[Mr]());var c=vi(l);return(c==U?mapToArray:c==V?setToArray:values)(l)}function toFinite(l){return l?(l=toNumber2(l))===y||l===-1/0?17976931348623157e292*(l<0?-1:1):l==l?l:0:0===l?l:0}function toInteger(l){var c=toFinite(l),d=c%1;return c==c?d?c-d:c:0}function toLength(l){return l?baseClamp(toInteger(l),0,w):0}function toNumber2(l){if("number"==typeof l)return l;if(isSymbol(l))return b;if(isObject2(l)){var c="function"==typeof l.valueOf?l.valueOf():l;l=isObject2(c)?c+"":c}if("string"!=typeof l)return 0===l?l:+l;l=baseTrim(l);var d=At.test(l);return d||Mt.test(l)?tn(l.slice(2),d?2:8):Tt.test(l)?b:+l}function toPlainObject(l){return copyObject(l,keysIn(l))}function toString2(l){return null==l?"":baseToString(l)}var Ca=createAssigner((function(l,c){if(isPrototype(c)||isArrayLike(c))copyObject(c,keys(c),l);else for(var d in c)or.call(c,d)&&assignValue(l,d,c[d])})),Ea=createAssigner((function(l,c){copyObject(c,keysIn(c),l)})),Ia=createAssigner((function(l,c,d,h){copyObject(c,keysIn(c),l,h)})),Aa=createAssigner((function(l,c,d,h){copyObject(c,keys(c),l,h)})),Oa=flatRest(baseAt),Na=baseRest((function(c,d){c=Zt(c);var h=-1,p=d.length,f=p>2?d[2]:l;for(f&&isIterateeCall(d[0],d[1],f)&&(p=1);++h<p;)for(var m=d[h],y=keysIn(m),_=-1,b=y.length;++_<b;){var w=y[_],E=c[w];(E===l||eq(E,tr[w])&&!or.call(c,w))&&(c[w]=m[w])}return c})),ja=baseRest((function(c){return c.push(l,customDefaultsMerge),apply(Ga,l,c)}));function get2(c,d,h){var p=null==c?l:baseGet2(c,d);return p===l?h:p}function hasIn(l,c){return null!=l&&hasPath(l,c,baseHasIn)}var Da=createInverter((function(l,c,d){null!=c&&"function"!=typeof c.toString&&(c=dr.call(c)),l[c]=d}),constant(identity2)),Ha=createInverter((function(l,c,d){null!=c&&"function"!=typeof c.toString&&(c=dr.call(c)),or.call(l,c)?l[c].push(d):l[c]=[d]}),getIteratee),za=baseRest(baseInvoke);function keys(l){return isArrayLike(l)?arrayLikeKeys(l):baseKeys(l)}function keysIn(l){return isArrayLike(l)?arrayLikeKeys(l,!0):baseKeysIn(l)}var Va=createAssigner((function(l,c,d){baseMerge(l,c,d)})),Ga=createAssigner((function(l,c,d,h){baseMerge(l,c,d,h)})),Ka=flatRest((function(l,c){var d={};if(null==l)return d;var h=!1;c=arrayMap(c,(function(c){return c=castPath(c,l),h||(h=c.length>1),c})),copyObject(l,getAllKeysIn(l),d),h&&(d=baseClone(d,7,customOmitClone));for(var p=c.length;p--;)baseUnset(d,c[p]);return d})),Ja=flatRest((function(l,c){return null==l?{}:function(l,c){return basePickBy(l,c,(function(c,d){return hasIn(l,d)}))}(l,c)}));function pickBy(l,c){if(null==l)return{};var d=arrayMap(getAllKeysIn(l),(function(l){return[l]}));return c=getIteratee(c),basePickBy(l,d,(function(l,d){return c(l,d[0])}))}var Ya=createToPairs(keys),Qa=createToPairs(keysIn);function values(l){return null==l?[]:baseValues(l,keys(l))}var Xa=createCompounder((function(l,c,d){return c=c.toLowerCase(),l+(d?capitalize(c):c)}));function capitalize(l){return ol(toString2(l).toLowerCase())}function deburr(l){return(l=toString2(l))&&l.replace(Pt,Fn).replace(Or,"")}var el=createCompounder((function(l,c,d){return l+(d?"-":"")+c.toLowerCase()})),tl=createCompounder((function(l,c,d){return l+(d?" ":"")+c.toLowerCase()})),rl=createCaseFirst("toLowerCase"),nl=createCompounder((function(l,c,d){return l+(d?"_":"")+c.toLowerCase()})),sl=createCompounder((function(l,c,d){return l+(d?" ":"")+ol(c)})),il=createCompounder((function(l,c,d){return l+(d?" ":"")+c.toUpperCase()})),ol=createCaseFirst("toUpperCase");function words(c,d,h){return c=toString2(c),(d=h?l:d)===l?function(l){return qr.test(l)}(c)?function(l){return l.match(jr)||[]}(c):function(l){return l.match(St)||[]}(c):c.match(d)||[]}var al=baseRest((function(c,d){try{return apply(c,l,d)}catch(hh){return isError2(hh)?hh:new Ht(hh)}})),ll=flatRest((function(l,c){return arrayEach(c,(function(c){c=toKey(c),baseAssignValue(l,c,jo(l[c],l))})),l}));function constant(l){return function(){return l}}var cl=createFlow(),ul=createFlow(!0);function identity2(l){return l}function iteratee(l){return baseIteratee("function"==typeof l?l:baseClone(l,1))}var dl=baseRest((function(l,c){return function(d){return baseInvoke(d,l,c)}})),hl=baseRest((function(l,c){return function(d){return baseInvoke(l,d,c)}}));function mixin(l,c,d){var h=keys(c),p=baseFunctions(c,h);null!=d||isObject2(c)&&(p.length||!h.length)||(d=c,c=l,l=this,p=baseFunctions(c,keys(c)));var f=!(isObject2(d)&&"chain"in d&&!d.chain),m=isFunction2(l);return arrayEach(p,(function(d){var h=c[d];l[d]=h,m&&(l.prototype[d]=function(){var c=this.__chain__;if(f||c){var d=l(this.__wrapped__);return(d.__actions__=copyArray(this.__actions__)).push({func:h,args:arguments,thisArg:l}),d.__chain__=c,d}return h.apply(l,arrayPush([this.value()],arguments))})})),l}function noop4(){}var pl=createOver(arrayMap),fl=createOver(arrayEvery),ml=createOver(arraySome);function property(l){return isKey2(l)?baseProperty(toKey(l)):function(l){return function(c){return baseGet2(c,l)}}(l)}var gl=createRange(),vl=createRange(!0);function stubArray(){return[]}function stubFalse(){return!1}var yl,_l=createMathOperation((function(l,c){return l+c}),0),bl=createRound("ceil"),wl=createMathOperation((function(l,c){return l/c}),1),Sl=createRound("floor"),xl=createMathOperation((function(l,c){return l*c}),1),kl=createRound("round"),Cl=createMathOperation((function(l,c){return l-c}),0);return lodash2.after=function(l,d){if("function"!=typeof d)throw new Yt(c);return l=toInteger(l),function(){if(--l<1)return d.apply(this,arguments)}},lodash2.ary=ary,lodash2.assign=Ca,lodash2.assignIn=Ea,lodash2.assignInWith=Ia,lodash2.assignWith=Aa,lodash2.at=Oa,lodash2.before=before,lodash2.bind=jo,lodash2.bindAll=ll,lodash2.bindKey=zo,lodash2.castArray=function(){if(!arguments.length)return[];var l=arguments[0];return na(l)?l:[l]},lodash2.chain=chain,lodash2.chunk=function(c,d,h){d=(h?isIterateeCall(c,d,h):d===l)?1:Wn(toInteger(d),0);var p=null==c?0:c.length;if(!p||d<1)return[];for(var f=0,m=0,y=Ft(ln(p/d));f<p;)y[m++]=baseSlice(c,f,f+=d);return y},lodash2.compact=function(l){for(var c=-1,d=null==l?0:l.length,h=0,p=[];++c<d;){var f=l[c];f&&(p[h++]=f)}return p},lodash2.concat=function(){var l=arguments.length;if(!l)return[];for(var c=Ft(l-1),d=arguments[0],h=l;h--;)c[h-1]=arguments[h];return arrayPush(na(d)?copyArray(d):[d],baseFlatten(c,1))},lodash2.cond=function(l){var d=null==l?0:l.length,h=getIteratee();return l=d?arrayMap(l,(function(l){if("function"!=typeof l[1])throw new Yt(c);return[h(l[0]),l[1]]})):[],baseRest((function(c){for(var h=-1;++h<d;){var p=l[h];if(apply(p[0],this,c))return apply(p[1],this,c)}}))},lodash2.conforms=function(l){return function(l){var c=keys(l);return function(d){return baseConformsTo(d,l,c)}}(baseClone(l,1))},lodash2.constant=constant,lodash2.countBy=fo,lodash2.create=function(l,c){var d=Es(l);return null==c?d:baseAssign(d,c)},lodash2.curry=function curry(c,d,h){var p=createWrap(c,8,l,l,l,l,l,d=h?l:d);return p.placeholder=curry.placeholder,p},lodash2.curryRight=function curryRight(c,d,h){var p=createWrap(c,16,l,l,l,l,l,d=h?l:d);return p.placeholder=curryRight.placeholder,p},lodash2.debounce=debounce2,lodash2.defaults=Na,lodash2.defaultsDeep=ja,lodash2.defer=Go,lodash2.delay=Ko,lodash2.difference=Ni,lodash2.differenceBy=Pi,lodash2.differenceWith=ji,lodash2.drop=function(c,d,h){var p=null==c?0:c.length;return p?baseSlice(c,(d=h||d===l?1:toInteger(d))<0?0:d,p):[]},lodash2.dropRight=function(c,d,h){var p=null==c?0:c.length;return p?baseSlice(c,0,(d=p-(d=h||d===l?1:toInteger(d)))<0?0:d):[]},lodash2.dropRightWhile=function(l,c){return l&&l.length?baseWhile(l,getIteratee(c,3),!0,!0):[]},lodash2.dropWhile=function(l,c){return l&&l.length?baseWhile(l,getIteratee(c,3),!0):[]},lodash2.fill=function(c,d,h,p){var f=null==c?0:c.length;return f?(h&&"number"!=typeof h&&isIterateeCall(c,d,h)&&(h=0,p=f),function(c,d,h,p){var f=c.length;for((h=toInteger(h))<0&&(h=-h>f?0:f+h),(p=p===l||p>f?f:toInteger(p))<0&&(p+=f),p=h>p?0:toLength(p);h<p;)c[h++]=d;return c}(c,d,h,p)):[]},lodash2.filter=function(l,c){return(na(l)?arrayFilter:baseFilter)(l,getIteratee(c,3))},lodash2.flatMap=function(l,c){return baseFlatten(map(l,c),1)},lodash2.flatMapDeep=function(l,c){return baseFlatten(map(l,c),y)},lodash2.flatMapDepth=function(c,d,h){return h=h===l?1:toInteger(h),baseFlatten(map(c,d),h)},lodash2.flatten=flatten,lodash2.flattenDeep=function(l){return null!=l&&l.length?baseFlatten(l,y):[]},lodash2.flattenDepth=function(c,d){return null!=c&&c.length?baseFlatten(c,d=d===l?1:toInteger(d)):[]},lodash2.flip=function(l){return createWrap(l,512)},lodash2.flow=cl,lodash2.flowRight=ul,lodash2.fromPairs=function(l){for(var c=-1,d=null==l?0:l.length,h={};++c<d;){var p=l[c];h[p[0]]=p[1]}return h},lodash2.functions=function(l){return null==l?[]:baseFunctions(l,keys(l))},lodash2.functionsIn=function(l){return null==l?[]:baseFunctions(l,keysIn(l))},lodash2.groupBy=vo,lodash2.initial=function(l){return null!=l&&l.length?baseSlice(l,0,-1):[]},lodash2.intersection=Fi,lodash2.intersectionBy=qi,lodash2.intersectionWith=Vi,lodash2.invert=Da,lodash2.invertBy=Ha,lodash2.invokeMap=yo,lodash2.iteratee=iteratee,lodash2.keyBy=_o,lodash2.keys=keys,lodash2.keysIn=keysIn,lodash2.map=map,lodash2.mapKeys=function(l,c){var d={};return c=getIteratee(c,3),baseForOwn(l,(function(l,h,p){baseAssignValue(d,c(l,h,p),l)})),d},lodash2.mapValues=function(l,c){var d={};return c=getIteratee(c,3),baseForOwn(l,(function(l,h,p){baseAssignValue(d,h,c(l,h,p))})),d},lodash2.matches=function(l){return baseMatches(baseClone(l,1))},lodash2.matchesProperty=function(l,c){return baseMatchesProperty(l,baseClone(c,1))},lodash2.memoize=memoize,lodash2.merge=Va,lodash2.mergeWith=Ga,lodash2.method=dl,lodash2.methodOf=hl,lodash2.mixin=mixin,lodash2.negate=negate,lodash2.nthArg=function(l){return l=toInteger(l),baseRest((function(c){return baseNth(c,l)}))},lodash2.omit=Ka,lodash2.omitBy=function(l,c){return pickBy(l,negate(getIteratee(c)))},lodash2.once=function(l){return before(2,l)},lodash2.orderBy=function(c,d,h,p){return null==c?[]:(na(d)||(d=null==d?[]:[d]),na(h=p?l:h)||(h=null==h?[]:[h]),baseOrderBy(c,d,h))},lodash2.over=pl,lodash2.overArgs=Jo,lodash2.overEvery=fl,lodash2.overSome=ml,lodash2.partial=Yo,lodash2.partialRight=Qo,lodash2.partition=bo,lodash2.pick=Ja,lodash2.pickBy=pickBy,lodash2.property=property,lodash2.propertyOf=function(c){return function(d){return null==c?l:baseGet2(c,d)}},lodash2.pull=Gi,lodash2.pullAll=pullAll,lodash2.pullAllBy=function(l,c,d){return l&&l.length&&c&&c.length?basePullAll(l,c,getIteratee(d,2)):l},lodash2.pullAllWith=function(c,d,h){return c&&c.length&&d&&d.length?basePullAll(c,d,l,h):c},lodash2.pullAt=Ki,lodash2.range=gl,lodash2.rangeRight=vl,lodash2.rearg=Xo,lodash2.reject=function(l,c){return(na(l)?arrayFilter:baseFilter)(l,negate(getIteratee(c,3)))},lodash2.remove=function(l,c){var d=[];if(!l||!l.length)return d;var h=-1,p=[],f=l.length;for(c=getIteratee(c,3);++h<f;){var m=l[h];c(m,h,l)&&(d.push(m),p.push(h))}return basePullAt(l,p),d},lodash2.rest=function(d,h){if("function"!=typeof d)throw new Yt(c);return baseRest(d,h=h===l?h:toInteger(h))},lodash2.reverse=reverse,lodash2.sampleSize=function(c,d,h){return d=(h?isIterateeCall(c,d,h):d===l)?1:toInteger(d),(na(c)?arraySampleSize:baseSampleSize)(c,d)},lodash2.set=function(l,c,d){return null==l?l:baseSet(l,c,d)},lodash2.setWith=function(c,d,h,p){return p="function"==typeof p?p:l,null==c?c:baseSet(c,d,h,p)},lodash2.shuffle=function(l){return(na(l)?arrayShuffle:baseShuffle)(l)},lodash2.slice=function(c,d,h){var p=null==c?0:c.length;return p?(h&&"number"!=typeof h&&isIterateeCall(c,d,h)?(d=0,h=p):(d=null==d?0:toInteger(d),h=h===l?p:toInteger(h)),baseSlice(c,d,h)):[]},lodash2.sortBy=wo,lodash2.sortedUniq=function(l){return l&&l.length?baseSortedUniq(l):[]},lodash2.sortedUniqBy=function(l,c){return l&&l.length?baseSortedUniq(l,getIteratee(c,2)):[]},lodash2.split=function(c,d,h){return h&&"number"!=typeof h&&isIterateeCall(c,d,h)&&(d=h=l),(h=h===l?w:h>>>0)?(c=toString2(c))&&("string"==typeof d||null!=d&&!ba(d))&&!(d=baseToString(d))&&hasUnicode(c)?castSlice(stringToArray(c),0,h):c.split(d,h):[]},lodash2.spread=function(l,d){if("function"!=typeof l)throw new Yt(c);return d=null==d?0:Wn(toInteger(d),0),baseRest((function(c){var h=c[d],p=castSlice(c,0,d);return h&&arrayPush(p,h),apply(l,this,p)}))},lodash2.tail=function(l){var c=null==l?0:l.length;return c?baseSlice(l,1,c):[]},lodash2.take=function(c,d,h){return c&&c.length?baseSlice(c,0,(d=h||d===l?1:toInteger(d))<0?0:d):[]},lodash2.takeRight=function(c,d,h){var p=null==c?0:c.length;return p?baseSlice(c,(d=p-(d=h||d===l?1:toInteger(d)))<0?0:d,p):[]},lodash2.takeRightWhile=function(l,c){return l&&l.length?baseWhile(l,getIteratee(c,3),!1,!0):[]},lodash2.takeWhile=function(l,c){return l&&l.length?baseWhile(l,getIteratee(c,3)):[]},lodash2.tap=function(l,c){return c(l),l},lodash2.throttle=function(l,d,h){var p=!0,f=!0;if("function"!=typeof l)throw new Yt(c);return isObject2(h)&&(p="leading"in h?!!h.leading:p,f="trailing"in h?!!h.trailing:f),debounce2(l,d,{leading:p,maxWait:d,trailing:f})},lodash2.thru=thru,lodash2.toArray=toArray2,lodash2.toPairs=Ya,lodash2.toPairsIn=Qa,lodash2.toPath=function(l){return na(l)?arrayMap(l,toKey):isSymbol(l)?[l]:copyArray(Mi(toString2(l)))},lodash2.toPlainObject=toPlainObject,lodash2.transform=function(l,c,d){var h=na(l),p=h||ha(l)||Sa(l);if(c=getIteratee(c,4),null==d){var f=l&&l.constructor;d=p?h?new f:[]:isObject2(l)&&isFunction2(f)?Es(Cr(l)):{}}return(p?arrayEach:baseForOwn)(l,(function(l,h,p){return c(d,l,h,p)})),d},lodash2.unary=function(l){return ary(l,1)},lodash2.union=Ji,lodash2.unionBy=Yi,lodash2.unionWith=Qi,lodash2.uniq=function(l){return l&&l.length?baseUniq(l):[]},lodash2.uniqBy=function(l,c){return l&&l.length?baseUniq(l,getIteratee(c,2)):[]},lodash2.uniqWith=function(c,d){return d="function"==typeof d?d:l,c&&c.length?baseUniq(c,l,d):[]},lodash2.unset=function(l,c){return null==l||baseUnset(l,c)},lodash2.unzip=unzip,lodash2.unzipWith=unzipWith,lodash2.update=function(l,c,d){return null==l?l:baseUpdate(l,c,castFunction(d))},lodash2.updateWith=function(c,d,h,p){return p="function"==typeof p?p:l,null==c?c:baseUpdate(c,d,castFunction(h),p)},lodash2.values=values,lodash2.valuesIn=function(l){return null==l?[]:baseValues(l,keysIn(l))},lodash2.without=Xi,lodash2.words=words,lodash2.wrap=function(l,c){return Yo(castFunction(c),l)},lodash2.xor=ro,lodash2.xorBy=oo,lodash2.xorWith=ao,lodash2.zip=co,lodash2.zipObject=function(l,c){return baseZipObject(l||[],c||[],assignValue)},lodash2.zipObjectDeep=function(l,c){return baseZipObject(l||[],c||[],baseSet)},lodash2.zipWith=ho,lodash2.entries=Ya,lodash2.entriesIn=Qa,lodash2.extend=Ea,lodash2.extendWith=Ia,mixin(lodash2,lodash2),lodash2.add=_l,lodash2.attempt=al,lodash2.camelCase=Xa,lodash2.capitalize=capitalize,lodash2.ceil=bl,lodash2.clamp=function(c,d,h){return h===l&&(h=d,d=l),h!==l&&(h=(h=toNumber2(h))==h?h:0),d!==l&&(d=(d=toNumber2(d))==d?d:0),baseClamp(toNumber2(c),d,h)},lodash2.clone=function(l){return baseClone(l,4)},lodash2.cloneDeep=function(l){return baseClone(l,5)},lodash2.cloneDeepWith=function(c,d){return baseClone(c,5,d="function"==typeof d?d:l)},lodash2.cloneWith=function(c,d){return baseClone(c,4,d="function"==typeof d?d:l)},lodash2.conformsTo=function(l,c){return null==c||baseConformsTo(l,c,keys(c))},lodash2.deburr=deburr,lodash2.defaultTo=function(l,c){return null==l||l!=l?c:l},lodash2.divide=wl,lodash2.endsWith=function(c,d,h){c=toString2(c),d=baseToString(d);var p=c.length,f=h=h===l?p:baseClamp(toInteger(h),0,p);return(h-=d.length)>=0&&c.slice(h,f)==d},lodash2.eq=eq,lodash2.escape=function(l){return(l=toString2(l))&&He.test(l)?l.replace(Ue,$n):l},lodash2.escapeRegExp=function(l){return(l=toString2(l))&&ft.test(l)?l.replace(ht,"\\$&"):l},lodash2.every=function(c,d,h){var p=na(c)?arrayEvery:baseEvery;return h&&isIterateeCall(c,d,h)&&(d=l),p(c,getIteratee(d,3))},lodash2.find=mo,lodash2.findIndex=findIndex2,lodash2.findKey=function(l,c){return baseFindKey(l,getIteratee(c,3),baseForOwn)},lodash2.findLast=go,lodash2.findLastIndex=findLastIndex,lodash2.findLastKey=function(l,c){return baseFindKey(l,getIteratee(c,3),baseForOwnRight)},lodash2.floor=Sl,lodash2.forEach=forEach,lodash2.forEachRight=forEachRight,lodash2.forIn=function(l,c){return null==l?l:Ns(l,getIteratee(c,3),keysIn)},lodash2.forInRight=function(l,c){return null==l?l:Ps(l,getIteratee(c,3),keysIn)},lodash2.forOwn=function(l,c){return l&&baseForOwn(l,getIteratee(c,3))},lodash2.forOwnRight=function(l,c){return l&&baseForOwnRight(l,getIteratee(c,3))},lodash2.get=get2,lodash2.gt=ea,lodash2.gte=ta,lodash2.has=function(l,c){return null!=l&&hasPath(l,c,baseHas)},lodash2.hasIn=hasIn,lodash2.head=head2,lodash2.identity=identity2,lodash2.includes=function(l,c,d,h){l=isArrayLike(l)?l:values(l),d=d&&!h?toInteger(d):0;var p=l.length;return d<0&&(d=Wn(p+d,0)),isString2(l)?d<=p&&l.indexOf(c,d)>-1:!!p&&baseIndexOf(l,c,d)>-1},lodash2.indexOf=function(l,c,d){var h=null==l?0:l.length;if(!h)return-1;var p=null==d?0:toInteger(d);return p<0&&(p=Wn(h+p,0)),baseIndexOf(l,c,p)},lodash2.inRange=function(c,d,h){return d=toFinite(d),h===l?(h=d,d=0):h=toFinite(h),function(l,c,d){return l>=Vn(c,d)&&l<Wn(c,d)}(c=toNumber2(c),d,h)},lodash2.invoke=za,lodash2.isArguments=ra,lodash2.isArray=na,lodash2.isArrayBuffer=ia,lodash2.isArrayLike=isArrayLike,lodash2.isArrayLikeObject=isArrayLikeObject,lodash2.isBoolean=function(l){return!0===l||!1===l||isObjectLike2(l)&&baseGetTag2(l)==P},lodash2.isBuffer=ha,lodash2.isDate=ma,lodash2.isElement=function(l){return isObjectLike2(l)&&1===l.nodeType&&!isPlainObject2(l)},lodash2.isEmpty=function(l){if(null==l)return!0;if(isArrayLike(l)&&(na(l)||"string"==typeof l||"function"==typeof l.splice||ha(l)||Sa(l)||ra(l)))return!l.length;var c=vi(l);if(c==U||c==V)return!l.size;if(isPrototype(l))return!baseKeys(l).length;for(var d in l)if(or.call(l,d))return!1;return!0},lodash2.isEqual=function(l,c){return baseIsEqual(l,c)},lodash2.isEqualWith=function(c,d,h){var p=(h="function"==typeof h?h:l)?h(c,d):l;return p===l?baseIsEqual(c,d,l,h):!!p},lodash2.isError=isError2,lodash2.isFinite=function(l){return"number"==typeof l&&Hn(l)},lodash2.isFunction=isFunction2,lodash2.isInteger=isInteger,lodash2.isLength=isLength,lodash2.isMap=ya,lodash2.isMatch=function(l,c){return l===c||baseIsMatch(l,c,getMatchData(c))},lodash2.isMatchWith=function(c,d,h){return h="function"==typeof h?h:l,baseIsMatch(c,d,getMatchData(d),h)},lodash2.isNaN=function(l){return isNumber(l)&&l!=+l},lodash2.isNative=function(l){if(yi(l))throw new Ht("Unsupported core-js use. Try https://npms.io/search?q=ponyfill.");return baseIsNative(l)},lodash2.isNil=function(l){return null==l},lodash2.isNull=function(l){return null===l},lodash2.isNumber=isNumber,lodash2.isObject=isObject2,lodash2.isObjectLike=isObjectLike2,lodash2.isPlainObject=isPlainObject2,lodash2.isRegExp=ba,lodash2.isSafeInteger=function(l){return isInteger(l)&&l>=-9007199254740991&&l<=_},lodash2.isSet=wa,lodash2.isString=isString2,lodash2.isSymbol=isSymbol,lodash2.isTypedArray=Sa,lodash2.isUndefined=function(c){return c===l},lodash2.isWeakMap=function(l){return isObjectLike2(l)&&vi(l)==Y},lodash2.isWeakSet=function(l){return isObjectLike2(l)&&"[object WeakSet]"==baseGetTag2(l)},lodash2.join=function(l,c){return null==l?"":zn.call(l,c)},lodash2.kebabCase=el,lodash2.last=last,lodash2.lastIndexOf=function(c,d,h){var p=null==c?0:c.length;if(!p)return-1;var f=p;return h!==l&&(f=(f=toInteger(h))<0?Wn(p+f,0):Vn(f,p-1)),d==d?function(l,c,d){for(var h=d+1;h--;)if(l[h]===c)return h;return h}(c,d,f):baseFindIndex(c,baseIsNaN,f,!0)},lodash2.lowerCase=tl,lodash2.lowerFirst=rl,lodash2.lt=xa,lodash2.lte=ka,lodash2.max=function(c){return c&&c.length?baseExtremum(c,identity2,baseGt):l},lodash2.maxBy=function(c,d){return c&&c.length?baseExtremum(c,getIteratee(d,2),baseGt):l},lodash2.mean=function(l){return baseMean(l,identity2)},lodash2.meanBy=function(l,c){return baseMean(l,getIteratee(c,2))},lodash2.min=function(c){return c&&c.length?baseExtremum(c,identity2,baseLt):l},lodash2.minBy=function(c,d){return c&&c.length?baseExtremum(c,getIteratee(d,2),baseLt):l},lodash2.stubArray=stubArray,lodash2.stubFalse=stubFalse,lodash2.stubObject=function(){return{}},lodash2.stubString=function(){return""},lodash2.stubTrue=function(){return!0},lodash2.multiply=xl,lodash2.nth=function(c,d){return c&&c.length?baseNth(c,toInteger(d)):l},lodash2.noConflict=function(){return sn._===this&&(sn._=fr),this},lodash2.noop=noop4,lodash2.now=So,lodash2.pad=function(l,c,d){l=toString2(l);var h=(c=toInteger(c))?stringSize(l):0;if(!c||h>=c)return l;var p=(c-h)/2;return createPadding(dn(p),d)+l+createPadding(ln(p),d)},lodash2.padEnd=function(l,c,d){l=toString2(l);var h=(c=toInteger(c))?stringSize(l):0;return c&&h<c?l+createPadding(c-h,d):l},lodash2.padStart=function(l,c,d){l=toString2(l);var h=(c=toInteger(c))?stringSize(l):0;return c&&h<c?createPadding(c-h,d)+l:l},lodash2.parseInt=function(l,c,d){return d||null==c?c=0:c&&(c=+c),Gn(toString2(l).replace(gt,""),c||0)},lodash2.random=function(c,d,h){if(h&&"boolean"!=typeof h&&isIterateeCall(c,d,h)&&(d=h=l),h===l&&("boolean"==typeof d?(h=d,d=l):"boolean"==typeof c&&(h=c,c=l)),c===l&&d===l?(c=0,d=1):(c=toFinite(c),d===l?(d=c,c=0):d=toFinite(d)),c>d){var p=c;c=d,d=p}if(h||c%1||d%1){var f=Kn();return Vn(c+f*(d-c+en("1e-"+((f+"").length-1))),d)}return baseRandom(c,d)},lodash2.reduce=function(l,c,d){var h=na(l)?arrayReduce:baseReduce,p=arguments.length<3;return h(l,getIteratee(c,4),d,p,Os)},lodash2.reduceRight=function(l,c,d){var h=na(l)?arrayReduceRight:baseReduce,p=arguments.length<3;return h(l,getIteratee(c,4),d,p,Ms)},lodash2.repeat=function(c,d,h){return d=(h?isIterateeCall(c,d,h):d===l)?1:toInteger(d),baseRepeat(toString2(c),d)},lodash2.replace=function(){var l=arguments,c=toString2(l[0]);return l.length<3?c:c.replace(l[1],l[2])},lodash2.result=function(c,d,h){var p=-1,f=(d=castPath(d,c)).length;for(f||(f=1,c=l);++p<f;){var m=null==c?l:c[toKey(d[p])];m===l&&(p=f,m=h),c=isFunction2(m)?m.call(c):m}return c},lodash2.round=kl,lodash2.runInContext=runInContext2,lodash2.sample=function(l){return(na(l)?arraySample:baseSample)(l)},lodash2.size=function(l){if(null==l)return 0;if(isArrayLike(l))return isString2(l)?stringSize(l):l.length;var c=vi(l);return c==U||c==V?l.size:baseKeys(l).length},lodash2.snakeCase=nl,lodash2.some=function(c,d,h){var p=na(c)?arraySome:baseSome;return h&&isIterateeCall(c,d,h)&&(d=l),p(c,getIteratee(d,3))},lodash2.sortedIndex=function(l,c){return baseSortedIndex(l,c)},lodash2.sortedIndexBy=function(l,c,d){return baseSortedIndexBy(l,c,getIteratee(d,2))},lodash2.sortedIndexOf=function(l,c){var d=null==l?0:l.length;if(d){var h=baseSortedIndex(l,c);if(h<d&&eq(l[h],c))return h}return-1},lodash2.sortedLastIndex=function(l,c){return baseSortedIndex(l,c,!0)},lodash2.sortedLastIndexBy=function(l,c,d){return baseSortedIndexBy(l,c,getIteratee(d,2),!0)},lodash2.sortedLastIndexOf=function(l,c){if(null!=l&&l.length){var d=baseSortedIndex(l,c,!0)-1;if(eq(l[d],c))return d}return-1},lodash2.startCase=sl,lodash2.startsWith=function(l,c,d){return l=toString2(l),d=null==d?0:baseClamp(toInteger(d),0,l.length),c=baseToString(c),l.slice(d,d+c.length)==c},lodash2.subtract=Cl,lodash2.sum=function(l){return l&&l.length?baseSum(l,identity2):0},lodash2.sumBy=function(l,c){return l&&l.length?baseSum(l,getIteratee(c,2)):0},lodash2.template=function(c,d,h){var p=lodash2.templateSettings;h&&isIterateeCall(c,d,h)&&(d=l),c=toString2(c),d=Ia({},d,p,customDefaultsAssignIn);var f,m,y=Ia({},d.imports,p.imports,customDefaultsAssignIn),_=keys(y),b=baseValues(y,_),w=0,E=d.interpolate||Lt,M="__p += '",N=Gt((d.escape||Lt).source+"|"+E.source+"|"+(E===Je?Et:Lt).source+"|"+(d.evaluate||Lt).source+"|$","g"),P="//# sourceURL="+(or.call(d,"sourceURL")?(d.sourceURL+"").replace(/\s/g," "):"lodash.templateSources["+ ++Zr+"]")+"\n";c.replace(N,(function(l,d,h,p,y,_){return h||(h=p),M+=c.slice(w,_).replace(jt,escapeStringChar),d&&(f=!0,M+="' +\n__e("+d+") +\n'"),y&&(m=!0,M+="';\n"+y+";\n__p += '"),h&&(M+="' +\n((__t = ("+h+")) == null ? '' : __t) +\n'"),w=_+l.length,l})),M+="';\n";var L=or.call(d,"variable")&&d.variable;if(L){if(xt.test(L))throw new Ht("Invalid `variable` option passed into `_.template`")}else M="with (obj) {\n"+M+"\n}\n";M=(m?M.replace(Oe,""):M).replace(Ne,"$1").replace(De,"$1;"),M="function("+(L||"obj")+") {\n"+(L?"":"obj || (obj = {});\n")+"var __t, __p = ''"+(f?", __e = _.escape":"")+(m?", __j = Array.prototype.join;\nfunction print() { __p += __j.call(arguments, '') }\n":";\n")+M+"return __p\n}";var j=al((function(){return Wt(_,P+"return "+M).apply(l,b)}));if(j.source=M,isError2(j))throw j;return j},lodash2.times=function(l,c){if((l=toInteger(l))<1||l>_)return[];var d=w,h=Vn(l,w);c=getIteratee(c),l-=w;for(var p=baseTimes(h,c);++d<l;)c(d);return p},lodash2.toFinite=toFinite,lodash2.toInteger=toInteger,lodash2.toLength=toLength,lodash2.toLower=function(l){return toString2(l).toLowerCase()},lodash2.toNumber=toNumber2,lodash2.toSafeInteger=function(l){return l?baseClamp(toInteger(l),-9007199254740991,_):0===l?l:0},lodash2.toString=toString2,lodash2.toUpper=function(l){return toString2(l).toUpperCase()},lodash2.trim=function(c,d,h){if((c=toString2(c))&&(h||d===l))return baseTrim(c);if(!c||!(d=baseToString(d)))return c;var p=stringToArray(c),f=stringToArray(d);return castSlice(p,charsStartIndex(p,f),charsEndIndex(p,f)+1).join("")},lodash2.trimEnd=function(c,d,h){if((c=toString2(c))&&(h||d===l))return c.slice(0,trimmedEndIndex(c)+1);if(!c||!(d=baseToString(d)))return c;var p=stringToArray(c);return castSlice(p,0,charsEndIndex(p,stringToArray(d))+1).join("")},lodash2.trimStart=function(c,d,h){if((c=toString2(c))&&(h||d===l))return c.replace(gt,"");if(!c||!(d=baseToString(d)))return c;var p=stringToArray(c);return castSlice(p,charsStartIndex(p,stringToArray(d))).join("")},lodash2.truncate=function(c,d){var h=30,p="...";if(isObject2(d)){var f="separator"in d?d.separator:f;h="length"in d?toInteger(d.length):h,p="omission"in d?baseToString(d.omission):p}var m=(c=toString2(c)).length;if(hasUnicode(c)){var y=stringToArray(c);m=y.length}if(h>=m)return c;var _=h-stringSize(p);if(_<1)return p;var b=y?castSlice(y,0,_).join(""):c.slice(0,_);if(f===l)return b+p;if(y&&(_+=b.length-_),ba(f)){if(c.slice(_).search(f)){var w,E=b;for(f.global||(f=Gt(f.source,toString2(It.exec(f))+"g")),f.lastIndex=0;w=f.exec(E);)var M=w.index;b=b.slice(0,M===l?_:M)}}else if(c.indexOf(baseToString(f),_)!=_){var N=b.lastIndexOf(f);N>-1&&(b=b.slice(0,N))}return b+p},lodash2.unescape=function(l){return(l=toString2(l))&&Be.test(l)?l.replace(Fe,Un):l},lodash2.uniqueId=function(l){var c=++ar;return toString2(l)+c},lodash2.upperCase=il,lodash2.upperFirst=ol,lodash2.each=forEach,lodash2.eachRight=forEachRight,lodash2.first=head2,mixin(lodash2,(yl={},baseForOwn(lodash2,(function(l,c){or.call(lodash2.prototype,c)||(yl[c]=l)})),yl),{chain:!1}),lodash2.VERSION="4.17.21",arrayEach(["bind","bindKey","curry","curryRight","partial","partialRight"],(function(l){lodash2[l].placeholder=lodash2})),arrayEach(["drop","take"],(function(c,d){LazyWrapper.prototype[c]=function(h){h=h===l?1:Wn(toInteger(h),0);var p=this.__filtered__&&!d?new LazyWrapper(this):this.clone();return p.__filtered__?p.__takeCount__=Vn(h,p.__takeCount__):p.__views__.push({size:Vn(h,w),type:c+(p.__dir__<0?"Right":"")}),p},LazyWrapper.prototype[c+"Right"]=function(l){return this.reverse()[c](l).reverse()}})),arrayEach(["filter","map","takeWhile"],(function(l,c){var d=c+1,h=1==d||3==d;LazyWrapper.prototype[l]=function(l){var c=this.clone();return c.__iteratees__.push({iteratee:getIteratee(l,3),type:d}),c.__filtered__=c.__filtered__||h,c}})),arrayEach(["head","last"],(function(l,c){var d="take"+(c?"Right":"");LazyWrapper.prototype[l]=function(){return this[d](1).value()[0]}})),arrayEach(["initial","tail"],(function(l,c){var d="drop"+(c?"":"Right");LazyWrapper.prototype[l]=function(){return this.__filtered__?new LazyWrapper(this):this[d](1)}})),LazyWrapper.prototype.compact=function(){return this.filter(identity2)},LazyWrapper.prototype.find=function(l){return this.filter(l).head()},LazyWrapper.prototype.findLast=function(l){return this.reverse().find(l)},LazyWrapper.prototype.invokeMap=baseRest((function(l,c){return"function"==typeof l?new LazyWrapper(this):this.map((function(d){return baseInvoke(d,l,c)}))})),LazyWrapper.prototype.reject=function(l){return this.filter(negate(getIteratee(l)))},LazyWrapper.prototype.slice=function(c,d){c=toInteger(c);var h=this;return h.__filtered__&&(c>0||d<0)?new LazyWrapper(h):(c<0?h=h.takeRight(-c):c&&(h=h.drop(c)),d!==l&&(h=(d=toInteger(d))<0?h.dropRight(-d):h.take(d-c)),h)},LazyWrapper.prototype.takeRightWhile=function(l){return this.reverse().takeWhile(l).reverse()},LazyWrapper.prototype.toArray=function(){return this.take(w)},baseForOwn(LazyWrapper.prototype,(function(c,d){var h=/^(?:filter|find|map|reject)|While$/.test(d),p=/^(?:head|last)$/.test(d),f=lodash2[p?"take"+("last"==d?"Right":""):d],m=p||/^find/.test(d);f&&(lodash2.prototype[d]=function(){var d=this.__wrapped__,y=p?[1]:arguments,_=d instanceof LazyWrapper,b=y[0],w=_||na(d),interceptor=function(l){var c=f.apply(lodash2,arrayPush([l],y));return p&&E?c[0]:c};w&&h&&"function"==typeof b&&1!=b.length&&(_=w=!1);var E=this.__chain__,M=!!this.__actions__.length,N=m&&!E,P=_&&!M;if(!m&&w){d=P?d:new LazyWrapper(this);var L=c.apply(d,y);return L.__actions__.push({func:thru,args:[interceptor],thisArg:l}),new LodashWrapper(L,E)}return N&&P?c.apply(this,y):(L=this.thru(interceptor),N?p?L.value()[0]:L.value():L)})})),arrayEach(["pop","push","shift","sort","splice","unshift"],(function(l){var c=Qt[l],d=/^(?:push|sort|unshift)$/.test(l)?"tap":"thru",h=/^(?:pop|shift)$/.test(l);lodash2.prototype[l]=function(){var l=arguments;if(h&&!this.__chain__){var p=this.value();return c.apply(na(p)?p:[],l)}return this[d]((function(d){return c.apply(na(d)?d:[],l)}))}})),baseForOwn(LazyWrapper.prototype,(function(l,c){var d=lodash2[c];if(d){var h=d.name+"";or.call(ss,h)||(ss[h]=[]),ss[h].push({name:c,func:d})}})),ss[createHybrid(l,2).name]=[{name:"wrapper",func:l}],LazyWrapper.prototype.clone=function(){var l=new LazyWrapper(this.__wrapped__);return l.__actions__=copyArray(this.__actions__),l.__dir__=this.__dir__,l.__filtered__=this.__filtered__,l.__iteratees__=copyArray(this.__iteratees__),l.__takeCount__=this.__takeCount__,l.__views__=copyArray(this.__views__),l},LazyWrapper.prototype.reverse=function(){if(this.__filtered__){var l=new LazyWrapper(this);l.__dir__=-1,l.__filtered__=!0}else(l=this.clone()).__dir__*=-1;return l},LazyWrapper.prototype.value=function(){var l=this.__wrapped__.value(),c=this.__dir__,d=na(l),h=c<0,p=d?l.length:0,f=function(l,c,d){for(var h=-1,p=d.length;++h<p;){var f=d[h],m=f.size;switch(f.type){case"drop":l+=m;break;case"dropRight":c-=m;break;case"take":c=Vn(c,l+m);break;case"takeRight":l=Wn(l,c-m)}}return{start:l,end:c}}(0,p,this.__views__),m=f.start,y=f.end,_=y-m,b=h?y:m-1,w=this.__iteratees__,E=w.length,M=0,N=Vn(_,this.__takeCount__);if(!d||!h&&p==_&&N==_)return baseWrapperValue(l,this.__actions__);var P=[];e:for(;_--&&M<N;){for(var L=-1,j=l[b+=c];++L<E;){var D=w[L],F=D.iteratee,U=D.type,B=F(j);if(2==U)j=B;else if(!B){if(1==U)continue e;break e}}P[M++]=j}return P},lodash2.prototype.at=po,lodash2.prototype.chain=function(){return chain(this)},lodash2.prototype.commit=function(){return new LodashWrapper(this.value(),this.__chain__)},lodash2.prototype.next=function(){this.__values__===l&&(this.__values__=toArray2(this.value()));var c=this.__index__>=this.__values__.length;return{done:c,value:c?l:this.__values__[this.__index__++]}},lodash2.prototype.plant=function(c){for(var d,h=this;h instanceof baseLodash;){var p=wrapperClone(h);p.__index__=0,p.__values__=l,d?f.__wrapped__=p:d=p;var f=p;h=h.__wrapped__}return f.__wrapped__=c,d},lodash2.prototype.reverse=function(){var c=this.__wrapped__;if(c instanceof LazyWrapper){var d=c;return this.__actions__.length&&(d=new LazyWrapper(this)),(d=d.reverse()).__actions__.push({func:thru,args:[reverse],thisArg:l}),new LodashWrapper(d,this.__chain__)}return this.thru(reverse)},lodash2.prototype.toJSON=lodash2.prototype.valueOf=lodash2.prototype.value=function(){return baseWrapperValue(this.__wrapped__,this.__actions__)},lodash2.prototype.first=lodash2.prototype.head,Mr&&(lodash2.prototype[Mr]=function(){return this}),lodash2}();ln?((ln.exports=Bn)._=Bn,an._=Bn):sn._=Bn}.call(sr);var IR=ER.exports;const TR=createListenerMiddleware(),RR=TR.startListening;let AR=null,OR=null,MR=null;let NR=0;let PR=null;const cleanupSocket=()=>{OR&&(clearTimeout(OR),OR=null),MR&&(clearTimeout(MR),MR=null),AR&&(AR.onclose=null,AR.onerror=null,AR.onmessage=null,AR.onopen=null,AR.close(),AR=null),PR=null},generateTurnId=()=>`turn_${Date.now()}_${Math.random().toString(36).substr(2,9)}`;RR({matcher:isAnyOf(vR),effect:(l,c)=>{const d=c.getState(),{sessionId:h,token:p}=l.payload;if(PR===h&&AR&&(AR.readyState===WebSocket.OPEN||AR.readyState===WebSocket.CONNECTING))return;cleanupSocket(),d.websocket.product;const f=`${IC.websocket_url}/document_to_survey_convertor/${h}/confirmit_session_data/ws`;try{if(NR<30){if(AR&&(AR.readyState===WebSocket.CONNECTING||AR.readyState===WebSocket.OPEN))return;AR=((l,c,d)=>(AR=new WebSocket(`${l}?token=${d}`),PR=c,AR))(f,h,p),MR=setTimeout((()=>{if(AR?.readyState!==WebSocket.OPEN){AR?.close(),NR++;const l=Math.min(1e3*Math.pow(2,NR),3e3);OR=setTimeout((()=>{c.dispatch(vR({sessionId:h,token:p}))}),l)}}),9e4),AR.onopen=()=>{MR&&(clearTimeout(MR),MR=null),NR=0,c.dispatch(yR()),c.dispatch(rR(!1))},AR.onmessage=l=>{try{const d=JSON.parse(l.data),h=c.getState().chat.sessionData;if("error"===d?.type){AR?.close();const l=d.message;return"Session not found"===l?(c.dispatch(wR(!0)),cleanupSocket()):void c.dispatch(nR(l))}if("diff"===d.type&&(d.iterable_item_added||d.iterable_item_removed||d.dictionary_item_added||d.dictionary_item_removed||d.values_changed||d.type_changes)){const l=((l,c)=>{if(!c||"object"!=typeof c)return l;let d=IR.cloneDeep(l??{});const splitPath=l=>l?l.replace(/^root\[/,"").split(/\]\[|\]$/).map((l=>l.replace(/['\[\]]/g,"").trim())).filter(Boolean):[],safeSetNestedValue=(l,c,d)=>{if(!c?.length||!l)return d;const h=IR.cloneDeep(l);let p=h;for(let m=0;m<c.length-1;m++){const l=c[m];if(!l)continue;const d=c[m+1],h=d&&/^\d+$/.test(d);l in p||(p[l]=h?[]:{}),p=p[l]??(h?[]:{})}const f=c[c.length-1];if(f)if(Array.isArray(p)&&/^\d+$/.test(f)){const l=parseInt(f,10);isNaN(l)||(p[l]=d)}else p[f]=d;return h},safeDeleteNestedValue=(l,c)=>{if(!c?.length||!l)return l;const d=IR.cloneDeep(l);let h=d;for(let f=0;f<c.length-1;f++){const l=c[f];if(!l||!(l in h))return d;if(h=h[l],!h)return d}const p=c[c.length-1];if(!p)return d;if(Array.isArray(h)){const l=parseInt(p,10);!isNaN(l)&&l>=0&&l<h.length&&h.splice(l,1)}else h&&"object"==typeof h&&delete h[p];return d},updateSet=(l,c,d,h)=>l&&c?(l[c]instanceof Set||(l[c]=new Set),"add"===h&&null!=d?l[c].add(d):"remove"===h&&null!=d&&l[c].delete(d),l):l;c.values_changed&&"object"==typeof c.values_changed&&Object.entries(c.values_changed).forEach((([l,c])=>{if(l&&void 0!==c?.new_value){const h=splitPath(l);d=safeSetNestedValue(d,h,c.new_value)}})),c.type_changes&&"object"==typeof c.type_changes&&Object.entries(c.type_changes).forEach((([l,c])=>{if(l&&c){const h=splitPath(l),p="NoneType"===c.new_type?null:c.new_value;d=safeSetNestedValue(d,h,p)}})),c.iterable_item_added&&"object"==typeof c.iterable_item_added&&Object.entries(c.iterable_item_added).forEach((([l,c])=>{if(!l)return;const h=splitPath(l),p=h[h.length-1];if(!p)return;const f=parseInt(p,10);if(isNaN(f))return;const m=h.slice(0,-1);let y=d;for(const d of m)d&&d in y||(y[d]=[]),y=y[d]??[];Array.isArray(y)&&(y[f]=c)})),c.iterable_item_removed&&"object"==typeof c.iterable_item_removed&&Object.entries(c.iterable_item_removed).forEach((([l])=>{if(!l)return;const c=splitPath(l),h=c[c.length-1];if(!h)return;const p=parseInt(h,10);if(isNaN(p))return;const f=c.slice(0,-1);let m=d;const y=f.length>=3&&"edit_with_revised_doc_state"===f[0]&&"plan"===f[1]&&"turns"===f[2];for(const d of f)d&&d in m||(m[d]=[]),m=m[d]??[];Array.isArray(m)&&p>=0&&p<m.length?m.splice(p,1):y&&Array.isArray(m)&&m.length>0&&m.splice(m.length-1,1)})),c.dictionary_item_added&&(Array.isArray(c.dictionary_item_added)?c.dictionary_item_added.forEach((l=>{if(l){const c=splitPath(l);d=safeSetNestedValue(d,c,{})}})):"object"==typeof c.dictionary_item_added&&Object.entries(c.dictionary_item_added).forEach((([l,c])=>{if(l){const h=splitPath(l);d=safeSetNestedValue(d,h,c)}}))),c.dictionary_item_removed&&(Array.isArray(c.dictionary_item_removed)?c.dictionary_item_removed:Object.keys(c.dictionary_item_removed)).forEach((l=>{if(l){const c=splitPath(l);d=safeDeleteNestedValue(d,c)}}));return c.set_item_added&&"object"==typeof c.set_item_added&&Object.entries(c.set_item_added).forEach((([l,c])=>{if(!l)return;const h=splitPath(l);let p=d;for(let d=0;d<h.length-1;d++){const l=h[d];l&&(p=p[l]??{})}const f=h[h.length-1];f&&(p=updateSet(p,f,c,"add"))})),c.set_item_removed&&"object"==typeof c.set_item_removed&&Object.entries(c.set_item_removed).forEach((([l,c])=>{if(!l)return;const h=splitPath(l);let p=d;for(let d=0;d<h.length-1;d++){const l=h[d];l&&(p=p[l]??{})}const f=h[h.length-1];f&&(p=updateSet(p,f,c,"remove"))})),c.attribute_added&&"object"==typeof c.attribute_added&&Object.entries(c.attribute_added).forEach((([l,c])=>{if(l){const h=splitPath(l);d=safeSetNestedValue(d,h,c)}})),c.attribute_removed&&"object"==typeof c.attribute_removed&&Object.entries(c.attribute_removed).forEach((([l])=>{if(l){const c=splitPath(l);d=safeDeleteNestedValue(d,c)}})),c.iterable_item_moved&&"object"==typeof c.iterable_item_moved&&Object.entries(c.iterable_item_moved).forEach((([l,c])=>{if(!l||!c)return;const h=splitPath(l);let p=d;for(let d=0;d<h.length-1;d++){const l=h[d];l&&(p=p[l]??[])}if(Array.isArray(p)&&"number"==typeof c.old_index&&"number"==typeof c.new_index&&c.old_index>=0&&c.old_index<p.length&&c.new_index>=0){const l=p[c.old_index];p.splice(c.old_index,1),p.splice(c.new_index,0,l)}})),c.repetition_change&&"object"==typeof c.repetition_change&&Object.entries(c.repetition_change).forEach((([l,c])=>{if(l&&void 0!==c?.new_value){const h=splitPath(l);d=safeSetNestedValue(d,h,c.new_value)}})),d})(h,d);c.dispatch(lR(l))}else"SESSION_UPDATE"===d.type?c.dispatch(lR(d.payload)):"ACCESS_LEVEL_UPDATE"===d.type||c.dispatch(lR(d));c.dispatch(wR(!1))}catch(d){console.error("Error processing WebSocket message:",d)}},AR.onclose=l=>{if(c.dispatch(_R()),NR<30){const l=Math.min(1e3*Math.pow(2,NR),3e3);NR++,OR=setTimeout((()=>{c.dispatch(vR({sessionId:h,token:p}))}),l)}},AR.onerror=l=>{console.error("WebSocket error occurred:",l),MR&&(clearTimeout(MR),MR=null),c.dispatch(bR("WebSocket connection error"))}}}catch(m){cleanupSocket(),c.dispatch(bR("Failed to connect to WebSocket"))}}}),RR({matcher:isAnyOf(_R),effect:()=>{cleanupSocket()}});const LR=function(l){const getDefaultMiddleware=function(l){const{thunk:c=!0,immutableCheck:d=!0,serializableCheck:h=!0,actionCreatorCheck:p=!0}=l??{};let f=new aT;return c&&("boolean"==typeof c?f.push(sT):f.push(iT(c.extraArgument))),f},{reducer:c,middleware:d,devTools:h=!0,preloadedState:p,enhancers:f}=l||{};let m,y;if("function"==typeof c)m=c;else{if(!isPlainObject$1(c))throw new Error(formatProdErrorMessage(1));m=combineReducers(c)}y="function"==typeof d?d(getDefaultMiddleware):getDefaultMiddleware();let _=compose;h&&(_=oT({trace:!1,..."object"==typeof h&&h}));const b=function(...l){return c=>(d,h)=>{const p=c(d,h);let dispatch=()=>{throw new Error(formatProdErrorMessage$1(15))};const f={getState:p.getState,dispatch:(l,...c)=>dispatch(l,...c)},m=l.map((l=>l(f)));return dispatch=compose(...m)(p.dispatch),{...p,dispatch:dispatch}}}(...y),w=buildGetDefaultEnhancers(b);return createStore(m,p,_(..."function"==typeof f?f(w):w()))}({reducer:{websocket:xR,chat:uR},middleware:l=>l({serializableCheck:{ignoredActions:["websocket/connecting","websocket/connected"]}}).prepend(TR.middleware).prepend(mR)}),useAppDispatch=()=>qT(),jR=WT,DocumentOverlay=({isOpen:l,onClose:c,onOpenImportFiles:d})=>{const h=jR((l=>l.chat.sessionData)),p=Gt.useMemo((()=>{const l=[...h?.document?.files??[],...h?.artefacts?.files??[],...h?.files??[]],c=new Set;return l.filter((l=>{const d=l.file_id||l.id||l.file_name||l.name;return!(!d||c.has(d))&&(c.add(d),!0)}))}),[h]),f=Gt.useMemo((()=>p.map((l=>{const c=(l=>{if("questionnaire"===(l.type||l.file_type||l.fileType||"").toLowerCase().trim())return"questionnaire";const c=(l.file_name||l.name||"").toLowerCase().split(".").pop();return["doc","docx","pdf","ppt","pptx"].includes(c)?"questionnaire":"additional"})(l);return{...l,type:l.type||l.file_type||l.fileType||"",category:c}}))),[p]),m=f.filter((l=>"questionnaire"===l.category)),y=f.filter((l=>"additional"===l.category)),mapFileToDocument=l=>{const c=l?.file_name??l?.name??"",d=c?.substring(c?.lastIndexOf(".")+1)??"";let h=l?.file_url??l?.url??"";return!h&&l?.file_s3_key&&(h=""),{id:l?.file_id??l?.id??nanoid(),name:c,type:d,fileType:l?.type,category:l?.category,size:l?.file_size?`${(l.file_size/1024/1024).toFixed(2)} MB`:"Unknown",uploadedAt:l?.created_at?new Date(l.created_at).toLocaleDateString():"Unknown",url:h,thumbnail:void 0,hasUrl:!!h}},handleDownload=async l=>{if(l.url&&l.hasUrl)try{const c=await fetch(l.url),d=await c.blob(),h=window.URL.createObjectURL(d),p=document.createElement("a");p.href=h,p.download=l.name,document.body.appendChild(p),p.click(),window.URL.revokeObjectURL(h),document.body.removeChild(p)}catch(c){console.error("Download failed:",c),vo.error("Failed to download file")}else vo.error("Download URL not available")},handleDocumentClick=async l=>{if(l.url&&l.hasUrl)try{window.open(l.url,"_blank")}catch(c){console.error("Failed to open document:",c),vo.error("Failed to open document")}else vo.error("File URL is not available.")};if(!l)return null;const _=m.length+y.length;return Kt.jsx("div",{className:"fixed inset-0 bg-black/80 backdrop-blur-sm z-50 flex items-center justify-center p-4",children:Kt.jsxs("div",{className:"relative w-full max-w-4xl bg-background rounded-lg p-4",children:[Kt.jsxs("div",{className:"flex items-center justify-between mb-4",children:[Kt.jsxs("div",{className:"flex items-center gap-2",children:[Kt.jsx(Zs,{className:"w-4 h-4 text-primary"}),Kt.jsxs("h2",{className:"font-medium",children:["Documents (",_,")"]})]}),Kt.jsxs("div",{className:"flex items-center gap-2",children:[d&&Kt.jsxs(or,{variant:"outline",size:"sm",onClick:d,className:"gap-1",children:[Kt.jsx(Ds,{className:"h-4 w-4"}),"Import Files"]}),Kt.jsx("button",{onClick:c,className:"hover:bg-accent rounded-lg p-1",children:Kt.jsx(Qi,{className:"w-4 h-4"})})]})]}),Kt.jsxs("div",{className:"overflow-y-auto max-h-[calc(100vh-200px)] space-y-6",children:[m.length>0&&Kt.jsxs("div",{children:[Kt.jsxs("h3",{className:"text-sm font-semibold mb-3 text-foreground",children:["Questionnaire (",m.length,")"]}),Kt.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-3",children:m.map((l=>{const c=mapFileToDocument(l),d=getDocumentIcon(c.type);return Kt.jsxs("button",{onClick:()=>handleDocumentClick(c),className:"group relative flex items-center gap-3 bg-muted/50 hover:bg-accent/50 rounded-lg p-2 transition-colors text-left w-full",children:[Kt.jsx("div",{className:"h-10 w-10 rounded bg-background flex items-center justify-center flex-shrink-0",children:Kt.jsx(d,{className:"w-4 h-4 text-muted-foreground"})}),Kt.jsxs("div",{className:"min-w-0 flex-1",children:[Kt.jsx("h3",{className:"text-sm truncate",children:c.name}),Kt.jsx("div",{className:"text-xs text-muted-foreground",children:c.type.toUpperCase()})]}),Kt.jsx("button",{onClick:l=>{l.stopPropagation(),handleDownload(c)},className:"p-1.5 bg-background/90 hover:bg-background rounded-lg ml-2",children:Kt.jsx(Os,{className:"w-4 h-4"})})]},c.id)}))})]}),y.length>0&&Kt.jsxs("div",{children:[Kt.jsxs("h3",{className:"text-sm font-semibold mb-3 text-foreground",children:["Additional Files (",y.length,")"]}),Kt.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-3",children:y.map((l=>{const c=mapFileToDocument(l),d=getDocumentIcon(c.type);return Kt.jsxs("button",{onClick:()=>handleDocumentClick(c),className:"group relative flex items-center gap-3 bg-muted/50 hover:bg-accent/50 rounded-lg p-2 transition-colors text-left w-full",children:[Kt.jsx("div",{className:"h-10 w-10 rounded bg-background flex items-center justify-center flex-shrink-0",children:Kt.jsx(d,{className:"w-4 h-4 text-muted-foreground"})}),Kt.jsxs("div",{className:"min-w-0 flex-1",children:[Kt.jsx("h3",{className:"text-sm truncate",children:c.name}),Kt.jsx("div",{className:"text-xs text-muted-foreground",children:c.type.toUpperCase()})]}),Kt.jsx("button",{onClick:l=>{l.stopPropagation(),handleDownload(c)},className:"p-1.5 bg-background/90 hover:bg-background rounded-lg ml-2",children:Kt.jsx(Os,{className:"w-4 h-4"})})]},c.id)}))})]}),0===_&&Kt.jsxs("div",{className:"flex flex-col items-center justify-center py-12 text-muted-foreground border-2 border-dashed rounded-xl bg-muted/5",children:[Kt.jsx(Zs,{className:"h-12 w-12 mb-3 opacity-20"}),Kt.jsx("p",{className:"text-sm font-medium",children:"No documents uploaded yet"}),Kt.jsx("p",{className:"text-xs opacity-60",children:"Upload files to see them here"})]})]})]})})};var DR={exports:{}},FR={},$R=Gt;var UR="function"==typeof Object.is?Object.is:function(l,c){return l===c&&(0!==l||1/l==1/c)||l!=l&&c!=c},BR=$R.useState,HR=$R.useEffect,zR=$R.useLayoutEffect,qR=$R.useDebugValue;function checkIfSnapshotChanged(l){var c=l.getSnapshot;l=l.value;try{var d=c();return!UR(l,d)}catch(h){return!0}}var WR="undefined"==typeof window||void 0===window.document||void 0===window.document.createElement?function(l,c){return c()}:function(l,c){var d=c(),h=BR({inst:{value:d,getSnapshot:c}}),p=h[0].inst,f=h[1];return zR((function(){p.value=d,p.getSnapshot=c,checkIfSnapshotChanged(p)&&f({inst:p})}),[l,d,c]),HR((function(){return checkIfSnapshotChanged(p)&&f({inst:p}),l((function(){checkIfSnapshotChanged(p)&&f({inst:p})}))}),[l]),qR(d),d};FR.useSyncExternalStore=void 0!==$R.useSyncExternalStore?$R.useSyncExternalStore:WR,DR.exports=FR;var VR=DR.exports;function subscribe(){return()=>{}}var ZR="Avatar",[GR,KR]=createContextScope(ZR),[JR,YR]=GR(ZR),QR=Gt.forwardRef(((l,c)=>{const{__scopeAvatar:d,...h}=l,[p,f]=Gt.useState("idle");return Kt.jsx(JR,{scope:d,imageLoadingStatus:p,onImageLoadingStatusChange:f,children:Kt.jsx(AC.span,{...h,ref:c})})}));QR.displayName=ZR;var XR="AvatarImage",eA=Gt.forwardRef(((l,c)=>{const{__scopeAvatar:d,src:h,onLoadingStatusChange:p=()=>{},...f}=l,m=YR(XR,d),y=function(l,{referrerPolicy:c,crossOrigin:d}){const h=VR.useSyncExternalStore(subscribe,(()=>!0),(()=>!1)),p=Gt.useRef(null),f=h?(p.current||(p.current=new window.Image),p.current):null,[m,y]=Gt.useState((()=>resolveLoadingStatus(f,l)));return LC((()=>{y(resolveLoadingStatus(f,l))}),[f,l]),LC((()=>{const updateStatus=l=>()=>{y(l)};if(!f)return;const l=updateStatus("loaded"),h=updateStatus("error");return f.addEventListener("load",l),f.addEventListener("error",h),c&&(f.referrerPolicy=c),"string"==typeof d&&(f.crossOrigin=d),()=>{f.removeEventListener("load",l),f.removeEventListener("error",h)}}),[f,d,c]),m}(h,f),_=useCallbackRef((l=>{p(l),m.onImageLoadingStatusChange(l)}));return LC((()=>{"idle"!==y&&_(y)}),[y,_]),"loaded"===y?Kt.jsx(AC.img,{...f,ref:c,src:h}):null}));eA.displayName=XR;var tA="AvatarFallback",rA=Gt.forwardRef(((l,c)=>{const{__scopeAvatar:d,delayMs:h,...p}=l,f=YR(tA,d),[m,y]=Gt.useState(void 0===h);return Gt.useEffect((()=>{if(void 0!==h){const l=window.setTimeout((()=>y(!0)),h);return()=>window.clearTimeout(l)}}),[h]),m&&"loaded"!==f.imageLoadingStatus?Kt.jsx(AC.span,{...p,ref:c}):null}));function resolveLoadingStatus(l,c){return l?c?(l.src!==c&&(l.src=c),l.complete&&l.naturalWidth>0?"loaded":"loading"):"error":"idle"}rA.displayName=tA;var nA=QR,sA=eA,iA=rA;const oA=Gt.forwardRef((({className:l,...c},d)=>Kt.jsx(nA,{ref:d,className:tr("relative flex h-10 w-10 shrink-0 overflow-hidden rounded-full",l),...c})));oA.displayName=nA.displayName;const aA=Gt.forwardRef((({className:l,...c},d)=>Kt.jsx(sA,{ref:d,className:tr("aspect-square h-full w-full",l),...c})));aA.displayName=sA.displayName;const lA=Gt.forwardRef((({className:l,...c},d)=>Kt.jsx(iA,{ref:d,className:tr("flex h-full w-full items-center justify-center rounded-full bg-muted",l),...c})));lA.displayName=iA.displayName;const cA=Gt.memo((function({children:l,id:c,className:d,editable:h=!1,onChange:p,placeholder:f="Enter text..."}){return h&&p?Kt.jsx("textarea",{id:c,value:l,onChange:l=>p(l.target.value),placeholder:f,className:tr("w-full min-h-[100px] p-3 border border-gray-300 rounded-md","focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent","resize-vertical font-mono text-sm","placeholder:text-gray-400",d)}):Kt.jsx("div",{id:c,className:tr("whitespace-pre-wrap break-words text-sm",d),children:l})}));cA.displayName="Markdown";var uA,dA="dismissableLayer.update",hA="dismissableLayer.pointerDownOutside",pA="dismissableLayer.focusOutside",fA=Gt.createContext({layers:new Set,layersWithOutsidePointerEventsDisabled:new Set,branches:new Set}),mA=Gt.forwardRef(((l,c)=>{const{disableOutsidePointerEvents:d=!1,onEscapeKeyDown:h,onPointerDownOutside:p,onFocusOutside:f,onInteractOutside:m,onDismiss:y,..._}=l,b=Gt.useContext(fA),[w,E]=Gt.useState(null),M=w?.ownerDocument??globalThis?.document,[,N]=Gt.useState({}),P=pr(c,(l=>E(l))),L=Array.from(b.layers),[j]=[...b.layersWithOutsidePointerEventsDisabled].slice(-1),D=L.indexOf(j),F=w?L.indexOf(w):-1,U=b.layersWithOutsidePointerEventsDisabled.size>0,B=F>=D,H=function(l,c=globalThis?.document){const d=useCallbackRef(l),h=Gt.useRef(!1),p=Gt.useRef((()=>{}));return Gt.useEffect((()=>{const handlePointerDown=l=>{if(l.target&&!h.current){let handleAndDispatchPointerDownOutsideEvent2=function(){handleAndDispatchCustomEvent(hA,d,h,{discrete:!0})};const h={originalEvent:l};"touch"===l.pointerType?(c.removeEventListener("click",p.current),p.current=handleAndDispatchPointerDownOutsideEvent2,c.addEventListener("click",p.current,{once:!0})):handleAndDispatchPointerDownOutsideEvent2()}else c.removeEventListener("click",p.current);h.current=!1},l=window.setTimeout((()=>{c.addEventListener("pointerdown",handlePointerDown)}),0);return()=>{window.clearTimeout(l),c.removeEventListener("pointerdown",handlePointerDown),c.removeEventListener("click",p.current)}}),[c,d]),{onPointerDownCapture:()=>h.current=!0}}((l=>{const c=l.target,d=[...b.branches].some((l=>l.contains(c)));B&&!d&&(p?.(l),m?.(l),l.defaultPrevented||y?.())}),M),z=function(l,c=globalThis?.document){const d=useCallbackRef(l),h=Gt.useRef(!1);return Gt.useEffect((()=>{const handleFocus=l=>{if(l.target&&!h.current){handleAndDispatchCustomEvent(pA,d,{originalEvent:l},{discrete:!1})}};return c.addEventListener("focusin",handleFocus),()=>c.removeEventListener("focusin",handleFocus)}),[c,d]),{onFocusCapture:()=>h.current=!0,onBlurCapture:()=>h.current=!1}}((l=>{const c=l.target;[...b.branches].some((l=>l.contains(c)))||(f?.(l),m?.(l),l.defaultPrevented||y?.())}),M);return function(l,c=globalThis?.document){const d=useCallbackRef(l);Gt.useEffect((()=>{const handleKeyDown=l=>{"Escape"===l.key&&d(l)};return c.addEventListener("keydown",handleKeyDown,{capture:!0}),()=>c.removeEventListener("keydown",handleKeyDown,{capture:!0})}),[d,c])}((l=>{F===b.layers.size-1&&(h?.(l),!l.defaultPrevented&&y&&(l.preventDefault(),y()))}),M),Gt.useEffect((()=>{if(w)return d&&(0===b.layersWithOutsidePointerEventsDisabled.size&&(uA=M.body.style.pointerEvents,M.body.style.pointerEvents="none"),b.layersWithOutsidePointerEventsDisabled.add(w)),b.layers.add(w),dispatchUpdate(),()=>{d&&1===b.layersWithOutsidePointerEventsDisabled.size&&(M.body.style.pointerEvents=uA)}}),[w,M,d,b]),Gt.useEffect((()=>()=>{w&&(b.layers.delete(w),b.layersWithOutsidePointerEventsDisabled.delete(w),dispatchUpdate())}),[w,b]),Gt.useEffect((()=>{const handleUpdate=()=>N({});return document.addEventListener(dA,handleUpdate),()=>document.removeEventListener(dA,handleUpdate)}),[]),Kt.jsx(AC.div,{..._,ref:P,style:{pointerEvents:U?B?"auto":"none":void 0,...l.style},onFocusCapture:composeEventHandlers(l.onFocusCapture,z.onFocusCapture),onBlurCapture:composeEventHandlers(l.onBlurCapture,z.onBlurCapture),onPointerDownCapture:composeEventHandlers(l.onPointerDownCapture,H.onPointerDownCapture)})}));mA.displayName="DismissableLayer";function dispatchUpdate(){const l=new CustomEvent(dA);document.dispatchEvent(l)}function handleAndDispatchCustomEvent(l,c,d,{discrete:h}){const p=d.originalEvent.target,f=new CustomEvent(l,{bubbles:!1,cancelable:!0,detail:d});c&&p.addEventListener(l,c,{once:!0}),h?function(l,c){l&&ur.flushSync((()=>l.dispatchEvent(c)))}(p,f):p.dispatchEvent(f)}Gt.forwardRef(((l,c)=>{const d=Gt.useContext(fA),h=Gt.useRef(null),p=pr(c,h);return Gt.useEffect((()=>{const l=h.current;if(l)return d.branches.add(l),()=>{d.branches.delete(l)}}),[d.branches]),Kt.jsx(AC.div,{...l,ref:p})})).displayName="DismissableLayerBranch";const gA=["top","right","bottom","left"],vA=Math.min,yA=Math.max,_A=Math.round,bA=Math.floor,createCoords=l=>({x:l,y:l}),wA={left:"right",right:"left",bottom:"top",top:"bottom"},SA={start:"end",end:"start"};function clamp(l,c,d){return yA(l,vA(c,d))}function evaluate(l,c){return"function"==typeof l?l(c):l}function getSide(l){return l.split("-")[0]}function getAlignment(l){return l.split("-")[1]}function getOppositeAxis(l){return"x"===l?"y":"x"}function getAxisLength(l){return"y"===l?"height":"width"}function getSideAxis(l){return["top","bottom"].includes(getSide(l))?"y":"x"}function getAlignmentAxis(l){return getOppositeAxis(getSideAxis(l))}function getOppositeAlignmentPlacement(l){return l.replace(/start|end/g,(l=>SA[l]))}function getOppositePlacement(l){return l.replace(/left|right|bottom|top/g,(l=>wA[l]))}function getPaddingObject(l){return"number"!=typeof l?function(l){return{top:0,right:0,bottom:0,left:0,...l}}(l):{top:l,right:l,bottom:l,left:l}}function rectToClientRect(l){const{x:c,y:d,width:h,height:p}=l;return{width:h,height:p,top:d,left:c,right:c+h,bottom:d+p,x:c,y:d}}function computeCoordsFromPlacement(l,c,d){let{reference:h,floating:p}=l;const f=getSideAxis(c),m=getAlignmentAxis(c),y=getAxisLength(m),_=getSide(c),b="y"===f,w=h.x+h.width/2-p.width/2,E=h.y+h.height/2-p.height/2,M=h[y]/2-p[y]/2;let N;switch(_){case"top":N={x:w,y:h.y-p.height};break;case"bottom":N={x:w,y:h.y+h.height};break;case"right":N={x:h.x+h.width,y:E};break;case"left":N={x:h.x-p.width,y:E};break;default:N={x:h.x,y:h.y}}switch(getAlignment(c)){case"start":N[m]-=M*(d&&b?-1:1);break;case"end":N[m]+=M*(d&&b?-1:1)}return N}async function detectOverflow(l,c){var d;void 0===c&&(c={});const{x:h,y:p,platform:f,rects:m,elements:y,strategy:_}=l,{boundary:b="clippingAncestors",rootBoundary:w="viewport",elementContext:E="floating",altBoundary:M=!1,padding:N=0}=evaluate(c,l),P=getPaddingObject(N),L=y[M?"floating"===E?"reference":"floating":E],j=rectToClientRect(await f.getClippingRect({element:null==(d=await(null==f.isElement?void 0:f.isElement(L)))||d?L:L.contextElement||await(null==f.getDocumentElement?void 0:f.getDocumentElement(y.floating)),boundary:b,rootBoundary:w,strategy:_})),D="floating"===E?{x:h,y:p,width:m.floating.width,height:m.floating.height}:m.reference,F=await(null==f.getOffsetParent?void 0:f.getOffsetParent(y.floating)),U=await(null==f.isElement?void 0:f.isElement(F))&&await(null==f.getScale?void 0:f.getScale(F))||{x:1,y:1},B=rectToClientRect(f.convertOffsetParentRelativeRectToViewportRelativeRect?await f.convertOffsetParentRelativeRectToViewportRelativeRect({elements:y,rect:D,offsetParent:F,strategy:_}):D);return{top:(j.top-B.top+P.top)/U.y,bottom:(B.bottom-j.bottom+P.bottom)/U.y,left:(j.left-B.left+P.left)/U.x,right:(B.right-j.right+P.right)/U.x}}function getSideOffsets(l,c){return{top:l.top-c.height,right:l.right-c.width,bottom:l.bottom-c.height,left:l.left-c.width}}function isAnySideFullyClipped(l){return gA.some((c=>l[c]>=0))}function hasWindow(){return"undefined"!=typeof window}function getNodeName(l){return isNode(l)?(l.nodeName||"").toLowerCase():"#document"}function getWindow(l){var c;return(null==l||null==(c=l.ownerDocument)?void 0:c.defaultView)||window}function getDocumentElement(l){var c;return null==(c=(isNode(l)?l.ownerDocument:l.document)||window.document)?void 0:c.documentElement}function isNode(l){return!!hasWindow()&&(l instanceof Node||l instanceof getWindow(l).Node)}function isElement(l){return!!hasWindow()&&(l instanceof Element||l instanceof getWindow(l).Element)}function isHTMLElement(l){return!!hasWindow()&&(l instanceof HTMLElement||l instanceof getWindow(l).HTMLElement)}function isShadowRoot(l){return!(!hasWindow()||"undefined"==typeof ShadowRoot)&&(l instanceof ShadowRoot||l instanceof getWindow(l).ShadowRoot)}function isOverflowElement(l){const{overflow:c,overflowX:d,overflowY:h,display:p}=getComputedStyle$1(l);return/auto|scroll|overlay|hidden|clip/.test(c+h+d)&&!["inline","contents"].includes(p)}function isTableElement(l){return["table","td","th"].includes(getNodeName(l))}function isTopLayer(l){return[":popover-open",":modal"].some((c=>{try{return l.matches(c)}catch(hh){return!1}}))}function isContainingBlock(l){const c=isWebKit(),d=isElement(l)?getComputedStyle$1(l):l;return["transform","translate","scale","rotate","perspective"].some((l=>!!d[l]&&"none"!==d[l]))||!!d.containerType&&"normal"!==d.containerType||!c&&!!d.backdropFilter&&"none"!==d.backdropFilter||!c&&!!d.filter&&"none"!==d.filter||["transform","translate","scale","rotate","perspective","filter"].some((l=>(d.willChange||"").includes(l)))||["paint","layout","strict","content"].some((l=>(d.contain||"").includes(l)))}function isWebKit(){return!("undefined"==typeof CSS||!CSS.supports)&&CSS.supports("-webkit-backdrop-filter","none")}function isLastTraversableNode(l){return["html","body","#document"].includes(getNodeName(l))}function getComputedStyle$1(l){return getWindow(l).getComputedStyle(l)}function getNodeScroll(l){return isElement(l)?{scrollLeft:l.scrollLeft,scrollTop:l.scrollTop}:{scrollLeft:l.scrollX,scrollTop:l.scrollY}}function getParentNode(l){if("html"===getNodeName(l))return l;const c=l.assignedSlot||l.parentNode||isShadowRoot(l)&&l.host||getDocumentElement(l);return isShadowRoot(c)?c.host:c}function getNearestOverflowAncestor(l){const c=getParentNode(l);return isLastTraversableNode(c)?l.ownerDocument?l.ownerDocument.body:l.body:isHTMLElement(c)&&isOverflowElement(c)?c:getNearestOverflowAncestor(c)}function getOverflowAncestors(l,c,d){var h;void 0===c&&(c=[]),void 0===d&&(d=!0);const p=getNearestOverflowAncestor(l),f=p===(null==(h=l.ownerDocument)?void 0:h.body),m=getWindow(p);if(f){const l=getFrameElement(m);return c.concat(m,m.visualViewport||[],isOverflowElement(p)?p:[],l&&d?getOverflowAncestors(l):[])}return c.concat(p,getOverflowAncestors(p,[],d))}function getFrameElement(l){return l.parent&&Object.getPrototypeOf(l.parent)?l.frameElement:null}function getCssDimensions(l){const c=getComputedStyle$1(l);let d=parseFloat(c.width)||0,h=parseFloat(c.height)||0;const p=isHTMLElement(l),f=p?l.offsetWidth:d,m=p?l.offsetHeight:h,y=_A(d)!==f||_A(h)!==m;return y&&(d=f,h=m),{width:d,height:h,$:y}}function unwrapElement(l){return isElement(l)?l:l.contextElement}function getScale(l){const c=unwrapElement(l);if(!isHTMLElement(c))return createCoords(1);const d=c.getBoundingClientRect(),{width:h,height:p,$:f}=getCssDimensions(c);let m=(f?_A(d.width):d.width)/h,y=(f?_A(d.height):d.height)/p;return m&&Number.isFinite(m)||(m=1),y&&Number.isFinite(y)||(y=1),{x:m,y:y}}const xA=createCoords(0);function getVisualOffsets(l){const c=getWindow(l);return isWebKit()&&c.visualViewport?{x:c.visualViewport.offsetLeft,y:c.visualViewport.offsetTop}:xA}function getBoundingClientRect(l,c,d,h){void 0===c&&(c=!1),void 0===d&&(d=!1);const p=l.getBoundingClientRect(),f=unwrapElement(l);let m=createCoords(1);c&&(h?isElement(h)&&(m=getScale(h)):m=getScale(l));const y=function(l,c,d){return void 0===c&&(c=!1),!(!d||c&&d!==getWindow(l))&&c}(f,d,h)?getVisualOffsets(f):createCoords(0);let _=(p.left+y.x)/m.x,b=(p.top+y.y)/m.y,w=p.width/m.x,E=p.height/m.y;if(f){const l=getWindow(f),c=h&&isElement(h)?getWindow(h):h;let d=l,p=getFrameElement(d);for(;p&&h&&c!==d;){const l=getScale(p),c=p.getBoundingClientRect(),h=getComputedStyle$1(p),f=c.left+(p.clientLeft+parseFloat(h.paddingLeft))*l.x,m=c.top+(p.clientTop+parseFloat(h.paddingTop))*l.y;_*=l.x,b*=l.y,w*=l.x,E*=l.y,_+=f,b+=m,d=getWindow(p),p=getFrameElement(d)}}return rectToClientRect({width:w,height:E,x:_,y:b})}function getWindowScrollBarX(l,c){const d=getNodeScroll(l).scrollLeft;return c?c.left+d:getBoundingClientRect(getDocumentElement(l)).left+d}function getHTMLOffset(l,c,d){void 0===d&&(d=!1);const h=l.getBoundingClientRect();return{x:h.left+c.scrollLeft-(d?0:getWindowScrollBarX(l,h)),y:h.top+c.scrollTop}}function getClientRectFromClippingAncestor(l,c,d){let h;if("viewport"===c)h=function(l,c){const d=getWindow(l),h=getDocumentElement(l),p=d.visualViewport;let f=h.clientWidth,m=h.clientHeight,y=0,_=0;if(p){f=p.width,m=p.height;const l=isWebKit();(!l||l&&"fixed"===c)&&(y=p.offsetLeft,_=p.offsetTop)}return{width:f,height:m,x:y,y:_}}(l,d);else if("document"===c)h=function(l){const c=getDocumentElement(l),d=getNodeScroll(l),h=l.ownerDocument.body,p=yA(c.scrollWidth,c.clientWidth,h.scrollWidth,h.clientWidth),f=yA(c.scrollHeight,c.clientHeight,h.scrollHeight,h.clientHeight);let m=-d.scrollLeft+getWindowScrollBarX(l);const y=-d.scrollTop;return"rtl"===getComputedStyle$1(h).direction&&(m+=yA(c.clientWidth,h.clientWidth)-p),{width:p,height:f,x:m,y:y}}(getDocumentElement(l));else if(isElement(c))h=function(l,c){const d=getBoundingClientRect(l,!0,"fixed"===c),h=d.top+l.clientTop,p=d.left+l.clientLeft,f=isHTMLElement(l)?getScale(l):createCoords(1);return{width:l.clientWidth*f.x,height:l.clientHeight*f.y,x:p*f.x,y:h*f.y}}(c,d);else{const d=getVisualOffsets(l);h={x:c.x-d.x,y:c.y-d.y,width:c.width,height:c.height}}return rectToClientRect(h)}function hasFixedPositionAncestor(l,c){const d=getParentNode(l);return!(d===c||!isElement(d)||isLastTraversableNode(d))&&("fixed"===getComputedStyle$1(d).position||hasFixedPositionAncestor(d,c))}function getRectRelativeToOffsetParent(l,c,d){const h=isHTMLElement(c),p=getDocumentElement(c),f="fixed"===d,m=getBoundingClientRect(l,!0,f,c);let y={scrollLeft:0,scrollTop:0};const _=createCoords(0);function setLeftRTLScrollbarOffset(){_.x=getWindowScrollBarX(p)}if(h||!h&&!f)if(("body"!==getNodeName(c)||isOverflowElement(p))&&(y=getNodeScroll(c)),h){const l=getBoundingClientRect(c,!0,f,c);_.x=l.x+c.clientLeft,_.y=l.y+c.clientTop}else p&&setLeftRTLScrollbarOffset();f&&!h&&p&&setLeftRTLScrollbarOffset();const b=!p||h||f?createCoords(0):getHTMLOffset(p,y);return{x:m.left+y.scrollLeft-_.x-b.x,y:m.top+y.scrollTop-_.y-b.y,width:m.width,height:m.height}}function isStaticPositioned(l){return"static"===getComputedStyle$1(l).position}function getTrueOffsetParent(l,c){if(!isHTMLElement(l)||"fixed"===getComputedStyle$1(l).position)return null;if(c)return c(l);let d=l.offsetParent;return getDocumentElement(l)===d&&(d=d.ownerDocument.body),d}function getOffsetParent(l,c){const d=getWindow(l);if(isTopLayer(l))return d;if(!isHTMLElement(l)){let c=getParentNode(l);for(;c&&!isLastTraversableNode(c);){if(isElement(c)&&!isStaticPositioned(c))return c;c=getParentNode(c)}return d}let h=getTrueOffsetParent(l,c);for(;h&&isTableElement(h)&&isStaticPositioned(h);)h=getTrueOffsetParent(h,c);return h&&isLastTraversableNode(h)&&isStaticPositioned(h)&&!isContainingBlock(h)?d:h||function(l){let c=getParentNode(l);for(;isHTMLElement(c)&&!isLastTraversableNode(c);){if(isContainingBlock(c))return c;if(isTopLayer(c))return null;c=getParentNode(c)}return null}(l)||d}const kA={convertOffsetParentRelativeRectToViewportRelativeRect:function(l){let{elements:c,rect:d,offsetParent:h,strategy:p}=l;const f="fixed"===p,m=getDocumentElement(h),y=!!c&&isTopLayer(c.floating);if(h===m||y&&f)return d;let _={scrollLeft:0,scrollTop:0},b=createCoords(1);const w=createCoords(0),E=isHTMLElement(h);if((E||!E&&!f)&&(("body"!==getNodeName(h)||isOverflowElement(m))&&(_=getNodeScroll(h)),isHTMLElement(h))){const l=getBoundingClientRect(h);b=getScale(h),w.x=l.x+h.clientLeft,w.y=l.y+h.clientTop}const M=!m||E||f?createCoords(0):getHTMLOffset(m,_,!0);return{width:d.width*b.x,height:d.height*b.y,x:d.x*b.x-_.scrollLeft*b.x+w.x+M.x,y:d.y*b.y-_.scrollTop*b.y+w.y+M.y}},getDocumentElement:getDocumentElement,getClippingRect:function(l){let{element:c,boundary:d,rootBoundary:h,strategy:p}=l;const f=[..."clippingAncestors"===d?isTopLayer(c)?[]:function(l,c){const d=c.get(l);if(d)return d;let h=getOverflowAncestors(l,[],!1).filter((l=>isElement(l)&&"body"!==getNodeName(l))),p=null;const f="fixed"===getComputedStyle$1(l).position;let m=f?getParentNode(l):l;for(;isElement(m)&&!isLastTraversableNode(m);){const c=getComputedStyle$1(m),d=isContainingBlock(m);d||"fixed"!==c.position||(p=null),(f?!d&&!p:!d&&"static"===c.position&&p&&["absolute","fixed"].includes(p.position)||isOverflowElement(m)&&!d&&hasFixedPositionAncestor(l,m))?h=h.filter((l=>l!==m)):p=c,m=getParentNode(m)}return c.set(l,h),h}(c,this._c):[].concat(d),h],m=f[0],y=f.reduce(((l,d)=>{const h=getClientRectFromClippingAncestor(c,d,p);return l.top=yA(h.top,l.top),l.right=vA(h.right,l.right),l.bottom=vA(h.bottom,l.bottom),l.left=yA(h.left,l.left),l}),getClientRectFromClippingAncestor(c,m,p));return{width:y.right-y.left,height:y.bottom-y.top,x:y.left,y:y.top}},getOffsetParent:getOffsetParent,getElementRects:async function(l){const c=this.getOffsetParent||getOffsetParent,d=this.getDimensions,h=await d(l.floating);return{reference:getRectRelativeToOffsetParent(l.reference,await c(l.floating),l.strategy),floating:{x:0,y:0,width:h.width,height:h.height}}},getClientRects:function(l){return Array.from(l.getClientRects())},getDimensions:function(l){const{width:c,height:d}=getCssDimensions(l);return{width:c,height:d}},getScale:getScale,isElement:isElement,isRTL:function(l){return"rtl"===getComputedStyle$1(l).direction}};function rectsAreEqual(l,c){return l.x===c.x&&l.y===c.y&&l.width===c.width&&l.height===c.height}function autoUpdate(l,c,d,h){void 0===h&&(h={});const{ancestorScroll:p=!0,ancestorResize:f=!0,elementResize:m="function"==typeof ResizeObserver,layoutShift:y="function"==typeof IntersectionObserver,animationFrame:_=!1}=h,b=unwrapElement(l),w=p||f?[...b?getOverflowAncestors(b):[],...getOverflowAncestors(c)]:[];w.forEach((l=>{p&&l.addEventListener("scroll",d,{passive:!0}),f&&l.addEventListener("resize",d)}));const E=b&&y?function(l,c){let d,h=null;const p=getDocumentElement(l);function cleanup(){var l;clearTimeout(d),null==(l=h)||l.disconnect(),h=null}return function refresh(f,m){void 0===f&&(f=!1),void 0===m&&(m=1),cleanup();const y=l.getBoundingClientRect(),{left:_,top:b,width:w,height:E}=y;if(f||c(),!w||!E)return;const M={rootMargin:-bA(b)+"px "+-bA(p.clientWidth-(_+w))+"px "+-bA(p.clientHeight-(b+E))+"px "+-bA(_)+"px",threshold:yA(0,vA(1,m))||1};let N=!0;function handleObserve(c){const h=c[0].intersectionRatio;if(h!==m){if(!N)return refresh();h?refresh(!1,h):d=setTimeout((()=>{refresh(!1,1e-7)}),1e3)}1!==h||rectsAreEqual(y,l.getBoundingClientRect())||refresh(),N=!1}try{h=new IntersectionObserver(handleObserve,{...M,root:p.ownerDocument})}catch(P){h=new IntersectionObserver(handleObserve,M)}h.observe(l)}(!0),cleanup}(b,d):null;let M,N=-1,P=null;m&&(P=new ResizeObserver((l=>{let[h]=l;h&&h.target===b&&P&&(P.unobserve(c),cancelAnimationFrame(N),N=requestAnimationFrame((()=>{var l;null==(l=P)||l.observe(c)}))),d()})),b&&!_&&P.observe(b),P.observe(c));let L=_?getBoundingClientRect(l):null;return _&&function frameLoop(){const c=getBoundingClientRect(l);L&&!rectsAreEqual(L,c)&&d();L=c,M=requestAnimationFrame(frameLoop)}(),d(),()=>{var l;w.forEach((l=>{p&&l.removeEventListener("scroll",d),f&&l.removeEventListener("resize",d)})),null==E||E(),null==(l=P)||l.disconnect(),P=null,_&&cancelAnimationFrame(M)}}const offset$1=function(l){return void 0===l&&(l=0),{name:"offset",options:l,async fn(c){var d,h;const{x:p,y:f,placement:m,middlewareData:y}=c,_=await async function(l,c){const{placement:d,platform:h,elements:p}=l,f=await(null==h.isRTL?void 0:h.isRTL(p.floating)),m=getSide(d),y=getAlignment(d),_="y"===getSideAxis(d),b=["left","top"].includes(m)?-1:1,w=f&&_?-1:1,E=evaluate(c,l);let{mainAxis:M,crossAxis:N,alignmentAxis:P}="number"==typeof E?{mainAxis:E,crossAxis:0,alignmentAxis:null}:{mainAxis:E.mainAxis||0,crossAxis:E.crossAxis||0,alignmentAxis:E.alignmentAxis};return y&&"number"==typeof P&&(N="end"===y?-1*P:P),_?{x:N*w,y:M*b}:{x:M*b,y:N*w}}(c,l);return m===(null==(d=y.offset)?void 0:d.placement)&&null!=(h=y.arrow)&&h.alignmentOffset?{}:{x:p+_.x,y:f+_.y,data:{..._,placement:m}}}}},shift$1=function(l){return void 0===l&&(l={}),{name:"shift",options:l,async fn(c){const{x:d,y:h,placement:p}=c,{mainAxis:f=!0,crossAxis:m=!1,limiter:y={fn:l=>{let{x:c,y:d}=l;return{x:c,y:d}}},..._}=evaluate(l,c),b={x:d,y:h},w=await detectOverflow(c,_),E=getSideAxis(getSide(p)),M=getOppositeAxis(E);let N=b[M],P=b[E];if(f){const l="y"===M?"bottom":"right";N=clamp(N+w["y"===M?"top":"left"],N,N-w[l])}if(m){const l="y"===E?"bottom":"right";P=clamp(P+w["y"===E?"top":"left"],P,P-w[l])}const L=y.fn({...c,[M]:N,[E]:P});return{...L,data:{x:L.x-d,y:L.y-h,enabled:{[M]:f,[E]:m}}}}}},flip$1=function(l){return void 0===l&&(l={}),{name:"flip",options:l,async fn(c){var d,h;const{placement:p,middlewareData:f,rects:m,initialPlacement:y,platform:_,elements:b}=c,{mainAxis:w=!0,crossAxis:E=!0,fallbackPlacements:M,fallbackStrategy:N="bestFit",fallbackAxisSideDirection:P="none",flipAlignment:L=!0,...j}=evaluate(l,c);if(null!=(d=f.arrow)&&d.alignmentOffset)return{};const D=getSide(p),F=getSideAxis(y),U=getSide(y)===y,B=await(null==_.isRTL?void 0:_.isRTL(b.floating)),H=M||(U||!L?[getOppositePlacement(y)]:function(l){const c=getOppositePlacement(l);return[getOppositeAlignmentPlacement(l),c,getOppositeAlignmentPlacement(c)]}(y)),z="none"!==P;!M&&z&&H.push(...function(l,c,d,h){const p=getAlignment(l);let f=function(l,c,d){const h=["left","right"],p=["right","left"],f=["top","bottom"],m=["bottom","top"];switch(l){case"top":case"bottom":return d?c?p:h:c?h:p;case"left":case"right":return c?f:m;default:return[]}}(getSide(l),"start"===d,h);return p&&(f=f.map((l=>l+"-"+p)),c&&(f=f.concat(f.map(getOppositeAlignmentPlacement)))),f}(y,L,P,B));const q=[y,...H],V=await detectOverflow(c,j),Z=[];let K=(null==(h=f.flip)?void 0:h.overflows)||[];if(w&&Z.push(V[D]),E){const l=function(l,c,d){void 0===d&&(d=!1);const h=getAlignment(l),p=getAlignmentAxis(l),f=getAxisLength(p);let m="x"===p?h===(d?"end":"start")?"right":"left":"start"===h?"bottom":"top";return c.reference[f]>c.floating[f]&&(m=getOppositePlacement(m)),[m,getOppositePlacement(m)]}(p,m,B);Z.push(V[l[0]],V[l[1]])}if(K=[...K,{placement:p,overflows:Z}],!Z.every((l=>l<=0))){var Y,ee;const l=((null==(Y=f.flip)?void 0:Y.index)||0)+1,c=q[l];if(c){if(!("alignment"===E&&F!==getSideAxis(c))||K.every((l=>l.overflows[0]>0&&getSideAxis(l.placement)===F)))return{data:{index:l,overflows:K},reset:{placement:c}}}let d=null==(ee=K.filter((l=>l.overflows[0]<=0)).sort(((l,c)=>l.overflows[1]-c.overflows[1]))[0])?void 0:ee.placement;if(!d)switch(N){case"bestFit":{var ne;const l=null==(ne=K.filter((l=>{if(z){const c=getSideAxis(l.placement);return c===F||"y"===c}return!0})).map((l=>[l.placement,l.overflows.filter((l=>l>0)).reduce(((l,c)=>l+c),0)])).sort(((l,c)=>l[1]-c[1]))[0])?void 0:ne[0];l&&(d=l);break}case"initialPlacement":d=y}if(p!==d)return{reset:{placement:d}}}return{}}}},size$1=function(l){return void 0===l&&(l={}),{name:"size",options:l,async fn(c){var d,h;const{placement:p,rects:f,platform:m,elements:y}=c,{apply:_=()=>{},...b}=evaluate(l,c),w=await detectOverflow(c,b),E=getSide(p),M=getAlignment(p),N="y"===getSideAxis(p),{width:P,height:L}=f.floating;let j,D;"top"===E||"bottom"===E?(j=E,D=M===(await(null==m.isRTL?void 0:m.isRTL(y.floating))?"start":"end")?"left":"right"):(D=E,j="end"===M?"top":"bottom");const F=L-w.top-w.bottom,U=P-w.left-w.right,B=vA(L-w[j],F),H=vA(P-w[D],U),z=!c.middlewareData.shift;let q=B,V=H;if(null!=(d=c.middlewareData.shift)&&d.enabled.x&&(V=U),null!=(h=c.middlewareData.shift)&&h.enabled.y&&(q=F),z&&!M){const l=yA(w.left,0),c=yA(w.right,0),d=yA(w.top,0),h=yA(w.bottom,0);N?V=P-2*(0!==l||0!==c?l+c:yA(w.left,w.right)):q=L-2*(0!==d||0!==h?d+h:yA(w.top,w.bottom))}await _({...c,availableWidth:V,availableHeight:q});const Z=await m.getDimensions(y.floating);return P!==Z.width||L!==Z.height?{reset:{rects:!0}}:{}}}},hide$1=function(l){return void 0===l&&(l={}),{name:"hide",options:l,async fn(c){const{rects:d}=c,{strategy:h="referenceHidden",...p}=evaluate(l,c);switch(h){case"referenceHidden":{const l=getSideOffsets(await detectOverflow(c,{...p,elementContext:"reference"}),d.reference);return{data:{referenceHiddenOffsets:l,referenceHidden:isAnySideFullyClipped(l)}}}case"escaped":{const l=getSideOffsets(await detectOverflow(c,{...p,altBoundary:!0}),d.floating);return{data:{escapedOffsets:l,escaped:isAnySideFullyClipped(l)}}}default:return{}}}}},arrow$2=l=>({name:"arrow",options:l,async fn(c){const{x:d,y:h,placement:p,rects:f,platform:m,elements:y,middlewareData:_}=c,{element:b,padding:w=0}=evaluate(l,c)||{};if(null==b)return{};const E=getPaddingObject(w),M={x:d,y:h},N=getAlignmentAxis(p),P=getAxisLength(N),L=await m.getDimensions(b),j="y"===N,D=j?"top":"left",F=j?"bottom":"right",U=j?"clientHeight":"clientWidth",B=f.reference[P]+f.reference[N]-M[N]-f.floating[P],H=M[N]-f.reference[N],z=await(null==m.getOffsetParent?void 0:m.getOffsetParent(b));let q=z?z[U]:0;q&&await(null==m.isElement?void 0:m.isElement(z))||(q=y.floating[U]||f.floating[P]);const V=B/2-H/2,Z=q/2-L[P]/2-1,K=vA(E[D],Z),Y=vA(E[F],Z),ee=K,ne=q-L[P]-Y,se=q/2-L[P]/2+V,ie=clamp(ee,se,ne),oe=!_.arrow&&null!=getAlignment(p)&&se!==ie&&f.reference[P]/2-(se<ee?K:Y)-L[P]/2<0,le=oe?se<ee?se-ee:se-ne:0;return{[N]:M[N]+le,data:{[N]:ie,centerOffset:se-ie-le,...oe&&{alignmentOffset:le}},reset:oe}}}),limitShift$1=function(l){return void 0===l&&(l={}),{options:l,fn(c){const{x:d,y:h,placement:p,rects:f,middlewareData:m}=c,{offset:y=0,mainAxis:_=!0,crossAxis:b=!0}=evaluate(l,c),w={x:d,y:h},E=getSideAxis(p),M=getOppositeAxis(E);let N=w[M],P=w[E];const L=evaluate(y,c),j="number"==typeof L?{mainAxis:L,crossAxis:0}:{mainAxis:0,crossAxis:0,...L};if(_){const l="y"===M?"height":"width",c=f.reference[M]-f.floating[l]+j.mainAxis,d=f.reference[M]+f.reference[l]-j.mainAxis;N<c?N=c:N>d&&(N=d)}if(b){var D,F;const l="y"===M?"width":"height",c=["top","left"].includes(getSide(p)),d=f.reference[E]-f.floating[l]+(c&&(null==(D=m.offset)?void 0:D[E])||0)+(c?0:j.crossAxis),h=f.reference[E]+f.reference[l]+(c?0:(null==(F=m.offset)?void 0:F[E])||0)-(c?j.crossAxis:0);P<d?P=d:P>h&&(P=h)}return{[M]:N,[E]:P}}}},computePosition=(l,c,d)=>{const h=new Map,p={platform:kA,...d},f={...p.platform,_c:h};return(async(l,c,d)=>{const{placement:h="bottom",strategy:p="absolute",middleware:f=[],platform:m}=d,y=f.filter(Boolean),_=await(null==m.isRTL?void 0:m.isRTL(c));let b=await m.getElementRects({reference:l,floating:c,strategy:p}),{x:w,y:E}=computeCoordsFromPlacement(b,h,_),M=h,N={},P=0;for(let L=0;L<y.length;L++){const{name:d,fn:f}=y[L],{x:j,y:D,data:F,reset:U}=await f({x:w,y:E,initialPlacement:h,placement:M,strategy:p,middlewareData:N,rects:b,platform:m,elements:{reference:l,floating:c}});w=null!=j?j:w,E=null!=D?D:E,N={...N,[d]:{...N[d],...F}},U&&P<=50&&(P++,"object"==typeof U&&(U.placement&&(M=U.placement),U.rects&&(b=!0===U.rects?await m.getElementRects({reference:l,floating:c,strategy:p}):U.rects),({x:w,y:E}=computeCoordsFromPlacement(b,M,_))),L=-1)}return{x:w,y:E,placement:M,strategy:p,middlewareData:N}})(l,c,{...p,platform:f})};var CA="undefined"!=typeof document?Gt.useLayoutEffect:function(){};function deepEqual(l,c){if(l===c)return!0;if(typeof l!=typeof c)return!1;if("function"==typeof l&&l.toString()===c.toString())return!0;let d,h,p;if(l&&c&&"object"==typeof l){if(Array.isArray(l)){if(d=l.length,d!==c.length)return!1;for(h=d;0!=h--;)if(!deepEqual(l[h],c[h]))return!1;return!0}if(p=Object.keys(l),d=p.length,d!==Object.keys(c).length)return!1;for(h=d;0!=h--;)if(!{}.hasOwnProperty.call(c,p[h]))return!1;for(h=d;0!=h--;){const d=p[h];if(("_owner"!==d||!l.$$typeof)&&!deepEqual(l[d],c[d]))return!1}return!0}return l!=l&&c!=c}function getDPR(l){if("undefined"==typeof window)return 1;return(l.ownerDocument.defaultView||window).devicePixelRatio||1}function roundByDPR(l,c){const d=getDPR(l);return Math.round(c*d)/d}function useLatestRef(l){const c=Gt.useRef(l);return CA((()=>{c.current=l})),c}const arrow$1=l=>({name:"arrow",options:l,fn(c){const{element:d,padding:h}="function"==typeof l?l(c):l;return d&&(p=d,{}.hasOwnProperty.call(p,"current"))?null!=d.current?arrow$2({element:d.current,padding:h}).fn(c):{}:d?arrow$2({element:d,padding:h}).fn(c):{};var p}}),offset=(l,c)=>({...offset$1(l),options:[l,c]}),shift=(l,c)=>({...shift$1(l),options:[l,c]}),limitShift=(l,c)=>({...limitShift$1(l),options:[l,c]}),flip=(l,c)=>({...flip$1(l),options:[l,c]}),size=(l,c)=>({...size$1(l),options:[l,c]}),hide=(l,c)=>({...hide$1(l),options:[l,c]}),arrow=(l,c)=>({...arrow$1(l),options:[l,c]});var EA=Gt.forwardRef(((l,c)=>{const{children:d,width:h=10,height:p=5,...f}=l;return Kt.jsx(AC.svg,{...f,ref:c,width:h,height:p,viewBox:"0 0 30 10",preserveAspectRatio:"none",children:l.asChild?d:Kt.jsx("polygon",{points:"0,0 30,0 15,10"})})}));EA.displayName="Arrow";var IA=EA,TA="Popper",[RA,AA]=createContextScope(TA),[OA,MA]=RA(TA),Popper=l=>{const{__scopePopper:c,children:d}=l,[h,p]=Gt.useState(null);return Kt.jsx(OA,{scope:c,anchor:h,onAnchorChange:p,children:d})};Popper.displayName=TA;var NA="PopperAnchor",PA=Gt.forwardRef(((l,c)=>{const{__scopePopper:d,virtualRef:h,...p}=l,f=MA(NA,d),m=Gt.useRef(null),y=pr(c,m);return Gt.useEffect((()=>{f.onAnchorChange(h?.current||m.current)})),h?null:Kt.jsx(AC.div,{...p,ref:y})}));PA.displayName=NA;var LA="PopperContent",[jA,DA]=RA(LA),FA=Gt.forwardRef(((l,c)=>{const{__scopePopper:d,side:h="bottom",sideOffset:p=0,align:f="center",alignOffset:m=0,arrowPadding:y=0,avoidCollisions:_=!0,collisionBoundary:b=[],collisionPadding:w=0,sticky:E="partial",hideWhenDetached:M=!1,updatePositionStrategy:N="optimized",onPlaced:P,...L}=l,j=MA(LA,d),[D,F]=Gt.useState(null),U=pr(c,(l=>F(l))),[B,H]=Gt.useState(null),z=useSize(B),q=z?.width??0,V=z?.height??0,Z=h+("center"!==f?"-"+f:""),K="number"==typeof w?w:{top:0,right:0,bottom:0,left:0,...w},Y=Array.isArray(b)?b:[b],ee=Y.length>0,ne={padding:K,boundary:Y.filter(isNotNull),altBoundary:ee},{refs:se,floatingStyles:ie,placement:oe,isPositioned:le,middlewareData:ce}=function(l){void 0===l&&(l={});const{placement:c="bottom",strategy:d="absolute",middleware:h=[],platform:p,elements:{reference:f,floating:m}={},transform:y=!0,whileElementsMounted:_,open:b}=l,[w,E]=Gt.useState({x:0,y:0,strategy:d,placement:c,middlewareData:{},isPositioned:!1}),[M,N]=Gt.useState(h);deepEqual(M,h)||N(h);const[P,L]=Gt.useState(null),[j,D]=Gt.useState(null),F=Gt.useCallback((l=>{l!==z.current&&(z.current=l,L(l))}),[]),U=Gt.useCallback((l=>{l!==q.current&&(q.current=l,D(l))}),[]),B=f||P,H=m||j,z=Gt.useRef(null),q=Gt.useRef(null),V=Gt.useRef(w),Z=null!=_,K=useLatestRef(_),Y=useLatestRef(p),ee=useLatestRef(b),ne=Gt.useCallback((()=>{if(!z.current||!q.current)return;const l={placement:c,strategy:d,middleware:M};Y.current&&(l.platform=Y.current),computePosition(z.current,q.current,l).then((l=>{const c={...l,isPositioned:!1!==ee.current};se.current&&!deepEqual(V.current,c)&&(V.current=c,ur.flushSync((()=>{E(c)})))}))}),[M,c,d,Y,ee]);CA((()=>{!1===b&&V.current.isPositioned&&(V.current.isPositioned=!1,E((l=>({...l,isPositioned:!1}))))}),[b]);const se=Gt.useRef(!1);CA((()=>(se.current=!0,()=>{se.current=!1})),[]),CA((()=>{if(B&&(z.current=B),H&&(q.current=H),B&&H){if(K.current)return K.current(B,H,ne);ne()}}),[B,H,ne,K,Z]);const ie=Gt.useMemo((()=>({reference:z,floating:q,setReference:F,setFloating:U})),[F,U]),oe=Gt.useMemo((()=>({reference:B,floating:H})),[B,H]),le=Gt.useMemo((()=>{const l={position:d,left:0,top:0};if(!oe.floating)return l;const c=roundByDPR(oe.floating,w.x),h=roundByDPR(oe.floating,w.y);return y?{...l,transform:"translate("+c+"px, "+h+"px)",...getDPR(oe.floating)>=1.5&&{willChange:"transform"}}:{position:d,left:c,top:h}}),[d,y,oe.floating,w.x,w.y]);return Gt.useMemo((()=>({...w,update:ne,refs:ie,elements:oe,floatingStyles:le})),[w,ne,ie,oe,le])}({strategy:"fixed",placement:Z,whileElementsMounted:(...l)=>autoUpdate(...l,{animationFrame:"always"===N}),elements:{reference:j.anchor},middleware:[offset({mainAxis:p+V,alignmentAxis:m}),_&&shift({mainAxis:!0,crossAxis:!1,limiter:"partial"===E?limitShift():void 0,...ne}),_&&flip({...ne}),size({...ne,apply:({elements:l,rects:c,availableWidth:d,availableHeight:h})=>{const{width:p,height:f}=c.reference,m=l.floating.style;m.setProperty("--radix-popper-available-width",`${d}px`),m.setProperty("--radix-popper-available-height",`${h}px`),m.setProperty("--radix-popper-anchor-width",`${p}px`),m.setProperty("--radix-popper-anchor-height",`${f}px`)}}),B&&arrow({element:B,padding:y}),transformOrigin({arrowWidth:q,arrowHeight:V}),M&&hide({strategy:"referenceHidden",...ne})]}),[pe,fe]=getSideAndAlignFromPlacement(oe),ge=useCallbackRef(P);LC((()=>{le&&ge?.()}),[le,ge]);const be=ce.arrow?.x,Oe=ce.arrow?.y,Ne=0!==ce.arrow?.centerOffset,[De,Fe]=Gt.useState();return LC((()=>{D&&Fe(window.getComputedStyle(D).zIndex)}),[D]),Kt.jsx("div",{ref:se.setFloating,"data-radix-popper-content-wrapper":"",style:{...ie,transform:le?ie.transform:"translate(0, -200%)",minWidth:"max-content",zIndex:De,"--radix-popper-transform-origin":[ce.transformOrigin?.x,ce.transformOrigin?.y].join(" "),...ce.hide?.referenceHidden&&{visibility:"hidden",pointerEvents:"none"}},dir:l.dir,children:Kt.jsx(jA,{scope:d,placedSide:pe,onArrowChange:H,arrowX:be,arrowY:Oe,shouldHideArrow:Ne,children:Kt.jsx(AC.div,{"data-side":pe,"data-align":fe,...L,ref:U,style:{...L.style,animation:le?void 0:"none"}})})})}));FA.displayName=LA;var $A="PopperArrow",UA={top:"bottom",right:"left",bottom:"top",left:"right"},BA=Gt.forwardRef((function(l,c){const{__scopePopper:d,...h}=l,p=DA($A,d),f=UA[p.placedSide];return Kt.jsx("span",{ref:p.onArrowChange,style:{position:"absolute",left:p.arrowX,top:p.arrowY,[f]:0,transformOrigin:{top:"",right:"0 0",bottom:"center 0",left:"100% 0"}[p.placedSide],transform:{top:"translateY(100%)",right:"translateY(50%) rotate(90deg) translateX(-50%)",bottom:"rotate(180deg)",left:"translateY(50%) rotate(-90deg) translateX(50%)"}[p.placedSide],visibility:p.shouldHideArrow?"hidden":void 0},children:Kt.jsx(IA,{...h,ref:c,style:{...h.style,display:"block"}})})}));function isNotNull(l){return null!==l}BA.displayName=$A;var transformOrigin=l=>({name:"transformOrigin",options:l,fn(c){const{placement:d,rects:h,middlewareData:p}=c,f=0!==p.arrow?.centerOffset,m=f?0:l.arrowWidth,y=f?0:l.arrowHeight,[_,b]=getSideAndAlignFromPlacement(d),w={start:"0%",center:"50%",end:"100%"}[b],E=(p.arrow?.x??0)+m/2,M=(p.arrow?.y??0)+y/2;let N="",P="";return"bottom"===_?(N=f?w:`${E}px`,P=-y+"px"):"top"===_?(N=f?w:`${E}px`,P=`${h.floating.height+y}px`):"right"===_?(N=-y+"px",P=f?w:`${M}px`):"left"===_&&(N=`${h.floating.width+y}px`,P=f?w:`${M}px`),{data:{x:N,y:P}}}});function getSideAndAlignFromPlacement(l){const[c,d="center"]=l.split("-");return[c,d]}var HA=Popper,zA=PA,qA=FA,WA=BA,VA=Object.freeze({position:"absolute",border:0,width:1,height:1,padding:0,margin:-1,overflow:"hidden",clip:"rect(0, 0, 0, 0)",whiteSpace:"nowrap",wordWrap:"normal"}),ZA=Gt.forwardRef(((l,c)=>Kt.jsx(AC.span,{...l,ref:c,style:{...VA,...l.style}})));ZA.displayName="VisuallyHidden";var GA=ZA,[KA,JA]=createContextScope("Tooltip",[AA]),YA=AA(),QA="TooltipProvider",XA=700,eO="tooltip.open",[tO,rO]=KA(QA),TooltipProvider$1=l=>{const{__scopeTooltip:c,delayDuration:d=XA,skipDelayDuration:h=300,disableHoverableContent:p=!1,children:f}=l,m=Gt.useRef(!0),y=Gt.useRef(!1),_=Gt.useRef(0);return Gt.useEffect((()=>{const l=_.current;return()=>window.clearTimeout(l)}),[]),Kt.jsx(tO,{scope:c,isOpenDelayedRef:m,delayDuration:d,onOpen:Gt.useCallback((()=>{window.clearTimeout(_.current),m.current=!1}),[]),onClose:Gt.useCallback((()=>{window.clearTimeout(_.current),_.current=window.setTimeout((()=>m.current=!0),h)}),[h]),isPointerInTransitRef:y,onPointerInTransitChange:Gt.useCallback((l=>{y.current=l}),[]),disableHoverableContent:p,children:f})};TooltipProvider$1.displayName=QA;var nO="Tooltip",[sO,iO]=KA(nO),Tooltip$1=l=>{const{__scopeTooltip:c,children:d,open:h,defaultOpen:p,onOpenChange:f,disableHoverableContent:m,delayDuration:y}=l,_=rO(nO,l.__scopeTooltip),b=YA(c),[w,E]=Gt.useState(null),M=useId(),N=Gt.useRef(0),P=m??_.disableHoverableContent,L=y??_.delayDuration,j=Gt.useRef(!1),[D,F]=useControllableState({prop:h,defaultProp:p??!1,onChange:l=>{l?(_.onOpen(),document.dispatchEvent(new CustomEvent(eO))):_.onClose(),f?.(l)},caller:nO}),U=Gt.useMemo((()=>D?j.current?"delayed-open":"instant-open":"closed"),[D]),B=Gt.useCallback((()=>{window.clearTimeout(N.current),N.current=0,j.current=!1,F(!0)}),[F]),H=Gt.useCallback((()=>{window.clearTimeout(N.current),N.current=0,F(!1)}),[F]),z=Gt.useCallback((()=>{window.clearTimeout(N.current),N.current=window.setTimeout((()=>{j.current=!0,F(!0),N.current=0}),L)}),[L,F]);return Gt.useEffect((()=>()=>{N.current&&(window.clearTimeout(N.current),N.current=0)}),[]),Kt.jsx(HA,{...b,children:Kt.jsx(sO,{scope:c,contentId:M,open:D,stateAttribute:U,trigger:w,onTriggerChange:E,onTriggerEnter:Gt.useCallback((()=>{_.isOpenDelayedRef.current?z():B()}),[_.isOpenDelayedRef,z,B]),onTriggerLeave:Gt.useCallback((()=>{P?H():(window.clearTimeout(N.current),N.current=0)}),[H,P]),onOpen:B,onClose:H,disableHoverableContent:P,children:d})})};Tooltip$1.displayName=nO;var oO="TooltipTrigger",aO=Gt.forwardRef(((l,c)=>{const{__scopeTooltip:d,...h}=l,p=iO(oO,d),f=rO(oO,d),m=YA(d),y=Gt.useRef(null),_=pr(c,y,p.onTriggerChange),b=Gt.useRef(!1),w=Gt.useRef(!1),E=Gt.useCallback((()=>b.current=!1),[]);return Gt.useEffect((()=>()=>document.removeEventListener("pointerup",E)),[E]),Kt.jsx(zA,{asChild:!0,...m,children:Kt.jsx(AC.button,{"aria-describedby":p.open?p.contentId:void 0,"data-state":p.stateAttribute,...h,ref:_,onPointerMove:composeEventHandlers(l.onPointerMove,(l=>{"touch"!==l.pointerType&&(w.current||f.isPointerInTransitRef.current||(p.onTriggerEnter(),w.current=!0))})),onPointerLeave:composeEventHandlers(l.onPointerLeave,(()=>{p.onTriggerLeave(),w.current=!1})),onPointerDown:composeEventHandlers(l.onPointerDown,(()=>{p.open&&p.onClose(),b.current=!0,document.addEventListener("pointerup",E,{once:!0})})),onFocus:composeEventHandlers(l.onFocus,(()=>{b.current||p.onOpen()})),onBlur:composeEventHandlers(l.onBlur,p.onClose),onClick:composeEventHandlers(l.onClick,p.onClose)})})}));aO.displayName=oO;var[lO,cO]=KA("TooltipPortal",{forceMount:void 0}),uO="TooltipContent",dO=Gt.forwardRef(((l,c)=>{const d=cO(uO,l.__scopeTooltip),{forceMount:h=d.forceMount,side:p="top",...f}=l,m=iO(uO,l.__scopeTooltip);return Kt.jsx(Presence,{present:h||m.open,children:m.disableHoverableContent?Kt.jsx(gO,{side:p,...f,ref:c}):Kt.jsx(hO,{side:p,...f,ref:c})})})),hO=Gt.forwardRef(((l,c)=>{const d=iO(uO,l.__scopeTooltip),h=rO(uO,l.__scopeTooltip),p=Gt.useRef(null),f=pr(c,p),[m,y]=Gt.useState(null),{trigger:_,onClose:b}=d,w=p.current,{onPointerInTransitChange:E}=h,M=Gt.useCallback((()=>{y(null),E(!1)}),[E]),N=Gt.useCallback(((l,c)=>{const d=l.currentTarget,h={x:l.clientX,y:l.clientY},p=function(l,c,d=5){const h=[];switch(c){case"top":h.push({x:l.x-d,y:l.y+d},{x:l.x+d,y:l.y+d});break;case"bottom":h.push({x:l.x-d,y:l.y-d},{x:l.x+d,y:l.y-d});break;case"left":h.push({x:l.x+d,y:l.y-d},{x:l.x+d,y:l.y+d});break;case"right":h.push({x:l.x-d,y:l.y-d},{x:l.x-d,y:l.y+d})}return h}(h,function(l,c){const d=Math.abs(c.top-l.y),h=Math.abs(c.bottom-l.y),p=Math.abs(c.right-l.x),f=Math.abs(c.left-l.x);switch(Math.min(d,h,p,f)){case f:return"left";case p:return"right";case d:return"top";case h:return"bottom";default:throw new Error("unreachable")}}(h,d.getBoundingClientRect())),f=function(l){const c=l.slice();return c.sort(((l,c)=>l.x<c.x?-1:l.x>c.x?1:l.y<c.y?-1:l.y>c.y?1:0)),function(l){if(l.length<=1)return l.slice();const c=[];for(let h=0;h<l.length;h++){const d=l[h];for(;c.length>=2;){const l=c[c.length-1],h=c[c.length-2];if(!((l.x-h.x)*(d.y-h.y)>=(l.y-h.y)*(d.x-h.x)))break;c.pop()}c.push(d)}c.pop();const d=[];for(let h=l.length-1;h>=0;h--){const c=l[h];for(;d.length>=2;){const l=d[d.length-1],h=d[d.length-2];if(!((l.x-h.x)*(c.y-h.y)>=(l.y-h.y)*(c.x-h.x)))break;d.pop()}d.push(c)}return d.pop(),1===c.length&&1===d.length&&c[0].x===d[0].x&&c[0].y===d[0].y?c:c.concat(d)}(c)}([...p,...function(l){const{top:c,right:d,bottom:h,left:p}=l;return[{x:p,y:c},{x:d,y:c},{x:d,y:h},{x:p,y:h}]}(c.getBoundingClientRect())]);y(f),E(!0)}),[E]);return Gt.useEffect((()=>()=>M()),[M]),Gt.useEffect((()=>{if(_&&w){const handleTriggerLeave=l=>N(l,w),handleContentLeave=l=>N(l,_);return _.addEventListener("pointerleave",handleTriggerLeave),w.addEventListener("pointerleave",handleContentLeave),()=>{_.removeEventListener("pointerleave",handleTriggerLeave),w.removeEventListener("pointerleave",handleContentLeave)}}}),[_,w,N,M]),Gt.useEffect((()=>{if(m){const handleTrackPointerGrace=l=>{const c=l.target,d={x:l.clientX,y:l.clientY},h=_?.contains(c)||w?.contains(c),p=!function(l,c){const{x:d,y:h}=l;let p=!1;for(let f=0,m=c.length-1;f<c.length;m=f++){const l=c[f],y=c[m],_=l.x,b=l.y,w=y.x,E=y.y;b>h!=E>h&&d<(w-_)*(h-b)/(E-b)+_&&(p=!p)}return p}(d,m);h?M():p&&(M(),b())};return document.addEventListener("pointermove",handleTrackPointerGrace),()=>document.removeEventListener("pointermove",handleTrackPointerGrace)}}),[_,w,m,b,M]),Kt.jsx(gO,{...l,ref:f})})),[pO,fO]=KA(nO,{isInside:!1}),mO=vr("TooltipContent"),gO=Gt.forwardRef(((l,c)=>{const{__scopeTooltip:d,children:h,"aria-label":p,onEscapeKeyDown:f,onPointerDownOutside:m,...y}=l,_=iO(uO,d),b=YA(d),{onClose:w}=_;return Gt.useEffect((()=>(document.addEventListener(eO,w),()=>document.removeEventListener(eO,w))),[w]),Gt.useEffect((()=>{if(_.trigger){const handleScroll=l=>{const c=l.target;c?.contains(_.trigger)&&w()};return window.addEventListener("scroll",handleScroll,{capture:!0}),()=>window.removeEventListener("scroll",handleScroll,{capture:!0})}}),[_.trigger,w]),Kt.jsx(mA,{asChild:!0,disableOutsidePointerEvents:!1,onEscapeKeyDown:f,onPointerDownOutside:m,onFocusOutside:l=>l.preventDefault(),onDismiss:w,children:Kt.jsxs(qA,{"data-state":_.stateAttribute,...b,...y,ref:c,style:{...y.style,"--radix-tooltip-content-transform-origin":"var(--radix-popper-transform-origin)","--radix-tooltip-content-available-width":"var(--radix-popper-available-width)","--radix-tooltip-content-available-height":"var(--radix-popper-available-height)","--radix-tooltip-trigger-width":"var(--radix-popper-anchor-width)","--radix-tooltip-trigger-height":"var(--radix-popper-anchor-height)"},children:[Kt.jsx(mO,{children:h}),Kt.jsx(pO,{scope:d,isInside:!0,children:Kt.jsx(GA,{id:_.contentId,role:"tooltip",children:p||h})})]})})}));dO.displayName=uO;var vO="TooltipArrow";Gt.forwardRef(((l,c)=>{const{__scopeTooltip:d,...h}=l,p=YA(d);return fO(vO,d).isInside?null:Kt.jsx(WA,{...p,...h,ref:c})})).displayName=vO;var yO=dO;const _O=TooltipProvider$1,bO=Tooltip$1,wO=aO,SO=Gt.forwardRef((({className:l,sideOffset:c=4,...d},h)=>Kt.jsx(yO,{ref:h,sideOffset:c,className:tr("z-50 overflow-hidden rounded-md border bg-popover px-3 py-1.5 text-sm text-popover-foreground shadow-md animate-in fade-in-0 zoom-in-95 data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=closed]:zoom-out-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2 origin-[--radix-tooltip-content-transform-origin]",l),...d})));SO.displayName=yO.displayName;const Message=({children:l,className:c,...d})=>Kt.jsx("div",{className:tr("flex gap-3",c),...d,children:l}),MessageAvatar=({src:l,alt:c,fallback:d,delayMs:h,className:p})=>Kt.jsxs(oA,{className:tr("h-8 w-8 shrink-0",p),children:[Kt.jsx(aA,{src:l,alt:c}),d&&Kt.jsx(lA,{delayMs:h,children:d})]}),MessageContent=({children:l,markdown:c=!1,className:d,...h})=>{const p=tr("rounded-lg p-2 text-foreground bg-secondary prose break-words whitespace-normal",d);return c?Kt.jsx(cA,{className:p,...h,children:l}):Kt.jsx("div",{className:p,...h,children:l})},TimeoutMessage=({showTimeoutMessage:l,onRetry:c,onDismiss:d})=>l?Kt.jsx(Message,{className:"message-enter w-full animate-fadeIn",children:Kt.jsx("div",{className:"flex flex-col w-full",children:Kt.jsx("div",{className:"bg-orange-50 border border-orange-200 rounded-lg p-3 w-full shadow-sm hover:shadow transition-shadow duration-200",children:Kt.jsxs("div",{className:"flex items-start gap-3 w-full",children:[Kt.jsx("div",{className:"bg-orange-100 p-2 rounded-full flex items-center justify-center",children:Kt.jsx(ds,{className:"h-4 w-4 text-orange-600 flex-shrink-0"})}),Kt.jsxs("div",{className:"w-full",children:[Kt.jsx("p",{className:"text-sm font-medium text-orange-900",children:"Request Timed Out"}),Kt.jsx("p",{className:"text-xs text-orange-700 mt-1",children:"The server took too long to respond. You can retry your request or try again later."}),Kt.jsxs("div",{className:"mt-3 flex flex-wrap gap-2",children:[Kt.jsxs(or,{size:"sm",variant:"default",onClick:c,className:"h-8 text-xs bg-orange-600 hover:bg-orange-700 text-white border-none shadow-sm hover:shadow-md transition-all duration-200",children:[Kt.jsx(Ni,{className:"h-3 w-3 mr-1.5"}),"Retry Request"]}),Kt.jsx(or,{size:"sm",variant:"outline",onClick:d,className:"h-8 text-xs text-orange-700 border-orange-300 hover:bg-orange-100 transition-colors duration-200",children:"Dismiss"})]})]})]})})})}):null,ToolCallItem=({toolCall:l,index:c,isExecuting:d=!1,executionError:h,canRetry:p=!1,onRetry:f,isDevMode:m=!1,onCopy:y})=>{const[_,b]=Gt.useState(!1),[w,E]=Gt.useState(!1),formatPayload=l=>{try{return JSON.stringify(l,null,2)}catch(c){return"Error formatting payload"}};return Kt.jsxs("div",{className:tr("tool-call-item relative transition-all duration-200","hover:bg-accent/5","border-b last:border-b-0 border-border/30"),children:[Kt.jsxs("div",{className:"flex items-start gap-3 px-4 py-3",children:[Kt.jsx("div",{className:"flex-shrink-0",children:d?Kt.jsx("div",{className:"w-8 h-8 rounded-full bg-primary/10 flex items-center justify-center bounce-in",children:Kt.jsx("div",{className:"w-4 h-4 border-2 border-primary border-t-transparent rounded-full animate-spin"})}):"completed"===l.status?Kt.jsx("div",{className:"w-8 h-8 rounded-full bg-green-500/10 flex items-center justify-center bounce-in hover-scale",children:Kt.jsx(ls,{className:"w-4 h-4 text-green-600 status-transition"})}):"failed"===l.status?Kt.jsx("div",{className:"w-8 h-8 rounded-full bg-red-500/10 flex items-center justify-center bounce-in hover-scale",children:Kt.jsx(cs,{className:"w-4 h-4 text-red-600 status-transition"})}):"cancelled"===l.status?Kt.jsx("div",{className:"w-8 h-8 rounded-full bg-gray-500/10 flex items-center justify-center bounce-in hover-scale",children:Kt.jsx(cs,{className:"w-4 h-4 text-yellow-600 status-transition"})}):Kt.jsx("div",{className:"w-8 h-8 rounded-full border-2 border-muted-foreground/30 flex items-center justify-center pulse-glow",children:Kt.jsx("div",{className:"w-2 h-2 rounded-full bg-muted-foreground/50 animate-ping"})})}),Kt.jsxs("div",{className:"flex-1 min-w-0",children:[Kt.jsxs("div",{className:"flex flex-col gap-1",children:[Kt.jsxs("div",{className:"flex items-center gap-2",children:[Kt.jsx("span",{className:"text-sm font-medium",children:(l=>{const c={updateQuestion:"Update Question",updateAnswers:"Update Answers",createQuestion:"Create Question",deleteNode:"Delete Node",getRoutingData:"Get Routing Data",default:"Tool Call"};return c[l]||c.default})(l.type)}),d&&Kt.jsx("span",{className:"text-xs text-muted-foreground animate-pulse",children:"Processing..."})]}),Kt.jsx("div",{className:"text-xs text-muted-foreground line-clamp-2",children:l.content})]}),h&&Kt.jsx("div",{className:"mt-2 text-xs text-red-600 bg-red-50 px-2 py-1 rounded",children:h})]}),Kt.jsxs("div",{className:"flex items-start gap-1 flex-shrink-0 mt-1",children:[m&&Kt.jsx(or,{variant:"ghost",size:"sm",onClick:()=>y?.(l.content),className:"h-7 w-7 p-0 hover:bg-accent",title:"Copy content",children:Kt.jsx(Es,{className:"h-3 w-3"})}),"failed"===l.status&&f&&Kt.jsx(or,{variant:"ghost",size:"sm",onClick:f,className:"h-7 w-7 p-0 text-orange-600 hover:text-orange-700 hover:bg-orange-100",title:"Retry tool call",children:Kt.jsx(Pi,{className:"h-3 w-3"})}),m&&Kt.jsx(or,{variant:"ghost",size:"sm",onClick:()=>b(!_),className:"h-7 w-7 p-0 hover:bg-accent",title:_?"Collapse details":"Expand details",children:_?Kt.jsx(os,{className:"h-3 w-3"}):Kt.jsx(ns,{className:"h-3 w-3"})})]})]}),_&&Kt.jsxs("div",{className:"tool-call-expanded px-4 pb-4 space-y-4 border-t border-border/20 bg-accent/5",children:[Kt.jsxs("div",{className:"space-y-2 pt-3",children:[Kt.jsxs("div",{className:"text-xs text-muted-foreground",children:[Kt.jsx("span",{className:"font-medium text-foreground",children:"ID:"})," ",l.id]}),Kt.jsxs("div",{className:"text-xs text-muted-foreground",children:[Kt.jsx("span",{className:"font-medium text-foreground",children:"Type:"})," ",l.type]}),Kt.jsxs("div",{className:"text-xs text-muted-foreground",children:[Kt.jsx("span",{className:"font-medium text-foreground",children:"Status:"}),Kt.jsx("span",{className:tr("ml-1 px-2 py-0.5 rounded-full text-xs font-medium","completed"===l.status&&"bg-green-100 text-green-800","failed"===l.status&&"bg-red-100 text-red-800","pending"===l.status&&"bg-yellow-100 text-yellow-800","cancelled"===l.status&&"bg-gray-100 text-gray-800"),children:l.status})]})]}),Kt.jsxs("div",{className:"space-y-2",children:[Kt.jsx(or,{variant:"outline",size:"sm",onClick:()=>E(!w),className:"h-7 text-xs px-2 py-1",children:w?Kt.jsxs(Kt.Fragment,{children:[Kt.jsx(Ns,{className:"h-3 w-3 mr-1"}),"Hide Payload"]}):Kt.jsxs(Kt.Fragment,{children:[Kt.jsx(Ps,{className:"h-3 w-3 mr-1"}),"Show Payload"]})}),w&&Kt.jsxs("div",{className:"relative",children:[Kt.jsx("pre",{className:"text-xs bg-muted/50 border border-border p-3 rounded-md overflow-x-auto max-h-48 overflow-y-auto",children:formatPayload(l)}),Kt.jsx(or,{variant:"ghost",size:"sm",onClick:()=>y?.(formatPayload(l)),className:"absolute top-2 right-2 h-6 w-6 p-0 bg-background/80 hover:bg-background/90 border border-border",title:"Copy payload",children:Kt.jsx(Es,{className:"h-3 w-3"})})]})]}),h&&Kt.jsx("div",{className:"space-y-2",children:Kt.jsxs("div",{className:"flex items-start gap-3 bg-red-50/80 border border-red-200 rounded-lg p-3",children:[Kt.jsx(as,{className:"h-4 w-4 text-red-500 mt-0.5 flex-shrink-0"}),Kt.jsxs("div",{className:"flex-1",children:[Kt.jsx("div",{className:"text-sm font-medium text-red-800 mb-1",children:"Execution Failed"}),Kt.jsx("div",{className:"text-sm text-red-700 break-words",children:h}),p&&Kt.jsx("div",{className:"mt-2 text-xs text-red-600 bg-red-100 px-2 py-1 rounded",children:"Maximum retry attempts reached (3/3)"})]})]})})]})]})};var xO={},kO={},CO={};!function(l){Object.defineProperty(l,"__esModule",{value:!0}),l.isEventSourceSupported=l.isReactNative=l.ReadyState=l.DEFAULT_HEARTBEAT=l.UNPARSABLE_JSON_OBJECT=l.DEFAULT_RECONNECT_INTERVAL_MS=l.DEFAULT_RECONNECT_LIMIT=l.SOCKET_IO_PING_CODE=l.SOCKET_IO_PATH=l.SOCKET_IO_PING_INTERVAL=l.DEFAULT_EVENT_SOURCE_OPTIONS=l.EMPTY_EVENT_HANDLERS=l.DEFAULT_OPTIONS=void 0;var c,d;l.DEFAULT_OPTIONS={},l.EMPTY_EVENT_HANDLERS={},l.DEFAULT_EVENT_SOURCE_OPTIONS={withCredentials:!1,events:l.EMPTY_EVENT_HANDLERS},l.SOCKET_IO_PING_INTERVAL=25e3,l.SOCKET_IO_PATH="/socket.io/?EIO=3&transport=websocket",l.SOCKET_IO_PING_CODE="2",l.DEFAULT_RECONNECT_LIMIT=20,l.DEFAULT_RECONNECT_INTERVAL_MS=5e3,l.UNPARSABLE_JSON_OBJECT={},l.DEFAULT_HEARTBEAT={message:"ping",timeout:6e4,interval:25e3},(d=c||(l.ReadyState=c={}))[d.UNINSTANTIATED=-1]="UNINSTANTIATED",d[d.CONNECTING=0]="CONNECTING",d[d.OPEN=1]="OPEN",d[d.CLOSING=2]="CLOSING",d[d.CLOSED=3]="CLOSED";l.isReactNative="undefined"!=typeof navigator&&"ReactNative"===navigator.product,l.isEventSourceSupported=!l.isReactNative&&function(){try{return"EventSource"in globalThis}catch(hh){return!1}}()}(CO);var EO={},IO={};!function(l){Object.defineProperty(l,"__esModule",{value:!0}),l.resetWebSockets=l.sharedWebSockets=void 0,l.sharedWebSockets={};l.resetWebSockets=function(c){if(c&&l.sharedWebSockets.hasOwnProperty(c))delete l.sharedWebSockets[c];else for(var d in l.sharedWebSockets)l.sharedWebSockets.hasOwnProperty(d)&&delete l.sharedWebSockets[d]}}(IO);var TO={},RO={};Object.defineProperty(RO,"__esModule",{value:!0}),RO.setUpSocketIOPing=RO.appendQueryParams=RO.parseSocketIOUrl=void 0;var AO=CO;RO.parseSocketIOUrl=function(l){if(l){var c=/^https|wss/.test(l),d=l.replace(/^(https?|wss?)(:\/\/)?/,"").replace(/\/$/,"");return"".concat(h=c?"wss":"ws","://").concat(d).concat(AO.SOCKET_IO_PATH)}if(""===l){var h=(c=/^https/.test(window.location.protocol))?"wss":"ws",p=window.location.port?":".concat(window.location.port):"";return"".concat(h,"://").concat(window.location.hostname).concat(p).concat(AO.SOCKET_IO_PATH)}return l};RO.appendQueryParams=function(l,c){void 0===c&&(c={});var d=/\?([\w]+=[\w]+)/.test(l),h="".concat(Object.entries(c).reduce((function(l,c){var d=c[0],h=c[1];return l+"".concat(d,"=").concat(h,"&")}),"").slice(0,-1));return"".concat(l).concat(d?"&":"?").concat(h)};RO.setUpSocketIOPing=function(l,c){void 0===c&&(c=AO.SOCKET_IO_PING_INTERVAL);return window.setInterval((function(){return l(AO.SOCKET_IO_PING_CODE)}),c)};var OO={};Object.defineProperty(OO,"__esModule",{value:!0}),OO.heartbeat=function(l,c,d){var h=d||{},p=h.interval,f=void 0===p?MO.DEFAULT_HEARTBEAT.interval:p,m=h.timeout,y=void 0===m?MO.DEFAULT_HEARTBEAT.timeout:m,_=h.message,b=void 0===_?MO.DEFAULT_HEARTBEAT.message:_,w=Math.max(100,f/10),E=Date.now(),M=setInterval((function(){var d=Date.now(),h=function(l){if(Array.isArray(l))return l.reduce((function(l,c){return l.current>c.current?l:c})).current;return l.current}(c);if(h+y<=d)console.warn("Heartbeat timed out, closing connection, last message received ".concat(d-h,"ms ago, last ping sent ").concat(d-E,"ms ago")),l.close();else if(h+f<=d&&E+f<=d)try{"function"==typeof b?l.send(b()):l.send(b),E=d}catch(p){console.error("Heartbeat failed, closing connection",p instanceof Error?p.message:p),l.close()}}),w);return l.addEventListener("close",(function(){clearInterval(M)})),function(){}};var MO=CO;var NO={},PO={};!function(l){Object.defineProperty(l,"__esModule",{value:!0}),l.resetSubscribers=l.removeSubscriber=l.addSubscriber=l.hasSubscribers=l.getSubscribers=void 0;var c={},d=[];l.getSubscribers=function(h){return(0,l.hasSubscribers)(h)?Array.from(c[h]):d};l.hasSubscribers=function(l){var d;return(null===(d=c[l])||void 0===d?void 0:d.size)>0};l.addSubscriber=function(l,d){c[l]=c[l]||new Set,c[l].add(d)};l.removeSubscriber=function(l,d){c[l].delete(d)};l.resetSubscribers=function(l){if(l&&c.hasOwnProperty(l))delete c[l];else for(var d in c)c.hasOwnProperty(d)&&delete c[d]}}(PO),Object.defineProperty(NO,"__esModule",{value:!0}),NO.assertIsWebSocket=function(l,c){if(!c&&l instanceof WebSocket==!1)throw new Error("")},NO.resetGlobalState=function(l){(0,jO.resetSubscribers)(l),(0,LO.resetWebSockets)(l)};var LO=IO,jO=PO;var DO=sr&&sr.__assign||function(){return DO=Object.assign||function(l){for(var c,d=1,h=arguments.length;d<h;d++)for(var p in c=arguments[d])Object.prototype.hasOwnProperty.call(c,p)&&(l[p]=c[p]);return l},DO.apply(this,arguments)};Object.defineProperty(TO,"__esModule",{value:!0}),TO.attachListeners=void 0;var FO=RO,$O=OO,UO=CO,BO=NO;TO.attachListeners=function(l,c,d,h,p,f,m){var y,_,b,w=c.setLastMessage,E=c.setReadyState;return d.current.fromSocketIO&&(y=(0,FO.setUpSocketIOPing)(m)),function(l,c,d,h){l.onmessage=function(l){var p;c.current.onMessage&&c.current.onMessage(l),"number"==typeof(null==h?void 0:h.current)&&(h.current=Date.now()),"function"==typeof c.current.filter&&!0!==c.current.filter(l)||c.current.heartbeat&&"boolean"!=typeof c.current.heartbeat&&(null===(p=c.current.heartbeat)||void 0===p?void 0:p.returnMessage)===l.data||d(l)}}(l,d,w,f),function(l,c,d,h,p){l.onopen=function(f){if(c.current.onOpen&&c.current.onOpen(f),h.current=0,d(UO.ReadyState.OPEN),c.current.heartbeat&&l instanceof WebSocket){var m="boolean"==typeof c.current.heartbeat?void 0:c.current.heartbeat;p.current=Date.now(),(0,$O.heartbeat)(l,p,m)}}}(l,d,E,p,f),_=function(l,c,d,h,p){return UO.isEventSourceSupported&&l instanceof EventSource?function(){}:((0,BO.assertIsWebSocket)(l,c.current.skipAssert),l.onclose=function(l){var m;if(c.current.onClose&&c.current.onClose(l),d(UO.ReadyState.CLOSED),c.current.shouldReconnect&&c.current.shouldReconnect(l)){var y=null!==(m=c.current.reconnectAttempts)&&void 0!==m?m:UO.DEFAULT_RECONNECT_LIMIT;if(p.current<y){var _="function"==typeof c.current.reconnectInterval?c.current.reconnectInterval(p.current):c.current.reconnectInterval;f=window.setTimeout((function(){p.current++,h()}),null!=_?_:UO.DEFAULT_RECONNECT_INTERVAL_MS)}else c.current.onReconnectStop&&c.current.onReconnectStop(y),console.warn("Max reconnect attempts of ".concat(y," exceeded"))}},function(){return f&&window.clearTimeout(f)});var f}(l,d,E,h,p),b=function(l,c,d,h,p){var f;return l.onerror=function(m){var y;if(c.current.onError&&c.current.onError(m),UO.isEventSourceSupported&&l instanceof EventSource&&(c.current.onClose&&c.current.onClose(DO(DO({},m),{code:1006,reason:"An error occurred with the EventSource: ".concat(m),wasClean:!1})),d(UO.ReadyState.CLOSED),l.close()),c.current.retryOnError)if(p.current<(null!==(y=c.current.reconnectAttempts)&&void 0!==y?y:UO.DEFAULT_RECONNECT_LIMIT)){var _="function"==typeof c.current.reconnectInterval?c.current.reconnectInterval(p.current):c.current.reconnectInterval;f=window.setTimeout((function(){p.current++,h()}),null!=_?_:UO.DEFAULT_RECONNECT_INTERVAL_MS)}else c.current.onReconnectStop&&c.current.onReconnectStop(c.current.reconnectAttempts),console.warn("Max reconnect attempts of ".concat(c.current.reconnectAttempts," exceeded"))},function(){return f&&window.clearTimeout(f)}}(l,d,E,h,p),function(){E(UO.ReadyState.CLOSING),_(),b(),l.close(),y&&clearInterval(y)}};var HO={},zO=sr&&sr.__assign||function(){return zO=Object.assign||function(l){for(var c,d=1,h=arguments.length;d<h;d++)for(var p in c=arguments[d])Object.prototype.hasOwnProperty.call(c,p)&&(l[p]=c[p]);return l},zO.apply(this,arguments)};Object.defineProperty(HO,"__esModule",{value:!0}),HO.attachSharedListeners=void 0;var qO=IO,WO=CO,VO=PO,ZO=RO,GO=OO;HO.attachSharedListeners=function(l,c,d,h){var p;return d.current.fromSocketIO&&(p=(0,ZO.setUpSocketIOPing)(h)),function(l,c,d){l.onmessage=function(l){(0,VO.getSubscribers)(c).forEach((function(c){var h;c.optionsRef.current.onMessage&&c.optionsRef.current.onMessage(l),"number"==typeof(null===(h=null==c?void 0:c.lastMessageTime)||void 0===h?void 0:h.current)&&(c.lastMessageTime.current=Date.now()),"function"==typeof c.optionsRef.current.filter&&!0!==c.optionsRef.current.filter(l)||d&&"boolean"!=typeof d&&(null==d?void 0:d.returnMessage)===l.data||c.setLastMessage(l)}))}}(l,c,d.current.heartbeat),function(l,c){l instanceof WebSocket&&(l.onclose=function(l){(0,VO.getSubscribers)(c).forEach((function(c){c.optionsRef.current.onClose&&c.optionsRef.current.onClose(l),c.setReadyState(WO.ReadyState.CLOSED)})),delete qO.sharedWebSockets[c],(0,VO.getSubscribers)(c).forEach((function(c){var d;if(c.optionsRef.current.shouldReconnect&&c.optionsRef.current.shouldReconnect(l)){var h=null!==(d=c.optionsRef.current.reconnectAttempts)&&void 0!==d?d:WO.DEFAULT_RECONNECT_LIMIT;if(c.reconnectCount.current<h){var p="function"==typeof c.optionsRef.current.reconnectInterval?c.optionsRef.current.reconnectInterval(c.reconnectCount.current):c.optionsRef.current.reconnectInterval;setTimeout((function(){c.reconnectCount.current++,c.reconnect.current()}),null!=p?p:WO.DEFAULT_RECONNECT_INTERVAL_MS)}else c.optionsRef.current.onReconnectStop&&c.optionsRef.current.onReconnectStop(c.optionsRef.current.reconnectAttempts),console.warn("Max reconnect attempts of ".concat(h," exceeded"))}}))})}(l,c),function(l,c,d){l.onopen=function(h){var p=(0,VO.getSubscribers)(c);p.forEach((function(c){c.reconnectCount.current=0,c.optionsRef.current.onOpen&&c.optionsRef.current.onOpen(h),c.setReadyState(WO.ReadyState.OPEN),d&&l instanceof WebSocket&&(c.lastMessageTime.current=Date.now())})),d&&l instanceof WebSocket&&(0,GO.heartbeat)(l,p.map((function(l){return l.lastMessageTime})),"boolean"==typeof d?void 0:d)}}(l,c,d.current.heartbeat),function(l,c){l.onerror=function(d){(0,VO.getSubscribers)(c).forEach((function(c){c.optionsRef.current.onError&&c.optionsRef.current.onError(d),WO.isEventSourceSupported&&l instanceof EventSource&&(c.optionsRef.current.onClose&&c.optionsRef.current.onClose(zO(zO({},d),{code:1006,reason:"An error occurred with the EventSource: ".concat(d),wasClean:!1})),c.setReadyState(WO.ReadyState.CLOSED))})),WO.isEventSourceSupported&&l instanceof EventSource&&l.close()}}(l,c),function(){p&&clearInterval(p)}},Object.defineProperty(EO,"__esModule",{value:!0}),EO.createOrJoinSocket=void 0;var KO=IO,JO=CO,YO=TO,QO=HO,XO=PO;EO.createOrJoinSocket=function(l,c,d,h,p,f,m,y,_){if(!JO.isEventSourceSupported&&h.current.eventSourceOptions)throw JO.isReactNative?new Error("EventSource is not supported in ReactNative"):new Error("EventSource is not supported");if(h.current.share){var b=null;void 0===KO.sharedWebSockets[c]?(KO.sharedWebSockets[c]=h.current.eventSourceOptions?new EventSource(c,h.current.eventSourceOptions):new WebSocket(c,h.current.protocols),l.current=KO.sharedWebSockets[c],d(JO.ReadyState.CONNECTING),b=(0,QO.attachSharedListeners)(KO.sharedWebSockets[c],c,h,_)):(l.current=KO.sharedWebSockets[c],d(KO.sharedWebSockets[c].readyState));var w={setLastMessage:p,setReadyState:d,optionsRef:h,reconnectCount:m,lastMessageTime:y,reconnect:f};return(0,XO.addSubscriber)(c,w),function(l,c,d,h,p){return function(){if((0,XO.removeSubscriber)(l,c),!(0,XO.hasSubscribers)(l)){try{var f=KO.sharedWebSockets[l];f instanceof WebSocket&&(f.onclose=function(l){d.current.onClose&&d.current.onClose(l),h(JO.ReadyState.CLOSED)}),f.close()}catch(hh){}p&&p(),delete KO.sharedWebSockets[l]}}}(c,w,h,d,b)}if(l.current=h.current.eventSourceOptions?new EventSource(c,h.current.eventSourceOptions):new WebSocket(c,h.current.protocols),d(JO.ReadyState.CONNECTING),!l.current)throw new Error("WebSocket failed to be created");return(0,YO.attachListeners)(l.current,{setLastMessage:p,setReadyState:d},h,f.current,m,y,_)};var eM={};!function(l){var c=sr&&sr.__awaiter||function(l,c,d,h){return new(d||(d=Promise))((function(p,f){function fulfilled(l){try{step(h.next(l))}catch(hh){f(hh)}}function rejected(l){try{step(h.throw(l))}catch(hh){f(hh)}}function step(l){var c;l.done?p(l.value):(c=l.value,c instanceof d?c:new d((function(l){l(c)}))).then(fulfilled,rejected)}step((h=h.apply(l,c||[])).next())}))},d=sr&&sr.__generator||function(l,c){var d,h,p,f={label:0,sent:function(){if(1&p[0])throw p[1];return p[1]},trys:[],ops:[]},m=Object.create(("function"==typeof Iterator?Iterator:Object).prototype);return m.next=verb(0),m.throw=verb(1),m.return=verb(2),"function"==typeof Symbol&&(m[Symbol.iterator]=function(){return this}),m;function verb(y){return function(_){return function(y){if(d)throw new TypeError("Generator is already executing.");for(;m&&(m=0,y[0]&&(f=0)),f;)try{if(d=1,h&&(p=2&y[0]?h.return:y[0]?h.throw||((p=h.return)&&p.call(h),0):h.next)&&!(p=p.call(h,y[1])).done)return p;switch(h=0,p&&(y=[2&y[0],p.value]),y[0]){case 0:case 1:p=y;break;case 4:return f.label++,{value:y[1],done:!1};case 5:f.label++,h=y[1],y=[0];continue;case 7:y=f.ops.pop(),f.trys.pop();continue;default:if(!(p=f.trys,(p=p.length>0&&p[p.length-1])||6!==y[0]&&2!==y[0])){f=0;continue}if(3===y[0]&&(!p||y[1]>p[0]&&y[1]<p[3])){f.label=y[1];break}if(6===y[0]&&f.label<p[1]){f.label=p[1],p=y;break}if(p&&f.label<p[2]){f.label=p[2],f.ops.push(y);break}p[2]&&f.ops.pop(),f.trys.pop();continue}y=c.call(l,f)}catch(hh){y=[6,hh],h=0}finally{d=p=0}if(5&y[0])throw y[1];return{value:y[0]?y[1]:void 0,done:!0}}([y,_])}}},h=sr&&sr.__spreadArray||function(l,c,d){if(d||2===arguments.length)for(var h,p=0,f=c.length;p<f;p++)!h&&p in c||(h||(h=Array.prototype.slice.call(c,0,p)),h[p]=c[p]);return l.concat(h||Array.prototype.slice.call(c))};Object.defineProperty(l,"__esModule",{value:!0}),l.getUrl=void 0;var p=RO,f=CO;l.getUrl=function(m,y){for(var _=[],b=2;b<arguments.length;b++)_[b-2]=arguments[b];return c(void 0,h([m,y],_,!0),void 0,(function(c,h,m){var y,_,b,w,E,M,N;return void 0===m&&(m=0),d(this,(function(d){switch(d.label){case 0:if("function"!=typeof c)return[3,10];d.label=1;case 1:return d.trys.push([1,3,,9]),[4,c()];case 2:return y=d.sent(),[3,9];case 3:return d.sent(),h.current.retryOnError?(_=null!==(E=h.current.reconnectAttempts)&&void 0!==E?E:f.DEFAULT_RECONNECT_LIMIT,m<_?(b="function"==typeof h.current.reconnectInterval?h.current.reconnectInterval(m):h.current.reconnectInterval,[4,(P=null!=b?b:f.DEFAULT_RECONNECT_INTERVAL_MS,new Promise((function(l){return window.setTimeout(l,P)})))]):[3,5]):[3,7];case 4:return d.sent(),[2,(0,l.getUrl)(c,h,m+1)];case 5:return null===(N=(M=h.current).onReconnectStop)||void 0===N||N.call(M,m),[2,null];case 6:return[3,8];case 7:return[2,null];case 8:return[3,9];case 9:return[3,11];case 10:y=c,d.label=11;case 11:return w=h.current.fromSocketIO?(0,p.parseSocketIOUrl)(y):y,[2,h.current.queryParams?(0,p.appendQueryParams)(w,h.current.queryParams):w]}var P}))}))}}(eM);var tM={};!function(l){Object.defineProperty(l,"__esModule",{value:!0}),l.websocketWrapper=void 0;l.websocketWrapper=function(l,c){return new Proxy(l,{get:function(l,d){var h=l[d];return"reconnect"===d?c:"function"==typeof h?(console.error("Calling methods directly on the websocket is not supported at this moment. You must use the methods returned by useWebSocket."),function(){}):h},set:function(l,c,d){return/^on/.test(c)?(console.warn("The websocket's event handlers should be defined through the options object passed into useWebSocket."),!1):(l[c]=d,!0)}})},l.default=l.websocketWrapper}(tM);var rM=sr&&sr.__assign||function(){return rM=Object.assign||function(l){for(var c,d=1,h=arguments.length;d<h;d++)for(var p in c=arguments[d])Object.prototype.hasOwnProperty.call(c,p)&&(l[p]=c[p]);return l},rM.apply(this,arguments)},nM=sr&&sr.__awaiter||function(l,c,d,h){return new(d||(d=Promise))((function(p,f){function fulfilled(l){try{step(h.next(l))}catch(hh){f(hh)}}function rejected(l){try{step(h.throw(l))}catch(hh){f(hh)}}function step(l){var c;l.done?p(l.value):(c=l.value,c instanceof d?c:new d((function(l){l(c)}))).then(fulfilled,rejected)}step((h=h.apply(l,c||[])).next())}))},sM=sr&&sr.__generator||function(l,c){var d,h,p,f={label:0,sent:function(){if(1&p[0])throw p[1];return p[1]},trys:[],ops:[]},m=Object.create(("function"==typeof Iterator?Iterator:Object).prototype);return m.next=verb(0),m.throw=verb(1),m.return=verb(2),"function"==typeof Symbol&&(m[Symbol.iterator]=function(){return this}),m;function verb(y){return function(_){return function(y){if(d)throw new TypeError("Generator is already executing.");for(;m&&(m=0,y[0]&&(f=0)),f;)try{if(d=1,h&&(p=2&y[0]?h.return:y[0]?h.throw||((p=h.return)&&p.call(h),0):h.next)&&!(p=p.call(h,y[1])).done)return p;switch(h=0,p&&(y=[2&y[0],p.value]),y[0]){case 0:case 1:p=y;break;case 4:return f.label++,{value:y[1],done:!1};case 5:f.label++,h=y[1],y=[0];continue;case 7:y=f.ops.pop(),f.trys.pop();continue;default:if(!(p=f.trys,(p=p.length>0&&p[p.length-1])||6!==y[0]&&2!==y[0])){f=0;continue}if(3===y[0]&&(!p||y[1]>p[0]&&y[1]<p[3])){f.label=y[1];break}if(6===y[0]&&f.label<p[1]){f.label=p[1],p=y;break}if(p&&f.label<p[2]){f.label=p[2],f.ops.push(y);break}p[2]&&f.ops.pop(),f.trys.pop();continue}y=c.call(l,f)}catch(hh){y=[6,hh],h=0}finally{d=p=0}if(5&y[0])throw y[1];return{value:y[0]?y[1]:void 0,done:!0}}([y,_])}}},iM=sr&&sr.__importDefault||function(l){return l&&l.__esModule?l:{default:l}};Object.defineProperty(kO,"__esModule",{value:!0}),kO.useWebSocket=void 0;var oM=Gt,aM=ur,lM=CO,cM=EO,uM=eM,dM=iM(tM),hM=NO;kO.useWebSocket=function(l,c,d){void 0===c&&(c=lM.DEFAULT_OPTIONS),void 0===d&&(d=!0);var h=(0,oM.useState)(null),p=h[0],f=h[1],m=(0,oM.useState)({}),y=m[0],_=m[1],b=(0,oM.useMemo)((function(){if(!c.disableJson&&p)try{return JSON.parse(p.data)}catch(hh){return lM.UNPARSABLE_JSON_OBJECT}return null}),[p,c.disableJson]),w=(0,oM.useRef)(null),E=(0,oM.useRef)(null),M=(0,oM.useRef)((function(){})),N=(0,oM.useRef)(0),P=(0,oM.useRef)(Date.now()),L=(0,oM.useRef)([]),j=(0,oM.useRef)(null),D=(0,oM.useRef)(c);D.current=c;var F=w.current&&void 0!==y[w.current]?y[w.current]:null!==l&&!0===d?lM.ReadyState.CONNECTING:lM.ReadyState.UNINSTANTIATED,U=c.queryParams?JSON.stringify(c.queryParams):null,B=(0,oM.useCallback)((function(l,c){var d;void 0===c&&(c=!0),lM.isEventSourceSupported&&E.current instanceof EventSource?console.warn("Unable to send a message from an eventSource"):(null===(d=E.current)||void 0===d?void 0:d.readyState)===lM.ReadyState.OPEN?((0,hM.assertIsWebSocket)(E.current,D.current.skipAssert),E.current.send(l)):c&&L.current.push(l)}),[]),H=(0,oM.useCallback)((function(l,c){void 0===c&&(c=!0),B(JSON.stringify(l),c)}),[B]),z=(0,oM.useCallback)((function(){return!0!==D.current.share||lM.isEventSourceSupported&&E.current instanceof EventSource?E.current:(null===j.current&&E.current&&((0,hM.assertIsWebSocket)(E.current,D.current.skipAssert),j.current=(0,dM.default)(E.current,M)),j.current)}),[]);return(0,oM.useEffect)((function(){if(null!==l&&!0===d){var c,h=!1,p=!0,start_1=function(){return nM(void 0,void 0,void 0,(function(){var d,m,y;return sM(this,(function(b){switch(b.label){case 0:return d=w,[4,(0,uM.getUrl)(l,D)];case 1:return d.current=b.sent(),null===w.current?(console.error("Failed to get a valid URL. WebSocket connection aborted."),w.current="ABORTED",(0,aM.flushSync)((function(){return _((function(l){return rM(rM({},l),{ABORTED:lM.ReadyState.CLOSED})}))})),[2]):(m=function(l){h||(0,aM.flushSync)((function(){return f(l)}))},y=function(l){h||(0,aM.flushSync)((function(){return _((function(c){var d;return rM(rM({},c),w.current&&((d={})[w.current]=l,d))}))}))},p&&(c=(0,cM.createOrJoinSocket)(E,w.current,y,D,m,M,N,P,B)),[2])}}))}))};return M.current=function(){h||(j.current&&(j.current=null),null==c||c(),start_1())},start_1(),function(){h=!0,p=!1,j.current&&(j.current=null),null==c||c(),f(null)}}null!==l&&!1!==d||(N.current=0,_((function(l){var c;return rM(rM({},l),w.current&&((c={})[w.current]=lM.ReadyState.CLOSED,c))})))}),[l,d,U,B]),(0,oM.useEffect)((function(){F===lM.ReadyState.OPEN&&L.current.splice(0).forEach((function(l){B(l)}))}),[F]),{sendMessage:B,sendJsonMessage:H,lastMessage:p,lastJsonMessage:b,readyState:F,getWebSocket:z}};var pM={},fM=sr&&sr.__assign||function(){return fM=Object.assign||function(l){for(var c,d=1,h=arguments.length;d<h;d++)for(var p in c=arguments[d])Object.prototype.hasOwnProperty.call(c,p)&&(l[p]=c[p]);return l},fM.apply(this,arguments)};Object.defineProperty(pM,"__esModule",{value:!0}),pM.useSocketIO=void 0;var mM=Gt,gM=kO,vM=CO,yM={type:"empty",payload:null};pM.useSocketIO=function(l,c,d){void 0===c&&(c=vM.DEFAULT_OPTIONS),void 0===d&&(d=!0);var h=(0,mM.useMemo)((function(){return fM(fM({},c),{fromSocketIO:!0})}),[]),p=(0,gM.useWebSocket)(l,h,d),f=p.sendMessage,m=p.sendJsonMessage,y=p.lastMessage,_=p.readyState,b=p.getWebSocket,w=(0,mM.useMemo)((function(){return function(l){if(!l||!l.data)return yM;var c=l.data.match(/\[.*]/);if(!c)return yM;var d=JSON.parse(c);return Array.isArray(d)&&d[1]?{type:d[0],payload:d[1]}:yM}(y)}),[y]);return{sendMessage:f,sendJsonMessage:m,lastMessage:w,lastJsonMessage:w,readyState:_,getWebSocket:b}};var _M={},bM=sr&&sr.__assign||function(){return bM=Object.assign||function(l){for(var c,d=1,h=arguments.length;d<h;d++)for(var p in c=arguments[d])Object.prototype.hasOwnProperty.call(c,p)&&(l[p]=c[p]);return l},bM.apply(this,arguments)},wM=sr&&sr.__rest||function(l,c){var d={};for(var h in l)Object.prototype.hasOwnProperty.call(l,h)&&c.indexOf(h)<0&&(d[h]=l[h]);if(null!=l&&"function"==typeof Object.getOwnPropertySymbols){var p=0;for(h=Object.getOwnPropertySymbols(l);p<h.length;p++)c.indexOf(h[p])<0&&Object.prototype.propertyIsEnumerable.call(l,h[p])&&(d[h[p]]=l[h[p]])}return d};Object.defineProperty(_M,"__esModule",{value:!0}),_M.useEventSource=void 0;var SM=Gt,xM=kO,kM=CO;_M.useEventSource=function(l,c,d){void 0===c&&(c=kM.DEFAULT_EVENT_SOURCE_OPTIONS);var h=c.withCredentials,p=c.events,f=wM(c,["withCredentials","events"]);void 0===d&&(d=!0);var m=bM(bM({},f),{eventSourceOptions:{withCredentials:h}}),y=(0,SM.useRef)(kM.EMPTY_EVENT_HANDLERS);p&&(y.current=p);var _=(0,xM.useWebSocket)(l,m,d),b=_.lastMessage,w=_.readyState,E=_.getWebSocket;return(0,SM.useEffect)((function(){(null==b?void 0:b.type)&&Object.entries(y.current).forEach((function(l){var c=l[0],d=l[1];c===b.type&&d(b)}))}),[b]),{lastEvent:b,readyState:w,getEventSource:E}},function(l){Object.defineProperty(l,"__esModule",{value:!0}),l.resetGlobalState=l.useEventSource=l.ReadyState=l.useSocketIO=l.default=void 0;var c=kO;Object.defineProperty(l,"default",{enumerable:!0,get:function(){return c.useWebSocket}});var d=pM;Object.defineProperty(l,"useSocketIO",{enumerable:!0,get:function(){return d.useSocketIO}});var h=CO;Object.defineProperty(l,"ReadyState",{enumerable:!0,get:function(){return h.ReadyState}});var p=_M;Object.defineProperty(l,"useEventSource",{enumerable:!0,get:function(){return p.useEventSource}});var f=NO;Object.defineProperty(l,"resetGlobalState",{enumerable:!0,get:function(){return f.resetGlobalState}})}(xO);const CM=wr(xO),EM=Gt.createContext(null),WebSocketProvider=({url:l,children:c,options:d={},params:h={}})=>{const p=Gt.useRef(new Map),[f,m]=Gt.useState(!1),y=Gt.useRef(void 0),_=Gt.useRef(null),b=Gt.useRef(new Map),w=Gt.useRef(null),[E,M]=Gt.useState({url:l,options:d,params:{force_connect:"false",...h}}),{sendMessage:N,lastMessage:P,readyState:L,getWebSocket:j}=CM(E?.url??null,{shouldReconnect:l=>"true"!==E?.params?.force_connect&&(!f&&(E?.options?.shouldReconnect??!0)),queryParams:E?.params||{},reconnectAttempts:E?.options?.reconnectAttempts??30,reconnectInterval:E?.options?.reconnectInterval??3e3,retryOnError:E?.options?.retryOnError??!0,onMessage:l=>{try{const c=JSON.parse(l.data),{type:d,...h}=c;if("ack"===d&&c.event_uid){const l=b.current.get(c.event_uid);return void(l&&(clearTimeout(l.timeoutId),b.current.delete(c.event_uid),l.resolve(c.event_uid)))}d.includes("batch")&&console.log(`Received batch message: ${d}`,c);const f=p.current.get(d);f&&f.forEach((l=>{try{l(c)}catch(h){console.error(`Error in event listener for ${d}:`,h)}}))}catch(c){console.error("Failed to parse WebSocket message:",c)}},onOpen:()=>{m(!1),w.current&&(clearTimeout(w.current.timeoutId),w.current.resolve(),w.current=null)},onClose:()=>{console.log("WebSocket closed"),w.current&&(clearTimeout(w.current.timeoutId),w.current.reject(new Error("WebSocket connection closed")),w.current=null),b.current.forEach((l=>{clearTimeout(l.timeoutId),l.reject(new Error("WebSocket connection closed"))})),b.current.clear(),"true"===E?.params?.force_connect&&setTimeout((()=>{M((l=>l?{url:l.url,options:l.options,params:{...l.params,force_connect:"false"}}:null))}),5e3)},onError:()=>{w.current&&(clearTimeout(w.current.timeoutId),w.current.reject(new Error("WebSocket connection error")),w.current=null)}}),D=Gt.useCallback((async(l=!0)=>{const c=j()?.readyState;if(!c||[xO.ReadyState.CLOSED,xO.ReadyState.CLOSING,xO.ReadyState.UNINSTANTIATED].includes(c))return;m(l),j()?.close(),M((l=>l?{...l,url:null,params:{...l.params,force_connect:"false"}}:null));const d=Date.now();for(;![xO.ReadyState.CLOSED,xO.ReadyState.UNINSTANTIATED,void 0].includes(j()?.readyState);)if(await new Promise((l=>setTimeout(l,200))),Date.now()-d>5e3)return}),[j]),F=Gt.useCallback((async c=>{const d=c?.url??l,h=j()?.readyState||xO.ReadyState.UNINSTANTIATED;return d!==E?.url||y.current&&c?.connect_from!==y.current||"true"===c.params?.force_connect||![xO.ReadyState.CONNECTING,xO.ReadyState.OPEN].includes(h)?new Promise(((l,p)=>{(async()=>{try{await D(!1),y.current=c?.connect_from??y.current??"build";const f=Date.now();for(;![xO.ReadyState.CLOSED,xO.ReadyState.UNINSTANTIATED].includes(h);)if(await new Promise((l=>setTimeout(l,200))),Date.now()-f>5e3){m(!0);break}const _=setTimeout((()=>{w.current&&(w.current.reject(new Error("Reconnection timeout - connection not established within 10 seconds")),w.current=null)}),1e4);w.current={resolve:l,reject:p,timeoutId:_};const b=c?.options;M((l=>({url:d,options:{...l?.options||{},...b},params:{...l?.params||{},...c?.params}})))}catch(f){p(f instanceof Error?f:new Error("Reconnection failed"))}})()})):(y.current||(y.current=c?.connect_from),Promise.resolve())}),[l,E,D,j]),U=Gt.useCallback(((l,c,d)=>{N(JSON.stringify({type:l,...c})),d&&d(c)}),[N]),B=Gt.useCallback(((l,c)=>{p.current.has(l)||p.current.set(l,new Set);const d=p.current.get(l);return d.add(c),()=>{d.delete(c),0===d.size&&p.current.delete(l)}}),[]),H=Gt.useCallback(((l,c,d={})=>new Promise(((h,p)=>{if(L!==xO.ReadyState.OPEN)return void p(new Error("WebSocket connection is not open"));const f=nanoid(),m=d.timeout??500,y=setTimeout((()=>{b.current.delete(f),p(new Error(`Message acknowledgment timeout after ${m}ms`))}),m);b.current.set(f,{event_uid:f,timeoutId:y,resolve:h,reject:p});const _={event_uid:f,type:l,timestamp:Date.now(),payload:c};try{N(JSON.stringify(_))}catch(w){clearTimeout(y),b.current.delete(f),p(new Error("Failed to send message"))}}))),[L,N]),z=Gt.useCallback(((l,c)=>{const d={tool_calls:l,session_id:c,batch_id:nanoid(),timestamp:Date.now()};return console.log("Sending tool calls batch:",d),H("confirmit_tool_calls_batch",d)}),[H]),q=Gt.useCallback((l=>B("tool_calls_batch_progress",l)),[B]),V=Gt.useCallback((l=>B("tool_calls_batch_completed",l)),[B]);Gt.useEffect((()=>()=>{w.current&&(clearTimeout(w.current.timeoutId),w.current=null),b.current.forEach((l=>{clearTimeout(l.timeoutId)})),b.current.clear()}),[]);const Z=Gt.useMemo((()=>({sendEvent:U,sendReliableEvent:H,subscribe:B,lastMessage:P,readyState:L,getWebSocket:j,closeConnection:D,manualClose:f,reconnect:F,sendToolCallsBatch:z,subscribeToBatchProgress:q,subscribeToBatchCompletion:V})),[U,H,B,P,L,j,D,f,F,z,q,V]),K=Gt.useCallback((()=>{_.current&&clearInterval(_.current),L===xO.ReadyState.OPEN&&(_.current=setInterval((()=>{L===xO.ReadyState.OPEN&&U("ping",{timestamp:Date.now(),uid:nanoid()})}),5e3))}),[L,U]),Y=Gt.useCallback((()=>{_.current&&(clearInterval(_.current),_.current=null)}),[]);return Gt.useEffect((()=>(L===xO.ReadyState.OPEN?K():Y(),()=>{Y()})),[L,K,Y]),Kt.jsx(EM.Provider,{value:Z,children:c})},useWebSocketContext=()=>{const l=Gt.useContext(EM);if(!l)throw new Error("useWebSocketContext must be used within a WebSocketProvider");return l},useWebSocketEvent=(l,c)=>{const{subscribe:d}=useWebSocketContext(),h=Gt.useCallback(c,[c]);Gt.useEffect((()=>{const c=d(l,h);return()=>{c()}}),[l,h,d])},IM={open:"data:image/svg+xml,%3csvg%20data-testid='node-icon'%20xmlns='http://www.w3.org/2000/svg'%20width='24'%20height='24'%20viewBox='0%200%2024%2024'%20class='comd-icon__UE1EA6FF%20comd-survey-node-icon__VZtfWa'%20fill='%23007db8'%20data-test-node-icon='open'%3e%3cpath%20d='M12,3%20C17.5,3%2022,6.58%2022,11%20C22,15.42%2017.5,19%2012,19%20C10.81,19%209.61,18.83%208.47,18.5%20C6.64,20%204.37,20.89%202,21%20C4.33,18.67%204.75,17.1%204.75,16.5%20C3.06,15.17%202.05,13.15%202,11%20C2,6.58%206.5,3%2012,3%20Z%20M12,5%20C7.58,5%204,7.69%204,11%20C4,14.31%207.58,17%2012,17%20C16.42,17%2020,14.31%2020,11%20C20,7.69%2016.42,5%2012,5%20Z%20M15.7456,8%20C15.8546,8%2015.9636,8.109%2015.9636,8.109%20L15.9636,8.109%20L15.9636,10.618%20C15.9636,11.818%2015.7456,12.69%2015.2006,13.236%20C14.6546,13.782%2013.9996,14%2013.2366,14%20C13.2366,14%2013.1276,14%2013.1276,13.891%20L13.1276,13.891%20L13.1276,12.909%20C13.1276,12.909%2013.1276,12.8%2013.2366,12.8%20C13.8916,12.8%2014.2186,12.363%2014.2186,11.491%20L14.2186,11.491%20L14.2186,11.055%20L12.6906,11.055%20C12.6906,11.055%2012.5816,11.055%2012.5816,10.945%20L12.5816,10.945%20L12.5816,8.109%20C12.5816,8.109%2012.5816,8%2012.6906,8%20L12.6906,8%20Z%20M11.1636,8%20C11.2726,8%2011.2726,8.109%2011.3816,8.109%20L11.3816,8.109%20L11.3816,10.618%20C11.3816,11.818%2011.0546,12.69%2010.6186,13.236%20C10.0726,13.782%209.4176,14%208.6546,14%20C8.5456,14%208.5456,14%208.5456,13.891%20L8.5456,13.891%20L8.5456,12.909%20C8.5456,12.909%208.5456,12.8%208.6546,12.8%20C9.3086,12.8%209.6366,12.363%209.6366,11.491%20L9.6366,11.491%20L9.6366,11.055%20L8.1086,11.055%20C7.9996,11.055%207.9996,11.055%207.9996,10.945%20L7.9996,10.945%20L7.9996,8.109%20C7.9996,8.109%207.9996,8%208.1086,8%20L8.1086,8%20Z'%3e%3c/path%3e%3c/svg%3e",multiopen:"data:image/svg+xml,%3csvg%20data-testid='node-icon'%20xmlns='http://www.w3.org/2000/svg'%20width='24'%20height='24'%20viewBox='0%200%2024%2024'%20class='comd-icon__UE1EA6FF%20comd-survey-node-icon__VZtfWa'%20fill='%23007db8'%20data-test-node-icon='multiopen'%3e%3cpath%20d='M20.9648,9.5683%20C22.2358,10.7753%2022.9998,12.3183%2022.9998,14.0003%20C22.9998,17.8663%2018.9708,21.0003%2013.9998,21.0003%20C12.8638,21.0003%2011.7818,20.8293%2010.7808,20.5313%20L10.781,20.531%20L10.4935529,20.7454124%20C9.03458689,21.7896236%207.31370861,22.4363639%205.51296059,22.586025%20L5.1518,22.6093%20C6.9348,20.8483%207.4708,19.5823%207.5918,18.9123%20C7.0328,18.4703%206.5528,17.9683%206.1588,17.4243%20C7.2958,17.7713%208.5178,17.9723%209.7968,17.9913%20C10.9678,18.6223%2012.4208,19.0003%2013.9998,19.0003%20C17.8658,19.0003%2020.9998,16.7613%2020.9998,14.0003%20C20.9998,13.2693%2020.7758,12.5783%2020.3818,11.9533%20C20.7028,11.1983%2020.9018,10.3993%2020.9648,9.5683%20Z%20M10,2%20C14.971,2%2019,5.134%2019,9%20C19,12.866%2014.971,16%2010,16%20C8.864,16%207.782,15.829%206.781,15.531%20L6.782,15.53%20L6.4937529,15.7451221%20C5.03478689,16.789428%203.31390861,17.4369041%201.51316059,17.5858813%20L1.152,17.609%20C2.935,15.849%203.471,14.582%203.592,13.912%20C1.991,12.648%201,10.915%201,9%20C1,5.134%205.029,2%2010,2%20Z%20M10,4%20C6.134,4%203,6.238%203,9%20C3,11.762%206.134,14%2010,14%20C13.866,14%2017,11.762%2017,9%20C17,6.238%2013.866,4%2010,4%20Z%20M13.3184,7%20C13.4094,7%2013.5004,7.091%2013.5004,7.091%20L13.5004,7.091%20L13.5004,9.182%20C13.5004,10.182%2013.3184,10.909%2012.8634,11.363%20C12.4094,11.818%2011.8634,12%2011.2274,12%20C11.2274,12%2011.1364,12%2011.1364,11.909%20L11.1364,11.909%20L11.1364,11.091%20C11.1364,11.091%2011.1364,11%2011.2274,11%20C11.7734,11%2012.0454,10.637%2012.0454,9.909%20L12.0454,9.909%20L12.0454,9.546%20L10.763832,9.545264%20C10.74028,9.54232%2010.6814,9.5276%2010.6814,9.454%20L10.6814,9.454%20L10.6814,7.091%20C10.6814,7.091%2010.6814,7%2010.7734,7%20L10.7734,7%20Z%20M9.1364,7%20C9.2274,7%209.2274,7.091%209.3184,7.091%20L9.3184,7.091%20L9.3184,9.182%20C9.3184,10.182%209.0454,10.909%208.6814,11.363%20C8.2274,11.818%207.6814,12%207.0454,12%20C6.9544,12%206.9544,12%206.9544,11.909%20L6.9544,11.909%20L6.9544,11.091%20C6.9544,11.091%206.9544,11%207.0454,11%20C7.5904,11%207.8634,10.637%207.8634,9.909%20L7.8634,9.909%20L7.8634,9.546%20L6.54648,9.545264%20C6.5004,9.54232%206.5004,9.5276%206.5004,9.454%20L6.5004,9.454%20L6.5004,7.091%20C6.5004,7.091%206.5004,7%206.5904,7%20L6.5904,7%20Z'%3e%3c/path%3e%3c/svg%3e",info:"data:image/svg+xml,%3csvg%20data-testid='node-icon'%20xmlns='http://www.w3.org/2000/svg'%20width='24'%20height='24'%20viewBox='0%200%2024%2024'%20class='comd-icon__UE1EA6FF%20comd-survey-node-icon__VZtfWa'%20fill='%23007db8'%20data-test-node-icon='info'%3e%3cpath%20d='M12,2%20C17.556,2%2022,6.444%2022,12%20C22,17.556%2017.556,22%2012,22%20C6.444,22%202,17.556%202,12%20C2,6.444%206.444,2%2012,2%20Z%20M10,17%20C8.685,17%208.685,19%2010,19%20L15,19%20C16.315,19%2016.315,17%2015,17%20L14,17%20L14,12%20C14.002,11.642%2013.911,11.439%2013.764,11.276%20C13.596,11.088%2013.35,10.97%2013.014,11%20L10,11%20C9,11%209,12%209,12%20C9,12%209,13%2010,13%20L11,13%20L11,17%20L10,17%20Z%20M12,5%20C11,5%2010,5.9%2010,7%20C10,8.1%2010.9,9%2012,9%20C13.1,9%2014,8.1%2014,7%20C14,5.9%2013.1,5%2012,5%20Z'%3e%3c/path%3e%3c/svg%3e",date:"data:image/svg+xml,%3csvg%20data-testid='node-icon'%20xmlns='http://www.w3.org/2000/svg'%20width='24'%20height='24'%20viewBox='0%200%2024%2024'%20class='comd-icon__UE1EA6FF%20comd-survey-node-icon__VZtfWa'%20fill='%23007db8'%20data-test-node-icon='date'%3e%3cpath%20d='M7,10H12V15H7M19,19H5V8H19M19,3H18V1H16V3H8V1H6V3H5C3.89,3%203,3.9%203,5V19A2,2%200%200,0%205,21H19A2,2%200%200,0%2021,19V5A2,2%200%200,0%2019,3Z'%3e%3c/path%3e%3c/svg%3e",single:"data:image/svg+xml,%3csvg%20data-testid='node-icon'%20xmlns='http://www.w3.org/2000/svg'%20width='24'%20height='24'%20viewBox='0%200%2024%2024'%20class='comd-icon__UE1EA6FF%20comd-survey-node-icon__VZtfWa'%20fill='%23007db8'%20data-test-node-icon='single'%3e%3cpath%20d='M12,3%20C17,3%2021,7%2021,12%20C21,17%2017,21%2012,21%20C7,21%203,17%203,12%20C3,7%207,3%2012,3%20Z%20M12,5%20C8,5%205,8%205,12%20C5,16%208,19%2012,19%20C16,19%2019,16%2019,12%20C19,8%2016,5%2012,5%20Z%20M12,9%20C13.6568542,9%2015,10.3431458%2015,12%20C15,13.6568542%2013.6568542,15%2012,15%20C10.3431458,15%209,13.6568542%209,12%20C9,10.3431458%2010.3431458,9%2012,9%20Z'%3e%3c/path%3e%3c/svg%3e",singlewithlookup:"data:image/svg+xml,%3csvg%20data-testid='node-icon'%20xmlns='http://www.w3.org/2000/svg'%20width='24'%20height='24'%20viewBox='0%200%2024%2024'%20class='comd-icon__UE1EA6FF%20comd-survey-node-icon__VZtfWa'%20fill='%23007db8'%20data-test-node-icon='singlewithlookup'%3e%3cpath%20d='M3,3H9V7H3V3M15,10H21V14H15V10M15,17H21V21H15V17M13,13H7V18H13V20H7L5,20V9H7V11H13V13Z'%3e%3c/path%3e%3c/svg%3e",multi:"data:image/svg+xml,%3csvg%20data-testid='node-icon'%20xmlns='http://www.w3.org/2000/svg'%20width='24'%20height='24'%20viewBox='0%200%2024%2024'%20class='comd-icon__UE1EA6FF%20comd-survey-node-icon__VZtfWa'%20fill='%23007db8'%20data-test-node-icon='multi'%3e%3cpath%20d='M8.6,3%20C5.5,3%203,5.5%203,8.6%20L3,15.3%20C3,18.5%205.5,21%208.6,21%20L15.3,21%20C18.4,21%2020.9,18.5%2020.9,15.4%20L20.9,8.6%20C21,5.5%2018.5,3%2015.4,3%20L8.6,3%20Z%20M17.3,9.4%20C17.4,9.5%2017.4,9.6%2017.3,9.7%20L10.6,16.4%20C10.5,16.5%2010.4,16.5%2010.3,16.4%20L6.7,13%20C6.6,12.9%206.6,12.8%206.7,12.6%20L8.3,11%20C8.4,11%208.5,11%208.6,11.1%20L9.8,12.5%20C9.9,12.6%2010,12.6%2010.2,12.5%20L15,7.8%20C15.1,7.7%2015.2,7.7%2015.4,7.8%20L17.3,9.4%20Z'%3e%3c/path%3e%3c/svg%3e",numeric:"data:image/svg+xml,%3csvg%20data-testid='node-icon'%20xmlns='http://www.w3.org/2000/svg'%20width='24'%20height='24'%20viewBox='0%200%2024%2024'%20class='comd-icon__UE1EA6FF%20comd-survey-node-icon__VZtfWa'%20fill='%23007db8'%20data-test-node-icon='numeric'%3e%3cpath%20d='M15,3%20L14.556,7%20L10.556,7%20L11,3%20L8.001,3%20L7.556,7%20L4,7%20L4,10%20L7.222,10%20L6.779,14%20L3,14%20L3,17%20L6.445,17%20L6,21%20L9.001,21%20L9.444,17%20L13.445,17%20L13,21%20L16,21%20L16.445,17%20L20,17%20L20,14%20L16.778,14%20L17.222,10%20L21,10%20L21,7%20L17.556,7%20L18.001,3%20L15,3%20Z%20M10.223,10%20L14.222,10%20L13.778,14%20L9.778,14%20L10.223,10%20Z'%3e%3c/path%3e%3c/svg%3e",multiopennumeric:"data:image/svg+xml,%3csvg%20data-testid='node-icon'%20xmlns='http://www.w3.org/2000/svg'%20width='24'%20height='24'%20viewBox='0%200%2024%2024'%20class='comd-icon__UE1EA6FF%20comd-survey-node-icon__VZtfWa'%20fill='%23007db8'%20data-test-node-icon='multiopennumeric'%3e%3cpath%20d='M23,5%20L23,21%20C23,22.104%2022.104,23%2021,23%20L5,23%20L5,21%20L21,21%20L21,5%20L23,5%20Z%20M11.1665,9%20L10.8335,11%20L8.8335,11%20L9.1665,9%20L11.1665,9%20Z%20M16,9%20L13.167,9%20L12.833,11%20L15,11%20L15,13%20L12.5,13%20L12,16%20L10,16%20L10.5,13%20L8.5,13%20L8,16%20L6,16%20L6.5,13%20L4,13%20L4,11%20L6.833,11%20L7.167,9%20L5,9%20L5,7%20L7.5,7%20L8,4%20L10,4%20L9.5,7%20L11.5,7%20L12,4%20L14,4%20L13.5,7%20L16,7%20L16,9%20Z%20M17,1%20L3,1%20C1.896,1%201,1.896%201,3%20L1,17%20C1,18.104%201.896,19%203,19%20L17,19%20C18.104,19%2019,18.104%2019,17%20L19,3%20C19,1.896%2018.104,1%2017,1%20L17,1%20Z'%3e%3c/path%3e%3c/svg%3e",multiordered:"data:image/svg+xml,%3csvg%20data-testid='node-icon'%20xmlns='http://www.w3.org/2000/svg'%20width='24'%20height='24'%20viewBox='0%200%2024%2024'%20class='comd-icon__UE1EA6FF%20comd-survey-node-icon__VZtfWa'%20fill='%23007db8'%20data-test-node-icon='multiordered'%3e%3cpath%20d='M20.2,4H20H17V2H7V4H4.5H3.8H2V11C2,12%203,13%204,13H7.2C7.6,14.9%208.6,16.6%2011,16.9V19C8,19.2%208,20.3%208,21.6V22H16V21.7C16,20.4%2016,19.3%2013,19.1V17C15.5,16.7%2016.5,15%2016.8,13.1H20C21,13.1%2022,12.1%2022,11.1V4H20.2M4,11V6H7V8V11C5.6,11%204.4,11%204,11M20,11C19.6,11%2018.4,11%2017,11V6H18H20V11Z'%3e%3c/path%3e%3c/svg%3e",grid:"data:image/svg+xml,%3csvg%20data-testid='node-icon'%20xmlns='http://www.w3.org/2000/svg'%20width='24'%20height='24'%20viewBox='0%200%2024%2024'%20class='comd-icon__UE1EA6FF%20comd-survey-node-icon__VZtfWa'%20fill='%23007db8'%20data-test-node-icon='grid'%3e%3cpath%20d='M13,2.0002%20L13,11.0002%20L22,11.0002%20L22,13.0002%20L13,13.0002%20L13,22.0002%20L11,22.0002%20L11,13.0002%20L2,13.0002%20L2,11.0002%20L11,11.0002%20L11,2.0002%20L13,2.0002%20Z%20M18,15%20C19.657,15%2021,16.343%2021,18%20C21,19.657%2019.657,21%2018,21%20C16.343,21%2015,19.657%2015,18%20C15,16.343%2016.343,15%2018,15%20Z%20M6,15%20C7.657,15%209,16.343%209,18%20C9,19.657%207.657,21%206,21%20C4.343,21%203,19.657%203,18%20C3,16.343%204.343,15%206,15%20Z%20M18,3%20C19.657,3%2021,4.343%2021,6%20C21,7.657%2019.657,9%2018,9%20C16.343,9%2015,7.657%2015,6%20C15,4.343%2016.343,3%2018,3%20Z%20M6,3%20C7.657,3%209,4.343%209,6%20C9,7.657%207.657,9%206,9%20C4.343,9%203,7.657%203,6%20C3,4.343%204.343,3%206,3%20Z'%3e%3c/path%3e%3c/svg%3e",multigrid:"data:image/svg+xml,%3csvg%20data-testid='node-icon'%20xmlns='http://www.w3.org/2000/svg'%20width='24'%20height='24'%20viewBox='0%200%2024%2024'%20class='comd-icon__UE1EA6FF%20comd-survey-node-icon__VZtfWa'%20fill='%23007db8'%20data-test-node-icon='multigrid'%3e%3cpath%20d='M13,2.0002%20L13,11.0002%20L22,11.0002%20L22,13.0002%20L13,13.0002%20L13,22.0002%20L11,22.0002%20L11,13.0002%20L2,13.0002%20L2,11.0002%20L11,11.0002%20L11,2.0002%20L13,2.0002%20Z%20M8.3637,14.6353%20L9.7787,16.0503%20L4.8287,21.0003%20L1.9997,18.1723%20L3.4137,16.7573%20L4.8287,18.1723%20L8.3637,14.6353%20Z%20M20.5857,14.6353%20L21.9997,16.0503%20L17.0507,21.0003%20L14.2217,18.1723%20L15.6357,16.7573%20L17.0507,18.1723%20L20.5857,14.6353%20Z%20M8.3637,2.6357%20L9.7787,4.0497%20L4.8287,9.0007%20L1.9997,6.1717%20L3.4137,4.7577%20L4.8287,6.1717%20L8.3637,2.6357%20Z%20M20.5857,2.6357%20L21.9997,4.0497%20L17.0507,9.0007%20L14.2217,6.1717%20L15.6357,4.7577%20L17.0507,6.1717%20L20.5857,2.6357%20Z'%3e%3c/path%3e%3c/svg%3e","3dgrid":"data:image/svg+xml,%3csvg%20data-testid='node-icon'%20xmlns='http://www.w3.org/2000/svg'%20width='24'%20height='24'%20viewBox='0%200%2024%2024'%20class='comd-icon__UE1EA6FF%20comd-survey-node-icon__VZtfWa'%20fill='%23007db8'%20data-test-node-icon='3dgrid'%3e%3cpath%20d='M13,2.0002%20L13,11.0002%20L22,11.0002%20L22,13.0002%20L13,13.0002%20L13,22.0002%20L11,22.0002%20L11,13.0002%20L2,13.0002%20L2,11.0002%20L11,11.0002%20L11,2.0002%20L13,2.0002%20Z%20M18,15%20C19.657,15%2021,16.343%2021,18%20C21,19.657%2019.657,21%2018,21%20C16.343,21%2015,19.657%2015,18%20C15,16.343%2016.343,15%2018,15%20Z%20M8.3636,14.636%20L9.7786,16.05%20L4.8286,21%20L1.9996,18.172%20L3.4136,16.758%20L4.8286,18.172%20L8.3636,14.636%20Z%20M18,3%20C19.657,3%2021,4.343%2021,6%20C21,7.657%2019.657,9%2018,9%20C16.343,9%2015,7.657%2015,6%20C15,4.343%2016.343,3%2018,3%20Z%20M8.3636,2.636%20L9.7786,4.05%20L4.8286,9%20L1.9996,6.172%20L3.4136,4.758%20L4.8286,6.172%20L8.3636,2.636%20Z'%3e%3c/path%3e%3c/svg%3e",imageupload:"data:image/svg+xml,%3csvg%20data-testid='node-icon'%20xmlns='http://www.w3.org/2000/svg'%20width='24'%20height='24'%20viewBox='0%200%2024%2024'%20class='comd-icon__UE1EA6FF%20comd-survey-node-icon__VZtfWa'%20fill='%23007db8'%20data-test-node-icon='imageupload'%3e%3cpath%20d='M19,19H5V5H19M19,3H5A2,2%200%200,0%203,5V19A2,2%200%200,0%205,21H19A2,2%200%200,0%2021,19V5A2,2%200%200,0%2019,3M13.96,12.29L11.21,15.83L9.25,13.47L6.5,17H17.5L13.96,12.29Z'%3e%3c/path%3e%3c/svg%3e",audiocapture:"data:image/svg+xml,%3csvg%20data-testid='node-icon'%20xmlns='http://www.w3.org/2000/svg'%20width='24'%20height='24'%20viewBox='0%200%2024%2024'%20class='comd-icon__UE1EA6FF%20comd-survey-node-icon__VZtfWa'%20fill='%23007db8'%20data-test-node-icon='audiocapture'%3e%3cpath%20d='M12,2A3,3%200%200,1%2015,5V11A3,3%200%200,1%2012,14A3,3%200%200,1%209,11V5A3,3%200%200,1%2012,2M19,11C19,14.53%2016.39,17.44%2013,17.93V21H11V17.93C7.61,17.44%205,14.53%205,11H7A5,5%200%200,0%2012,16A5,5%200%200,0%2017,11H19Z'%3e%3c/path%3e%3c/svg%3e",videocapture:"data:image/svg+xml,%3csvg%20data-testid='node-icon'%20xmlns='http://www.w3.org/2000/svg'%20width='24'%20height='24'%20viewBox='0%200%2024%2024'%20class='comd-icon__UE1EA6FF%20comd-survey-node-icon__VZtfWa'%20fill='%23007db8'%20data-test-node-icon='videocapture'%3e%3cpath%20d='M17,10.5V7A1,1%200%200,0%2016,6H4A1,1%200%200,0%203,7V17A1,1%200%200,0%204,18H16A1,1%200%200,0%2017,17V13.5L21,17.5V6.5L17,10.5Z'%3e%3c/path%3e%3c/svg%3e",codecapture:"data:image/svg+xml,%3csvg%20data-testid='node-icon'%20xmlns='http://www.w3.org/2000/svg'%20width='24'%20height='24'%20viewBox='0%200%2024%2024'%20class='comd-icon__UE1EA6FF%20comd-survey-node-icon__VZtfWa'%20fill='%23007db8'%20data-test-node-icon='codecapture'%3e%3cpath%20d='M4,6H6V18H4V6M7,6H8V18H7V6M9,6H12V18H9V6M13,6H14V18H13V6M16,6H18V18H16V6M19,6H20V18H19V6M2,4V8H0V4A2,2%200%200,1%202,2H6V4H2M22,2A2,2%200%200,1%2024,4V8H22V4H18V2H22M2,16V20H6V22H2A2,2%200%200,1%200,20V16H2M22,20V16H24V20A2,2%200%200,1%2022,22H18V20H22Z'%3e%3c/path%3e%3c/svg%3e",geolocation:"data:image/svg+xml,%3csvg%20data-testid='node-icon'%20xmlns='http://www.w3.org/2000/svg'%20width='24'%20height='24'%20viewBox='0%200%2024%2024'%20class='comd-icon__UE1EA6FF%20comd-survey-node-icon__VZtfWa'%20fill='%23007db8'%20data-test-node-icon='geolocation'%3e%3cpath%20d='M12,11.5A2.5,2.5%200%200,1%209.5,9A2.5,2.5%200%200,1%2012,6.5A2.5,2.5%200%200,1%2014.5,9A2.5,2.5%200%200,1%2012,11.5M12,2A7,7%200%200,0%205,9C5,14.25%2012,22%2012,22C12,22%2019,14.25%2019,9A7,7%200%200,0%2012,2Z'%3e%3c/path%3e%3c/svg%3e"},TM={folder:"data:image/svg+xml,%3csvg%20data-testid='node-icon'%20xmlns='http://www.w3.org/2000/svg'%20width='24'%20height='24'%20viewBox='0%200%2024%2024'%20class='comd-icon__UE1EA6FF%20comd-survey-node-icon__VZtfWa'%20fill='%23ffb84c'%20data-test-node-icon='folder'%3e%3cpath%20d='M10,4H4C2.89,4%202,4.89%202,6V18A2,2%200%200,0%204,20H20A2,2%200%200,0%2022,18V8C22,6.89%2021.1,6%2020,6H12L10,4Z'%3e%3c/path%3e%3c/svg%3e",page:"data:image/svg+xml,%3csvg%20data-testid='node-icon'%20xmlns='http://www.w3.org/2000/svg'%20width='24'%20height='24'%20viewBox='0%200%2024%2024'%20class='comd-icon__UE1EA6FF%20comd-survey-node-icon__VZtfWa'%20fill='%2300bae0'%20data-test-node-icon='page'%3e%3cpath%20d='M13,9V3.5L18.5,9M6,2C4.89,2%204,2.89%204,4V20A2,2%200%200,0%206,22H18A2,2%200%200,0%2020,20V8L14,2H6Z'%3e%3c/path%3e%3c/svg%3e",block:"data:image/svg+xml,%3csvg%20data-testid='node-icon'%20xmlns='http://www.w3.org/2000/svg'%20width='24'%20height='24'%20viewBox='0%200%2024%2024'%20class='comd-icon__UE1EA6FF%20comd-survey-node-icon__VZtfWa'%20fill='%23008473'%20data-test-node-icon='block'%3e%3cpath%20d='M21,16.5C21,16.88%2020.79,17.21%2020.47,17.38L12.57,21.82C12.41,21.94%2012.21,22%2012,22C11.79,22%2011.59,21.94%2011.43,21.82L3.53,17.38C3.21,17.21%203,16.88%203,16.5V7.5C3,7.12%203.21,6.79%203.53,6.62L11.43,2.18C11.59,2.06%2011.79,2%2012,2C12.21,2%2012.41,2.06%2012.57,2.18L20.47,6.62C20.79,6.79%2021,7.12%2021,7.5V16.5M12,4.15L6.04,7.5L12,10.85L17.96,7.5L12,4.15Z'%3e%3c/path%3e%3c/svg%3e",callblock:"data:image/svg+xml,%3csvg%20data-testid='node-icon'%20xmlns='http://www.w3.org/2000/svg'%20width='24'%20height='24'%20viewBox='0%200%2024%2024'%20class='comd-icon__UE1EA6FF%20comd-survey-node-icon__VZtfWa'%20fill='%23008473'%20data-test-node-icon='callblock'%3e%3cpath%20d='M21,16.5C21,16.88%2020.79,17.21%2020.47,17.38L12.57,21.82C12.41,21.94%2012.21,22%2012,22C11.79,22%2011.59,21.94%2011.43,21.82L3.53,17.38C3.21,17.21%203,16.88%203,16.5V7.5C3,7.12%203.21,6.79%203.53,6.62L11.43,2.18C11.59,2.06%2011.79,2%2012,2C12.21,2%2012.41,2.06%2012.57,2.18L20.47,6.62C20.79,6.79%2021,7.12%2021,7.5V16.5M12,4.15L6.04,7.5L12,10.85L17.96,7.5L12,4.15M5,15.91L11,19.29V12.58L5,9.21V15.91M19,15.91V9.21L13,12.58V19.29L19,15.91Z'%3e%3c/path%3e%3c/svg%3e",loop:"data:image/svg+xml,%3csvg%20data-testid='node-icon'%20xmlns='http://www.w3.org/2000/svg'%20width='24'%20height='24'%20viewBox='0%200%2024%2024'%20class='comd-icon__UE1EA6FF%20comd-survey-node-icon__VZtfWa'%20fill='%2300bae0'%20data-test-node-icon='loop'%3e%3cpath%20d='M12,18A6,6%200%200,1%206,12C6,11%206.25,10.03%206.7,9.2L5.24,7.74C4.46,8.97%204,10.43%204,12A8,8%200%200,0%2012,20V23L16,19L12,15M12,4V1L8,5L12,9V6A6,6%200%200,1%2018,12C18,13%2017.75,13.97%2017.3,14.8L18.76,16.26C19.54,15.03%2020,13.57%2020,12A8,8%200%200,0%2012,4Z'%3e%3c/path%3e%3c/svg%3e",conditionif:"data:image/svg+xml,%3csvg%20data-testid='node-icon'%20xmlns='http://www.w3.org/2000/svg'%20width='24'%20height='24'%20viewBox='0%200%2024%2024'%20class='comd-icon__UE1EA6FF%20comd-survey-node-icon__VZtfWa'%20fill='%23ff6f00'%20data-test-node-icon='condition'%3e%3cpath%20d='M14.236,6.201l-8.236,0l0,9l-4,0l0,7l10,0l0,-7l-4,0l0,-7l6.092,0l3.706,4.373l4.202,-5.286l-4.202,-5.288l-3.562,4.201Z'%3e%3c/path%3e%3c/svg%3e",script:"data:image/svg+xml,%3csvg%20data-testid='node-icon'%20xmlns='http://www.w3.org/2000/svg'%20width='24'%20height='24'%20viewBox='0%200%2024%2024'%20class='comd-icon__UE1EA6FF%20comd-survey-node-icon__VZtfWa'%20fill='%23d34e0a'%20data-test-node-icon='script'%3e%3cpath%20d='M15,20A1,1%200%200,0%2016,19V4H8A1,1%200%200,0%207,5V16H5V5A3,3%200%200,1%208,2H19A3,3%200%200,1%2022,5V6H20V5A1,1%200%200,0%2019,4A1,1%200%200,0%2018,5V9L18,19A3,3%200%200,1%2015,22H5A3,3%200%200,1%202,19V18H13A2,2%200%200,0%2015,20M9,6H14V8H9V6M9,10H14V12H9V10M9,14H14V16H9V14Z'%3e%3c/path%3e%3c/svg%3e",stop:"data:image/svg+xml,%3csvg%20data-testid='node-icon'%20xmlns='http://www.w3.org/2000/svg'%20width='24'%20height='24'%20viewBox='0%200%2024%2024'%20class='comd-icon__UE1EA6FF%20comd-survey-node-icon__VZtfWa'%20fill='%23eb0052'%20data-test-node-icon='stop'%3e%3cpath%20d='M13,13H11V7H13M12,17.3A1.3,1.3%200%200,1%2010.7,16A1.3,1.3%200%200,1%2012,14.7A1.3,1.3%200%200,1%2013.3,16A1.3,1.3%200%200,1%2012,17.3M15.73,3H8.27L3,8.27V15.73L8.27,21H15.73L21,15.73V8.27L15.73,3Z'%3e%3c/path%3e%3c/svg%3e",predefinedlist:"data:image/svg+xml,%3csvg%20data-testid='node-icon'%20xmlns='http://www.w3.org/2000/svg'%20width='24'%20height='24'%20viewBox='0%200%2024%2024'%20class='comd-icon__UE1EA6FF%20comd-survey-node-icon__VZtfWa'%20fill='%23007db8'%20data-test-node-icon='predefinedlists'%3e%3cpath%20d='M3,4H7V8H3V4M9,5V7H21V5H9M3,10H7V14H3V10M9,11V13H21V11H9M3,16H7V20H3V16M9,17V19H21V17H9'%3e%3c/path%3e%3c/svg%3e",specialblock:"data:image/svg+xml,%3csvg%20data-testid='node-icon'%20xmlns='http://www.w3.org/2000/svg'%20width='24'%20height='24'%20viewBox='0%200%2024%2024'%20class='comd-icon__UE1EA6FF%20comd-survey-node-icon__VZtfWa'%20fill='%23008473'%20data-test-node-icon='specialblock'%3e%3cpath%20d='M21,16.5C21,16.88%2020.79,17.21%2020.47,17.38L12.57,21.82C12.41,21.94%2012.21,22%2012,22C11.79,22%2011.59,21.94%2011.43,21.82L3.53,17.38C3.21,17.21%203,16.88%203,16.5V7.5C3,7.12%203.21,6.79%203.53,6.62L11.43,2.18C11.59,2.06%2011.79,2%2012,2C12.21,2%2012.41,2.06%2012.57,2.18L20.47,6.62C20.79,6.79%2021,7.12%2021,7.5V16.5M12,4.15L6.04,7.5L12,10.85L17.96,7.5L12,4.15M5,15.91L11,19.29V12.58L5,9.21V15.91M19,15.91V9.21L13,12.58V19.29L19,15.91Z'%3e%3c/path%3e%3c/svg%3e"};const ToolCallsDisplay=({toolCalls:l,executingToolCalls:c,toolCallErrors:d,maxRetriesReached:h,onRetryToolCall:p,isDevMode:f=!1,onCopy:m,onGroupFailure:y})=>{const[_,b]=Gt.useState(!1),[w,E]=Gt.useState(new Set),{sendEvent:M}=useWebSocketContext(),{projectId:N}=useParams(),P=Gt.useRef(new Map),L=Gt.useRef(new Set),[j,D]=Gt.useState(new Set),F=Gt.useMemo((()=>l?.reduce(((l,c)=>(l.some((l=>l.id===c.id))||l.push(c),l)),[])||[]),[l]),U=Gt.useMemo((()=>{const l=new Map;F.forEach((c=>{const d=c?.operation_group_id||null,h=l.get(d)||[];l.set(d,[...h,c])}));return Array.from(l.entries()).map((([l,d])=>{const h=d.some((l=>c.has(l.id))),p=d.some((l=>"completed"===l.status)),f=d.some((l=>"failed"===l.status)),m=d.some((l=>"cancelled"===l.status)),y=d.every((l=>"completed"===l.status)),_=d[0]?.message||null,b=d[0]?.payload?.question_type,w=d[0]?.payload?.node_type;let E="General Actions";return l&&(E=(l=>{const c=l.match(/^q_(.+?)_(q\d+)$/i);if(c){const l=c[1].replace(/_/g," "),d=c[2].toUpperCase();return`${l.split(" ").map((l=>l.charAt(0).toUpperCase()+l.slice(1))).join(" ")} ${d}`}return l.replace(/^q_/,"").replace(/_/g," ").split(" ").map((l=>l.charAt(0).toUpperCase()+l.slice(1))).join(" ")})(l)),{questionId:l,toolCalls:d,displayName:E,message:_,hasExecuting:h,hasCompleted:p,hasFailed:f,hasCancelled:m,allCompleted:y,questionType:b,nodeType:w}})).sort(((l,c)=>l.questionId&&!c.questionId?-1:!l.questionId&&c.questionId?1:0))}),[F,c]),B=Gt.useMemo((()=>U.findIndex((l=>l.hasFailed&&!j.has(l.toolCalls[0]?.id)))),[U,j]);Gt.useEffect((()=>{const l=new Set;U.forEach((c=>{if(!c.hasFailed||!c.questionId)return;const d=P.current.get(c.questionId)||new Set;c.toolCalls.forEach(((h,p)=>{if("failed"===h.status&&!d.has(h.id)){const d=c.toolCalls.slice(p+1).filter((l=>"pending"===l.status||"completed"===l.status)).map((l=>l.id));if(d.length>0){const p=d.filter((l=>!L.current.has(l)));p.length>0&&(p.forEach((c=>{l.add(c),L.current.add(c)})),y&&y(c.questionId,h.id,p),M("cancel_all_operations",{operation_group_id:c.questionId,tool_call_ids:p,reason:`Previous tool call failed in group ${c.displayName}`,failed_tool_call_id:h.id}))}P.current.has(c.questionId)||P.current.set(c.questionId,new Set),P.current.get(c.questionId).add(h.id)}}))})),l.size>0&&D((c=>{const d=new Set(c);return l.forEach((l=>d.add(l))),d}))}),[U,y,M]);const H=Array.from(c).filter((l=>F.some((c=>c.id===l)))).length,z=F.filter((l=>"completed"===l.status)).length,q=F.filter((l=>"failed"===l.status)).length,V=F.filter((l=>"cancelled"===l.status)).length;if(Gt.useEffect((()=>{if(H>0||q>0){b(!0);const l=new Set;U.forEach((c=>{(c.hasExecuting||c.hasFailed)&&l.add(c.questionId||"general")})),E(l)}}),[H,q,U]),!l||0===l.length)return null;const getGroupStatusIcon=l=>l.hasExecuting?Kt.jsx(wi,{className:"h-3 w-3 animate-spin text-primary"}):l.allCompleted?Kt.jsx(ls,{className:"h-3 w-3 text-green-500"}):l.hasFailed?Kt.jsx(as,{className:"h-3 w-3 text-red-500"}):l.hasCancelled?Kt.jsx(as,{className:"h-3 w-3 text-yellow-500"}):l.hasCompleted?Kt.jsx(ds,{className:"h-3 w-3 text-yellow-500"}):Kt.jsx("div",{className:"h-3 w-3 rounded-full border border-muted-foreground/30"}),toggleGroup=async(l,c)=>{const d=(l=>{const c=l.toolCalls.filter((l=>l.payload?.node_id));return c.length>=2?c[1]?.payload?.node_id||null:c[0]?.payload?.node_id||null})(c);d&&await(async l=>{if(N)try{const[c]=await er.tabs.query({active:!0,currentWindow:!0});if(!c?.url)return void console.warn("No active tab URL found");if(!isConfirmitDomain(c.url))return void console.warn("Navigation blocked: Not on a Confirmit domain",{currentUrl:c.url});if(c.url&&c.id){const d=`${new URL(c.url).origin}/surveydesigner/${N}/design/nodes/${l}`;await er.scripting.executeScript({target:{tabId:c.id},func:l=>{window.history.pushState({},"",l),window.dispatchEvent(new Event("popstate")),window.dispatchEvent(new CustomEvent("navigate",{detail:{url:l}}))},args:[d]})}}catch(c){console.error("Error navigating to node:",c)}})(d),E((c=>{const d=new Set(c);return d.has(l)?d.delete(l):d.add(l),d}))},getGroupIcon=l=>{const c=function(l,c){if(!l&&!c)return null;const d=(l||c)?.toLowerCase();if(!d)return null;const h=IM[d];if(h)return h;return TM[d]||null}(l.questionType,l.nodeType);return c?Kt.jsx("img",{src:c,alt:l.questionType||l.nodeType||"icon",className:"h-5 w-5"}):Kt.jsx(yi,{className:"h-5 w-5 text-muted-foreground transition-colors duration-200 group-hover:text-foreground"})};return Kt.jsx("div",{className:"tool-call-container mt-3 w-full",children:Kt.jsxs("div",{className:tr("relative overflow-hidden rounded-lg border bg-card/60 backdrop-blur-sm transition-all duration-300 w-full","hover:shadow-md hover:border-primary/30",_&&"shadow-md border-primary/20"),children:[Kt.jsxs("div",{className:tr("flex items-center justify-between px-4 py-3 cursor-pointer select-none w-full","group hover:bg-accent/10 transition-colors duration-200"),onClick:()=>b(!_),children:[Kt.jsxs("div",{className:"flex items-center gap-3",children:[Kt.jsxs("div",{className:"relative",children:[H>0?Kt.jsx(wi,{className:"h-4 w-4 animate-spin text-primary"}):z===F.length?Kt.jsx(ls,{className:"h-4 w-4 text-green-500"}):q>0?Kt.jsx(as,{className:"h-4 w-4 text-red-500"}):V>0?Kt.jsx(as,{className:"h-4 w-4 text-yellow-500"}):Kt.jsx(ds,{className:"h-4 w-4 text-yellow-500"}),H>0&&Kt.jsx("div",{className:"absolute inset-0 rounded-full animate-ping opacity-75",children:Kt.jsx("div",{className:"w-full h-full rounded-full bg-primary/20"})})]}),Kt.jsx("span",{className:"text-sm text-muted-foreground",children:(()=>{const l=U.filter((l=>l.questionId));U.filter((l=>l.allCompleted)).length;const c=U.filter((l=>l.hasFailed)).length,d=U.filter((l=>l.hasCancelled)).length,h=U.filter((l=>l.hasExecuting)).length;if(l.length>0){const p=l.filter((l=>l.allCompleted)).length;if(h>0)return"Processing Actions...";if(p===l.length)return"Completed all actions";if(c>0||d>0){const l=[];return p>0&&l.push(`${p} completed`),c>0&&l.push(`${c} with errors`),d>0&&l.push(`${d} cancelled`),`Questions: ${l.join(", ")}`}return"Executing Actions..."}if(H>0)return"Executing actions...";if(z===F.length)return"Completed all actions";if(q>0||V>0){const l=[];return z>0&&l.push(`${z} completed`),q>0&&l.push(`${q} failed`),V>0&&l.push(`${V} canceled`),l.join(", ")}return"Executing actions..."})()})]}),Kt.jsx(ns,{className:tr("h-4 w-4 text-muted-foreground transition-all duration-300","group-hover:text-foreground",_&&"rotate-180")})]}),Kt.jsx("div",{className:tr("overflow-y-auto transition-all duration-300 w-full",_?"max-h-[600px]":"max-h-0"),children:Kt.jsx("div",{className:"border-t w-full",children:1!==U.length||U[0].questionId?U.map(((l,y)=>{const _=l.questionId||"general",b=w.has(_),E=y===B;return Kt.jsxs("div",{className:tr("border-b last:border-b-0 border-border/20 w-full overflow-hidden",l.hasFailed&&!j.has(l.toolCalls[0]?.id)&&"border-red-500/30"),children:[Kt.jsxs("div",{className:tr("group flex items-center gap-3 px-4 py-3 cursor-pointer w-full","hover:bg-black/5 transition-all duration-200","bg-gradient-to-r from-muted/30 to-transparent","hover:from-black/8 hover:to-black/3",l.hasFailed&&!j.has(l.toolCalls[0]?.id)&&"from-red-50/30 to-red-50/5 hover:from-black/10 hover:to-black/5"),onClick:()=>toggleGroup(_,l),children:[Kt.jsx("div",{className:"flex items-center justify-center flex-shrink-0",children:getGroupIcon(l)}),Kt.jsxs("div",{className:"flex-1 flex flex-col gap-1 min-w-0",children:[Kt.jsx("span",{className:tr("text-sm font-medium transition-colors duration-200 truncate",l.questionId?"text-foreground group-hover:text-primary":"text-muted-foreground group-hover:text-foreground"),children:l.displayName}),l.message&&Kt.jsx("span",{className:"text-xs text-muted-foreground transition-colors duration-200 group-hover:text-foreground/80 line-clamp-2",children:l.message})]}),Kt.jsx("div",{className:"flex items-center gap-2",children:getGroupStatusIcon(l)})]}),E&&Kt.jsx("div",{className:"relative px-4 py-3 bg-red-50/50 border-y border-red-100/50",children:Kt.jsxs("div",{className:"flex items-start gap-3",children:[Kt.jsx(cs,{className:"h-4 w-4 text-red-500 mt-0.5 flex-shrink-0"}),Kt.jsxs("div",{className:"flex-1 min-w-0",children:[Kt.jsx("p",{className:"text-sm text-red-700 font-medium mb-1",children:l.displayName}),Kt.jsx("p",{className:"text-xs text-red-600/90",children:'Please create this question manually, then click the "Create next 5 Questions" button to continue.'}),Kt.jsx("p",{className:"text-xs text-red-600/75 mt-1",children:"Note: Subsequent operations have been cancelled."})]})]})}),f&&b&&!j.has(l.toolCalls[0]?.id)&&Kt.jsxs("div",{className:"relative bg-accent/5 w-full",children:[Kt.jsx("div",{className:"absolute left-8 top-0 bottom-0 w-px bg-border/40"}),l.toolCalls.map(((y,_)=>{l.hasFailed&&l.toolCalls.findIndex((l=>"failed"===l.status));return l.hasFailed&&l.toolCalls.findIndex((l=>"failed"===l.status))<_?null:Kt.jsx(ToolCallItem,{toolCall:{...y,status:j.has(y.id)?"cancelled":y.status},index:_,isExecuting:c.has(y.id),executionError:d.get(y.id),canRetry:h.has(y.id),onRetry:()=>p(y),isDevMode:f,onCopy:m},`${y.id}-${_}`)}))]})]},_)})):Kt.jsxs("div",{className:"relative w-full",children:[Kt.jsx("div",{className:"absolute left-8 top-0 bottom-0 w-px bg-border/50"}),F.map(((l,y)=>Kt.jsx(ToolCallItem,{toolCall:{...l,status:j.has(l.id)?"cancelled":l.status},index:y,isExecuting:c.has(l.id),executionError:d.get(l.id),canRetry:h.has(l.id),onRetry:()=>p(l),isDevMode:f,onCopy:m},`${l.id}-${y}`)))]})})})]})})},RM=Gt.createContext(null);function useDropdownMenuContext(){const l=Gt.useContext(RM);if(!l)throw new Error("DropdownMenu components must be wrapped in <DropdownMenu>");return l}function DropdownMenu({children:l,open:c,defaultOpen:d=!1,onOpenChange:h}){const[p,f]=Gt.useState(d),m=void 0!==c,y=m?c:p,_=Gt.useCallback((l=>{m||f(l),h?.(l)}),[m,h]),b=Gt.useRef(null),w=Gt.useRef(`dropdown-${Math.random().toString(36).substr(2,9)}`).current;return Kt.jsx(RM.Provider,{value:{open:y,setOpen:_,triggerRef:b,dropdownId:w},children:l})}function DropdownMenuTrigger({children:l,asChild:c=!1,className:d}){const{open:h,setOpen:p,triggerRef:f,dropdownId:m}=useDropdownMenuContext(),y=Gt.useCallback((l=>{l.stopPropagation(),p(!h)}),[h,p]);if(c&&Gt.isValidElement(l)){const c=l;return Gt.cloneElement(c,{ref:l=>{f.current=l;const d=c.ref;"function"==typeof d?d(l):d&&(d.current=l)},onClick:l=>{y(l),c.props.onClick?.(l)},className:tr(c.props.className,d),"data-ui-dropdown-trigger":m})}return Kt.jsx("button",{ref:l=>{f.current=l},type:"button",onClick:y,className:tr("inline-flex items-center justify-center",d),"data-ui-dropdown-trigger":m,children:l})}function DropdownMenuContent({children:l,className:c,align:d="start",side:h="bottom",sideOffset:p=4,alignOffset:f=0,onCloseAutoFocus:m}){const{open:y,setOpen:_,triggerRef:b,dropdownId:w}=useDropdownMenuContext(),[E,M]=Gt.useState({top:0,left:0}),N=Gt.useRef(null);return Gt.useEffect((()=>{if(!y)return;function updatePosition(){let l=b.current;const c=N.current;if(!l){const c=document.querySelector(`[data-ui-dropdown-trigger="${w}"]`);c&&(l=c)}if(!l||!c)return void M({top:100,left:100});const m=l.getBoundingClientRect(),y=c.getBoundingClientRect();if(0===y.width||0===y.height){const l={top:m.bottom+p,left:m.left};return M(l),void requestAnimationFrame(updatePosition)}let _=0,E=0;"top"===h?_=m.top-y.height-p:"left"===h?(_=m.top+f,E=m.left):"right"===h?(_=m.top+f,E=m.right):_=m.bottom+p,"bottom"!==h&&"top"!==h||(E="center"===d?m.left+m.width/2-y.width/2+f:"end"===d?m.right-y.width+f:m.left);const P=window.innerWidth,L=window.innerHeight;E+y.width>P&&(E=P-y.width-8),E<8&&(E=8),_+y.height>L&&(_=L-y.height-8),_<8&&(_=8),M({top:_,left:E})}updatePosition();const l=requestAnimationFrame((()=>{requestAnimationFrame((()=>{updatePosition()}))}));return window.addEventListener("resize",updatePosition),window.addEventListener("scroll",updatePosition,!0),()=>{cancelAnimationFrame(l),window.removeEventListener("resize",updatePosition),window.removeEventListener("scroll",updatePosition,!0)}}),[y,h,d,p,f,b]),Gt.useEffect((()=>{if(!y)return;const onOutsideClick=l=>{const c=N.current;let d=b.current;d||(d=document.querySelector(`[data-ui-dropdown-trigger="${w}"]`));const h=l.target,p=c&&!c.contains(h),f=d&&!d.contains(h);p&&f&&_(!1)},onEscape=l=>{"Escape"===l.key&&(_(!1),m?.(l))};return document.addEventListener("mousedown",onOutsideClick,!0),document.addEventListener("keydown",onEscape),()=>{document.removeEventListener("mousedown",onOutsideClick,!0),document.removeEventListener("keydown",onEscape)}}),[y,_,m,b]),y?ur.createPortal(Kt.jsx("div",{ref:N,"data-ui-dropdown-content":"",className:tr("fixed z-50 min-w-[12rem] max-w-[16rem] overflow-hidden rounded-lg border bg-white shadow-lg ring-1 ring-black/5","py-1 text-sm text-gray-700",c),style:{top:E.top,left:E.left},children:l}),document.body):null}function DropdownMenuItem({children:l,onSelect:c,disabled:d=!1,variant:h="default",inset:p=!1,icon:f,...m}){const{setOpen:y}=useDropdownMenuContext();return Kt.jsxs("div",{role:"menuitem","data-ui-dropdown-item":!0,"data-ui-dropdown-item-variant":h,"data-ui-dropdown-item-disabled":d?"true":void 0,"data-ui-dropdown-item-inset":p?"":void 0,className:tr("relative flex cursor-default select-none items-center gap-3 rounded-md px-3 py-2 text-sm outline-none transition-colors",d?"opacity-50 pointer-events-none text-gray-400":"text-gray-700 hover:bg-gray-50 hover:text-gray-900 focus:bg-gray-50 focus:text-gray-900","destructive"===h&&"text-red-600 hover:bg-red-50 hover:text-red-700 focus:bg-red-50 focus:text-red-700",p&&"pl-9",m.className),onClick:l=>{d||(c?.(l),y(!1))},...m,children:[f&&Kt.jsx(f,{className:"h-4 w-4 text-gray-500"}),l]})}function PulseDotLoader({className:l,size:c="md"}){return Kt.jsx("div",{className:tr("bg-primary animate-[pulse-dot_1.2s_ease-in-out_infinite] rounded-full",{sm:"size-1",md:"size-2",lg:"size-3"}[c],l),children:Kt.jsx("span",{className:"sr-only",children:"Loading"})})}Gt.createContext(null);const AM={open:{label:"Text",description:"Single line or multi-line text input"},multiopen:{label:"Text list",description:"Multiple text input fields"},info:{label:"Informational text",description:"Display-only text content"},date:{label:"Date",description:"Date picker input"},single:{label:"Single choice",description:"Radio button selection"},singlewithlookup:{label:"Table lookup/Hierarchy",description:"Hierarchical selection with lookup"},multi:{label:"Multi choice",description:"Checkbox selection"},numeric:{label:"Numeric",description:"Number input field"},multiopennumeric:{label:"Numeric list",description:"Multiple numeric input fields"},multiordered:{label:"Ranking",description:"Drag-and-drop ranking"},grid:{label:"Grid",description:"Single choice grid/matrix"},multigrid:{label:"Multi choice grid",description:"Multiple choice grid/matrix"},"3dgrid":{label:"3D Grid",description:"Three-dimensional grid"},imageupload:{label:"Image upload",description:"File upload for images"},audiocapture:{label:"Audio capture",description:"Audio recording"},videocapture:{label:"Video capture",description:"Video recording"},codecapture:{label:"Barcode/QR code",description:"Barcode/QR code scanner"},geolocation:{label:"Geolocation",description:"GPS location capture"}},OM=class _ConfirmitAPI{constructor(l){__publicField(this,"config"),this.config={defaultLanguageId:"9",defaultLanguageCombinedId:"en",showDeletedNodes:!1,...l}}async loggedFetch(l,c={}){const d=performance.now(),h=c.method||"GET",p=c.endpoint||new URL(l).pathname,f=c.correlationId||this.generateCorrelationId();let m=null;try{c.body&&(m="string"==typeof c.body?JSON.parse(c.body):c.body)}catch{m=c.body}let y={};try{y=this.sanitizeHeadersForLogging(c.headers)}catch{y={error:"Failed to sanitize headers"}}try{logInfo$1(`API Request: ${h} ${p}`,{url:l,method:h,endpoint:p,correlationId:f,headers:y,requestPayload:m,timestamp:(new Date).toISOString()})}catch(w){console.error("Failed to log API request:",w)}let _=null,b=null;try{_=await fetch(l,c);const M=performance.now()-d;try{const l=_.clone(),c=_.headers.get("content-type");b=c&&c.includes("application/json")?await l.json():await l.text()}catch(E){try{logDebug("Failed to parse response body",{error:E instanceof Error?E.message:String(E),endpoint:p})}catch{}}let N={};try{_.headers.forEach(((l,c)=>{N[c]=l}))}catch{N={error:"Failed to collect headers"}}const P=_.ok;try{P?logInfo$1(`API Response SUCCESS: ${h} ${p}`,{url:l,method:h,endpoint:p,correlationId:f,statusCode:_.status,statusText:_.statusText,duration:`${M.toFixed(2)}ms`,requestHeaders:y,requestPayload:m,responseHeaders:N,responsePayload:b,timestamp:(new Date).toISOString()}):logError(`API Response FAILURE: ${h} ${p}`,{url:l,method:h,endpoint:p,correlationId:f,statusCode:_.status,statusText:_.statusText,duration:`${M.toFixed(2)}ms`,requestHeaders:y,requestPayload:m,responseHeaders:N,responsePayload:b,errorType:"HTTP_ERROR",timestamp:(new Date).toISOString()})}catch(w){console.error("Failed to log API response:",w)}return _}catch(M){const c=performance.now()-d,_=M instanceof Error?M:new Error(String(M));try{logError(`API Request EXCEPTION: ${h} ${p}`,{url:l,method:h,endpoint:p,correlationId:f,duration:`${c.toFixed(2)}ms`,requestHeaders:y,requestPayload:m,errorMessage:_.message,errorType:_.name,errorStack:_.stack,timestamp:(new Date).toISOString()})}catch(w){console.error("Failed to log API error:",w)}throw _}}sanitizeHeadersForLogging(l){if(!l)return{};const c={},d=l instanceof Headers?Object.fromEntries(l.entries()):l;for(const[h,p]of Object.entries(d))if("authorization"===h.toLowerCase()){const l=String(p);if(l.startsWith("Bearer ")){const d=l.substring(7);c[h]=`Bearer ${d.substring(0,10)}...${d.substring(d.length-4)}`}else c[h]="***REDACTED***"}else c[h]=String(p);return c}generateCorrelationId(){return crypto.randomUUID()}buildHeaders(l){const{authToken:c=this.config.authToken,correlationId:d=this.generateCorrelationId(),languageId:h=this.config.defaultLanguageId,languageCombinedId:p=this.config.defaultLanguageCombinedId,showDeletedNodes:f=this.config.showDeletedNodes,additionalHeaders:m={}}=l;return{accept:"*/*","accept-language":"en-US,en;q=0.9",authorization:`Bearer ${c.replace(/^(Bearer\s+)+/i,"")}`,"content-type":"application/json",origin:this.config.baseUrl,"sec-ch-ua":'"Google Chrome";v="137", "Chromium";v="137", "Not/A)Brand";v="24"',"sec-ch-ua-mobile":"?0","sec-ch-ua-platform":'"macOS"',"sec-fetch-dest":"empty","sec-fetch-mode":"cors","sec-fetch-site":"same-origin","user-agent":"Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/137.0.0.0 Safari/537.36","x-confirmit-correlation-id":d,"x-confirmit-initiating-service":"Confirmit.SurveyDesigner.Client","x-current-language-combined-id":p,[`x-current-language-combined-id-${this.config.projectId}`]:p,"x-current-language-id":h,[`x-current-language-id-${this.config.projectId}`]:h,"x-show-deleted-nodes":f.toString(),[`x-show-deleted-nodes-${this.config.projectId}`]:f.toString(),...m}}async createQuestion(l){const{type:c="open",position:d="Before",nodeId:h,authToken:p,correlationId:f,languageId:m,languageCombinedId:y,showDeletedNodes:_}=l,b=new URL(`/surveydesigner/api/surveys/${this.config.projectId}/nodes`,this.config.baseUrl);b.searchParams.set("type",c),b.searchParams.set("position",d),b.searchParams.set("nodeId",h);const w=this.buildHeaders({authToken:p,correlationId:f,languageId:m,languageCombinedId:y,showDeletedNodes:_,additionalHeaders:{"content-length":"0",priority:"u=1, i",referer:`${this.config.baseUrl}/surveydesigner/${this.config.projectId}/design/nodes/${h}/add/${d}/${h}`}});return this.loggedFetch(b.toString(),{method:"POST",headers:w,body:"",correlationId:f,endpoint:"createQuestion"})}async createQuestionWithOverlay(l){const{tabId:c,...d}=l,h=AM[d.type||"open"],p=`Creating ${h?.label||"question"}...`;try{await ZT.show(p,"Please wait while the question is being created",c);const l=await this.createQuestion(d);return await new Promise((l=>setTimeout(l,500))),l}finally{await ZT.hide(c)}}async getRouting(l={}){const{expandToNode:c,authToken:d,correlationId:h,languageId:p,languageCombinedId:f,showDeletedNodes:m}=l,y=new URL(`/surveydesigner/api/surveys/${this.config.projectId}/routing/Routing`,this.config.baseUrl),_={priority:"u=1, i",referer:`${this.config.baseUrl}/surveydesigner/${this.config.projectId}/design/nodes/${c||""}`};c&&(_["x-expand-to-node"]=c);const b=this.buildHeaders({authToken:d,correlationId:h,languageId:p,languageCombinedId:f,showDeletedNodes:m,additionalHeaders:_});return this.loggedFetch(y.toString(),{method:"GET",headers:b,correlationId:h,endpoint:"getRouting"})}async getRoutingData(l={}){const c=await this.getRouting(l);if(!c.ok)throw new Error(`Failed to get routing data: ${c.status} ${c.statusText}`);const d=await c.json();return{...d,analysis:this.analyzeRouting(d)}}analyzeRouting(l){const c=l.routes||l.nodes||[],d={};let h=0;return Array.isArray(c)&&c.forEach((l=>{h++;const c=l.questionType||l.type||"unknown";d[c]=(d[c]||0)+1})),{totalRoutes:h,questionTypes:d,nodeCount:c.length}}async updateQuestion(l){const{nodeId:c,data:d,authToken:h,correlationId:p}=l,f=new URL(`/surveydesigner/api/surveys/${this.config.projectId}/nodes/${c}`,this.config.baseUrl),m=this.buildHeaders({authToken:h,correlationId:p,additionalHeaders:{origin:this.config.baseUrl,priority:"u=1, i",referer:`${this.config.baseUrl}/surveydesigner/${this.config.projectId}/design/nodes/${c}`}});return this.loggedFetch(f.toString(),{method:"PUT",headers:m,body:JSON.stringify(d),correlationId:p,endpoint:"updateQuestion"})}async updateMultiGridAnswers(l){const{parentMultigridNodeId:c,targetNodeId:d,data:h,parentNodeName:p,position:f,authToken:m,correlationId:y,index:_}=l;try{const l=await this.updateMultiGridQuestion({parentMultigridNodeId:c,targetNodeId:0===_?void 0:d,parentNodeName:p||"",position:f||"After",data:{__uniqueId:(_||0)+1,precode:h.precode,keepPos:h.keepPos??!1,formTexts:h.formTexts||[],texts:h.texts||[]},authToken:m,correlationId:y});if(!l.ok)return console.error(`\u274c Failed to create multigrid question: ${l.status} ${l.statusText}`),l;const b=await l.json(),w=b?.entityIdAsString||b?.entityId?.id;if(!w)return console.error("\u274c Failed to extract question ID from create response"),l;if(h.full_payload&&p){const l=await this.updateMultiGridQuestionById({parentMultigridNodeId:c,questionId:w,parentNodeName:p,data:h.full_payload,authToken:m,correlationId:y});return l.ok||console.error(`\u26a0\ufe0f Question created but update failed: ${l.status} ${l.statusText}`),l}return l}catch(b){throw console.error("\u274c Error in updateMultiGridAnswers:",b),b}}async updateQuestionSafely(l){try{const c=await this.updateQuestion(l);if(c.ok){const d=await c.json().catch((()=>null));return{success:!0,message:`Node ${l.nodeId} updated successfully`,nodeId:l.nodeId,data:d}}return{success:!1,message:`Failed to update node ${l.nodeId}: ${c.status} ${c.statusText}`,nodeId:l.nodeId}}catch(c){return{success:!1,message:`Error updating node ${l.nodeId}: ${c instanceof Error?c.message:"Unknown error"}`,nodeId:l.nodeId}}}async updateQuestionWithOverlay(l){const{tabId:c,...d}=l,h=`Updating question ${d.nodeId}...`;try{await ZT.show(h,"Please wait while the question is being updated",c);const l=await this.updateQuestionSafely(d);return await new Promise((l=>setTimeout(l,500))),l}finally{await ZT.hide(c)}}async getAnswers(l){const{nodeId:c,type:d,authToken:h,correlationId:p,languageId:f,languageCombinedId:m,showDeletedNodes:y}=l,_=new URL(`/surveydesigner/api/surveys/${this.config.projectId}/${c}/answers`,this.config.baseUrl);_.searchParams.set("type",d.charAt(0).toUpperCase()+d.slice(1));const b=this.buildHeaders({authToken:h,correlationId:p,languageId:f,languageCombinedId:m,showDeletedNodes:y,additionalHeaders:{priority:"u=1, i",referer:`${this.config.baseUrl}/surveydesigner/${this.config.projectId}/design/nodes/${c}`}});return this.loggedFetch(_.toString(),{method:"GET",headers:b,correlationId:p,endpoint:"getAnswers"})}async getAnswersData(l){try{const c=await this.getAnswers(l);if(c.ok){const d=await c.json();return{success:!0,message:`Answers retrieved successfully for node ${l.nodeId}`,nodeId:l.nodeId,answers:d.answers||d,data:d}}return{success:!1,message:`Failed to get answers for node ${l.nodeId}: ${c.status} ${c.statusText}`,nodeId:l.nodeId}}catch(c){return{success:!1,message:`Error getting answers for node ${l.nodeId}: ${c instanceof Error?c.message:"Unknown error"}`,nodeId:l.nodeId}}}async updateAnswers(l){const{nodeId:c,type:d,data:h,authToken:p,correlationId:f,languageId:m,languageCombinedId:y,showDeletedNodes:_}=l,b=new URL(`/surveydesigner/api/surveys/${this.config.projectId}/${c}/answers`,this.config.baseUrl);b.searchParams.set("type",d.charAt(0).toUpperCase()+d.slice(1));const w=this.buildHeaders({authToken:p,correlationId:f,languageId:m,languageCombinedId:y,showDeletedNodes:_,additionalHeaders:{origin:this.config.baseUrl,priority:"u=1, i",referer:`${this.config.baseUrl}/surveydesigner/${this.config.projectId}/design/nodes/${c}`}});return this.loggedFetch(b.toString(),{method:"PUT",headers:w,body:JSON.stringify(h),correlationId:f,endpoint:"updateAnswers"})}async updateAnswersSafely(l){try{const c=await this.updateAnswers(l);if(c.ok){const d=await c.json().catch((()=>null));return{success:!0,message:`Answers updated successfully for node ${l.nodeId}`,nodeId:l.nodeId,data:d}}return{success:!1,message:`Failed to update answers for node ${l.nodeId}: ${c.status} ${c.statusText}`,nodeId:l.nodeId}}catch(c){return{success:!1,message:`Error updating answers for node ${l.nodeId}: ${c instanceof Error?c.message:"Unknown error"}`,nodeId:l.nodeId}}}async updateAnswersWithOverlay(l){const{tabId:c,...d}=l,h=`Updating answers for question ${d.nodeId}...`;try{await ZT.show(h,"Please wait while the answers are being updated",c);const l=await this.updateAnswersSafely(d);return await new Promise((l=>setTimeout(l,500))),l}finally{await ZT.hide(c)}}async deleteNode(l){const{nodeId:c,authToken:d,correlationId:h}=l,p=new URL(`/surveydesigner/api/surveys/${this.config.projectId}/routing/${c}`,this.config.baseUrl),f=this.buildHeaders({authToken:d,correlationId:h,additionalHeaders:{origin:this.config.baseUrl,priority:"u=1, i",referer:`${this.config.baseUrl}/surveydesigner/${this.config.projectId}/design/nodes/${c}`}});return this.loggedFetch(p.toString(),{method:"DELETE",headers:f,correlationId:h,endpoint:"deleteNode"})}async deleteNodeSafely(l){try{const c=await this.deleteNode(l);return c.ok?{success:!0,message:`Node ${l.nodeId} deleted successfully`,nodeId:l.nodeId}:{success:!1,message:`Failed to delete node ${l.nodeId}: ${c.status} ${c.statusText}`,nodeId:l.nodeId}}catch(c){return{success:!1,message:`Error deleting node ${l.nodeId}: ${c instanceof Error?c.message:"Unknown error"}`,nodeId:l.nodeId}}}async deleteNodeWithOverlay(l){const{tabId:c,...d}=l,h=`Deleting node ${d.nodeId}...`;try{await ZT.show(h,"Please wait while the node is being deleted",c);const l=await this.deleteNodeSafely(d);return await new Promise((l=>setTimeout(l,500))),l}finally{await ZT.hide(c)}}updateConfig(l){this.config={...this.config,...l}}getConfig(){return{...this.config}}static getAvailableQuestionTypes(){return{...AM}}static getQuestionTypeInfo(l){return AM[l]||null}static isValidQuestionType(l){return l in AM}static findHighestNodeId(l){let c=0,d=null;const extractNodeIds=l=>{const h=l?.nodeId||l?.id;if(h){const l=h.toString().match(/\d+/);if(l){const p=parseInt(l[0],10);p>c&&(c=p,d=h.toString())}}l?.children&&Array.isArray(l.children)&&l.children.forEach(extractNodeIds),l?.recursiveData?.children&&Array.isArray(l.recursiveData.children)&&l.recursiveData.children.forEach(extractNodeIds)};return l?.children&&Array.isArray(l.children)&&l.children.forEach(extractNodeIds),l?.blocks?.children&&Array.isArray(l.blocks.children)&&l.blocks.children.forEach(extractNodeIds),l?.predefinedLists?.children&&Array.isArray(l.predefinedLists.children)&&l.predefinedLists.children.forEach(extractNodeIds),l?.question2nodeId&&Array.isArray(l.question2nodeId)&&l.question2nodeId.forEach((l=>{const h=l?.assigned_node_id;if(h){const l=h.toString().match(/\d+/);if(l){const p=parseInt(l[0],10);p>c&&(c=p,d=h.toString())}}})),d}async getQuestionDetails(l,c={}){const{authToken:d,correlationId:h,languageId:p,languageCombinedId:f,showDeletedNodes:m}=c,y=new URL(`/surveydesigner/api/surveys/${this.config.projectId}/nodes/${l}`,this.config.baseUrl),_=this.buildHeaders({authToken:d,correlationId:h,languageId:p,languageCombinedId:f,showDeletedNodes:m,additionalHeaders:{priority:"u=1, i",referer:`${this.config.baseUrl}/surveydesigner/${this.config.projectId}/design/nodes/${l}`}});return this.loggedFetch(y.toString(),{method:"GET",headers:_,correlationId:h,endpoint:"getQuestionDetails"})}async getQuestionDetailsData(l,c={}){try{const d=await this.getQuestionDetails(l,c);return d.ok?await d.json():(console.error(`Failed to get question details for node ${l}: ${d.status}`),null)}catch(d){return console.error(`Error getting question details for node ${l}:`,d),null}}async getRoutingDataWithNewNode(l={}){const{createNode:c=!0,nodeType:d="open",position:h="After",updateData:p,...f}=l;try{const l=await this.getRoutingDataWithChildren(f);let m=null;if(l?.question2nodeId){m=await this.findAndDeleteDemoNodes(l.question2nodeId,f.authToken);m.deletionResults.filter((l=>l.success)).length,m.foundNodes.length}m?.updatedRoutingData&&(l.question2nodeId=m.updatedRoutingData);const y=l,_=_ConfirmitAPI.findHighestNodeId(y);if(!c||!_)return{success:!0,message:c?"Routing data retrieved successfully, but no node created (no highest node ID found)":"Routing data retrieved successfully, node creation skipped",routingData:y,highestNodeId:_||void 0,createdNode:!1,cleanupResults:m};const b=await this.createQuestion({nodeId:_,type:d,position:h,authToken:f.authToken,correlationId:f.correlationId,languageId:f.languageId,languageCombinedId:f.languageCombinedId,showDeletedNodes:f.showDeletedNodes});if(b.ok){const l=await b.json().catch((()=>null)),c=l?.nodeId||l?.entityIdAsString||`new-${Date.now()}`;let h;l&&(h=await this.updateQuestionSafely({nodeId:c,data:{...l,formTexts:[{text:"demo",language:9}],entityIdAsString:c,entityId:{$type:"EntityId",id:c}}}),h.success||console.warn(`\u26a0\ufe0f Node created but update failed: ${h.message}`));const f={...y};if(l&&f){f.question2nodeId||(f.question2nodeId={});const d=l?.entityIdAsString||l?.entityId?.id||c;f.question2nodeId[d]={...l,...h?.data,assigned_node_id:c,dummy_node:!0},Array.isArray(f.nodes)?f.nodes.push(h?.data||l):Array.isArray(f.children)&&f.children.push(h?.data||l)}return{success:!0,message:p?`Successfully created and updated new ${d} node ${c}`:`Successfully created new ${d} node ${c}`,routingData:f,newNodeId:c,highestNodeId:_,createdNode:!0,updateResult:h||void 0,cleanupResults:m}}return console.warn(`\u26a0\ufe0f Failed to create new node: ${b.status} ${b.statusText}`),{success:!0,message:`Routing data retrieved successfully, but failed to create new node: ${b.status} ${b.statusText}`,routingData:y,highestNodeId:_,createdNode:!1,cleanupResults:m}}catch(m){console.error("\u274c Error in getRoutingDataWithNewNode:",m);try{const l=await this.getRoutingDataWithChildren(f);return{success:!0,message:`Routing data retrieved successfully (fallback), but failed to create new node: ${m instanceof Error?m.message:"Unknown error"}`,routingData:l,createdNode:!1}}catch(y){return{success:!1,message:`Failed to get routing data and create new node: ${m instanceof Error?m.message:"Unknown error"}`,routingData:null,createdNode:!1,cleanupResults:null}}}}async getFolderContents(l,c={}){try{const d=new URL(`/surveydesigner/api/surveys/${this.config.projectId}/routing/${l}`,this.config.baseUrl),h=this.buildHeaders({authToken:c.authToken,correlationId:c.correlationId,languageId:c.languageId,languageCombinedId:c.languageCombinedId,showDeletedNodes:c.showDeletedNodes,additionalHeaders:{priority:"u=1, i",referer:`${this.config.baseUrl}/surveydesigner/${this.config.projectId}/design/nodes/${l}`}}),p=await this.loggedFetch(d.toString(),{method:"GET",headers:h,correlationId:c.correlationId,endpoint:"getFolderContents"});if(!p.ok)return console.error(`Failed to get folder contents for ${l}: ${p.status} ${p.statusText}`),null;return await p.json()}catch(d){return console.error(`\ud83d\udca5 Error getting folder contents for ${l}:`,d),null}}async getFolderRoutingData(l,c={}){try{const d=await this.getFolderContents(l,c);return d?{success:!0,message:`Successfully retrieved routing data for folder ${l}`,data:d,question2nodeId:[]}:{success:!1,message:`Failed to get routing data for folder ${l}`,data:null,question2nodeId:[]}}catch(d){return{success:!1,message:`Error getting routing data for folder ${l}: ${d instanceof Error?d.message:"Unknown error"}`,data:null,question2nodeId:[]}}}async processFolderContents(l,c={},d=500){const h=[];for(let p=0;p<l.length;p++){const f=l[p];await new Promise((l=>setTimeout(l,d)));const m=await this.getQuestionDetails(f.nodeId||f.id,{authToken:c.authToken,correlationId:c.correlationId,languageId:c.languageId,languageCombinedId:c.languageCombinedId,showDeletedNodes:c.showDeletedNodes});if(m.ok){const l=await m.json();h.push({...f,details:l})}else h.push(f)}return h}async getBlockById(l,c={}){const{authToken:d,correlationId:h,languageId:p,languageCombinedId:f,showDeletedNodes:m}=c,y=new URL(`/surveydesigner/api/surveys/${this.config.projectId}/routing/${l}`,this.config.baseUrl),_={priority:"u=1, i",referer:`${this.config.baseUrl}/surveydesigner/${this.config.projectId}/design/nodes/${l}`},b=this.buildHeaders({authToken:d,correlationId:h,languageId:p,languageCombinedId:f,showDeletedNodes:m,additionalHeaders:_}),w=await fetch(y.toString(),{method:"GET",headers:b});return w.ok?w.json():(console.error(`Failed to get block ${l}: ${w.status} ${w.statusText}`),null)}async getBlocks(l={}){const{expandToNode:c,authToken:d,correlationId:h,languageId:p,languageCombinedId:f,showDeletedNodes:m}=l,y=new URL(`/surveydesigner/api/surveys/${this.config.projectId}/routing/Blocks`,this.config.baseUrl),_={priority:"u=1, i",referer:`${this.config.baseUrl}/surveydesigner/${this.config.projectId}/design/nodes/${c||""}`};c&&(_["x-expand-to-node"]=c);const b=this.buildHeaders({authToken:d,correlationId:h,languageId:p,languageCombinedId:f,showDeletedNodes:m,additionalHeaders:_});return this.loggedFetch(y.toString(),{method:"GET",headers:b,correlationId:h,endpoint:"getBlocks"})}async getAllBlocksWithDetails(l={}){try{const c=await this.getBlocks(l);if(!c.ok)return console.error(`Failed to get blocks list: ${c.status} ${c.statusText}`),null;const d=await c.json(),h=d?.children?.map((l=>l.nodeId||l.id)).filter(Boolean)||[];if(0===h.length)return console.log("No blocks found"),d;const p=(await __vitePreload((async()=>{const{default:l}=await Promise.resolve().then((()=>WM));return{default:l}}),void 0)).default,f=p(8),m=new Map,fetchWithCache=async(l,c)=>{if(m.has(l))return m.get(l);const d=f((async()=>{try{return await c()}catch(d){throw console.error(`\u274c Failed to fetch ${l}:`,d),d}}));return m.set(l,d),d},y=h.map((c=>fetchWithCache(`block-${c}`,(()=>this.getBlockById(c,l))))),_=await Promise.all(y),b=d.children.map(((l,c)=>({...l,..._[c]}))),fetchNestedChildrenParallel=async c=>{if(!c||0===c.length)return[];return await Promise.all(c.map((async c=>{const d=c.nodeId||c.id,h=c.nodeType||c.extNodeType||c.type;if(!d){if(c.children&&Array.isArray(c.children)){const l=await fetchNestedChildrenParallel(c.children);return{...c,children:l}}return c}const p=h?.toLowerCase().includes("folder")||"root"===h?.toLowerCase()||"block"===h?.toLowerCase()||"predefinedlist"===h?.toLowerCase()||"callableblock"===h?.toLowerCase()||h?.toLowerCase().includes("condition")||"truenodes"===h?.toLowerCase()||"falsenodes"===h?.toLowerCase()||"conditionifthen"===h?.toLowerCase()||"page"===h?.toLowerCase()||"inlineblock"===h?.toLowerCase()||"grid3d"===h?.toLowerCase()||"loop"===h?.toLowerCase();console.log(h,"amma_node",p,c);try{const f=`${p?"folder":"question"}-${d}`,m=await fetchWithCache(f,(()=>p?this.getFolderContents(d,l):this.getQuestionDetailsData(d,l)));let y=[];return p&&m?.children&&Array.isArray(m.children)?(console.log(h,"amma_node",p,c),y=await fetchNestedChildrenParallel(m.children)):c.children&&Array.isArray(c.children)&&(y=await fetchNestedChildrenParallel(c.children)),{...c,...m,children:y}}catch(f){if(console.error(`\u274c Error fetching ${h} ${d}:`,f),c.children&&Array.isArray(c.children)){const l=await fetchNestedChildrenParallel(c.children);return{...c,children:l}}return c}})))};if(b&&Array.isArray(b)){const l=await fetchNestedChildrenParallel(b);return{...d,children:l}}return{...d,children:b}}catch(c){return console.error("Error getting blocks with details:",c),null}}async getQuotas(l={}){const{authToken:c,correlationId:d,languageId:h,languageCombinedId:p,showDeletedNodes:f}=l,m=new URL(`/surveydesigner/api/surveys/${this.config.projectId}/routing/Quotas`,this.config.baseUrl),y={priority:"u=1, i",referer:`${this.config.baseUrl}/surveydesigner/${this.config.projectId}/design/nodes/`},_=this.buildHeaders({authToken:c,correlationId:d,languageId:h,languageCombinedId:p,showDeletedNodes:f,additionalHeaders:y});return this.loggedFetch(m.toString(),{method:"GET",headers:_,correlationId:d,endpoint:"getBlocks"})}async getQuotasData(l={}){try{const c=await this.getQuotas(l);return c.ok?c.json():(console.error(`Failed to get quotas data: ${c.status} ${c.statusText}`),null)}catch(c){return console.error("Error getting quotas data:",c),null}}async getBlocksData(l={}){try{const c=await this.getBlocks(l);if(!c.ok)return console.error(`Failed to get blocks data: ${c.status} ${c.statusText}`),null;return await c.json()}catch(c){return console.error("Error getting blocks data:",c),null}}async getRoutingDataWithChildren(l={}){if(_ConfirmitAPI.isProcessingRouting&&_ConfirmitAPI.routingPromise)return _ConfirmitAPI.routingPromise;const c=(await __vitePreload((async()=>{const{default:l}=await Promise.resolve().then((()=>WM));return{default:l}}),void 0)).default;return _ConfirmitAPI.isProcessingRouting=!0,_ConfirmitAPI.routingPromise=(async()=>{const d=performance.now();try{const h=new Map,p=c(15);let f=0,m=0;const fetchWithCache=async(l,c)=>{if(h.has(l))return m++,h.get(l);f++;const d=p((async()=>{try{return await c()}catch(d){throw console.error(`\u274c Failed to fetch ${l}:`,d),d}}));return h.set(l,d),d},[y,_,b,w]=await Promise.all([this.getRoutingData(l),this.getAllBlocksWithDetails(l),this.getPredefinedListsData(l),this.getQuotasData(l)]),fetchNestedChildrenParallel=async c=>{if(!c||0===c.length)return[];return await Promise.all(c.map((async c=>{const d=c.nodeId||c.id,h=c.nodeType||c.extNodeType||c.type;c.name;if(!d){if(c.children&&Array.isArray(c.children)){const l=await fetchNestedChildrenParallel(c.children);return{...c,children:l}}return c}const p=h?.toLowerCase().includes("folder")||"root"===h?.toLowerCase()||"block"===h?.toLowerCase()||"predefinedlist"===h?.toLowerCase()||"callableblock"===h?.toLowerCase()||h?.toLowerCase().includes("condition")||"truenodes"===h?.toLowerCase()||"falsenodes"===h?.toLowerCase()||"conditionifthen"===h?.toLowerCase()||"page"===h?.toLowerCase()||"inlineblock"===h?.toLowerCase()||"grid3d"===h?.toLowerCase()||"loop"===h?.toLowerCase();try{const h=`${p?"folder":"question"}-${d}`,f=await fetchWithCache(h,(()=>p?this.getFolderContents(d,l):this.getQuestionDetailsData(d,l)));let m=[];return p&&f?.children&&Array.isArray(f.children)?m=await fetchNestedChildrenParallel(f.children):c.children&&Array.isArray(c.children)&&(m=await fetchNestedChildrenParallel(c.children)),{...c,...f,children:m}}catch(f){if(console.error(`\u274c Error fetching ${h} ${d}:`,f),c.children&&Array.isArray(c.children)){const l=await fetchNestedChildrenParallel(c.children);return{...c,children:l}}return c}})))},E=[];y?.children&&Array.isArray(y.children)&&E.push(fetchNestedChildrenParallel(y.children).then((l=>({type:"routing",data:l})))),_?.children&&Array.isArray(_.children)&&E.push(fetchNestedChildrenParallel(_.children).then((l=>({type:"blocks",data:l})))),b?.children&&Array.isArray(b.children)&&E.push(fetchNestedChildrenParallel(b.children).then((l=>({type:"lists",data:l}))));const M=await Promise.all(E);let N=y.children||[],P=_,L=b;for(const l of M)switch(l.type){case"routing":N=l.data;break;case"blocks":P={..._,children:l.data};break;case"lists":L={...b,children:l.data}}const j={question2nodeId:[],...y,children:N,blocks:P,predefinedLists:L,quotas:w};j.question2nodeId=await this.buildQuestionMappingList(j);const D=((performance.now()-d)/1e3).toFixed(2);Math.round(180/parseFloat(D));return j}finally{setTimeout((()=>{_ConfirmitAPI.isProcessingRouting=!1,_ConfirmitAPI.routingPromise=null}),100)}})(),_ConfirmitAPI.routingPromise}createQuestion2NodeIdMapping(l){const c={},d=new Set,processNode=(l,h=0)=>{const p=l.nodeId||l.id,f=l.name;l.nodeType||l.extNodeType||l.type,p&&d.has(p)||(p&&d.add(p),p&&f&&(c[f]=p),l.children&&Array.isArray(l.children)&&l.children.forEach((l=>processNode(l,h+1))),l.recursiveData&&l.recursiveData.children&&Array.isArray(l.recursiveData.children)&&l.recursiveData.children.forEach((l=>processNode(l,h+1))))};return l?.children&&Array.isArray(l.children)&&l.children.forEach((l=>processNode(l,0))),l?.blocks?.children&&Array.isArray(l.blocks.children)&&l.blocks.children.forEach((l=>processNode(l,0))),c}async getQuestion2NodeIdMapping(l={}){return(await this.getRoutingDataWithChildren(l)).question2nodeId||[]}async buildQuestionMappingList(l){const c=[],d=new Set,h=new Set(Object.keys(AM).map((l=>l.toLowerCase()))),traverse=l=>{if((l=>{const p=(l?.nodeId||l?.id)?.toString();if(!p)return;if(d.has(p))return;d.add(p);const f=(l?.extNodeType??l?.nodeType??"").toString().toLowerCase(),m=(l?.nodeType??"").toString().toLowerCase(),y=h.has(f)||h.has(m)?"question":"node",_="stop"===m||"stop"===f?(l?.label??l?.name??"").toString():(l?.name??l?.label??"").toString();c.push({...l,type:y,name:_,assigned_node_id:p,nodeId:p,nodeType:l?.nodeType,extNodeType:l?.extNodeType})})(l),l?.children&&Array.isArray(l.children))for(const c of l.children)traverse(c);if(l?.recursiveData?.children&&Array.isArray(l.recursiveData.children))for(const c of l.recursiveData.children)traverse(c)};if(l?.children&&Array.isArray(l.children))for(const f of l.children)traverse(f);if(l?.blocks?.children&&Array.isArray(l.blocks.children))for(const f of l.blocks.children)traverse(f);if(l?.quotas?.children&&Array.isArray(l.quotas.children))for(const f of l.quotas.children)traverse(f);if(l?.predefinedLists?.children&&Array.isArray(l.predefinedLists.children))for(const f of l.predefinedLists.children)traverse(f);const p=c.filter((l=>{const c=(l.extNodeType??l.nodeType??"").toString().toLowerCase(),d=(l.nodeType??"").toString().toLowerCase();return h.has(c)||h.has(d)}));if(p.length>0){console.log(`\ud83d\udd0d Fetching answers for ${p.length} questions in parallel...`);const l=(0,(await __vitePreload((async()=>{const{default:l}=await Promise.resolve().then((()=>WM));return{default:l}}),void 0)).default)(20),d=new Map,fetchAnswersWithCache=async(c,h)=>{const p=`answers-${c}-${h}`;if(d.has(p))return d.get(p);const f=l((async()=>{try{if(h&&_ConfirmitAPI.isValidQuestionType(h.toLowerCase())){const l=await this.getAnswersData({nodeId:c,type:h.toLowerCase()});if(l.success&&l.answers)return l.answers}return[]}catch(l){return console.error(`\u274c Error fetching answers for ${c} (${h}):`,l),[]}}));return d.set(p,f),f},h=p.map((l=>fetchAnswersWithCache(l.nodeId,l.nodeType||l.extNodeType||"").then((c=>({nodeId:l.nodeId,answers:c,answerType:l.nodeType||l.extNodeType}))))),f=await Promise.all(h),m=new Map;f.forEach((l=>{m.set(l.nodeId,{answers:l.answers,answerType:l.answerType||""})})),c.forEach((l=>{const c=m.get(l.nodeId);c&&(l.answerType=c.answerType,l.answers=c.answers)}));const y=f.reduce(((l,c)=>l+c.answers.length),0);console.log(`\u2705 Fetched ${y} total answers for ${p.length} questions`)}return c.map((({nodeId:l,...c})=>c))}async findAndDeleteDemoNodes(l,c){const d=[],h=new Set,traverse=l=>{if((l=>{const c=(l?.nodeId||l?.id)?.toString();if(c&&!h.has(c)&&(h.add(c),l?.formTexts&&Array.isArray(l.formTexts)))for(const h of l.formTexts)if(h?.text&&h.text.toLowerCase().includes("demo")){const p=(l?.name??l?.label??"").toString();d.push({nodeId:c,name:p,text:h.text});break}})(l),l?.children&&Array.isArray(l.children))for(const c of l.children)traverse(c);if(l?.recursiveData?.children&&Array.isArray(l.recursiveData.children))for(const c of l.recursiveData.children)traverse(c)};if(Array.isArray(l))for(const _ of l)traverse(_);else{if(l?.children&&Array.isArray(l.children))for(const c of l.children)traverse(c);if(l?.blocks?.children&&Array.isArray(l.blocks.children))for(const c of l.blocks.children)traverse(c);if(l?.predefinedLists?.children&&Array.isArray(l.predefinedLists.children))for(const c of l.predefinedLists.children)traverse(c)}const p=[];for(const _ of d)try{const l=await this.deleteNodeSafely({nodeId:_.nodeId,authToken:c});p.push(l),l.success}catch(y){const l={success:!1,message:`Error deleting demo node ${_.nodeId}: ${y instanceof Error?y.message:"Unknown error"}`,nodeId:_.nodeId};p.push(l),console.error(`\u274c Error deleting demo node: ${_.name} (${_.nodeId})`,y)}const f=JSON.parse(JSON.stringify(l)),m=new Set(p.filter((l=>l.success)).map((l=>l.nodeId))),removeDeletedNodes=l=>Array.isArray(l)?l.filter((l=>{const c=(l?.nodeId||l?.id)?.toString();return!c||!m.has(c)})).map((l=>({...l,children:l.children?removeDeletedNodes(l.children):l.children,recursiveData:l.recursiveData?.children?{...l.recursiveData,children:removeDeletedNodes(l.recursiveData.children)}:l.recursiveData}))):l;if(Array.isArray(f)){const l=f.filter((l=>{const c=(l?.nodeId||l?.id)?.toString();return!c||!m.has(c)}));f.length=0,f.push(...l)}else f?.children&&Array.isArray(f.children)&&(f.children=removeDeletedNodes(f.children)),f?.blocks?.children&&Array.isArray(f.blocks.children)&&(f.blocks.children=removeDeletedNodes(f.blocks.children)),f?.predefinedLists?.children&&Array.isArray(f.predefinedLists.children)&&(f.predefinedLists.children=removeDeletedNodes(f.predefinedLists.children)),f?.question2nodeId&&Array.isArray(f.question2nodeId)&&(f.question2nodeId=f.question2nodeId.filter((l=>{const c=l?.assigned_node_id?.toString();return!c||!m.has(c)})));return m.size,{foundNodes:d,deletionResults:p,updatedRoutingData:f}}async getRoutingDataAndCleanupDemo(l={},c){const d=await this.getRoutingData(l);let h=null;if(d?.question2nodeId){h=await this.findAndDeleteDemoNodes(d,c),h.deletionResults.filter((l=>l.success)).length;h.foundNodes.length>0||console.log("\ud83e\uddf9 No demo nodes found to clean up")}return{routingData:h?.updatedRoutingData||d,cleanupResults:h}}async getBlocksOnly(l,c={}){return this.getBlocksData({...c,expandToNode:l})}analyzeBlocks(l){if(!l||!l.children)return{totalBlocks:0,blockNames:[],blockStructure:[]};const c=l.children||[],d=c.map((l=>l.name||l.title||"Unnamed Block"));return{totalBlocks:c.length,blockNames:d,blockStructure:c}}async getPredefinedLists(l={}){const{expandToNode:c,authToken:d,correlationId:h,languageId:p,languageCombinedId:f,showDeletedNodes:m}=l,y=new URL(`/surveydesigner/api/surveys/${this.config.projectId}/routing/PredefinedLists`,this.config.baseUrl),_={priority:"u=1, i",referer:`${this.config.baseUrl}/surveydesigner/${this.config.projectId}/design/nodes/${c||""}`},b=this.buildHeaders({authToken:d,correlationId:h,languageId:p,languageCombinedId:f,showDeletedNodes:m,additionalHeaders:_});return this.loggedFetch(y.toString(),{method:"GET",headers:b,correlationId:h,endpoint:"getPredefinedLists"})}async getPredefinedListsData(l={}){try{const c=await this.getPredefinedLists(l);if(!c.ok)return console.error(`Failed to get predefined lists data: ${c.status} ${c.statusText}`),null;return await c.json()}catch(c){return console.error("Error getting predefined lists data:",c),null}}async getPredefinedListsOnly(l={}){return this.getPredefinedListsData(l)}async getPredefinedListsWithChildren(l={}){try{const c=await this.getPredefinedListsData(l);if(!c)return{success:!1,message:"Failed to get predefined lists data",data:null,question2nodeId:[]};const fetchNestedChildren=async c=>{const d=c.nodeId||c.id;c.nodeType||c.extNodeType||c.type,c.name;if(d)try{const h=await this.getFolderContents(d,l);if(h&&h.children&&Array.isArray(h.children)&&h.children.length>0){const l=[];for(const c of h.children){const d=await fetchNestedChildren(c);l.push(d)}return{...c,children:l,recursiveData:h}}if(c.children&&Array.isArray(c.children)){const l=[];for(const d of c.children){const c=await fetchNestedChildren(d);l.push(c)}return{...c,children:l}}return c}catch(h){return console.error(`Error fetching children for predefined list ${d}:`,h),c}if(c.children&&Array.isArray(c.children)){const l=[];for(const d of c.children){const c=await fetchNestedChildren(d);l.push(c)}return{...c,children:l}}return c};let d=c;if(c?.children&&Array.isArray(c.children)){const l=[];for(const d of c.children){const c=await fetchNestedChildren(d);l.push(c)}d={...c,children:l}}return{success:!0,message:"Successfully retrieved 0 items from predefined lists",data:d,question2nodeId:[]}}catch(c){return{success:!1,message:`Error getting predefined lists with children: ${c instanceof Error?c.message:"Unknown error"}`,data:null,question2nodeId:[]}}}static flattenRoutingTree(l){const c=[];return l?.children&&Array.isArray(l.children)&&l.children.forEach((function traverse(l){"Folder"!==l.nodeType&&"folder"!==l.type&&c.push(l),l.children&&Array.isArray(l.children)&&l.children.forEach(traverse)})),c}async getAllQuestionsFlattened(l={}){const c=await this.getRoutingDataWithChildren(l);return _ConfirmitAPI.flattenRoutingTree(c)}async getFolderContentsRecursive(l,c={}){const d=Date.now(),{maxDepth:h=10,delay:p=300,parallel:f=!1,includeContainerTypes:m=["Folder","CallableBlock"],...y}=c;let _=0,b=0,w=0;try{const c=await this.recursiveFetchHelper(l,y,0,h,p,f,m,{totalContainers:0,totalItems:0,maxDepthReached:0});_=c.stats.totalContainers,b=c.stats.totalItems,w=c.stats.maxDepthReached;const E=Date.now()-d,M=this.flattenRecursiveData(c.data);return{success:!0,message:`Successfully fetched all contents for ${l} with ${b} items`,data:c.data,flattenedItems:M,statistics:{totalContainers:_,totalItems:b,maxDepthReached:w,processingTime:E}}}catch(E){const c=Date.now()-d;return{success:!1,message:`Error during recursive fetch for ${l}: ${E instanceof Error?E.message:"Unknown error"}`,data:null,statistics:{totalContainers:_,totalItems:b,maxDepthReached:w,processingTime:c}}}}async recursiveFetchHelper(l,c,d,h,p,f,m,y){if(y.maxDepthReached=Math.max(y.maxDepthReached,d),d>=h)return{data:null,stats:y};p>0&&d>0&&await new Promise((l=>setTimeout(l,p)));const _=await this.getFolderContents(l,c);if(!_)return{data:null,stats:y};if(y.totalContainers++,!_.children||!Array.isArray(_.children))return{data:_,stats:y};y.totalItems+=_.children.length;const b=[];if(f){const l=_.children.map((async l=>{const _=l.nodeId||l.id,b=l.nodeType||l.extNodeType;if(_&&m.includes(b)){const b=await this.recursiveFetchHelper(_,c,d+1,h,p,f,m,y);return{...l,children:b.data?.children||[],recursiveData:b.data}}return l})),w=await Promise.all(l);b.push(...w)}else for(const w of _.children){const l=w.nodeId||w.id,_=w.nodeType||w.extNodeType;if(l&&m.includes(_)){const _=await this.recursiveFetchHelper(l,c,d+1,h,p,f,m,y);b.push({...w,children:_.data?.children||[],recursiveData:_.data})}else b.push(w)}return{data:{..._,children:b},stats:y}}flattenRecursiveData(l){if(!l)return[];const c=[],traverse=l=>{(l.nodeId||l.id)&&c.push({nodeId:l.nodeId||l.id,name:l.name,label:l.label,nodeType:l.nodeType,extNodeType:l.extNodeType,type:l.type,parentId:l.parentId,isContainer:l.children&&l.children.length>0,hasRecursiveData:!!l.recursiveData}),l.children&&Array.isArray(l.children)&&l.children.forEach(traverse)};return traverse(l),c}async getBlockContentsRecursive(l,c={}){const d=await this.getFolderContentsRecursive(l,{...c,includeContainerTypes:["CallableBlock","Folder","Block"]});return{success:d.success,message:d.message,blockData:d.data,allItems:d.flattenedItems||[],statistics:d.statistics}}async getSurveyDetails(l,c={}){try{if(!l)return{success:!1,message:"Survey ID is required"};const d=`${this.config.baseUrl}/surveydesigner/api/surveys/${l}`,h=this.buildHeaders({correlationId:c.correlationId,additionalHeaders:{"cache-control":"no-cache",pragma:"no-cache",priority:"u=1, i"}}),p=await fetch(d,{method:"GET",headers:h});if(!p.ok){const l=await p.text();return console.error("Error details:",l),{success:!1,message:`Failed to fetch survey details: ${p.status} ${p.statusText}`,error:{status:p.status,statusText:p.statusText,details:l}}}return{success:!0,message:"Survey details fetched successfully",data:await p.json()}}catch(d){return{success:!1,message:`Error fetching survey details: ${d instanceof Error?d.message:"Unknown error"}`,error:d}}}async getDesignerLog(l,c={}){try{if(!l)return{success:!1,message:"Survey ID is required"};const d=`${this.config.baseUrl}/surveydesigner/api/surveys/${l}/designerlog`,h=this.buildHeaders({correlationId:c.correlationId,additionalHeaders:{"cache-control":"no-cache",pragma:"no-cache",priority:"u=1, i"}}),p=await this.loggedFetch(d,{method:"GET",headers:h,correlationId:c.correlationId,endpoint:"getDesignerLog"});if(!p.ok){const l=await p.text();return console.error(`\u274c Failed to fetch designer log: ${p.status} ${p.statusText}`),console.error("Error details:",l),{success:!1,message:`Failed to fetch designer log: ${p.status} ${p.statusText}`,error:{status:p.status,statusText:p.statusText,details:l}}}return{success:!0,message:"Designer log fetched successfully",data:await p.json()}}catch(d){return console.error("\u274c Error fetching designer log:",d),{success:!1,message:`Error fetching designer log: ${d instanceof Error?d.message:"Unknown error"}`,error:d}}}async updateMultiGridQuestionById(l){const{parentMultigridNodeId:c,questionId:d,parentNodeName:h,data:p,authToken:f,correlationId:m}=l,y=new URL(`/surveydesigner/api/surveys/${this.config.projectId}/multigrid/${c}/questions/${d}`,this.config.baseUrl);y.searchParams.append("parentNodeName",h);const _=this.buildHeaders({authToken:f,correlationId:m,additionalHeaders:{"cache-control":"no-cache",pragma:"no-cache",priority:"u=1, i",referer:`${this.config.baseUrl}/surveydesigner/${this.config.projectId}/design/nodes/${c}`,"content-type":"application/json"}});return this.loggedFetch(y.toString(),{method:"PUT",headers:_,body:JSON.stringify(p),correlationId:m,endpoint:"updateMultiGridQuestionById"})}async updateMultiGridQuestion(l){const{parentMultigridNodeId:c,targetNodeId:d,parentNodeName:h,position:p,data:f,authToken:m,correlationId:y}=l,_=new URL(`/surveydesigner/api/surveys/${this.config.projectId}/multigrid/${c}/questions`,this.config.baseUrl);_.searchParams.append("parentNodeName",h),_.searchParams.append("position",p),d&&_.searchParams.append("nodeId",d);const b=this.buildHeaders({authToken:m,correlationId:y,additionalHeaders:{"cache-control":"no-cache",pragma:"no-cache",priority:"u=1, i",referer:`${this.config.baseUrl}/surveydesigner/${this.config.projectId}/design/nodes/${c}`,"content-type":"application/json"}});return this.loggedFetch(_.toString(),{method:"POST",headers:b,body:JSON.stringify(f),correlationId:y,endpoint:"updateMultiGridQuestion"})}async fetchTemplates(l){const{filter:c="",keywords:d="",orderBy:h="Name",orderDir:p="asc",authToken:f,correlationId:m}=l||{},y=new URL("/surveydesigner/api/surveys",this.config.baseUrl);y.searchParams.append("filter",c),y.searchParams.append("keywords",d),y.searchParams.append("type","template"),y.searchParams.append("orderBy",h),y.searchParams.append("orderDir",p);const _=this.buildHeaders({authToken:f,correlationId:m,additionalHeaders:{"cache-control":"no-cache",pragma:"no-cache",priority:"u=1, i",referer:`${this.config.baseUrl}/surveydesigner`}});return this.loggedFetch(y.toString(),{method:"GET",headers:_,correlationId:m,endpoint:"fetchTemplates"})}};__publicField(OM,"isProcessingRouting",!1),__publicField(OM,"routingPromise",null);let MM=OM;!function(){Date.now()}();const hashValue=async l=>{try{const c=new TextEncoder,d=await crypto.subtle.importKey("raw",c.encode("a1b2c3d4e5f6g7h8i9j0k1l2m3n4o5p6"),{name:"AES-GCM"},!1,["encrypt"]),h=crypto.getRandomValues(new Uint8Array(12)),p=await crypto.subtle.encrypt({name:"AES-GCM",iv:h},d,c.encode(l)),f=new Uint8Array(h.length+p.byteLength);return f.set(h),f.set(new Uint8Array(p),h.length),btoa(String.fromCharCode(...f))}catch(c){return console.error("Encryption error:",c),l}},NM={invalid_language_codes:Kt.jsxs("p",{className:"text-sm text-gray-700 mt-1",children:["Hey, looks like you've selected languages that we don't support. Here are the list of languages that we currently support -"," ",Kt.jsx("a",{href:"https://help.metaforms.ai/survey-programming-confirmit/metaforms-chrome-extension-confirmit-guide/languages-supported",target:"_blank",rel:"noopener noreferrer",className:"text-blue-500 hover:text-blue-600 underline",children:"Metaforms Chrome Extension \u2013 Confirmit Guide"})]}),template_support_disabled:Kt.jsxs("p",{className:"text-sm text-gray-700 mt-1",children:["Looks like you're trying to create a project with Templates. Template support is not enabled for your organisation, please reach out to"," ",Kt.jsx("a",{href:"mailto:help@metaforms.ai",className:"text-blue-500 hover:text-blue-600 underline",children:"help@metaforms.ai"})," ","to enable access."]})},MessageList=({messages:l,isStreaming:c,showTimeoutMessage:d,executingToolCalls:h,toolCallErrors:p,toolCallStatuses:f,maxRetriesReached:m,isDevMode:y,onRetryMessage:_,onRetryToolCall:b,onCopy:w,onTimeoutRetry:E,onTimeoutDismiss:M,onCancelToolCallsForGroup:N,turnErrors:P=new Map,showErrorDetails:L=new Map,onToggleErrorDetails:j,onRetryTurn:D,onModifyTurn:F,onSkipTurn:U,setIsLoadingRoutingData:B,isOnValidSurveyPage:H,isConfirmitSite:z})=>{const q=qT(),{sendEvent:V}=useWebSocketContext(),{authToken:Z,projectId:K}=useConfirmitProject(),[Y,ee]=Gt.useState(5),ne=[1,2,3,4,5],handleGroupFailure=(l,c,d)=>{N&&N(l,d)},se=Gt.useCallback((async l=>{try{const d=`user-${Date.now()}`,h=`Create next ${l} Question${1!==l?"s":""}`;if(q(KT({id:d,content:h,role:"user",timestamp:Date.now(),generated_content:h,tool_calls:[]})),q(XT(!0)),!Z)throw new Error("Authentication token is required");const p=await hashValue(Z),f=await getConfirmitBaseUrl();if(!f)throw new Error("Error: No Confirmit base URL available. Please navigate to a Confirmit page first.");const m={instruction:h,token:p,baseUrl:f};if(Z&&K)try{B&&B(!0);const l=new MM({baseUrl:f,projectId:K,authToken:Z}),c=await l.getRoutingDataWithNewNode({createNode:!0,nodeType:"info",position:"After"});c.success&&c.routingData?m.routing_data=stripChildren(c.routingData):console.warn("\u26a0\ufe0f Failed to get routing data with new node for suggestion:",c.message);const d=await l.getSurveyDetails(K);let h=[];d.data?.languages&&(h=d.data.languages),m.languageCodes=h}catch(c){console.error("\u274c Failed to fetch routing data with new node:",c)}finally{B&&B(!1)}V("plan_replied",m,(l=>{console.log("Next 5 questions requested:",l)}))}catch(c){console.error("Failed to send next questions request:",c)}}),[q,V,Z,K,B]),isEmptyAssistantMessage=l=>!("assistant"!==l.role||l.generated_content||l.content||l.tool_calls&&0!==l.tool_calls.length),shouldShowNoActionsMessage=l=>{const d=l.id===ie[ie.length-1]?.id;return!c||!d},ie=(l||[]).map((l=>({...l,tool_calls:l.tool_calls?.map((l=>({...l,status:f.get(l.id)||l.status})))}))).filter(((l,d,h)=>"user"===l.role||(!c||d!==h.length-1||!isEmptyAssistantMessage(l))&&(l.generated_content||l.content||void 0!==l.tool_calls||P?.has(l.id))));return Kt.jsx("div",{className:"flex-1 overflow-y-auto px-4 py-6 pb-20",children:Kt.jsxs("div",{className:"flex flex-col gap-4  w-full ",children:[ie?.map(((l,c)=>Kt.jsx("div",{className:"message-enter",style:{animationDelay:.1*c+"s"},children:Kt.jsxs(Message,{className:"user"===l.role?"justify-end":"justify-start",children:["assistant"===l.role&&Kt.jsx(MessageAvatar,{src:"/avatars/ai.png",alt:"AI",fallback:"AI"}),Kt.jsxs("div",{className:"flex flex-col w-[100%]",children:["assistant"!==l.role&&Kt.jsx(MessageContent,{className:"user"===l.role?"message-bubble user bg-primary text-primary-foreground":"message-bubble assistant bg-muted/50 text-foreground",children:"user"===l.role?l?.generated_content||l?.content:""}),"assistant"===l.role&&Kt.jsxs(Kt.Fragment,{children:[l.tool_calls&&l.tool_calls.length>0?Kt.jsx(ToolCallsDisplay,{toolCalls:l.tool_calls,executingToolCalls:h,toolCallErrors:p,maxRetriesReached:m,onRetryToolCall:b,isDevMode:y,onCopy:w,onGroupFailure:handleGroupFailure}):!shouldShowNoActionsMessage(l)||P?.has(l?.id)||l?.has_error?null:Kt.jsx(MessageContent,{className:"message-bubble assistant bg-muted/50 text-foreground",children:"I understand, but I don't have any actions to perform at this moment."}),(P?.has(l?.id)||l?.has_error)&&(()=>{const c=l?.id?P?.get(l?.id):void 0,d=c?.errorType||l.error_type,h=d?NM?.[d]:void 0;return h?Kt.jsx("div",{className:"mt-3 rounded-lg border border-red-200 bg-red-50 p-3",children:Kt.jsxs("div",{className:"flex items-start gap-2",children:[Kt.jsx(as,{className:"h-4 w-4 text-red-500 mt-0.5 shrink-0"}),Kt.jsxs("div",{className:"flex-1 min-w-0",children:[Kt.jsx("span",{className:"text-sm font-medium text-red-700",children:"Error"}),h]})]})}):null})()]}),"sending"===l.status&&Kt.jsx("div",{className:"text-xs text-muted-foreground mt-1",children:"Sending..."}),"error"===l.status&&Kt.jsxs("div",{className:"flex items-center gap-2 mt-1",children:[Kt.jsx("div",{className:"text-xs text-red-500",children:"Failed to send"}),Kt.jsxs(or,{size:"sm",variant:"ghost",onClick:()=>_(l),className:"h-6 px-2 text-xs",children:[Kt.jsx(Ni,{className:"h-3 w-3 mr-1"}),"Retry"]})]})]})]})},l.id))),(()=>{if(!c)return!1;if(!ie.length)return!0;const l=ie[ie.length-1];return"user"===l.role||!("assistant"!==l.role||!isEmptyAssistantMessage(l))})()&&Kt.jsxs(Message,{className:"justify-start",children:[Kt.jsx(MessageAvatar,{src:"/avatars/ai.png",alt:"AI",fallback:"AI"}),Kt.jsxs("div",{className:"bg-muted/50 text-foreground rounded-lg p-2 flex items-center gap-2",children:[Kt.jsx(PulseDotLoader,{size:"sm"}),Kt.jsx("span",{className:"text-sm text-muted-foreground",children:"AI is thinking..."})]})]}),Kt.jsx(TimeoutMessage,{showTimeoutMessage:d,onRetry:E,onDismiss:M}),!c&&ie.length>0&&isEmptyAssistantMessage(ie[ie?.length-1])&&Kt.jsx(Message,{className:"justify-start",children:Kt.jsxs("div",{className:"border bg-white rounded-lg p-3 flex flex-col gap-3",children:[Kt.jsx("div",{className:"flex items-start gap-2",children:Kt.jsx("div",{className:"flex-1",children:Kt.jsx("p",{className:"text-sm",children:"No survey actions were generated this time. You can continue by creating the next set of survey elements and questions."})})}),Kt.jsx("div",{className:"flex gap-2",children:Kt.jsxs("div",{className:"flex items-center rounded-full overflow-hidden border border-violet-600",children:[Kt.jsxs(or,{disabled:!H,onClick:()=>se(Y),className:"rounded-none rounded-l-full font-medium bg-violet-600 hover:bg-violet-700 text-white px-3 h-9 text-sm",children:["Generate next ",Y," ",1===Y?"question":"questions"]}),Kt.jsxs(DropdownMenu,{children:[Kt.jsx(DropdownMenuTrigger,{asChild:!0,children:Kt.jsx(or,{disabled:!H,className:"rounded-none rounded-r-full font-medium bg-violet-700 hover:bg-violet-800 text-white px-2 h-9 border-l border-violet-500/30",children:Kt.jsx(ns,{className:"h-3.5 w-3.5"})})}),Kt.jsx(DropdownMenuContent,{align:"end",className:"min-w-[80px] p-1",children:ne.map((l=>Kt.jsx(DropdownMenuItem,{onSelect:()=>{ee(l)},className:tr("cursor-pointer justify-center py-1.5 px-3 text-sm font-medium transition-colors",l===Y?"bg-violet-600 text-white":"hover:bg-gray-100"),children:l},l)))})]})]})})]})}),!c&&ie.length>0&&"assistant"===ie[ie.length-1].role&&ie[ie.length-1].tool_calls&&ie[ie.length-1].tool_calls.length>0&&Kt.jsx(Message,{className:"justify-start",children:Kt.jsxs("div",{className:"border bg-white rounded-lg p-3 flex flex-col gap-3",children:[Kt.jsx("div",{className:"flex items-start gap-2",children:Kt.jsxs("div",{className:"flex-1",children:[Kt.jsx("p",{className:"text-sm font-medium",children:"Generation Complete"}),Kt.jsx("p",{className:"text-sm mt-1",children:"Please verify the changes before moving to the next questions. Review the generated content and tool execution results above."})]})}),Kt.jsx("div",{className:"flex gap-2",children:Kt.jsxs("div",{className:"flex items-center rounded-full overflow-hidden border border-violet-600",children:[Kt.jsxs(or,{disabled:!H,onClick:()=>se(Y),className:"rounded-none rounded-l-full font-medium bg-violet-600 hover:bg-violet-700 text-white px-3 h-9 text-sm",children:["Generate next ",Y," ",1===Y?"question":"questions"]}),Kt.jsxs(DropdownMenu,{children:[Kt.jsx(DropdownMenuTrigger,{asChild:!0,children:Kt.jsx(or,{disabled:!H,className:"rounded-none rounded-r-full font-medium bg-violet-700 hover:bg-violet-800 text-white px-2 h-9 border-l border-violet-500/30",children:Kt.jsx(ns,{className:"h-3.5 w-3.5"})})}),Kt.jsx(DropdownMenuContent,{align:"end",className:"min-w-[80px] p-1",children:ne.map((l=>Kt.jsx(DropdownMenuItem,{onSelect:()=>{ee(l)},className:tr("cursor-pointer justify-center py-1.5 px-3 text-sm font-medium transition-colors",l===Y?"bg-violet-600 text-white":"hover:bg-gray-100"),children:l},l)))})]})]})})]})})]})})},stripChildren=l=>{if(Array.isArray(l)){return l.filter((()=>!0)).map(stripChildren)}if(l&&"object"==typeof l){const{children:c,...d}=l;return Object.fromEntries(Object.entries(d).map((([l,c])=>[l,stripChildren(c)])))}return l},PM=Gt.forwardRef((({className:l,...c},d)=>Kt.jsx("textarea",{className:tr("flex min-h-[80px] w-full rounded-md border border-input bg-background px-3 py-2 text-base ring-offset-background placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50 md:text-sm",l),ref:d,...c})));PM.displayName="Textarea";const LM=Gt.createContext({isLoading:!1,value:"",setValue:()=>{},maxHeight:240,onSubmit:void 0,disabled:!1});function PromptInput({className:l,isLoading:c=!1,maxHeight:d=240,value:h,onValueChange:p,onSubmit:f,children:m,disabled:y=!1}){const[_,b]=Gt.useState(h||"");return Kt.jsx(_O,{children:Kt.jsx(LM.Provider,{value:{isLoading:c,value:h??_,setValue:p??(l=>{b(l),p?.(l)}),maxHeight:d,onSubmit:f,disabled:y},children:Kt.jsx("div",{className:tr("border-input bg-background rounded-3xl border p-2 shadow-xs",l),children:m})})})}function PromptInputTextarea({className:l,onKeyDown:c,disableAutosize:d=!1,...h}){const{value:p,setValue:f,maxHeight:m,onSubmit:y,disabled:_}=function(){const l=Gt.useContext(LM);if(!l)throw new Error("usePromptInput must be used within a PromptInput");return l}(),b=Gt.useRef(null);Gt.useEffect((()=>{d||b.current&&(b.current.style.height="auto",b.current.style.height="number"==typeof m?`${Math.min(b.current.scrollHeight,m)}px`:`min(${b.current.scrollHeight}px, ${m})`)}),[p,m,d]);return Kt.jsx(PM,{ref:b,value:p,onChange:l=>f(l.target.value),onKeyDown:l=>{"Enter"!==l.key||l.shiftKey||(l.preventDefault(),y?.()),c?.(l)},className:tr("text-primary min-h-[44px] w-full resize-none border-none bg-transparent shadow-none outline-none focus-visible:ring-0 focus-visible:ring-offset-0",l),rows:1,disabled:_,...h})}function PromptInputActions({children:l,className:c,...d}){return Kt.jsx("div",{className:tr("flex items-center gap-2",c),...d,children:l})}function PromptInputAction({tooltip:l,children:c,className:d,side:h="top",...p}){return Kt.jsxs(bO,{...p,children:[Kt.jsx(wO,{children:c}),Kt.jsx(SO,{side:h,className:d,children:l})]})}const useWebSocket=()=>{const l=useAppDispatch(),c=jR((l=>l.websocket)),d=jR((l=>l.chat)),h=Gt.useCallback(((c,d)=>{l(vR({sessionId:c,token:d}))}),[l]),p=Gt.useCallback((()=>{l(_R())}),[l]),f=Gt.useCallback((c=>{const d=`turn_${Date.now()}_${Math.random().toString(36).substr(2,9)}`,h={id:d,content:c,role:"user",timestamp:Date.now(),generated_content:"",tool_calls:[]};l(KT(h));const p=((l,c)=>{if(AR&&AR.readyState===WebSocket.OPEN){const d={type:"turn_message",id:c||generateTurnId(),content:l,role:"user",timestamp:Date.now()};return AR.send(JSON.stringify(d)),d.id}return console.error("WebSocket is not connected or is in an invalid state"),null})(c,d);return p||l(KT({...h,generated_content:"",tool_calls:[]})),d}),[l]),m=Gt.useCallback((c=>{const d=`msg_${Date.now()}_${Math.random().toString(36).substr(2,9)}`,h={id:d,content:c,role:"user",timestamp:Date.now(),status:"sending"};l(sR(h));const p=((l,c)=>{if(AR&&AR.readyState===WebSocket.OPEN){const d={type:"chat_message",id:c||generateTurnId(),content:l,role:"user",timestamp:Date.now()};return AR.send(JSON.stringify(d)),d.id}return console.error("WebSocket is not connected or is in an invalid state"),null})(c,d);return p||l(sR({...h,status:"error"})),d}),[l]),y=d.sessionData?.plan?.turns?.map((l=>({id:l.id,content:l.content,role:l.role,timestamp:l.timestamp,generated_content:l.generated_content,tool_calls:l.tool_calls,question_id:l.question_id,has_error:l.has_error,error_message:l.error_message,error_type:l.error_type,error_timestamp:l.error_timestamp})))||[];return{isConnected:c.isConnected,isConnecting:c.isConnecting,error:c.error,invalidAccess:c.invalidAccess,messages:y,turns:d.sessionData?.plan?.turns||[],isLoading:d.isLoading,sessionData:d.sessionData,isStreaming:d.sessionData?.plan?.is_streaming||!1,connect:h,disconnect:p,sendMessage:f,sendLegacyMessage:m,sendTurn:f}},PromptInputBasic=l=>{const[c,d]=Gt.useState(""),[h,p]=Gt.useState(!1),[f,m]=Gt.useState(!0),[y,_]=Gt.useState(!1),[b,w]=Gt.useState(!1),{sendEvent:E}=useWebSocketContext(),{messages:M}=useWebSocket(),{authToken:N,projectId:P}=useConfirmitProject(),L=l.isStreaming||h||!N||!l.isConfirmitSite||l.isOnValidSurveyPage;Gt.useEffect((()=>{N?_(!1):(_(!0),(async()=>{try{const l=await er.tabs.query({active:!0,currentWindow:!0});l[0]?.id&&await er.tabs.reload(l[0].id)}catch(l){console.error("Failed to reload tab:",l)}})())}),[N]),Gt.useEffect((()=>{M&&M.length>0&&m(!1)}),[M]);const j=qT(),D=Gt.useCallback((async()=>{const f=c.trim();if(!f||h)return;p(!0),d("");const y=`user-${Date.now()}`;l.lastUserMessageIdRef.current=y,j(KT({id:y,content:f,role:"user",timestamp:Date.now(),generated_content:f,tool_calls:[]})),j(XT(!0));try{const c=await getConfirmitBaseUrl(),d={instruction:f,token:await hashValue(N||""),baseUrl:c};if(N&&P){try{w(!0);const l=new MM({baseUrl:c||"",projectId:P,authToken:N}),h=await l.getRoutingDataWithNewNode({createNode:!0,nodeType:"info",position:"After"});h.success&&h.routingData?d.routing_data=h.routingData:console.warn("\u26a0\ufe0f Failed to get routing data with new node:",h.message);const p=await l.getSurveyDetails(P);let f=[];p.data?.languages&&(f=p.data.languages),d.languageCodes=f}catch(_){console.error("\u274c Failed to fetch routing data with new node:",_)}finally{w(!1)}m(!1)}const h=`user-${Date.now()}`;l.lastUserMessageIdRef.current=h,l.messageTimeoutRef.current&&clearTimeout(l.messageTimeoutRef.current),l.messageTimeoutRef.current=setTimeout((()=>{l.messageTimeoutRef.current=null,l.lastUserMessageIdRef.current=null,l.onTimeout(),l.isStreaming&&handleStopGeneration()}),12e4),E("plan_replied",d,(l=>{}))}catch(_){l.messageTimeoutRef.current&&(clearTimeout(l.messageTimeoutRef.current),l.messageTimeoutRef.current=null)}finally{p(!1),d("")}}),[c,h,N,P,l.messageTimeoutRef,l.onTimeout,l.isStreaming,E,w,m]),handleStopGeneration=()=>{E("stop_generation",{},(l=>{console.log("Generation stopped")}))},F=l.isStreaming||h||b||l.isLoadingRoutingData;return Kt.jsx("div",{className:"relative flex w-full",children:Kt.jsxs("div",{className:"flex min-w-0 flex-1 flex-col",children:[Kt.jsxs("div",{className:"flex items-center gap-2 px-3 py-2 text-xs text-muted-foreground border-b border-border/50",children:[Kt.jsx("div",{className:"flex items-center gap-1.5",children:Kt.jsx("div",{className:tr("w-2 h-2 rounded-full transition-all duration-300",l.isStreaming?"bg-blue-500 animate-pulse":L?"bg-red-500 animate-ping":"bg-green-500")})}),L&&!l.isStreaming?Kt.jsx("div",{className:"flex items-center gap-1 text-yellow-600",children:Kt.jsx("span",{children:"Please switch to an active survey page to start generating and navigating"})}):y?Kt.jsxs("div",{className:"flex items-center gap-1 text-yellow-600",children:[Kt.jsx(wi,{className:"h-3 w-3 animate-spin"}),Kt.jsx("span",{children:"Loading token in 5 seconds..."})]}):l.isStreaming?Kt.jsxs("div",{className:"flex items-center gap-1 text-blue-600",children:[Kt.jsx(wi,{className:"h-3 w-3 animate-spin"}),Kt.jsx("span",{children:"Generating response... "})]}):b||l.isLoadingRoutingData?Kt.jsxs("div",{className:"flex items-center gap-1 text-blue-600",children:[Kt.jsx(wi,{className:"h-3 w-3 animate-spin"}),Kt.jsx("span",{children:"Loading question data..."})]}):N?Kt.jsxs("div",{className:"flex items-center gap-1 text-muted-foreground/70",children:[Kt.jsx("span",{children:"\u2022"}),Kt.jsx("span",{children:"Ready to process requests"})]}):null]}),Kt.jsx("div",{className:"p-3",children:Kt.jsxs(PromptInput,{value:c,onValueChange:l=>{d(l)},isLoading:F,onSubmit:D,disabled:L,className:"w-full",children:[Kt.jsx(PromptInputTextarea,{placeholder:l.isStreaming?"Generation in progress... Please wait":"Ask me anything...",className:tr("min-h-[20px] max-h-[200px] w-full resize-none border-0 bg-transparent px-0 py-0","text-sm placeholder:text-muted-foreground focus-visible:ring-0 focus-visible:ring-offset-0","scrollbar-thin scrollbar-track-transparent scrollbar-thumb-border",l.isStreaming&&"cursor-not-allowed opacity-75")}),Kt.jsx(PromptInputActions,{className:"flex justify-end pt-2",children:l.isStreaming?Kt.jsx(PromptInputAction,{tooltip:"Stop generation",children:Kt.jsx(or,{variant:"destructive",size:"icon",onClick:handleStopGeneration,className:"h-8 w-8 rounded-lg transition-all duration-200 hover:scale-105",children:Kt.jsx(Fi,{className:"h-4 w-4"})})}):Kt.jsx(PromptInputAction,{tooltip:F?"Loading...":"Send message",children:Kt.jsx(or,{variant:"default",size:"icon",onClick:D,disabled:!c.trim()||L,className:tr("h-8 w-8 rounded-lg transition-all duration-200",(!c.trim()||L)&&"opacity-50 cursor-not-allowed"),children:F?Kt.jsx(wi,{className:"h-4 w-4 animate-spin"}):Kt.jsx(es,{className:"h-4 w-4"})})})})]})})]})})},SettingsModal=({isOpen:l,onClose:c,onLogout:d})=>{if(!l)return null;return Kt.jsx("div",{className:"fixed inset-0 z-50 bg-black/50 backdrop-blur-sm animate-in fade-in-0",children:Kt.jsx("div",{className:"fixed inset-x-0 inset-y-0 z-50 overflow-hidden",children:Kt.jsx("div",{className:"flex min-h-full items-center justify-center p-4",children:Kt.jsxs("div",{className:"relative w-full max-w-md rounded-lg bg-background shadow-lg animate-in slide-in-from-bottom-2",children:[Kt.jsxs("div",{className:"flex items-center justify-between border-b p-6",children:[Kt.jsx("h2",{className:"text-lg font-semibold",children:"Settings"}),Kt.jsx(or,{variant:"ghost",size:"icon",onClick:c,className:"h-8 w-8",children:Kt.jsx(Qi,{className:"h-4 w-4"})})]}),Kt.jsx("div",{className:"p-6 space-y-4",children:Kt.jsxs("div",{className:"space-y-4",children:[Kt.jsx("h3",{className:"text-sm font-medium text-muted-foreground",children:"Account"}),Kt.jsxs(or,{variant:"outline",className:tr("w-full justify-start gap-2","hover:bg-red-50 hover:text-red-600 hover:border-red-200","dark:hover:bg-red-950/10 dark:hover:text-red-400 dark:hover:border-red-900"),onClick:()=>{d(),c()},children:[Kt.jsx(xi,{className:"h-4 w-4"}),"Log out"]}),Kt.jsx("p",{className:"text-xs text-muted-foreground",children:"This will log you out and reload the page."})]})})]})})})})},AIRulesViewModal=({isOpen:l,onClose:c,currentFolderIds:d=[]})=>{const{data:h,isLoading:p,isError:f,refetch:m}=((l,c=!0)=>useQuery({queryKey:["ai-rules","folders","by-ids",...l||[]],queryFn:async()=>{if(!l||0===l.length)return[];try{const c=`${IC.api_url}/ai_rules/folders?output_platform=confirmit`,d=await fetchWithAuth(c);if(!d.ok)return[];return((await d.json()).folders||[]).filter((c=>l.includes(c.folder_id)))}catch(c){return[]}},enabled:c&&!!(l&&l.length>0),staleTime:0,refetchOnWindowFocus:!1}))(d,l);Gt.useEffect((()=>{l&&d&&d.length>0&&m()}),[l,d.length,m]);return l?Kt.jsx("div",{className:"fixed inset-0 z-50 bg-black/50 backdrop-blur-sm animate-in fade-in-0",children:Kt.jsx("div",{className:"fixed inset-x-0 inset-y-0 z-50 overflow-hidden",children:Kt.jsx("div",{className:"flex min-h-full items-center justify-center p-4",children:Kt.jsxs("div",{className:"relative w-full max-w-md rounded-lg bg-background shadow-lg animate-in slide-in-from-bottom-2 max-h-[80vh] flex flex-col",children:[Kt.jsxs("div",{className:"flex items-center justify-between border-b p-6",children:[Kt.jsxs("div",{className:"flex items-center gap-2",children:[Kt.jsx(Us,{className:"h-5 w-5 text-primary"}),Kt.jsx("h2",{className:"text-lg font-semibold",children:"Active AI Rules"})]}),Kt.jsx(or,{variant:"ghost",size:"icon",onClick:c,className:"h-8 w-8",children:Kt.jsx(Qi,{className:"h-4 w-4"})})]}),Kt.jsxs("div",{className:"flex-1 overflow-y-auto p-6",children:[Kt.jsxs("div",{className:"mb-6 p-4 bg-muted/50 rounded-lg border border-border",children:[Kt.jsx("p",{className:"text-sm text-muted-foreground mb-3",children:"View and manage your AI Rules folders in the main dashboard."}),Kt.jsxs(or,{variant:"outline",size:"sm",className:"w-full",onClick:()=>{window.open((()=>{const l=IC.api_url;let c="https://app.workhack.ai";return l.includes("localhost")?c="http://localhost:3000":l.includes("dev.metaforms.ai")?c="https://app.dev.metaforms.ai":l.includes("staging.metaforms.ai")&&(c="https://app.staging.metaforms.ai"),`${c}/ai-rules`})(),"_blank")},children:[Kt.jsx(Ms,{className:"h-4 w-4 mr-2"}),"Manage AI Rules"]})]}),p&&Kt.jsxs("div",{className:"flex flex-col items-center justify-center py-8 space-y-3",children:[Kt.jsx(wi,{className:"h-8 w-8 animate-spin text-muted-foreground"}),Kt.jsx("p",{className:"text-sm text-muted-foreground",children:"Loading AI Rules..."})]}),f&&Kt.jsxs("div",{className:"text-center py-8 space-y-3",children:[Kt.jsx(as,{className:"h-12 w-12 text-destructive mx-auto"}),Kt.jsx("p",{className:"text-sm text-muted-foreground",children:"Failed to load AI Rules folders"}),Kt.jsx(or,{variant:"outline",size:"sm",onClick:()=>m(),children:"Try Again"})]}),!p&&!f&&Kt.jsxs("div",{className:"space-y-3",children:[Kt.jsx("p",{className:"text-sm font-medium text-foreground mb-3",children:"Active Rules for this Session"}),h&&h.length>0?Kt.jsx("div",{className:"space-y-2",children:h.map((l=>Kt.jsx("div",{className:"p-4 bg-muted/30 rounded-lg border border-border",children:Kt.jsx("div",{className:"flex items-start justify-between",children:Kt.jsxs("div",{className:"flex-1 min-w-0",children:[Kt.jsxs("div",{className:"flex items-center gap-2 mb-1",children:[Kt.jsx("h3",{className:"font-medium text-sm text-foreground truncate",children:l.name}),"always"===l.when_to_use&&Kt.jsx("span",{className:"inline-flex items-center px-2 py-0.5 rounded text-xs font-medium bg-primary/10 text-primary",children:"Always"})]}),l.description&&Kt.jsx("p",{className:"text-xs text-muted-foreground mt-1",children:l.description})]})})},l.folder_id)))}):Kt.jsxs("div",{className:"text-center py-8 space-y-3",children:[Kt.jsx(Us,{className:"h-12 w-12 text-muted-foreground mx-auto opacity-50"}),Kt.jsxs("div",{children:[Kt.jsx("p",{className:"text-sm font-medium text-foreground",children:"No AI Rules active"}),Kt.jsx("p",{className:"text-xs text-muted-foreground mt-1",children:"This session doesn't have any AI Rules folders configured"})]})]})]})]}),Kt.jsx("div",{className:"border-t p-4",children:Kt.jsx(or,{variant:"outline",className:"w-full",onClick:c,children:"Close"})})]})})})}):null},jM=dr("inline-flex items-center rounded-md border px-2.5 py-0.5 text-xs font-semibold transition-colors focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2",{variants:{variant:{default:"border-transparent bg-primary text-primary-foreground shadow hover:bg-primary/80",secondary:"border-transparent bg-secondary text-secondary-foreground hover:bg-secondary/80",destructive:"border-transparent bg-destructive text-destructive-foreground shadow hover:bg-destructive/80",outline:"text-foreground"}},defaultVariants:{variant:"default"}});function Badge({className:l,variant:c,...d}){return Kt.jsx("div",{className:tr(jM({variant:c}),l),...d})}const DM=100,isValidUrl=l=>{try{const c=l.match(/^https?:\/\//)?l:`https://${l}`;return new URL(c).hostname.includes(".")?{valid:!0}:{valid:!1,error:"Invalid URL format - must include domain"}}catch{return{valid:!1,error:"Invalid URL format"}}},ImageThumbnail=({url:l,index:c,onError:d,onLoad:h,hasError:p,isLoading:f})=>p?Kt.jsxs("div",{className:"w-full h-full flex flex-col items-center justify-center bg-muted text-muted-foreground p-2 text-center",children:[Kt.jsx(hi,{className:"h-6 w-6 mb-1 opacity-50"}),Kt.jsx("span",{className:"text-[10px] leading-tight",children:"Failed to load"})]}):Kt.jsxs("div",{className:"relative w-full h-full bg-muted/30",children:[f&&Kt.jsx("div",{className:"absolute inset-0 flex items-center justify-center bg-muted/50 z-10 backdrop-blur-[1px]",children:Kt.jsx("div",{className:"h-5 w-5 border-2 border-primary/50 border-t-primary rounded-full animate-spin"})}),Kt.jsx("img",{src:l,alt:`Preview ${c+1}`,className:"w-full h-full object-cover transition-opacity duration-300",style:{opacity:f?0:1},onError:()=>d(l),onLoad:()=>h(l),loading:"lazy"})]}),MediaUploadModal=({isOpen:l,onClose:c,onSave:d,initialFiles:h=[],projectId:p,accessToken:f,preSession:m=!1,saveLabel:y,cancelLabel:_,onBack:b})=>{const[w,E]=Gt.useState(h),[M,N]=Gt.useState(""),[P,L]=Gt.useState([]),[j,D]=Gt.useState(""),[F,U]=Gt.useState(1),[B,H]=Gt.useState(new Set),[z,q]=Gt.useState(new Set),[V,Z]=Gt.useState(new Set),[K,Y]=Gt.useState(!1),[ee,ne]=Gt.useState(new Set),[se,ie]=Gt.useState(!1),[oe,le]=Gt.useState({alreadyInList:[],inCurrentInput:[]}),[ce,pe]=Gt.useState(!1),fe=Gt.useRef(null),ge=m?K:K||!p||!f;if(Gt.useEffect((()=>{0!==h.length&&(E((l=>{if(0===l.length)return h;const c=new Set(h.map((l=>l.order_key)).filter(Boolean));return[...[...l.filter((l=>l.order_key&&!c.has(l.order_key))),...h]].sort(((l,c)=>l.order_key||c.order_key?l.order_key?c.order_key?c.order_key.localeCompare(l.order_key):-1:1:0))})),U(1))}),[h]),Gt.useEffect((()=>{const l=new Set(w.map((l=>l.url)));H((c=>{if(0===c.size)return c;const d=new Set;return c.forEach((c=>{l.has(c)&&d.add(c)})),d})),q((c=>{if(0===c.size)return c;const d=new Set;return c.forEach((c=>{l.has(c)&&d.add(c)})),d}))}),[w]),Gt.useEffect((()=>{const l=M.trim(),c=l?[...P,l]:[...P];if(0===c.length)return void((oe.alreadyInList.length>0||oe.inCurrentInput.length>0)&&le({alreadyInList:[],inCurrentInput:[]}));const d=[];for(const w of c){isValidUrl(w).valid&&d.push(w)}const h=new Set(w.filter((l=>!ee.has(l.url))).map((l=>l.url))),p=new Map;for(const w of d)p.set(w,(p.get(w)||0)+1);const f=[],m=[];p.forEach(((l,c)=>{if(h.has(c))f.push({url:c,count:l});else for(let d=0;d<l;d++)m.push(c)}));const y=new Map;for(const w of m)y.set(w,(y.get(w)||0)+1);const _=[];y.forEach(((l,c)=>{l>1&&_.push({url:c,count:l})}));const b=f.length===oe.alreadyInList.length&&f.every((l=>oe.alreadyInList.some((c=>c.url===l.url&&c.count===l.count)))),E=_.length===oe.inCurrentInput.length&&_.every((l=>oe.inCurrentInput.some((c=>c.url===l.url&&c.count===l.count))));b&&E||le({alreadyInList:f,inCurrentInput:_})}),[P,M,w,ee,oe]),!l)return null;const be=Math.ceil(w.length/8),Oe=8*(F-1),Ne=Oe+8,De=w.slice(Oe,Ne),handleImageError=l=>{H((c=>new Set(c).add(l))),q((c=>{const d=new Set(c);return d.delete(l),d}))},handleImageLoad=l=>{q((c=>{const d=new Set(c);return d.delete(l),d}))},handleRemovePendingUrl=l=>{L((c=>{const d=c.filter(((c,d)=>d!==l));return 0!==d.length||M.trim()||(D(""),le({alreadyInList:[],inCurrentInput:[]}),pe(!1)),d}))},handleAddUrls=()=>{const l=M.trim(),c=l?[...P,l]:P;if(0===c.length)return void D("Please enter at least one URL");const d=[],h=[];if(c.forEach((l=>{const c=isValidUrl(l);c.valid?h.push(l):d.push({url:l,error:c.error||"Invalid URL"})})),d.length>0){const l=d.slice(0,3).map((({url:l,error:c})=>`\u2022 ${l.substring(0,40)}${l.length>40?"...":""}: ${c}`)).join("\n"),c=d.length>3?` (and ${d.length-3} more)`:"";return void D(`Invalid URLs detected${c}:\n${l}`)}if(oe.alreadyInList.length>0||oe.inCurrentInput.length>0){pe(!0);const l=oe.alreadyInList.reduce(((l,c)=>l+c.count),0)+oe.inCurrentInput.reduce(((l,c)=>l+(c.count-1)),0);return void D(`Found ${l} duplicate instance${1!==l?"s":""}. Please review.`)}if(w.length+h.length>DM)return void D(`Cannot add ${h.length} URLs. Maximum limit is 100 files. You currently have ${w.length}.`);const p=Date.now(),f=[...[...h.map(((l,c)=>{const d=(l=>{try{const c=l.split("?")[0].split("#")[0],d=c.match(/^https?:\/\//)?c:`https://${c}`,h=new URL(d).pathname;return(h.startsWith("/")?h.slice(1):h).replace(/\.[^.]+$/,"")||""}catch{const c=l.match(/([^\/]+?)(?:\.[^.\/]+)?$/);return c&&c[1]?c[1]:""}})(l);return{url:l,description:d.slice(0,60),order_key:`${p}-${c+1}`}})),...w]].sort(((l,c)=>l.order_key||c.order_key?l.order_key?c.order_key?c.order_key.localeCompare(l.order_key):-1:1:0));E(f),Z((l=>{const d=new Set(l);return c.forEach((l=>d.add(l))),d})),N(""),L([]),D(""),le({alreadyInList:[],inCurrentInput:[]}),pe(!1),U(1)},handleRemoveFile=l=>{const c=w[l].url;V.has(c)?(E((c=>c.filter(((c,d)=>d!==l)))),Z((l=>{const d=new Set(l);return d.delete(c),d})),H((l=>{const d=new Set(l);return d.delete(c),d})),q((l=>{const d=new Set(l);return d.delete(c),d}))):ne((l=>{const d=new Set(l);return d.has(c)?d.delete(c):(d.add(c),H((l=>{const d=new Set(l);return d.delete(c),d})),q((l=>{const d=new Set(l);return d.delete(c),d}))),d}))},handleClose=()=>{K||(D(""),le({alreadyInList:[],inCurrentInput:[]}),pe(!1),H(new Set),q(new Set),c())},renderFileListItem=(l,c,d)=>{const h=V.has(l.url),p=B.has(l.url),f=z.has(l.url),m=ee.has(l.url);return Kt.jsxs("div",{className:tr("group relative flex flex-col sm:flex-row gap-4 p-3 rounded-lg border transition-all duration-200",m?"bg-red-50/50 border-red-100 opacity-80":"hover:bg-accent/5 border-border/40"),children:[Kt.jsxs("div",{className:"relative shrink-0",children:[Kt.jsx("div",{className:tr("w-full sm:w-24 h-32 sm:h-24 rounded-lg overflow-hidden border bg-muted/20",m&&"grayscale opacity-70"),children:Kt.jsx(ImageThumbnail,{url:l.url,index:d,onError:handleImageError,onLoad:handleImageLoad,hasError:p,isLoading:f})}),h&&!m&&Kt.jsx(Badge,{variant:"default",className:"absolute -top-2 -left-2 text-[10px] px-1.5 h-5 bg-blue-600 hover:bg-blue-700 shadow-sm",children:"New"})]}),Kt.jsxs("div",{className:"flex-1 min-w-0 flex flex-col justify-between gap-2",children:[Kt.jsxs("div",{className:"space-y-1",children:[Kt.jsxs("div",{className:"flex items-start justify-between gap-4",children:[Kt.jsxs("div",{className:"flex items-center gap-2 min-w-0",children:[Kt.jsx("div",{className:"p-1 rounded bg-primary/5 text-primary shrink-0",children:Kt.jsx(_i,{className:"w-3 h-3"})}),Kt.jsx("p",{className:tr("text-sm font-mono text-foreground/90 truncate max-w-[200px] sm:max-w-md",m&&"line-through text-muted-foreground"),title:l.url,children:l.url})]}),Kt.jsx(or,{variant:"ghost",size:"icon",onClick:()=>handleRemoveFile(d),className:tr("h-8 w-8 sm:hidden -mt-1 -mr-2",m?"text-green-600 hover:text-green-700 hover:bg-green-50":"text-muted-foreground hover:text-red-600 hover:bg-red-50"),children:m?Kt.jsx(Gi,{className:"h-4 w-4"}):Kt.jsx(qi,{className:"h-4 w-4"})})]}),m&&Kt.jsxs("div",{className:"flex items-center gap-2 text-xs text-red-600 font-medium",children:[Kt.jsx(as,{className:"w-3 h-3"}),"Marked for deletion"]})]}),Kt.jsxs("div",{className:"mt-1",children:[Kt.jsx("label",{htmlFor:`media-desc-${d}`,className:"text-[11px] font-medium text-muted-foreground mb-1 flex items-center gap-1 pl-1",children:"Description for AI"}),Kt.jsxs("div",{className:"relative group/input",children:[Kt.jsx("div",{className:"absolute inset-y-0 left-0 pl-2.5 flex items-center pointer-events-none",children:Kt.jsx(Ei,{className:"h-3 w-3 text-muted-foreground/50 group-focus-within/input:text-primary/50 transition-colors"})}),Kt.jsx(NI,{id:`media-desc-${d}`,placeholder:"Add a description for AI...",value:l.description,onChange:l=>((l,c)=>{const d=c.slice(0,60);E(w.map(((c,h)=>h===l?{...c,description:d}:c)))})(d,l.target.value),className:tr("pl-8 h-8 text-sm bg-muted/20 border-transparent focus:bg-background focus:border-input transition-all",m&&"opacity-50 pointer-events-none"),maxLength:60,disabled:m,"aria-describedby":`media-desc-help-${d}`}),Kt.jsx("div",{className:"absolute inset-y-0 right-0 pr-2.5 flex items-center pointer-events-none",children:Kt.jsxs("span",{className:"text-[10px] text-muted-foreground/50",children:[l.description.length,"/60"]})})]})]})]}),Kt.jsx("div",{className:"hidden sm:flex flex-col items-end gap-2",children:Kt.jsx(or,{variant:"ghost",size:"icon",onClick:()=>handleRemoveFile(d),className:tr("h-8 w-8 rounded-full transition-colors",m?"bg-green-50 text-green-600 hover:bg-green-100 hover:text-green-700":"text-muted-foreground hover:bg-red-50 hover:text-red-600"),title:m?"Undo deletion":"Mark for deletion",children:m?Kt.jsx(Gi,{className:"h-4 w-4"}):Kt.jsx(qi,{className:"h-4 w-4"})})})]},`${l.url}-${d}`)};return Kt.jsxs("div",{className:"fixed inset-0 z-50 bg-background/80 backdrop-blur-sm animate-in fade-in-0",children:[Kt.jsx("div",{className:"fixed inset-0 z-50 flex items-center justify-center p-4 sm:p-6 overflow-y-auto",children:Kt.jsxs("div",{className:"w-full max-w-4xl max-h-[90vh] flex flex-col bg-card rounded-xl shadow-2xl border animate-in slide-in-from-bottom-4 duration-300",role:"dialog","aria-modal":"true",children:[Kt.jsxs("div",{className:"flex items-center justify-between px-6 py-4 border-b bg-muted/5",children:[Kt.jsxs("div",{children:[Kt.jsxs("h2",{className:"text-xl font-semibold tracking-tight flex items-center gap-2",children:["Manage Media",Kt.jsxs(Badge,{variant:"outline",className:"font-normal text-xs",children:[w.length,"/",DM]})]}),Kt.jsx("p",{className:"text-sm text-muted-foreground mt-1",children:"Add reference images for AI analysis and context."})]}),Kt.jsx(or,{variant:"ghost",size:"icon",onClick:handleClose,className:"h-9 w-9 rounded-full hover:bg-muted",children:Kt.jsx(Qi,{className:"h-5 w-5"})})]}),Kt.jsx("div",{className:"flex-1 overflow-y-auto min-h-0",children:Kt.jsxs("div",{className:"p-6 space-y-8",children:[Kt.jsxs("div",{className:"space-y-3",children:[Kt.jsxs("div",{className:"flex items-center justify-between",children:[Kt.jsx("label",{className:"text-sm font-medium text-foreground",children:"Add Image URLs"}),(P.length>0||M.trim())&&Kt.jsx(or,{variant:"ghost",size:"sm",onClick:()=>{L([]),N(""),D(""),le({alreadyInList:[],inCurrentInput:[]}),pe(!1)},className:"h-6 px-2 text-xs text-muted-foreground hover:text-foreground",children:"Clear all"})]}),Kt.jsxs("div",{className:tr("group bg-background border rounded-lg p-1.5 focus-within:ring-2 focus-within:ring-ring focus-within:ring-offset-2 transition-all cursor-text",j&&"border-red-200 focus-within:ring-red-200"),onClick:()=>fe.current?.focus(),children:[Kt.jsxs("div",{className:"flex flex-wrap gap-2 p-1",children:[P.map(((l,c)=>Kt.jsxs(Badge,{variant:"secondary",className:"h-7 px-2.5 font-normal text-sm flex items-center gap-1.5 bg-muted text-foreground hover:bg-muted/80",children:[Kt.jsx("span",{className:"truncate max-w-[200px]",children:l}),Kt.jsx("button",{type:"button",onClick:()=>handleRemovePendingUrl(c),className:"ml-1 hover:bg-background/50 rounded-full p-0.5 transition-colors",children:Kt.jsx(Qi,{className:"h-3 w-3"})})]},c))),Kt.jsx("input",{ref:fe,type:"text",placeholder:0===P.length?"Paste image URLs here (space or comma separated)...":"Add more...",value:M,onChange:l=>(l=>{if(N(l),(j||oe.alreadyInList.length>0||oe.inCurrentInput.length>0)&&(D(""),le({alreadyInList:[],inCurrentInput:[]}),pe(!1)),l.includes(",")||l.includes(" ")){const c=l.split(/[,\s]+/),d=c.slice(0,-1).map((l=>l.trim())).filter((l=>l.length>0));d.length>0&&(L((l=>[...l,...d])),N(c[c.length-1]))}})(l.target.value),onKeyDown:l=>{"Enter"===l.key?(l.preventDefault(),handleAddUrls()):"Backspace"===l.key&&!M&&P.length>0&&handleRemovePendingUrl(P.length-1)},className:"flex-1 min-w-[200px] bg-transparent border-none outline-none text-sm h-7 px-1 placeholder:text-muted-foreground/60"})]}),Kt.jsxs("div",{className:"border-t mt-2 pt-2 px-1 flex items-center justify-between",children:[Kt.jsxs("div",{className:"text-xs text-muted-foreground",children:["Press"," ",Kt.jsx("kbd",{className:"px-1 py-0.5 bg-muted rounded text-[10px] font-sans",children:"Enter"})," ","to add"]}),Kt.jsxs(or,{onClick:handleAddUrls,disabled:w.length>=DM||0===P.length&&!M.trim(),size:"sm",className:"h-7 text-xs",children:[Kt.jsx(Mi,{className:"h-3 w-3 mr-1.5"}),"Add URLs"]})]})]}),j&&Kt.jsxs("div",{className:"bg-red-50 text-red-900 text-sm p-3 rounded-md flex items-start gap-2 border border-red-100",children:[Kt.jsx(as,{className:"h-4 w-4 mt-0.5 shrink-0 text-red-600"}),Kt.jsx("div",{className:"whitespace-pre-wrap",children:j})]}),(oe.alreadyInList.length>0||oe.inCurrentInput.length>0)&&Kt.jsxs("div",{className:"border border-amber-200 bg-amber-50/50 rounded-lg overflow-hidden",children:[Kt.jsxs("button",{onClick:()=>pe(!ce),className:"w-full flex items-center justify-between p-3 text-sm font-medium text-amber-900 hover:bg-amber-50 transition-colors",children:[Kt.jsxs("div",{className:"flex items-center gap-2",children:[Kt.jsx(Vi,{className:"h-4 w-4 text-amber-600"}),Kt.jsxs("span",{children:[oe.alreadyInList.length+oe.inCurrentInput.length," ","Potential Duplicate(s) Found"]})]}),ce?Kt.jsx(os,{className:"h-4 w-4"}):Kt.jsx(ns,{className:"h-4 w-4"})]}),ce&&Kt.jsx("div",{className:"px-3 pb-3 pt-0 border-t border-amber-200/50",children:Kt.jsxs("div",{className:"mt-2 space-y-2 text-xs text-amber-800/80",children:[oe.alreadyInList.map(((l,c)=>Kt.jsxs("div",{className:"flex gap-2",children:[Kt.jsx("span",{className:"font-mono bg-amber-100/50 px-1 rounded text-amber-900",children:l.url}),Kt.jsx("span",{children:"(Already in list)"})]},`exist-${c}`))),oe.inCurrentInput.map(((l,c)=>Kt.jsxs("div",{className:"flex gap-2",children:[Kt.jsx("span",{className:"font-mono bg-amber-100/50 px-1 rounded text-amber-900",children:l.url}),Kt.jsxs("span",{children:["(Repeated ",l.count," times)"]})]},`new-${c}`)))]})})]})]}),w.length>0?Kt.jsxs("div",{className:"space-y-4",children:[Kt.jsxs("div",{className:"flex items-center justify-between pb-2 border-b",children:[Kt.jsxs("h3",{className:"text-sm font-medium flex items-center gap-2",children:[Kt.jsx(Ls,{className:"h-4 w-4 text-primary"}),"Files List"]}),be>1&&Kt.jsxs("div",{className:"text-xs text-muted-foreground",children:["Page ",F," of ",be]})]}),Kt.jsx("div",{className:"space-y-3",children:De.map(((l,c)=>renderFileListItem(l,0,Oe+c)))}),be>1&&Kt.jsxs("div",{className:"flex items-center justify-center gap-2 pt-4",children:[Kt.jsx(or,{variant:"outline",size:"sm",onClick:()=>U((l=>Math.max(1,l-1))),disabled:1===F,className:"h-8 w-8 p-0",children:Kt.jsx(ss,{className:"h-4 w-4"})}),Kt.jsxs("span",{className:"text-sm font-medium min-w-[3rem] text-center",children:[F," / ",be]}),Kt.jsx(or,{variant:"outline",size:"sm",onClick:()=>U((l=>Math.min(be,l+1))),disabled:F===be,className:"h-8 w-8 p-0",children:Kt.jsx(is,{className:"h-4 w-4"})})]})]}):Kt.jsxs("div",{className:"flex flex-col items-center justify-center py-12 text-muted-foreground border-2 border-dashed rounded-xl bg-muted/5",children:[Kt.jsx(mi,{className:"h-12 w-12 mb-3 opacity-20"}),Kt.jsx("p",{className:"text-sm font-medium",children:"No images added yet"}),Kt.jsx("p",{className:"text-xs opacity-60",children:"Paste URLs above to get started"})]})]})}),Kt.jsxs("div",{className:"border-t bg-muted/5 p-4 sm:px-6",children:[K&&Kt.jsxs("div",{className:"w-full h-1 bg-muted rounded-full overflow-hidden mb-4",children:[Kt.jsx("div",{className:"h-full bg-primary animate-[slide_1s_ease-in-out_infinite] w-1/3 relative left-0",style:{animation:"slide 1.5s ease-in-out infinite"}}),Kt.jsx("style",{children:"\n                  @keyframes slide {\n                    0% { transform: translateX(-100%); }\n                    100% { transform: translateX(400%); }\n                  }\n                "})]}),Kt.jsxs("div",{className:"flex items-center justify-between gap-4",children:[Kt.jsx("div",{className:"text-xs text-muted-foreground hidden sm:block",children:K?"Processing...":ee.size>0?`${ee.size} file(s) marked for deletion`:`${w.length} files ready`}),Kt.jsxs("div",{className:"flex gap-3 ml-auto",children:[Kt.jsx(or,{variant:"outline",onClick:handleClose,disabled:K,className:"min-w-[80px]",children:_??"Cancel"}),Kt.jsx(or,{onClick:()=>{ie(!0)},disabled:ge,className:"min-w-[100px]",children:K?m?"Generating...":"Saving...":y??(m?"Generate Session":"Save Changes")})]})]})]})]})}),se&&Kt.jsx("div",{className:"fixed inset-0 z-[60] bg-black/60 backdrop-blur-sm flex items-center justify-center p-4 animate-in fade-in duration-200",children:Kt.jsxs("div",{className:"bg-background rounded-xl shadow-2xl max-w-md w-full p-6 border animate-in zoom-in-95 duration-200",children:[Kt.jsxs("div",{className:"flex flex-col items-center text-center mb-6",children:[Kt.jsx("h3",{className:"text-lg font-semibold",children:m?"Generate Session":"Save Changes"}),Kt.jsx("p",{className:"text-sm text-muted-foreground mt-2 px-4",children:m?"This will create a new session and you'll be able to start\n                  chatting.":ee.size>0?`You are about to save ${w.length-ee.size} files and delete ${ee.size} files.`:`This will save ${w.length} files to your project.`})]}),Kt.jsxs("div",{className:"grid grid-cols-2 gap-3",children:[Kt.jsx(or,{variant:"outline",onClick:()=>ie(!1),className:"w-full",children:"Cancel"}),Kt.jsx(or,{onClick:async()=>{ie(!1),Y(!0);try{const l=w.filter((l=>!ee.has(l.url))),h=w.filter((l=>ee.has(l.url))).map((l=>l.url));await d(l),E(l),ne(new Set),Z(new Set),h.length>0&&(H((l=>{const c=new Set(l);return h.forEach((l=>c.delete(l))),c})),q((l=>{const c=new Set(l);return h.forEach((l=>c.delete(l))),c}))),m||c()}catch(l){console.error("Error saving media files:",l),D(l instanceof Error?`Failed to save: ${l.message}`:"Failed to save changes. Please try again.")}finally{Y(!1)}},className:"w-full",children:m?"Generate":"Confirm Save"})]})]})})]})},FM={damping:.7,stiffness:.05,mass:1.25},$M=1e3/60;let UM=!1;globalThis.document?.addEventListener("mousedown",(()=>{UM=!0})),globalThis.document?.addEventListener("mouseup",(()=>{UM=!1})),globalThis.document?.addEventListener("click",(()=>{UM=!1}));const useStickToBottom=(l={})=>{const[c,d]=Gt.useState(!1),[h,p]=Gt.useState(!1!==l.initial),[f,m]=Gt.useState(!1),y=Gt.useRef(null);y.current=l;const _=Gt.useCallback((()=>{if(!UM)return!1;const l=window.getSelection();if(!l||!l.rangeCount)return!1;const c=l.getRangeAt(0);return c.commonAncestorContainer.contains(j.current)||j.current?.contains(c.commonAncestorContainer)}),[]),b=Gt.useCallback((l=>{E.isAtBottom=l,p(l)}),[]),w=Gt.useCallback((l=>{E.escapedFromLock=l,d(l)}),[]),E=Gt.useMemo((()=>{let d;return{escapedFromLock:c,isAtBottom:h,resizeDifference:0,accumulated:0,velocity:0,listeners:new Set,get scrollTop(){return j.current?.scrollTop??0},set scrollTop(l){j.current&&(j.current.scrollTop=l,E.ignoreScrollToTop=j.current.scrollTop)},get targetScrollTop(){return j.current&&D.current?j.current.scrollHeight-1-j.current.clientHeight:0},get calculatedTargetScrollTop(){if(!j.current||!D.current)return 0;const{targetScrollTop:c}=this;if(!l.targetScrollTop)return c;if(d?.targetScrollTop===c)return d.calculatedScrollTop;const h=Math.max(Math.min(l.targetScrollTop(c,{scrollElement:j.current,contentElement:D.current}),c),0);return d={targetScrollTop:c,calculatedScrollTop:h},requestAnimationFrame((()=>{d=void 0})),h},get scrollDifference(){return this.calculatedTargetScrollTop-this.scrollTop},get isNearBottom(){return this.scrollDifference<=70}}}),[]),M=Gt.useCallback(((l={})=>{"string"==typeof l&&(l={animation:l}),l.preserveScrollPosition||b(!0);const c=Date.now()+(Number(l.wait)||0),d=mergeAnimations(y.current,l.animation),{ignoreEscapes:h=!1}=l;let p,f=E.calculatedTargetScrollTop;l.duration instanceof Promise?l.duration.finally((()=>{p=Date.now()})):p=c+(l.duration??0);const next=async()=>{const l=new Promise(requestAnimationFrame).then((()=>{if(!E.isAtBottom)return E.animation=void 0,!1;const{scrollTop:m}=E,b=performance.now(),w=(b-(E.lastTick??b))/$M;if(E.animation||(E.animation={behavior:d,promise:l,ignoreEscapes:h}),E.animation.behavior===d&&(E.lastTick=b),_())return next();if(c>Date.now())return next();if(m<Math.min(f,E.calculatedTargetScrollTop)){if(E.animation?.behavior===d){if("instant"===d)return E.scrollTop=E.calculatedTargetScrollTop,next();E.velocity=(d.damping*E.velocity+d.stiffness*E.scrollDifference)/d.mass,E.accumulated+=E.velocity*w,E.scrollTop+=E.accumulated,E.scrollTop!==m&&(E.accumulated=0)}return next()}return p>Date.now()?(f=E.calculatedTargetScrollTop,next()):(E.animation=void 0,E.scrollTop<E.calculatedTargetScrollTop?M({animation:mergeAnimations(y.current,y.current.resize),ignoreEscapes:h,duration:Math.max(0,p-Date.now())||void 0}):E.isAtBottom)}));return l.then((l=>(requestAnimationFrame((()=>{E.animation||(E.lastTick=void 0,E.velocity=0)})),l)))};return!0!==l.wait&&(E.animation=void 0),E.animation?.behavior===d?E.animation.promise:next()}),[b,_,E]),N=Gt.useCallback((()=>{w(!0),b(!1)}),[w,b]),P=Gt.useCallback((({target:l})=>{if(l!==j.current)return;const{scrollTop:c,ignoreScrollToTop:d}=E;let{lastScrollTop:h=c}=E;E.lastScrollTop=c,E.ignoreScrollToTop=void 0,d&&d>c&&(h=d),m(E.isNearBottom),setTimeout((()=>{if(E.resizeDifference||c===d)return;if(_())return w(!0),void b(!1);const l=c>h,p=c<h;E.animation?.ignoreEscapes?E.scrollTop=h:(p&&(w(!0),b(!1)),l&&w(!1),!E.escapedFromLock&&E.isNearBottom&&b(!0))}),1)}),[w,b,_,E]),L=Gt.useCallback((({target:l,deltaY:c})=>{let d=l;for(;!["scroll","auto"].includes(getComputedStyle(d).overflow);){if(!d.parentElement)return;d=d.parentElement}d===j.current&&c<0&&j.current.scrollHeight>j.current.clientHeight&&!E.animation?.ignoreEscapes&&(w(!0),b(!1))}),[w,b,E]),j=useRefCallback((l=>{j.current?.removeEventListener("scroll",P),j.current?.removeEventListener("wheel",L),l?.addEventListener("scroll",P,{passive:!0}),l?.addEventListener("wheel",L,{passive:!0})}),[]),D=useRefCallback((l=>{if(E.resizeObserver?.disconnect(),!l)return;let c;E.resizeObserver=new ResizeObserver((([l])=>{const{height:d}=l.contentRect,h=d-(c??d);if(E.resizeDifference=h,E.scrollTop>E.targetScrollTop&&(E.scrollTop=E.targetScrollTop),m(E.isNearBottom),h>=0){const l=mergeAnimations(y.current,c?y.current.resize:y.current.initial);M({animation:l,wait:!0,preserveScrollPosition:!0,duration:"instant"===l?void 0:350})}else E.isNearBottom&&(w(!1),b(!0));c=d,requestAnimationFrame((()=>{setTimeout((()=>{E.resizeDifference===h&&(E.resizeDifference=0)}),1)}))})),E.resizeObserver?.observe(l)}),[]);return{contentRef:D,scrollRef:j,scrollToBottom:M,stopScroll:N,isAtBottom:h||f,isNearBottom:f,escapedFromLock:c,state:E}};function useRefCallback(l,c){const d=Gt.useCallback((c=>(d.current=c,l(c))),c);return d}const BM=new Map;function mergeAnimations(...l){const c={...FM};let d=!1;for(const p of l)"instant"!==p?"object"==typeof p&&(d=!1,c.damping=p.damping??c.damping,c.stiffness=p.stiffness??c.stiffness,c.mass=p.mass??c.mass):d=!0;const h=JSON.stringify(c);return BM.has(h)||BM.set(h,Object.freeze(c)),d?"instant":BM.get(h)}const HM=Gt.createContext(null),zM="undefined"!=typeof window?Gt.useLayoutEffect:Gt.useEffect;function StickToBottom({instance:l,children:c,resize:d,initial:h,mass:p,damping:f,stiffness:m,targetScrollTop:y,contextRef:_,...b}){const w=Gt.useRef(null),E=Gt.useCallback(((l,c)=>{const d=B?.targetScrollTop??y;return d?.(l,c)??l}),[y]),M=useStickToBottom({mass:p,damping:f,stiffness:m,resize:d,initial:h,targetScrollTop:E}),{scrollRef:N,contentRef:P,scrollToBottom:L,stopScroll:j,isAtBottom:D,escapedFromLock:F,state:U}=l??M,B=Gt.useMemo((()=>({scrollToBottom:L,stopScroll:j,scrollRef:N,isAtBottom:D,escapedFromLock:F,contentRef:P,state:U,get targetScrollTop(){return w.current},set targetScrollTop(l){w.current=l}})),[L,D,P,N,j,F,U]);return Gt.useImperativeHandle(_,(()=>B),[B]),zM((()=>{N.current&&"visible"===getComputedStyle(N.current).overflow&&(N.current.style.overflow="auto")}),[]),Kt.jsx(HM.Provider,{value:B,children:Kt.jsx("div",{...b,children:"function"==typeof c?c(B):c})})}function ChatContainerRoot({children:l,className:c,...d}){return Kt.jsx(StickToBottom,{className:tr("flex overflow-y-auto",c),resize:"smooth",initial:"smooth",role:"log",...d,children:l})}function ChatContainerContent({children:l,className:c,...d}){return Kt.jsx(StickToBottom.Content,{className:tr("flex w-full flex-col",c),...d,children:l})}(StickToBottom||(StickToBottom={})).Content=function({children:l,...c}){const d=function(){const l=Gt.useContext(HM);if(!l)throw new Error("use-stick-to-bottom component context must be used within a StickToBottom component");return l}();return Kt.jsx("div",{ref:d.scrollRef,style:{height:"100%",width:"100%"},children:Kt.jsx("div",{...c,ref:d.contentRef,children:"function"==typeof l?l(d):l})})};let qM=class{constructor(l){__publicField(this,"value"),__publicField(this,"next"),this.value=l}};class Queue{constructor(){__privateAdd(this,Ht),__privateAdd(this,Wt),__privateAdd(this,Vt),this.clear()}enqueue(l){const c=new qM(l);__privateGet(this,Ht)?(__privateGet(this,Wt).next=c,__privateSet(this,Wt,c)):(__privateSet(this,Ht,c),__privateSet(this,Wt,c)),__privateWrapper(this,Vt)._++}dequeue(){const l=__privateGet(this,Ht);if(l)return __privateSet(this,Ht,__privateGet(this,Ht).next),__privateWrapper(this,Vt)._--,l.value}peek(){if(__privateGet(this,Ht))return __privateGet(this,Ht).value}clear(){__privateSet(this,Ht,void 0),__privateSet(this,Wt,void 0),__privateSet(this,Vt,0)}get size(){return __privateGet(this,Vt)}*[Symbol.iterator](){let l=__privateGet(this,Ht);for(;l;)yield l.value,l=l.next}*drain(){for(;__privateGet(this,Ht);)yield this.dequeue()}}function pLimit(l){validateConcurrency(l);const c=new Queue;let d=0;const resumeNext=()=>{d<l&&c.size>0&&(d++,c.dequeue()())},run=async(l,c,h)=>{const p=(async()=>l(...h))();c(p);try{await p}catch{}d--,resumeNext()},generator=(h,...p)=>new Promise((f=>{((h,p,f)=>{new Promise((l=>{c.enqueue(l)})).then(run.bind(void 0,h,p,f)),d<l&&resumeNext()})(h,f,p)}));return Object.defineProperties(generator,{activeCount:{get:()=>d},pendingCount:{get:()=>c.size},clearQueue:{value(){c.clear()}},concurrency:{get:()=>l,set(h){validateConcurrency(h),l=h,queueMicrotask((()=>{for(;d<l&&c.size>0;)resumeNext()}))}},map:{async value(l,c){const d=l.map(((l,d)=>this(c,l,d)));return Promise.all(d)}}}),generator}function validateConcurrency(l){if(!Number.isInteger(l)&&l!==Number.POSITIVE_INFINITY||!(l>0))throw new TypeError("Expected `concurrency` to be a number from 1 and up")}Ht=new WeakMap,Wt=new WeakMap,Vt=new WeakMap;const WM=Object.freeze(Object.defineProperty({__proto__:null,default:pLimit},Symbol.toStringTag,{value:"Module"})),VM=["weight","lowerLimit","upperLimit","multiSumEqual","multiSumMinimum","multiSumMaximum"];function convertMongoDBExtendedJSON(l){if(l&&"object"==typeof l){if(void 0!==l.$numberLong)return String(l.$numberLong);if(void 0!==l.$numberInt)return String(l.$numberInt);if(void 0!==l.$numberDouble)return String(l.$numberDouble)}return l}function sanitizeMongoDBExtendedJSON(l){if(null==l)return l;if(Array.isArray(l))return l.map((l=>sanitizeMongoDBExtendedJSON(l)));if("object"==typeof l){const c={};for(const d in l)Object.prototype.hasOwnProperty.call(l,d)&&(VM.includes(d)?c[d]=convertMongoDBExtendedJSON(l[d]):"object"==typeof l[d]?c[d]=sanitizeMongoDBExtendedJSON(l[d]):c[d]=l[d]);return c}return l}const useToolCallExecutor=(l={})=>{const c=Gt.useRef(pLimit(5)),{authToken:d,projectId:h}=useConfirmitProject(),{sendEvent:p}=useWebSocketContext(),f=Gt.useRef(null),m=Gt.useRef(new Set),y=Gt.useRef(new Set),[_,b]=Gt.useState(new Map),[w,E]=Gt.useState(!1),M=Gt.useRef([]),N=Gt.useRef(!1),P=Gt.useRef(new Map);Gt.useEffect((()=>{(async()=>{if(d&&h){const l=await getConfirmitBaseUrl();l&&(f.current=new MM({baseUrl:l,projectId:h,authToken:d}))}})()}),[d,h]);const L=Gt.useCallback(((c,d)=>{console.log("cancelToolCallsForGroup",c,d),d.forEach((c=>{l.onStatusUpdate?.(c,"cancelled")})),M.current=M.current.filter((l=>!d.includes(l.toolCall.id))),d.forEach((l=>{y.current.add(l),m.current.delete(l)})),console.log(`Cancelled ${d.length} tool calls for group ${c}`)}),[l]),j=Gt.useCallback(((c,d)=>{const h=new Set;M.current.filter((l=>l.messageId===d&&l.toolCall.id!==c.id&&!y.current.has(l.toolCall.id))).forEach((l=>h.add(l.toolCall.id)));const f=c.operation_group_id;if(f){const d=P.current.get(f);d&&d.forEach((d=>{if(d!==c.id&&!y.current.has(d)){const c=l.getCurrentStatus?.(d);"pending"!==c&&c||h.add(d)}}))}m.current.forEach((p=>{if(p===c.id)return;const m=l.getCurrentStatus?.(p);if("completed"===m||"failed"===m||"cancelled"===m)return;const y=M.current.some((l=>l.toolCall.id===p&&l.messageId===d)),_=f&&P.current.get(f)?.has(p);(y||_)&&h.add(p)}));const _=Array.from(h);_.length>0&&(console.log(`Tool call ${c.id} failed. Cancelling ${_.length} remaining tool calls in the same group.`),L(f||d,_),p("cancel_all_operations",{operation_group_id:f||d,tool_call_ids:_,reason:`Tool call ${c.id} failed after max retries`,failed_tool_call_id:c.id}))}),[L,p,l]);Gt.useEffect((()=>()=>{}),[L]);const D=Gt.useCallback(((l,c,d,h,f)=>{const m={type:"tool_call_acknowledgment",tool_call_id:l,turn_id:h,status:d?"completed":"failed",routing_data:f};try{p("tool_call_acknowledgment",m)}catch(y){}}),[p]),F=Gt.useCallback((async l=>{if(!f.current)throw new Error("API not initialized. Missing auth token or project ID.");const d=f.current,h=c.current((async()=>{switch(l.type){case"createQuestion":case"createNode":{const{node_id:h,question_type:p,node_type:f,position:m}=l.payload,y=p||f,_=sanitizeMongoDBExtendedJSON(l.payload),b={nodeId:_.node_id||h,type:y,position:_.position||m};try{const c=await d.createQuestion(b),h=await c.json(),p=c.ok||200===c.status||201===c.status;return{success:p,status:c.status,message:p?"Question created successfully":"Failed to create question",data:h,originalPayload:l.payload,apiPayload:b}}catch(c){return{success:!1,status:500,message:c instanceof Error?c.message:"createQuestion API call failed",data:null,originalPayload:l.payload,apiPayload:b}}}case"updateQuestion":case"updateNode":{const p=sanitizeMongoDBExtendedJSON(l.payload),{node_id:f,question_payload_content:m,node_payload:y,question_type:_,position:b=""}=p;if(!f)throw new Error("node_id is required for updateQuestion");if(null===y)return{success:!1,message:"node_payload is null - cannot update question",data:null,originalPayload:l.payload,apiPayload:null};if("multigrid"===_&&m)try{const c={...m};c.grid3DAnswers&&delete c.grid3DAnswers;const p=m.questions||[];c.questions&&(c.questions=c.questions.map((l=>{const c={...l};if(c.full_payload?.answers){const l={...c.full_payload};delete l.answers,c.full_payload=l}return c})));const y={nodeId:f,data:c},_=await d.updateQuestionSafely(y);if(!_.success)return{success:!1,message:`Failed to update parent multigrid question: ${_.message}`,data:_,originalPayload:l.payload,apiPayload:y};const b=[];for(const[l,m]of p.entries())if(m.node_id&&m.full_payload)try{await d.updateMultiGridAnswers({parentMultigridNodeId:f,targetNodeId:m.node_id,data:m.full_payload,position:m.position??"",parentNodeName:m.parentNodeName,index:l}),b.push({node_id:m.node_id,success:!0})}catch(h){b.push({node_id:m.node_id,success:!1,error:h instanceof Error?h.message:h})}else b.push({node_id:m.node_id,success:!1,error:"Missing node_id or full_payload"});const w=b.every((l=>l.node_id&&!0===l.success));return{success:w,message:w?`Multigrid question and ${b.length} sub-questions updated successfully`:"Multigrid parent updated, but some sub-questions failed",data:{parent:_,subQuestions:b},originalPayload:l.payload,apiPayload:{parent:y,subQuestions:b}}}catch(c){return{success:!1,message:c instanceof Error?c.message:"Multigrid update failed",data:null,originalPayload:l.payload,apiPayload:null}}const w={nodeId:f,data:m||y};try{const c=await d.updateQuestionSafely(w);return{success:c.success,message:c.message,data:c,originalPayload:l.payload,apiPayload:w}}catch(c){return{success:!1,message:c instanceof Error?c.message:"updateQuestion API call failed",data:null,originalPayload:l.payload,apiPayload:w}}}case"getAnswers":{const h=sanitizeMongoDBExtendedJSON(l.payload),{node_id:p,nodeId:f=p,question_type:m,type:y=m}=h,_=f||p,b=y||m;if(!_)throw new Error("node_id is required for getAnswers");if(!b)throw new Error("question_type is required for getAnswers");const w={nodeId:_,type:b};try{const c=await d.getAnswersData(w);return{success:c.success,message:c.message,data:c,originalPayload:l.payload,apiPayload:w}}catch(c){return{success:!1,message:c instanceof Error?c.message:"getAnswers API call failed",data:null,originalPayload:l.payload,apiPayload:w}}}case"updateAnswers":{const h=sanitizeMongoDBExtendedJSON(l.payload),{node_id:p,nodeId:f=p,question_type:m,type:y=m,answer_payload_content:_}=h,b=f||p,w=y||m;if(!b)throw new Error("node_id or nodeId is required for updateAnswers");if(!w)throw new Error("question_type or type is required for updateAnswers");if(!_)throw new Error("answers_payload_content is required for updateAnswers");const E={nodeId:b,type:["multiopen","multi","multiopennumeric","multiordered"].includes(w.toLowerCase())?"Multi":"grid"===w?"Grid":["multigrid","3dgrid"].includes(w.toLowerCase())?"Grid3D":w,data:_};try{const c=await d.updateAnswersSafely(E);return{success:c.success,message:c.message,data:c,originalPayload:l.payload,apiPayload:E}}catch(c){return{success:!1,message:c instanceof Error?c.message:"updateAnswers API call failed",data:null,originalPayload:l.payload,apiPayload:E}}}case"getRouting":{const h=sanitizeMongoDBExtendedJSON(l.payload),{expandToNode:p}=h,f={expandToNode:p};try{const c=await d.getRoutingDataWithChildren(f);return{success:!!c,message:c?"Routing data retrieved successfully":"Failed to retrieve routing data",data:c,originalPayload:l.payload,apiPayload:f}}catch(c){return{success:!1,message:c instanceof Error?c.message:"getRouting API call failed",data:null,originalPayload:l.payload,apiPayload:f}}}case"deleteNode":{const h=sanitizeMongoDBExtendedJSON(l.payload),{node_id:p,nodeId:f=p}=h,m=f||p;if(!m)throw new Error("node_id is required for deleteNode");const y={nodeId:m};try{const c=await d.deleteNodeSafely(y);return{success:c.success,message:c.message,data:c,originalPayload:l.payload,apiPayload:y}}catch(c){return{success:!1,message:c instanceof Error?c.message:"deleteNode API call failed",data:null,originalPayload:l.payload,apiPayload:y}}}default:throw new Error(`Unknown tool call type: ${l.type}`)}}));return h}),[]),U=Gt.useCallback((async({toolCall:c,messageId:d,attemptNumber:h=1})=>{const p=performance.now();if(Ex.track("tool_call_execution",`Starting tool call ${c.type}`,{toolCallId:c.id,toolCallType:c.type,messageId:d,attemptNumber:h,payload:c.payload}),y.current.has(c.id))return void Ex.track("tool_call_execution",`Tool call ${c.id} already processed`,{toolCallId:c.id,toolCallType:c.type,status:"skipped"},"debug");const f=l.getCurrentStatus?.(c.id)||c.status;if(console.log(f,"currentStatus"),"cancelled"===f||"completed"===f||"failed"===f)return y.current.add(c.id),void Ex.track("tool_call_execution",`Tool call ${c.id} skipped due to status`,{toolCallId:c.id,toolCallType:c.type,status:f,reason:"invalid_status"},"debug");const w=_.get(c.id);if(!w?.maxRetriesReached){if(h>3)return b((l=>{const d=new Map(l);return d.set(c.id,{attempts:h,lastError:new Error("Max retries exceeded"),maxRetriesReached:!0}),d})),y.current.add(c.id),l.onStatusUpdate?.(c.id,"failed"),l.onMaxRetriesReached?.(c.id),void D(c.id,c.type,!1,d);m.current.add(c.id),l.onStatusUpdate?.(c.id,"pending");try{if("cancelled"===(l.getCurrentStatus?.(c.id)||c.status))return y.current.add(c.id),m.current.delete(c.id),void l.onStatusUpdate?.(c.id,"cancelled");const f=await(E=c.id,M=c.type,N=async()=>(logDebug(`Executing ${c.type} tool call`,{toolCallId:c.id,payload:c.payload,attemptNumber:h}),await F(c)),ah.trackToolCall(E,M,N)),_=performance.now(),w=_-p,L=!0===f?.success;if(Tx(c.id,c.type,p,_,L,{messageId:d,attemptNumber:h,payload:c.payload,result:f}),captureToolCallMetrics(c.id,c.type,L,w,h-1,L?void 0:f?.message),!L){throw new Error(f?.message||"API call failed")}{y.current.add(c.id),m.current.delete(c.id),b((l=>{const d=new Map(l);return d.delete(c.id),d})),Ex.track("tool_call_execution",`Tool call ${c.type} completed successfully`,{toolCallId:c.id,toolCallType:c.type,duration:w,messageId:d,attemptNumber:h},"info"),logInfo$1(`Tool call ${c.type} completed successfully`,{toolCallId:c.id,duration:w,messageId:d,attemptNumber:h,result:f?.data?"has_data":"no_data"}),l.onStatusUpdate?.(c.id,"completed"),l.onSuccess?.(c.id,f);const p=f.data||f;if(D(c.id,c.type,!0,d,p),"updateQuestion"===c.type||"updateAnswers"===c.type)try{er.tabs.query({}).then((l=>{l.forEach((l=>{l.id&&l.url&&l.url.includes("confirmit.com")&&er.tabs.sendMessage(l.id,{type:"TOOL_CALL_COMPLETED",toolCallType:c.type,toolCallId:c.id,success:!0,result:f}).catch((c=>{console.error("Failed to send message to tab:",l.id,c)}))}))})).catch((l=>{console.error("Failed to query tabs:",l)}))}catch(P){console.error("Failed to send message to content script:",P)}}}catch(P){const f=performance.now()-p,_=P instanceof Error?P:new Error(String(P));if(Ex.trackError("tool_call_error",_,{toolCallId:c.id,toolCallType:c.type,messageId:d,attemptNumber:h,duration:f,payload:c.payload}),logError(`Tool call ${c.type} failed`,{toolCallId:c.id,error:_.message,errorType:_.name,duration:f,attemptNumber:h,messageId:d}),captureToolCallMetrics(c.id,c.type,!1,f,h-1,_.message),m.current.delete(c.id),b((l=>{const d=new Map(l);return d.set(c.id,{attempts:h,lastError:_,maxRetriesReached:h>=3}),d})),h<3){const l=Math.min(1e3*Math.pow(2,h-1),5e3);return await new Promise((c=>setTimeout(c,l))),await U({toolCall:c,messageId:d,attemptNumber:h+1})}y.current.add(c.id),l.onStatusUpdate?.(c.id,"failed"),l.onError?.(c.id,_),l.onMaxRetriesReached?.(c.id),D(c.id,c.type,!1,d),j(c,d)}var E,M,N}}),[l,D,_,F,j]),B=Gt.useCallback((async()=>{if(!N.current&&0!==M.current.length){N.current=!0,E(!0);try{let d=0;for(;M.current.length>0;){const h=M.current.shift();if(!h)break;const{toolCall:p,messageId:f}=h;if(d++,y.current.has(p.id))continue;const m=l.getCurrentStatus?.(p.id)||p.status;if("cancelled"!==m&&"completed"!==m&&"failed"!==m){try{await U({toolCall:p,messageId:f,attemptNumber:1})}catch(c){y.current.has(p.id)||(y.current.add(p.id),l.onStatusUpdate?.(p.id,"failed"),l.onError?.(p.id,c instanceof Error?c:new Error(String(c))),j(p,f))}await new Promise((l=>setTimeout(l,0)))}else y.current.add(p.id)}}catch(c){}finally{N.current=!1,E(!1),l.onQueueProcessingComplete&&l.onQueueProcessingComplete()}}}),[U,l,j]),H=Gt.useCallback((async(c,d)=>{c.forEach((l=>{const c=l.operation_group_id||d;P.current.has(c)||P.current.set(c,new Set),P.current.get(c).add(l.id)}));const h=c.filter((c=>{const d=!y.current.has(c.id),h=!_.get(c.id)?.maxRetriesReached,p=!m.current.has(c.id),f=l.getCurrentStatus?.(c.id)||c.status;return d&&h&&"pending"===f&&p&&!("completed"===f)&&!("failed"===f)&&!("cancelled"===f)}));0!==h.length&&(h.forEach((l=>{M.current.push({toolCall:l,messageId:d})})),await B())}),[B,_,l]),z=Gt.useCallback((async(l,c,d)=>{b((c=>{const d=new Map(c);return d.delete(l),d})),y.current.delete(l),m.current.delete(l),M.current.unshift({toolCall:d,messageId:c}),await B()}),[B]),q=Gt.useCallback((()=>{0!==M.current.length&&(N.current&&(N.current=!1,E(!1)),B())}),[B]),V=Gt.useCallback((()=>{m.current.clear(),y.current.clear(),M.current=[],N.current=!1,b(new Map),E(!1),P.current.clear()}),[]),Z=Gt.useCallback((l=>!0===_.get(l)?.maxRetriesReached),[_]);return{executeToolCall:U,executeToolCalls:H,retryToolCall:z,reset:V,hasReachedMaxRetries:Z,isReady:Boolean(f.current),isExecuting:w,retryInfo:_,forceStartQueue:q,isToolCallProcessed:l=>y.current.has(l),getProcessedCount:()=>y.current.size,cancelToolCallsForGroup:L}},ZM={toFrontend:l=>({url:l.file_url,description:l.description,order_key:l.order_key??null}),toApi:l=>({file_url:l.url,description:l.description,order_key:l.order_key??void 0}),toFrontendArray(l){return l.map(this.toFrontend)},toApiArray(l){return l.map(this.toApi)}},GM=IC.api_url;function retrySessionConfirmit({confirmitSessionId:l}){const c=`${IC.api_url}/document_to_survey_convertor/confirmit/${l}/retry`;return fetchWithAuth(c,{method:"POST",headers:{"Content-Type":"application/json"}}).then((async l=>{if(!l.ok){const c=await l.json().catch((()=>null));throw{status:l.status,message:c&&c.detail||l.statusText||"Unknown error"}}return l.json()}))}(()=>{if("undefined"!=typeof document){if(!document.getElementById("chat-timeline-styles")){const l=document.createElement("style");l.id="chat-timeline-styles",l.textContent="\n@keyframes progress-down {\n  0% { \n    height: 0%;\n    opacity: 0;\n  }\n  20% {\n    opacity: 1;\n  }\n  100% { \n    height: 100%;\n    opacity: 0;\n  }\n}\n\n@keyframes slide-in-from-top {\n  0% {\n    transform: translateY(-8px);\n    opacity: 0;\n  }\n  100% {\n    transform: translateY(0);\n    opacity: 1;\n  }\n}\n\n@keyframes slide-in-from-bottom {\n  0% {\n    transform: translateY(20px);\n    opacity: 0;\n  }\n  100% {\n    transform: translateY(0);\n    opacity: 1;\n  }\n}\n\n@keyframes fade-in {\n  0% {\n    opacity: 0;\n    transform: scale(0.95);\n  }\n  100% {\n    opacity: 1;\n    transform: scale(1);\n  }\n}\n\n@keyframes pulse-glow {\n  0%, 100% {\n    box-shadow: 0 0 0 0 rgba(59, 130, 246, 0.4);\n  }\n  50% {\n    box-shadow: 0 0 0 8px rgba(59, 130, 246, 0);\n  }\n}\n\n@keyframes typing-dots {\n  0%, 20% {\n    color: rgba(0,0,0,0.4);\n    text-shadow: 0.25em 0 0 rgba(0,0,0,0.2), 0.5em 0 0 rgba(0,0,0,0.2);\n  }\n  40% {\n    color: rgba(0,0,0,1);\n    text-shadow: 0.25em 0 0 rgba(0,0,0,0.2), 0.5em 0 0 rgba(0,0,0,0.2);\n  }\n  60% {\n    text-shadow: 0.25em 0 0 rgba(0,0,0,1), 0.5em 0 0 rgba(0,0,0,0.2);\n  }\n  80%, 100% {\n    text-shadow: 0.25em 0 0 rgba(0,0,0,1), 0.5em 0 0 rgba(0,0,0,1);\n  }\n}\n\n@keyframes button-press {\n  0% {\n    transform: scale(1);\n  }\n  50% {\n    transform: scale(0.95);\n  }\n  100% {\n    transform: scale(1);\n  }\n}\n\n@keyframes bounce-in {\n  0% {\n    transform: scale(0.3);\n    opacity: 0;\n  }\n  50% {\n    transform: scale(1.05);\n  }\n  70% {\n    transform: scale(0.9);\n  }\n  100% {\n    transform: scale(1);\n    opacity: 1;\n  }\n}\n\n@keyframes shimmer {\n  0% {\n    background-position: -200px 0;\n  }\n  100% {\n    background-position: calc(200px + 100%) 0;\n  }\n}\n\n@keyframes spin {\n  0% {\n    transform: rotate(0deg);\n  }\n  100% {\n    transform: rotate(360deg);\n  }\n}\n\n@keyframes subtle-pulse {\n  0%, 100% {\n    box-shadow: 0 0 0 0 rgba(239, 68, 68, 0.4);\n  }\n  50% {\n    box-shadow: 0 0 0 4px rgba(239, 68, 68, 0);\n  }\n}\n\n.animate-progress-down {\n  animation: progress-down 1.5s cubic-bezier(0.4, 0, 0.2, 1) infinite;\n}\n\n.animate-in {\n  animation-duration: 200ms;\n  animation-fill-mode: both;\n}\n\n.slide-in-from-top-2 {\n  animation-name: slide-in-from-top;\n}\n\n.slide-in-from-bottom {\n  animation: slide-in-from-bottom 0.3s ease-out;\n}\n\n.fade-in {\n  animation: fade-in 0.3s ease-out;\n}\n\n.pulse-glow {\n  animation: pulse-glow 2s infinite;\n}\n\n.typing-dots::after {\n  content: '\u22ef';\n  animation: typing-dots 1.5s infinite;\n  margin-left: 4px;\n}\n\n.button-press:active {\n  animation: button-press 0.1s ease-out;\n}\n\n.bounce-in {\n  animation: bounce-in 0.5s cubic-bezier(0.68, -0.55, 0.265, 1.55);\n}\n\n.shimmer {\n  background: linear-gradient(90deg, #f0f0f0 25%, #e0e0e0 50%, #f0f0f0 75%);\n  background-size: 200px 100%;\n  animation: shimmer 2s infinite;\n}\n\n.animate-spin {\n  animation: spin 1s linear infinite;\n}\n\n.message-enter {\n  animation: slide-in-from-bottom 0.4s ease-out;\n}\n\n.tool-call-expand {\n  transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);\n}\n\n.hover-lift:hover {\n  transform: translateY(-1px);\n  transition: transform 0.2s ease-out;\n}\n\n.hover-scale:hover {\n  transform: scale(1.02);\n  transition: transform 0.2s ease-out;\n}\n\n.status-transition {\n  transition: all 0.3s ease-in-out;\n}\n",document.head.appendChild(l)}}})();const ChatContent=({accessToken:l})=>{const{theme:c}=useTheme();useNavigate();const{isConnected:d,isConnecting:h,error:p,messages:f,isStreaming:m,connect:y,sendMessage:_}=useWebSocket(),b=jR((l=>l.chat.sessionData)),{mutate:w,isPending:E}=useMutation({mutationFn:retrySessionConfirmit}),{projectId:M,authToken:N}=useConfirmitProject(),{isOnValidSurveyPage:P}=useActiveSurveyMonitor(),L=Gt.useRef(!1),j=Gt.useRef(M),D=Gt.useRef(""),[F,U]=Gt.useState(!1),[B,H]=Gt.useState(!1),[z,q]=Gt.useState(!1),[V,Z]=Gt.useState(!0),[K,Y]=Gt.useState(""),[ee,ne]=Gt.useState(new Set),[se,ie]=Gt.useState(new Map),[oe,le]=Gt.useState(new Map),[ce,pe]=Gt.useState(new Set),{sendEvent:fe}=useWebSocketContext(),{turnErrors:ge,clearTurnError:be,toggleErrorDetails:Oe,isShowingErrorDetails:Ne}=((l={})=>{const[c,d]=Gt.useState(new Map),[h,p]=Gt.useState(new Map),f=Gt.useRef(new Set),m=Gt.useCallback((l=>{switch(l){case"llm_generation":return"AI generation failed. The instruction might be too complex or unclear.";case"topology_generation":return"Failed to generate survey structure. Please try a simpler approach.";case"batch_generation":return"Failed to process multiple operations. Try breaking them into smaller steps.";case"tool_call_processing":return"Failed to process the requested action. Please check your survey state.";case"message_processing":return"Failed to process the message. Please try again.";case"validation":return"The requested operation is invalid. Please check your input.";default:return"An unexpected error occurred. Please try again."}}),[]),y=Gt.useCallback((c=>{console.log("Handling turn error:",c);const h={turnId:c.turn_id,errorType:c.error_type,errorMessage:c.error_message,suggestion:c.suggestion||m(c.error_type),timestamp:c.timestamp,hasFallback:c.has_fallback,recoveryOptions:{canRetry:!0,canModify:!0,canSkip:c.has_fallback,canViewDetails:!0}};d((l=>{const d=new Map(l);return d.set(c.turn_id,h),d})),f.current.has(c.turn_id)||(f.current.add(c.turn_id),console.error("[Turn Error]",{turnId:c.turn_id,type:c.error_type,message:c.error_message,timestamp:new Date(c.timestamp).toISOString()})),l.onTurnError?.(h)}),[m,l]),_=Gt.useCallback((l=>{console.log("Handling existing turn error:",l);const c={turnId:l.turn_id,errorType:l.error_type,errorMessage:l.error_message,suggestion:m(l.error_type),timestamp:1e3*l.error_timestamp,hasFallback:l.has_fallback,recoveryOptions:{canRetry:!0,canModify:!0,canSkip:l.has_fallback,canViewDetails:!0}};d((d=>{const h=new Map(d);return h.set(l.turn_id,c),h})),f.current.add(l.turn_id)}),[m]);useWebSocketEvent("turn_error",y),useWebSocketEvent("existing_turn_error",_);const b=Gt.useCallback((l=>{p((c=>{const d=new Map(c);return d.set(l,!c.get(l)),d}))}),[]),w=Gt.useCallback((l=>{d((c=>{const d=new Map(c);return d.delete(l),d})),p((c=>{const d=new Map(c);return d.delete(l),d})),f.current.delete(l)}),[]),E=Gt.useCallback((l=>c.get(l)),[c]),M=Gt.useCallback((l=>h.get(l)||!1),[h]);return{turnErrors:c,getTurnError:E,clearTurnError:w,toggleErrorDetails:b,isShowingErrorDetails:M,hasError:l=>c.has(l)}})({onTurnError:l=>{},onRetry:l=>{const c=f.find((c=>c.id===l));c&&"user"===c.role&&handleRetryMessage(c)},onModify:(l,c)=>{_(c)},onSkip:l=>{be(l)}}),De=Gt.useRef(""),Fe=Gt.useRef(!1),Ue=Gt.useCallback((()=>d&&!h&&!p),[d,h,p]),Be=Gt.useRef(0),He=Gt.useRef(null),[qe,Ve]=Gt.useState(!1),[Je,tt]=Gt.useState(!1),[nt,it]=Gt.useState(!1),[ht,ft]=Gt.useState(!1),[gt,yt]=Gt.useState(!1),{data:_t=[],isLoading:bt}=useQuery({queryKey:["referenceMediaFiles",wt=M],enabled:Boolean(wt),queryFn:async()=>{const l=`${GM}/document_to_survey_convertor/confirmit_session/${wt}/reference-media-files`,c=await fetchWithAuth(l,{method:"GET"});if(!c.ok){const l=await c.text();throw new Error(`Failed to get reference media files: ${c.status} ${c.statusText} - ${l}`)}const d=await c.json();return ZM.toFrontendArray(d.reference_media_files)},staleTime:3e4});var wt;const St=(()=>{const l=useQueryClient();return useMutation({mutationFn:async l=>{const{confirmitSessionId:c,files:d}=l,h=`${GM}/document_to_survey_convertor/confirmit_session/${c}/reference-media-files`,p={reference_media_files:ZM.toApiArray(d)},f=await fetchWithAuth(h,{method:"PATCH",headers:{"Content-Type":"application/json"},body:JSON.stringify(p)});if(!f.ok){const l=await f.text();throw new Error(`Failed to update reference media files: ${f.status} ${f.statusText} - ${l}`)}return await f.json()},retry:2,onSuccess:(c,d)=>{l.invalidateQueries({queryKey:["referenceMediaFiles",d.confirmitSessionId]}),vo.success("Media files saved successfully")},onError:l=>{vo.error(l?.message??"Failed to save media files")}})})(),{messageTimeoutRef:xt,lastUserMessageIdRef:kt,clearTimeout:Et}=(({messages:l,isStreaming:c,onTimeout:d,timeoutDuration:h=12e4})=>{const p=Gt.useRef(null),f=Gt.useRef(null);return Gt.useEffect((()=>{l&&l.length>0&&"assistant"===l[l.length-1].role&&p.current&&(console.log("Assistant response received, clearing timeout"),clearTimeout(p.current),p.current=null,f.current=null)}),[l]),Gt.useEffect((()=>()=>{p.current&&(clearTimeout(p.current),p.current=null)}),[]),{messageTimeoutRef:p,lastUserMessageIdRef:f,startTimeout:(l,m)=>{f.current=l,p.current&&clearTimeout(p.current),p.current=setTimeout((()=>{console.log(`Request timed out after ${h/1e3} seconds`),p.current=null,f.current=null,d(),c&&m()}),h)},clearTimeout:()=>{p.current&&(clearTimeout(p.current),p.current=null)}}})({messages:f,isStreaming:m,onTimeout:()=>q(!0)}),It=Gt.useCallback((async l=>{try{await er.runtime.sendMessage({messageType:gr.websocketStateUpdate,sessionId:j.current,isGenerating:l})}catch(c){console.error("Failed to notify background script:",c)}}),[]),Tt=Gt.useCallback((async()=>{try{const[l]=await er.tabs.query({active:!0,currentWindow:!0});if(l?.url){const c=new URL(l.url).hostname.endsWith(".confirmit.com");Z(c),Y(l.url)}}catch(l){console.error("Failed to check active tab URL:",l),Z(!0)}}),[]);Gt.useEffect((()=>{Tt();const handleTabUpdate=(l,c,d)=>{("complete"===c.status||c.url)&&Tt()},handleTabActivated=l=>{Tt()};er.tabs.onUpdated.addListener(handleTabUpdate),er.tabs.onActivated.addListener(handleTabActivated);const l=setInterval(Tt,2e3);return()=>{er.tabs.onUpdated.removeListener(handleTabUpdate),er.tabs.onActivated.removeListener(handleTabActivated),clearInterval(l)}}),[Tt]);const{executeToolCalls:At,retryToolCall:Ot,isReady:Mt,isExecuting:Nt,hasReachedMaxRetries:Pt,retryInfo:Lt,forceStartQueue:jt,isToolCallProcessed:Dt,getProcessedCount:Ft,cancelToolCallsForGroup:Bt}=useToolCallExecutor({onStatusUpdate:(l,c)=>{le((d=>new Map(d).set(l,c))),ne("pending"===c?c=>{const d=new Set(c);return d.add(l),d}:c=>{const d=new Set(c);return d.delete(l),d})},getCurrentStatus:l=>oe.get(l),onError:(l,c)=>{ie((d=>new Map(d).set(l,c.message)))},onSuccess:async(l,c)=>{ie((c=>{const d=new Map(c);return d.delete(l),d})),pe((c=>{const d=new Set(c);return d.delete(l),d}));(f?.flatMap((l=>l.tool_calls||[]))||[]).find((c=>c.id===l))&&setTimeout((()=>{Ht()}),1500)},onMaxRetriesReached:l=>{pe((c=>new Set(c).add(l)))},onQueueProcessingComplete:()=>{ne(new Set)}}),Ht=Gt.useCallback((async()=>{try{const[l]=await er.tabs.query({active:!0,currentWindow:!0});if(l?.id&&l.url?.includes("confirmit.com")){await er.scripting.executeScript({target:{tabId:l.id},func:()=>{try{const l=['a[href*="/design/nodes"]','div[data-routing-action="Routing"] a','.comd-sidebar__item[data-routing-action="Routing"] a','.page-view__sidebar a[href*="/surveydesigner"][href*="/design/nodes"]','[data-testid="item"][data-routing-action="Routing"] a','a[data-testid="icon-button"][href*="/design/nodes"]'];let c=null;for(const d of l)if(c=document.querySelector(d),c)break;if(c){c.click();const l=new MouseEvent("click",{bubbles:!0,cancelable:!0,view:window});return c.dispatchEvent(l),!0}return console.warn("Routing link not found"),!1}catch(l){return console.error("Error clicking routing link:",l),!1}}})}}catch(l){console.error("Failed to inject routing click script:",l)}}),[]),Wt=Gt.useCallback((async()=>{try{const[l]=await er.tabs.query({active:!0,currentWindow:!0});return l?.id?(await er.tabs.reload(l.id),!0):(console.warn("No active tab found to reload"),!1)}catch(l){return console.error("Failed to reload user website:",l),!1}}),[]);Gt.useEffect((()=>{if(!L.current&&M&&l){const c=M;j.current=c||"",D.current=l,y(c||"",l),L.current=!0}return()=>{}}),[y,M,l]);const Vt=Gt.useCallback((async()=>{if(b?.plan?.turns&&b.plan.turns.length>0)return!1;if(!Ue()||!M||!N||Fe.current)return!1;Fe.current=!0,tt(!0);try{const l=await getConfirmitBaseUrl();if(!l)throw new Error("No Confirmit base URL available");const c=new MM({baseUrl:l,projectId:M,authToken:N}),d=await c.getSurveyDetails(M);let h=[];d.data?.languages&&(h=d.data.languages);const p=await c.getRoutingDataWithChildren(),f=await hashValue(N),m={instruction:"Generate a plan for the document",routing_data:stripChildren(p),token:f,baseUrl:l,languageCodes:h};return new Promise((l=>{fe("topology_generated",m,(c=>{tt(!1),l(!0)}))}))}catch(l){return console.error("Initial plan generation failed:",l),tt(!1),Fe.current=!1,!1}}),[Ue,M,N,fe,b]);Gt.useEffect((()=>{if(b&&b?.document&&"success"!==b?.document?.status)return;const l=Boolean(b&&(!b.plan||!b.plan.turns||0===b.plan.turns.length));b&&b?.created_by&&M&&N&&l?Vt():b?.plan?.turns&&b.plan.turns.length}),[b,Ue,M,N,Vt]),Gt.useEffect((()=>{if(f&&f.length>Be.current){f.slice(Be.current).some((l=>"user"===l.role))&&Ve(!0),Be.current=f.length}}),[f]),Gt.useEffect((()=>{}),[d,h,p]),Gt.useEffect((()=>{f&&0!==f.length&&le((l=>{const c=new Map(l);let d=!1;return f.forEach((l=>{"assistant"===l.role&&l.tool_calls&&l.tool_calls.forEach((l=>{c.has(l.id)||(c.set(l.id,l.status),d=!0)}))})),d?c:l}))}),[f]),Gt.useEffect((()=>{if(!m&&0===ee.size&&f&&f.length>0&&qe){const l=f[f.length-1];"assistant"===l.role&&l.id!==He.current&&(He.current=l.id,Ve(!1),setTimeout((()=>{Wt()}),1e3))}}),[m,ee.size,f,qe,Wt]),Gt.useEffect((()=>{if(!f||0===f.length)return;if(!Mt)return;if(Nt)return;let l=!1;const c=[];for(const d of f)if("assistant"===d.role&&d.tool_calls&&d.tool_calls.length>0){const h=d.tool_calls.filter((l=>{const c=!Dt(l.id),d=!ee.has(l.id),h="pending"===l.status,p=!Pt(l.id),f=oe.get(l.id);return c&&d&&h&&p&&!("completed"===f)&&!("failed"===f)&&!("cancelled"===f)}));h.length>0&&(h.forEach((l=>{c.push({toolCall:l,messageId:d.id})})),l=!0)}if(l&&c.length>0){const l=c.map((l=>l.toolCall)),d=c[0].messageId;At(l,d)}}),[f,ee,Mt,Nt,At,Pt,Dt,Ft,oe]);const Zt=Gt.useCallback((l=>{const c=oe.get(l.id);if("completed"===c||"cancelled"===c)return;const d=f.find((c=>c.tool_calls?.some((c=>c.id===l.id))));d&&(pe((c=>{const d=new Set(c);return d.delete(l.id),d})),ie((c=>{const d=new Map(c);return d.delete(l.id),d})),ne((c=>{const d=new Set(c);return d.delete(l.id),d})),le((c=>{const d=new Map(c);return d.delete(l.id),d})),De.current="",Ot(l.id,d.id,l))}),[f,Ot,oe]),handleRetryMessage=l=>{l.content&&(Ve(!0),_(l.content))};Gt.useEffect((()=>{It(m)}),[m,It]),Gt.useEffect((()=>()=>{ne(new Set),ie(new Map),le(new Map),pe(new Set),De.current="",xt.current&&Et(),It(!1)}),[It]);const Yt="in_progress"===b?.document?.status,Qt="error"===b?.document?.status,tr="success"===b?.document?.status;if(Yt)return Kt.jsx(Kt.Fragment,{children:Kt.jsx("div",{className:"fixed inset-0 flex justify-center items-center",children:Kt.jsxs("div",{className:"flex flex-col items-center gap-3",children:[Kt.jsx("div",{className:"h-8 w-8 animate-spin rounded-full border-4 border-violet-200 border-t-violet-600"}),Kt.jsx("p",{className:"text-sm text-gray-600",children:"Loading..."})]})})});if(Qt){const handleRetry=()=>{(b.confirmit_session_id||j.current)&&w({confirmitSessionId:(b.confirmit_session_id||j.current)??""},{onSuccess:()=>{vo.success("Session retry initiated. Processing document...")},onError:l=>{vo.error(l.message||"Failed to retry session. Please try again.")}})};return Kt.jsx("div",{className:"fixed inset-0 flex justify-center items-center bg-background/80 backdrop-blur-sm p-4",children:Kt.jsxs(Ax,{className:"w-full max-w-lg shadow-2xl border-red-200/50 dark:border-red-900/50 animate-in fade-in-0 zoom-in-95 duration-300",children:[Kt.jsxs(Ox,{className:"text-center space-y-4 pb-4",children:[Kt.jsxs("div",{className:"mx-auto relative",children:[Kt.jsx("div",{className:"absolute inset-0 rounded-full bg-red-100 dark:bg-red-900/20 animate-ping opacity-75"}),Kt.jsx("div",{className:"relative rounded-full bg-gradient-to-br from-red-50 to-red-100 dark:from-red-900/30 dark:to-red-800/20 p-4 border-2 border-red-200 dark:border-red-800/50",children:Kt.jsx(as,{className:"h-10 w-10 text-red-600 dark:text-red-400"})})]}),Kt.jsxs("div",{className:"space-y-2",children:[Kt.jsx(Mx,{className:"text-2xl font-bold text-red-600 dark:text-red-400",children:"Document Processing Failed"}),Kt.jsx(Nx,{className:"text-base",children:"We encountered an issue while processing your document"})]})]}),Kt.jsxs(Px,{className:"space-y-4",children:[Kt.jsx("div",{className:"rounded-lg bg-red-50/50 dark:bg-red-900/10 border border-red-200/50 dark:border-red-800/30 p-4 backdrop-blur-sm",children:Kt.jsx("p",{className:"text-sm text-red-800 dark:text-red-300 text-center leading-relaxed",children:"The document could not be processed. It may be corrupted, in an unsupported format, or there was an issue with the upload."})}),Kt.jsxs("div",{className:"flex flex-col sm:flex-row gap-3 pt-2",children:[Kt.jsx(or,{onClick:handleRetry,disabled:!b?.confirmit_session_id,className:"flex-1 bg-red-600 hover:bg-red-700 dark:bg-red-700 dark:hover:bg-red-600 text-white shadow-lg hover:shadow-xl transition-all duration-200",children:E?Kt.jsxs(Kt.Fragment,{children:[Kt.jsx(wi,{className:"mr-2 h-4 w-4 animate-spin"}),"Retrying..."]}):Kt.jsxs(Kt.Fragment,{children:[Kt.jsx(Ni,{className:"mr-2 h-4 w-4"}),"Retry Processing"]})}),Kt.jsx(or,{variant:"outline",onClick:()=>{},className:"flex-1 border-red-200 dark:border-red-800/50 text-red-600 dark:text-red-400 hover:bg-red-50 dark:hover:bg-red-900/20 transition-all duration-200",children:"Go Back to Dashboard"})]})]})]})})}return b&&tr?Kt.jsx("div",{className:`${c} flex h-screen flex-col relative`,children:Kt.jsxs(Kt.Fragment,{children:[Kt.jsx(ChatHeader,{isConnected:d,isConnecting:h,error:p,authToken:N,isDevMode:F,retryCount:0,hasReachedMaxRetries:!1,onToggleDevMode:()=>U(!F),onOpenDocuments:()=>H(!0),onRetryConnection:()=>{y(j.current||"",D.current)},onOpenSettings:()=>it(!0),onOpenAIRules:()=>ft(!0),onOpenMediaUpload:()=>yt(!0)}),Kt.jsx(ChatContainerRoot,{className:"chat-container flex flex-1 flex-col",children:Kt.jsx(ChatContainerContent,{className:"flex flex-1 flex-col overflow-hidden",children:Kt.jsx(MessageList,{messages:f,isStreaming:m,showTimeoutMessage:z,executingToolCalls:ee,toolCallErrors:se,toolCallStatuses:oe,maxRetriesReached:ce,isDevMode:F,isConfirmitSite:V,onRetryMessage:handleRetryMessage,onRetryToolCall:Zt,onCopy:async l=>{try{await navigator.clipboard.writeText(l)}catch(c){console.error("Failed to copy text: ",c)}},isOnValidSurveyPage:P,onTimeoutRetry:()=>{if(q(!1),f&&f.length>0){const l=[...f].reverse().find((l=>"user"===l.role));l?.content&&(Ve(!0),handleRetryMessage(l))}},onTimeoutDismiss:()=>q(!1),onCancelToolCallsForGroup:Bt,turnErrors:ge,showErrorDetails:new Map(Array.from(ge.keys()).map((l=>[l,Ne(l)]))),onToggleErrorDetails:Oe,onRetryTurn:l=>{const c=f.find((c=>c.id===l&&"user"===c.role));c&&handleRetryMessage(c)},onModifyTurn:(l,c)=>_(c),onSkipTurn:be,setIsLoadingRoutingData:tt})})}),Kt.jsx(PromptInputBasic,{isStreaming:m,isConfirmitSite:V,messageTimeoutRef:xt,lastUserMessageIdRef:kt,onTimeout:()=>q(!0),isLoadingRoutingData:Je}),Kt.jsx(DocumentOverlay,{isOpen:B,onClose:()=>H(!1)}),Kt.jsx(SettingsModal,{isOpen:nt,onClose:()=>it(!1),onLogout:async()=>{try{const{error:l}=await EC.auth.signOut();l&&console.error("Supabase logout error:",l),await er.storage.local.clear();const[c]=await er.tabs.query({active:!0,currentWindow:!0});c?.id&&await er.tabs.reload(c.id)}catch(l){console.error("Failed to logout:",l)}}}),Kt.jsx(AIRulesViewModal,{isOpen:ht,onClose:()=>ft(!1),currentFolderIds:b?.ai_rules_folder_ids||[]}),Kt.jsx(MediaUploadModal,{isOpen:gt,onClose:()=>yt(!1),onSave:async c=>{if(M)if(l)try{await St.mutateAsync({confirmitSessionId:M,files:c})}catch(d){console.error("Failed to save media files:",d);const l=d instanceof Error?d.message:"An unexpected error occurred";throw vo.error(`Failed to save: ${l}`),d}else vo.error("Authentication required. Please log in to continue.");else vo.error("Please navigate to a Confirmit survey page to manage media files")},initialFiles:_t,projectId:M,accessToken:l})]})}):Kt.jsx("div",{className:"fixed inset-0 flex justify-center items-center",children:Kt.jsxs("div",{className:"flex flex-col items-center gap-3",children:[Kt.jsx("div",{className:"h-8 w-8 animate-spin rounded-full border-4 border-violet-200 border-t-violet-600"}),Kt.jsx("p",{className:"text-sm text-gray-600",children:"Loading..."})]})})},Chat=()=>{const{projectId:l}=useConfirmitProject(),[c,d]=Gt.useState(null),{projectId:h}=useParams(),p=useNavigate();Gt.useEffect((()=>{h&&l&&h!==l&&p("/",{replace:!0})}),[l,h,p]),Gt.useEffect((()=>{(async()=>{try{const{data:{session:l},error:c}=await EC.auth.getSession();c&&console.error("Failed to get Supabase session:",c),l?.access_token&&d(l.access_token)}catch(l){console.error("Failed to get Supabase session:",l)}})();const{data:{subscription:l}}=EC.auth.onAuthStateChange(((l,c)=>{c?.access_token&&d(c.access_token)}));return()=>{l.unsubscribe()}}),[]);const f=c?`${IC.websocket_url}/document_to_survey_convertor/${h}/confirmit_session_data/completion?token=${c}`:null;return c&&f?Kt.jsx(WebSocketProvider,{url:f,params:{instance_key:h||nanoid()},children:Kt.jsx(ChatContent,{accessToken:c})}):Kt.jsx("div",{children:"Loading authentication..."})},ReduxProvider=({children:l})=>Kt.jsx(Provider_default,{store:LR,children:l});function ConfigProvider({children:l}){const{data:c,isLoading:d,error:h,refetch:p,isSuccess:f}=useConfirmitConfig(),[m,y]=Gt.useState(!0),[_,b]=Gt.useState(0);return Gt.useEffect((()=>{if(c?.confirmit_base_url){y(!1);try{er.runtime.sendMessage({messageType:gr.reloadConfirmitConfig}).then((l=>{})).catch((l=>{}))}catch(l){}}}),[c]),Gt.useEffect((()=>{if(h&&_<3){b((l=>l+1));setTimeout((()=>{p()}),1e3*_)}else h&&_>=3&&y(!1)}),[h,p,_]),Gt.useEffect((()=>{d&&y(!0)}),[d]),Gt.useEffect((()=>{f&&(y(!1),b(0))}),[f]),m&&d&&!c?Kt.jsx("div",{className:"flex items-center justify-center h-screen",children:Kt.jsxs("div",{className:"text-center",children:[Kt.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-blue-600 mx-auto mb-2"}),Kt.jsx("p",{className:"text-sm text-gray-600",children:"Loading Confirmit configuration..."})]})}):h&&_>=3?Kt.jsx("div",{className:"flex items-center justify-center h-screen",children:Kt.jsxs("div",{className:"text-center",children:[Kt.jsx("div",{className:"text-red-500 mb-2",children:"\u26a0\ufe0f"}),Kt.jsx("p",{className:"text-sm text-red-600 mb-2",children:"Failed to load configuration"}),Kt.jsx("button",{onClick:()=>{b(0),p()},className:"px-3 py-1 bg-blue-600 text-white rounded text-sm hover:bg-blue-700",children:"Retry"})]})}):Kt.jsx(Kt.Fragment,{children:l})}const SimpleToolCallsDisplay=({toolCalls:l,executingToolCalls:c,toolCallErrors:d,maxRetriesReached:h,onRetryToolCall:p,isDevMode:f=!1,onCopy:m,onGroupFailure:y})=>{const[_,b]=Gt.useState(!1),[w,E]=Gt.useState(new Set),M=Gt.useRef(new Map),N=Gt.useRef(new Set),[P,L]=Gt.useState(new Set),j=Gt.useMemo((()=>l?.reduce(((l,c)=>(l.some((l=>l.id===c.id))||l.push(c),l)),[])||[]),[l]),D=Gt.useMemo((()=>{const l=new Map;j.forEach((c=>{const d=c?.operation_group_id||null,h=l.get(d)||[];l.set(d,[...h,c])}));return Array.from(l.entries()).map((([l,d])=>{const h=d.some((l=>c.has(l.id))),p=d.some((l=>"completed"===l.status)),f=d.some((l=>"failed"===l.status)),m=d.some((l=>"cancelled"===l.status)),y=d.every((l=>"completed"===l.status)),_=d[0]?.message||null;let b="General Actions";return l&&(b=(l=>{const c=l.match(/^q_(.+?)_(q\d+)$/i);if(c){const l=c[1].replace(/_/g," "),d=c[2].toUpperCase();return`${l.split(" ").map((l=>l.charAt(0).toUpperCase()+l.slice(1))).join(" ")} ${d}`}return l.replace(/^q_/,"").replace(/_/g," ").split(" ").map((l=>l.charAt(0).toUpperCase()+l.slice(1))).join(" ")})(l)),{questionId:l,toolCalls:d,displayName:b,message:_,hasExecuting:h,hasCompleted:p,hasFailed:f,hasCancelled:m,allCompleted:y}})).sort(((l,c)=>l.questionId&&!c.questionId?-1:!l.questionId&&c.questionId?1:0))}),[j,c]),F=Gt.useMemo((()=>D.findIndex((l=>l.hasFailed&&!P.has(l.toolCalls[0]?.id)))),[D,P]);Gt.useEffect((()=>{const l=new Set;D.forEach((c=>{if(!c.hasFailed||!c.questionId)return;const d=M.current.get(c.questionId)||new Set;c.toolCalls.forEach(((h,p)=>{if("failed"===h.status&&!d.has(h.id)){const d=c.toolCalls.slice(p+1).filter((l=>"pending"===l.status||"completed"===l.status)).map((l=>l.id));if(d.length>0){const p=d.filter((l=>!N.current.has(l)));p.length>0&&(p.forEach((c=>{l.add(c),N.current.add(c)})),y&&y(c.questionId,h.id,p))}M.current.has(c.questionId)||M.current.set(c.questionId,new Set),M.current.get(c.questionId).add(h.id)}}))})),l.size>0&&L((c=>{const d=new Set(c);return l.forEach((l=>d.add(l))),d}))}),[D,y]);const U=Array.from(c).filter((l=>j.some((c=>c.id===l)))).length,B=j.filter((l=>"completed"===l.status)).length,H=j.filter((l=>"failed"===l.status)).length,z=j.filter((l=>"cancelled"===l.status)).length;if(Gt.useEffect((()=>{if(U>0||H>0){b(!0);const l=new Set;D.forEach((c=>{(c.hasExecuting||c.hasFailed)&&l.add(c.questionId||"general")})),E(l)}}),[U,H,D]),!l||0===l.length)return null;const getGroupStatusIcon=l=>l.hasExecuting?Kt.jsx(wi,{className:"h-3 w-3 animate-spin text-primary"}):l.allCompleted?Kt.jsx(ls,{className:"h-3 w-3 text-green-500"}):l.hasFailed?Kt.jsx(as,{className:"h-3 w-3 text-red-500"}):l.hasCancelled?Kt.jsx(as,{className:"h-3 w-3 text-yellow-500"}):l.hasCompleted?Kt.jsx(ds,{className:"h-3 w-3 text-yellow-500"}):Kt.jsx("div",{className:"h-3 w-3 rounded-full border border-muted-foreground/30"});return Kt.jsx("div",{className:"tool-call-container mt-3 w-full",children:Kt.jsxs("div",{className:tr("relative overflow-hidden rounded-lg border bg-card/60 backdrop-blur-sm transition-all duration-300 w-full","hover:shadow-md hover:border-primary/30",_&&"shadow-md border-primary/20"),children:[Kt.jsxs("div",{className:tr("flex items-center justify-between px-4 py-3 cursor-pointer select-none w-full","group hover:bg-accent/10 transition-colors duration-200"),onClick:()=>b(!_),children:[Kt.jsxs("div",{className:"flex items-center gap-3",children:[Kt.jsxs("div",{className:"relative",children:[U>0?Kt.jsx(wi,{className:"h-4 w-4 animate-spin text-primary"}):B===j.length?Kt.jsx(ls,{className:"h-4 w-4 text-green-500"}):H>0?Kt.jsx(as,{className:"h-4 w-4 text-red-500"}):z>0?Kt.jsx(as,{className:"h-4 w-4 text-yellow-500"}):Kt.jsx(ds,{className:"h-4 w-4 text-yellow-500"}),U>0&&Kt.jsx("div",{className:"absolute inset-0 rounded-full animate-ping opacity-75",children:Kt.jsx("div",{className:"w-full h-full rounded-full bg-primary/20"})})]}),Kt.jsx("span",{className:"text-sm text-muted-foreground",children:(()=>{const l=D.filter((l=>l.questionId));D.filter((l=>l.allCompleted)).length;const c=D.filter((l=>l.hasFailed)).length,d=D.filter((l=>l.hasCancelled)).length,h=D.filter((l=>l.hasExecuting)).length;if(l.length>0){const p=l.filter((l=>l.allCompleted)).length;if(h>0)return"Processing Actions...";if(p===l.length)return"Completed all actions";if(c>0||d>0){const l=[];return p>0&&l.push(`${p} completed`),c>0&&l.push(`${c} with errors`),d>0&&l.push(`${d} cancelled`),`Questions: ${l.join(", ")}`}return"Executing Actions..."}if(U>0)return"Executing actions...";if(B===j.length)return"Completed all actions";if(H>0||z>0){const l=[];return B>0&&l.push(`${B} completed`),H>0&&l.push(`${H} failed`),z>0&&l.push(`${z} canceled`),l.join(", ")}return"Executing actions..."})()})]}),Kt.jsx(ns,{className:tr("h-4 w-4 text-muted-foreground transition-all duration-300","group-hover:text-foreground",_&&"rotate-180")})]}),Kt.jsx("div",{className:tr("overflow-y-auto transition-all duration-300 w-full",_?"max-h-[600px]":"max-h-0"),children:Kt.jsx("div",{className:"border-t w-full",children:1!==D.length||D[0].questionId?D.map(((l,y)=>{const _=l.questionId||"general",b=w.has(_),M=y===F;return Kt.jsxs("div",{className:tr("border-b last:border-b-0 border-border/20 w-full overflow-hidden",l.hasFailed&&!P.has(l.toolCalls[0]?.id)&&"border-red-500/30"),children:[Kt.jsxs("div",{className:tr("flex items-center gap-3 px-4 py-3 cursor-pointer w-full","hover:bg-accent/5 transition-all duration-200","bg-gradient-to-r from-muted/30 to-transparent",l.hasFailed&&!P.has(l.toolCalls[0]?.id)&&"from-red-50/30 to-red-50/5"),onClick:()=>(l=>{E((c=>{const d=new Set(c);return d.has(l)?d.delete(l):d.add(l),d}))})(_),children:[Kt.jsx("div",{className:tr("p-1.5 rounded-lg",l.questionId?"bg-primary/10":"bg-muted"),children:Kt.jsx(yi,{className:"h-3.5 w-3.5 text-muted-foreground"})}),Kt.jsxs("div",{className:"flex-1 flex flex-col gap-1",children:[Kt.jsx("span",{className:tr("text-sm font-medium",l.questionId?"text-foreground":"text-muted-foreground"),children:l.displayName}),l.message&&Kt.jsx("span",{className:"text-xs text-muted-foreground",children:l.message})]}),Kt.jsx("div",{className:"flex items-center gap-2",children:getGroupStatusIcon(l)})]}),M&&Kt.jsx("div",{className:"relative px-4 py-3 bg-red-50/50 border-y border-red-100/50",children:Kt.jsxs("div",{className:"flex items-start gap-3",children:[Kt.jsx(cs,{className:"h-4 w-4 text-red-500 mt-0.5 flex-shrink-0"}),Kt.jsxs("div",{className:"flex-1 min-w-0",children:[Kt.jsx("p",{className:"text-sm text-red-700 font-medium mb-1",children:l.displayName}),Kt.jsx("p",{className:"text-xs text-red-600/90",children:"This operation failed during session recreation."}),Kt.jsx("p",{className:"text-xs text-red-600/75 mt-1",children:"Note: Subsequent operations have been cancelled."})]})]})}),f&&b&&!P.has(l.toolCalls[0]?.id)&&Kt.jsxs("div",{className:"relative bg-accent/5 w-full",children:[Kt.jsx("div",{className:"absolute left-8 top-0 bottom-0 w-px bg-border/40"}),l.toolCalls.map(((y,_)=>{l.hasFailed&&l.toolCalls.findIndex((l=>"failed"===l.status));return l.hasFailed&&l.toolCalls.findIndex((l=>"failed"===l.status))<_?null:Kt.jsx(ToolCallItem,{toolCall:{...y,status:P.has(y.id)?"cancelled":y.status},index:_,isExecuting:c.has(y.id),executionError:d.get(y.id),canRetry:h.has(y.id),onRetry:()=>p(y),isDevMode:f,onCopy:m},`${y.id}-${_}`)}))]})]},_)})):Kt.jsxs("div",{className:"relative w-full",children:[Kt.jsx("div",{className:"absolute left-8 top-0 bottom-0 w-px bg-border/50"}),j.map(((l,y)=>Kt.jsx(ToolCallItem,{toolCall:{...l,status:P.has(l.id)?"cancelled":l.status},index:y,isExecuting:c.has(l.id),executionError:d.get(l.id),canRetry:h.has(l.id),onRetry:()=>p(l),isDevMode:f,onCopy:m},`${l.id}-${y}`)))]})})})]})})},SimpleMessageList=({messages:l,isStreaming:c,executingToolCalls:d,toolCallErrors:h,toolCallStatuses:p,maxRetriesReached:f,isDevMode:m,onRetryMessage:y,onRetryToolCall:_,onCopy:b,onCancelToolCallsForGroup:w})=>{const handleGroupFailure=(l,c,d)=>{w&&w(l,d)},isEmptyAssistantMessage=l=>!("assistant"!==l.role||l.generated_content||l.content||l.tool_calls&&0!==l.tool_calls.length),shouldShowNoActionsMessage=l=>{const d=l.id===E[E.length-1]?.id;return!c||!d},E=(l||[]).map((l=>({...l,tool_calls:l.tool_calls?.map((l=>({...l,status:p.get(l.id)||l.status})))}))).filter(((l,d,h)=>"user"===l.role||(!c||d!==h.length-1||!isEmptyAssistantMessage(l))&&(l.generated_content||l.content||void 0!==l.tool_calls)));return Kt.jsx("div",{className:"px-4 py-6",children:Kt.jsxs("div",{className:"flex flex-col gap-4 w-full max-w-4xl mx-auto",children:[E?.map(((l,c)=>Kt.jsx("div",{className:"message-enter",style:{animationDelay:.1*c+"s"},children:Kt.jsxs(Message,{className:"user"===l.role?"justify-end":"justify-start",children:["assistant"===l.role&&Kt.jsx(MessageAvatar,{src:"/avatars/ai.png",alt:"AI",fallback:"AI"}),Kt.jsxs("div",{className:"flex flex-col w-[100%]",children:["assistant"!==l.role&&Kt.jsx(MessageContent,{className:"user"===l.role?"message-bubble user bg-primary text-primary-foreground":"message-bubble assistant bg-muted/50 text-foreground",children:"user"===l.role?l?.generated_content||l?.content:""}),"assistant"===l.role&&Kt.jsx(Kt.Fragment,{children:l.tool_calls&&l.tool_calls.length>0?Kt.jsx(SimpleToolCallsDisplay,{toolCalls:l.tool_calls,executingToolCalls:d,toolCallErrors:h,maxRetriesReached:f,onRetryToolCall:_,isDevMode:m,onCopy:b,onGroupFailure:handleGroupFailure}):shouldShowNoActionsMessage(l)?Kt.jsx(MessageContent,{className:"message-bubble assistant bg-muted/50 text-foreground",children:"I understand, but I don't have any actions to perform at this moment."}):null}),"sending"===l.status&&Kt.jsx("div",{className:"text-xs text-muted-foreground mt-1",children:"Sending..."}),"error"===l.status&&Kt.jsxs("div",{className:"flex items-center gap-2 mt-1",children:[Kt.jsx("div",{className:"text-xs text-red-500",children:"Failed to send"}),Kt.jsxs(or,{size:"sm",variant:"ghost",onClick:()=>y(l),className:"h-6 px-2 text-xs",children:[Kt.jsx(Ni,{className:"h-3 w-3 mr-1"}),"Retry"]})]})]})]})},l.id))),(()=>{if(!c)return!1;if(!E.length)return!0;const l=E[E.length-1];return"user"===l.role||!("assistant"!==l.role||!isEmptyAssistantMessage(l))})()&&Kt.jsxs(Message,{className:"justify-start",children:[Kt.jsx(MessageAvatar,{src:"/avatars/ai.png",alt:"AI",fallback:"AI"}),Kt.jsxs("div",{className:"bg-muted/50 text-foreground rounded-lg p-2 flex items-center gap-2",children:[Kt.jsx(PulseDotLoader,{size:"sm"}),Kt.jsx("span",{className:"text-sm text-muted-foreground",children:"AI is thinking..."})]})]}),!c&&E.length>0&&isEmptyAssistantMessage(E[E?.length-1])&&Kt.jsx(Message,{className:"justify-start",children:Kt.jsx("div",{className:"border bg-white rounded-lg p-3 flex flex-col gap-3",children:Kt.jsx("div",{className:"flex items-start gap-2",children:Kt.jsx("div",{className:"flex-1",children:Kt.jsx("p",{className:"text-sm",children:"No survey actions were generated this time. This session recreation is complete."})})})})}),!c&&E.length>0&&"assistant"===E[E.length-1].role&&E[E.length-1].tool_calls&&E[E.length-1].tool_calls.length>0&&Kt.jsx(Message,{className:"justify-start",children:Kt.jsx("div",{className:"border bg-white rounded-lg p-3 flex flex-col gap-3",children:Kt.jsx("div",{className:"flex items-start gap-2",children:Kt.jsxs("div",{className:"flex-1",children:[Kt.jsx("p",{className:"text-sm font-medium",children:"Session Recreation Complete"}),Kt.jsx("p",{className:"text-sm mt-1",children:"The session has been recreated with all tool calls executed. Review the results above to see what was accomplished."})]})})})})]})})};function SmepCopySession(){const{sessionId:l}=useParams(),[c]=useSearchParams(),d="true"===c.get("execute"),{authToken:h,projectId:p}=useConfirmitProject(),{data:f,isLoading:m,isError:y,error:_,refetch:b,isSuccess:w}=function(l){return useQuery({queryKey:["sessionDetails",l],queryFn:async()=>{if(!l)throw new Error("Session ID is required");const c=await fetchWithAuth(`${IC.api_url}/document_to_survey_convertor/confirmit_session/${l}/details`,{method:"GET",headers:{"Content-Type":"application/json"},credentials:"include"});if(!c.ok){const l=await c.text();throw new Error(`Failed to fetch session details: ${c.status} ${l}`)}return c.json()},enabled:Boolean(l&&IC?.api_url),staleTime:3e5,retry:(l,c)=>!c.message.includes("404")&&!c.message.includes("403")&&l<3})}(l),[E,M]=Gt.useState([]),[N,P]=Gt.useState(!1),[L,j]=Gt.useState(!1),[D,F]=Gt.useState(0),[U,B]=Gt.useState(new Set),[H,z]=Gt.useState(new Map),[q,V]=Gt.useState(new Map),[Z,K]=Gt.useState(new Set),Y=((l={})=>{const{authToken:c,projectId:d}=useConfirmitProject(),h=Gt.useRef(null),p=Gt.useRef(new Set),f=Gt.useRef(new Set),[m,y]=Gt.useState(new Map),[b,w]=Gt.useState(!1),E=Gt.useRef([]),M=Gt.useRef(!1),N=Gt.useRef(new Map);Gt.useEffect((()=>{(async()=>{if(c&&d){const l=await getConfirmitBaseUrl();l&&(h.current=new MM({baseUrl:l,projectId:d,authToken:c}))}})()}),[c,d]);const P=Gt.useCallback(((c,d)=>{d.forEach((c=>{l.onStatusUpdate?.(c,"cancelled")})),E.current=E.current.filter((l=>!d.includes(l.toolCall.id))),d.forEach((l=>{f.current.add(l),p.current.delete(l)}))}),[l]),L=Gt.useCallback(((l,c)=>{const d=E.current.filter((d=>d.messageId===c&&d.toolCall.id!==l.id&&!f.current.has(d.toolCall.id))).map((l=>l.toolCall.id)),h=l.operation_group_id;if(h){const c=N.current.get(h);c&&c.forEach((c=>{c===l.id||f.current.has(c)||d.includes(c)||d.push(c)}))}d.length>0&&P(h||c,d)}),[P]),j=Gt.useCallback((async l=>{if(!h.current)throw new Error("API not initialized. Missing auth token or project ID.");switch(l.type){case"createQuestion":case"createNode":{const{node_id:c,question_type:d,node_type:p,position:f}=l.payload,m={nodeId:c,type:d||p,position:f};try{const c=await h.current.createQuestion(m),d=await c.json(),p=c.ok||200===c.status||201===c.status;return{success:p,status:c.status,message:p?"Question created successfully":"Failed to create question",data:d,originalPayload:l.payload,apiPayload:m}}catch(_){return{success:!1,status:500,message:_ instanceof Error?_.message:"createQuestion API call failed",data:null,originalPayload:l.payload,apiPayload:m}}}case"updateQuestion":case"updateNode":{const{node_id:c,question_payload_content:d,node_payload:p}=l.payload;if(!c)throw new Error("node_id is required for updateQuestion");const f={nodeId:c,data:d||p};try{const c=await h.current.updateQuestionSafely(f);return{success:c.success,message:c.message,data:c,originalPayload:l.payload,apiPayload:f}}catch(_){return{success:!1,message:_ instanceof Error?_.message:"updateQuestion API call failed",data:null,originalPayload:l.payload,apiPayload:f}}}case"getAnswers":{const{node_id:c,nodeId:d=c,question_type:p,type:f=p}=l.payload,m=d||c,y=f||p;if(!m)throw new Error("node_id is required for getAnswers");if(!y)throw new Error("question_type is required for getAnswers");const b={nodeId:m,type:y};try{const c=await h.current.getAnswersData(b);return{success:c.success,message:c.message,data:c,originalPayload:l.payload,apiPayload:b}}catch(_){return{success:!1,message:_ instanceof Error?_.message:"getAnswers API call failed",data:null,originalPayload:l.payload,apiPayload:b}}}case"updateAnswers":{const{node_id:c,nodeId:d=c,question_type:p,type:f=p,answer_payload_content:m}=l.payload,y=d||c,b=f||p;if(!y)throw new Error("node_id or nodeId is required for updateAnswers");if(!b)throw new Error("question_type or type is required for updateAnswers");if(!m)throw new Error("answers_payload_content is required for updateAnswers");const w={nodeId:y,type:["multiopen","multi","multiopennumeric","multiordered"].includes(b.toLowerCase())?"Multi":"grid"===b?"Grid":["multigrid","3dgrid"].includes(b.toLowerCase())?"Grid3D":b,data:m};try{const c=await h.current.updateAnswersSafely(w);return{success:c.success,message:c.message,data:c,originalPayload:l.payload,apiPayload:w}}catch(_){return{success:!1,message:_ instanceof Error?_.message:"updateAnswers API call failed",data:null,originalPayload:l.payload,apiPayload:w}}}case"getRouting":{const{expandToNode:c}=l.payload,d={expandToNode:c};try{const c=await h.current.getRoutingDataWithChildren(d);return{success:!!c,message:c?"Routing data retrieved successfully":"Failed to retrieve routing data",data:c,originalPayload:l.payload,apiPayload:d}}catch(_){return{success:!1,message:_ instanceof Error?_.message:"getRouting API call failed",data:null,originalPayload:l.payload,apiPayload:d}}}case"deleteNode":{const{node_id:c,nodeId:d=c}=l.payload,p=d||c;if(!p)throw new Error("node_id is required for deleteNode");const f={nodeId:p};try{const c=await h.current.deleteNodeSafely(f);return{success:c.success,message:c.message,data:c,originalPayload:l.payload,apiPayload:f}}catch(_){return{success:!1,message:_ instanceof Error?_.message:"deleteNode API call failed",data:null,originalPayload:l.payload,apiPayload:f}}}default:throw new Error(`Unknown tool call type: ${l.type}`)}}),[]),D=Gt.useCallback((async({toolCall:c,messageId:d,attemptNumber:h=1})=>{const b=performance.now();if(f.current.has(c.id))return;const w=l.getCurrentStatus?.(c.id)||c.status;if("cancelled"===w||"completed"===w||"failed"===w)return void f.current.add(c.id);const E=m.get(c.id);if(!E?.maxRetriesReached){if(h>3)return y((l=>{const d=new Map(l);return d.set(c.id,{attempts:h,lastError:new Error("Max retries exceeded"),maxRetriesReached:!0}),d})),f.current.add(c.id),l.onStatusUpdate?.(c.id,"failed"),void l.onMaxRetriesReached?.(c.id);p.current.add(c.id),l.onStatusUpdate?.(c.id,"pending");try{if("cancelled"===(l.getCurrentStatus?.(c.id)||c.status))return f.current.add(c.id),p.current.delete(c.id),void l.onStatusUpdate?.(c.id,"cancelled");const d=await j(c);if(performance.now(),!0!==d?.success)throw new Error(d?.message||"API call failed");f.current.add(c.id),p.current.delete(c.id),y((l=>{const d=new Map(l);return d.delete(c.id),d})),l.onStatusUpdate?.(c.id,"completed"),l.onSuccess?.(c.id,d)}catch(_){const w=performance.now()-b,E=_ instanceof Error?_:new Error(String(_));if(console.error(`Tool call ${c.type} failed:`,{toolCallId:c.id,error:E.message,duration:w,attemptNumber:h,messageId:d}),p.current.delete(c.id),y((l=>{const d=new Map(l);return d.set(c.id,{attempts:h,lastError:E,maxRetriesReached:h>=3}),d})),h<3){const l=Math.min(1e3*Math.pow(2,h-1),5e3);return await new Promise((c=>setTimeout(c,l))),await D({toolCall:c,messageId:d,attemptNumber:h+1})}f.current.add(c.id),l.onStatusUpdate?.(c.id,"failed"),l.onError?.(c.id,E),l.onMaxRetriesReached?.(c.id),L(c,d)}}}),[l,m,j,L]),F=Gt.useCallback((async()=>{if(!M.current&&0!==E.current.length){M.current=!0,w(!0);try{let c=0;for(;E.current.length>0;){const d=E.current.shift();if(!d)break;const{toolCall:h,messageId:p}=d;if(c++,f.current.has(h.id))continue;const m=l.getCurrentStatus?.(h.id)||h.status;if("cancelled"!==m&&"completed"!==m&&"failed"!==m){try{await D({toolCall:h,messageId:p,attemptNumber:1})}catch(_){f.current.has(h.id)||(f.current.add(h.id),l.onStatusUpdate?.(h.id,"failed"),l.onError?.(h.id,_ instanceof Error?_:new Error(String(_))),L(h,p))}await new Promise((l=>setTimeout(l,1e3)))}else f.current.add(h.id)}}catch(_){console.error("Queue processing error:",_)}finally{M.current=!1,w(!1),l.onQueueProcessingComplete&&l.onQueueProcessingComplete()}}}),[D,l,L]),U=Gt.useCallback((async(c,d)=>{c.forEach((l=>{const c=l.operation_group_id||d;N.current.has(c)||N.current.set(c,new Set),N.current.get(c).add(l.id)}));const h=c.filter((c=>{const d=!f.current.has(c.id),h=!m.get(c.id)?.maxRetriesReached,y=!p.current.has(c.id),_=l.getCurrentStatus?.(c.id)||c.status;return d&&h&&"pending"===_&&y&&!("completed"===_)&&!("failed"===_)&&!("cancelled"===_)}));0!==h.length&&(h.forEach((l=>{E.current.push({toolCall:l,messageId:d})})),await F())}),[F,m,l]),B=Gt.useCallback((async(l,c,d)=>{y((c=>{const d=new Map(c);return d.delete(l),d})),f.current.delete(l),p.current.delete(l),E.current.unshift({toolCall:d,messageId:c}),await F()}),[F]),H=Gt.useCallback((()=>{p.current.clear(),f.current.clear(),E.current=[],M.current=!1,y(new Map),w(!1),N.current.clear()}),[]),z=Gt.useCallback((l=>!0===m.get(l)?.maxRetriesReached),[m]);return{executeToolCall:D,executeToolCalls:U,retryToolCall:B,reset:H,hasReachedMaxRetries:z,isReady:Boolean(h.current),isExecuting:b,retryInfo:m,isToolCallProcessed:l=>f.current.has(l),getProcessedCount:()=>f.current.size,cancelToolCallsForGroup:P}})({onStatusUpdate:(l,c)=>{V((d=>new Map(d).set(l,c))),B("pending"===c?c=>new Set(c).add(l):c=>{const d=new Set(c);return d.delete(l),d})},onError:(l,c)=>{z((d=>new Map(d).set(l,c.message)))},onSuccess:(l,c)=>{},onMaxRetriesReached:l=>{K((c=>new Set(c).add(l)))},getCurrentStatus:l=>q.get(l)}),ee=Gt.useCallback((l=>l?.turns?l.turns.map(((c,d)=>({id:`${l.session_id}-turn-${d}`,role:c.role,content:c.content||"",generated_content:c.content||"",timestamp:Date.now()-1e3*(l.turns.length-d),tool_calls:c.tool_calls?.map((l=>{let c=l.status||"pending";return"completed"===c&&(c="pending"),{...l,status:c}}))||[]}))):[]),[]);Gt.useEffect((()=>{if(w&&f){const l=ee(f);M(l);const c=new Map;l.forEach((l=>{l.tool_calls?.forEach((l=>{c.set(l.id,l.status)}))})),V(c)}}),[w,f,ee]),Gt.useEffect((()=>{d&&E.length>0&&Y.isReady&&!N&&ne()}),[d,E,Y.isReady,N]);const ne=Gt.useCallback((async()=>{if(E.length&&!N){P(!0),j(!1),F(0);try{let c=0;for(let d=0;d<E.length&&!L;d++){const f=E[d];if(F(d),"user"===f.role&&c++,"assistant"===f.role&&f.tool_calls?.length){const d=f.tool_calls.filter((l=>"pending"===q.get(l.id)));if(d.length>0){if(c>=2&&h&&p)try{const l=await getConfirmitBaseUrl();if(l){const c=new MM({baseUrl:l,projectId:p,authToken:h}),d=await c.getRoutingDataWithNewNode({createNode:!0,nodeType:"open",position:"After"});d.success||console.warn("\u26a0\ufe0f Failed to get fresh routing data:",d.message)}}catch(l){console.error("\u274c Failed to fetch fresh routing data:",l)}await Y.executeToolCalls(d,f.id)}}await new Promise((l=>setTimeout(l,1e3)))}}catch(l){console.error("Session execution failed:",l)}finally{P(!1),F(0)}}}),[E,N,L,q,Y,h,p]),se=Gt.useCallback((()=>{N?j(!L):ne()}),[N,L,ne]),ie=Gt.useCallback((()=>{P(!1),j(!1),F(0),B(new Set),z(new Map),K(new Set);const l=new Map;E.forEach((c=>{c.tool_calls?.forEach((c=>{let d=c.status;"completed"===d&&(d="pending"),l.set(c.id,d)}))})),V(l),Y.reset()}),[E,Y]),oe=Gt.useCallback((l=>{const c=E.find((c=>c.tool_calls?.some((c=>c.id===l.id))));c&&(z((c=>{const d=new Map(c);return d.delete(l.id),d})),K((c=>{const d=new Set(c);return d.delete(l.id),d})),Y.retryToolCall(l.id,c.id,l))}),[E,Y]),le=Gt.useCallback(((l,c)=>{Y.cancelToolCallsForGroup(l,c)}),[Y]),ce=Gt.useMemo((()=>{const l=Array.from(q.entries()).filter((([l,c])=>"pending"===c||"completed"===c)).length,c=Array.from(q.entries()).filter((([l,c])=>"completed"===c)).length;return l>0?c/l*100:0}),[q]);return m?Kt.jsx("div",{className:"flex items-center justify-center min-h-screen",children:Kt.jsxs("div",{className:"flex items-center gap-2",children:[Kt.jsx(PulseDotLoader,{size:"sm"}),Kt.jsx("span",{children:"Loading session details..."})]})}):y?Kt.jsx("div",{className:"container mx-auto p-6 max-w-2xl",children:Kt.jsxs(Ax,{children:[Kt.jsx(Ox,{children:Kt.jsxs(Mx,{className:"flex items-center gap-2 text-red-600",children:[Kt.jsx(as,{className:"h-5 w-5"}),"Error Loading Session"]})}),Kt.jsxs(Px,{children:[Kt.jsx("p",{className:"text-sm text-muted-foreground mb-4",children:_?.message||"Failed to load session details"}),Kt.jsx(or,{onClick:()=>b(),variant:"outline",children:"Retry"})]})]})}):Kt.jsxs("div",{className:"min-h-screen bg-background",children:[Kt.jsxs("div",{className:"sticky top-0 z-10 border-b bg-background/95 backdrop-blur supports-[backdrop-filter]:bg-background/60 p-4",children:[Kt.jsxs("div",{className:"flex items-center justify-between",children:[Kt.jsxs("div",{children:[Kt.jsx("h1",{className:"text-xl font-semibold",children:"Session Recreation"}),Kt.jsxs("p",{className:"text-sm text-muted-foreground",children:["Session ID: ",l," | Execute: ",d?"Yes":"No"]})]}),Kt.jsxs("div",{className:"flex items-center gap-2",children:[Kt.jsx(or,{onClick:se,disabled:!Y.isReady||0===E.length,variant:N?"secondary":"default",children:N?L?Kt.jsxs(Kt.Fragment,{children:[Kt.jsx(Ri,{className:"h-4 w-4 mr-2"}),"Resume"]}):Kt.jsxs(Kt.Fragment,{children:[Kt.jsx(ki,{className:"h-4 w-4 mr-2"}),"Pause"]}):Kt.jsxs(Kt.Fragment,{children:[Kt.jsx(Ri,{className:"h-4 w-4 mr-2"}),"Execute"]})}),Kt.jsxs(or,{onClick:ie,variant:"outline",disabled:N&&!L,children:[Kt.jsx(Pi,{className:"h-4 w-4 mr-2"}),"Reset"]})]})]}),(N||ce>0)&&Kt.jsxs("div",{className:"mt-3",children:[Kt.jsxs("div",{className:"flex justify-between text-xs text-muted-foreground mb-1",children:[Kt.jsx("span",{children:"Execution Progress"}),Kt.jsxs("span",{children:[Math.round(ce),"%"]})]}),Kt.jsx("div",{className:"w-full bg-muted rounded-full h-2",children:Kt.jsx("div",{className:"bg-primary h-2 rounded-full transition-all duration-300",style:{width:`${ce}%`}})})]})]}),Kt.jsx("div",{className:"pb-4",children:Kt.jsx(SimpleMessageList,{messages:E,isStreaming:!1,executingToolCalls:U,toolCallErrors:H,toolCallStatuses:q,maxRetriesReached:Z,isDevMode:!0,onRetryMessage:()=>{},onRetryToolCall:oe,onCopy:l=>navigator.clipboard.writeText(l),onCancelToolCallsForGroup:le})})]})}const useAuth=()=>{const[l,c]=Gt.useState(null),[d,h]=Gt.useState(!0);return Gt.useEffect((()=>{(async()=>{try{const{data:{session:l},error:d}=await EC.auth.getSession();if(d)return console.error("Error fetching session:",d),c(null),void h(!1);if(c(l?.user??null),h(!1),l?.user){const c={userId:l.user.id,email:l.user.email||"",fullName:l.user.user_metadata?.full_name||""};await er.storage.local.set({confirmit_extension_session:c}),er.tabs.query({url:"*://*.confirmit.com/*"}).then((l=>{l.forEach((l=>{l.id&&er.tabs.sendMessage(l.id,{type:"session_update",sessionData:c}).catch((()=>{}))}))}))}}catch(l){console.error("Unexpected error in getSession:",l),c(null),h(!1)}})();const{data:{subscription:l}}=EC.auth.onAuthStateChange((async(l,d)=>{if(c(d?.user??null),h(!1),d?.user){const l={userId:d.user.id,email:d.user.email||"",fullName:d.user.user_metadata?.full_name||""};await er.storage.local.set({confirmit_extension_session:l}),er.tabs.query({url:"*://*.confirmit.com/*"}).then((c=>{c.forEach((c=>{c.id&&er.tabs.sendMessage(c.id,{type:"session_update",sessionData:l}).catch((()=>{}))}))}))}else await er.storage.local.remove("confirmit_extension_session"),er.tabs.query({url:"*://*.confirmit.com/*"}).then((l=>{l.forEach((l=>{l.id&&er.tabs.sendMessage(l.id,{type:"session_clear"}).catch((()=>{}))}))}))}));return()=>l.unsubscribe()}),[]),{user:l,loading:d}},ProtectedRoute=({children:l})=>{const{user:c,loading:d}=useAuth();return d?Kt.jsx("div",{className:"flex h-screen items-center justify-center",children:Kt.jsxs("div",{className:"text-center",children:[Kt.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-primary mx-auto mb-4"}),Kt.jsx("p",{className:"text-sm text-muted-foreground",children:"Loading..."})]})}):c?Kt.jsx(ConfigProvider,{children:l}):Kt.jsx(Navigate,{to:"/login",replace:!0})},ActiveSurveyGuard=({children:l})=>{const{isValidSurveyPage:c,isLoading:d,refresh:h,currentUrl:p,isConfirmitPage:f}=useActiveSurveyMonitor(),m=useLocation(),y=Gt.useMemo((()=>{if(m.pathname.includes("/chat"))return!1;if("/"===m.pathname){if(!p||!f)return!0;try{const l=new URL(p).pathname;return"/surveydesigner/"===l||"/surveydesigner/new-survey"===l||(l.includes("/surveydesigner/p"),!c)}catch{return!0}}return!1}),[p,f,m.pathname,c]);return d?Kt.jsx("div",{className:"flex h-screen items-center justify-center",children:Kt.jsxs("div",{className:"text-center",children:[Kt.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-primary mx-auto mb-4"}),Kt.jsx("p",{className:"text-sm text-muted-foreground",children:"Checking survey..."})]})}):y?Kt.jsx(NoActiveSurvey,{onRefresh:h}):Kt.jsx(Kt.Fragment,{children:l})},ConfirmitSiteGuard=({children:l})=>{const[c,d]=Gt.useState(!0),[h,p]=Gt.useState(""),[f,m]=Gt.useState(!0),[y,_]=Gt.useState(!1),b=Gt.useCallback((async()=>{try{const[c]=await er.tabs.query({active:!0,currentWindow:!0});if(c?.url){const h=new URL(c.url).hostname.endsWith(".confirmit.com");if(d(h),p(c.url),h&&c.id)try{const l=await er.cookies.get({url:c.url,name:"idsrv.session"}),d=await er.cookies.getAll({domain:".confirmit.com"}),h=!!l||d.some((l=>["idsrv.session","confirmit.session",".AspNet.Cookies"].includes(l.name)));_(h)}catch(l){console.error("Failed to check Confirmit session:",l),_(!1)}else _(!1)}}catch(c){console.error("Failed to check active tab URL:",c),d(!1),_(!1)}finally{m(!1)}}),[]);return Gt.useEffect((()=>{b();const handleTabUpdate=(l,c,d)=>{("complete"===c.status||c.url)&&b()},handleTabActivated=l=>{b()};er.tabs.onUpdated.addListener(handleTabUpdate),er.tabs.onActivated.addListener(handleTabActivated);const l=setInterval(b,2e3);return()=>{er.tabs.onUpdated.removeListener(handleTabUpdate),er.tabs.onActivated.removeListener(handleTabActivated),clearInterval(l)}}),[b]),f?Kt.jsx("div",{className:"flex h-screen items-center justify-center",children:Kt.jsxs("div",{className:"text-center",children:[Kt.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-primary mx-auto mb-4"}),Kt.jsx("p",{className:"text-sm text-muted-foreground",children:"Checking site..."})]})}):Kt.jsx(Kt.Fragment,{children:l})},LoginPage=()=>{const l=useNavigate(),{user:c,loading:d}=useAuth();return Gt.useEffect((()=>{!d&&c&&l("/",{replace:!0})}),[c,d,l]),d?Kt.jsx("div",{className:"flex h-screen items-center justify-center",children:Kt.jsxs("div",{className:"text-center",children:[Kt.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-primary mx-auto mb-4"}),Kt.jsx("p",{className:"text-sm text-muted-foreground",children:"Loading..."})]})}):Kt.jsx("div",{className:"flex h-screen items-center justify-center",children:Kt.jsx(Login,{onSuccess:()=>{l("/",{replace:!0})},onSignupClick:()=>{console.log("Navigate to signup")},onForgotPasswordClick:()=>{l("/forget-password")}})})},AnalyticsProvider=({session:l})=>(Gt.useEffect((()=>{try{if(!ro.init("bc60b40ec8356f84ba6214dfc277fdcbe6de326a",{region:"eu",advancedNetwork:{websockets:!0,allowedUrls:[/.*/],allowedHeaders:["*","content-type","authorization","x-api-key","x-request-id","x-correlation-id","accept","cache-control","user-agent","referer","origin"]},cookies:!0,interceptors:{network:(l,c)=>{if((l.url.includes("websocket")||l.url.includes("ws://")||l.url.includes("wss://"))&&ro.track("websocket_activity",{url:l.url,hasRequest:!!l.request,hasResponse:!!l.response}),l.response?.body)try{const c=JSON.parse(l.response.body);(c.error||c.message?.includes("error"))&&ro.track("api_error",{url:l.url,error:c.error||c.message})}catch(hh){}},error:(l,c)=>{console.error("[Smartlook Error]",l),ro.track("js_error",{message:l.message||"",filename:l.filename||"",line:l.lineno||0,column:l.colno||0})},click:(l,c)=>{console.log("[Smartlook Click]",l)}}}))return void console.error("[Analytics] Failed to initialize Smartlook");l?.user?.id&&ro.identify(l.user.id,{name:l.user.user_metadata?.full_name||"",email:l.user.email||"",environment:"development"}),ro.record({forms:!0,api:!0,ips:!0,numbers:!0,emails:!0});const c=window.wsErrors;c&&Array.isArray(c)&&c.length>0&&(console.log(`[Analytics] Tracking ${c.length} WebSocket errors`),c.forEach((l=>{ro.track("websocket_error",{type:l.type,url:l.url||"",details:JSON.stringify(l.details)})}))),ro.track("app_initialized",{userId:l?.user?.id||"anonymous",sessionStartTime:(new Date).toISOString()})}catch(c){console.error("[Analytics] Error initializing Smartlook:",c)}return()=>{console.log("[Analytics] Cleaning up analytics provider")}}),[l]),null),SettingsRoute=()=>{const{theme:l}=useTheme(),c=useNavigate();return Kt.jsxs("div",{className:`${l} flex h-screen flex-col`,children:[Kt.jsx("div",{className:"border-b bg-background/95 backdrop-blur-sm p-4",children:Kt.jsxs("div",{className:"flex items-center justify-between",children:[Kt.jsxs("div",{className:"flex items-center gap-2",children:[Kt.jsx(or,{variant:"ghost",size:"sm",onClick:()=>{c("/")},className:"text-muted-foreground hover:text-foreground",children:"\u2190 Back"}),Kt.jsx("h1",{className:"text-lg font-semibold",children:"Settings"})]}),Kt.jsx(or,{variant:"ghost",size:"sm",onClick:async()=>{try{await EC.auth.signOut(),c("/login",{replace:!0})}catch(l){console.error("Error logging out:",l)}},className:"text-muted-foreground hover:text-foreground",children:"Logout"})]})}),Kt.jsx("div",{className:"flex-1 overflow-y-auto p-4",children:Kt.jsx(SettingsPage,{})})]})},App=()=>{const{theme:l}=useTheme(),{i18n:c}=useTranslation();return useAuthToken(),Gt.useEffect((()=>{initializeTelemetry()}),[]),Gt.useEffect((()=>{!async function(){const l=await er.storage.local.get("i18n");l.i18n&&await c.changeLanguage(l.i18n)}()}),[]),Kt.jsxs(Kt.Fragment,{children:[Kt.jsx("style",{children:"\n        @keyframes slideIn {\n          from {\n            opacity: 0;\n            transform: translateX(-20px);\n          }\n          to {\n            opacity: 1;\n            transform: translateX(0);\n          }\n        }\n        \n        @keyframes checkPulse {\n          0% {\n            transform: scale(0.8);\n            opacity: 0;\n          }\n          50% {\n            transform: scale(1.2);\n          }\n          100% {\n            transform: scale(1);\n            opacity: 1;\n          }\n        }\n        \n        .check-animation {\n          animation: checkPulse 0.6s ease-out forwards;\n        }\n      "}),Kt.jsx("div",{className:`${l} h-screen`,children:Kt.jsxs(Routes,{children:[Kt.jsx(Route,{path:"/login",element:Kt.jsx(LoginPage,{})}),Kt.jsx(Route,{path:"/",element:Kt.jsx(ProtectedRoute,{children:Kt.jsx(ConfirmitSiteGuard,{children:Kt.jsx(ActiveSurveyGuard,{children:Kt.jsx(Dashboard,{})})})})}),Kt.jsx(Route,{path:"/:projectId/chat",element:Kt.jsx(ProtectedRoute,{children:Kt.jsx(ConfirmitSiteGuard,{children:Kt.jsx(ActiveSurveyGuard,{children:Kt.jsx(Chat,{})})})})}),Kt.jsx(Route,{path:"/settings",element:Kt.jsx(ProtectedRoute,{children:Kt.jsx(ConfirmitSiteGuard,{children:Kt.jsx(SettingsRoute,{})})})}),Kt.jsx(Route,{path:"/:sessionId/SmepCopySession",element:Kt.jsx(ProtectedRoute,{children:Kt.jsx(ConfirmitSiteGuard,{children:Kt.jsx(SmepCopySession,{})})})}),Kt.jsx(Route,{path:"*",element:Kt.jsx(Navigate,{to:"/",replace:!0})})]})}),Kt.jsx(bo,{closeButton:!0})]})};function Dashboard(){const[l,c]=Gt.useState(null),[d,h]=Gt.useState(!1),[p,f]=Gt.useState([]),[m,y]=Gt.useState([]),[_,b]=Gt.useState(!1),[w,E]=Gt.useState(!1),[M,N]=Gt.useState(!1),[P,L]=Gt.useState(!1),[j,D]=Gt.useState([]),[F,U]=Gt.useState(!1),[B,H]=Gt.useState(!1),[z,q]=Gt.useState(!1),[V,Z]=Gt.useState(void 0),[K,Y]=Gt.useState(void 0),[ee,ne]=Gt.useState(""),[se,ie]=Gt.useState(!1),oe=useAuth(),le=oe.user?.email,ce=le?.endsWith("@workhack.ai"),pe=useAppDispatch(),{projectId:fe,currentUrl:ge,isLoading:be,authToken:Oe}=useConfirmitProject();Gt.useEffect((()=>{ge&&E(ge.includes("/surveydesigner/new-survey"))}),[ge]);const Ne=Gt.useCallback((async l=>{const c=l?.trim();if(c)if(Oe)try{const l=await getConfirmitBaseUrl();if(!l)return void Y(void 0);const d=new MM({baseUrl:l,projectId:fe||"",authToken:Oe}),h=await d.fetchTemplates({keywords:c,authToken:Oe});if(!h.ok){const l=await h.text().catch((()=>{}));throw new Error(`[Dashboard] Failed to fetch templates: ${h.status} ${h.statusText}${l?` - ${l}`:""}`)}const p=await h.json().catch((()=>{}));console.log(p,"templateResponse");const f=(Array.isArray(p)?p:Array.isArray(p?.Items)?p.Items:Array.isArray(p?.items)?p.items:[]).find((l=>{if(!l)return!1;return("string"==typeof l.Name?l.Name.trim():"string"==typeof l.name?l.name.trim():"")===c}));if(f){const l=f.ProjectId||f.projectId;if(l)return Y(l),void console.log(l,"projectIdentifier")}Y(void 0)}catch(d){console.error("[Dashboard] Error fetching template project ID:",d),Y(void 0)}else Y(void 0);else Y(void 0)}),[Oe,fe]);Gt.useEffect((()=>{!async function(){if(fe&&!w)try{const l=await getConfirmitBaseUrl();if(!l)return void h(!1);const d=`${l}/surveydesigner/api/surveys/${fe}`;h(!0);const p=await fetch(d,{headers:{Authorization:"Bearer "+Oe||""}});if(!p.ok){const l=`HTTP error! status: ${p.status}`;throw new Error(l)}const f=await p.json();c(f)}catch(l){console.error("[Dashboard] Error fetching survey data:",l)}finally{h(!1),console.log("[Dashboard] Completed survey data fetch")}else h(!1)}()}),[fe,Oe,w]),Gt.useEffect((()=>{(async()=>{if(fe&&!w){H(!0);try{const l=await getConfirmitBaseUrl();if(!l)throw new Error("No Confirmit base URL available");const c=new MM({baseUrl:l,projectId:fe,authToken:Oe||""}),d=await c.getDesignerLog(fe);if(d.success&&d.data?.items){const l=d.data.items.filter((l=>"Update project info"===l.operation));if(l.length>0){const c=l[l.length-1];if(c.description&&Array.isArray(c.description)){const l=c.description.find((l=>l.includes('Property "Name" changed:')));if(l){const c=l.match(/Property "Name" changed: "([^"]+)" -> "([^"]+)"/);if(c&&"New Project"!==c[1]){q(!0);let l=c[1];const d=/^Copy of\s*/i;d.test(l)&&(l=l.replace(d,"").trim()),Z(l),await Ne(l)}}}}}}catch(l){console.error("[Dashboard] Error fetching designer log:",l)}finally{H(!1)}}})()}),[fe,Oe,w]);const{mutate:De,isPending:Fe}=useNewSurvey(),Ue=useNavigate(),{data:Be}=useQuery({queryKey:["confirmit-session",He=fe||""],queryFn:async()=>{const l=await fetchWithAuth(`${IC.api_url}/document_to_survey_convertor/${He}/confirmit_session_data/completion/exists`,{method:"GET",headers:{"Content-Type":"application/json"}});if(!l.ok)throw new Error("Failed to check Confirmit session status");return l.json()},refetchOnWindowFocus:!1,refetchOnMount:!1,staleTime:3e5});var He;const qe=Gt.useRef(fe);Gt.useEffect((()=>{if(qe.current&&fe&&qe.current!==fe){console.log(`Project ID changed from ${qe.current} to ${fe}`),c(null),f([]);try{pe(cR()),pe(_R())}catch(l){console.error("Error clearing Redux state:",l)}}qe.current=fe,Be?.exists&&fe&&Ue(`/${fe}/chat`)}),[Be,fe,Ue,pe]);const handleFilesChange=l=>{p.length,f(l),l.length>0?L(!0):L(!1)};return Fe||be||d||B?Kt.jsx("div",{className:"fixed inset-0 flex justify-center items-center",children:Kt.jsxs("div",{className:"flex flex-col items-center gap-3",children:[Kt.jsx("div",{className:"h-8 w-8 animate-spin rounded-full border-4 border-violet-200 border-t-violet-600"}),Kt.jsx("p",{className:"text-sm text-gray-600",children:"Loading..."})]})}):Kt.jsxs("div",{className:"container mx-auto p-6 max-w-4xl",children:[Kt.jsx("div",{className:"mb-8",children:Kt.jsxs("div",{className:"flex items-center justify-between mb-2",children:[Kt.jsx("h2",{className:"text-xl font-semibold text-gray-900",children:"Dashboard"}),Kt.jsx("div",{className:"flex items-center gap-2",children:Kt.jsx(or,{variant:"ghost",size:"icon",onClick:()=>N(!0),className:"text-gray-600 hover:text-gray-900",title:"Settings",children:Kt.jsx(ji,{className:"h-5 w-5"})})})]})}),Kt.jsx("div",{className:"grid gap-6",children:Kt.jsxs(Ax,{children:[Kt.jsxs(Ox,{children:[Kt.jsx(Mx,{className:"text-lg",children:"Project Details"}),Kt.jsx(Nx,{children:"Basic information about your project"})]}),Kt.jsxs(Px,{children:[Kt.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[Kt.jsxs("div",{className:"flex items-center space-x-3 p-3 bg-gray-50 rounded-lg",children:[Kt.jsx("div",{className:"p-2 bg-blue-100 rounded-full",children:Kt.jsx(Gs,{className:"h-4 w-4 text-blue-600"})}),Kt.jsxs("div",{children:[Kt.jsx("p",{className:"text-sm font-medium text-gray-500",children:"Project Name"}),Kt.jsx("p",{className:"text-sm font-mono text-gray-900 select-all",children:l?.name})]})]}),Kt.jsxs("div",{className:"flex items-center space-x-3 p-3 bg-gray-50 rounded-lg",children:[Kt.jsx("div",{className:"p-2 bg-green-100 rounded-full",children:Kt.jsx(ts,{className:"h-4 w-4 text-green-600"})}),Kt.jsxs("div",{children:[Kt.jsx("p",{className:"text-sm font-medium text-gray-500",children:"Created Date"}),Kt.jsx("p",{className:"text-sm text-gray-900",children:l?.createdDate?new Date(l?.createdDate).toLocaleDateString("en-US",{year:"numeric",month:"long",day:"numeric",hour:"2-digit",minute:"2-digit"}):""})]})]}),Kt.jsxs("div",{className:"flex items-center space-x-3 p-3 bg-gray-50 rounded-lg",children:[Kt.jsx("div",{className:"p-2 bg-purple-100 rounded-full",children:Kt.jsx(Ji,{className:"h-4 w-4 text-purple-600"})}),Kt.jsxs("div",{children:[Kt.jsx("p",{className:"text-sm font-medium text-gray-500",children:"Created By"}),Kt.jsx("p",{className:"text-sm text-gray-900",children:l?.creatorFullName})]})]}),Kt.jsxs("div",{className:"flex items-center space-x-3 p-3 bg-gray-50 rounded-lg",children:[Kt.jsx("div",{className:"p-2 bg-orange-100 rounded-full",children:Kt.jsx(ds,{className:"h-4 w-4 text-orange-600"})}),Kt.jsxs("div",{children:[Kt.jsx("p",{className:"text-sm font-medium text-gray-500",children:"Last Updated"}),Kt.jsx("p",{className:"text-sm text-gray-900",children:l?.lastModified?new Date(l?.lastModified).toLocaleDateString("en-US",{year:"numeric",month:"long",day:"numeric",hour:"2-digit",minute:"2-digit"}):""})]})]}),Kt.jsx("div",{className:"col-span-full mt-4",children:Kt.jsxs("div",{className:"flex flex-col space-y-3",children:[Kt.jsxs("div",{className:"flex items-center space-x-3 p-3 bg-gray-50 rounded-lg",children:[Kt.jsx("div",{className:"p-2 bg-indigo-100 rounded-full",children:Kt.jsx(Os,{className:"h-4 w-4 text-indigo-600"})}),Kt.jsxs("div",{className:"flex-1",children:[Kt.jsx("p",{className:"text-sm font-medium text-gray-500",children:"Upload Files"}),Kt.jsx("p",{className:"text-xs text-gray-400",children:"Upload survey documents, templates, or reference files"})]})]}),Kt.jsx("div",{className:"mt-2 flex justify-center rounded-lg border-2 border-dashed px-6 py-10 transition-all duration-500 "+(p.length>0?"border-green-500 bg-green-50/30":F?"border-blue-500 bg-blue-50/50":"border-gray-300 hover:border-gray-400 bg-white"),onDragOver:l=>{l.preventDefault(),l.stopPropagation(),U(!0)},onDragLeave:l=>{l.preventDefault(),l.stopPropagation(),U(!1)},onDrop:l=>{l.preventDefault(),l.stopPropagation(),U(!1);const c=Array.from(l.dataTransfer.files);if(c.length>0){const l=p.map((l=>l.name)),d=c.filter((c=>l.includes(c.name))),h=c.filter((c=>!l.includes(c.name)));if(d.length>0&&(D(d.map((l=>l.name))),setTimeout((()=>D([])),3e3)),h.length>0){const l=[...p,...h];handleFilesChange(l)}}},children:Kt.jsxs("div",{className:"text-center",children:[Kt.jsxs("div",{className:"relative mx-auto h-12 w-12",children:[Kt.jsx(Ki,{className:"absolute inset-0 h-12 w-12 transition-all duration-500 "+(p.length>0?"opacity-0 scale-50 rotate-180":"opacity-100 scale-100 rotate-0 text-gray-300")}),Kt.jsx(rs,{className:"absolute inset-0 h-12 w-12 text-green-500 transition-all duration-500 "+(p.length>0?P?"check-animation":"opacity-100 scale-100 rotate-0":"opacity-0 scale-0")})]}),p.length>0&&Kt.jsxs("p",{className:"mt-2 text-sm font-medium text-green-600",children:[p.length," file",p.length>1?"s":""," uploaded"]}),Kt.jsxs("div",{className:"mt-4 flex text-sm leading-6 text-gray-600",children:[Kt.jsxs("label",{htmlFor:"file-upload",className:"relative cursor-pointer rounded-md bg-white font-semibold text-indigo-600 focus-within:outline-none focus-within:ring-2 focus-within:ring-indigo-600 focus-within:ring-offset-2 hover:text-indigo-500",children:[Kt.jsx("span",{children:"Upload files"}),Kt.jsx("input",{id:"file-upload",name:"file-upload",type:"file",accept:".pdf,.docx,.xlsx,.xls",onChange:l=>{const c=Array.from(l.target.files||[]);if(c.length>0){const l=p.map((l=>l.name)),d=c.filter((c=>l.includes(c.name))),h=c.filter((c=>!l.includes(c.name)));if(d.length>0&&(D(d.map((l=>l.name))),setTimeout((()=>D([])),3e3)),h.length>0){const l=[...p,...h];handleFilesChange(l)}}l.target.value=""},className:"sr-only"})]}),Kt.jsx("p",{className:"pl-1",children:F?"Drop files here":"or drag and drop"})]}),Kt.jsx("p",{className:"text-xs leading-5 text-gray-600",children:"PDF, DOCX, XLSX, XLS files up to 10MB"})]})}),j.length>0&&Kt.jsx("div",{className:"mt-2 p-3 bg-yellow-50 border border-yellow-200 rounded-md animate-in fade-in slide-in-from-top-1 duration-300",children:Kt.jsxs("div",{className:"flex items-center gap-2",children:[Kt.jsx(as,{className:"h-4 w-4 text-yellow-600"}),Kt.jsxs("p",{className:"text-sm text-yellow-800",children:["Skipped duplicate file",j.length>1?"s":"",":",Kt.jsx("span",{className:"font-medium ml-1",children:j.join(", ")})]})]})}),p?.length>0&&Kt.jsxs("div",{className:"mt-4 animate-in fade-in slide-in-from-bottom-2 duration-300",children:[Kt.jsxs("h4",{className:"text-sm font-medium text-gray-900 mb-2",children:["Uploaded Files (",p.length,")"]}),Kt.jsx("div",{className:"space-y-2",children:p.map(((l,c)=>Kt.jsxs("div",{id:`file-${c}`,className:"flex items-center justify-between p-2 bg-gray-50 rounded-md transition-all duration-200 hover:bg-gray-100 hover:shadow-sm",style:{animation:`slideIn 0.3s ease-out ${50*c}ms both`},children:[Kt.jsxs("div",{className:"flex items-center space-x-2 flex-1 min-w-0",children:[Kt.jsx("div",{className:"p-2 bg-gradient-to-br from-blue-100 to-blue-200 rounded-lg flex-shrink-0",children:Kt.jsx(Gs,{className:"h-4 w-4 text-blue-700"})}),Kt.jsxs("div",{className:"flex-1 min-w-0",children:[Kt.jsx("span",{className:"text-sm text-gray-700 block truncate",title:l.name,children:l.name}),Kt.jsxs("span",{className:"text-xs text-gray-500",children:[Math.round(l.size/1024)," KB"]})]})]}),Kt.jsx(or,{variant:"ghost",size:"sm",onClick:()=>{const l=document.getElementById(`file-${c}`);l&&(l.style.opacity="0",l.style.transform="translateX(-20px)",setTimeout((()=>{const l=p.filter(((l,d)=>d!==c));f(l)}),200))},className:"text-red-500 hover:text-red-700 transition-colors",children:Kt.jsx(Qi,{className:"h-4 w-4"})})]},`${l.name}-${l.lastModified}`)))})]})]})}),ce&&Kt.jsx("div",{className:"col-span-full mt-4",children:Kt.jsxs(Ax,{children:[Kt.jsxs(Ox,{children:[Kt.jsx(Mx,{className:"text-lg",children:"Quick Access"}),Kt.jsx(Nx,{children:"Enter an existing session ID to join directly"})]}),Kt.jsx(Px,{children:Kt.jsxs("div",{className:"space-y-3",children:[Kt.jsx(NI,{placeholder:"Enter session ID",value:ee,onChange:l=>ne(l.target.value),className:"w-full"}),Kt.jsxs("div",{className:"flex items-center space-x-2",children:[Kt.jsx("input",{type:"checkbox",id:"execute",checked:se,onChange:l=>ie(l.target.checked),className:"h-4 w-4 text-blue-600 focus:ring-blue-500 border-gray-300 rounded"}),Kt.jsx("label",{htmlFor:"execute",className:"text-sm font-medium leading-none peer-disabled:cursor-not-allowed peer-disabled:opacity-70",children:"Execute"})]}),Kt.jsx(or,{onClick:()=>{ee.trim()&&Ue(`/${ee}/SmepCopySession?execute=${se}`)},disabled:!ee.trim(),className:"w-full",children:"Copy Session ID"})]})})]})})]}),Kt.jsx("div",{className:"mt-4",children:Kt.jsx(or,{className:"w-full flex items-center justify-center gap-2",onClick:()=>{0!==p.length?b(!0):vo.error("Please upload question files first",{description:"Upload survey documents, templates, or reference files to continue",duration:4e3})},children:"Continue"})})]})]})}),Kt.jsx(SettingsModal,{isOpen:M,onClose:()=>N(!1),onLogout:async()=>{try{pe(cR()),pe(_R()),await EC.auth.signOut(),Ue("/login",{replace:!0})}catch(l){console.error("Error logging out:",l),Ue("/login",{replace:!0})}}}),Kt.jsx(MediaUploadModal,{isOpen:_,onClose:()=>{b(!1)},onSave:c=>{const d=c.map(((l,c)=>({file_url:l?.url,description:l?.description,order_key:l?.order_key||`${Date.now()}-${c+1}`})));pe(cR()),pe(_R()),console.log(l,"surveyData"),De({files:p,projectId:fe,surveyName:l?.name||"",is_template:z?"true":"false",template_project_id:K,reference_media_files:d},{onSuccess:()=>{b(!1),Ue(`/${fe}/chat`,{replace:!0})},onError:l=>{vo.error("Failed to create survey session",{description:l?.message||"Please try again later"})}})},initialFiles:m,preSession:!0})]})}const KM=new Vn;function Main(){const[l,c]=Gt.useState(null);return Gt.useEffect((()=>{(async()=>{const{data:{session:l}}=await EC.auth.getSession();c(l)})();const{data:{subscription:l}}=EC.auth.onAuthStateChange(((l,d)=>{c(d)}));return()=>l.unsubscribe()}),[]),Gt.useEffect((()=>{const l=er.runtime.connect({name:"sidepanel"});return()=>{l.disconnect()}}),[]),Kt.jsx(ReduxProvider,{children:Kt.jsx(QueryClientProvider,{client:KM,children:Kt.jsxs(BrowserRouter,{children:[Kt.jsx(AnalyticsProvider,{session:l}),Kt.jsx(App,{})]})})})}function Providers({children:l}){return Kt.jsx(ThemeProvider,{children:l})}var JM;kx?console.log("[Sentry] Already initialized, skipping..."):(init({dsn:"https://22e46359dd544f29ffb42f0690091403@o4505871997992960.ingest.sentry.io/4506296337498112",environment:"production",enabled:!0,integrations:[new BrowserTracing({tracePropagationTargets:["localhost",/.*workhack\.io.*/,/.*workhack\.ai.*/,/.*metaforms\.ai.*/,/.*confirmit\.com.*/]}),new Replay$1({maskAllText:!1,blockAllMedia:!1})],tracesSampleRate:1,replaysSessionSampleRate:.1,replaysOnErrorSampleRate:1,beforeSend(l){if(l.tags={...l.tags,app:"confirmit-extension",platform:"chrome-extension",extensionId:er?.runtime?.id||"unknown",version:chrome?.runtime?.getManifest?.()?.version||"unknown"},"memory"in performance){const c=performance.memory;l.contexts={...l.contexts,performance:{usedJSHeapSize:c.usedJSHeapSize,totalJSHeapSize:c.totalJSHeapSize,jsHeapSizeLimit:c.jsHeapSizeLimit}}}return l.contexts={...l.contexts,browser:{name:navigator.userAgent,version:navigator.appVersion,language:navigator.language,cookieEnabled:navigator.cookieEnabled,onLine:navigator.onLine}},l},beforeSendTransaction:l=>(l.tags={...l.tags,app:"confirmit-extension",extensionId:er?.runtime?.id||"unknown"},l)}),JM={id:getSessionIdSync(),username:"extension-user"},getCurrentHub().setUser(JM),setContext("extension",{id:er?.runtime?.id||"unknown",version:chrome?.runtime?.getManifest?.()?.version||"unknown",installType:"extension"}),kx=!0,console.log("[Sentry] Initialized successfully")),Sr.createRoot(document.getElementById("root")).render(Kt.jsx(Yt.StrictMode,{children:Kt.jsx(Providers,{children:Kt.jsx(Main,{})})}));
